cscope 15 $HOME/Downloads/crypto               0002217101
	@3way.cpp

4 
	~"pch.h
"

5 
	~"3way.h
"

6 
	~"misc.h
"

8 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

10 
	$Th»eWay_Te¡In¡ªtŸtiÚs
()

12 
Th»eWay
::
Enüy±iÚ
 
x1
;

13 
Th»eWay
::
Deüy±iÚ
 
x2
;

14 
	}
}

16 cÚ¡ 
wÜd32
 
	gSTART_E
 = 0x0b0b;

17 cÚ¡ 
wÜd32
 
	gSTART_D
 = 0xb1b1;

18 cÚ¡ 
wÜd32
 
	gRC_MODULUS
 = 0x11011;

20 
šlše
 
wÜd32
 
	$»v”£B™s
(
wÜd32
 
a
)

22 
a
 = ((a & 0xAAAAAAAA) >> 1) | ((a & 0x55555555) << 1);

23 
a
 = ((a & 0xCCCCCCCC) >> 2) | ((a & 0x33333333) << 2);

24  ((
a
 & 0xF0F0F0F0) >> 4) | ((a & 0x0F0F0F0F) << 4);

25 
	}
}

27 
	#mu
(
a0
, 
a1
, 
a2
) \

29 
a1
 = 
	`»v”£B™s
(a1); \

30 
wÜd32
 
t
 = 
	`»v”£B™s
(
a0
); \

31 
a0
 = 
	`»v”£B™s
(
a2
); \

32 
a2
 = 
t
; \

33 }

	)

35 
	#pi_gamma_pi
(
a0
, 
a1
, 
a2
) \

37 
wÜd32
 
b0
, 
b2
; \

38 
b2
 = 
	`rÙlFixed
(
a2
, 1U); \

39 
b0
 = 
	`rÙlFixed
(
a0
, 22U); \

40 
a0
 = 
	`rÙlFixed
(
b0
 ^ (
a1
|(~
b2
)), 1U); \

41 
a2
 = 
	`rÙlFixed
(
b2
 ^ (
b0
|(~
a1
)), 22U);\

42 
a1
 ^ğ(
b2
|(~
b0
)); \

43 }

	)

46 
	#th‘a
(
a0
, 
a1
, 
a2
) \

48 
wÜd32
 
b0
, 
b1
, 
c
; \

49 
c
 = 
a0
 ^ 
a1
 ^ 
a2
; \

50 
c
 = 
	`rÙlFixed
(c, 16U) ^„otlFixed(c, 8U); \

51 
b0
 = (
a0
 << 24è^ (
a2
 >> 8è^ (
a1
 << 8) ^ (a0 >> 24); \

52 
b1
 = (
a1
 << 24è^ (
a0
 >> 8è^ (
a2
 << 8) ^ (a1 >> 24); \

53 
a0
 ^ğ
c
 ^ 
b0
; \

54 
a1
 ^ğ
c
 ^ 
b1
; \

55 
a2
 ^ğ
c
 ^ (
b0
 >> 16è^ (
b1
 << 16); \

56 }

	)

58 
	#rho
(
a0
, 
a1
, 
a2
) \

60 
	`th‘a
(
a0
, 
a1
, 
a2
); \

61 
	`pi_gamma_pi
(
a0
, 
a1
, 
a2
); \

62 }

	)

64 
	gTh»eWay
::
Ba£
::
	$UncheckedS‘Key
(cÚ¡ 
by‹
 *
uk
, 
Ëngth
, cÚ¡ 
NameV®uePaœs
 &
·¿ms
)

66 
	`As£¹V®idKeyL’gth
(
Ëngth
);

68 
m_rounds
 = 
	`G‘RoundsAndThrowIfInv®id
(
·¿ms
, 
this
);

70 
i
=0; i<3; i++)

71 
m_k
[
i
] = (
wÜd32
)
uk
[4*i+3] | ((word32)uk[4*i+2]<<8) | ((word32)uk[4*i+1]<<16) | ((word32)uk[4*i]<<24);

73 ià(!
	`IsFÜw¬dT¿nsfÜm©iÚ
())

75 
	`th‘a
(
m_k
[0], m_k[1], m_k[2]);

76 
	`mu
(
m_k
[0], m_k[1], m_k[2]);

77 
m_k
[0] = 
	`By‹Rev”£
(m_k[0]);

78 
m_k
[1] = 
	`By‹Rev”£
(m_k[1]);

79 
m_k
[2] = 
	`By‹Rev”£
(m_k[2]);

81 
	}
}

83 
	gTh»eWay
::
Enc
::
	$ProûssAndXÜBlock
(cÚ¡ 
by‹
 *
šBlock
, cÚ¡ by‹ *
xÜBlock
, by‹ *
outBlock
) const

85 
BlockG‘AndPut
<
	twÜd32
, 
	tBigEndŸn
> 
	tBlock
;

87 
wÜd32
 
a0
, 
a1
, 
a2
;

88 
Block
::
	`G‘
(
šBlock
)(
a0
)(
a1
)(
a2
);

90 
wÜd32
 
rc
 = 
START_E
;

92 
i
=0; i<
m_rounds
; i++)

94 
a0
 ^ğ
m_k
[0] ^ (
rc
<<16);

95 
a1
 ^ğ
m_k
[1];

96 
a2
 ^ğ
m_k
[2] ^ 
rc
;

97 
	`rho
(
a0
, 
a1
, 
a2
);

99 
rc
 <<= 1;

100 ià(
rc
&0x10000)„c ^= 0x11011;

102 
a0
 ^ğ
m_k
[0] ^ (
rc
<<16);

103 
a1
 ^ğ
m_k
[1];

104 
a2
 ^ğ
m_k
[2] ^ 
rc
;

105 
	`th‘a
(
a0
, 
a1
, 
a2
);

107 
Block
::
	`Put
(
xÜBlock
, 
outBlock
)(
a0
)(
a1
)(
a2
);

108 
	}
}

110 
	gTh»eWay
::
Dec
::
	$ProûssAndXÜBlock
(cÚ¡ 
by‹
 *
šBlock
, cÚ¡ by‹ *
xÜBlock
, by‹ *
outBlock
) const

112 
BlockG‘AndPut
<
	twÜd32
, 
	tL™eEndŸn
> 
	tBlock
;

114 
wÜd32
 
a0
, 
a1
, 
a2
;

115 
Block
::
	`G‘
(
šBlock
)(
a0
)(
a1
)(
a2
);

117 
wÜd32
 
rc
 = 
START_D
;

119 
	`mu
(
a0
, 
a1
, 
a2
);

120 
i
=0; i<
m_rounds
; i++)

122 
a0
 ^ğ
m_k
[0] ^ (
rc
<<16);

123 
a1
 ^ğ
m_k
[1];

124 
a2
 ^ğ
m_k
[2] ^ 
rc
;

125 
	`rho
(
a0
, 
a1
, 
a2
);

127 
rc
 <<= 1;

128 ià(
rc
&0x10000)„c ^= 0x11011;

130 
a0
 ^ğ
m_k
[0] ^ (
rc
<<16);

131 
a1
 ^ğ
m_k
[1];

132 
a2
 ^ğ
m_k
[2] ^ 
rc
;

133 
	`th‘a
(
a0
, 
a1
, 
a2
);

134 
	`mu
(
a0
, 
a1
, 
a2
);

136 
Block
::
	`Put
(
xÜBlock
, 
outBlock
)(
a0
)(
a1
)(
a2
);

137 
	}
}

139 
	gNAMESPACE_END


	@3way.h

1 #iâdeà
CRYPTOPP_THREEWAY_H


2 
	#CRYPTOPP_THREEWAY_H


	)

7 
	~"£ckey.h
"

8 
	~"£cblock.h
"

10 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

13 
Th»eWay_Info
 : 
public
 
FixedBlockSize
<12>,…ubliø
FixedKeyL’gth
<12>,…ubliø
V¬ŸbËRounds
<11>

15 cÚ¡ *
	`SticAlgÜ™hmName
() { "3-Way";}

16 
	}
};

19 
şass
 
	gTh»eWay
 : 
public
 
Th»eWay_Info
,…ubliø
	gBlockCh”Docum’tiÚ


21 
şass
 
CRYPTOPP_NO_VTABLE
 
	gBa£
 : 
public
 
BlockCh”Im¶
<
Th»eWay_Info
>

23 
public
:

24 
UncheckedS‘Key
(cÚ¡ 
by‹
 *
key
, 
Ëngth
, cÚ¡ 
NameV®uePaœs
 &
·¿ms
);

26 
	g´Ùeùed
:

27 
m_rounds
;

28 
	gFixedSizeSecBlock
<
	gwÜd32
, 3> 
	gm_k
;

31 şas 
	cCRYPTOPP_NO_VTABLE
 
	gEnc
 : 
public
 
Ba£


33 
public
:

34 
ProûssAndXÜBlock
(cÚ¡ 
by‹
 *
šBlock
, cÚ¡ by‹ *
xÜBlock
, by‹ *
outBlock
) const;

37 şas 
	cCRYPTOPP_NO_VTABLE
 
	gDec
 : 
public
 
Ba£


39 
public
:

40 
ProûssAndXÜBlock
(cÚ¡ 
by‹
 *
šBlock
, cÚ¡ by‹ *
xÜBlock
, by‹ *
outBlock
) const;

43 
	gpublic
:

44 
BlockCh”Fš®
<
	tENCRYPTION
, 
	tEnc
> 
	tEnüy±iÚ
;

45 
	gBlockCh”Fš®
<
	tDECRYPTION
, 
	tDec
> 
	tDeüy±iÚ
;

48 
	gTh»eWay
::
	tEnüy±iÚ
 
	tTh»eWayEnüy±iÚ
;

49 
	gTh»eWay
::
	tDeüy±iÚ
 
	tTh»eWayDeüy±iÚ
;

51 
	gNAMESPACE_END


	@adhoc.cpp

1 
	~"f‹rs.h
"

2 
	~"fes.h
"

3 
	~"ba£64.h
"

4 
	~"hex.h
"

5 
	~<io¡»am
>

7 
	$USING_NAMESPACE
(
Cry±oPP
)

8 
	$USING_NAMESPACE
(
¡d
)

10 (*
AdhocTe¡
)(
¬gc
, *
¬gv
[]);

12 
	$MyAdhocTe¡
(
¬gc
, *
¬gv
[])

15 
	}
}

17 
	gs_i
 = (
AdhocTe¡
 = &
MyAdhocTe¡
, 0);

	@adler32.cpp

3 
	~"pch.h
"

4 
	~"adËr32.h
"

6 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

8 
AdËr32
::
	$Upd©e
(cÚ¡ 
by‹
 *
šput
, 
size_t
 
Ëngth
)

10 cÚ¡ 
BASE
 = 65521;

12 
s1
 = 
m_s1
;

13 
s2
 = 
m_s2
;

15 ià(
Ëngth
 % 8 != 0)

19 
s1
 +ğ*
šput
++;

20 
s2
 +ğ
s1
;

21 
Ëngth
--;

22 } 
Ëngth
 % 8 != 0);

24 ià(
s1
 >ğ
BASE
)

25 
s1
 -ğ
BASE
;

26 
s2
 %ğ
BASE
;

29 
Ëngth
 > 0)

31 
s1
 +ğ
šput
[0]; 
s2
 += s1;

32 
s1
 +ğ
šput
[1]; 
s2
 += s1;

33 
s1
 +ğ
šput
[2]; 
s2
 += s1;

34 
s1
 +ğ
šput
[3]; 
s2
 += s1;

35 
s1
 +ğ
šput
[4]; 
s2
 += s1;

36 
s1
 +ğ
šput
[5]; 
s2
 += s1;

37 
s1
 +ğ
šput
[6]; 
s2
 += s1;

38 
s1
 +ğ
šput
[7]; 
s2
 += s1;

40 
Ëngth
 -= 8;

41 
šput
 += 8;

43 ià(
s1
 >ğ
BASE
)

44 
s1
 -ğ
BASE
;

45 ià(
Ëngth
 % 0x8000 == 0)

46 
s2
 %ğ
BASE
;

49 
	`as£¹
(
s1
 < 
BASE
);

50 
	`as£¹
(
s2
 < 
BASE
);

52 
m_s1
 = (
wÜd16
)
s1
;

53 
m_s2
 = (
wÜd16
)
s2
;

54 
	}
}

56 
	gAdËr32
::
	$Trunÿ‹dFš®
(
by‹
 *
hash
, 
size_t
 
size
)

58 
	`ThrowIfInv®idTrunÿ‹dSize
(
size
);

60 
size
)

63 
hash
[3] = 
	`by‹
(
m_s1
);

65 
hash
[2] = 
	`by‹
(
m_s1
 >> 8);

67 
hash
[1] = 
	`by‹
(
m_s2
);

69 
hash
[0] = 
	`by‹
(
m_s2
 >> 8);

74 
	`Re£t
();

75 
	}
}

77 
	gNAMESPACE_END


	@adler32.h

1 #iâdeà
CRYPTOPP_ADLER32_H


2 
	#CRYPTOPP_ADLER32_H


	)

4 
	~"üy±lib.h
"

6 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

9 şas 
	cAdËr32
 : 
public
 
HashT¿nsfÜm©iÚ


11 
public
:

12 
	$CRYPTOPP_CONSTANT
(
DIGESTSIZE
 = 4)

13 
	$AdËr32
(è{
	`Re£t
();}

14 
	`Upd©e
(cÚ¡ 
by‹
 *
šput
, 
size_t
 
Ëngth
);

15 
	`Trunÿ‹dFš®
(
by‹
 *
hash
, 
size_t
 
size
);

16 
	$Dige¡Size
(ècÚ¡ { 
DIGESTSIZE
;
	}
}

17 cÚ¡ * 
	$SticAlgÜ™hmName
(è{ "AdËr32";
	}
}

18 
	g¡d
::
¡ršg
 
	$AlgÜ™hmName
(ècÚ¡ { 
	`SticAlgÜ™hmName
();
	}
}

20 
	g´iv©e
:

21 
	$Re£t
(è{
m_s1
 = 1; 
m_s2
 = 0;
	}
}

23 
wÜd16
 
	gm_s1
, 
	gm_s2
;

26 
	gNAMESPACE_END


	@aes.h

1 #iâdeà
CRYPTOPP_AES_H


2 
	#CRYPTOPP_AES_H


	)

4 
	~"rijnd«l.h
"

6 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

9 
	`DOCUMENTED_TYPEDEF
(
Rijnd«l
, 
AES
);

11 
Rijnd«lEnüy±iÚ
 
	tAESEnüy±iÚ
;

12 
Rijnd«lDeüy±iÚ
 
	tAESDeüy±iÚ
;

14 
NAMESPACE_END


	@algebra.cpp

3 
	~"pch.h
"

5 #iâdeà
CRYPTOPP_ALGEBRA_CPP


6 
	#CRYPTOPP_ALGEBRA_CPP


	)

8 
	~"®geb¿.h
"

9 
	~"š‹g”.h
"

11 
	~<veùÜ
>

13 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

15 
‹m¶©e
 <
şass
 
T
> cÚ¡ T& 
Ab¡¿ùGroup
<T>::
	$DoubË
(cÚ¡ 
EËm’t
 &
a
) const

17  
this
->
	`Add
(
a
,‡);

18 
	}
}

20 
	g‹m¶©e
 <
şass
 
	gT
> cÚ¡ T& 
	gAb¡¿ùGroup
<T>::
	$SubŒaù
(cÚ¡ 
EËm’t
 &
a
, cÚ¡ EËm’ˆ&
b
) const

23 
EËm’t
 
	`a1
(
a
);

24  
this
->
	`Add
(
a1
, 
	`Inv”£
(
b
));

25 
	}
}

27 
	g‹m¶©e
 <
şass
 
	gT
> T& 
	gAb¡¿ùGroup
<T>::
	$AccumuÏ‹
(
EËm’t
 &
a
, cÚ¡ EËm’ˆ&
b
) const

29  
a
 = 
this
->
	`Add
×, 
b
);

30 
	}
}

32 
	g‹m¶©e
 <
şass
 
	gT
> T& 
	gAb¡¿ùGroup
<T>::
	$Reduû
(
EËm’t
 &
a
, cÚ¡ EËm’ˆ&
b
) const

34  
a
 = 
this
->
	`SubŒaù
×, 
b
);

35 
	}
}

37 
	g‹m¶©e
 <
şass
 
	gT
> cÚ¡ T& 
	gAb¡¿ùRšg
<T>::
	$Squ¬e
(cÚ¡ 
EËm’t
 &
a
) const

39  
this
->
	`MuÉly
(
a
,‡);

40 
	}
}

42 
	g‹m¶©e
 <
şass
 
	gT
> cÚ¡ T& 
	gAb¡¿ùRšg
<T>::
	$Divide
(cÚ¡ 
EËm’t
 &
a
, cÚ¡ EËm’ˆ&
b
) const

45 
EËm’t
 
	`a1
(
a
);

46  
this
->
	`MuÉly
(
a1
,his->
	`MuÉliÿtiveInv”£
(
b
));

47 
	}
}

49 
	g‹m¶©e
 <
şass
 
	gT
> cÚ¡ T& 
	gAb¡¿ùEuşid—nDomaš
<T>::
	$Mod
(cÚ¡ 
EËm’t
 &
a
, cÚ¡ EËm’ˆ&
b
) const

51 
EËm’t
 
q
;

52 
this
->
	`DivisiÚAlgÜ™hm
(
»suÉ
, 
q
, 
a
, 
b
);

53  
»suÉ
;

54 
	}
}

56 
	g‹m¶©e
 <
şass
 
	gT
> cÚ¡ T& 
	gAb¡¿ùEuşid—nDomaš
<T>::
	$Gcd
(cÚ¡ 
EËm’t
 &
a
, cÚ¡ EËm’ˆ&
b
) const

58 
EËm’t
 
g
[3]={
b
, 
a
};

59 
i0
=0, 
i1
=1, 
i2
=2;

61 !
this
->
	`Equ®
(
g
[
i1
],his->
	`Id’t™y
()))

63 
g
[
i2
] = 
this
->
	`Mod
(g[
i0
], g[
i1
]);

64 
t
 = 
i0
; i0 = 
i1
; i1 = 
i2
; i2 =;

67  
»suÉ
 = 
g
[
i0
];

68 
	}
}

70 
	g‹m¶©e
 <
şass
 
	gT
> cÚ¡ 
ty³Çme
 
	gQuÙ›ÁRšg
<T>::
EËm’t
& 
QuÙ›ÁRšg
<
T
>::
	$MuÉliÿtiveInv”£
(cÚ¡ 
EËm’t
 &
a
) const

72 
EËm’t
 
g
[3]={
m_modulus
, 
a
};

73 
EËm’t
 
v
[3]={
m_domaš
.
	`Id’t™y
(), m_domaš.
	`MuÉliÿtiveId’t™y
()};

74 
EËm’t
 
y
;

75 
i0
=0, 
i1
=1, 
i2
=2;

77 !
this
->
	`Equ®
(
g
[
i1
],his->
	`Id’t™y
()))

81 
m_domaš
.
	`DivisiÚAlgÜ™hm
(
g
[
i2
], 
y
, g[
i0
], g[
i1
]);

83 
v
[
i2
] = 
m_domaš
.
	`SubŒaù
(v[
i0
], m_domaš.
	`MuÉly
(v[
i1
], 
y
));

84 
t
 = 
i0
; i0 = 
i1
; i1 = 
i2
; i2 =;

87  
m_domaš
.
	`IsUn™
(
g
[
i0
]è? m_domaš.
	`Divide
(
v
[i0], g[i0]è: m_domaš.
	`Id’t™y
();

88 
	}
}

90 
	g‹m¶©e
 <
şass
 
	gT
> 
T
 
	gAb¡¿ùGroup
<T>::
	$SÿÏrMuÉly
(cÚ¡ 
EËm’t
 &
ba£
, cÚ¡ 
IÁeg”
 &
expÚ’t
) const

92 
EËm’t
 
»suÉ
;

93 
this
->
	`SimuÉªeousMuÉly
(&
»suÉ
, 
ba£
, &
expÚ’t
, 1);

94  
»suÉ
;

95 
	}
}

97 
	g‹m¶©e
 <
şass
 
	gT
> 
T
 
	gAb¡¿ùGroup
<T>::
	$CasÿdeSÿÏrMuÉly
(cÚ¡ 
EËm’t
 &
x
, cÚ¡ 
IÁeg”
 &
e1
, cÚ¡ EËm’ˆ&
y
, cÚ¡ IÁeg” &
e2
) const

99 cÚ¡ 
expL’
 = 
	`STDMAX
(
e1
.
	`B™CouÁ
(), 
e2
.BitCount());

100 ià(
expL’
==0)

101  
this
->
	`Id’t™y
();

103 cÚ¡ 
w
 = (
expL’
 <= 46 ? 1 : (expLen <= 260 ? 2 : 3));

104 cÚ¡ 
bËSize
 = 1<<
w
;

105 
¡d
::
veùÜ
<
EËm’t
> 
	`pow”TabË
(
bËSize
 << 
w
);

107 
pow”TabË
[1] = 
x
;

108 
pow”TabË
[
bËSize
] = 
y
;

109 ià(
w
==1)

110 
pow”TabË
[3] = 
this
->
	`Add
(
x
,
y
);

113 
pow”TabË
[2] = 
this
->
	`DoubË
(
x
);

114 
pow”TabË
[2*
bËSize
] = 
this
->
	`DoubË
(
y
);

116 
i
, 
j
;

118 
i
=3; i<
bËSize
; i+=2)

119 
pow”TabË
[
i
] = 
	`Add
(powerTable[i-2],…owerTable[2]);

120 
i
=1; i<
bËSize
; i+=2)

121 
j
=
i
+
bËSize
; j<ÑabËSize<<
w
); j+=tableSize)

122 
pow”TabË
[
j
] = 
	`Add
Õow”TabË[j-
bËSize
], 
y
);

124 
i
=3*
bËSize
; i<ÑabËSize<<
w
); i+=2*tableSize)

125 
pow”TabË
[
i
] = 
	`Add
Õow”TabË[i-2*
bËSize
],…owerTable[2*tableSize]);

126 
i
=
bËSize
; i<ÑabËSize<<
w
); i+=2*tableSize)

127 
j
=
i
+2; j<i+
bËSize
; j+=2)

128 
pow”TabË
[
j
] = 
	`Add
Õow”TabË[j-1], 
x
);

131 
EËm’t
 
»suÉ
;

132 
pow”1
 = 0, 
pow”2
 = 0, 
´evPos™iÚ
 = 
expL’
-1;

133 
boŞ
 
fœ¡Time
 = 
Œue
;

135 
i
 = 
expL’
-1; i>=0; i--)

137 
pow”1
 = 2*pow”1 + 
e1
.
	`G‘B™
(
i
);

138 
pow”2
 = 2*pow”2 + 
e2
.
	`G‘B™
(
i
);

140 ià(
i
==0 || 2*
pow”1
 >ğ
bËSize
 || 2*
pow”2
 >=ableSize)

142 
squ¬esBefÜe
 = 
´evPos™iÚ
-
i
;

143 
squ¬esAá”
 = 0;

144 
´evPos™iÚ
 = 
i
;

145 (
pow”1
 || 
pow”2
) &&…ower1%2 == 0 &&…ower2%2==0)

147 
pow”1
 /= 2;

148 
pow”2
 /= 2;

149 
squ¬esBefÜe
--;

150 
squ¬esAá”
++;

152 ià(
fœ¡Time
)

154 
»suÉ
 = 
pow”TabË
[(
pow”2
<<
w
è+ 
pow”1
];

155 
fœ¡Time
 = 
çl£
;

159 
squ¬esBefÜe
--)

160 
»suÉ
 = 
this
->
	`DoubË
(result);

161 ià(
pow”1
 || 
pow”2
)

162 
	`AccumuÏ‹
(
»suÉ
, 
pow”TabË
[(
pow”2
<<
w
è+ 
pow”1
]);

164 
squ¬esAá”
--)

165 
»suÉ
 = 
this
->
	`DoubË
(result);

166 
pow”1
 = 
pow”2
 = 0;

169  
»suÉ
;

170 
	}
}

172 
	g‹m¶©e
 <
şass
 
	gEËm’t
, cÏs 
	gI‹¿tÜ
> 
EËm’t
 
G’”®CasÿdeMuÉliÿtiÚ
(cÚ¡ 
Ab¡¿ùGroup
<EËm’t> &
group
, 
I‹¿tÜ
 
begš
, I‹¿tÜ 
’d
)

174 ià(
	g’d
-
	gbegš
 == 1)

175  
group
.
SÿÏrMuÉly
(
begš
->
ba£
, begš->
expÚ’t
);

176 ià(
	g’d
-
	gbegš
 == 2)

177  
group
.
CasÿdeSÿÏrMuÉly
(
begš
->
ba£
, begš->
expÚ’t
, (begin+1)->base, (begin+1)->exponent);

180 
IÁeg”
 
	gq
, 
	gt
;

181 
I‹¿tÜ
 
	gÏ¡
 = 
’d
;

182 --
	gÏ¡
;

184 
	g¡d
::
make_h—p
(
begš
, 
’d
);

185 
	g¡d
::
pİ_h—p
(
begš
, 
’d
);

187 !!
	gbegš
->
	gexpÚ’t
)

190 
	gt
 = 
Ï¡
->
expÚ’t
;

191 
	gIÁeg”
::
Divide
(
Ï¡
->
expÚ’t
, 
q
, 
t
, 
begš
->exponent);

193 ià(
	gq
 =ğ
IÁeg”
::
OÃ
())

194 
group
.
AccumuÏ‹
(
begš
->
ba£
, 
Ï¡
->base);

196 
	ggroup
.
AccumuÏ‹
(
begš
->
ba£
, 
group
.
SÿÏrMuÉly
(
Ï¡
->ba£, 
q
));

198 
	g¡d
::
push_h—p
(
begš
, 
’d
);

199 
	g¡d
::
pİ_h—p
(
begš
, 
’d
);

202  
	ggroup
.
SÿÏrMuÉly
(
Ï¡
->
ba£
,†a¡->
expÚ’t
);

206 
	sWšdowSlid”


208 
WšdowSlid”
(cÚ¡ 
IÁeg”
 &
expIn
, 
boŞ
 
ç¡Neg©e
, 
wšdowSizeIn
=0)

209 : 
exp
(
expIn
), 
wšdowModulus
(
IÁeg”
::
OÃ
()), 
wšdowSize
(
wšdowSizeIn
), 
wšdowBegš
(0), 
ç¡Neg©e
(ç¡Neg©e), 
fœ¡Time
(
Œue
), 
fšished
(
çl£
)

211 ià(
	mwšdowSize
 == 0)

213 
expL’
 = 
exp
.
B™CouÁ
();

214 
	mwšdowSize
 = 
expL’
 <= 17 ? 1 : (expLen <= 24 ? 2 : (expLen <= 70 ? 3 : (expLen <= 197 ? 4 : (expLen <= 539 ? 5 : (expLen <= 1434 ? 6 : 7)))));

216 
	mwšdowModulus
 <<ğ
wšdowSize
;

219 
FšdNextWšdow
()

221 
	mexpL’
 = 
exp
.
WÜdCouÁ
(è* 
WORD_BITS
;

222 
	mskCouÁ
 = 
fœ¡Time
 ? 0 : 
wšdowSize
;

223 
	mfœ¡Time
 = 
çl£
;

224 !
	mexp
.
G‘B™
(
skCouÁ
))

226 ià(
	mskCouÁ
 >ğ
expL’
)

228 
fšished
 = 
Œue
;

231 
	mskCouÁ
++;

234 
	mexp
 >>ğ
skCouÁ
;

235 
	mwšdowBegš
 +ğ
skCouÁ
;

236 
	mexpWšdow
 = 
wÜd32
(
exp
 % (
wÜd
(1è<< 
wšdowSize
));

238 ià(
	mç¡Neg©e
 && 
	mexp
.
G‘B™
(
wšdowSize
))

240 
	mÃg©eNext
 = 
Œue
;

241 
	mexpWšdow
 = (
wÜd32
(1è<< 
wšdowSize
è- 
expWšdow
;

242 
	mexp
 +ğ
wšdowModulus
;

245 
	mÃg©eNext
 = 
çl£
;

248 
IÁeg”
 
	mexp
, 
	mwšdowModulus
;

249 
	mwšdowSize
, 
	mwšdowBegš
;

250 
wÜd32
 
	mexpWšdow
;

251 
boŞ
 
	mç¡Neg©e
, 
	mÃg©eNext
, 
	mfœ¡Time
, 
	mfšished
;

254 
	g‹m¶©e
 <
şass
 
	gT
>

255 
	gAb¡¿ùGroup
<
	gT
>::
	$SimuÉªeousMuÉly
(
T
 *
»suÉs
, cÚ¡ T &
ba£
, cÚ¡ 
IÁeg”
 *
expBegš
, 
expCouÁ
) const

257 
¡d
::
veùÜ
<¡d::veùÜ<
EËm’t
> > 
	`buck‘s
(
expCouÁ
);

258 
¡d
::
veùÜ
<
WšdowSlid”
> 
expÚ’ts
;

259 
expÚ’ts
.
	`»£rve
(
expCouÁ
);

260 
i
;

262 
i
=0; i<
expCouÁ
; i++)

264 
	`as£¹
(
expBegš
->
	`NÙNeg©ive
());

265 
expÚ’ts
.
	`push_back
(
	`WšdowSlid”
(*
expBegš
++, 
	`Inv”siÚIsFa¡
(), 0));

266 
expÚ’ts
[
i
].
	`FšdNextWšdow
();

267 
buck‘s
[
i
].
	`»size
(1<<(
expÚ’ts
[i].
wšdowSize
-1), 
	`Id’t™y
());

270 
expB™Pos™iÚ
 = 0;

271 
EËm’t
 
g
 = 
ba£
;

272 
boŞ
 
nÙDÚe
 = 
Œue
;

274 
nÙDÚe
)

276 
nÙDÚe
 = 
çl£
;

277 
i
=0; i<
expCouÁ
; i++)

279 ià(!
expÚ’ts
[
i
].
fšished
 && 
expB™Pos™iÚ
 =ğexpÚ’ts[i].
wšdowBegš
)

281 
EËm’t
 &
buck‘
 = 
buck‘s
[
i
][
expÚ’ts
[i].
expWšdow
/2];

282 ià(
expÚ’ts
[
i
].
Ãg©eNext
)

283 
	`AccumuÏ‹
(
buck‘
, 
	`Inv”£
(
g
));

285 
	`AccumuÏ‹
(
buck‘
, 
g
);

286 
expÚ’ts
[
i
].
	`FšdNextWšdow
();

288 
nÙDÚe
 =‚ÙDÚ|| !
expÚ’ts
[
i
].
fšished
;

291 ià(
nÙDÚe
)

293 
g
 = 
	`DoubË
(g);

294 
expB™Pos™iÚ
++;

298 
i
=0; i<
expCouÁ
; i++)

300 
EËm’t
 &
r
 = *
»suÉs
++;

301 
r
 = 
buck‘s
[
i
][buck‘s[i].
	`size
()-1];

302 ià(
buck‘s
[
i
].
	`size
() > 1)

304 
j
 = ()
buck‘s
[
i
].
	`size
()-2; j >= 1; j--)

306 
	`AccumuÏ‹
(
buck‘s
[
i
][
j
], buckets[i][j+1]);

307 
	`AccumuÏ‹
(
r
, 
buck‘s
[
i
][
j
]);

309 
	`AccumuÏ‹
(
buck‘s
[
i
][0], buckets[i][1]);

310 
r
 = 
	`Add
(
	`DoubË
Ô), 
buck‘s
[
i
][0]);

313 
	}
}

315 
	g‹m¶©e
 <
şass
 
	gT
> 
T
 
	gAb¡¿ùRšg
<T>::
	$ExpÚ’tŸ‹
(cÚ¡ 
EËm’t
 &
ba£
, cÚ¡ 
IÁeg”
 &
expÚ’t
) const

317 
EËm’t
 
»suÉ
;

318 
	`SimuÉªeousExpÚ’tŸ‹
(&
»suÉ
, 
ba£
, &
expÚ’t
, 1);

319  
»suÉ
;

320 
	}
}

322 
	g‹m¶©e
 <
şass
 
	gT
> 
T
 
	gAb¡¿ùRšg
<T>::
	$CasÿdeExpÚ’tŸ‹
(cÚ¡ 
EËm’t
 &
x
, cÚ¡ 
IÁeg”
 &
e1
, cÚ¡ EËm’ˆ&
y
, cÚ¡ IÁeg” &
e2
) const

324  
	`MuÉliÿtiveGroup
().
Ab¡¿ùGroup
<
T
>::
	`CasÿdeSÿÏrMuÉly
(
x
, 
e1
, 
y
, 
e2
);

325 
	}
}

327 
	g‹m¶©e
 <
şass
 
	gEËm’t
, cÏs 
	gI‹¿tÜ
> 
EËm’t
 
G’”®CasÿdeExpÚ’tŸtiÚ
(cÚ¡ 
Ab¡¿ùRšg
<EËm’t> &
ršg
, 
I‹¿tÜ
 
begš
, I‹¿tÜ 
’d
)

329  
	gG’”®CasÿdeMuÉliÿtiÚ
<
	gEËm’t
>(
	gršg
.
MuÉliÿtiveGroup
(), 
	gbegš
, 
	g’d
);

332 
	g‹m¶©e
 <
şass
 
	gT
>

333 
	gAb¡¿ùRšg
<
	gT
>::
	$SimuÉªeousExpÚ’tŸ‹
(
T
 *
»suÉs
, cÚ¡ T &
ba£
, cÚ¡ 
IÁeg”
 *
expÚ’ts
, 
expCouÁ
) const

335 
	`MuÉliÿtiveGroup
().
Ab¡¿ùGroup
<
T
>::
	`SimuÉªeousMuÉly
(
»suÉs
, 
ba£
, 
expÚ’ts
, 
expCouÁ
);

336 
	}
}

338 
	gNAMESPACE_END


	@algebra.h

1 #iâdeà
CRYPTOPP_ALGEBRA_H


2 
	#CRYPTOPP_ALGEBRA_H


	)

4 
	~"cÚfig.h
"

6 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

8 
şass
 
IÁeg”
;

19 
‹m¶©e
 <
şass
 
T
> cÏs 
	cCRYPTOPP_NO_VTABLE
 
Ab¡¿ùGroup


21 
public
:

22 
T
 
	tEËm’t
;

24 
vœtu®
 ~
	$Ab¡¿ùGroup
() {}

26 
vœtu®
 
boŞ
 
	$Equ®
(cÚ¡ 
EËm’t
 &
a
, cÚ¡ EËm’ˆ&
b
) const =0;

27 
vœtu®
 cÚ¡ 
EËm’t
& 
	$Id’t™y
() const =0;

28 
vœtu®
 cÚ¡ 
EËm’t
& 
	$Add
(cÚ¡ 
EËm’t
 &
a
, cÚ¡ EËm’ˆ&
b
) const =0;

29 
vœtu®
 cÚ¡ 
EËm’t
& 
	$Inv”£
(cÚ¡ 
EËm’t
 &
a
) const =0;

30 
vœtu®
 
boŞ
 
	$Inv”siÚIsFa¡
(ècÚ¡ { 
çl£
;
	}
}

32 
vœtu®
 cÚ¡ 
	gEËm’t
& 
	$DoubË
(cÚ¡ 
EËm’t
 &
a
) const;

33 
vœtu®
 cÚ¡ 
EËm’t
& 
	$SubŒaù
(cÚ¡ 
EËm’t
 &
a
, cÚ¡ EËm’ˆ&
b
) const;

34 
vœtu®
 
EËm’t
& 
	$AccumuÏ‹
(
EËm’t
 &
a
, cÚ¡ EËm’ˆ&
b
) const;

35 
vœtu®
 
EËm’t
& 
	$Reduû
(
EËm’t
 &
a
, cÚ¡ EËm’ˆ&
b
) const;

37 
vœtu®
 
EËm’t
 
	$SÿÏrMuÉly
(cÚ¡ 
EËm’t
 &
a
, cÚ¡ 
IÁeg”
 &
e
) const;

38 
vœtu®
 
EËm’t
 
	$CasÿdeSÿÏrMuÉly
(cÚ¡ 
EËm’t
 &
x
, cÚ¡ 
IÁeg”
 &
e1
, cÚ¡ EËm’ˆ&
y
, cÚ¡ IÁeg” &
e2
) const;

40 
vœtu®
 
	$SimuÉªeousMuÉly
(
EËm’t
 *
»suÉs
, cÚ¡ EËm’ˆ&
ba£
, cÚ¡ 
IÁeg”
 *
expÚ’ts
, 
expÚ’tsCouÁ
) const;

41 
	}
};

44 
	g‹m¶©e
 <
şass
 
	gT
> cÏs 
CRYPTOPP_NO_VTABLE
 
	gAb¡¿ùRšg
 : 
public
 
Ab¡¿ùGroup
<
T
>

46 
public
:

47 
T
 
	tEËm’t
;

49 
Ab¡¿ùRšg
(è{
	gm_mg
.
	gm_pRšg
 = 
this
;}

50 
Ab¡¿ùRšg
(cÚ¡ Ab¡¿ùRšg &
sourû
è{
	gm_mg
.
	gm_pRšg
 = 
this
;}

51 
	gAb¡¿ùRšg
& 
	gİ”©Ü
=(cÚ¡ 
Ab¡¿ùRšg
 &
sourû
è{ *
this
;}

53 
vœtu®
 
boŞ
 
IsUn™
(cÚ¡ 
EËm’t
 &
a
) const =0;

54 
vœtu®
 cÚ¡ 
	gEËm’t
& 
MuÉliÿtiveId’t™y
() const =0;

55 
vœtu®
 cÚ¡ 
	gEËm’t
& 
MuÉly
(cÚ¡ 
EËm’t
 &
a
, cÚ¡ EËm’ˆ&
b
) const =0;

56 
vœtu®
 cÚ¡ 
	gEËm’t
& 
MuÉliÿtiveInv”£
(cÚ¡ 
EËm’t
 &
a
) const =0;

58 
vœtu®
 cÚ¡ 
	gEËm’t
& 
Squ¬e
(cÚ¡ 
EËm’t
 &
a
) const;

59 
vœtu®
 cÚ¡ 
	gEËm’t
& 
Divide
(cÚ¡ 
EËm’t
 &
a
, cÚ¡ EËm’ˆ&
b
) const;

61 
vœtu®
 
EËm’t
 
ExpÚ’tŸ‹
(cÚ¡ EËm’ˆ&
a
, cÚ¡ 
IÁeg”
 &
e
) const;

62 
vœtu®
 
EËm’t
 
CasÿdeExpÚ’tŸ‹
(cÚ¡ EËm’ˆ&
x
, cÚ¡ 
IÁeg”
 &
e1
, cÚ¡ EËm’ˆ&
y
, cÚ¡ IÁeg” &
e2
) const;

64 
vœtu®
 
SimuÉªeousExpÚ’tŸ‹
(
EËm’t
 *
»suÉs
, cÚ¡ EËm’ˆ&
ba£
, cÚ¡ 
IÁeg”
 *
expÚ’ts
, 
expÚ’tsCouÁ
) const;

66 
vœtu®
 cÚ¡ 
	gAb¡¿ùGroup
<
	gT
>& 
MuÉliÿtiveGroup
() const

67 { 
	gm_mg
;}

69 
	g´iv©e
:

70 
şass
 
MuÉliÿtiveGroupT
 : 
public
 
Ab¡¿ùGroup
<
T
>

72 
public
:

73 cÚ¡ 
Ab¡¿ùRšg
<
T
>& 
G‘Ršg
() const

74 { *
m_pRšg
;}

76 
boŞ
 
Equ®
(cÚ¡ 
EËm’t
 &
a
, cÚ¡ EËm’ˆ&
b
) const

77 { 
G‘Ršg
().
Equ®
(
a
, 
b
);}

79 cÚ¡ 
	gEËm’t
& 
Id’t™y
() const

80 { 
G‘Ršg
().
MuÉliÿtiveId’t™y
();}

82 cÚ¡ 
	gEËm’t
& 
Add
(cÚ¡ 
EËm’t
 &
a
, cÚ¡ EËm’ˆ&
b
) const

83 { 
G‘Ršg
().
MuÉly
(
a
, 
b
);}

85 
	gEËm’t
& 
AccumuÏ‹
(
EËm’t
 &
a
, cÚ¡ EËm’ˆ&
b
) const

86 { 
	ga
 = 
G‘Ršg
().
MuÉly
(
a
, 
b
);}

88 cÚ¡ 
	gEËm’t
& 
Inv”£
(cÚ¡ 
EËm’t
 &
a
) const

89 { 
G‘Ršg
().
MuÉliÿtiveInv”£
(
a
);}

91 cÚ¡ 
	gEËm’t
& 
SubŒaù
(cÚ¡ 
EËm’t
 &
a
, cÚ¡ EËm’ˆ&
b
) const

92 { 
G‘Ršg
().
Divide
(
a
, 
b
);}

94 
	gEËm’t
& 
Reduû
(
EËm’t
 &
a
, cÚ¡ EËm’ˆ&
b
) const

95 { 
	ga
 = 
G‘Ršg
().
Divide
(
a
, 
b
);}

97 cÚ¡ 
	gEËm’t
& 
DoubË
(cÚ¡ 
EËm’t
 &
a
) const

98 { 
G‘Ršg
().
Squ¬e
(
a
);}

100 
EËm’t
 
SÿÏrMuÉly
(cÚ¡ EËm’ˆ&
a
, cÚ¡ 
IÁeg”
 &
e
) const

101 { 
G‘Ršg
().
ExpÚ’tŸ‹
(
a
, 
e
);}

103 
EËm’t
 
CasÿdeSÿÏrMuÉly
(cÚ¡ EËm’ˆ&
x
, cÚ¡ 
IÁeg”
 &
e1
, cÚ¡ EËm’ˆ&
y
, cÚ¡ IÁeg” &
e2
) const

104 { 
G‘Ršg
().
CasÿdeExpÚ’tŸ‹
(
x
, 
e1
, 
y
, 
e2
);}

106 
SimuÉªeousMuÉly
(
EËm’t
 *
»suÉs
, cÚ¡ EËm’ˆ&
ba£
, cÚ¡ 
IÁeg”
 *
expÚ’ts
, 
expÚ’tsCouÁ
) const

107 {
G‘Ršg
().
SimuÉªeousExpÚ’tŸ‹
(
»suÉs
, 
ba£
, 
expÚ’ts
, 
expÚ’tsCouÁ
);}

109 cÚ¡ 
	gAb¡¿ùRšg
<
	gT
> *
	gm_pRšg
;

112 
MuÉliÿtiveGroupT
 
	gm_mg
;

118 
	g‹m¶©e
 <
şass
 
	gT
, cÏs 
	gE
 = 
IÁeg”
>

119 
	sBa£AndExpÚ’t


121 
public
:

122 
Ba£AndExpÚ’t
() {}

123 
Ba£AndExpÚ’t
(cÚ¡ 
T
 &
ba£
, cÚ¡ 
E
 &
expÚ’t
) : base(base),ƒxponent(exponent) {}

124 
boŞ
 
İ”©Ü
<(cÚ¡ 
Ba£AndExpÚ’t
<
T
, 
E
> &
rhs
ècÚ¡ { 
expÚ’t
 <„hs.exponent;}

125 
T
 
	mba£
;

126 
E
 
	mexpÚ’t
;

130 
	g‹m¶©e
 <
şass
 
	gEËm’t
, cÏs 
	gI‹¿tÜ
>

131 
EËm’t
 
G’”®CasÿdeMuÉliÿtiÚ
(cÚ¡ 
Ab¡¿ùGroup
<EËm’t> &
group
, 
I‹¿tÜ
 
begš
, I‹¿tÜ 
’d
);

132 
	g‹m¶©e
 <
şass
 
	gEËm’t
, cÏs 
	gI‹¿tÜ
>

133 
EËm’t
 
G’”®CasÿdeExpÚ’tŸtiÚ
(cÚ¡ 
Ab¡¿ùRšg
<EËm’t> &
ršg
, 
I‹¿tÜ
 
begš
, I‹¿tÜ 
’d
);

138 
	g‹m¶©e
 <
şass
 
	gT
> cÏs 
CRYPTOPP_NO_VTABLE
 
	gAb¡¿ùEuşid—nDomaš
 : 
public
 
Ab¡¿ùRšg
<
T
>

140 
public
:

141 
T
 
	tEËm’t
;

143 
vœtu®
 
DivisiÚAlgÜ™hm
(
EËm’t
 &
r
, EËm’ˆ&
q
, cÚ¡ EËm’ˆ&
a
, cÚ¡ EËm’ˆ&
d
) const =0;

145 
vœtu®
 cÚ¡ 
	gEËm’t
& 
Mod
(cÚ¡ 
EËm’t
 &
a
, cÚ¡ EËm’ˆ&
b
) const =0;

146 
vœtu®
 cÚ¡ 
	gEËm’t
& 
Gcd
(cÚ¡ 
EËm’t
 &
a
, cÚ¡ EËm’ˆ&
b
) const;

148 
	g´Ùeùed
:

149 
mubË
 
EËm’t
 
»suÉ
;

155 
	g‹m¶©e
 <
şass
 
	gT
> cÏs 
	gEuşid—nDomašOf
 : 
public
 
Ab¡¿ùEuşid—nDomaš
<
T
>

157 
public
:

158 
T
 
	tEËm’t
;

160 
Euşid—nDomašOf
() {}

162 
boŞ
 
Equ®
(cÚ¡ 
EËm’t
 &
a
, cÚ¡ EËm’ˆ&
b
) const

163 { 
	ga
==
b
;}

165 cÚ¡ 
	gEËm’t
& 
Id’t™y
() const

166 { 
	gEËm’t
::
Z”o
();}

168 cÚ¡ 
	gEËm’t
& 
Add
(cÚ¡ 
EËm’t
 &
a
, cÚ¡ EËm’ˆ&
b
) const

169 { 
	g»suÉ
 = 
a
+
b
;}

171 
	gEËm’t
& 
AccumuÏ‹
(
EËm’t
 &
a
, cÚ¡ EËm’ˆ&
b
) const

172 { 
	ga
+=
b
;}

174 cÚ¡ 
	gEËm’t
& 
Inv”£
(cÚ¡ 
EËm’t
 &
a
) const

175 { 
	g»suÉ
 = -
a
;}

177 cÚ¡ 
	gEËm’t
& 
SubŒaù
(cÚ¡ 
EËm’t
 &
a
, cÚ¡ EËm’ˆ&
b
) const

178 { 
	g»suÉ
 = 
a
-
b
;}

180 
	gEËm’t
& 
Reduû
(
EËm’t
 &
a
, cÚ¡ EËm’ˆ&
b
) const

181 { 
	ga
-=
b
;}

183 cÚ¡ 
	gEËm’t
& 
DoubË
(cÚ¡ 
EËm’t
 &
a
) const

184 { 
	g»suÉ
 = 
a
.
DoubËd
();}

186 cÚ¡ 
	gEËm’t
& 
MuÉliÿtiveId’t™y
() const

187 { 
	gEËm’t
::
OÃ
();}

189 cÚ¡ 
	gEËm’t
& 
MuÉly
(cÚ¡ 
EËm’t
 &
a
, cÚ¡ EËm’ˆ&
b
) const

190 { 
	g»suÉ
 = 
a
*
b
;}

192 cÚ¡ 
	gEËm’t
& 
Squ¬e
(cÚ¡ 
EËm’t
 &
a
) const

193 { 
	g»suÉ
 = 
a
.
Squ¬ed
();}

195 
boŞ
 
IsUn™
(cÚ¡ 
EËm’t
 &
a
) const

196 { 
	ga
.
IsUn™
();}

198 cÚ¡ 
	gEËm’t
& 
MuÉliÿtiveInv”£
(cÚ¡ 
EËm’t
 &
a
) const

199 { 
	g»suÉ
 = 
a
.
MuÉliÿtiveInv”£
();}

201 cÚ¡ 
	gEËm’t
& 
Divide
(cÚ¡ 
EËm’t
 &
a
, cÚ¡ EËm’ˆ&
b
) const

202 { 
	g»suÉ
 = 
a
/
b
;}

204 cÚ¡ 
	gEËm’t
& 
Mod
(cÚ¡ 
EËm’t
 &
a
, cÚ¡ EËm’ˆ&
b
) const

205 { 
	g»suÉ
 = 
a
%
b
;}

207 
DivisiÚAlgÜ™hm
(
EËm’t
 &
r
, EËm’ˆ&
q
, cÚ¡ EËm’ˆ&
a
, cÚ¡ EËm’ˆ&
d
) const

208 {
	gEËm’t
::
Divide
(
r
, 
q
, 
a
, 
d
);}

210 
boŞ
 
	gİ”©Ü
==(cÚ¡ 
Euşid—nDomašOf
<
T
> &
rhs
) const

211 { 
Œue
;}

213 
	g´iv©e
:

214 
mubË
 
EËm’t
 
»suÉ
;

218 
	g‹m¶©e
 <
şass
 
	gT
> cÏs 
	gQuÙ›ÁRšg
 : 
public
 
Ab¡¿ùRšg
<
ty³Çme
 
T
::
EËm’t
>

220 
public
:

221 
T
 
	tEuşid—nDomaš
;

222 
ty³Çme
 
	tT
::
	tEËm’t
 Element;

224 
QuÙ›ÁRšg
(cÚ¡ 
Euşid—nDomaš
 &
domaš
, cÚ¡ 
EËm’t
 &
modulus
)

225 : 
m_domaš
(
domaš
), 
m_modulus
(
modulus
) {}

227 cÚ¡ 
	gEuşid—nDomaš
 & 
G‘Domaš
() const

228 { 
	gm_domaš
;}

230 cÚ¡ 
	gEËm’t
& 
G‘Modulus
() const

231 { 
	gm_modulus
;}

233 
boŞ
 
Equ®
(cÚ¡ 
EËm’t
 &
a
, cÚ¡ EËm’ˆ&
b
) const

234 { 
	gm_domaš
.
Equ®
(
m_domaš
.
Mod
(m_domaš.
SubŒaù
(
a
, 
b
), 
m_modulus
), m_domaš.
Id’t™y
());}

236 cÚ¡ 
	gEËm’t
& 
Id’t™y
() const

237 { 
	gm_domaš
.
Id’t™y
();}

239 cÚ¡ 
	gEËm’t
& 
Add
(cÚ¡ 
EËm’t
 &
a
, cÚ¡ EËm’ˆ&
b
) const

240 { 
	gm_domaš
.
Add
(
a
, 
b
);}

242 
	gEËm’t
& 
AccumuÏ‹
(
EËm’t
 &
a
, cÚ¡ EËm’ˆ&
b
) const

243 { 
	gm_domaš
.
AccumuÏ‹
(
a
, 
b
);}

245 cÚ¡ 
	gEËm’t
& 
Inv”£
(cÚ¡ 
EËm’t
 &
a
) const

246 { 
	gm_domaš
.
Inv”£
(
a
);}

248 cÚ¡ 
	gEËm’t
& 
SubŒaù
(cÚ¡ 
EËm’t
 &
a
, cÚ¡ EËm’ˆ&
b
) const

249 { 
	gm_domaš
.
SubŒaù
(
a
, 
b
);}

251 
	gEËm’t
& 
Reduû
(
EËm’t
 &
a
, cÚ¡ EËm’ˆ&
b
) const

252 { 
	gm_domaš
.
Reduû
(
a
, 
b
);}

254 cÚ¡ 
	gEËm’t
& 
DoubË
(cÚ¡ 
EËm’t
 &
a
) const

255 { 
	gm_domaš
.
DoubË
(
a
);}

257 
boŞ
 
IsUn™
(cÚ¡ 
EËm’t
 &
a
) const

258 { 
	gm_domaš
.
IsUn™
(
m_domaš
.
Gcd
(
a
, 
m_modulus
));}

260 cÚ¡ 
	gEËm’t
& 
MuÉliÿtiveId’t™y
() const

261 { 
	gm_domaš
.
MuÉliÿtiveId’t™y
();}

263 cÚ¡ 
	gEËm’t
& 
MuÉly
(cÚ¡ 
EËm’t
 &
a
, cÚ¡ EËm’ˆ&
b
) const

264 { 
	gm_domaš
.
Mod
(
m_domaš
.
MuÉly
(
a
, 
b
), 
m_modulus
);}

266 cÚ¡ 
	gEËm’t
& 
Squ¬e
(cÚ¡ 
EËm’t
 &
a
) const

267 { 
	gm_domaš
.
Mod
(
m_domaš
.
Squ¬e
(
a
), 
m_modulus
);}

269 cÚ¡ 
	gEËm’t
& 
MuÉliÿtiveInv”£
(cÚ¡ 
EËm’t
 &
a
) const;

271 
boŞ
 
	gİ”©Ü
==(cÚ¡ 
QuÙ›ÁRšg
<
T
> &
rhs
) const

272 { 
m_domaš
 =ğ
rhs
.m_domaš && 
m_modulus
 ==„hs.m_modulus;}

274 
	g´Ùeùed
:

275 
Euşid—nDomaš
 
m_domaš
;

276 
EËm’t
 
	gm_modulus
;

279 
	gNAMESPACE_END


281 #ifdeà
CRYPTOPP_MANUALLY_INSTANTIATE_TEMPLATES


282 
	~"®geb¿.ıp
"

	@algparam.cpp

3 
	~"pch.h
"

5 #iâdeà
CRYPTOPP_IMPORTS


7 
	~"®g·¿m.h
"

9 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

11 
PAssignIÁToIÁeg”
 
g_pAssignIÁToIÁeg”
 = 
NULL
;

13 
boŞ
 
CombšedNameV®uePaœs
::
	$G‘VoidV®ue
(cÚ¡ *
Çme
, cÚ¡ 
¡d
::
ty³_šfo
 &
v®ueTy³
, *
pV®ue
) const

15 ià(
	`¡rcmp
(
Çme
, "ValueNames") == 0)

16  
m_·œs1
.
	`G‘VoidV®ue
(
Çme
, 
v®ueTy³
, 
pV®ue
è&& 
m_·œs2
.GetVoidValue(name, valueType,…Value);

18  
m_·œs1
.
	`G‘VoidV®ue
(
Çme
, 
v®ueTy³
, 
pV®ue
è|| 
m_·œs2
.GetVoidValue(name, valueType,…Value);

19 
	}
}

21 
	gAlgÜ™hmP¬am‘”sBa£
::
İ”©Ü
=(cÚ¡ 
AlgÜ™hmP¬am‘”sBa£
& 
rhs
)

23 
as£¹
(
çl£
);

26 
boŞ
 
	gAlgÜ™hmP¬am‘”sBa£
::
	$G‘VoidV®ue
(cÚ¡ *
Çme
, cÚ¡ 
¡d
::
ty³_šfo
 &
v®ueTy³
, *
pV®ue
) const

28 ià(
	`¡rcmp
(
Çme
, "ValueNames") == 0)

30 
NameV®uePaœs
::
	`ThrowIfTy³Mism©ch
(
Çme
, 
	`ty³id
(
¡d
::
¡ršg
), 
v®ueTy³
);

31 ià(
m_Ãxt
.
	`g‘
())

32 
m_Ãxt
->
	`G‘VoidV®ue
(
Çme
, 
v®ueTy³
, 
pV®ue
);

33 (*
»š‹½»t_ÿ¡
<
¡d
::
¡ršg
 *>(
pV®ue
è+ğ
m_Çme
) += ";";

34  
Œue
;

36 ià(
	`¡rcmp
(
Çme
, 
m_Çme
) == 0)

38 
	`AssignV®ue
(
Çme
, 
v®ueTy³
, 
pV®ue
);

39 
m_u£d
 = 
Œue
;

40  
Œue
;

42 ià(
m_Ãxt
.
	`g‘
())

43  
m_Ãxt
->
	`G‘VoidV®ue
(
Çme
, 
v®ueTy³
, 
pV®ue
);

45  
çl£
;

46 
	}
}

48 
	gAlgÜ™hmP¬am‘”s
::
	$AlgÜ™hmP¬am‘”s
()

49 : 
	$m_deçuÉThrowIfNÙU£d
(
Œue
)

51 
	}
}

53 
AlgÜ™hmP¬am‘”s
::
	$AlgÜ™hmP¬am‘”s
(cÚ¡ 
AlgÜ™hmP¬am‘”s
 &
x
)

54 : 
	$m_deçuÉThrowIfNÙU£d
(
x
.
m_deçuÉThrowIfNÙU£d
)

56 
m_Ãxt
.
	`»£t
(
cÚ¡_ÿ¡
<
AlgÜ™hmP¬am‘”s
 &>(
x
).m_Ãxt.
	`»Ëa£
());

57 
	}
}

59 
	gAlgÜ™hmP¬am‘”s
 & AlgÜ™hmP¬am‘”s::
İ”©Ü
=(cÚ¡ 
AlgÜ™hmP¬am‘”s
 &
x
)

61 
m_Ãxt
.
»£t
(
cÚ¡_ÿ¡
<
AlgÜ™hmP¬am‘”s
 &>(
x
).m_Ãxt.
»Ëa£
());

62  *
	gthis
;

65 
boŞ
 
	gAlgÜ™hmP¬am‘”s
::
	$G‘VoidV®ue
(cÚ¡ *
Çme
, cÚ¡ 
¡d
::
ty³_šfo
 &
v®ueTy³
, *
pV®ue
) const

67 ià(
m_Ãxt
.
	`g‘
())

68  
m_Ãxt
->
	`G‘VoidV®ue
(
Çme
, 
v®ueTy³
, 
pV®ue
);

70  
çl£
;

71 
	}
}

73 
	gNAMESPACE_END


	@algparam.h

1 #iâdeà
CRYPTOPP_ALGPARAM_H


2 
	#CRYPTOPP_ALGPARAM_H


	)

4 
	~"üy±lib.h
"

5 
	~"sm¬Œ.h
"

6 
	~"£cblock.h
"

8 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

13 şas 
	cCÚ¡By‹A¼ayP¬am‘”


15 
public
:

16 
	$CÚ¡By‹A¼ayP¬am‘”
(cÚ¡ *
d©a
 = 
NULL
, 
boŞ
 
d“pCİy
 = 
çl£
)

18 
	`Assign
((cÚ¡ 
by‹
 *)
d©a
, d©¨? 
	`¡¾’
(d©aè: 0, 
d“pCİy
);

20 
	$CÚ¡By‹A¼ayP¬am‘”
(cÚ¡ 
by‹
 *
d©a
, 
size_t
 
size
, 
boŞ
 
d“pCİy
 = 
çl£
)

22 
	`Assign
(
d©a
, 
size
, 
d“pCİy
);

23 
	}
}

24 
	g‹m¶©e
 <
şass
 
	gT
> 
	$CÚ¡By‹A¼ayP¬am‘”
(cÚ¡ 
T
 &
¡ršg
, 
boŞ
 
d“pCİy
 = 
çl£
)

26 
	`CRYPTOPP_COMPILE_ASSERT
((
CPP_TYPENAME
 
T
::
v®ue_ty³
) == 1);

27 
	`Assign
((cÚ¡ 
by‹
 *)
¡ršg
.
	`d©a
(), sŒšg.
	`size
(), 
d“pCİy
);

28 
	}
}

30 
	$Assign
(cÚ¡ 
by‹
 *
d©a
, 
size_t
 
size
, 
boŞ
 
d“pCİy
)

32 ià(
d“pCİy
)

33 
m_block
.
	`Assign
(
d©a
, 
size
);

36 
m_d©a
 = 
d©a
;

37 
m_size
 = 
size
;

39 
m_d“pCİy
 = 
d“pCİy
;

40 
	}
}

42 cÚ¡ 
by‹
 *
	$begš
(ècÚ¡ { 
m_d“pCİy
 ? 
m_block
.
	`begš
(è: 
m_d©a
;
	}
}

43 cÚ¡ 
by‹
 *
	$’d
(ècÚ¡ { 
m_d“pCİy
 ? 
m_block
.
	`’d
(è: 
m_d©a
 + 
m_size
;
	}
}

44 
size_t
 
	$size
(ècÚ¡ { 
m_d“pCİy
 ? 
m_block
.
	`size
(è: 
m_size
;
	}
}

46 
	g´iv©e
:

47 
boŞ
 
m_d“pCİy
;

48 cÚ¡ 
by‹
 *
	gm_d©a
;

49 
size_t
 
	gm_size
;

50 
SecBy‹Block
 
	gm_block
;

53 şas 
	cBy‹A¼ayP¬am‘”


55 
	mpublic
:

56 
	$By‹A¼ayP¬am‘”
(
by‹
 *
d©a
 = 
NULL
, 
size
 = 0)

57 : 
	`m_d©a
(
d©a
), 
	$m_size
(
size
) {}

58 
	$By‹A¼ayP¬am‘”
(
SecBy‹Block
 &
block
)

59 : 
	`m_d©a
(
block
.
	`begš
()), 
	`m_size
(block.
	$size
()è{
	}
}

61 
by‹
 *
	$begš
(ècÚ¡ { 
m_d©a
;
	}
}

62 
by‹
 *
	$’d
(ècÚ¡ { 
m_d©a
 + 
m_size
;
	}
}

63 
size_t
 
	$size
(ècÚ¡ { 
m_size
;
	}
}

65 
	g´iv©e
:

66 
by‹
 *
m_d©a
;

67 
size_t
 
	gm_size
;

70 şas 
	cCRYPTOPP_DLL
 
	mCombšedNameV®uePaœs
 : 
public
 
NameV®uePaœs


72 
public
:

73 
	$CombšedNameV®uePaœs
(cÚ¡ 
NameV®uePaœs
 &
·œs1
, cÚ¡ NameV®uePaœ &
·œs2
)

74 : 
	`m_·œs1
(
·œs1
), 
	$m_·œs2
(
·œs2
) {}

76 
boŞ
 
	$G‘VoidV®ue
(cÚ¡ *
Çme
, cÚ¡ 
¡d
::
ty³_šfo
 &
v®ueTy³
, *
pV®ue
) const;

78 
´iv©e
:

79 cÚ¡ 
NameV®uePaœs
 &
m_·œs1
, &
m_·œs2
;

80 
	}
};

82 
	g‹m¶©e
 <
şass
 
	gT
, cÏs 
	gBASE
>

83 şas 
	cG‘V®ueH–³rCÏss


85 
	mpublic
:

86 
	$G‘V®ueH–³rCÏss
(cÚ¡ 
T
 *
pObjeù
, cÚ¡ *
Çme
, cÚ¡ 
¡d
::
ty³_šfo
 &
v®ueTy³
, *
pV®ue
, cÚ¡ 
NameV®uePaœs
 *
£¬chFœ¡
)

87 : 
	`m_pObjeù
(
pObjeù
), 
	`m_Çme
(
Çme
), 
	`m_v®ueTy³
(&
v®ueTy³
), 
	`m_pV®ue
(
pV®ue
), 
	`m_found
(
çl£
), 
	$m_g‘V®ueNames
(
çl£
)

89 ià(
	`¡rcmp
(
m_Çme
, "ValueNames") == 0)

91 
m_found
 = 
m_g‘V®ueNames
 = 
Œue
;

92 
NameV®uePaœs
::
	`ThrowIfTy³Mism©ch
(
m_Çme
, 
	`ty³id
(
¡d
::
¡ršg
), *
m_v®ueTy³
);

93 ià(
£¬chFœ¡
)

94 
£¬chFœ¡
->
	`G‘VoidV®ue
(
m_Çme
, 
v®ueTy³
, 
pV®ue
);

95 ià(
	`ty³id
(
T
è!ğty³id(
BASE
))

96 
pObjeù
->
BASE
::
	`G‘VoidV®ue
(
m_Çme
, 
v®ueTy³
, 
pV®ue
);

97 ((*
»š‹½»t_ÿ¡
<
¡d
::
¡ršg
 *>(
m_pV®ue
è+ğ"ThisPoš‹r:"è+ğ
	`ty³id
(
T
).
	`Çme
()) += ';';

100 ià(!
m_found
 && 
	`¡ºcmp
(
m_Çme
, "ThisPoš‹r:", 12è=ğ0 && 
	`¡rcmp
(m_Çme+12, 
	`ty³id
(
T
).
	`Çme
()) == 0)

102 
NameV®uePaœs
::
	`ThrowIfTy³Mism©ch
(
m_Çme
, 
	`ty³id
(
T
 *), *
m_v®ueTy³
);

103 *
»š‹½»t_ÿ¡
<cÚ¡ 
T
 **>(
pV®ue
èğ
pObjeù
;

104 
m_found
 = 
Œue
;

108 ià(!
m_found
 && 
£¬chFœ¡
)

109 
m_found
 = 
£¬chFœ¡
->
	`G‘VoidV®ue
(
m_Çme
, 
v®ueTy³
, 
pV®ue
);

111 ià(!
m_found
 && 
	`ty³id
(
T
è!ğty³id(
BASE
))

112 
m_found
 = 
pObjeù
->
BASE
::
	`G‘VoidV®ue
(
m_Çme
, 
v®ueTy³
, 
pV®ue
);

115 
İ”©Ü
 
	$boŞ
(ècÚ¡ { 
m_found
;
	}
}

117 
	g‹m¶©e
 <
şass
 
	gR
>

118 
	gG‘V®ueH–³rCÏss
<
	gT
,
	gBASE
> & 
	$İ”©Ü
()(cÚ¡ *
Çme
, cÚ¡ 
R
 & (
T
::*
pm
)() const)

120 ià(
m_g‘V®ueNames
)

121 (*
»š‹½»t_ÿ¡
<
¡d
::
¡ršg
 *>(
m_pV®ue
è+ğ
Çme
) += ";";

122 ià(!
m_found
 && 
	`¡rcmp
(
Çme
, 
m_Çme
) == 0)

124 
NameV®uePaœs
::
	`ThrowIfTy³Mism©ch
(
Çme
, 
	`ty³id
(
R
), *
m_v®ueTy³
);

125 *
»š‹½»t_ÿ¡
<
R
 *>(
m_pV®ue
èğ(
m_pObjeù
->*
pm
)();

126 
m_found
 = 
Œue
;

128  *
this
;

129 
	}
}

131 
	gG‘V®ueH–³rCÏss
<
	gT
,
	gBASE
> &
	$AssigÇbË
()

133 #iâdeà
__INTEL_COMPILER


134 ià(
m_g‘V®ueNames
)

135 ((*
»š‹½»t_ÿ¡
<
¡d
::
¡ršg
 *>(
m_pV®ue
è+ğ"ThisObjeù:"è+ğ
	`ty³id
(
T
).
	`Çme
()) += ';';

136 ià(!
m_found
 && 
	`¡ºcmp
(
m_Çme
, "ThisObjeù:", 11è=ğ0 && 
	`¡rcmp
(m_Çme+11, 
	`ty³id
(
T
).
	`Çme
()) == 0)

138 
NameV®uePaœs
::
	`ThrowIfTy³Mism©ch
(
m_Çme
, 
	`ty³id
(
T
), *
m_v®ueTy³
);

139 *
»š‹½»t_ÿ¡
<
T
 *>(
m_pV®ue
èğ*
m_pObjeù
;

140 
m_found
 = 
Œue
;

143  *
this
;

144 
	}
}

146 
	g´iv©e
:

147 cÚ¡ 
T
 *
m_pObjeù
;

148 cÚ¡ *
	gm_Çme
;

149 cÚ¡ 
	g¡d
::
ty³_šfo
 *
m_v®ueTy³
;

150 *
	gm_pV®ue
;

151 
boŞ
 
	gm_found
, 
	gm_g‘V®ueNames
;

154 
	g‹m¶©e
 <
şass
 
	gBASE
, cÏs 
	gT
>

155 
	gG‘V®ueH–³rCÏss
<
	gT
, 
	gBASE
> 
	$G‘V®ueH–³r
(cÚ¡ 
T
 *
pObjeù
, cÚ¡ *
Çme
, cÚ¡ 
¡d
::
ty³_šfo
 &
v®ueTy³
, *
pV®ue
, cÚ¡ 
NameV®uePaœs
 *
£¬chFœ¡
=
NULL
, 
BASE
 *
dummy
=NULL)

157  
G‘V®ueH–³rCÏss
<
T
, 
BASE
>(
pObjeù
, 
Çme
, 
v®ueTy³
, 
pV®ue
, 
£¬chFœ¡
);

158 
	}
}

160 
	g‹m¶©e
 <
şass
 
	gT
>

161 
	gG‘V®ueH–³rCÏss
<
	gT
, T> 
	$G‘V®ueH–³r
(cÚ¡ 
T
 *
pObjeù
, cÚ¡ *
Çme
, cÚ¡ 
¡d
::
ty³_šfo
 &
v®ueTy³
, *
pV®ue
, cÚ¡ 
NameV®uePaœs
 *
£¬chFœ¡
=
NULL
)

163  
G‘V®ueH–³rCÏss
<
T
, T>(
pObjeù
, 
Çme
, 
v®ueTy³
, 
pV®ue
, 
£¬chFœ¡
);

164 
	}
}

168 
	g‹m¶©e
 <
şass
 
	gR
>

169 
R
 
	$Hack_DeçuÉV®ueFromCÚ¡Reã»nûTy³
(cÚ¡ 
R
 &)

171  
	`R
();

172 
	}
}

174 
	g‹m¶©e
 <
şass
 
	gR
>

175 
boŞ
 
	$Hack_G‘V®ueIÁoCÚ¡Reã»nû
(cÚ¡ 
NameV®uePaœs
 &
sourû
, cÚ¡ *
Çme
, cÚ¡ 
R
 &
v®ue
)

177  
sourû
.
	`G‘V®ue
(
Çme
, 
cÚ¡_ÿ¡
<
R
 &>(
v®ue
));

178 
	}
}

180 
	g‹m¶©e
 <
şass
 
	gT
, cÏs 
	gBASE
>

181 şas 
	cAssignFromH–³rCÏss


183 
	mpublic
:

184 
	$AssignFromH–³rCÏss
(
T
 *
pObjeù
, cÚ¡ 
NameV®uePaœs
 &
sourû
)

185 : 
	`m_pObjeù
(
pObjeù
), 
	`m_sourû
(
sourû
), 
	$m_dÚe
(
çl£
)

187 ià(
sourû
.
	`G‘ThisObjeù
(*
pObjeù
))

188 
m_dÚe
 = 
Œue
;

189 ià(
	`ty³id
(
BASE
è!ğty³id(
T
))

190 
pObjeù
->
BASE
::
	`AssignFrom
(
sourû
);

193 
‹m¶©e
 <
şass
 
R
>

194 
AssignFromH–³rCÏss
 & 
	$İ”©Ü
()(cÚ¡ *
Çme
, (
T
::*
pm
)(
R
))

196 ià(!
m_dÚe
)

198 
R
 
v®ue
 = 
	`Hack_DeçuÉV®ueFromCÚ¡Reã»nûTy³
(
»š‹½»t_ÿ¡
<R>(*(*)
NULL
));

199 ià(!
	`Hack_G‘V®ueIÁoCÚ¡Reã»nû
(
m_sourû
, 
Çme
, 
v®ue
))

200 
throw
 
	`Inv®idArgum’t
(
¡d
::
	`¡ršg
(
	`ty³id
(
T
).
	`Çme
()è+ ": Missšg„equœed…¬am‘” '" + 
Çme
 + "'");

201 (
m_pObjeù
->*
pm
)(
v®ue
);

203  *
this
;

204 
	}
}

206 
	g‹m¶©e
 <
şass
 
	gR
, cÏs 
	gS
>

207 
	gAssignFromH–³rCÏss
 & 
	$İ”©Ü
()(cÚ¡ *
Çme1
, cÚ¡ *
Çme2
, (
T
::*
pm
)(
R
, 
S
))

209 ià(!
m_dÚe
)

211 
R
 
v®ue1
 = 
	`Hack_DeçuÉV®ueFromCÚ¡Reã»nûTy³
(
»š‹½»t_ÿ¡
<R>(*(*)
NULL
));

212 ià(!
	`Hack_G‘V®ueIÁoCÚ¡Reã»nû
(
m_sourû
, 
Çme1
, 
v®ue1
))

213 
throw
 
	`Inv®idArgum’t
(
¡d
::
	`¡ršg
(
	`ty³id
(
T
).
	`Çme
()è+ ": Missšg„equœed…¬am‘” '" + 
Çme1
 + "'");

214 
S
 
v®ue2
 = 
	`Hack_DeçuÉV®ueFromCÚ¡Reã»nûTy³
(
»š‹½»t_ÿ¡
<S>(*(*)
NULL
));

215 ià(!
	`Hack_G‘V®ueIÁoCÚ¡Reã»nû
(
m_sourû
, 
Çme2
, 
v®ue2
))

216 
throw
 
	`Inv®idArgum’t
(
¡d
::
	`¡ršg
(
	`ty³id
(
T
).
	`Çme
()è+ ": Missšg„equœed…¬am‘” '" + 
Çme2
 + "'");

217 (
m_pObjeù
->*
pm
)(
v®ue1
, 
v®ue2
);

219  *
this
;

220 
	}
}

222 
	g´iv©e
:

223 
T
 *
m_pObjeù
;

224 cÚ¡ 
	gNameV®uePaœs
 &
	gm_sourû
;

225 
boŞ
 
	gm_dÚe
;

228 
	g‹m¶©e
 <
şass
 
	gBASE
, cÏs 
	gT
>

229 
	gAssignFromH–³rCÏss
<
	gT
, 
	gBASE
> 
	$AssignFromH–³r
(
T
 *
pObjeù
, cÚ¡ 
NameV®uePaœs
 &
sourû
, 
BASE
 *
dummy
=
NULL
)

231  
AssignFromH–³rCÏss
<
T
, 
BASE
>(
pObjeù
, 
sourû
);

232 
	}
}

234 
	g‹m¶©e
 <
şass
 
	gT
>

235 
	gAssignFromH–³rCÏss
<
	gT
, T> 
	$AssignFromH–³r
(
T
 *
pObjeù
, cÚ¡ 
NameV®uePaœs
 &
sourû
)

237  
AssignFromH–³rCÏss
<
T
, T>(
pObjeù
, 
sourû
);

238 
	}
}

243 
	$boŞ
 (
	tCRYPTOPP_API
 * 
	tPAssignIÁToIÁeg”
)(cÚ¡ 
	t¡d
::
	tty³_šfo
 &
	tv®ueTy³
, *
	tpIÁeg”
, cÚ¡ *
	tpIÁ
);

244 
CRYPTOPP_DLL
 
PAssignIÁToIÁeg”
 
g_pAssignIÁToIÁeg”
;

246 
CRYPTOPP_DLL
 cÚ¡ 
¡d
::
ty³_šfo
 & 
CRYPTOPP_API
 
	`IÁeg”Ty³Id
();

248 şas 
	cCRYPTOPP_DLL
 
AlgÜ™hmP¬am‘”sBa£


250 
public
:

251 şas 
	cP¬am‘”NÙU£d
 : 
public
 
Exû±iÚ


253 
public
:

254 
	`P¬am‘”NÙU£d
(cÚ¡ *
Çme
è: 
	`Exû±iÚ
(
OTHER_ERROR
, 
¡d
::
	`¡ršg
("AlgorithmParametersBase:…arameter \"") +‚ame + "\"‚ot used") {}

258 
	$AlgÜ™hmP¬am‘”sBa£
(cÚ¡ 
AlgÜ™hmP¬am‘”sBa£
 &
x
)

259 : 
	`m_Çme
(
x
.
m_Çme
), 
	`m_throwIfNÙU£d
(x.
m_throwIfNÙU£d
), 
	$m_u£d
(
x
.
m_u£d
)

261 
m_Ãxt
.
	`»£t
(
cÚ¡_ÿ¡
<
AlgÜ™hmP¬am‘”sBa£
 &>(
x
).m_Ãxt.
	`»Ëa£
());

262 
x
.
m_u£d
 = 
Œue
;

263 
	}
}

265 
	$AlgÜ™hmP¬am‘”sBa£
(cÚ¡ *
Çme
, 
boŞ
 
throwIfNÙU£d
)

266 : 
	`m_Çme
(
Çme
), 
	`m_throwIfNÙU£d
(
throwIfNÙU£d
), 
	$m_u£d
(
çl£
è{
	}
}

268 
	gvœtu®
 ~
	$AlgÜ™hmP¬am‘”sBa£
()

270 #ifdeà
CRYPTOPP_UNCAUGHT_EXCEPTION_AVAILABLE


271 ià(!
¡d
::
	`unÿught_exû±iÚ
())

273 
Œy


276 ià(
m_throwIfNÙU£d
 && !
m_u£d
)

277 
throw
 
	`P¬am‘”NÙU£d
(
m_Çme
);

279 #iâdeà
CRYPTOPP_UNCAUGHT_EXCEPTION_AVAILABLE


280 
	`ÿtch
(...)

284 
	}
}

286 
boŞ
 
	$G‘VoidV®ue
(cÚ¡ *
Çme
, cÚ¡ 
¡d
::
ty³_šfo
 &
v®ueTy³
, *
pV®ue
) const;

288 
´Ùeùed
:

289 
ä›nd
 
şass
 
AlgÜ™hmP¬am‘”s
;

290 
İ”©Ü
=(cÚ¡ 
AlgÜ™hmP¬am‘”sBa£
& 
rhs
);

292 
vœtu®
 
	$AssignV®ue
(cÚ¡ *
Çme
, cÚ¡ 
¡d
::
ty³_šfo
 &
v®ueTy³
, *
pV®ue
) const =0;

293 
vœtu®
 
	$MoveIÁo
(*
p
) const =0;

295 cÚ¡ *
m_Çme
;

296 
boŞ
 
m_throwIfNÙU£d
;

297 
mubË
 
boŞ
 
m_u£d
;

298 
memb”_±r
<
AlgÜ™hmP¬am‘”sBa£
> 
m_Ãxt
;

299 
	}
};

301 
	g‹m¶©e
 <
şass
 
	gT
>

302 şas 
	cAlgÜ™hmP¬am‘”sTem¶©e
 : 
public
 
AlgÜ™hmP¬am‘”sBa£


304 
public
:

305 
	$AlgÜ™hmP¬am‘”sTem¶©e
(cÚ¡ *
Çme
, cÚ¡ 
T
 &
v®ue
, 
boŞ
 
throwIfNÙU£d
)

306 : 
	`AlgÜ™hmP¬am‘”sBa£
(
Çme
, 
throwIfNÙU£d
), 
	$m_v®ue
(
v®ue
)

310 
	$AssignV®ue
(cÚ¡ *
Çme
, cÚ¡ 
¡d
::
ty³_šfo
 &
v®ueTy³
, *
pV®ue
) const

313 ià(!(
g_pAssignIÁToIÁeg”
 !ğ
NULL
 && 
	`ty³id
(
T
è=ğty³id(è&& 
	`g_pAssignIÁToIÁeg”
(
v®ueTy³
, 
pV®ue
, &
m_v®ue
)))

315 
NameV®uePaœs
::
	`ThrowIfTy³Mism©ch
(
Çme
, 
	`ty³id
(
T
), 
v®ueTy³
);

316 *
»š‹½»t_ÿ¡
<
T
 *>(
pV®ue
èğ
m_v®ue
;

318 
	}
}

320 
	$MoveIÁo
(*
bufãr
) const

322 
AlgÜ™hmP¬am‘”sTem¶©e
<
T
>* 
p
 = 
	`Ãw
(
bufãr
èAlgÜ™hmP¬am‘”sTem¶©e<T>(*
this
);

323 
	}
}

325 
	g´Ùeùed
:

326 
T
 
m_v®ue
;

329 
CRYPTOPP_DLL_TEMPLATE_CLASS
 
	gAlgÜ™hmP¬am‘”sTem¶©e
<
	gboŞ
>;

330 
CRYPTOPP_DLL_TEMPLATE_CLASS
 
	gAlgÜ™hmP¬am‘”sTem¶©e
<>;

331 
CRYPTOPP_DLL_TEMPLATE_CLASS
 
	gAlgÜ™hmP¬am‘”sTem¶©e
<
	gCÚ¡By‹A¼ayP¬am‘”
>;

333 şas 
	cCRYPTOPP_DLL
 
	mAlgÜ™hmP¬am‘”s
 : 
public
 
NameV®uePaœs


335 
public
:

336 
AlgÜ™hmP¬am‘”s
();

338 #ifdeà
__BORLANDC__


339 
	m‹m¶©e
 <
şass
 
	mT
>

340 
	$AlgÜ™hmP¬am‘”s
(cÚ¡ *
Çme
, cÚ¡ 
T
 &
v®ue
, 
boŞ
 
throwIfNÙU£d
=
Œue
)

341 : 
	`m_Ãxt
(
Ãw
 
AlgÜ™hmP¬am‘”sTem¶©e
<
T
>(
Çme
, 
v®ue
, 
throwIfNÙU£d
))

342 , 
	$m_deçuÉThrowIfNÙU£d
(
throwIfNÙU£d
)

347 
	`AlgÜ™hmP¬am‘”s
(cÚ¡ 
AlgÜ™hmP¬am‘”s
 &
x
);

349 
AlgÜ™hmP¬am‘”s
 & 
İ”©Ü
=(cÚ¡ AlgÜ™hmP¬am‘” &
x
);

351 
‹m¶©e
 <
şass
 
T
>

352 
AlgÜ™hmP¬am‘”s
 & 
	$İ”©Ü
()(cÚ¡ *
Çme
, cÚ¡ 
T
 &
v®ue
, 
boŞ
 
throwIfNÙU£d
)

354 
memb”_±r
<
AlgÜ™hmP¬am‘”sBa£
> 
	`p
(
Ãw
 
AlgÜ™hmP¬am‘”sTem¶©e
<
T
>(
Çme
, 
v®ue
, 
throwIfNÙU£d
));

355 
p
->
m_Ãxt
.
	`»£t
(m_Ãxt.
	`»Ëa£
());

356 
m_Ãxt
.
	`»£t
(
p
.
	`»Ëa£
());

357 
m_deçuÉThrowIfNÙU£d
 = 
throwIfNÙU£d
;

358  *
this
;

359 
	}
}

361 
	g‹m¶©e
 <
şass
 
	gT
>

362 
	gAlgÜ™hmP¬am‘”s
 & 
	$İ”©Ü
()(cÚ¡ *
Çme
, cÚ¡ 
T
 &
v®ue
)

364  
	`İ”©Ü
()(
Çme
, 
v®ue
, 
m_deçuÉThrowIfNÙU£d
);

365 
	}
}

367 
boŞ
 
	$G‘VoidV®ue
(cÚ¡ *
Çme
, cÚ¡ 
¡d
::
ty³_šfo
 &
v®ueTy³
, *
pV®ue
) const;

369 
´Ùeùed
:

370 
memb”_±r
<
AlgÜ™hmP¬am‘”sBa£
> 
m_Ãxt
;

371 
boŞ
 
m_deçuÉThrowIfNÙU£d
;

372 
	}
};

382 #ifdeà
__BORLANDC__


383 
AlgÜ™hmP¬am‘”s
 
	tMakeP¬am‘”s
;

385 
	g‹m¶©e
 <
şass
 
	gT
>

386 
AlgÜ™hmP¬am‘”s
 
	$MakeP¬am‘”s
(cÚ¡ *
Çme
, cÚ¡ 
T
 &
v®ue
, 
boŞ
 
throwIfNÙU£d
 = 
Œue
)

388  
	`AlgÜ™hmP¬am‘”s
()(
Çme
, 
v®ue
, 
throwIfNÙU£d
);

389 
	}
}

392 
	#CRYPTOPP_GET_FUNCTION_ENTRY
(
Çme
è(
Name
::
	`Çme
(), &
ThisCÏss
::
G‘
##Çme)

	)

393 
	#CRYPTOPP_SET_FUNCTION_ENTRY
(
Çme
è(
Name
::
	`Çme
(), &
ThisCÏss
::
S‘
##Çme)

	)

394 
	#CRYPTOPP_SET_FUNCTION_ENTRY2
(
Çme1
, 
Çme2
è(
Name
::
	`Çme1
(), Name::
	`Çme2
(), &
ThisCÏss
::
S‘
##Çme1##
And
##Çme2)

	)

396 
	gNAMESPACE_END


	@arc4.cpp

9 
	~"pch.h
"

10 
	#CRYPTOPP_ENABLE_NAMESPACE_WEAK
 1

	)

11 
	~"¬c4.h
"

13 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

14 
Çme¥aû
 
W—k1
 {

16 
	`ARC4_Te¡In¡ªtŸtiÚs
()

18 
ARC4
 
x
;

21 
ARC4_Ba£
::~
	`ARC4_Ba£
()

23 
m_x
 = 
m_y
 = 0;

26 
ARC4_Ba£
::
	`UncheckedS‘Key
(cÚ¡ 
by‹
 *
key
, 
keyL’
, cÚ¡ 
NameV®uePaœs
 &
·¿ms
)

28 
	`As£¹V®idKeyL’gth
(
keyL’
);

30 
m_x
 = 1;

31 
m_y
 = 0;

33 
i
;

34 
i
=0; i<256; i++)

35 
m_¡©e
[
i
] = i;

37 
keyIndex
 = 0, 
¡©eIndex
 = 0;

38 
i
=0; i<256; i++)

40 
a
 = 
m_¡©e
[
i
];

41 
¡©eIndex
 +ğ
key
[
keyIndex
] + 
a
;

42 
¡©eIndex
 &= 0xff;

43 
m_¡©e
[
i
] = m_¡©e[
¡©eIndex
];

44 
m_¡©e
[
¡©eIndex
] = 
a
;

45 ià(++
keyIndex
 >ğ
keyL’
)

46 
keyIndex
 = 0;

49 
disÿrdBy‹s
 = 
·¿ms
.
	`G‘IÁV®ueW™hDeçuÉ
("DisÿrdBy‹s", 
	`G‘DeçuÉDisÿrdBy‹s
());

50 
	`DisÿrdBy‹s
(
disÿrdBy‹s
);

53 
‹m¶©e
 <
şass
 
T
>

54 
šlše
 
	`MakeBy‹
(
T
 &
x
, T &
y
, 
by‹
 *
s
)

56 
a
 = 
s
[
x
];

57 
y
 = (y+
a
) & 0xff;

58 
b
 = 
s
[
y
];

59 
s
[
x
] = 
b
;

60 
s
[
y
] = 
a
;

61 
x
 = (x+1) & 0xff;

62  
s
[(
a
+
b
) & 0xff];

65 
ARC4_Ba£
::
	`G’”©eBlock
(
by‹
 *
ouut
, 
size_t
 
size
)

67 
size
--)

68 *
ouut
++ = 
	`MakeBy‹
(
m_x
, 
m_y
, 
m_¡©e
);

71 
ARC4_Ba£
::
	`ProûssD©a
(
by‹
 *
outSŒšg
, cÚ¡ by‹ *
šSŒšg
, 
size_t
 
Ëngth
)

73 ià(
Ëngth
 == 0)

76 
by‹
 *cÚ¡ 
s
 = 
m_¡©e
;

77 
x
 = 
m_x
;

78 
y
 = 
m_y
;

80 ià(
šSŒšg
 =ğ
outSŒšg
)

84 *
outSŒšg
++ ^ğ
	`MakeBy‹
(
x
, 
y
, 
s
);

85 } --
Ëngth
);

91 *
outSŒšg
++ = *
šSŒšg
++ ^ 
	`MakeBy‹
(
x
, 
y
, 
s
);

93 --
Ëngth
);

96 
m_x
 = 
x
;

97 
m_y
 = 
y
;

100 
ARC4_Ba£
::
	`DisÿrdBy‹s
(
size_t
 
Ëngth
)

102 ià(
Ëngth
 == 0)

105 
by‹
 *cÚ¡ 
s
 = 
m_¡©e
;

106 
x
 = 
m_x
;

107 
y
 = 
m_y
;

111 
	`MakeBy‹
(
x
, 
y
, 
s
);

113 --
Ëngth
);

115 
m_x
 = 
x
;

116 
m_y
 = 
y
;

119 
	}
}

120 
	gNAMESPACE_END


	@arc4.h

1 #iâdeà
CRYPTOPP_ARC4_H


2 
	#CRYPTOPP_ARC4_H


	)

4 
	~"¡rchr.h
"

6 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

8 
Çme¥aû
 
W—k1
 {

11 
şass
 
CRYPTOPP_NO_VTABLE
 
ARC4_Ba£
 : 
public
 
V¬ŸbËKeyL’gth
<16, 1, 256>,…ubliø
RªdomNumb”G’”©Ü
,…ubliø
Symm‘ricCh”
,…ubliø
Symm‘ricCh”Docum’tiÚ


13 
public
:

14 ~
	`ARC4_Ba£
();

16 cÚ¡ *
	`SticAlgÜ™hmName
() { "ARC4";}

18 
	`G’”©eBlock
(
by‹
 *
ouut
, 
size_t
 
size
);

19 
	`DisÿrdBy‹s
(
size_t
 
n
);

21 
	`ProûssD©a
(
by‹
 *
outSŒšg
, cÚ¡ by‹ *
šSŒšg
, 
size_t
 
Ëngth
);

23 
boŞ
 
	`IsRªdomAcûss
(ècÚ¡ { 
çl£
;}

24 
boŞ
 
	`IsS–fInv”tšg
(ècÚ¡ { 
Œue
;}

25 
boŞ
 
	`IsFÜw¬dT¿nsfÜm©iÚ
(ècÚ¡ { 
Œue
;}

27 
Symm‘ricCh”Fš®
<
	tARC4_Ba£
> 
	tEnüy±iÚ
;

28 
Symm‘ricCh”Fš®
<
	tARC4_Ba£
> 
	tDeüy±iÚ
;

30 
´Ùeùed
:

31 
	`UncheckedS‘Key
(cÚ¡ 
by‹
 *
key
, 
Ëngth
, cÚ¡ 
NameV®uePaœs
 &
·¿ms
);

32 
vœtu®
 
	`G‘DeçuÉDisÿrdBy‹s
() const { 0;}

34 
FixedSizeSecBlock
<
by‹
, 256> 
m_¡©e
;

35 
by‹
 
m_x
, 
m_y
;

39 
	`DOCUMENTED_TYPEDEF
(
Symm‘ricCh”Fš®
<
ARC4_Ba£
>, 
ARC4
)

42 şas 
	cCRYPTOPP_NO_VTABLE
 
MARC4_Ba£
 : 
public
 
ARC4_Ba£


44 
public
:

45 cÚ¡ *
	`SticAlgÜ™hmName
() { "MARC4";}

47 
Symm‘ricCh”Fš®
<
	tMARC4_Ba£
> 
	tEnüy±iÚ
;

48 
Symm‘ricCh”Fš®
<
	tMARC4_Ba£
> 
	tDeüy±iÚ
;

50 
´Ùeùed
:

51 
	`G‘DeçuÉDisÿrdBy‹s
() const { 256;}

52 
	}
};

55 
DOCUMENTED_TYPEDEF
(
Symm‘ricCh”Fš®
<
MARC4_Ba£
>, 
MARC4
)

58 #ià
CRYPTOPP_ENABLE_NAMESPACE_WEAK
 >= 1

59 
Çme¥aû
 
	gW—k
 {
usšg
‚ame¥aû 
	gW—k1
;}

61 
usšg
 
Çme¥aû
 
	gW—k1
;

62 #ifdeà
__GNUC__


65 #´agm¨
mes§ge
("You may be using‡ weak‡lgorithmhat has been„etained for backwards compatibility. Please '#define CRYPTOPP_ENABLE_NAMESPACE_WEAK 1' before includinghis .h file‡nd…rependhe class‚ame with 'Weak::'o„emovehis warning.")

69 
	gNAMESPACE_END


	@argnames.h

1 #iâdeà
CRYPTOPP_ARGNAMES_H


2 
	#CRYPTOPP_ARGNAMES_H


	)

4 
	~"üy±lib.h
"

6 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

8 
	$DOCUMENTED_NAMESPACE_BEGIN
(
Name
)

10 
	#CRYPTOPP_DEFINE_NAME_STRING
(
Çme
è
šlše
 cÚ¡ *
	`Çme
(è{ #Çme;
	}

	)
}

12 
	$CRYPTOPP_DEFINE_NAME_STRING
(
V®ueNames
)

13 
	$CRYPTOPP_DEFINE_NAME_STRING
(
V”siÚ
)

14 
	$CRYPTOPP_DEFINE_NAME_STRING
(
S“d
)

15 
	$CRYPTOPP_DEFINE_NAME_STRING
(
Key
)

16 
	$CRYPTOPP_DEFINE_NAME_STRING
(
IV
)

17 
	$CRYPTOPP_DEFINE_NAME_STRING
(
StŞ’IV
)

18 
	$CRYPTOPP_DEFINE_NAME_STRING
(
Rounds
)

19 
	$CRYPTOPP_DEFINE_NAME_STRING
(
F“dbackSize
)

20 
	$CRYPTOPP_DEFINE_NAME_STRING
(
WÜdSize
)

21 
	$CRYPTOPP_DEFINE_NAME_STRING
(
BlockSize
)

22 
	$CRYPTOPP_DEFINE_NAME_STRING
(
EfãùiveKeyL’gth
)

23 
	$CRYPTOPP_DEFINE_NAME_STRING
(
KeySize
)

24 
	$CRYPTOPP_DEFINE_NAME_STRING
(
ModulusSize
)

25 
	$CRYPTOPP_DEFINE_NAME_STRING
(
SubgroupOrd”Size
)

26 
	$CRYPTOPP_DEFINE_NAME_STRING
(
Priv©eExpÚ’tSize
)

27 
	$CRYPTOPP_DEFINE_NAME_STRING
(
Modulus
)

28 
	$CRYPTOPP_DEFINE_NAME_STRING
(
PublicExpÚ’t
)

29 
	$CRYPTOPP_DEFINE_NAME_STRING
(
Priv©eExpÚ’t
)

30 
	$CRYPTOPP_DEFINE_NAME_STRING
(
PublicEËm’t
)

31 
	$CRYPTOPP_DEFINE_NAME_STRING
(
SubgroupOrd”
)

32 
	$CRYPTOPP_DEFINE_NAME_STRING
(
CoçùÜ
)

33 
	$CRYPTOPP_DEFINE_NAME_STRING
(
SubgroupG’”©Ü
)

34 
	$CRYPTOPP_DEFINE_NAME_STRING
(
Curve
)

35 
	$CRYPTOPP_DEFINE_NAME_STRING
(
GroupOID
)

36 
	$CRYPTOPP_DEFINE_NAME_STRING
(
Poš‹rToPrimeS–eùÜ
)

37 
	$CRYPTOPP_DEFINE_NAME_STRING
(
Prime1
)

38 
	$CRYPTOPP_DEFINE_NAME_STRING
(
Prime2
)

39 
	$CRYPTOPP_DEFINE_NAME_STRING
(
ModPrime1Priv©eExpÚ’t
)

40 
	$CRYPTOPP_DEFINE_NAME_STRING
(
ModPrime2Priv©eExpÚ’t
)

41 
	$CRYPTOPP_DEFINE_NAME_STRING
(
MuÉliÿtiveInv”£OfPrime2ModPrime1
)

42 
	$CRYPTOPP_DEFINE_NAME_STRING
(
Quad¿ticResidueModPrime1
)

43 
	$CRYPTOPP_DEFINE_NAME_STRING
(
Quad¿ticResidueModPrime2
)

44 
	$CRYPTOPP_DEFINE_NAME_STRING
(
PutMes§ge
)

45 
	$CRYPTOPP_DEFINE_NAME_STRING
(
Trunÿ‹dDige¡Size
)

46 
	$CRYPTOPP_DEFINE_NAME_STRING
(
BlockPaddšgScheme
)

47 
	$CRYPTOPP_DEFINE_NAME_STRING
(
HashV”ifiÿtiÚF‹rFÏgs
)

48 
	$CRYPTOPP_DEFINE_NAME_STRING
(
Auth’tiÿ‹dDeüy±iÚF‹rFÏgs
)

49 
	$CRYPTOPP_DEFINE_NAME_STRING
(
SigÇtu»V”ifiÿtiÚF‹rFÏgs
)

50 
	$CRYPTOPP_DEFINE_NAME_STRING
(
IÅutBufãr
)

51 
	$CRYPTOPP_DEFINE_NAME_STRING
(
OuutBufãr
)

52 
	$CRYPTOPP_DEFINE_NAME_STRING
(
IÅutFeName
)

53 
	$CRYPTOPP_DEFINE_NAME_STRING
(
IÅutFeNameWide
)

54 
	$CRYPTOPP_DEFINE_NAME_STRING
(
IÅutSŒ—mPoš‹r
)

55 
	$CRYPTOPP_DEFINE_NAME_STRING
(
IÅutBš¬yMode
)

56 
	$CRYPTOPP_DEFINE_NAME_STRING
(
OuutFeName
)

57 
	$CRYPTOPP_DEFINE_NAME_STRING
(
OuutFeNameWide
)

58 
	$CRYPTOPP_DEFINE_NAME_STRING
(
OuutSŒ—mPoš‹r
)

59 
	$CRYPTOPP_DEFINE_NAME_STRING
(
OuutBš¬yMode
)

60 
	$CRYPTOPP_DEFINE_NAME_STRING
(
EncodšgP¬am‘”s
)

61 
	$CRYPTOPP_DEFINE_NAME_STRING
(
KeyD”iv©iÚP¬am‘”s
)

62 
	$CRYPTOPP_DEFINE_NAME_STRING
(
S•¬©Ü
)

63 
	$CRYPTOPP_DEFINE_NAME_STRING
(
T”mš©Ü
)

64 
	$CRYPTOPP_DEFINE_NAME_STRING
(
Uµ”ÿ£
)

65 
	$CRYPTOPP_DEFINE_NAME_STRING
(
GroupSize
)

66 
	$CRYPTOPP_DEFINE_NAME_STRING
(
Pad
)

67 
	$CRYPTOPP_DEFINE_NAME_STRING
(
PaddšgBy‹
)

68 
	$CRYPTOPP_DEFINE_NAME_STRING
(
Log2Ba£
)

69 
	$CRYPTOPP_DEFINE_NAME_STRING
(
EncodšgLookupA¼ay
)

70 
	$CRYPTOPP_DEFINE_NAME_STRING
(
DecodšgLookupA¼ay
)

71 
	$CRYPTOPP_DEFINE_NAME_STRING
(
In£¹LšeB»aks
)

72 
	$CRYPTOPP_DEFINE_NAME_STRING
(
MaxLšeL’gth
)

73 
	$CRYPTOPP_DEFINE_NAME_STRING
(
Dige¡Size
)

74 
	$CRYPTOPP_DEFINE_NAME_STRING
(
L1KeyL’gth
)

75 
	$CRYPTOPP_DEFINE_NAME_STRING
(
TabËSize
)

77 
DOCUMENTED_NAMESPACE_END


79 
NAMESPACE_END


	@asn.cpp

3 
	~"pch.h
"

5 #iâdeà
CRYPTOPP_IMPORTS


7 
	~"a¢.h
"

9 
	~<iomª
>

10 
	~<time.h
>

12 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

13 
	$USING_NAMESPACE
(
¡d
)

16 
size_t
 
	$DERL’gthEncode
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
, 
lwÜd
 
Ëngth
)

18 
size_t
 
i
=0;

19 ià(
Ëngth
 <= 0x7f)

21 
bt
.
	`Put
(
	`by‹
(
Ëngth
));

22 
i
++;

26 
bt
.
	`Put
(
	`by‹
(
	`By‹P»cisiÚ
(
Ëngth
) | 0x80));

27 
i
++;

28 
j
=
	`By‹P»cisiÚ
(
Ëngth
); j; --j)

30 
bt
.
	`Put
(
	`by‹
(
Ëngth
 >> (
j
-1)*8));

31 
i
++;

34  
i
;

35 
	}
}

37 
boŞ
 
	$BERL’gthDecode
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
, 
lwÜd
 &
Ëngth
, 
boŞ
 &
defš™eL’gth
)

39 
by‹
 
b
;

41 ià(!
bt
.
	`G‘
(
b
))

42  
çl£
;

44 ià(!(
b
 & 0x80))

46 
defš™eL’gth
 = 
Œue
;

47 
Ëngth
 = 
b
;

51 
ËngthBy‹s
 = 
b
 & 0x7f;

53 ià(
ËngthBy‹s
 == 0)

55 
defš™eL’gth
 = 
çl£
;

56  
Œue
;

59 
defš™eL’gth
 = 
Œue
;

60 
Ëngth
 = 0;

61 
ËngthBy‹s
--)

63 ià(
Ëngth
 >> (8*((length)-1)))

64 
	`BERDecodeE¼Ü
();

66 ià(!
bt
.
	`G‘
(
b
))

67  
çl£
;

69 
Ëngth
 = (Ëngth << 8è| 
b
;

72  
Œue
;

73 
	}
}

75 
boŞ
 
	$BERL’gthDecode
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
, 
size_t
 &
Ëngth
)

77 
lwÜd
 
lw
;

78 
boŞ
 
defš™eL’gth
;

79 ià(!
	`BERL’gthDecode
(
bt
, 
lw
, 
defš™eL’gth
))

80 
	`BERDecodeE¼Ü
();

81 ià(!
	`SaãCÚv”t
(
lw
, 
Ëngth
))

82 
	`BERDecodeE¼Ü
();

83  
defš™eL’gth
;

84 
	}
}

86 
	$DEREncodeNuÎ
(
Bufã»dT¿nsfÜm©iÚ
 &
out
)

88 
out
.
	`Put
(
TAG_NULL
);

89 
out
.
	`Put
(0);

90 
	}
}

92 
	$BERDecodeNuÎ
(
Bufã»dT¿nsfÜm©iÚ
 &
š
)

94 
by‹
 
b
;

95 ià(!
š
.
	`G‘
(
b
è|| b !ğ
TAG_NULL
)

96 
	`BERDecodeE¼Ü
();

97 
size_t
 
Ëngth
;

98 ià(!
	`BERL’gthDecode
(
š
, 
Ëngth
) ||†ength != 0)

99 
	`BERDecodeE¼Ü
();

100 
	}
}

103 
size_t
 
	$DEREncodeOù‘SŒšg
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
, cÚ¡ 
by‹
 *
¡r
, 
size_t
 
¡rL’
)

105 
bt
.
	`Put
(
OCTET_STRING
);

106 
size_t
 
ËngthBy‹s
 = 
	`DERL’gthEncode
(
bt
, 
¡rL’
);

107 
bt
.
	`Put
(
¡r
, 
¡rL’
);

108  1+
ËngthBy‹s
+
¡rL’
;

109 
	}
}

111 
size_t
 
	$DEREncodeOù‘SŒšg
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
, cÚ¡ 
SecBy‹Block
 &
¡r
)

113  
	`DEREncodeOù‘SŒšg
(
bt
, 
¡r
.
	`begš
(), sŒ.
	`size
());

114 
	}
}

116 
size_t
 
	$BERDecodeOù‘SŒšg
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
, 
SecBy‹Block
 &
¡r
)

118 
by‹
 
b
;

119 ià(!
bt
.
	`G‘
(
b
è|| b !ğ
OCTET_STRING
)

120 
	`BERDecodeE¼Ü
();

122 
size_t
 
bc
;

123 ià(!
	`BERL’gthDecode
(
bt
, 
bc
))

124 
	`BERDecodeE¼Ü
();

126 
¡r
.
	`»size
(
bc
);

127 ià(
bc
 !ğ
bt
.
	`G‘
(
¡r
, bc))

128 
	`BERDecodeE¼Ü
();

129  
bc
;

130 
	}
}

132 
size_t
 
	$BERDecodeOù‘SŒšg
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
, Bufã»dT¿nsfÜm©iÚ &
¡r
)

134 
by‹
 
b
;

135 ià(!
bt
.
	`G‘
(
b
è|| b !ğ
OCTET_STRING
)

136 
	`BERDecodeE¼Ü
();

138 
size_t
 
bc
;

139 ià(!
	`BERL’gthDecode
(
bt
, 
bc
))

140 
	`BERDecodeE¼Ü
();

142 
bt
.
	`T¿nsãrTo
(
¡r
, 
bc
);

143  
bc
;

144 
	}
}

146 
size_t
 
	$DEREncodeTextSŒšg
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
, cÚ¡ 
¡d
::
¡ršg
 &
¡r
, 
by‹
 
a¢Tag
)

148 
bt
.
	`Put
(
a¢Tag
);

149 
size_t
 
ËngthBy‹s
 = 
	`DERL’gthEncode
(
bt
, 
¡r
.
	`size
());

150 
bt
.
	`Put
((cÚ¡ 
by‹
 *)
¡r
.
	`d©a
(), sŒ.
	`size
());

151  1+
ËngthBy‹s
+
¡r
.
	`size
();

152 
	}
}

154 
size_t
 
	$BERDecodeTextSŒšg
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
, 
¡d
::
¡ršg
 &
¡r
, 
by‹
 
a¢Tag
)

156 
by‹
 
b
;

157 ià(!
bt
.
	`G‘
(
b
è|| b !ğ
a¢Tag
)

158 
	`BERDecodeE¼Ü
();

160 
size_t
 
bc
;

161 ià(!
	`BERL’gthDecode
(
bt
, 
bc
))

162 
	`BERDecodeE¼Ü
();

164 
SecBy‹Block
 
	`‹mp
(
bc
);

165 ià(
bc
 !ğ
bt
.
	`G‘
(
‹mp
, bc))

166 
	`BERDecodeE¼Ü
();

167 
¡r
.
	`assign
((*)
‹mp
.
	`begš
(), 
bc
);

168  
bc
;

169 
	}
}

172 
size_t
 
	$DEREncodeB™SŒšg
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
, cÚ¡ 
by‹
 *
¡r
, 
size_t
 
¡rL’
, 
unu£dB™s
)

174 
bt
.
	`Put
(
BIT_STRING
);

175 
size_t
 
ËngthBy‹s
 = 
	`DERL’gthEncode
(
bt
, 
¡rL’
+1);

176 
bt
.
	`Put
((
by‹
)
unu£dB™s
);

177 
bt
.
	`Put
(
¡r
, 
¡rL’
);

178  2+
ËngthBy‹s
+
¡rL’
;

179 
	}
}

181 
size_t
 
	$BERDecodeB™SŒšg
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
, 
SecBy‹Block
 &
¡r
, &
unu£dB™s
)

183 
by‹
 
b
;

184 ià(!
bt
.
	`G‘
(
b
è|| b !ğ
BIT_STRING
)

185 
	`BERDecodeE¼Ü
();

187 
size_t
 
bc
;

188 ià(!
	`BERL’gthDecode
(
bt
, 
bc
))

189 
	`BERDecodeE¼Ü
();

191 
by‹
 
unu£d
;

192 ià(!
bt
.
	`G‘
(
unu£d
))

193 
	`BERDecodeE¼Ü
();

194 
unu£dB™s
 = 
unu£d
;

195 
¡r
.
	`»size
(
bc
-1);

196 ià((
bc
-1è!ğ
bt
.
	`G‘
(
¡r
, bc-1))

197 
	`BERDecodeE¼Ü
();

198  
bc
-1;

199 
	}
}

201 
	$DERR“ncode
(
Bufã»dT¿nsfÜm©iÚ
 &
sourû
, Bufã»dT¿nsfÜm©iÚ &
de¡
)

203 
by‹
 
g
;

204 
sourû
.
	`P“k
(
g
);

205 
BERG’”®Decod”
 
	`decod”
(
sourû
, 
g
);

206 
DERG’”®Encod”
 
	`’cod”
(
de¡
, 
g
);

207 ià(
decod”
.
	`IsDefš™eL’gth
())

208 
decod”
.
	`T¿nsãrTo
(
’cod”
, decod”.
	`RemaššgL’gth
());

211 !
decod”
.
	`EndR—ched
())

212 
	`DERR“ncode
(
decod”
, 
’cod”
);

214 
decod”
.
	`Mes§geEnd
();

215 
’cod”
.
	`Mes§geEnd
();

216 
	}
}

218 
	gOID
::
	$EncodeV®ue
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
, 
wÜd32
 
v
)

220 
i
=
	`RoundUpToMuÉËOf
(
	`STDMAX
(7U,
	`B™P»cisiÚ
(
v
)), 7U)-7; i != 0; i-=7)

221 
bt
.
	`Put
((
by‹
)(0x80 | ((
v
 >> 
i
) & 0x7f)));

222 
bt
.
	`Put
((
by‹
)(
v
 & 0x7f));

223 
	}
}

225 
size_t
 
	gOID
::
	$DecodeV®ue
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
, 
wÜd32
 &
v
)

227 
by‹
 
b
;

228 
size_t
 
i
=0;

229 
v
 = 0;

230 
Œue
)

232 ià(!
bt
.
	`G‘
(
b
))

233 
	`BERDecodeE¼Ü
();

234 
i
++;

235 ià(
v
 >> (8*(v)-7))

236 
	`BERDecodeE¼Ü
();

237 
v
 <<= 7;

238 
v
 +ğ
b
 & 0x7f;

239 ià(!(
b
 & 0x80))

240  
i
;

242 
	}
}

244 
	gOID
::
	$DEREncode
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
) const

246 
	`as£¹
(
m_v®ues
.
	`size
() >= 2);

247 
By‹Queue
 
‹mp
;

248 
‹mp
.
	`Put
(
	`by‹
(
m_v®ues
[0] * 40 + m_values[1]));

249 
size_t
 
i
=2; i<
m_v®ues
.
	`size
(); i++)

250 
	`EncodeV®ue
(
‹mp
, 
m_v®ues
[
i
]);

251 
bt
.
	`Put
(
OBJECT_IDENTIFIER
);

252 
	`DERL’gthEncode
(
bt
, 
‹mp
.
	`Cu¼’tSize
());

253 
‹mp
.
	`T¿nsãrTo
(
bt
);

254 
	}
}

256 
	gOID
::
	$BERDecode
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
)

258 
by‹
 
b
;

259 ià(!
bt
.
	`G‘
(
b
è|| b !ğ
OBJECT_IDENTIFIER
)

260 
	`BERDecodeE¼Ü
();

262 
size_t
 
Ëngth
;

263 ià(!
	`BERL’gthDecode
(
bt
, 
Ëngth
) ||†ength < 1)

264 
	`BERDecodeE¼Ü
();

266 ià(!
bt
.
	`G‘
(
b
))

267 
	`BERDecodeE¼Ü
();

269 
Ëngth
--;

270 
m_v®ues
.
	`»size
(2);

271 
m_v®ues
[0] = 
b
 / 40;

272 
m_v®ues
[1] = 
b
 % 40;

274 
Ëngth
 > 0)

276 
wÜd32
 
v
;

277 
size_t
 
v®ueL’
 = 
	`DecodeV®ue
(
bt
, 
v
);

278 ià(
v®ueL’
 > 
Ëngth
)

279 
	`BERDecodeE¼Ü
();

280 
m_v®ues
.
	`push_back
(
v
);

281 
Ëngth
 -ğ
v®ueL’
;

283 
	}
}

285 
	gOID
::
	$BERDecodeAndCheck
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
) const

287 
OID
 
	`oid
(
bt
);

288 ià(*
this
 !ğ
oid
)

289 
	`BERDecodeE¼Ü
();

290 
	}
}

292 
šlše
 
	gBufã»dT¿nsfÜm©iÚ
 & 
	gEncodedObjeùF‹r
::
	$Cu¼’tT¬g‘
()

294 ià(
m_æags
 & 
PUT_OBJECTS
)

295  *
	`A‰achedT¿nsfÜm©iÚ
();

297  
	`TheB™Buck‘
();

298 
	}
}

300 
	gEncodedObjeùF‹r
::
	$Put
(cÚ¡ 
by‹
 *
šSŒšg
, 
size_t
 
Ëngth
)

302 ià(
m_nCu¼’tObjeù
 =ğ
m_nObjeùs
)

304 
	`A‰achedT¿nsfÜm©iÚ
()->
	`Put
(
šSŒšg
, 
Ëngth
);

308 
LazyPu‰”
 
	`ÏzyPu‰”
(
m_queue
, 
šSŒšg
, 
Ëngth
);

310 
m_queue
.
	`AnyR‘r›vabË
())

312 
m_¡©e
)

314 
IDENTIFIER
:

315 ià(!
m_queue
.
	`G‘
(
m_id
))

317 
m_queue
.
	`T¿nsãrTo
(
	`Cu¼’tT¬g‘
(), 1);

318 
m_¡©e
 = 
LENGTH
;

319 
LENGTH
:

321 
by‹
 
b
;

322 ià(
m_Ëv–
 > 0 && 
m_id
 =ğ0 && 
m_queue
.
	`P“k
(
b
) && b == 0)

324 
m_queue
.
	`T¿nsãrTo
(
	`Cu¼’tT¬g‘
(), 1);

325 
m_Ëv–
--;

326 
m_¡©e
 = 
IDENTIFIER
;

329 
By‹Queue
::
W®k”
 
	`w®k”
(
m_queue
);

330 
boŞ
 
defš™eL’gth
;

331 ià(!
	`BERL’gthDecode
(
w®k”
, 
m_ËngthRemaššg
, 
defš™eL’gth
))

333 
m_queue
.
	`T¿nsãrTo
(
	`Cu¼’tT¬g‘
(), 
w®k”
.
	`G‘Cu¼’tPos™iÚ
());

334 ià(!((
m_id
 & 
CONSTRUCTED
è|| 
defš™eL’gth
))

335 
	`BERDecodeE¼Ü
();

336 ià(!
defš™eL’gth
)

338 ià(!(
m_id
 & 
CONSTRUCTED
))

339 
	`BERDecodeE¼Ü
();

340 
m_Ëv–
++;

341 
m_¡©e
 = 
IDENTIFIER
;

344 
m_¡©e
 = 
BODY
;

346 
BODY
:

347 
m_ËngthRemaššg
 -ğ
m_queue
.
	`T¿nsãrTo
(
	`Cu¼’tT¬g‘
(), m_lengthRemaining);

349 ià(
m_ËngthRemaššg
 == 0)

350 
m_¡©e
 = 
IDENTIFIER
;

353 ià(
m_¡©e
 =ğ
IDENTIFIER
 && 
m_Ëv–
 == 0)

356 ++
m_nCu¼’tObjeù
;

358 ià(
m_æags
 & 
PUT_MESSANGE_END_AFTER_EACH_OBJECT
)

359 
	`A‰achedT¿nsfÜm©iÚ
()->
	`Mes§geEnd
();

361 ià(
m_nCu¼’tObjeù
 =ğ
m_nObjeùs
)

363 ià(
m_æags
 & 
PUT_MESSANGE_END_AFTER_ALL_OBJECTS
)

364 
	`A‰achedT¿nsfÜm©iÚ
()->
	`Mes§geEnd
();

366 ià(
m_æags
 & 
PUT_MESSANGE_SERIES_END_AFTER_ALL_OBJECTS
)

367 
	`A‰achedT¿nsfÜm©iÚ
()->
	`Mes§geS”›sEnd
();

369 
m_queue
.
	`T¿nsãrAÎTo
(*
	`A‰achedT¿nsfÜm©iÚ
());

374 
	}
}

376 
	gBERG’”®Decod”
::
	$BERG’”®Decod”
(
Bufã»dT¿nsfÜm©iÚ
 &
šQueue
, 
by‹
 
a¢Tag
)

377 : 
	`m_šQueue
(
šQueue
), 
	$m_fšished
(
çl£
)

379 
	`In™
(
a¢Tag
);

380 
	}
}

382 
	gBERG’”®Decod”
::
	$BERG’”®Decod”
(
BERG’”®Decod”
 &
šQueue
, 
by‹
 
a¢Tag
)

383 : 
	`m_šQueue
(
šQueue
), 
	$m_fšished
(
çl£
)

385 
	`In™
(
a¢Tag
);

386 
	}
}

388 
	gBERG’”®Decod”
::
	$In™
(
by‹
 
a¢Tag
)

390 
by‹
 
b
;

391 ià(!
m_šQueue
.
	`G‘
(
b
è|| b !ğ
a¢Tag
)

392 
	`BERDecodeE¼Ü
();

394 ià(!
	`BERL’gthDecode
(
m_šQueue
, 
m_Ëngth
, 
m_defš™eL’gth
))

395 
	`BERDecodeE¼Ü
();

397 ià(!
m_defš™eL’gth
 && !(
a¢Tag
 & 
CONSTRUCTED
))

398 
	`BERDecodeE¼Ü
();

399 
	}
}

401 
	gBERG’”®Decod”
::~
	$BERG’”®Decod”
()

403 
Œy


405 ià(!
m_fšished
)

406 
	`Mes§geEnd
();

408 
	`ÿtch
 (...)

411 
	}
}

413 
boŞ
 
	gBERG’”®Decod”
::
	$EndR—ched
() const

415 ià(
m_defš™eL’gth
)

416  
m_Ëngth
 == 0;

419 
wÜd16
 
i
;

420  (
m_šQueue
.
	`P“kWÜd16
(
i
)==2 && i==0);

422 
	}
}

424 
by‹
 
	gBERG’”®Decod”
::
	$P“kBy‹
() const

426 
by‹
 
b
;

427 ià(!
	`P“k
(
b
))

428 
	`BERDecodeE¼Ü
();

429  
b
;

430 
	}
}

432 
	gBERG’”®Decod”
::
	$CheckBy‹
(
by‹
 
check
)

434 
by‹
 
b
;

435 ià(!
	`G‘
(
b
è|| b !ğ
check
)

436 
	`BERDecodeE¼Ü
();

437 
	}
}

439 
	gBERG’”®Decod”
::
	$Mes§geEnd
()

441 
m_fšished
 = 
Œue
;

442 ià(
m_defš™eL’gth
)

444 ià(
m_Ëngth
 != 0)

445 
	`BERDecodeE¼Ü
();

449 
wÜd16
 
i
;

450 ià(
m_šQueue
.
	`G‘WÜd16
(
i
) != 2 || i != 0)

451 
	`BERDecodeE¼Ü
();

453 
	}
}

455 
size_t
 
	gBERG’”®Decod”
::
	$T¿nsãrTo2
(
Bufã»dT¿nsfÜm©iÚ
 &
rg‘
, 
lwÜd
 &
ŒªsãrBy‹s
, cÚ¡ 
¡d
::
¡ršg
 &
chªÃl
, 
boŞ
 
blockšg
)

457 ià(
m_defš™eL’gth
 && 
ŒªsãrBy‹s
 > 
m_Ëngth
)

458 
ŒªsãrBy‹s
 = 
m_Ëngth
;

459 
size_t
 
blockedBy‹s
 = 
m_šQueue
.
	`T¿nsãrTo2
(
rg‘
, 
ŒªsãrBy‹s
, 
chªÃl
, 
blockšg
);

460 
	`ReduûL’gth
(
ŒªsãrBy‹s
);

461  
blockedBy‹s
;

462 
	}
}

464 
size_t
 
	gBERG’”®Decod”
::
	$CİyRªgeTo2
(
Bufã»dT¿nsfÜm©iÚ
 &
rg‘
, 
lwÜd
 &
begš
,†wÜd 
’d
, cÚ¡ 
¡d
::
¡ršg
 &
chªÃl
, 
boŞ
 
blockšg
) const

466 ià(
m_defš™eL’gth
)

467 
’d
 = 
	`STDMIN
(
m_Ëngth
,ƒnd);

468  
m_šQueue
.
	`CİyRªgeTo2
(
rg‘
, 
begš
, 
’d
, 
chªÃl
, 
blockšg
);

469 
	}
}

471 
lwÜd
 
	gBERG’”®Decod”
::
	$ReduûL’gth
(
lwÜd
 
d–
)

473 ià(
m_defš™eL’gth
)

475 ià(
m_Ëngth
 < 
d–
)

476 
	`BERDecodeE¼Ü
();

477 
m_Ëngth
 -ğ
d–
;

479  
d–
;

480 
	}
}

482 
	gDERG’”®Encod”
::
	$DERG’”®Encod”
(
Bufã»dT¿nsfÜm©iÚ
 &
outQueue
, 
by‹
 
a¢Tag
)

483 : 
	`m_outQueue
(
outQueue
), 
	`m_fšished
(
çl£
), 
	$m_a¢Tag
(
a¢Tag
)

485 
	}
}

487 
	gDERG’”®Encod”
::
	$DERG’”®Encod”
(
DERG’”®Encod”
 &
outQueue
, 
by‹
 
a¢Tag
)

488 : 
	`m_outQueue
(
outQueue
), 
	`m_fšished
(
çl£
), 
	$m_a¢Tag
(
a¢Tag
)

490 
	}
}

492 
	gDERG’”®Encod”
::~
	$DERG’”®Encod”
()

494 
Œy


496 ià(!
m_fšished
)

497 
	`Mes§geEnd
();

499 
	`ÿtch
 (...)

502 
	}
}

504 
	gDERG’”®Encod”
::
	$Mes§geEnd
()

506 
m_fšished
 = 
Œue
;

507 
lwÜd
 
Ëngth
 = 
	`Cu¼’tSize
();

508 
m_outQueue
.
	`Put
(
m_a¢Tag
);

509 
	`DERL’gthEncode
(
m_outQueue
, 
Ëngth
);

510 
	`T¿nsãrTo
(
m_outQueue
);

511 
	}
}

515 
	gX509PublicKey
::
	$BERDecode
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
)

517 
BERSequ’ûDecod”
 
	`subjeùPublicKeyInfo
(
bt
);

518 
BERSequ’ûDecod”
 
	`®gÜ™hm
(
subjeùPublicKeyInfo
);

519 
	`G‘AlgÜ™hmID
().
	`BERDecodeAndCheck
(
®gÜ™hm
);

520 
boŞ
 
·¿m‘”sP»£Á
 = 
®gÜ™hm
.
	`EndR—ched
(è? 
çl£
 : 
	`BERDecodeAlgÜ™hmP¬am‘”s
(algorithm);

521 
®gÜ™hm
.
	`Mes§geEnd
();

523 
BERG’”®Decod”
 
	`subjeùPublicKey
(
subjeùPublicKeyInfo
, 
BIT_STRING
);

524 
subjeùPublicKey
.
	`CheckBy‹
(0);

525 
	`BERDecodePublicKey
(
subjeùPublicKey
, 
·¿m‘”sP»£Á
, (
size_t
)subjeùPublicKey.
	`RemaššgL’gth
());

526 
subjeùPublicKey
.
	`Mes§geEnd
();

527 
subjeùPublicKeyInfo
.
	`Mes§geEnd
();

528 
	}
}

530 
	gX509PublicKey
::
	$DEREncode
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
) const

532 
DERSequ’ûEncod”
 
	`subjeùPublicKeyInfo
(
bt
);

534 
DERSequ’ûEncod”
 
	`®gÜ™hm
(
subjeùPublicKeyInfo
);

535 
	`G‘AlgÜ™hmID
().
	`DEREncode
(
®gÜ™hm
);

536 
	`DEREncodeAlgÜ™hmP¬am‘”s
(
®gÜ™hm
);

537 
®gÜ™hm
.
	`Mes§geEnd
();

539 
DERG’”®Encod”
 
	`subjeùPublicKey
(
subjeùPublicKeyInfo
, 
BIT_STRING
);

540 
subjeùPublicKey
.
	`Put
(0);

541 
	`DEREncodePublicKey
(
subjeùPublicKey
);

542 
subjeùPublicKey
.
	`Mes§geEnd
();

544 
subjeùPublicKeyInfo
.
	`Mes§geEnd
();

545 
	}
}

547 
	gPKCS8Priv©eKey
::
	$BERDecode
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
)

549 
BERSequ’ûDecod”
 
	`´iv©eKeyInfo
(
bt
);

550 
wÜd32
 
v”siÚ
;

551 
BERDecodeUnsigÃd
<
wÜd32
>(
´iv©eKeyInfo
, 
v”siÚ
, 
INTEGER
, 0, 0);

553 
BERSequ’ûDecod”
 
	`®gÜ™hm
(
´iv©eKeyInfo
);

554 
	`G‘AlgÜ™hmID
().
	`BERDecodeAndCheck
(
®gÜ™hm
);

555 
boŞ
 
·¿m‘”sP»£Á
 = 
®gÜ™hm
.
	`EndR—ched
(è? 
çl£
 : 
	`BERDecodeAlgÜ™hmP¬am‘”s
(algorithm);

556 
®gÜ™hm
.
	`Mes§geEnd
();

558 
BERG’”®Decod”
 
	`où‘SŒšg
(
´iv©eKeyInfo
, 
OCTET_STRING
);

559 
	`BERDecodePriv©eKey
(
où‘SŒšg
, 
·¿m‘”sP»£Á
, (
size_t
)
´iv©eKeyInfo
.
	`RemaššgL’gth
());

560 
où‘SŒšg
.
	`Mes§geEnd
();

562 ià(!
´iv©eKeyInfo
.
	`EndR—ched
())

563 
	`BERDecodeO±iÚ®A‰ribu‹s
(
´iv©eKeyInfo
);

564 
´iv©eKeyInfo
.
	`Mes§geEnd
();

565 
	}
}

567 
	gPKCS8Priv©eKey
::
	$DEREncode
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
) const

569 
DERSequ’ûEncod”
 
	`´iv©eKeyInfo
(
bt
);

570 
DEREncodeUnsigÃd
<
wÜd32
>(
´iv©eKeyInfo
, 0);

572 
DERSequ’ûEncod”
 
	`®gÜ™hm
(
´iv©eKeyInfo
);

573 
	`G‘AlgÜ™hmID
().
	`DEREncode
(
®gÜ™hm
);

574 
	`DEREncodeAlgÜ™hmP¬am‘”s
(
®gÜ™hm
);

575 
®gÜ™hm
.
	`Mes§geEnd
();

577 
DERG’”®Encod”
 
	`où‘SŒšg
(
´iv©eKeyInfo
, 
OCTET_STRING
);

578 
	`DEREncodePriv©eKey
(
où‘SŒšg
);

579 
où‘SŒšg
.
	`Mes§geEnd
();

581 
	`DEREncodeO±iÚ®A‰ribu‹s
(
´iv©eKeyInfo
);

582 
´iv©eKeyInfo
.
	`Mes§geEnd
();

583 
	}
}

585 
	gPKCS8Priv©eKey
::
	$BERDecodeO±iÚ®A‰ribu‹s
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
)

587 
	`DERR“ncode
(
bt
, 
m_İtiÚ®A‰ribu‹s
);

588 
	}
}

590 
	gPKCS8Priv©eKey
::
	$DEREncodeO±iÚ®A‰ribu‹s
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
) const

592 
m_İtiÚ®A‰ribu‹s
.
	`CİyTo
(
bt
);

593 
	}
}

595 
	gNAMESPACE_END


	@asn.h

1 #iâdeà
CRYPTOPP_ASN_H


2 
	#CRYPTOPP_ASN_H


	)

4 
	~"f‹rs.h
"

5 
	~"queue.h
"

6 
	~<veùÜ
>

8 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

11 
	eASNTag


13 
BOOLEAN
 = 0x01,

14 
INTEGER
 = 0x02,

15 
BIT_STRING
 = 0x03,

16 
OCTET_STRING
 = 0x04,

17 
TAG_NULL
 = 0x05,

18 
OBJECT_IDENTIFIER
 = 0x06,

19 
OBJECT_DESCRIPTOR
 = 0x07,

20 
EXTERNAL
 = 0x08,

21 
REAL
 = 0x09,

22 
ENUMERATED
 = 0x0a,

23 
UTF8_STRING
 = 0x0c,

24 
SEQUENCE
 = 0x10,

25 
SET
 = 0x11,

26 
NUMERIC_STRING
 = 0x12,

27 
PRINTABLE_STRING
 = 0x13,

28 
T61_STRING
 = 0x14,

29 
VIDEOTEXT_STRING
 = 0x15,

30 
IA5_STRING
 = 0x16,

31 
UTC_TIME
 = 0x17,

32 
GENERALIZED_TIME
 = 0x18,

33 
GRAPHIC_STRING
 = 0x19,

34 
VISIBLE_STRING
 = 0x1a,

35 
GENERAL_STRING
 = 0x1b

38 
	eASNIdFÏg


40 
UNIVERSAL
 = 0x00,

43 
CONSTRUCTED
 = 0x20,

44 
APPLICATION
 = 0x40,

45 
CONTEXT_SPECIFIC
 = 0x80,

46 
PRIVATE
 = 0xc0

49 
šlše
 
	$BERDecodeE¼Ü
(è{
throw
 
	`BERDecodeE¼
();
	}
}

51 şas 
	cCRYPTOPP_DLL
 
	mUnknownOID
 : 
public
 
BERDecodeE¼


53 
public
:

54 
	$UnknownOID
(è: 
	`BERDecodeE¼
("BER decodeƒrror: unknown object identifier") {}

55 
	$UnknownOID
(cÚ¡ *
”r
è: 
	$BERDecodeE¼
(
”r
è{
	}
}

59 
CRYPTOPP_DLL
 
size_t
 
CRYPTOPP_API
 
DERL’gthEncode
(
Bufã»dT¿nsfÜm©iÚ
 &
out
, 
lwÜd
 
Ëngth
);

61 
CRYPTOPP_DLL
 
boŞ
 
CRYPTOPP_API
 
BERL’gthDecode
(
Bufã»dT¿nsfÜm©iÚ
 &
š
, 
size_t
 &
Ëngth
);

63 
CRYPTOPP_DLL
 
CRYPTOPP_API
 
DEREncodeNuÎ
(
Bufã»dT¿nsfÜm©iÚ
 &
out
);

64 
CRYPTOPP_DLL
 
CRYPTOPP_API
 
BERDecodeNuÎ
(
Bufã»dT¿nsfÜm©iÚ
 &
š
);

66 
CRYPTOPP_DLL
 
size_t
 
CRYPTOPP_API
 
DEREncodeOù‘SŒšg
(
Bufã»dT¿nsfÜm©iÚ
 &
out
, cÚ¡ 
by‹
 *
¡r
, size_ˆ
¡rL’
);

67 
CRYPTOPP_DLL
 
size_t
 
CRYPTOPP_API
 
DEREncodeOù‘SŒšg
(
Bufã»dT¿nsfÜm©iÚ
 &
out
, cÚ¡ 
SecBy‹Block
 &
¡r
);

68 
CRYPTOPP_DLL
 
size_t
 
CRYPTOPP_API
 
BERDecodeOù‘SŒšg
(
Bufã»dT¿nsfÜm©iÚ
 &
š
, 
SecBy‹Block
 &
¡r
);

69 
CRYPTOPP_DLL
 
size_t
 
CRYPTOPP_API
 
BERDecodeOù‘SŒšg
(
Bufã»dT¿nsfÜm©iÚ
 &
š
, Bufã»dT¿nsfÜm©iÚ &
¡r
);

72 
CRYPTOPP_DLL
 
size_t
 
CRYPTOPP_API
 
DEREncodeTextSŒšg
(
Bufã»dT¿nsfÜm©iÚ
 &
out
, cÚ¡ 
¡d
::
¡ršg
 &
¡r
, 
by‹
 
a¢Tag
);

73 
CRYPTOPP_DLL
 
size_t
 
CRYPTOPP_API
 
BERDecodeTextSŒšg
(
Bufã»dT¿nsfÜm©iÚ
 &
š
, 
¡d
::
¡ršg
 &
¡r
, 
by‹
 
a¢Tag
);

75 
CRYPTOPP_DLL
 
size_t
 
CRYPTOPP_API
 
DEREncodeB™SŒšg
(
Bufã»dT¿nsfÜm©iÚ
 &
out
, cÚ¡ 
by‹
 *
¡r
, size_ˆ
¡rL’
, 
unu£dB™s
=0);

76 
CRYPTOPP_DLL
 
size_t
 
CRYPTOPP_API
 
BERDecodeB™SŒšg
(
Bufã»dT¿nsfÜm©iÚ
 &
š
, 
SecBy‹Block
 &
¡r
, &
unu£dB™s
);

79 
CRYPTOPP_DLL
 
CRYPTOPP_API
 
DERR“ncode
(
Bufã»dT¿nsfÜm©iÚ
 &
sourû
, Bufã»dT¿nsfÜm©iÚ &
de¡
);

82 şas 
	cCRYPTOPP_DLL
 
	mOID


84 
	mpublic
:

85 
	$OID
() {}

86 
	$OID
(
wÜd32
 
v
è: 
	$m_v®ues
(1, 
v
è{
	}
}

87 
	$OID
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
è{
	`BERDecode
(bt);
	}
}

89 
šlše
 
	gOID
 & 
	gİ”©Ü
+=(
wÜd32
 
rhs
è{
m_v®ues
.
push_back
Ôhs);  *
	gthis
;}

91 
	$DEREncode
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
) const;

92 
	`BERDecode
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
);

95 
	$BERDecodeAndCheck
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
) const;

97 
¡d
::
veùÜ
<
wÜd32
> 
m_v®ues
;

99 
´iv©e
:

100 
	`EncodeV®ue
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
, 
wÜd32
 
v
);

101 
size_t
 
	`DecodeV®ue
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
, 
wÜd32
 &
v
);

102 
	}
};

104 şas 
	cEncodedObjeùF‹r
 : 
public
 
F‹r


106 
public
:

107 
	eFÏg
 {
PUT_OBJECTS
=1, 
	mPUT_MESSANGE_END_AFTER_EACH_OBJECT
=2, 
	mPUT_MESSANGE_END_AFTER_ALL_OBJECTS
=4, 
	mPUT_MESSANGE_SERIES_END_AFTER_ALL_OBJECTS
=8};

108 
EncodedObjeùF‹r
(
Bufã»dT¿nsfÜm©iÚ
 *
©chm’t
 = 
NULL
, 
nObjeùs
 = 1, 
wÜd32
 
æags
 = 0);

110 
Put
(cÚ¡ 
by‹
 *
šSŒšg
, 
size_t
 
Ëngth
);

112 
	$G‘Numb”OfCom¶‘edObjeùs
(ècÚ¡ { 
m_nCu¼’tObjeù
;
	}
}

113 
	$G‘Pos™iÚOfObjeù
(
i
ècÚ¡ { 
m_pos™iÚs
[i];
	}
}

115 
	g´iv©e
:

116 
Bufã»dT¿nsfÜm©iÚ
 & 
Cu¼’tT¬g‘
();

118 
wÜd32
 
	gm_æags
;

119 
	gm_nObjeùs
, 
	gm_nCu¼’tObjeù
, 
	gm_Ëv–
;

120 
	g¡d
::
veùÜ
<> 
m_pos™iÚs
;

121 
By‹Queue
 
	gm_queue
;

122 
	eS‹
 {
	gIDENTIFIER
, 
	gLENGTH
, 
	gBODY
, 
	gTAIL
, 
	gALL_DONE
} 
	gm_¡©e
;

123 
by‹
 
	gm_id
;

124 
lwÜd
 
	gm_ËngthRemaššg
;

128 şas 
	cCRYPTOPP_DLL
 
	mBERG’”®Decod”
 : 
public
 
StÜe


130 
public
:

131 
ex¶ic™
 
BERG’”®Decod”
(
Bufã»dT¿nsfÜm©iÚ
 &
šQueue
, 
by‹
 
a¢Tag
);

132 
ex¶ic™
 
BERG’”®Decod”
(BERG’”®Decod” &
šQueue
, 
by‹
 
a¢Tag
);

133 ~
BERG’”®Decod”
();

135 
boŞ
 
	$IsDefš™eL’gth
(ècÚ¡ { 
m_defš™eL’gth
;}

136 
lwÜd
 
	$RemaššgL’gth
(ècÚ¡ {
	`as£¹
(
m_defš™eL’gth
);  
m_Ëngth
;
	}
}

137 
boŞ
 
	$EndR—ched
() const;

138 
by‹
 
	$P“kBy‹
() const;

139 
	`CheckBy‹
(
by‹
 
b
);

141 
size_t
 
	`T¿nsãrTo2
(
Bufã»dT¿nsfÜm©iÚ
 &
rg‘
, 
lwÜd
 &
ŒªsãrBy‹s
, cÚ¡ 
¡d
::
¡ršg
 &
chªÃl
=
DEFAULT_CHANNEL
, 
boŞ
 
blockšg
=
Œue
);

142 
size_t
 
	$CİyRªgeTo2
(
Bufã»dT¿nsfÜm©iÚ
 &
rg‘
, 
lwÜd
 &
begš
,†wÜd 
’d
=
LWORD_MAX
, cÚ¡ 
¡d
::
¡ršg
 &
chªÃl
=
DEFAULT_CHANNEL
, 
boŞ
 
blockšg
=
Œue
) const;

145 
	`Mes§geEnd
();

147 
´Ùeùed
:

148 
Bufã»dT¿nsfÜm©iÚ
 &
m_šQueue
;

149 
boŞ
 
m_fšished
, 
m_defš™eL’gth
;

150 
lwÜd
 
m_Ëngth
;

152 
´iv©e
:

153 
	`In™
(
by‹
 
a¢Tag
);

154 
	$StÜeIn™Ÿlize
(cÚ¡ 
NameV®uePaœs
 &
·¿m‘”s
è{
	`as£¹
(
çl£
);
	}
}

155 
lwÜd
 
ReduûL’gth
ÖwÜd 
d–
);

159 şas 
	cCRYPTOPP_DLL
 
	mDERG’”®Encod”
 : 
public
 
By‹Queue


161 
public
:

162 
ex¶ic™
 
DERG’”®Encod”
(
Bufã»dT¿nsfÜm©iÚ
 &
outQueue
, 
by‹
 
a¢Tag
 = 
SEQUENCE
 | 
CONSTRUCTED
);

163 
ex¶ic™
 
DERG’”®Encod”
(DERG’”®Encod” &
outQueue
, 
by‹
 
a¢Tag
 = 
SEQUENCE
 | 
CONSTRUCTED
);

164 ~
DERG’”®Encod”
();

167 
Mes§geEnd
();

169 
	m´iv©e
:

170 
Bufã»dT¿nsfÜm©iÚ
 &
m_outQueue
;

171 
boŞ
 
	mm_fšished
;

173 
by‹
 
	mm_a¢Tag
;

177 şas 
	cCRYPTOPP_DLL
 
	mBERSequ’ûDecod”
 : 
public
 
BERG’”®Decod”


179 
public
:

180 
ex¶ic™
 
BERSequ’ûDecod”
(
Bufã»dT¿nsfÜm©iÚ
 &
šQueue
, 
by‹
 
a¢Tag
 = 
SEQUENCE
 | 
CONSTRUCTED
)

181 : 
	$BERG’”®Decod”
(
šQueue
, 
a¢Tag
) {}

182 
ex¶ic™
 
	`BERSequ’ûDecod”
(
BERSequ’ûDecod”
 &
šQueue
, 
by‹
 
a¢Tag
 = 
SEQUENCE
 | 
CONSTRUCTED
)

183 : 
	$BERG’”®Decod”
(
šQueue
, 
a¢Tag
è{
	}
}

187 şas 
	cCRYPTOPP_DLL
 
	mDERSequ’ûEncod”
 : 
public
 
DERG’”®Encod”


189 
public
:

190 
ex¶ic™
 
DERSequ’ûEncod”
(
Bufã»dT¿nsfÜm©iÚ
 &
outQueue
, 
by‹
 
a¢Tag
 = 
SEQUENCE
 | 
CONSTRUCTED
)

191 : 
	$DERG’”®Encod”
(
outQueue
, 
a¢Tag
) {}

192 
ex¶ic™
 
	`DERSequ’ûEncod”
(
DERSequ’ûEncod”
 &
outQueue
, 
by‹
 
a¢Tag
 = 
SEQUENCE
 | 
CONSTRUCTED
)

193 : 
	$DERG’”®Encod”
(
outQueue
, 
a¢Tag
è{
	}
}

197 şas 
	cCRYPTOPP_DLL
 
	mBERS‘Decod”
 : 
public
 
BERG’”®Decod”


199 
public
:

200 
ex¶ic™
 
BERS‘Decod”
(
Bufã»dT¿nsfÜm©iÚ
 &
šQueue
, 
by‹
 
a¢Tag
 = 
SET
 | 
CONSTRUCTED
)

201 : 
	$BERG’”®Decod”
(
šQueue
, 
a¢Tag
) {}

202 
ex¶ic™
 
	`BERS‘Decod”
(
BERS‘Decod”
 &
šQueue
, 
by‹
 
a¢Tag
 = 
SET
 | 
CONSTRUCTED
)

203 : 
	$BERG’”®Decod”
(
šQueue
, 
a¢Tag
è{
	}
}

207 şas 
	cCRYPTOPP_DLL
 
	mDERS‘Encod”
 : 
public
 
DERG’”®Encod”


209 
public
:

210 
ex¶ic™
 
DERS‘Encod”
(
Bufã»dT¿nsfÜm©iÚ
 &
outQueue
, 
by‹
 
a¢Tag
 = 
SET
 | 
CONSTRUCTED
)

211 : 
	$DERG’”®Encod”
(
outQueue
, 
a¢Tag
) {}

212 
ex¶ic™
 
	`DERS‘Encod”
(
DERS‘Encod”
 &
outQueue
, 
by‹
 
a¢Tag
 = 
SET
 | 
CONSTRUCTED
)

213 : 
	$DERG’”®Encod”
(
outQueue
, 
a¢Tag
è{
	}
}

216 
	g‹m¶©e
 <
şass
 
	gT
>

217 
şass
 
	gASNO±iÚ®
 : 
public
 
memb”_±r
<
T
>

219 
public
:

220 
BERDecode
(
BERSequ’ûDecod”
 &
£qDecod”
, 
by‹
 
g
, by‹ 
mask
 = ~
CONSTRUCTED
)

222 
by‹
 
b
;

223 ià(
	g£qDecod”
.
P“k
(
b
è&& (
	gb
 & 
	gmask
è=ğ
g
)

224 
»£t
(
Ãw
 
T
(
£qDecod”
));

226 
DEREncode
(
Bufã»dT¿nsfÜm©iÚ
 &
out
)

228 ià(
	gthis
->
g‘
(è!ğ
NULL
)

229 
this
->
g‘
()->
DEREncode
(
out
);

234 
	g‹m¶©e
 <
şass
 
	gBASE
>

235 
şass
 
CRYPTOPP_DLL
 
CRYPTOPP_NO_VTABLE
 
	gASN1Cry±oM©”Ÿl
 : 
public
 
ASN1Objeù
,…ubliø
	gBASE


237 
	gpublic
:

238 
Save
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
) const

239 {
BEREncode
(
bt
);}

240 
Lßd
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
)

241 {
BERDecode
(
bt
);}

245 
şass
 
CRYPTOPP_DLL
 
	gX509PublicKey
 : 
public
 
ASN1Cry±oM©”Ÿl
<
PublicKey
>

247 
public
:

248 
BERDecode
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
);

249 
DEREncode
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
) const;

251 
vœtu®
 
OID
 
G‘AlgÜ™hmID
() const =0;

252 
vœtu®
 
boŞ
 
BERDecodeAlgÜ™hmP¬am‘”s
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
)

253 {
BERDecodeNuÎ
(
bt
);  
	gçl£
;}

254 
vœtu®
 
boŞ
 
DEREncodeAlgÜ™hmP¬am‘”s
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
) const

255 {
DEREncodeNuÎ
(
bt
);  
	gçl£
;}

258 
vœtu®
 
BERDecodePublicKey
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
, 
boŞ
 
·¿m‘”sP»£Á
, 
size_t
 
size
) =0;

260 
vœtu®
 
DEREncodePublicKey
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
) const =0;

264 
şass
 
CRYPTOPP_DLL
 
	gPKCS8Priv©eKey
 : 
public
 
ASN1Cry±oM©”Ÿl
<
Priv©eKey
>

266 
public
:

267 
BERDecode
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
);

268 
DEREncode
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
) const;

270 
vœtu®
 
OID
 
G‘AlgÜ™hmID
() const =0;

271 
vœtu®
 
boŞ
 
BERDecodeAlgÜ™hmP¬am‘”s
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
)

272 {
BERDecodeNuÎ
(
bt
);  
	gçl£
;}

273 
vœtu®
 
boŞ
 
DEREncodeAlgÜ™hmP¬am‘”s
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
) const

274 {
DEREncodeNuÎ
(
bt
);  
	gçl£
;}

277 
vœtu®
 
BERDecodePriv©eKey
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
, 
boŞ
 
·¿m‘”sP»£Á
, 
size_t
 
size
) =0;

279 
vœtu®
 
DEREncodePriv©eKey
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
) const =0;

283 
vœtu®
 
BERDecodeO±iÚ®A‰ribu‹s
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
);

285 
vœtu®
 
DEREncodeO±iÚ®A‰ribu‹s
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
) const;

287 
	g´Ùeùed
:

288 
By‹Queue
 
m_İtiÚ®A‰ribu‹s
;

295 
	g‹m¶©e
 <
şass
 
	gT
>

296 
size_t
 
	$DEREncodeUnsigÃd
(
Bufã»dT¿nsfÜm©iÚ
 &
out
, 
T
 
w
, 
by‹
 
a¢Tag
 = 
INTEGER
)

298 
by‹
 
buf
[(
w
)+1];

299 
bc
;

300 ià(
a¢Tag
 =ğ
BOOLEAN
)

302 
buf
[(
w
)] = w ? 0xff : 0;

303 
bc
 = 1;

307 
buf
[0] = 0;

308 
i
=0; i<(
w
); i++)

309 
buf
[
i
+1] = 
	`by‹
(
w
 >> ((w)-1-i)*8);

310 
bc
 = (
w
);

311 
bc
 > 1 && 
buf
[(
w
)+1-bc] == 0)

312 --
bc
;

313 ià(
buf
[(
w
)+1-
bc
] & 0x80)

314 ++
bc
;

316 
out
.
	`Put
(
a¢Tag
);

317 
size_t
 
ËngthBy‹s
 = 
	`DERL’gthEncode
(
out
, 
bc
);

318 
out
.
	`Put
(
buf
+(
w
)+1-
bc
, bc);

319  1+
ËngthBy‹s
+
bc
;

320 
	}
}

325 
	g‹m¶©e
 <
şass
 
	gT
>

326 
	$BERDecodeUnsigÃd
(
Bufã»dT¿nsfÜm©iÚ
 &
š
, 
T
 &
w
, 
by‹
 
a¢Tag
 = 
INTEGER
,

327 
T
 
mšV®ue
 = 0, T 
maxV®ue
 = 0xffffffff)

329 
by‹
 
b
;

330 ià(!
š
.
	`G‘
(
b
è|| b !ğ
a¢Tag
)

331 
	`BERDecodeE¼Ü
();

333 
size_t
 
bc
;

334 
	`BERL’gthDecode
(
š
, 
bc
);

336 
SecBy‹Block
 
	`buf
(
bc
);

338 ià(
bc
 !ğ
š
.
	`G‘
(
buf
, bc))

339 
	`BERDecodeE¼Ü
();

341 cÚ¡ 
by‹
 *
±r
 = 
buf
;

342 
bc
 > (
w
è&& *
±r
 == 0)

344 
bc
--;

345 
±r
++;

347 ià(
bc
 > (
w
))

348 
	`BERDecodeE¼Ü
();

350 
w
 = 0;

351 
i
=0; i<
bc
; i++)

352 
w
 = (w << 8è| 
±r
[
i
];

354 ià(
w
 < 
mšV®ue
 || w > 
maxV®ue
)

355 
	`BERDecodeE¼Ü
();

356 
	}
}

358 
šlše
 
boŞ
 
	gİ”©Ü
==(cÚ¡ ::
Cry±oPP
::
OID
 &
lhs
, cÚ¡ ::Cry±oPP::OID &
rhs
)

359 { 
lhs
.
m_v®ues
 =ğ
rhs
.m_values;}

360 
šlše
 
boŞ
 
	gİ”©Ü
!=(cÚ¡ ::
Cry±oPP
::
OID
 &
lhs
, cÚ¡ ::Cry±oPP::OID &
rhs
)

361 { 
lhs
.
m_v®ues
 !ğ
rhs
.m_values;}

362 
šlše
 
boŞ
 
	gİ”©Ü
<(cÚ¡ ::
Cry±oPP
::
OID
 &
lhs
, cÚ¡ ::Cry±oPP::OID &
rhs
)

363 { 
¡d
::
Ëxicog¿phiÿl_com·»
(
lhs
.
m_v®ues
.
begš
(),†hs.m_v®ues.
’d
(), 
rhs
.m_values.begin(),„hs.m_values.end());}

364 
	gšlše
 ::
Cry±oPP
::
OID
 
İ”©Ü
+(cÚ¡ ::Cry±oPP::OID &
lhs
, 
	grhs
)

365 { ::
Cry±oPP
::
OID
(
lhs
)+=
rhs
;}

367 
	gNAMESPACE_END


	@authenc.cpp

3 
	~"pch.h
"

5 #iâdeà
CRYPTOPP_IMPORTS


7 
	~"auth’c.h
"

9 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

11 
Auth’tiÿ‹dSymm‘ricCh”Ba£
::
	$Auth’tiÿ‹D©a
(cÚ¡ 
by‹
 *
šput
, 
size_t
 
Ën
)

13 
blockSize
 = 
	`Auth’tiÿtiÚBlockSize
();

14 &
num
 = 
m_bufã»dD©aL’gth
;

15 
by‹
* 
d©a
 = 
m_bufãr
.
	`begš
();

17 ià(
num
 != 0)

19 ià(
num
+
Ën
 >ğ
blockSize
)

21 
	`memıy
(
d©a
+
num
, 
šput
, 
blockSize
-num);

22 
	`Auth’tiÿ‹Blocks
(
d©a
, 
blockSize
);

23 
šput
 +ğ(
blockSize
-
num
);

24 
Ën
 -ğ(
blockSize
-
num
);

25 
num
 = 0;

30 
	`memıy
(
d©a
+
num
, 
šput
, 
Ën
);

31 
num
 +ğ()
Ën
;

37 ià(
Ën
 >ğ
blockSize
)

39 
size_t
 
ËáOv”
 = 
	`Auth’tiÿ‹Blocks
(
šput
, 
Ën
);

40 
šput
 +ğ(
Ën
 - 
ËáOv”
);

41 
Ën
 = 
ËáOv”
;

44 
	`memıy
(
d©a
, 
šput
, 
Ën
);

45 
num
 = ()
Ën
;

46 
	}
}

48 
	gAuth’tiÿ‹dSymm‘ricCh”Ba£
::
	$S‘Key
(cÚ¡ 
by‹
 *
u£rKey
, 
size_t
 
keyËngth
, cÚ¡ 
NameV®uePaœs
 &
·¿ms
)

50 
m_bufã»dD©aL’gth
 = 0;

51 
m_¡©e
 = 
S‹_S¹
;

53 
	`S‘KeyW™houtResync
(
u£rKey
, 
keyËngth
, 
·¿ms
);

54 
m_¡©e
 = 
S‹_KeyS‘
;

56 
size_t
 
Ëngth
;

57 cÚ¡ 
by‹
 *
iv
 = 
	`G‘IVAndThrowIfInv®id
(
·¿ms
, 
Ëngth
);

58 ià(
iv
)

59 
	`ResynchrÚize
(
iv
, ()
Ëngth
);

60 
	}
}

62 
	gAuth’tiÿ‹dSymm‘ricCh”Ba£
::
	$ResynchrÚize
(cÚ¡ 
by‹
 *
iv
, 
Ëngth
)

64 ià(
m_¡©e
 < 
S‹_KeyS‘
)

65 
throw
 
	`BadS‹
(
	`AlgÜ™hmName
(), "Resynchronize", "key is set");

67 
m_bufã»dD©aL’gth
 = 0;

68 
m_tÙ®H—d”L’gth
 = 
m_tÙ®Mes§geL’gth
 = 
m_tÙ®FoÙ”L’gth
 = 0;

69 
m_¡©e
 = 
S‹_KeyS‘
;

71 
	`Resync
(
iv
, 
this
->
	`ThrowIfInv®idIVL’gth
(
Ëngth
));

72 
m_¡©e
 = 
S‹_IVS‘
;

73 
	}
}

75 
	gAuth’tiÿ‹dSymm‘ricCh”Ba£
::
	$Upd©e
(cÚ¡ 
by‹
 *
šput
, 
size_t
 
Ëngth
)

77 ià(
Ëngth
 == 0)

80 
m_¡©e
)

82 
S‹_S¹
:

83 
S‹_KeyS‘
:

84 
throw
 
	`BadS‹
(
	`AlgÜ™hmName
(), "Update", "setting key‡nd IV");

85 
S‹_IVS‘
:

86 
	`Auth’tiÿ‹D©a
(
šput
, 
Ëngth
);

87 
m_tÙ®H—d”L’gth
 +ğ
Ëngth
;

89 
S‹_AuthUÁ¿nsfÜmed
:

90 
S‹_AuthT¿nsfÜmed
:

91 
	`Auth’tiÿ‹La¡CÚfid’tŸlBlock
();

92 
m_bufã»dD©aL’gth
 = 0;

93 
m_¡©e
 = 
S‹_AuthFoÙ”
;

95 
S‹_AuthFoÙ”
:

96 
	`Auth’tiÿ‹D©a
(
šput
, 
Ëngth
);

97 
m_tÙ®FoÙ”L’gth
 +ğ
Ëngth
;

100 
	`as£¹
(
çl£
);

102 
	}
}

104 
	gAuth’tiÿ‹dSymm‘ricCh”Ba£
::
	$ProûssD©a
(
by‹
 *
outSŒšg
, cÚ¡ by‹ *
šSŒšg
, 
size_t
 
Ëngth
)

106 
m_tÙ®Mes§geL’gth
 +ğ
Ëngth
;

107 ià(
m_¡©e
 >ğ
S‹_IVS‘
 && 
m_tÙ®Mes§geL’gth
 > 
	`MaxMes§geL’gth
())

108 
throw
 
	`Inv®idArgum’t
(
	`AlgÜ™hmName
() + ": message†engthƒxceeds maximum");

110 
»sw™ch
:

111 
m_¡©e
)

113 
S‹_S¹
:

114 
S‹_KeyS‘
:

115 
throw
 
	`BadS‹
(
	`AlgÜ™hmName
(), "ProcessData", "setting key‡nd IV");

116 
S‹_AuthFoÙ”
:

117 
throw
 
	`BadS‹
(
	`AlgÜ™hmName
(), "ProcessData was called‡fter footer input has started");

118 
S‹_IVS‘
:

119 
	`Auth’tiÿ‹La¡H—d”Block
();

120 
m_bufã»dD©aL’gth
 = 0;

121 
m_¡©e
 = 
	`Auth’tiÿtiÚIsOnPÏš‹xt
()==
	`IsFÜw¬dT¿nsfÜm©iÚ
(è? 
S‹_AuthUÁ¿nsfÜmed
 : 
S‹_AuthT¿nsfÜmed
;

122 
»sw™ch
;

123 
S‹_AuthUÁ¿nsfÜmed
:

124 
	`Auth’tiÿ‹D©a
(
šSŒšg
, 
Ëngth
);

125 
	`AcûssSymm‘ricCh”
().
	`ProûssD©a
(
outSŒšg
, 
šSŒšg
, 
Ëngth
);

127 
S‹_AuthT¿nsfÜmed
:

128 
	`AcûssSymm‘ricCh”
().
	`ProûssD©a
(
outSŒšg
, 
šSŒšg
, 
Ëngth
);

129 
	`Auth’tiÿ‹D©a
(
outSŒšg
, 
Ëngth
);

132 
	`as£¹
(
çl£
);

134 
	}
}

136 
	gAuth’tiÿ‹dSymm‘ricCh”Ba£
::
	$Trunÿ‹dFš®
(
by‹
 *
mac
, 
size_t
 
macSize
)

138 ià(
m_tÙ®H—d”L’gth
 > 
	`MaxH—d”L’gth
())

139 
throw
 
	`Inv®idArgum’t
(
	`AlgÜ™hmName
(è+ ": h—d”†’gth oà" + 
	`IÁToSŒšg
(
m_tÙ®H—d”L’gth
è+ "ƒxûed thmaximum oà" + IÁToSŒšg(
	`MaxH—d”L’gth
()));

141 ià(
m_tÙ®FoÙ”L’gth
 > 
	`MaxFoÙ”L’gth
())

143 ià(
	`MaxFoÙ”L’gth
() == 0)

144 
throw
 
	`Inv®idArgum’t
(
	`AlgÜ™hmName
() + ":‡dditional‡uthenticated data (AAD) cannot be input‡fter datao beƒncrypted or decrypted");

146 
throw
 
	`Inv®idArgum’t
(
	`AlgÜ™hmName
(è+ ": foÙ”†’gth oà" + 
	`IÁToSŒšg
(
m_tÙ®FoÙ”L’gth
è+ "ƒxûed thmaximum oà" + IÁToSŒšg(
	`MaxFoÙ”L’gth
()));

149 
m_¡©e
)

151 
S‹_S¹
:

152 
S‹_KeyS‘
:

153 
throw
 
	`BadS‹
(
	`AlgÜ™hmName
(), "TruncatedFinal", "setting key‡nd IV");

155 
S‹_IVS‘
:

156 
	`Auth’tiÿ‹La¡H—d”Block
();

157 
m_bufã»dD©aL’gth
 = 0;

160 
S‹_AuthUÁ¿nsfÜmed
:

161 
S‹_AuthT¿nsfÜmed
:

162 
	`Auth’tiÿ‹La¡CÚfid’tŸlBlock
();

163 
m_bufã»dD©aL’gth
 = 0;

166 
S‹_AuthFoÙ”
:

167 
	`Auth’tiÿ‹La¡FoÙ”Block
(
mac
, 
macSize
);

168 
m_bufã»dD©aL’gth
 = 0;

172 
	`as£¹
(
çl£
);

175 
m_¡©e
 = 
S‹_KeyS‘
;

176 
	}
}

178 
	gNAMESPACE_END


	@authenc.h

1 #iâdeà
CRYPTOPP_AUTHENC_H


2 
	#CRYPTOPP_AUTHENC_H


	)

4 
	~"üy±lib.h
"

5 
	~"£cblock.h
"

7 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

10 şas 
	cCRYPTOPP_DLL
 
CRYPTOPP_NO_VTABLE
 
Auth’tiÿ‹dSymm‘ricCh”Ba£
 : 
public
 
Auth’tiÿ‹dSymm‘ricCh”


12 
public
:

13 
	$Auth’tiÿ‹dSymm‘ricCh”Ba£
(è: 
	$m_¡©e
(
S‹_S¹
) {}

15 
boŞ
 
	$IsRªdomAcûss
(ècÚ¡ { 
çl£
;
	}
}

16 
boŞ
 
	$IsS–fInv”tšg
(ècÚ¡ { 
Œue
;
	}
}

17 
	$UncheckedS‘Key
(cÚ¡ 
by‹
 *,,cÚ¡ 
Cry±oPP
::
NameV®uePaœs
 &è{
	`as£¹
(
çl£
);
	}
}

19 
S‘Key
(cÚ¡ 
by‹
 *
u£rKey
, 
size_t
 
keyËngth
, cÚ¡ 
NameV®uePaœs
 &
·¿ms
);

20 
	$Re¡¬t
(è{ià(
m_¡©e
 > 
S‹_KeyS‘
èm_¡©ğS‹_KeyS‘;
	}
}

21 
ResynchrÚize
(cÚ¡ 
by‹
 *
iv
, 
Ëngth
=-1);

22 
Upd©e
(cÚ¡ 
by‹
 *
šput
, 
size_t
 
Ëngth
);

23 
ProûssD©a
(
by‹
 *
outSŒšg
, cÚ¡ by‹ *
šSŒšg
, 
size_t
 
Ëngth
);

24 
Trunÿ‹dFš®
(
by‹
 *
mac
, 
size_t
 
macSize
);

26 
	g´Ùeùed
:

27 
Auth’tiÿ‹D©a
(cÚ¡ 
by‹
 *
d©a
, 
size_t
 
Ën
);

28 cÚ¡ 
	gSymm‘ricCh”
 & 
	$G‘Symm‘ricCh”
(ècÚ¡ { 
cÚ¡_ÿ¡
<
Auth’tiÿ‹dSymm‘ricCh”Ba£
 *>(
this
)->
	`AcûssSymm‘ricCh”
();
	}
};

30 
vœtu®
 
	gSymm‘ricCh”
 & 
AcûssSymm‘ricCh”
() =0;

31 
vœtu®
 
boŞ
 
	$Auth’tiÿtiÚIsOnPÏš‹xt
() const =0;

32 
vœtu®
 
	$Auth’tiÿtiÚBlockSize
() const =0;

33 
vœtu®
 
	`S‘KeyW™houtResync
(cÚ¡ 
by‹
 *
u£rKey
, 
size_t
 
keyËngth
, cÚ¡ 
NameV®uePaœs
 &
·¿ms
) =0;

34 
vœtu®
 
	`Resync
(cÚ¡ 
by‹
 *
iv
, 
size_t
 
Ën
) =0;

35 
vœtu®
 
size_t
 
	`Auth’tiÿ‹Blocks
(cÚ¡ 
by‹
 *
d©a
, size_ˆ
Ën
) =0;

36 
vœtu®
 
	`Auth’tiÿ‹La¡H—d”Block
() =0;

37 
vœtu®
 
	$Auth’tiÿ‹La¡CÚfid’tŸlBlock
(è{
	}
}

38 
vœtu®
 
Auth’tiÿ‹La¡FoÙ”Block
(
by‹
 *
mac
, 
size_t
 
macSize
) =0;

40 
	eS‹
 {
	gS‹_S¹
, 
	gS‹_KeyS‘
, 
	gS‹_IVS‘
, 
	gS‹_AuthUÁ¿nsfÜmed
, 
	gS‹_AuthT¿nsfÜmed
, 
	gS‹_AuthFoÙ”
};

41 
S‹
 
	gm_¡©e
;

42 
	gm_bufã»dD©aL’gth
;

43 
lwÜd
 
	gm_tÙ®H—d”L’gth
, 
	gm_tÙ®Mes§geL’gth
, 
	gm_tÙ®FoÙ”L’gth
;

44 
AligÃdSecBy‹Block
 
	gm_bufãr
;

47 
	gNAMESPACE_END


	@base32.cpp

3 
	~"pch.h
"

4 
	~"ba£32.h
"

6 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

8 cÚ¡ 
by‹
 
s_vecUµ”
[] = "ABCDEFGHIJKMNPQRSTUVWXYZ23456789";

9 cÚ¡ 
by‹
 
s_vecLow”
[] = "abcdefghijkmnpqrstuvwxyz23456789";

11 
Ba£32Encod”
::
	$IsŞ©edIn™Ÿlize
(cÚ¡ 
NameV®uePaœs
 &
·¿m‘”s
)

13 
boŞ
 
uµ”ÿ£
 = 
·¿m‘”s
.
	`G‘V®ueW™hDeçuÉ
(
Name
::
	`Uµ”ÿ£
(), 
Œue
);

14 
m_f‹r
->
	`In™Ÿlize
(
	`CombšedNameV®uePaœs
(

15 
·¿m‘”s
,

16 
	`MakeP¬am‘”s
(
Name
::
	`EncodšgLookupA¼ay
(), 
uµ”ÿ£
 ? &
s_vecUµ”
[0] : &
s_vecLow”
[0], 
çl£
)(Name::
	`Log2Ba£
(), 5, 
Œue
)));

17 
	}
}

19 
	gBa£32Decod”
::
	$IsŞ©edIn™Ÿlize
(cÚ¡ 
NameV®uePaœs
 &
·¿m‘”s
)

21 
Ba£N_Decod”
::
	`In™Ÿlize
(
	`CombšedNameV®uePaœs
(

22 
·¿m‘”s
,

23 
	`MakeP¬am‘”s
(
Name
::
	`DecodšgLookupA¼ay
(), 
	`G‘DeçuÉDecodšgLookupA¼ay
(), 
çl£
)(Name::
	`Log2Ba£
(), 5, 
Œue
)));

24 
	}
}

26 cÚ¡ *
	gBa£32Decod”
::
	$G‘DeçuÉDecodšgLookupA¼ay
()

28 vŞ©
boŞ
 
s_š™Ÿlized
 = 
çl£
;

29 
s_¬¿y
[256];

31 ià(!
s_š™Ÿlized
)

33 
	`In™ŸlizeDecodšgLookupA¼ay
(
s_¬¿y
, 
s_vecUµ”
, 32, 
Œue
);

34 
s_š™Ÿlized
 = 
Œue
;

36  
s_¬¿y
;

37 
	}
}

39 
	gNAMESPACE_END


	@base32.h

1 #iâdeà
CRYPTOPP_BASE32_H


2 
	#CRYPTOPP_BASE32_H


	)

4 
	~"ba£code.h
"

6 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

10 şas 
	cBa£32Encod”
 : 
public
 
Sim¶eProxyF‹r


12 
public
:

13 
	`Ba£32Encod”
(
Bufã»dT¿nsfÜm©iÚ
 *
©chm’t
 = 
NULL
, 
boŞ
 
uµ”ÿ£
 = 
Œue
, 
ouutGroupSize
 = 0, cÚ¡ 
¡d
::
¡ršg
 &
£·¿tÜ
 = ":", cÚ¡ std::¡ršg &
‹rmš©Ü
 = "")

14 : 
	`Sim¶eProxyF‹r
(
Ãw
 
	`Ba£N_Encod”
Òew 
Grou³r
), 
©chm’t
)

16 
	`IsŞ©edIn™Ÿlize
(
	`MakeP¬am‘”s
(
Name
::
	`Uµ”ÿ£
(), 
uµ”ÿ£
)(Name::
	`GroupSize
(), 
ouutGroupSize
)(Name::
	`S•¬©Ü
(), 
	`CÚ¡By‹A¼ayP¬am‘”
(
£·¿tÜ
)));

19 
	`IsŞ©edIn™Ÿlize
(cÚ¡ 
NameV®uePaœs
 &
·¿m‘”s
);

20 
	}
};

24 şas 
	cBa£32Decod”
 : 
public
 
Ba£N_Decod”


26 
public
:

27 
	$Ba£32Decod”
(
Bufã»dT¿nsfÜm©iÚ
 *
©chm’t
 = 
NULL
)

28 : 
	`Ba£N_Decod”
(
	`G‘DeçuÉDecodšgLookupA¼ay
(), 5, 
©chm’t
) {}

30 
	`IsŞ©edIn™Ÿlize
(cÚ¡ 
NameV®uePaœs
 &
·¿m‘”s
);

32 
´iv©e
:

33 cÚ¡ * 
CRYPTOPP_API
 
	`G‘DeçuÉDecodšgLookupA¼ay
();

34 
	}
};

36 
	gNAMESPACE_END


	@base64.cpp

3 
	~"pch.h
"

4 
	~"ba£64.h
"

6 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

8 cÚ¡ 
by‹
 
s_vec
[] =

10 cÚ¡ 
by‹
 
s_·ddšg
 = '=';

12 
Ba£64Encod”
::
	$IsŞ©edIn™Ÿlize
(cÚ¡ 
NameV®uePaœs
 &
·¿m‘”s
)

14 
boŞ
 
š£¹LšeB»aks
 = 
·¿m‘”s
.
	`G‘V®ueW™hDeçuÉ
(
Name
::
	`In£¹LšeB»aks
(), 
Œue
);

15 
maxLšeL’gth
 = 
·¿m‘”s
.
	`G‘IÁV®ueW™hDeçuÉ
(
Name
::
	`MaxLšeL’gth
(), 72);

17 cÚ¡ *
lšeB»ak
 = 
š£¹LšeB»aks
 ? "\n" : "";

19 
m_f‹r
->
	`In™Ÿlize
(
	`CombšedNameV®uePaœs
(

20 
·¿m‘”s
,

21 
	`MakeP¬am‘”s
(
Name
::
	`EncodšgLookupA¼ay
(), &
s_vec
[0], 
çl£
)

22 (
Name
::
	`PaddšgBy‹
(), 
s_·ddšg
)

23 (
Name
::
	`GroupSize
(), 
š£¹LšeB»aks
 ? 
maxLšeL’gth
 : 0)

24 (
Name
::
	`S•¬©Ü
(), 
	`CÚ¡By‹A¼ayP¬am‘”
(
lšeB»ak
))

25 (
Name
::
	`T”mš©Ü
(), 
	`CÚ¡By‹A¼ayP¬am‘”
(
lšeB»ak
))

26 (
Name
::
	`Log2Ba£
(), 6, 
Œue
)));

27 
	}
}

29 cÚ¡ *
	gBa£64Decod”
::
	$G‘DecodšgLookupA¼ay
()

31 vŞ©
boŞ
 
s_š™Ÿlized
 = 
çl£
;

32 
s_¬¿y
[256];

34 ià(!
s_š™Ÿlized
)

36 
	`In™ŸlizeDecodšgLookupA¼ay
(
s_¬¿y
, 
s_vec
, 64, 
çl£
);

37 
s_š™Ÿlized
 = 
Œue
;

39  
s_¬¿y
;

40 
	}
}

42 
	gNAMESPACE_END


	@base64.h

1 #iâdeà
CRYPTOPP_BASE64_H


2 
	#CRYPTOPP_BASE64_H


	)

4 
	~"ba£code.h
"

6 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

9 şas 
	cBa£64Encod”
 : 
public
 
Sim¶eProxyF‹r


11 
public
:

12 
	$Ba£64Encod”
(
Bufã»dT¿nsfÜm©iÚ
 *
©chm’t
 = 
NULL
, 
boŞ
 
š£¹LšeB»aks
 = 
Œue
, 
maxLšeL’gth
 = 72)

13 : 
	`Sim¶eProxyF‹r
(
Ãw
 
	`Ba£N_Encod”
Òew 
Grou³r
), 
©chm’t
)

15 
	`IsŞ©edIn™Ÿlize
(
	`MakeP¬am‘”s
(
Name
::
	`In£¹LšeB»aks
(), 
š£¹LšeB»aks
)(Name::
	`MaxLšeL’gth
(), 
maxLšeL’gth
));

18 
	`IsŞ©edIn™Ÿlize
(cÚ¡ 
NameV®uePaœs
 &
·¿m‘”s
);

19 
	}
};

22 şas 
	cBa£64Decod”
 : 
public
 
Ba£N_Decod”


24 
public
:

25 
	$Ba£64Decod”
(
Bufã»dT¿nsfÜm©iÚ
 *
©chm’t
 = 
NULL
)

26 : 
	`Ba£N_Decod”
(
	`G‘DecodšgLookupA¼ay
(), 6, 
©chm’t
) {}

28 
	$IsŞ©edIn™Ÿlize
(cÚ¡ 
NameV®uePaœs
 &
·¿m‘”s
è{
	}
}

30 
	g´iv©e
:

31 cÚ¡ * 
CRYPTOPP_API
 
G‘DecodšgLookupA¼ay
();

34 
	gNAMESPACE_END


	@basecode.cpp

3 
	~"pch.h
"

5 #iâdeà
CRYPTOPP_IMPORTS


7 
	~"ba£code.h
"

8 
	~"æŒim¶.h
"

9 
	~<ùy³.h
>

11 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

13 
Ba£N_Encod”
::
	$IsŞ©edIn™Ÿlize
(cÚ¡ 
NameV®uePaœs
 &
·¿m‘”s
)

15 
·¿m‘”s
.
	`G‘RequœedP¬am‘”
("Ba£N_Encod”", 
Name
::
	`EncodšgLookupA¼ay
(), 
m_®phab‘
);

17 
·¿m‘”s
.
	`G‘RequœedIÁP¬am‘”
("Ba£N_Encod”", 
Name
::
	`Log2Ba£
(), 
m_b™sP”Ch¬
);

18 ià(
m_b™sP”Ch¬
 <= 0 || m_bitsPerChar >= 8)

19 
throw
 
	`Inv®idArgum’t
("BaseN_Encoder: Log2Base must be between 1‡nd 7 inclusive");

21 
by‹
 
·ddšg
;

22 
boŞ
 
·d
;

23 ià(
·¿m‘”s
.
	`G‘V®ue
(
Name
::
	`PaddšgBy‹
(), 
·ddšg
))

24 
·d
 = 
·¿m‘”s
.
	`G‘V®ueW™hDeçuÉ
(
Name
::
	`Pad
(), 
Œue
);

26 
·d
 = 
çl£
;

27 
m_·ddšg
 = 
·d
 ? 
·ddšg
 : -1;

29 
m_by‹Pos
 = 
m_b™Pos
 = 0;

31 
i
 = 8;

32 
i
%
m_b™sP”Ch¬
 != 0)

33 
i
 += 8;

34 
m_ouutBlockSize
 = 
i
/
m_b™sP”Ch¬
;

36 
m_outBuf
.
	`New
(
m_ouutBlockSize
);

37 
	}
}

39 
size_t
 
	gBa£N_Encod”
::
	$Put2
(cÚ¡ 
by‹
 *
begš
, 
size_t
 
Ëngth
, 
mes§geEnd
, 
boŞ
 
blockšg
)

41 
FILTER_BEGIN
;

42 
m_šputPos™iÚ
 < 
Ëngth
)

44 ià(
m_by‹Pos
 == 0)

45 
	`mem£t
(
m_outBuf
, 0, 
m_ouutBlockSize
);

48 
b
 = 
begš
[
m_šputPos™iÚ
++], 
b™sLeáInSourû
 = 8;

49 
Œue
)

51 
	`as£¹
(
m_b™Pos
 < 
m_b™sP”Ch¬
);

52 
b™sLeáInT¬g‘
 = 
m_b™sP”Ch¬
-
m_b™Pos
;

53 
m_outBuf
[
m_by‹Pos
] |ğ
b
 >> (8-
b™sLeáInT¬g‘
);

54 ià(
b™sLeáInSourû
 >ğ
b™sLeáInT¬g‘
)

56 
m_b™Pos
 = 0;

57 ++
m_by‹Pos
;

58 
b™sLeáInSourû
 -ğ
b™sLeáInT¬g‘
;

59 ià(
b™sLeáInSourû
 == 0)

61 
b
 <<ğ
b™sLeáInT¬g‘
;

62 
b
 &= 0xff;

66 
m_b™Pos
 +ğ
b™sLeáInSourû
;

72 
	`as£¹
(
m_by‹Pos
 <ğ
m_ouutBlockSize
);

73 ià(
m_by‹Pos
 =ğ
m_ouutBlockSize
)

75 
i
;

76 
i
=0; i<
m_by‹Pos
; i++)

78 
	`as£¹
(
m_outBuf
[
i
] < (1 << 
m_b™sP”Ch¬
));

79 
m_outBuf
[
i
] = 
m_®phab‘
[m_outBuf[i]];

81 
	`FILTER_OUTPUT
(1, 
m_outBuf
, 
m_ouutBlockSize
, 0);

83 
m_by‹Pos
 = 
m_b™Pos
 = 0;

86 ià(
mes§geEnd
)

88 ià(
m_b™Pos
 > 0)

89 ++
m_by‹Pos
;

91 
i
;

92 
i
=0; i<
m_by‹Pos
; i++)

93 
m_outBuf
[
i
] = 
m_®phab‘
[m_outBuf[i]];

95 ià(
m_·ddšg
 !ğ-1 && 
m_by‹Pos
 > 0)

97 
	`mem£t
(
m_outBuf
+
m_by‹Pos
, 
m_·ddšg
, 
m_ouutBlockSize
-m_bytePos);

98 
m_by‹Pos
 = 
m_ouutBlockSize
;

100 
	`FILTER_OUTPUT
(2, 
m_outBuf
, 
m_by‹Pos
, 
mes§geEnd
);

101 
m_by‹Pos
 = 
m_b™Pos
 = 0;

103 
FILTER_END_NO_MESSAGE_END
;

104 
	}
}

106 
	gBa£N_Decod”
::
	$IsŞ©edIn™Ÿlize
(cÚ¡ 
NameV®uePaœs
 &
·¿m‘”s
)

108 
·¿m‘”s
.
	`G‘RequœedP¬am‘”
("Ba£N_Decod”", 
Name
::
	`DecodšgLookupA¼ay
(), 
m_lookup
);

110 
·¿m‘”s
.
	`G‘RequœedIÁP¬am‘”
("Ba£N_Decod”", 
Name
::
	`Log2Ba£
(), 
m_b™sP”Ch¬
);

111 ià(
m_b™sP”Ch¬
 <= 0 || m_bitsPerChar >= 8)

112 
throw
 
	`Inv®idArgum’t
("BaseN_Decoder: Log2Base must be between 1‡nd 7 inclusive");

114 
m_by‹Pos
 = 
m_b™Pos
 = 0;

116 
i
 = 
m_b™sP”Ch¬
;

117 
i
%8 != 0)

118 
i
 +ğ
m_b™sP”Ch¬
;

119 
m_ouutBlockSize
 = 
i
/8;

121 
m_outBuf
.
	`New
(
m_ouutBlockSize
);

122 
	}
}

124 
size_t
 
	gBa£N_Decod”
::
	$Put2
(cÚ¡ 
by‹
 *
begš
, 
size_t
 
Ëngth
, 
mes§geEnd
, 
boŞ
 
blockšg
)

126 
FILTER_BEGIN
;

127 
m_šputPos™iÚ
 < 
Ëngth
)

129 
v®ue
;

130 
v®ue
 = 
m_lookup
[
begš
[
m_šputPos™iÚ
++]];

131 ià(
v®ue
 >= 256)

134 ià(
m_by‹Pos
 =ğ0 && 
m_b™Pos
 == 0)

135 
	`mem£t
(
m_outBuf
, 0, 
m_ouutBlockSize
);

138 
ÃwB™Pos
 = 
m_b™Pos
 + 
m_b™sP”Ch¬
;

139 ià(
ÃwB™Pos
 <= 8)

140 
m_outBuf
[
m_by‹Pos
] |ğ
v®ue
 << (8-
ÃwB™Pos
);

143 
m_outBuf
[
m_by‹Pos
] |ğ
v®ue
 >> (
ÃwB™Pos
-8);

144 
m_outBuf
[
m_by‹Pos
+1] |ğ
v®ue
 << (16-
ÃwB™Pos
);

147 
m_b™Pos
 = 
ÃwB™Pos
;

148 
m_b™Pos
 >= 8)

150 
m_b™Pos
 -= 8;

151 ++
m_by‹Pos
;

155 ià(
m_by‹Pos
 =ğ
m_ouutBlockSize
)

157 
	`FILTER_OUTPUT
(1, 
m_outBuf
, 
m_ouutBlockSize
, 0);

158 
m_by‹Pos
 = 
m_b™Pos
 = 0;

161 ià(
mes§geEnd
)

163 
	`FILTER_OUTPUT
(2, 
m_outBuf
, 
m_by‹Pos
, 
mes§geEnd
);

164 
m_by‹Pos
 = 
m_b™Pos
 = 0;

166 
FILTER_END_NO_MESSAGE_END
;

167 
	}
}

169 
	gBa£N_Decod”
::
	$In™ŸlizeDecodšgLookupA¼ay
(*
lookup
, cÚ¡ 
by‹
 *
®phab‘
, 
ba£
, 
boŞ
 
ÿ£In£ns™ive
)

171 
¡d
::
	`fl
(
lookup
,†ookup+256, -1);

173 
i
=0; i<
ba£
; i++)

175 ià(
ÿ£In£ns™ive
 && 
	`i§Íha
(
®phab‘
[
i
]))

177 
	`as£¹
(
lookup
[
	`touµ”
(
®phab‘
[
i
])] == -1);

178 
lookup
[
	`touµ”
(
®phab‘
[
i
])] = i;

179 
	`as£¹
(
lookup
[
	`tŞow”
(
®phab‘
[
i
])] == -1);

180 
lookup
[
	`tŞow”
(
®phab‘
[
i
])] = i;

184 
	`as£¹
(
lookup
[
®phab‘
[
i
]] == -1);

185 
lookup
[
®phab‘
[
i
]] = i;

188 
	}
}

190 
	gGrou³r
::
	$IsŞ©edIn™Ÿlize
(cÚ¡ 
NameV®uePaœs
 &
·¿m‘”s
)

192 
m_groupSize
 = 
·¿m‘”s
.
	`G‘IÁV®ueW™hDeçuÉ
(
Name
::
	`GroupSize
(), 0);

193 
CÚ¡By‹A¼ayP¬am‘”
 
£·¿tÜ
, 
‹rmš©Ü
;

194 ià(
m_groupSize
)

195 
·¿m‘”s
.
	`G‘RequœedP¬am‘”
("Grou³r", 
Name
::
	`S•¬©Ü
(), 
£·¿tÜ
);

197 
·¿m‘”s
.
	`G‘V®ue
(
Name
::
	`S•¬©Ü
(), 
£·¿tÜ
);

198 
·¿m‘”s
.
	`G‘V®ue
(
Name
::
	`T”mš©Ü
(), 
‹rmš©Ü
);

200 
m_£·¿tÜ
.
	`Assign
(
£·¿tÜ
.
	`begš
(), s•¬©Ü.
	`size
());

201 
m_‹rmš©Ü
.
	`Assign
(
‹rmš©Ü
.
	`begš
(),”mš©Ü.
	`size
());

202 
m_couÁ”
 = 0;

203 
	}
}

205 
size_t
 
	gGrou³r
::
	$Put2
(cÚ¡ 
by‹
 *
begš
, 
size_t
 
Ëngth
, 
mes§geEnd
, 
boŞ
 
blockšg
)

207 
FILTER_BEGIN
;

208 ià(
m_groupSize
)

210 
m_šputPos™iÚ
 < 
Ëngth
)

212 ià(
m_couÁ”
 =ğ
m_groupSize
)

214 
	`FILTER_OUTPUT
(1, 
m_£·¿tÜ
, m_£·¿tÜ.
	`size
(), 0);

215 
m_couÁ”
 = 0;

218 
size_t
 
Ën
;

219 
	`FILTER_OUTPUT2
(2, 
Ën
 = 
	`STDMIN
(
Ëngth
-
m_šputPos™iÚ
, 
m_groupSize
-
m_couÁ”
),

220 
begš
+
m_šputPos™iÚ
, 
Ën
, 0);

221 
m_šputPos™iÚ
 +ğ
Ën
;

222 
m_couÁ”
 +ğ
Ën
;

226 
	`FILTER_OUTPUT
(3, 
begš
, 
Ëngth
, 0);

228 ià(
mes§geEnd
)

230 
	`FILTER_OUTPUT
(4, 
m_‹rmš©Ü
, m_‹rmš©Ü.
	`size
(), 
mes§geEnd
);

231 
m_couÁ”
 = 0;

233 
FILTER_END_NO_MESSAGE_END


234 
	}
}

236 
	gNAMESPACE_END


	@basecode.h

1 #iâdeà
CRYPTOPP_BASECODE_H


2 
	#CRYPTOPP_BASECODE_H


	)

4 
	~"f‹rs.h
"

5 
	~"®g·¿m.h
"

6 
	~"¬gÇmes.h
"

8 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

11 
şass
 
CRYPTOPP_DLL
 
Ba£N_Encod”
 : 
public
 
UnæushabË
<
F‹r
>

13 
public
:

14 
	`Ba£N_Encod”
(
Bufã»dT¿nsfÜm©iÚ
 *
©chm’t
=
NULL
)

15 {
	`D‘ach
(
©chm’t
);}

17 
	`Ba£N_Encod”
(cÚ¡ 
by‹
 *
®phab‘
, 
log2ba£
, 
Bufã»dT¿nsfÜm©iÚ
 *
©chm’t
=
NULL
, 
·ddšg
=-1)

19 
	`D‘ach
(
©chm’t
);

20 
	`IsŞ©edIn™Ÿlize
(
	`MakeP¬am‘”s
(
Name
::
	`EncodšgLookupA¼ay
(), 
®phab‘
)

21 (
Name
::
	`Log2Ba£
(), 
log2ba£
)

22 (
Name
::
	`Pad
(), 
·ddšg
 != -1)

23 (
Name
::
	`PaddšgBy‹
(), 
	`by‹
(
·ddšg
)));

26 
	`IsŞ©edIn™Ÿlize
(cÚ¡ 
NameV®uePaœs
 &
·¿m‘”s
);

27 
size_t
 
	`Put2
(cÚ¡ 
by‹
 *
begš
, size_ˆ
Ëngth
, 
mes§geEnd
, 
boŞ
 
blockšg
);

29 
´iv©e
:

30 cÚ¡ 
by‹
 *
m_®phab‘
;

31 
m_·ddšg
, 
m_b™sP”Ch¬
, 
m_ouutBlockSize
;

32 
m_by‹Pos
, 
m_b™Pos
;

33 
SecBy‹Block
 
m_outBuf
;

34 
	}
};

37 
şass
 
CRYPTOPP_DLL
 
	gBa£N_Decod”
 : 
public
 
UnæushabË
<
F‹r
>

39 
public
:

40 
Ba£N_Decod”
(
Bufã»dT¿nsfÜm©iÚ
 *
©chm’t
=
NULL
)

41 {
D‘ach
(
©chm’t
);}

43 
Ba£N_Decod”
(cÚ¡ *
lookup
, 
log2ba£
, 
Bufã»dT¿nsfÜm©iÚ
 *
©chm’t
=
NULL
)

45 
D‘ach
(
©chm’t
);

46 
IsŞ©edIn™Ÿlize
(
MakeP¬am‘”s
(
Name
::
DecodšgLookupA¼ay
(), 
lookup
)(Name::
Log2Ba£
(), 
log2ba£
));

49 
IsŞ©edIn™Ÿlize
(cÚ¡ 
NameV®uePaœs
 &
·¿m‘”s
);

50 
size_t
 
Put2
(cÚ¡ 
by‹
 *
begš
, size_ˆ
Ëngth
, 
mes§geEnd
, 
boŞ
 
blockšg
);

52 
CRYPTOPP_API
 
In™ŸlizeDecodšgLookupA¼ay
(*
lookup
, cÚ¡ 
by‹
 *
®phab‘
, 
ba£
, 
boŞ
 
ÿ£In£ns™ive
);

54 
	g´iv©e
:

55 cÚ¡ *
m_lookup
;

56 
	gm_·ddšg
, 
	gm_b™sP”Ch¬
, 
	gm_ouutBlockSize
;

57 
	gm_by‹Pos
, 
	gm_b™Pos
;

58 
SecBy‹Block
 
	gm_outBuf
;

62 
şass
 
CRYPTOPP_DLL
 
	gGrou³r
 : 
public
 
Bufã¾ess
<
F‹r
>

64 
public
:

65 
Grou³r
(
Bufã»dT¿nsfÜm©iÚ
 *
©chm’t
=
NULL
)

66 {
D‘ach
(
©chm’t
);}

68 
Grou³r
(
groupSize
, cÚ¡ 
¡d
::
¡ršg
 &
£·¿tÜ
, cÚ¡ std::¡ršg &
‹rmš©Ü
, 
Bufã»dT¿nsfÜm©iÚ
 *
©chm’t
=
NULL
)

70 
D‘ach
(
©chm’t
);

71 
IsŞ©edIn™Ÿlize
(
MakeP¬am‘”s
(
Name
::
GroupSize
(), 
groupSize
)

72 (
Name
::
S•¬©Ü
(), 
CÚ¡By‹A¼ayP¬am‘”
(
£·¿tÜ
))

73 (
Name
::
T”mš©Ü
(), 
CÚ¡By‹A¼ayP¬am‘”
(
‹rmš©Ü
)));

76 
IsŞ©edIn™Ÿlize
(cÚ¡ 
NameV®uePaœs
 &
·¿m‘”s
);

77 
size_t
 
Put2
(cÚ¡ 
by‹
 *
begš
, size_ˆ
Ëngth
, 
mes§geEnd
, 
boŞ
 
blockšg
);

79 
	g´iv©e
:

80 
SecBy‹Block
 
m_£·¿tÜ
, 
	gm_‹rmš©Ü
;

81 
size_t
 
	gm_groupSize
, 
	gm_couÁ”
;

84 
	gNAMESPACE_END


	@bench.cpp

3 
	#_CRT_SECURE_NO_DEPRECATE


	)

5 
	~"b’ch.h
"

6 
	~"v®id©e.h
"

7 
	~"«s.h
"

8 
	~"blumshub.h
"

9 
	~"fes.h
"

10 
	~"hex.h
"

11 
	~"modes.h
"

12 
	~"çùÜy.h
"

13 
	~"ıu.h
"

15 
	~<time.h
>

16 
	~<m©h.h
>

17 
	~<io¡»am
>

18 
	~<iomª
>

20 
	$USING_NAMESPACE
(
Cry±oPP
)

21 
	$USING_NAMESPACE
(
¡d
)

23 #ifdeà
CLOCKS_PER_SEC


24 cÚ¡ 
CLOCK_TICKS_PER_SECOND
 = ()
CLOCKS_PER_SEC
;

25 #–ià
	`defšed
(
CLK_TCK
)

26 cÚ¡ 
CLOCK_TICKS_PER_SECOND
 = ()
CLK_TCK
;

28 cÚ¡ 
CLOCK_TICKS_PER_SECOND
 = 1000000.0;

31 
logtÙ®
 = 0, 
g_®loÿ‹dTime
, 
g_h”tz
;

32 
logcouÁ
 = 0;

34 cÚ¡ 
by‹
 *cÚ¡ 
key
=(byte *)"0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000";

36 
	$OuutResuÉBy‹s
(cÚ¡ *
Çme
, 
Ëngth
, 
timeTak’
)

38 
mbs
 = 
Ëngth
 / 
timeTak’
 / (1024*1024);

39 
cout
 << "\n<TR><TH>" << 
Çme
;

41 
cout
 << 
	`£tiosæags
(
ios
::
fixed
);

43 
cout
 << "<TD>" << 
	`£»cisiÚ
(0è<< 
	`£tiosæags
(
ios
::
fixed
è<< 
mbs
;

44 ià(
g_h”tz
)

45 
cout
 << "<TD>" << 
	`£»cisiÚ
(1è<< 
	`£tiosæags
(
ios
::
fixed
è<< 
timeTak’
 * 
g_h”tz
 / 
Ëngth
;

46 
cout
 << 
	`»£tiosæags
(
ios
::
fixed
);

47 
logtÙ®
 +ğ
	`log
(
mbs
);

48 
logcouÁ
++;

49 
	}
}

51 
	$OuutResuÉKeyšg
(
™”©iÚs
, 
timeTak’
)

53 
cout
 << "<TD>" << 
	`£»cisiÚ
(3è<< 
	`£tiosæags
(
ios
::
fixed
è<< (1000*1000*
timeTak’
/
™”©iÚs
);

54 ià(
g_h”tz
)

55 
cout
 << "<TD>" << 
	`£»cisiÚ
(0è<< 
	`£tiosæags
(
ios
::
fixed
è<< 
timeTak’
 * 
g_h”tz
 / 
™”©iÚs
;

56 
	}
}

58 
	$OuutResuÉO³¿tiÚs
(cÚ¡ *
Çme
, cÚ¡ *
İ”©iÚ
, 
boŞ
 
pc
, 
™”©iÚs
, 
timeTak’
)

60 
cout
 << "\n<TR><TH>" << 
Çme
 << " " << 
İ”©iÚ
 << (
pc
 ? " with…recomputation" : "");

64 
cout
 << "<TD>" << 
	`£»cisiÚ
(2è<< 
	`£tiosæags
(
ios
::
fixed
è<< (1000*
timeTak’
/
™”©iÚs
);

65 ià(
g_h”tz
)

66 
cout
 << "<TD>" << 
	`£»cisiÚ
(2è<< 
	`£tiosæags
(
ios
::
fixed
è<< 
timeTak’
 * 
g_h”tz
 / 
™”©iÚs
 / 1000000;

67 
cout
 << 
	`»£tiosæags
(
ios
::
fixed
);

69 
logtÙ®
 +ğ
	`log
(
™”©iÚs
/
timeTak’
);

70 
logcouÁ
++;

71 
	}
}

96 
	$B’chM¬k
(cÚ¡ *
Çme
, 
SŒ—mT¿nsfÜm©iÚ
 &
ch”
, 
timeTÙ®
)

98 cÚ¡ 
BUF_SIZE
=
	`RoundUpToMuÉËOf
(2048U, 
ch”
.
	`O±im®BlockSize
());

99 
AligÃdSecBy‹Block
 
	`buf
(
BUF_SIZE
);

100 
	`Glob®RNG
().
	`G’”©eBlock
(
buf
, 
BUF_SIZE
);

101 
şock_t
 
¡¬t
 = 
	`şock
();

103 
i
=0, 
blocks
=1;

104 
timeTak’
;

107 
blocks
 *= 2;

108 ; 
i
<
blocks
; i++)

109 
ch”
.
	`ProûssSŒšg
(
buf
, 
BUF_SIZE
);

110 
timeTak’
 = (
	`şock
(è- 
¡¬t
è/ 
CLOCK_TICKS_PER_SECOND
;

112 
timeTak’
 < 2.0/3*
timeTÙ®
);

114 
	`OuutResuÉBy‹s
(
Çme
, (
blocks
è* 
BUF_SIZE
, 
timeTak’
);

115 
	}
}

117 
	$B’chM¬k
(cÚ¡ *
Çme
, 
Auth’tiÿ‹dSymm‘ricCh”
 &
ch”
, 
timeTÙ®
)

119 ià(
ch”
.
	`N“dsP»¥ecif›dD©aL’gths
())

120 
ch”
.
	`S³cifyD©aL’gths
(0, ch”.
	`MaxMes§geL’gth
(), 0);

122 
	`B’chM¬k
(
Çme
, 
¡©ic_ÿ¡
<
SŒ—mT¿nsfÜm©iÚ
 &>(
ch”
), 
timeTÙ®
);

123 
	}
}

125 
	$B’chM¬k
(cÚ¡ *
Çme
, 
HashT¿nsfÜm©iÚ
 &
ht
, 
timeTÙ®
)

127 cÚ¡ 
BUF_SIZE
=2048U;

128 
AligÃdSecBy‹Block
 
	`buf
(
BUF_SIZE
);

129 
	`Glob®RNG
().
	`G’”©eBlock
(
buf
, 
BUF_SIZE
);

130 
şock_t
 
¡¬t
 = 
	`şock
();

132 
i
=0, 
blocks
=1;

133 
timeTak’
;

136 
blocks
 *= 2;

137 ; 
i
<
blocks
; i++)

138 
ht
.
	`Upd©e
(
buf
, 
BUF_SIZE
);

139 
timeTak’
 = (
	`şock
(è- 
¡¬t
è/ 
CLOCK_TICKS_PER_SECOND
;

141 
timeTak’
 < 2.0/3*
timeTÙ®
);

143 
	`OuutResuÉBy‹s
(
Çme
, (
blocks
è* 
BUF_SIZE
, 
timeTak’
);

144 
	}
}

146 
	$B’chM¬k
(cÚ¡ *
Çme
, 
Bufã»dT¿nsfÜm©iÚ
 &
bt
, 
timeTÙ®
)

148 cÚ¡ 
BUF_SIZE
=2048U;

149 
AligÃdSecBy‹Block
 
	`buf
(
BUF_SIZE
);

150 
	`Glob®RNG
().
	`G’”©eBlock
(
buf
, 
BUF_SIZE
);

151 
şock_t
 
¡¬t
 = 
	`şock
();

153 
i
=0, 
blocks
=1;

154 
timeTak’
;

157 
blocks
 *= 2;

158 ; 
i
<
blocks
; i++)

159 
bt
.
	`Put
(
buf
, 
BUF_SIZE
);

160 
timeTak’
 = (
	`şock
(è- 
¡¬t
è/ 
CLOCK_TICKS_PER_SECOND
;

162 
timeTak’
 < 2.0/3*
timeTÙ®
);

164 
	`OuutResuÉBy‹s
(
Çme
, (
blocks
è* 
BUF_SIZE
, 
timeTak’
);

165 
	}
}

167 
	$B’chM¬kKeyšg
(
Sim¶eKeyšgIÁ”çû
 &
c
, 
size_t
 
keyL’gth
, cÚ¡ 
NameV®uePaœs
 &
·¿ms
)

169 
™”©iÚs
 = 0;

170 
şock_t
 
¡¬t
 = 
	`şock
();

171 
timeTak’
;

174 
i
=0; i<1024; i++)

175 
c
.
	`S‘Key
(
key
, 
keyL’gth
, 
·¿ms
);

176 
timeTak’
 = (
	`şock
(è- 
¡¬t
è/ 
CLOCK_TICKS_PER_SECOND
;

177 
™”©iÚs
 += 1024;

179 
timeTak’
 < 
g_®loÿ‹dTime
);

181 
	`OuutResuÉKeyšg
(
™”©iÚs
, 
timeTak’
);

182 
	}
}

186 
	g‹m¶©e
 <
şass
 
	gT_FaùÜyOuut
, cÏs 
	gT_IÁ”çû
>

187 
	$B’chM¬kByName2
(cÚ¡ *
çùÜyName
, 
size_t
 
keyL’gth
 = 0, cÚ¡ *
di¥ÏyName
=
NULL
, cÚ¡ 
NameV®uePaœs
 &
·¿ms
 = 
g_nuÎNameV®uePaœs
, 
T_FaùÜyOuut
 *
x
=NULL, 
T_IÁ”çû
 *
y
=NULL)

189 
¡d
::
¡ršg
 
Çme
 = 
çùÜyName
;

190 ià(
di¥ÏyName
)

191 
Çme
 = 
di¥ÏyName
;

192 ià(
keyL’gth
)

193 
Çme
 +ğ" (" + 
	`IÁToSŒšg
(
keyL’gth
 * 8) + "-bit key)";

195 
¡d
::
auto_±r
<
T_FaùÜyOuut
> 
	`obj
(
ObjeùFaùÜyRegi¡ry
<T_FaùÜyOuut>::
	`Regi¡ry
().
	`C»©eObjeù
(
çùÜyName
));

196 ià(!
keyL’gth
)

197 
keyL’gth
 = 
obj
->
	`DeçuÉKeyL’gth
();

198 
obj
->
	`S‘Key
(
key
, 
keyL’gth
, 
	`CombšedNameV®uePaœs
(
·¿ms
, 
	`MakeP¬am‘”s
(
Name
::
	`IV
(), 
	`CÚ¡By‹A¼ayP¬am‘”
(key, obj->
	`IVSize
()), 
çl£
)));

199 
	`B’chM¬k
(
Çme
.
	`c_¡r
(), *
¡©ic_ÿ¡
<
T_IÁ”çû
 *>(
obj
.
	`g‘
()), 
g_®loÿ‹dTime
);

200 
	`B’chM¬kKeyšg
(*
obj
, 
keyL’gth
, 
	`CombšedNameV®uePaœs
(
·¿ms
, 
	`MakeP¬am‘”s
(
Name
::
	`IV
(), 
	`CÚ¡By‹A¼ayP¬am‘”
(
key
, obj->
	`IVSize
()), 
çl£
)));

201 
	}
}

204 
	g‹m¶©e
 <
şass
 
	gT_FaùÜyOuut
>

205 
	$B’chM¬kByName
(cÚ¡ *
çùÜyName
, 
size_t
 
keyL’gth
 = 0, cÚ¡ *
di¥ÏyName
=
NULL
, cÚ¡ 
NameV®uePaœs
 &
·¿ms
 = 
g_nuÎNameV®uePaœs
, 
T_FaùÜyOuut
 *
x
=NULL)

207 
B’chM¬kByName2
<
T_FaùÜyOuut
, T_FaùÜyOuut>(
çùÜyName
, 
keyL’gth
, 
di¥ÏyName
, 
·¿ms
, 
x
, x);

208 
	}
}

210 
	g‹m¶©e
 <
şass
 
	gT
>

211 
	$B’chM¬kByNameKeyLess
(cÚ¡ *
çùÜyName
, cÚ¡ *
di¥ÏyName
=
NULL
, cÚ¡ 
NameV®uePaœs
 &
·¿ms
 = 
g_nuÎNameV®uePaœs
, 
T
 *
x
=NULL)

213 
¡d
::
¡ršg
 
Çme
 = 
çùÜyName
;

214 ià(
di¥ÏyName
)

215 
Çme
 = 
di¥ÏyName
;

217 
¡d
::
auto_±r
<
T
> 
	`obj
(
ObjeùFaùÜyRegi¡ry
<T>::
	`Regi¡ry
().
	`C»©eObjeù
(
çùÜyName
));

218 
	`B’chM¬k
(
Çme
.
	`c_¡r
(), *
obj
, 
g_®loÿ‹dTime
);

219 
	}
}

221 
	$B’chm¬kAÎ
(
t
, 
h”tz
)

224 
logtÙ®
 = 0;

225 
logcouÁ
 = 0;

226 
g_®loÿ‹dTime
 = 
t
;

227 
g_h”tz
 = 
h”tz
;

229 cÚ¡ *
ıb
, *
ık
;

230 ià(
g_h”tz
)

232 
ıb
 = "<TH>Cycles Per Byte";

233 
ık
 = "<TH>Cycleso<br>Setup Key‡nd IV";

234 
cout
 << "CPU f»qu’cy oàth‹¡…ÏtfÜm i " << 
g_h”tz
 << " Hz.\n";

238 
ıb
 = 
ık
 = "";

239 
cout
 << "CPU frequency ofheest…latform was‚ot…rovided.\n";

242 
cout
 << "<TABLE bÜd”=1><COLGROUP><COL‡lignöeá><COL‡lignôight><COL‡lignôight><COL‡lignôight><COL‡lignôight>" << 
’dl
;

243 
cout
 << "<THEAD><TR><TH>AlgÜ™hm<TH>MiB/SecÚd" << 
ıb
 << "<TH>Miüo£cÚd to<br>S‘u°Key‡nd IV" << 
ık
 << 
’dl
;

245 
cout
 << "\n<TBODY style=\"background: yellow\">";

246 #ià
CRYPTOPP_BOOL_AESNI_INTRINSICS_AVAILABLE


247 ià(
	`HasCLMUL
())

248 
B’chM¬kByName2
<
Auth’tiÿ‹dSymm‘ricCh”
, AuthenticatedSymmetricCipher>("AES/GCM", 0, "AES/GCM");

252 
B’chM¬kByName2
<
Auth’tiÿ‹dSymm‘ricCh”
, Auth’tiÿ‹dSymm‘ricCh”>("AES/GCM", 0, "AES/GCM (2KabËs)", 
	`MakeP¬am‘”s
(
Name
::
	`TabËSize
(), 2048));

253 
B’chM¬kByName2
<
Auth’tiÿ‹dSymm‘ricCh”
, Auth’tiÿ‹dSymm‘ricCh”>("AES/GCM", 0, "AES/GCM (64KabËs)", 
	`MakeP¬am‘”s
(
Name
::
	`TabËSize
(), 64*1024));

255 
B’chM¬kByName2
<
Auth’tiÿ‹dSymm‘ricCh”
, AuthenticatedSymmetricCipher>("AES/CCM");

256 
B’chM¬kByName2
<
Auth’tiÿ‹dSymm‘ricCh”
, AuthenticatedSymmetricCipher>("AES/EAX");

258 
cout
 << "\n<TBODY style=\"background: white\">";

259 #ià
CRYPTOPP_BOOL_AESNI_INTRINSICS_AVAILABLE


260 ià(
	`HasCLMUL
())

261 
B’chM¬kByName2
<
Auth’tiÿ‹dSymm‘ricCh”
, 
Mes§geAuth’tiÿtiÚCode
>("AES/GCM", 0, "GMAC(AES)");

265 
B’chM¬kByName2
<
Auth’tiÿ‹dSymm‘ricCh”
, 
Mes§geAuth’tiÿtiÚCode
>("AES/GCM", 0, "GMAC(AESè(2KabËs)", 
	`MakeP¬am‘”s
(
Name
::
	`TabËSize
(), 2048));

266 
B’chM¬kByName2
<
Auth’tiÿ‹dSymm‘ricCh”
, 
Mes§geAuth’tiÿtiÚCode
>("AES/GCM", 0, "GMAC(AESè(64KabËs)", 
	`MakeP¬am‘”s
(
Name
::
	`TabËSize
(), 64*1024));

268 
B’chM¬kByName
<
Mes§geAuth’tiÿtiÚCode
>("VMAC(AES)-64");

269 
B’chM¬kByName
<
Mes§geAuth’tiÿtiÚCode
>("VMAC(AES)-128");

270 
B’chM¬kByName
<
Mes§geAuth’tiÿtiÚCode
>("HMAC(SHA-1)");

271 
B’chM¬kByName
<
Mes§geAuth’tiÿtiÚCode
>("Two-Track-MAC");

272 
B’chM¬kByName
<
Mes§geAuth’tiÿtiÚCode
>("CMAC(AES)");

273 
B’chM¬kByName
<
Mes§geAuth’tiÿtiÚCode
>("DMAC(AES)");

275 
cout
 << "\n<TBODY style=\"background: yellow\">";

276 
B’chM¬kByNameKeyLess
<
HashT¿nsfÜm©iÚ
>("CRC32");

277 
B’chM¬kByNameKeyLess
<
HashT¿nsfÜm©iÚ
>("Adler32");

278 
B’chM¬kByNameKeyLess
<
HashT¿nsfÜm©iÚ
>("MD5");

279 
B’chM¬kByNameKeyLess
<
HashT¿nsfÜm©iÚ
>("SHA-1");

280 
B’chM¬kByNameKeyLess
<
HashT¿nsfÜm©iÚ
>("SHA-256");

281 
B’chM¬kByNameKeyLess
<
HashT¿nsfÜm©iÚ
>("SHA-512");

282 
B’chM¬kByNameKeyLess
<
HashT¿nsfÜm©iÚ
>("SHA-3-224");

283 
B’chM¬kByNameKeyLess
<
HashT¿nsfÜm©iÚ
>("SHA-3-256");

284 
B’chM¬kByNameKeyLess
<
HashT¿nsfÜm©iÚ
>("SHA-3-384");

285 
B’chM¬kByNameKeyLess
<
HashT¿nsfÜm©iÚ
>("SHA-3-512");

286 
B’chM¬kByNameKeyLess
<
HashT¿nsfÜm©iÚ
>("Tiger");

287 
B’chM¬kByNameKeyLess
<
HashT¿nsfÜm©iÚ
>("Whirlpool");

288 
B’chM¬kByNameKeyLess
<
HashT¿nsfÜm©iÚ
>("RIPEMD-160");

289 
B’chM¬kByNameKeyLess
<
HashT¿nsfÜm©iÚ
>("RIPEMD-320");

290 
B’chM¬kByNameKeyLess
<
HashT¿nsfÜm©iÚ
>("RIPEMD-128");

291 
B’chM¬kByNameKeyLess
<
HashT¿nsfÜm©iÚ
>("RIPEMD-256");

293 
cout
 << "\n<TBODY style=\"background: white\">";

294 
B’chM¬kByName
<
Symm‘ricCh”
>("Panama-LE");

295 
B’chM¬kByName
<
Symm‘ricCh”
>("Panama-BE");

296 
B’chM¬kByName
<
Symm‘ricCh”
>("Salsa20");

297 
B’chM¬kByName
<
Symm‘ricCh”
>("S®§20", 0, "S®§20/12", 
	`MakeP¬am‘”s
(
Name
::
	`Rounds
(), 12));

298 
B’chM¬kByName
<
Symm‘ricCh”
>("S®§20", 0, "S®§20/8", 
	`MakeP¬am‘”s
(
Name
::
	`Rounds
(), 8));

299 
B’chM¬kByName
<
Symm‘ricCh”
>("Sosemanuk");

300 
B’chM¬kByName
<
Symm‘ricCh”
>("MARC4");

301 
B’chM¬kByName
<
Symm‘ricCh”
>("SEAL-3.0-LE");

302 
B’chM¬kByName
<
Symm‘ricCh”
>("WAKE-OFB-LE");

304 
cout
 << "\n<TBODY style=\"background: yellow\">";

305 
B’chM¬kByName
<
Symm‘ricCh”
>("AES/CTR", 16);

306 
B’chM¬kByName
<
Symm‘ricCh”
>("AES/CTR", 24);

307 
B’chM¬kByName
<
Symm‘ricCh”
>("AES/CTR", 32);

308 
B’chM¬kByName
<
Symm‘ricCh”
>("AES/CBC", 16);

309 
B’chM¬kByName
<
Symm‘ricCh”
>("AES/CBC", 24);

310 
B’chM¬kByName
<
Symm‘ricCh”
>("AES/CBC", 32);

311 
B’chM¬kByName
<
Symm‘ricCh”
>("AES/OFB", 16);

312 
B’chM¬kByName
<
Symm‘ricCh”
>("AES/CFB", 16);

313 
B’chM¬kByName
<
Symm‘ricCh”
>("AES/ECB", 16);

314 
B’chM¬kByName
<
Symm‘ricCh”
>("Camellia/CTR", 16);

315 
B’chM¬kByName
<
Symm‘ricCh”
>("Camellia/CTR", 32);

316 
B’chM¬kByName
<
Symm‘ricCh”
>("Twofish/CTR");

317 
B’chM¬kByName
<
Symm‘ricCh”
>("Serpent/CTR");

318 
B’chM¬kByName
<
Symm‘ricCh”
>("CAST-256/CTR");

319 
B’chM¬kByName
<
Symm‘ricCh”
>("RC6/CTR");

320 
B’chM¬kByName
<
Symm‘ricCh”
>("MARS/CTR");

321 
B’chM¬kByName
<
Symm‘ricCh”
>("SHACAL-2/CTR", 16);

322 
B’chM¬kByName
<
Symm‘ricCh”
>("SHACAL-2/CTR", 64);

323 
B’chM¬kByName
<
Symm‘ricCh”
>("DES/CTR");

324 
B’chM¬kByName
<
Symm‘ricCh”
>("DES-XEX3/CTR");

325 
B’chM¬kByName
<
Symm‘ricCh”
>("DES-EDE3/CTR");

326 
B’chM¬kByName
<
Symm‘ricCh”
>("IDEA/CTR");

327 
B’chM¬kByName
<
Symm‘ricCh”
>("RC5/CTR", 0, "RC5 (r=16)");

328 
B’chM¬kByName
<
Symm‘ricCh”
>("Blowfish/CTR");

329 
B’chM¬kByName
<
Symm‘ricCh”
>("TEA/CTR");

330 
B’chM¬kByName
<
Symm‘ricCh”
>("XTEA/CTR");

331 
B’chM¬kByName
<
Symm‘ricCh”
>("CAST-128/CTR");

332 
B’chM¬kByName
<
Symm‘ricCh”
>("SKIPJACK/CTR");

333 
B’chM¬kByName
<
Symm‘ricCh”
>("SEED/CTR", 0, "SEED/CTR (1/2 Kable)");

334 
cout
 << "</TABLE>" << 
’dl
;

336 
	`B’chm¬kAÎ2
(
t
, 
h”tz
);

338 
cout
 << "ThroughpuˆGeom‘riøAv”age: " << 
	`£tiosæags
(
ios
::
fixed
è<< 
	`exp
(
logtÙ®
/
logcouÁ
è<< 
’dl
;

340 
time_t
 
’dTime
 = 
	`time
(
NULL
);

341 
cout
 << "\nTe¡ƒnded‡ˆ" << 
	`asùime
(
	`loÿÉime
(&
’dTime
));

343 
	}
}

	@bench.h

1 #iâdeà
CRYPTOPP_BENCH_H


2 
	#CRYPTOPP_BENCH_H


	)

4 
	~"üy±lib.h
"

6 cÚ¡ 
CLOCK_TICKS_PER_SECOND
;

8 
B’chm¬kAÎ
(
t
, 
h”tz
);

9 
B’chm¬kAÎ2
(
t
, 
h”tz
);

	@bench2.cpp

3 
	~"b’ch.h
"

4 
	~"v®id©e.h
"

5 
	~"fes.h
"

6 
	~"hex.h
"

8 
	~"r§.h
"

9 
	~"Ä.h
"

10 
	~"d§.h
"

11 
	~"luc.h
"

12 
	~"rw.h
"

13 
	~"ecüy±o.h
"

14 
	~"eı.h
"

15 
	~"ec2n.h
"

16 
	~"a¢.h
"

17 
	~"dh.h
"

18 
	~"mqv.h
"

19 
	~"xŒüy±.h
"

20 
	~"esign.h
"

21 
	~"ps¤.h
"

22 
	~"oids.h
"

23 
	~"¿ndpoŞ.h
"

25 
	~<time.h
>

26 
	~<m©h.h
>

27 
	~<io¡»am
>

28 
	~<iomª
>

30 
	$USING_NAMESPACE
(
Cry±oPP
)

31 
	$USING_NAMESPACE
(
¡d
)

33 
	`OuutResuÉO³¿tiÚs
(cÚ¡ *
Çme
, cÚ¡ *
İ”©iÚ
, 
boŞ
 
pc
, 
™”©iÚs
, 
timeTak’
);

35 
	$B’chM¬kEnüy±iÚ
(cÚ¡ *
Çme
, 
PK_Enüy±Ü
 &
key
, 
timeTÙ®
, 
boŞ
 
pc
=
çl£
)

37 
Ën
 = 16;

38 
SecBy‹Block
 
	`¶aš‹xt
(
Ën
), 
	`ch”‹xt
(
key
.
	`Ch”‹xtL’gth
(len));

39 
	`Glob®RNG
().
	`G’”©eBlock
(
¶aš‹xt
, 
Ën
);

41 
şock_t
 
¡¬t
 = 
	`şock
();

42 
i
;

43 
timeTak’
;

44 
timeTak’
=()0, 
i
=0;imeTak’ < 
timeTÙ®
;imeTak’ = (
	`şock
(è- 
¡¬t
è/ 
CLOCK_TICKS_PER_SECOND
, i++)

45 
key
.
	`Enüy±
(
	`Glob®RNG
(), 
¶aš‹xt
, 
Ën
, 
ch”‹xt
);

47 
	`OuutResuÉO³¿tiÚs
(
Çme
, "Enüy±iÚ", 
pc
, 
i
, 
timeTak’
);

49 ià(!
pc
 && 
key
.
	`G‘M©”Ÿl
().
	`SuµÜtsP»computiÚ
())

51 
key
.
	`AcûssM©”Ÿl
().
	`P»compu‹
(16);

52 
	`B’chM¬kEnüy±iÚ
(
Çme
, 
key
, 
timeTÙ®
, 
Œue
);

54 
	}
}

56 
	$B’chM¬kDeüy±iÚ
(cÚ¡ *
Çme
, 
PK_Deüy±Ü
 &
´iv
, 
PK_Enüy±Ü
 &
pub
, 
timeTÙ®
)

58 
Ën
 = 16;

59 
SecBy‹Block
 
	`ch”‹xt
(
pub
.
	`Ch”‹xtL’gth
(
Ën
));

60 
SecBy‹Block
 
	`¶aš‹xt
(
pub
.
	`MaxPÏš‹xtL’gth
(
ch”‹xt
.
	`size
()));

61 
	`Glob®RNG
().
	`G’”©eBlock
(
¶aš‹xt
, 
Ën
);

62 
pub
.
	`Enüy±
(
	`Glob®RNG
(), 
¶aš‹xt
, 
Ën
, 
ch”‹xt
);

64 
şock_t
 
¡¬t
 = 
	`şock
();

65 
i
;

66 
timeTak’
;

67 
timeTak’
=()0, 
i
=0;imeTak’ < 
timeTÙ®
;imeTak’ = (
	`şock
(è- 
¡¬t
è/ 
CLOCK_TICKS_PER_SECOND
, i++)

68 
´iv
.
	`Deüy±
(
	`Glob®RNG
(), 
ch”‹xt
, ch”‹xt.
	`size
(), 
¶aš‹xt
);

70 
	`OuutResuÉO³¿tiÚs
(
Çme
, "Deüy±iÚ", 
çl£
, 
i
, 
timeTak’
);

71 
	}
}

73 
	$B’chM¬kSignšg
(cÚ¡ *
Çme
, 
PK_SigÃr
 &
key
, 
timeTÙ®
, 
boŞ
 
pc
=
çl£
)

75 
Ën
 = 16;

76 
AligÃdSecBy‹Block
 
	`mes§ge
(
Ën
), 
	`sigÇtu»
(
key
.
	`SigÇtu»L’gth
());

77 
	`Glob®RNG
().
	`G’”©eBlock
(
mes§ge
, 
Ën
);

79 
şock_t
 
¡¬t
 = 
	`şock
();

80 
i
;

81 
timeTak’
;

82 
timeTak’
=()0, 
i
=0;imeTak’ < 
timeTÙ®
;imeTak’ = (
	`şock
(è- 
¡¬t
è/ 
CLOCK_TICKS_PER_SECOND
, i++)

83 
key
.
	`SignMes§ge
(
	`Glob®RNG
(), 
mes§ge
, 
Ën
, 
sigÇtu»
);

85 
	`OuutResuÉO³¿tiÚs
(
Çme
, "SigÇtu»", 
pc
, 
i
, 
timeTak’
);

87 ià(!
pc
 && 
key
.
	`G‘M©”Ÿl
().
	`SuµÜtsP»computiÚ
())

89 
key
.
	`AcûssM©”Ÿl
().
	`P»compu‹
(16);

90 
	`B’chM¬kSignšg
(
Çme
, 
key
, 
timeTÙ®
, 
Œue
);

92 
	}
}

94 
	$B’chM¬kV”ifiÿtiÚ
(cÚ¡ *
Çme
, cÚ¡ 
PK_SigÃr
 &
´iv
, 
PK_V”if›r
 &
pub
, 
timeTÙ®
, 
boŞ
 
pc
=
çl£
)

96 
Ën
 = 16;

97 
AligÃdSecBy‹Block
 
	`mes§ge
(
Ën
), 
	`sigÇtu»
(
pub
.
	`SigÇtu»L’gth
());

98 
	`Glob®RNG
().
	`G’”©eBlock
(
mes§ge
, 
Ën
);

99 
´iv
.
	`SignMes§ge
(
	`Glob®RNG
(), 
mes§ge
, 
Ën
, 
sigÇtu»
);

101 
şock_t
 
¡¬t
 = 
	`şock
();

102 
i
;

103 
timeTak’
;

104 
timeTak’
=()0, 
i
=0;imeTak’ < 
timeTÙ®
;imeTak’ = (
	`şock
(è- 
¡¬t
è/ 
CLOCK_TICKS_PER_SECOND
, i++)

105 
pub
.
	`V”ifyMes§ge
(
mes§ge
, 
Ën
, 
sigÇtu»
, sigÇtu».
	`size
());

107 
	`OuutResuÉO³¿tiÚs
(
Çme
, "V”ifiÿtiÚ", 
pc
, 
i
, 
timeTak’
);

109 ià(!
pc
 && 
pub
.
	`G‘M©”Ÿl
().
	`SuµÜtsP»computiÚ
())

111 
pub
.
	`AcûssM©”Ÿl
().
	`P»compu‹
(16);

112 
	`B’chM¬kV”ifiÿtiÚ
(
Çme
, 
´iv
, 
pub
, 
timeTÙ®
, 
Œue
);

114 
	}
}

116 
	$B’chM¬kKeyG’
(cÚ¡ *
Çme
, 
Sim¶eKeyAg»em’tDomaš
 &
d
, 
timeTÙ®
, 
boŞ
 
pc
=
çl£
)

118 
SecBy‹Block
 
	`´iv
(
d
.
	`Priv©eKeyL’gth
()), 
	`pub
(d.
	`PublicKeyL’gth
());

120 
şock_t
 
¡¬t
 = 
	`şock
();

121 
i
;

122 
timeTak’
;

123 
timeTak’
=()0, 
i
=0;imeTak’ < 
timeTÙ®
;imeTak’ = (
	`şock
(è- 
¡¬t
è/ 
CLOCK_TICKS_PER_SECOND
, i++)

124 
d
.
	`G’”©eKeyPaœ
(
	`Glob®RNG
(), 
´iv
, 
pub
);

126 
	`OuutResuÉO³¿tiÚs
(
Çme
, "Key-Paœ G’”©iÚ", 
pc
, 
i
, 
timeTak’
);

128 ià(!
pc
 && 
d
.
	`G‘M©”Ÿl
().
	`SuµÜtsP»computiÚ
())

130 
d
.
	`AcûssM©”Ÿl
().
	`P»compu‹
(16);

131 
	`B’chM¬kKeyG’
(
Çme
, 
d
, 
timeTÙ®
, 
Œue
);

133 
	}
}

135 
	$B’chM¬kKeyG’
(cÚ¡ *
Çme
, 
Auth’tiÿ‹dKeyAg»em’tDomaš
 &
d
, 
timeTÙ®
, 
boŞ
 
pc
=
çl£
)

137 
SecBy‹Block
 
	`´iv
(
d
.
	`Ephem”®Priv©eKeyL’gth
()), 
	`pub
(d.
	`Ephem”®PublicKeyL’gth
());

139 
şock_t
 
¡¬t
 = 
	`şock
();

140 
i
;

141 
timeTak’
;

142 
timeTak’
=()0, 
i
=0;imeTak’ < 
timeTÙ®
;imeTak’ = (
	`şock
(è- 
¡¬t
è/ 
CLOCK_TICKS_PER_SECOND
, i++)

143 
d
.
	`G’”©eEphem”®KeyPaœ
(
	`Glob®RNG
(), 
´iv
, 
pub
);

145 
	`OuutResuÉO³¿tiÚs
(
Çme
, "Key-Paœ G’”©iÚ", 
pc
, 
i
, 
timeTak’
);

147 ià(!
pc
 && 
d
.
	`G‘M©”Ÿl
().
	`SuµÜtsP»computiÚ
())

149 
d
.
	`AcûssM©”Ÿl
().
	`P»compu‹
(16);

150 
	`B’chM¬kKeyG’
(
Çme
, 
d
, 
timeTÙ®
, 
Œue
);

152 
	}
}

154 
	$B’chM¬kAg»em’t
(cÚ¡ *
Çme
, 
Sim¶eKeyAg»em’tDomaš
 &
d
, 
timeTÙ®
, 
boŞ
 
pc
=
çl£
)

156 
SecBy‹Block
 
	`´iv1
(
d
.
	`Priv©eKeyL’gth
()), 
	`´iv2
(d.PrivateKeyLength());

157 
SecBy‹Block
 
	`pub1
(
d
.
	`PublicKeyL’gth
()), 
	`pub2
(d.PublicKeyLength());

158 
d
.
	`G’”©eKeyPaœ
(
	`Glob®RNG
(), 
´iv1
, 
pub1
);

159 
d
.
	`G’”©eKeyPaœ
(
	`Glob®RNG
(), 
´iv2
, 
pub2
);

160 
SecBy‹Block
 
	`v®
(
d
.
	`Ag»edV®ueL’gth
());

162 
şock_t
 
¡¬t
 = 
	`şock
();

163 
i
;

164 
timeTak’
;

165 
timeTak’
=()0, 
i
=0;imeTak’ < 
timeTÙ®
;imeTak’ = (
	`şock
(è- 
¡¬t
è/ 
CLOCK_TICKS_PER_SECOND
, i+=2)

167 
d
.
	`Ag»e
(
v®
, 
´iv1
, 
pub2
);

168 
d
.
	`Ag»e
(
v®
, 
´iv2
, 
pub1
);

171 
	`OuutResuÉO³¿tiÚs
(
Çme
, "Key Ag»em’t", 
pc
, 
i
, 
timeTak’
);

172 
	}
}

174 
	$B’chM¬kAg»em’t
(cÚ¡ *
Çme
, 
Auth’tiÿ‹dKeyAg»em’tDomaš
 &
d
, 
timeTÙ®
, 
boŞ
 
pc
=
çl£
)

176 
SecBy‹Block
 
	`¥riv1
(
d
.
	`SticPriv©eKeyL’gth
()), 
	`¥riv2
(d.StaticPrivateKeyLength());

177 
SecBy‹Block
 
	`•riv1
(
d
.
	`Ephem”®Priv©eKeyL’gth
()), 
	`•riv2
(d.EphemeralPrivateKeyLength());

178 
SecBy‹Block
 
	`¥ub1
(
d
.
	`SticPublicKeyL’gth
()), 
	`¥ub2
(d.StaticPublicKeyLength());

179 
SecBy‹Block
 
	`•ub1
(
d
.
	`Ephem”®PublicKeyL’gth
()), 
	`•ub2
(d.EphemeralPublicKeyLength());

180 
d
.
	`G’”©eSticKeyPaœ
(
	`Glob®RNG
(), 
¥riv1
, 
¥ub1
);

181 
d
.
	`G’”©eSticKeyPaœ
(
	`Glob®RNG
(), 
¥riv2
, 
¥ub2
);

182 
d
.
	`G’”©eEphem”®KeyPaœ
(
	`Glob®RNG
(), 
•riv1
, 
•ub1
);

183 
d
.
	`G’”©eEphem”®KeyPaœ
(
	`Glob®RNG
(), 
•riv2
, 
•ub2
);

184 
SecBy‹Block
 
	`v®
(
d
.
	`Ag»edV®ueL’gth
());

186 
şock_t
 
¡¬t
 = 
	`şock
();

187 
i
;

188 
timeTak’
;

189 
timeTak’
=()0, 
i
=0;imeTak’ < 
timeTÙ®
;imeTak’ = (
	`şock
(è- 
¡¬t
è/ 
CLOCK_TICKS_PER_SECOND
, i+=2)

191 
d
.
	`Ag»e
(
v®
, 
¥riv1
, 
•riv1
, 
¥ub2
, 
•ub2
);

192 
d
.
	`Ag»e
(
v®
, 
¥riv2
, 
•riv2
, 
¥ub1
, 
•ub1
);

195 
	`OuutResuÉO³¿tiÚs
(
Çme
, "Key Ag»em’t", 
pc
, 
i
, 
timeTak’
);

196 
	}
}

199 
	g‹m¶©e
 <
şass
 
	gSCHEME
>

200 
	$B’chM¬kCry±o
(cÚ¡ *
f’ame
, cÚ¡ *
Çme
, 
timeTÙ®
, 
SCHEME
 *
x
=
NULL
)

202 
FeSourû
 
	`f
(
f’ame
, 
Œue
, 
Ãw
 
	`HexDecod”
());

203 
ty³Çme
 
SCHEME
::
Deüy±Ü
 
	`´iv
(
f
);

204 
ty³Çme
 
SCHEME
::
Enüy±Ü
 
	`pub
(
´iv
);

205 
	`B’chM¬kEnüy±iÚ
(
Çme
, 
pub
, 
timeTÙ®
);

206 
	`B’chM¬kDeüy±iÚ
(
Çme
, 
´iv
, 
pub
, 
timeTÙ®
);

207 
	}
}

210 
	g‹m¶©e
 <
şass
 
	gSCHEME
>

211 
	$B’chM¬kSigÇtu»
(cÚ¡ *
f’ame
, cÚ¡ *
Çme
, 
timeTÙ®
, 
SCHEME
 *
x
=
NULL
)

213 
FeSourû
 
	`f
(
f’ame
, 
Œue
, 
Ãw
 
	`HexDecod”
());

214 
ty³Çme
 
SCHEME
::
SigÃr
 
	`´iv
(
f
);

215 
ty³Çme
 
SCHEME
::
V”if›r
 
	`pub
(
´iv
);

216 
	`B’chM¬kSignšg
(
Çme
, 
´iv
, 
timeTÙ®
);

217 
	`B’chM¬kV”ifiÿtiÚ
(
Çme
, 
´iv
, 
pub
, 
timeTÙ®
);

218 
	}
}

221 
	g‹m¶©e
 <
şass
 
	gD
>

222 
	$B’chM¬kKeyAg»em’t
(cÚ¡ *
f’ame
, cÚ¡ *
Çme
, 
timeTÙ®
, 
D
 *
x
=
NULL
)

224 
FeSourû
 
	`f
(
f’ame
, 
Œue
, 
Ãw
 
	`HexDecod”
());

225 
D
 
	`d
(
f
);

226 
	`B’chM¬kKeyG’
(
Çme
, 
d
, 
timeTÙ®
);

227 
	`B’chM¬kAg»em’t
(
Çme
, 
d
, 
timeTÙ®
);

228 
	}
}

230 
g_h”tz
;

232 
	$B’chm¬kAÎ2
(
t
, 
h”tz
)

234 
g_h”tz
 = 
h”tz
;

236 
cout
 << "<TABLE bÜd”=1><COLGROUP><COL‡lignöeá><COL‡lignôight><COL‡lignôight>" << 
’dl
;

237 
cout
 << "<THEAD><TR><TH>O³¿tiÚ<TH>Mli£cÚds/O³¿tiÚ" << (
g_h”tz
 ? "<TH>Megacyşes/O³¿tiÚ" : ""è<< 
’dl
;

239 
cout
 << "\n<TBODY style=\"background: yellow\">";

240 
B’chM¬kCry±o
<
RSAES
<
OAEP
<
SHA
> > >("Te¡D©a/r§1024.d©", "RSA 1024", 
t
);

241 
B’chM¬kCry±o
<
LUCES
<
OAEP
<
SHA
> > >("Te¡D©a/luc1024.d©", "LUC 1024", 
t
);

242 
B’chM¬kCry±o
<
DLIES
<> >("Te¡D©a/dl›1024.d©", "DLIES 1024", 
t
);

243 
B’chM¬kCry±o
<
LUC_IES
<> >("Te¡D©a/lucc512.d©", "LUCELG 512", 
t
);

245 
cout
 << "\n<TBODY style=\"background: white\">";

246 
B’chM¬kCry±o
<
RSAES
<
OAEP
<
SHA
> > >("Te¡D©a/r§2048.d©", "RSA 2048", 
t
);

247 
B’chM¬kCry±o
<
LUCES
<
OAEP
<
SHA
> > >("Te¡D©a/luc2048.d©", "LUC 2048", 
t
);

248 
B’chM¬kCry±o
<
DLIES
<> >("Te¡D©a/dl›2048.d©", "DLIES 2048", 
t
);

249 
B’chM¬kCry±o
<
LUC_IES
<> >("Te¡D©a/lucc1024.d©", "LUCELG 1024", 
t
);

251 
cout
 << "\n<TBODY style=\"background: yellow\">";

252 
B’chM¬kSigÇtu»
<
RSASS
<
PSSR
, 
SHA
> >("Te¡D©a/r§1024.d©", "RSA 1024", 
t
);

253 
B’chM¬kSigÇtu»
<
RWSS
<
PSSR
, 
SHA
> >("Te¡D©a/rw1024.d©", "RW 1024", 
t
);

254 
B’chM¬kSigÇtu»
<
LUCSS
<
PSSR
, 
SHA
> >("Te¡D©a/luc1024.d©", "LUC 1024", 
t
);

255 
B’chM¬kSigÇtu»
<
NR
<
SHA
> >("Te¡D©a/Ä1024.d©", "NR 1024", 
t
);

256 
B’chM¬kSigÇtu»
<
DSA
>("Te¡D©a/d§1024.d©", "DSA 1024", 
t
);

257 
B’chM¬kSigÇtu»
<
LUC_HMP
<
SHA
> >("Te¡D©a/lucs512.d©", "LUC-HMP 512", 
t
);

258 
B’chM¬kSigÇtu»
<
ESIGN
<
SHA
> >("Te¡D©a/esig1023.d©", "ESIGN 1023", 
t
);

259 
B’chM¬kSigÇtu»
<
ESIGN
<
SHA
> >("Te¡D©a/esig1536.d©", "ESIGN 1536", 
t
);

261 
cout
 << "\n<TBODY style=\"background: white\">";

262 
B’chM¬kSigÇtu»
<
RSASS
<
PSSR
, 
SHA
> >("Te¡D©a/r§2048.d©", "RSA 2048", 
t
);

263 
B’chM¬kSigÇtu»
<
RWSS
<
PSSR
, 
SHA
> >("Te¡D©a/rw2048.d©", "RW 2048", 
t
);

264 
B’chM¬kSigÇtu»
<
LUCSS
<
PSSR
, 
SHA
> >("Te¡D©a/luc2048.d©", "LUC 2048", 
t
);

265 
B’chM¬kSigÇtu»
<
NR
<
SHA
> >("Te¡D©a/Ä2048.d©", "NR 2048", 
t
);

266 
B’chM¬kSigÇtu»
<
LUC_HMP
<
SHA
> >("Te¡D©a/lucs1024.d©", "LUC-HMP 1024", 
t
);

267 
B’chM¬kSigÇtu»
<
ESIGN
<
SHA
> >("Te¡D©a/esig2046.d©", "ESIGN 2046", 
t
);

269 
cout
 << "\n<TBODY style=\"background: yellow\">";

270 
B’chM¬kKeyAg»em’t
<
XTR_DH
>("Te¡D©a/xŒdh171.d©", "XTR-DH 171", 
t
);

271 
B’chM¬kKeyAg»em’t
<
XTR_DH
>("Te¡D©a/xŒdh342.d©", "XTR-DH 342", 
t
);

272 
B’chM¬kKeyAg»em’t
<
DH
>("Te¡D©a/dh1024.d©", "DH 1024", 
t
);

273 
B’chM¬kKeyAg»em’t
<
DH
>("Te¡D©a/dh2048.d©", "DH 2048", 
t
);

274 
B’chM¬kKeyAg»em’t
<
LUC_DH
>("Te¡D©a/lucd512.d©", "LUCDIF 512", 
t
);

275 
B’chM¬kKeyAg»em’t
<
LUC_DH
>("Te¡D©a/lucd1024.d©", "LUCDIF 1024", 
t
);

276 
B’chM¬kKeyAg»em’t
<
MQV
>("Te¡D©a/mqv1024.d©", "MQV 1024", 
t
);

277 
B’chM¬kKeyAg»em’t
<
MQV
>("Te¡D©a/mqv2048.d©", "MQV 2048", 
t
);

279 
cout
 << "\n<TBODY style=\"background: white\">";

281 
ECIES
<
ECP
>::
Deüy±Ü
 
	`ıriv
(
	`Glob®RNG
(), 
ASN1
::
	`£ı256k1
());

282 
ECIES
<
ECP
>::
Enüy±Ü
 
	`ıub
(
ıriv
);

283 
ECDSA
<
ECP
, 
SHA
>::
SigÃr
 
	`¥riv
(
ıriv
);

284 
ECDSA
<
ECP
, 
SHA
>::
V”if›r
 
	`¥ub
(
¥riv
);

285 
ECDH
<
ECP
>::
Domaš
 
	`ecdhc
(
ASN1
::
	`£ı256k1
());

286 
ECMQV
<
ECP
>::
Domaš
 
	`ecmqvc
(
ASN1
::
	`£ı256k1
());

288 
	`B’chM¬kEnüy±iÚ
("ECIES ov” GFÕè256", 
ıub
, 
t
);

289 
	`B’chM¬kDeüy±iÚ
("ECIES ov” GFÕè256", 
ıriv
, 
ıub
, 
t
);

290 
	`B’chM¬kSignšg
("ECDSA ov” GFÕè256", 
¥riv
, 
t
);

291 
	`B’chM¬kV”ifiÿtiÚ
("ECDSA ov” GFÕè256", 
¥riv
, 
¥ub
, 
t
);

292 
	`B’chM¬kKeyG’
("ECDHC ov” GFÕè256", 
ecdhc
, 
t
);

293 
	`B’chM¬kAg»em’t
("ECDHC ov” GFÕè256", 
ecdhc
, 
t
);

294 
	`B’chM¬kKeyG’
("ECMQVC ov” GFÕè256", 
ecmqvc
, 
t
);

295 
	`B’chM¬kAg»em’t
("ECMQVC ov” GFÕè256", 
ecmqvc
, 
t
);

298 
cout
 << "<TBODY styË=\"background: y–low\">" << 
’dl
;

300 
ECIES
<
EC2N
>::
Deüy±Ü
 
	`ıriv
(
	`Glob®RNG
(), 
ASN1
::
	`£ù233r1
());

301 
ECIES
<
EC2N
>::
Enüy±Ü
 
	`ıub
(
ıriv
);

302 
ECDSA
<
EC2N
, 
SHA
>::
SigÃr
 
	`¥riv
(
ıriv
);

303 
ECDSA
<
EC2N
, 
SHA
>::
V”if›r
 
	`¥ub
(
¥riv
);

304 
ECDH
<
EC2N
>::
Domaš
 
	`ecdhc
(
ASN1
::
	`£ù233r1
());

305 
ECMQV
<
EC2N
>::
Domaš
 
	`ecmqvc
(
ASN1
::
	`£ù233r1
());

307 
	`B’chM¬kEnüy±iÚ
("ECIES ov” GF(2^nè233", 
ıub
, 
t
);

308 
	`B’chM¬kDeüy±iÚ
("ECIES ov” GF(2^nè233", 
ıriv
, 
ıub
, 
t
);

309 
	`B’chM¬kSignšg
("ECDSA ov” GF(2^nè233", 
¥riv
, 
t
);

310 
	`B’chM¬kV”ifiÿtiÚ
("ECDSA ov” GF(2^nè233", 
¥riv
, 
¥ub
, 
t
);

311 
	`B’chM¬kKeyG’
("ECDHC ov” GF(2^nè233", 
ecdhc
, 
t
);

312 
	`B’chM¬kAg»em’t
("ECDHC ov” GF(2^nè233", 
ecdhc
, 
t
);

313 
	`B’chM¬kKeyG’
("ECMQVC ov” GF(2^nè233", 
ecmqvc
, 
t
);

314 
	`B’chM¬kAg»em’t
("ECMQVC ov” GF(2^nè233", 
ecmqvc
, 
t
);

316 
cout
 << "</TABLE>" << 
’dl
;

317 
	}
}

	@bfinit.cpp

1 
	~"pch.h
"

2 
	~"blowfish.h
"

4 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

6 cÚ¡ 
wÜd32
 
Blowfish
::
Ba£
::
p_š™
[Blowfish::
ROUNDS
+2] =

13 
	}
} ;

15 cÚ¡ 
wÜd32
 
	gBlowfish
::
Ba£
::
s_š™
[4*256] = {

277 
	gNAMESPACE_END


	@blowfish.cpp

3 
	~"pch.h
"

4 
	~"blowfish.h
"

5 
	~"misc.h
"

7 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

9 
Blowfish
::
Ba£
::
	$UncheckedS‘Key
(cÚ¡ 
by‹
 *
key_¡ršg
, 
keyËngth
, cÚ¡ 
NameV®uePaœs
 &)

11 
	`As£¹V®idKeyL’gth
(
keyËngth
);

13 
i
, 
j
=0, 
k
;

14 
wÜd32
 
d©a
, 
d¥aû
[2] = {0, 0};

16 
	`memıy
(
pbox
, 
p_š™
, (p_init));

17 
	`memıy
(
sbox
, 
s_š™
, (s_init));

20 
i
=0 ; i<
ROUNDS
+2 ; ++i)

22 
d©a
 = 0 ;

23 
k
=0 ; k<4 ; ++k )

24 
d©a
 = (d©¨<< 8è| 
key_¡ršg
[
j
++ % 
keyËngth
];

25 
pbox
[
i
] ^ğ
d©a
;

28 
	`üy±_block
(
d¥aû
, 
pbox
);

30 
i
=0; i<
ROUNDS
; i+=2)

31 
	`üy±_block
(
pbox
+
i
,…box+i+2);

33 
	`üy±_block
(
pbox
+
ROUNDS
, 
sbox
);

35 
i
=0; i<4*256-2; i+=2)

36 
	`üy±_block
(
sbox
+
i
, sbox+i+2);

38 ià(!
	`IsFÜw¬dT¿nsfÜm©iÚ
())

39 
i
=0; i<(
ROUNDS
+2)/2; i++)

40 
¡d
::
	`sw­
(
pbox
[
i
],…box[
ROUNDS
+1-i]);

41 
	}
}

44 
	gBlowfish
::
Ba£
::
	$üy±_block
(cÚ¡ 
wÜd32
 
š
[2], wÜd32 
out
[2]) const

46 
wÜd32
 
Ëá
 = 
š
[0];

47 
wÜd32
 
right
 = 
š
[1];

49 cÚ¡ 
wÜd32
 *cÚ¡ 
s
=
sbox
;

50 cÚ¡ 
wÜd32
 *
p
=
pbox
;

52 
Ëá
 ^ğ
p
[0];

54 
i
=0; i<
ROUNDS
/2; i++)

56 
right
 ^ğ(((
s
[
	`GETBYTE
(
Ëá
,3)] + s[256+GETBYTE(left,2)])

57 ^ 
s
[2*256+
	`GETBYTE
(
Ëá
,1)]) + s[3*256+GETBYTE(left,0)])

58 ^ 
p
[2*
i
+1];

60 
Ëá
 ^ğ(((
s
[
	`GETBYTE
(
right
,3)] + s[256+GETBYTE(right,2)])

61 ^ 
s
[2*256+
	`GETBYTE
(
right
,1)]) + s[3*256+GETBYTE(right,0)])

62 ^ 
p
[2*
i
+2];

65 
right
 ^ğ
p
[
ROUNDS
+1];

67 
out
[0] = 
right
;

68 
out
[1] = 
Ëá
;

69 
	}
}

71 
	gBlowfish
::
Ba£
::
	$ProûssAndXÜBlock
(cÚ¡ 
by‹
 *
šBlock
, cÚ¡ by‹ *
xÜBlock
, by‹ *
outBlock
) const

73 
BlockG‘AndPut
<
	twÜd32
, 
	tBigEndŸn
> 
	tBlock
;

75 
wÜd32
 
Ëá
, 
right
;

76 
Block
::
	`G‘
(
šBlock
)(
Ëá
)(
right
);

78 cÚ¡ 
wÜd32
 *cÚ¡ 
s
=
sbox
;

79 cÚ¡ 
wÜd32
 *
p
=
pbox
;

81 
Ëá
 ^ğ
p
[0];

83 
i
=0; i<
ROUNDS
/2; i++)

85 
right
 ^ğ(((
s
[
	`GETBYTE
(
Ëá
,3)] + s[256+GETBYTE(left,2)])

86 ^ 
s
[2*256+
	`GETBYTE
(
Ëá
,1)]) + s[3*256+GETBYTE(left,0)])

87 ^ 
p
[2*
i
+1];

89 
Ëá
 ^ğ(((
s
[
	`GETBYTE
(
right
,3)] + s[256+GETBYTE(right,2)])

90 ^ 
s
[2*256+
	`GETBYTE
(
right
,1)]) + s[3*256+GETBYTE(right,0)])

91 ^ 
p
[2*
i
+2];

94 
right
 ^ğ
p
[
ROUNDS
+1];

96 
Block
::
	`Put
(
xÜBlock
, 
outBlock
)(
right
)(
Ëá
);

97 
	}
}

99 
	gNAMESPACE_END


	@blowfish.h

1 #iâdeà
CRYPTOPP_BLOWFISH_H


2 
	#CRYPTOPP_BLOWFISH_H


	)

6 
	~"£ckey.h
"

7 
	~"£cblock.h
"

9 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

12 
Blowfish_Info
 : 
public
 
FixedBlockSize
<8>,…ubliø
V¬ŸbËKeyL’gth
<16, 4, 56>,…ubliø
FixedRounds
<16>

14 cÚ¡ *
	`SticAlgÜ™hmName
() { "Blowfish";}

15 
	}
};

18 
şass
 
	gBlowfish
 : 
public
 
Blowfish_Info
,…ubliø
	gBlockCh”Docum’tiÚ


20 
şass
 
CRYPTOPP_NO_VTABLE
 
	gBa£
 : 
public
 
BlockCh”Im¶
<
Blowfish_Info
>

22 
public
:

23 
ProûssAndXÜBlock
(cÚ¡ 
by‹
 *
šBlock
, cÚ¡ by‹ *
xÜBlock
, by‹ *
outBlock
) const;

24 
UncheckedS‘Key
(cÚ¡ 
by‹
 *
key_¡ršg
, 
keyËngth
, cÚ¡ 
NameV®uePaœs
 &
·¿ms
);

26 
	g´iv©e
:

27 
üy±_block
(cÚ¡ 
wÜd32
 
š
[2], wÜd32 
out
[2]) const;

29 cÚ¡ 
wÜd32
 
	gp_š™
[
ROUNDS
+2];

30 cÚ¡ 
wÜd32
 
	gs_š™
[4*256];

32 
	gFixedSizeSecBlock
<
	gwÜd32
, 
	gROUNDS
+2> 
	gpbox
;

33 
	gFixedSizeSecBlock
<
	gwÜd32
, 4*256> 
	gsbox
;

36 
	gpublic
:

37 
BlockCh”Fš®
<
	tENCRYPTION
, 
	tBa£
> 
	tEnüy±iÚ
;

38 
	gBlockCh”Fš®
<
	tDECRYPTION
, 
	tBa£
> 
	tDeüy±iÚ
;

41 
	gBlowfish
::
	tEnüy±iÚ
 
	tBlowfishEnüy±iÚ
;

42 
	gBlowfish
::
	tDeüy±iÚ
 
	tBlowfishDeüy±iÚ
;

44 
	gNAMESPACE_END


	@blumshub.cpp

3 
	~"pch.h
"

4 
	~"blumshub.h
"

6 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

8 
PublicBlumBlumShub
::
	$PublicBlumBlumShub
(cÚ¡ 
IÁeg”
 &
n
, cÚ¡ IÁeg” &
£ed
)

9 : 
	`modn
(
n
),

10 
	`maxB™s
(
	`B™P»cisiÚ
(
n
.
	`B™CouÁ
())-1)

12 
cu¼’t
 = 
modn
.
	`Squ¬e
(modn.Squ¬e(
£ed
));

13 
b™sLeá
 = 
maxB™s
;

14 
	}
}

16 
	gPublicBlumBlumShub
::
	$G’”©eB™
()

18 ià(
b™sLeá
==0)

20 
cu¼’t
 = 
modn
.
	`Squ¬e
(current);

21 
b™sLeá
 = 
maxB™s
;

24  
cu¼’t
.
	`G‘B™
(--
b™sLeá
);

25 
	}
}

27 
by‹
 
	gPublicBlumBlumShub
::
	$G’”©eBy‹
()

29 
by‹
 
b
=0;

30 
i
=0; i<8; i++)

31 
b
 = (b << 1è| 
PublicBlumBlumShub
::
	`G’”©eB™
();

32  
b
;

33 
	}
}

35 
	gPublicBlumBlumShub
::
	$G’”©eBlock
(
by‹
 *
ouut
, 
size_t
 
size
)

37 
size
--)

38 *
ouut
++ = 
PublicBlumBlumShub
::
	`G’”©eBy‹
();

39 
	}
}

41 
	gPublicBlumBlumShub
::
	$ProûssD©a
(
by‹
 *
outSŒšg
, cÚ¡ by‹ *
šSŒšg
, 
size_t
 
Ëngth
)

43 
Ëngth
--)

44 *
outSŒšg
++ = *
šSŒšg
++ ^ 
PublicBlumBlumShub
::
	`G’”©eBy‹
();

45 
	}
}

47 
	gBlumBlumShub
::
	$BlumBlumShub
(cÚ¡ 
IÁeg”
 &
p
, cÚ¡ IÁeg” &
q
, cÚ¡ IÁeg” &
£ed
)

48 : 
	`PublicBlumBlumShub
(
p
*
q
, 
£ed
),

49 
	`p
(
p
), 
	`q
(
q
),

50 
	`x0
(
modn
.
	$Squ¬e
(
£ed
))

52 
	}
}

54 
	gBlumBlumShub
::
	$S“k
(
lwÜd
 
šdex
)

56 
IÁeg”
 
	`i
(IÁeg”::
POSITIVE
, 
šdex
);

57 
i
 *= 8;

58 
IÁeg”
 
e
 = 
	`a_exp_b_mod_c
 (2, 
i
 / 
maxB™s
 + 1, (
p
-1)*(
q
-1));

59 
cu¼’t
 = 
modn
.
	`ExpÚ’tŸ‹
(
x0
, 
e
);

60 
b™sLeá
 = 
maxB™s
 - 
i
 % maxBits;

61 
	}
}

63 
	gNAMESPACE_END


	@blumshub.h

1 #iâdeà
CRYPTOPP_BLUMSHUB_H


2 
	#CRYPTOPP_BLUMSHUB_H


	)

4 
	~"mod¬™h.h
"

6 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

8 
şass
 
BlumGŞdwas£rPublicKey
;

9 
şass
 
BlumGŞdwas£rPriv©eKey
;

12 
şass
 
PublicBlumBlumShub
 : 
public
 
RªdomNumb”G’”©Ü
,

13 
public
 
SŒ—mT¿nsfÜm©iÚ


15 
public
:

16 
	`PublicBlumBlumShub
(cÚ¡ 
IÁeg”
 &
n
, cÚ¡ IÁeg” &
£ed
);

18 
	`G’”©eB™
();

19 
by‹
 
	`G’”©eBy‹
();

20 
	`G’”©eBlock
(
by‹
 *
ouut
, 
size_t
 
size
);

21 
	`ProûssD©a
(
by‹
 *
outSŒšg
, cÚ¡ by‹ *
šSŒšg
, 
size_t
 
Ëngth
);

23 
boŞ
 
	`IsS–fInv”tšg
(ècÚ¡ { 
Œue
;}

24 
boŞ
 
	`IsFÜw¬dT¿nsfÜm©iÚ
(ècÚ¡ { 
Œue
;}

26 
´Ùeùed
:

27 
ModuÏrAr™hm‘ic
 
modn
;

28 
wÜd
 
maxB™s
, 
b™sLeá
;

29 
IÁeg”
 
cu¼’t
;

31 
ä›nd
 
şass
 
BlumGŞdwas£rPublicKey
;

32 
ä›nd
 
şass
 
BlumGŞdwas£rPriv©eKey
;

33 
	}
};

36 şas 
	cBlumBlumShub
 : 
public
 
PublicBlumBlumShub


38 
public
:

41 
BlumBlumShub
(cÚ¡ 
IÁeg”
 &
p
, cÚ¡ IÁeg” &
q
, cÚ¡ IÁeg” &
£ed
);

43 
boŞ
 
	$IsRªdomAcûss
(ècÚ¡ { 
Œue
;}

44 
	`S“k
(
lwÜd
 
šdex
);

46 
´Ùeùed
:

47 cÚ¡ 
IÁeg”
 
p
, 
q
;

48 cÚ¡ 
IÁeg”
 
x0
;

49 
	}
};

51 
	gNAMESPACE_END


	@camellia.cpp

12 
	~"pch.h
"

14 
	~"ÿm–lŸ.h
"

15 
	~"misc.h
"

16 
	~"ıu.h
"

18 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

21 
	#SLOW_ROUND
(
lh
, 
Î
, 
rh
, 
¾
, 
kh
, 
kl
) { \

22 
wÜd32
 
zr
 = 
Î
 ^ 
kl
; \

23 
wÜd32
 
zl
 = 
lh
 ^ 
kh
; \

24 
zr
ğ
	`rÙlFixed
(
s1
[
	`GETBYTE
(zr, 3)], 1) | \

25 (
	`rÙrFixed
(
s1
[
	`GETBYTE
(
zr
, 2)], 1) << 24) | \

26 (
s1
[
	`rÙlFixed
(
	`CRYPTOPP_GET_BYTE_AS_BYTE
(
zr
, 1),1)] << 16) | \

27 (
s1
[
	`GETBYTE
(
zr
, 0)] << 8); \

28 
zl
ğ(
s1
[
	`GETBYTE
(zl, 3)] << 24) | \

29 (
	`rÙlFixed
(
s1
[
	`GETBYTE
(
zl
, 2)], 1) << 16) | \

30 (
	`rÙrFixed
(
s1
[
	`GETBYTE
(
zl
, 1)], 1) << 8) | \

31 
s1
[
	`rÙlFixed
(
	`CRYPTOPP_GET_BYTE_AS_BYTE
(
zl
, 0), 1)]; \

32 
zl
 ^ğ
zr
; \

33 
zr
 = 
zl
 ^ 
	`rÙlFixed
(zr, 8); \

34 
zl
 = 
zr
 ^ 
	`rÙrFixed
(zl, 8); \

35 
rh
 ^ğ
	`rÙlFixed
(
zr
, 16); \

36 
rh
 ^ğ
zl
; \

37 
¾
 ^ğ
	`rÙlFixed
(
zl
, 8); \

38 
	}

	)
}

41 
	#ROUND
(
lh
, 
Î
, 
rh
, 
¾
, 
kh
, 
kl
) { \

42 
wÜd32
 
th
 = 
lh
 ^ 
kh
; \

43 
wÜd32
 

 = 
Î
 ^ 
kl
; \

44 
wÜd32
 
d
 = 
SP
[0][
	`GETBYTE
(

,0)] ^ SP[1][GETBYTE(tl,3)] ^ SP[2][GETBYTE(tl,2)] ^ SP[3][GETBYTE(tl,1)]; \

45 
wÜd32
 
u
 = 
SP
[0][
	`GETBYTE
(
th
,3)] ^ SP[1][GETBYTE(th,2)] ^ SP[2][GETBYTE(th,1)] ^ SP[3][GETBYTE(th,0)]; \

46 
d
 ^ğ
u
; \

47 
rh
 ^ğ
d
; \

48 
¾
 ^ğ
d
; \

49 
¾
 ^ğ
	`rÙrFixed
(
u
, 8);}

	)

51 
	#DOUBLE_ROUND
(
lh
, 
Î
, 
rh
, 
¾
, 
k0
, 
k1
, 
k2
, 
k3
) \

52 
	`ROUND
(
lh
, 
Î
, 
rh
, 
¾
, 
k0
, 
k1
) \

53 
	`ROUND
(
rh
, 
¾
, 
lh
, 
Î
, 
k2
, 
k3
)

	)

55 #ifdeà
IS_LITTLE_ENDIAN


56 
	#EFI
(
i
è(1-(i))

	)

58 
	#EFI
(
i
è(i)

	)

61 
	gCam–lŸ
::
Ba£
::
	$UncheckedS‘Key
(cÚ¡ 
by‹
 *
key
, 
keyËn
, cÚ¡ 
NameV®uePaœs
 &)

63 
m_rounds
 = (
keyËn
 >= 24) ? 4 : 3;

64 
k¦’
 = (8 * 
m_rounds
 + 2);

65 
m_key
.
	`New
(
k¦’
*2);

66 
wÜd32
 *
ks32
 = 
m_key
.
	`d©a
();

67 
m
=0, 
a
=0;

68 ià(!
	`IsFÜw¬dT¿nsfÜm©iÚ
())

69 
m
 = -1, 
a
 = 
k¦’
-1;

71 
wÜd32
 
kl0
, 
kl1
, 
kl2
, 
kl3
;

72 
G‘Block
<
wÜd32
, 
BigEndŸn
> 
	`g‘Block
(
key
);

73 
	`g‘Block
(
kl0
)(
kl1
)(
kl2
)(
kl3
);

74 
wÜd32
 
k0
=
kl0
, 
k1
=
kl1
, 
k2
=
kl2
, 
k3
=
kl3
;

76 
	#CALC_ADDR2
(
ba£
, 
i
, 
j
è((
by‹
 *)(ba£)+8*(i)+4*(j)+((-16*(i))&
m
))

	)

77 
	#CALC_ADDR
(
ba£
, 
i
è
	`CALC_ADDR2
(ba£, i, 0)

	)

80 
wÜd64
 
kwl
, 
kwr
;

81 
ks32
 +ğ2*
a
;

82 
	#PREPARE_KS_ROUNDS
 \

83 
kwl
 = (
	`wÜd64
(
k0
è<< 32è| 
k1
; \

84 
kwr
 = (
	`wÜd64
(
k2
è<< 32è| 
k3


	)

85 
	#KS_ROUND_0
(
i
) \

86 *(
wÜd64
*)
	`CALC_ADDR
(
ks32
, 
i
+
	`EFI
(0)èğ
kwl
; \

87 *(
wÜd64
*)
	`CALC_ADDR
(
ks32
, 
i
+
	`EFI
(1)èğ
kwr


	)

88 
	#KS_ROUND
(
i
, 
r
, 
which
) \

89 ià(
which
 & (1<<(
r
<64))è*(
wÜd64
*)
	`CALC_ADDR
(
ks32
, 
i
+
	`EFI
Ô<64)èğ(
kwr
 << (r%64)è| (
kwl
 >> (64 - (r%64))); \

90 ià(
which
 & (1<<(
r
>64))è*(
wÜd64
*)
	`CALC_ADDR
(
ks32
, 
i
+
	`EFI
Ô>64)èğ(
kwl
 << (r%64)è| (
kwr
 >> (64 - (r%64)))

	)

94 
__m128i
 
kw
, 
kw2
;

95 
__m128i
 *
ks128
 = (__m128˜*)
ks32
+
a
/2;

96 
ks32
 +ğ2*
a
;

97 
	#PREPARE_KS_ROUNDS
 \

98 
kw
 = 
	`_mm_£t_•i32
(
k0
, 
k1
, 
k2
, 
k3
); \

99 ià(
m
è
kw2
 = 
kw
, kw = 
	`_mm_shufæe_•i32
(kw, 
	`_MM_SHUFFLE
(1, 0, 3, 2)); \

100 
kw2
 = 
	`_mm_shufæe_•i32
(
kw
, 
	`_MM_SHUFFLE
(1, 0, 3, 2))

	)

101 
	#KS_ROUND_0
(
i
) \

102 
	`_mm_¡Üe_si128
((
__m128i
 *)
	`CALC_ADDR
(
ks128
, 
i
), 
kw
)

	)

103 
	#KS_ROUND
(
i
, 
r
, 
which
) { \

104 
__m128i
 
‹mp
; \

105 ià(
r
<64 && (
which
!=1 || 
m
)è
‹mp
 = 
	`_mm_Ü_si128
(
	`_mm_¦li_•i64
(
kw
,„%64), 
	`_mm_¤li_•i64
(
kw2
, 64-r%64)); \

106 
‹mp
 = 
	`_mm_Ü_si128
(
	`_mm_¦li_•i64
(
kw2
, 
r
%64), 
	`_mm_¤li_•i64
(
kw
, 64-r%64)); \

107 ià(
which
 & 2è
	`_mm_¡Üe_si128
((
__m128i
 *)
	`CALC_ADDR
(
ks128
, 
i
), 
‹mp
); \

108 
	`_mm_¡Ü–_•i64
((
__m128i
*)
	`CALC_ADDR
(
ks32
, 
i
+
	`EFI
(0)), 
‹mp
); \

109 }

	)

112 ià(
keyËn
 == 16)

115 
PREPARE_KS_ROUNDS
;

116 
	`KS_ROUND_0
(0);

117 
	`KS_ROUND
(4, 15, 3);

118 
	`KS_ROUND
(10, 45, 3);

119 
	`KS_ROUND
(12, 60, 2);

120 
	`KS_ROUND
(16, 77, 3);

121 
	`KS_ROUND
(18, 94, 3);

122 
	`KS_ROUND
(22, 111, 3);

125 
k0
=
kl0
, 
k1
=
kl1
, 
k2
=
kl2
, 
k3
=
kl3
;

126 
	`DOUBLE_ROUND
(
k0
, 
k1
, 
k2
, 
k3
, 0xA09E667Ful, 0x3BCC908Bul, 0xB67AE858ul, 0x4CAA73B2ul);

127 
k0
^=
kl0
, 
k1
^=
kl1
, 
k2
^=
kl2
, 
k3
^=
kl3
;

128 
	`DOUBLE_ROUND
(
k0
, 
k1
, 
k2
, 
k3
, 0xC6EF372Ful, 0xE94F82BEul, 0x54FF53A5ul, 0xF1D36F1Cul);

130 
PREPARE_KS_ROUNDS
;

131 
	`KS_ROUND_0
(2);

132 
	`KS_ROUND
(6, 15, 3);

133 
	`KS_ROUND
(8, 30, 3);

134 
	`KS_ROUND
(12, 45, 1);

135 
	`KS_ROUND
(14, 60, 3);

136 
	`KS_ROUND
(20, 94, 3);

137 
	`KS_ROUND
(24, 47, 3);

142 
PREPARE_KS_ROUNDS
;

143 
	`KS_ROUND_0
(0);

144 
	`KS_ROUND
(12, 45, 3);

145 
	`KS_ROUND
(16, 60, 3);

146 
	`KS_ROUND
(22, 77, 3);

147 
	`KS_ROUND
(30, 111, 3);

150 
wÜd32
 
kr0
, 
kr1
, 
kr2
, 
kr3
;

151 
G‘Block
<
wÜd32
, 
BigEndŸn
>(
key
+16)(
kr0
)(
kr1
);

152 ià(
keyËn
 == 24)

153 
kr2
 = ~
kr0
, 
kr3
 = ~
kr1
;

155 
G‘Block
<
wÜd32
, 
BigEndŸn
>(
key
+24)(
kr2
)(
kr3
);

156 
k0
=
kr0
, 
k1
=
kr1
, 
k2
=
kr2
, 
k3
=
kr3
;

158 
PREPARE_KS_ROUNDS
;

159 
	`KS_ROUND
(4, 15, 3);

160 
	`KS_ROUND
(8, 30, 3);

161 
	`KS_ROUND
(18, 60, 3);

162 
	`KS_ROUND
(26, 94, 3);

165 
k0
^=
kl0
, 
k1
^=
kl1
, 
k2
^=
kl2
, 
k3
^=
kl3
;

166 
	`DOUBLE_ROUND
(
k0
, 
k1
, 
k2
, 
k3
, 0xA09E667Ful, 0x3BCC908Bul, 0xB67AE858ul, 0x4CAA73B2ul);

167 
k0
^=
kl0
, 
k1
^=
kl1
, 
k2
^=
kl2
, 
k3
^=
kl3
;

168 
	`DOUBLE_ROUND
(
k0
, 
k1
, 
k2
, 
k3
, 0xC6EF372Ful, 0xE94F82BEul, 0x54FF53A5ul, 0xF1D36F1Cul);

170 
PREPARE_KS_ROUNDS
;

171 
	`KS_ROUND
(6, 15, 3);

172 
	`KS_ROUND
(14, 45, 3);

173 
	`KS_ROUND
(24, 77, 3);

174 
	`KS_ROUND
(28, 94, 3);

177 
k0
^=
kr0
, 
k1
^=
kr1
, 
k2
^=
kr2
, 
k3
^=
kr3
;

178 
	`DOUBLE_ROUND
(
k0
, 
k1
, 
k2
, 
k3
, 0x10E527FAul, 0xDE682D1Dul, 0xB05688C2ul, 0xB3E6C1FDul);

180 
PREPARE_KS_ROUNDS
;

181 
	`KS_ROUND_0
(2);

182 
	`KS_ROUND
(10, 30, 3);

183 
	`KS_ROUND
(20, 60, 3);

184 
	`KS_ROUND
(32, 47, 3);

186 
	}
}

188 
	gCam–lŸ
::
Ba£
::
	$ProûssAndXÜBlock
(cÚ¡ 
by‹
 *
šBlock
, cÚ¡ by‹ *
xÜBlock
, by‹ *
outBlock
) const

190 
	#KS
(
i
, 
j
è
ks
[i*4 + 
	`EFI
(j/2)*2 + EFI(j%2)]

	)

192 
	#FL
(
klh
, 
kÎ
, 
krh
, 
k¾
) \

193 
Î
 ^ğ
	`rÙlFixed
(
lh
 & 
klh
, 1); \

194 
lh
 ^ğ(
Î
 | 
kÎ
); \

195 
rh
 ^ğ(
¾
 | 
k¾
); \

196 
¾
 ^ğ
	`rÙlFixed
(
rh
 & 
krh
, 1);

	)

198 
wÜd32
 
lh
, 
Î
, 
rh
, 
¾
;

199 
BlockG‘AndPut
<
	twÜd32
, 
	tBigEndŸn
> 
	tBlock
;

200 
Block
::
	`G‘
(
šBlock
)(
lh
)(
Î
)(
rh
)(
¾
);

201 cÚ¡ 
wÜd32
 *
ks
 = 
m_key
.
	`d©a
();

202 
lh
 ^ğ
	`KS
(0,0);

203 
Î
 ^ğ
	`KS
(0,1);

204 
rh
 ^ğ
	`KS
(0,2);

205 
¾
 ^ğ
	`KS
(0,3);

208 cÚ¡ 
ÿcheLšeSize
 = 
	`G‘CacheLšeSize
();

209 
i
;

210 
wÜd32
 
u
 = 0;

211 
i
=0; i<256; i+=
ÿcheLšeSize
)

212 
u
 &ğ*(cÚ¡ 
wÜd32
 *)(
s1
+
i
);

213 
u
 &ğ*(cÚ¡ 
wÜd32
 *)(
s1
+252);

214 
lh
 |ğ
u
; 
Î
 |= u;

216 
	`SLOW_ROUND
(
lh
, 
Î
, 
rh
, 
¾
, 
	`KS
(1,0), KS(1,1))

217 
	`SLOW_ROUND
(
rh
, 
¾
, 
lh
, 
Î
, 
	`KS
(1,2), KS(1,3))

218 
i
 = 
m_rounds
-1; i > 0; --i)

220 
	`DOUBLE_ROUND
(
lh
, 
Î
, 
rh
, 
¾
, 
	`KS
(2,0), KS(2,1), KS(2,2), KS(2,3))

221 
	`DOUBLE_ROUND
(
lh
, 
Î
, 
rh
, 
¾
, 
	`KS
(3,0), KS(3,1), KS(3,2), KS(3,3))

222 
	`FL
(
	`KS
(4,0), KS(4,1), KS(4,2), KS(4,3));

223 
	`DOUBLE_ROUND
(
lh
, 
Î
, 
rh
, 
¾
, 
	`KS
(5,0), KS(5,1), KS(5,2), KS(5,3))

224 
ks
 += 16;

226 
	`DOUBLE_ROUND
(
lh
, 
Î
, 
rh
, 
¾
, 
	`KS
(2,0), KS(2,1), KS(2,2), KS(2,3))

227 
	`ROUND
(
lh
, 
Î
, 
rh
, 
¾
, 
	`KS
(3,0), KS(3,1))

228 
	`SLOW_ROUND
(
rh
, 
¾
, 
lh
, 
Î
, 
	`KS
(3,2), KS(3,3))

229 
lh
 ^ğ
	`KS
(4,0);

230 
Î
 ^ğ
	`KS
(4,1);

231 
rh
 ^ğ
	`KS
(4,2);

232 
¾
 ^ğ
	`KS
(4,3);

233 
Block
::
	`Put
(
xÜBlock
, 
outBlock
)(
rh
)(
¾
)(
lh
)(
Î
);

234 
	}
}

238 cÚ¡ 
by‹
 
	gCam–lŸ
::
Ba£
::
s1
[256] =

258 cÚ¡ 
wÜd32
 
	gCam–lŸ
::
Ba£
::
SP
[4][256] = {

524 
	gNAMESPACE_END


	@camellia.h

1 #iâdeà
CRYPTOPP_CAMELLIA_H


2 
	#CRYPTOPP_CAMELLIA_H


	)

4 
	~"cÚfig.h
"

9 
	~"£ckey.h
"

10 
	~"£cblock.h
"

12 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

15 
Cam–lŸ_Info
 : 
public
 
FixedBlockSize
<16>,…ubliø
V¬ŸbËKeyL’gth
<16, 16, 32, 8>

17 cÚ¡ *
	`SticAlgÜ™hmName
() { "Camellia";}

18 
	}
};

21 
şass
 
	gCam–lŸ
 : 
public
 
Cam–lŸ_Info
,…ubliø
	gBlockCh”Docum’tiÚ


23 
şass
 
CRYPTOPP_NO_VTABLE
 
	gBa£
 : 
public
 
BlockCh”Im¶
<
Cam–lŸ_Info
>

25 
public
:

26 
UncheckedS‘Key
(cÚ¡ 
by‹
 *
key
, 
keyËn
, cÚ¡ 
NameV®uePaœs
 &
·¿ms
);

27 
ProûssAndXÜBlock
(cÚ¡ 
by‹
 *
šBlock
, cÚ¡ by‹ *
xÜBlock
, by‹ *
outBlock
) const;

29 
	g´Ùeùed
:

30 cÚ¡ 
by‹
 
s1
[256];

31 cÚ¡ 
wÜd32
 
	gSP
[4][256];

33 
	gm_rounds
;

34 
	gSecBlock
<
	gwÜd32
> 
	gm_key
;

37 
	gpublic
:

38 
BlockCh”Fš®
<
	tENCRYPTION
, 
	tBa£
> 
	tEnüy±iÚ
;

39 
	gBlockCh”Fš®
<
	tDECRYPTION
, 
	tBa£
> 
	tDeüy±iÚ
;

42 
	gCam–lŸ
::
	tEnüy±iÚ
 
	tCam–lŸEnüy±iÚ
;

43 
	gCam–lŸ
::
	tDeüy±iÚ
 
	tCam–lŸDeüy±iÚ
;

45 
	gNAMESPACE_END


	@cast.cpp

4 
	~"pch.h
"

5 
	~"ÿ¡.h
"

6 
	~"misc.h
"

8 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

11 
	#U8a
(
x
è
	`GETBYTE
(x,3)

	)

12 
	#U8b
(
x
è
	`GETBYTE
(x,2)

	)

13 
	#U8c
(
x
è
	`GETBYTE
(x,1)

	)

14 
	#U8d
(
x
è
	`GETBYTE
(x,0)

	)

17 
	#f1
(
l
, 
r
, 
km
, 
kr
) \

18 
t
 = 
	`rÙlV¬ŸbË
(
km
 + 
r
, 
kr
); \

19 
l
 ^ğ((
S
[0][
	`U8a
(
t
)] ^ S[1][
	`U8b
(t)]) - \

20 
S
[2][
	`U8c
(
t
)]è+ S[3][
	`U8d
Ñ)];

	)

21 
	#f2
(
l
, 
r
, 
km
, 
kr
) \

22 
t
 = 
	`rÙlV¬ŸbË
(
km
 ^ 
r
, 
kr
); \

23 
l
 ^ğ((
S
[0][
	`U8a
(
t
)] - S[1][
	`U8b
(t)]) + \

24 
S
[2][
	`U8c
(
t
)]è^ S[3][
	`U8d
Ñ)];

	)

25 
	#f3
(
l
, 
r
, 
km
, 
kr
) \

26 
t
 = 
	`rÙlV¬ŸbË
(
km
 - 
r
, 
kr
); \

27 
l
 ^ğ((
S
[0][
	`U8a
(
t
)] + S[1][
	`U8b
(t)]) ^ \

28 
S
[2][
	`U8c
(
t
)]è- S[3][
	`U8d
Ñ)];

	)

30 
	#F1
(
l
, 
r
, 
i
, 
j
è
	`f1
Ö,„, 
K
[i], K[i+j])

	)

31 
	#F2
(
l
, 
r
, 
i
, 
j
è
	`f2
Ö,„, 
K
[i], K[i+j])

	)

32 
	#F3
(
l
, 
r
, 
i
, 
j
è
	`f3
Ö,„, 
K
[i], K[i+j])

	)

34 
BlockG‘AndPut
<
	twÜd32
, 
	tBigEndŸn
> 
	tBlock
;

36 
CAST128
::
Enc
::
	$ProûssAndXÜBlock
(cÚ¡ 
by‹
 *
šBlock
, cÚ¡ by‹ *
xÜBlock
, by‹ *
outBlock
) const

38 
wÜd32
 
t
, 
l
, 
r
;

41 
Block
::
	`G‘
(
šBlock
)(
l
)(
r
);

43 
	`F1
(
l
, 
r
, 0, 16);

44 
	`F2
(
r
, 
l
, 1, 16);

45 
	`F3
(
l
, 
r
, 2, 16);

46 
	`F1
(
r
, 
l
, 3, 16);

47 
	`F2
(
l
, 
r
, 4, 16);

48 
	`F3
(
r
, 
l
, 5, 16);

49 
	`F1
(
l
, 
r
, 6, 16);

50 
	`F2
(
r
, 
l
, 7, 16);

51 
	`F3
(
l
, 
r
, 8, 16);

52 
	`F1
(
r
, 
l
, 9, 16);

53 
	`F2
(
l
, 
r
, 10, 16);

54 
	`F3
(
r
, 
l
, 11, 16);

56 ià(!
»duûd
) {

57 
	`F1
(
l
, 
r
, 12, 16);

58 
	`F2
(
r
, 
l
, 13, 16);

59 
	`F3
(
l
, 
r
, 14, 16);

60 
	`F1
(
r
, 
l
, 15, 16);

63 
Block
::
	`Put
(
xÜBlock
, 
outBlock
)(
r
)(
l
);

64 
	}
}

66 
	gCAST128
::
Dec
::
	$ProûssAndXÜBlock
(cÚ¡ 
by‹
 *
šBlock
, cÚ¡ by‹ *
xÜBlock
, by‹ *
outBlock
) const

68 
wÜd32
 
t
, 
l
, 
r
;

71 
Block
::
	`G‘
(
šBlock
)(
r
)(
l
);

73 ià(!
»duûd
) {

74 
	`F1
(
r
, 
l
, 15, 16);

75 
	`F3
(
l
, 
r
, 14, 16);

76 
	`F2
(
r
, 
l
, 13, 16);

77 
	`F1
(
l
, 
r
, 12, 16);

79 
	`F3
(
r
, 
l
, 11, 16);

80 
	`F2
(
l
, 
r
, 10, 16);

81 
	`F1
(
r
, 
l
, 9, 16);

82 
	`F3
(
l
, 
r
, 8, 16);

83 
	`F2
(
r
, 
l
, 7, 16);

84 
	`F1
(
l
, 
r
, 6, 16);

85 
	`F3
(
r
, 
l
, 5, 16);

86 
	`F2
(
l
, 
r
, 4, 16);

87 
	`F1
(
r
, 
l
, 3, 16);

88 
	`F3
(
l
, 
r
, 2, 16);

89 
	`F2
(
r
, 
l
, 1, 16);

90 
	`F1
(
l
, 
r
, 0, 16);

92 
Block
::
	`Put
(
xÜBlock
, 
outBlock
)(
l
)(
r
);

94 
t
 = 
l
 = 
r
 = 0;

95 
	}
}

97 
	gCAST128
::
Ba£
::
	$UncheckedS‘Key
(cÚ¡ 
by‹
 *
u£rKey
, 
keyËngth
, cÚ¡ 
NameV®uePaœs
 &)

99 
	`As£¹V®idKeyL’gth
(
keyËngth
);

101 
»duûd
 = (
keyËngth
 <= 10);

103 
wÜd32
 
X
[4], 
Z
[4];

104 
	`G‘U£rKey
(
BIG_ENDIAN_ORDER
, 
X
, 4, 
u£rKey
, 
keyËngth
);

106 
	#x
(
i
è
	`GETBYTE
(
X
[i/4], 3-i%4)

	)

107 
	#z
(
i
è
	`GETBYTE
(
Z
[i/4], 3-i%4)

	)

109 
i
;

110 
i
=0; i<=16; i+=16)

113 
Z
[0] = 
X
[0] ^ 
S
[4][
	`x
(0xD)] ^ S[5][x(0xF)] ^ S[6][x(0xC)] ^ S[7][x(0xE)] ^ S[6][x(0x8)];

114 
Z
[1] = 
X
[2] ^ 
S
[4][
	`z
(0x0)] ^ S[5][z(0x2)] ^ S[6][z(0x1)] ^ S[7][z(0x3)] ^ S[7][
	`x
(0xA)];

115 
Z
[2] = 
X
[3] ^ 
S
[4][
	`z
(0x7)] ^ S[5][z(0x6)] ^ S[6][z(0x5)] ^ S[7][z(0x4)] ^ S[4][
	`x
(0x9)];

116 
Z
[3] = 
X
[1] ^ 
S
[4][
	`z
(0xA)] ^ S[5][z(0x9)] ^ S[6][z(0xB)] ^ S[7][z(0x8)] ^ S[5][
	`x
(0xB)];

117 
K
[
i
+0] = 
S
[4][
	`z
(0x8)] ^ S[5][z(0x9)] ^ S[6][z(0x7)] ^ S[7][z(0x6)] ^ S[4][z(0x2)];

118 
K
[
i
+1] = 
S
[4][
	`z
(0xA)] ^ S[5][z(0xB)] ^ S[6][z(0x5)] ^ S[7][z(0x4)] ^ S[5][z(0x6)];

119 
K
[
i
+2] = 
S
[4][
	`z
(0xC)] ^ S[5][z(0xD)] ^ S[6][z(0x3)] ^ S[7][z(0x2)] ^ S[6][z(0x9)];

120 
K
[
i
+3] = 
S
[4][
	`z
(0xE)] ^ S[5][z(0xF)] ^ S[6][z(0x1)] ^ S[7][z(0x0)] ^ S[7][z(0xC)];

121 
X
[0] = 
Z
[2] ^ 
S
[4][
	`z
(0x5)] ^ S[5][z(0x7)] ^ S[6][z(0x4)] ^ S[7][z(0x6)] ^ S[6][z(0x0)];

122 
X
[1] = 
Z
[0] ^ 
S
[4][
	`x
(0x0)] ^ S[5][x(0x2)] ^ S[6][x(0x1)] ^ S[7][x(0x3)] ^ S[7][
	`z
(0x2)];

123 
X
[2] = 
Z
[1] ^ 
S
[4][
	`x
(0x7)] ^ S[5][x(0x6)] ^ S[6][x(0x5)] ^ S[7][x(0x4)] ^ S[4][
	`z
(0x1)];

124 
X
[3] = 
Z
[3] ^ 
S
[4][
	`x
(0xA)] ^ S[5][x(0x9)] ^ S[6][x(0xB)] ^ S[7][x(0x8)] ^ S[5][
	`z
(0x3)];

125 
K
[
i
+4] = 
S
[4][
	`x
(0x3)] ^ S[5][x(0x2)] ^ S[6][x(0xC)] ^ S[7][x(0xD)] ^ S[4][x(0x8)];

126 
K
[
i
+5] = 
S
[4][
	`x
(0x1)] ^ S[5][x(0x0)] ^ S[6][x(0xE)] ^ S[7][x(0xF)] ^ S[5][x(0xD)];

127 
K
[
i
+6] = 
S
[4][
	`x
(0x7)] ^ S[5][x(0x6)] ^ S[6][x(0x8)] ^ S[7][x(0x9)] ^ S[6][x(0x3)];

128 
K
[
i
+7] = 
S
[4][
	`x
(0x5)] ^ S[5][x(0x4)] ^ S[6][x(0xA)] ^ S[7][x(0xB)] ^ S[7][x(0x7)];

129 
Z
[0] = 
X
[0] ^ 
S
[4][
	`x
(0xD)] ^ S[5][x(0xF)] ^ S[6][x(0xC)] ^ S[7][x(0xE)] ^ S[6][x(0x8)];

130 
Z
[1] = 
X
[2] ^ 
S
[4][
	`z
(0x0)] ^ S[5][z(0x2)] ^ S[6][z(0x1)] ^ S[7][z(0x3)] ^ S[7][
	`x
(0xA)];

131 
Z
[2] = 
X
[3] ^ 
S
[4][
	`z
(0x7)] ^ S[5][z(0x6)] ^ S[6][z(0x5)] ^ S[7][z(0x4)] ^ S[4][
	`x
(0x9)];

132 
Z
[3] = 
X
[1] ^ 
S
[4][
	`z
(0xA)] ^ S[5][z(0x9)] ^ S[6][z(0xB)] ^ S[7][z(0x8)] ^ S[5][
	`x
(0xB)];

133 
K
[
i
+8] = 
S
[4][
	`z
(0x3)] ^ S[5][z(0x2)] ^ S[6][z(0xC)] ^ S[7][z(0xD)] ^ S[4][z(0x9)];

134 
K
[
i
+9] = 
S
[4][
	`z
(0x1)] ^ S[5][z(0x0)] ^ S[6][z(0xE)] ^ S[7][z(0xF)] ^ S[5][z(0xC)];

135 
K
[
i
+10] = 
S
[4][
	`z
(0x7)] ^ S[5][z(0x6)] ^ S[6][z(0x8)] ^ S[7][z(0x9)] ^ S[6][z(0x2)];

136 
K
[
i
+11] = 
S
[4][
	`z
(0x5)] ^ S[5][z(0x4)] ^ S[6][z(0xA)] ^ S[7][z(0xB)] ^ S[7][z(0x6)];

137 
X
[0] = 
Z
[2] ^ 
S
[4][
	`z
(0x5)] ^ S[5][z(0x7)] ^ S[6][z(0x4)] ^ S[7][z(0x6)] ^ S[6][z(0x0)];

138 
X
[1] = 
Z
[0] ^ 
S
[4][
	`x
(0x0)] ^ S[5][x(0x2)] ^ S[6][x(0x1)] ^ S[7][x(0x3)] ^ S[7][
	`z
(0x2)];

139 
X
[2] = 
Z
[1] ^ 
S
[4][
	`x
(0x7)] ^ S[5][x(0x6)] ^ S[6][x(0x5)] ^ S[7][x(0x4)] ^ S[4][
	`z
(0x1)];

140 
X
[3] = 
Z
[3] ^ 
S
[4][
	`x
(0xA)] ^ S[5][x(0x9)] ^ S[6][x(0xB)] ^ S[7][x(0x8)] ^ S[5][
	`z
(0x3)];

141 
K
[
i
+12] = 
S
[4][
	`x
(0x8)] ^ S[5][x(0x9)] ^ S[6][x(0x7)] ^ S[7][x(0x6)] ^ S[4][x(0x3)];

142 
K
[
i
+13] = 
S
[4][
	`x
(0xA)] ^ S[5][x(0xB)] ^ S[6][x(0x5)] ^ S[7][x(0x4)] ^ S[5][x(0x7)];

143 
K
[
i
+14] = 
S
[4][
	`x
(0xC)] ^ S[5][x(0xD)] ^ S[6][x(0x3)] ^ S[7][x(0x2)] ^ S[6][x(0x8)];

144 
K
[
i
+15] = 
S
[4][
	`x
(0xE)] ^ S[5][x(0xF)] ^ S[6][x(0x1)] ^ S[7][x(0x0)] ^ S[7][x(0xD)];

147 
i
=16; i<32; i++)

148 
K
[
i
] &= 0x1f;

149 
	}
}

153 cÚ¡ 
wÜd32
 
	gCAST256
::
Ba£
::
t_m
[8][24]={

188 cÚ¡ 
	gCAST256
::
Ba£
::
t_r
[8][24]={

199 
	#Q
(
i
) \

200 
	`F1
(
block
[2],block[3],8*
i
+4,-4); \

201 
	`F2
(
block
[1],block[2],8*
i
+5,-4); \

202 
	`F3
(
block
[0],block[1],8*
i
+6,-4); \

203 
	`F1
(
block
[3],block[0],8*
i
+7,-4);

	)

205 
	#QB¬
(
i
) \

206 
	`F1
(
block
[3],block[0],8*
i
+7,-4); \

207 
	`F3
(
block
[0],block[1],8*
i
+6,-4); \

208 
	`F2
(
block
[1],block[2],8*
i
+5,-4); \

209 
	`F1
(
block
[2],block[3],8*
i
+4,-4);

	)

214 
	gCAST256
::
Ba£
::
	$ProûssAndXÜBlock
(cÚ¡ 
by‹
 *
šBlock
, cÚ¡ by‹ *
xÜBlock
, by‹ *
outBlock
) const

216 
wÜd32
 
t
, 
block
[4];

217 
Block
::
	`G‘
(
šBlock
)(
block
[0])(block[1])(block[2])(block[3]);

220 
	`Q
(0);

221 
	`Q
(1);

222 
	`Q
(2);

223 
	`Q
(3);

224 
	`Q
(4);

225 
	`Q
(5);

228 
	`QB¬
(6);

229 
	`QB¬
(7);

230 
	`QB¬
(8);

231 
	`QB¬
(9);

232 
	`QB¬
(10);

233 
	`QB¬
(11);

235 
Block
::
	`Put
(
xÜBlock
, 
outBlock
)(
block
[0])(block[1])(block[2])(block[3]);

236 
	}
}

240 
	gCAST256
::
Ba£
::
	$Omega
(
i
, 
wÜd32
 
k­·
[8])

242 
wÜd32
 
t
;

244 
	`f1
(
k­·
[6],k­·[7],
t_m
[0][
i
],
t_r
[0][i]);

245 
	`f2
(
k­·
[5],k­·[6],
t_m
[1][
i
],
t_r
[1][i]);

246 
	`f3
(
k­·
[4],k­·[5],
t_m
[2][
i
],
t_r
[2][i]);

247 
	`f1
(
k­·
[3],k­·[4],
t_m
[3][
i
],
t_r
[3][i]);

248 
	`f2
(
k­·
[2],k­·[3],
t_m
[4][
i
],
t_r
[4][i]);

249 
	`f3
(
k­·
[1],k­·[2],
t_m
[5][
i
],
t_r
[5][i]);

250 
	`f1
(
k­·
[0],k­·[1],
t_m
[6][
i
],
t_r
[6][i]);

251 
	`f2
(
k­·
[7],k­·[0],
t_m
[7][
i
],
t_r
[7][i]);

252 
	}
}

254 
	gCAST256
::
Ba£
::
	$UncheckedS‘Key
(cÚ¡ 
by‹
 *
u£rKey
, 
keyËngth
, cÚ¡ 
NameV®uePaœs
 &)

256 
	`As£¹V®idKeyL’gth
(
keyËngth
);

258 
wÜd32
 
k­·
[8];

259 
	`G‘U£rKey
(
BIG_ENDIAN_ORDER
, 
k­·
, 8, 
u£rKey
, 
keyËngth
);

261 
i
=0; i<12; ++i)

263 
	`Omega
(2*
i
,
k­·
);

264 
	`Omega
(2*
i
+1,
k­·
);

266 
K
[8*
i
]=
k­·
[0] & 31;

267 
K
[8*
i
+1]=
k­·
[2] & 31;

268 
K
[8*
i
+2]=
k­·
[4] & 31;

269 
K
[8*
i
+3]=
k­·
[6] & 31;

270 
K
[8*
i
+4]=
k­·
[7];

271 
K
[8*
i
+5]=
k­·
[5];

272 
K
[8*
i
+6]=
k­·
[3];

273 
K
[8*
i
+7]=
k­·
[1];

276 ià(!
	`IsFÜw¬dT¿nsfÜm©iÚ
())

278 
j
=0; j<6; ++j)

280 
i
=0; i<4; ++i)

282 
i1
=8*
j
+
i
;

283 
i2
=8*(11-
j
)+
i
;

285 
	`as£¹
(
i1
<
i2
);

287 
¡d
::
	`sw­
(
K
[
i1
],K[
i2
]);

288 
¡d
::
	`sw­
(
K
[
i1
+4],K[
i2
+4]);

293 
	`mem£t
(
k­·
, 0, (kappa));

294 
	}
}

296 
	gNAMESPACE_END


	@cast.h

1 #iâdeà
CRYPTOPP_CAST_H


2 
	#CRYPTOPP_CAST_H


	)

7 
	~"£ckey.h
"

8 
	~"£cblock.h
"

10 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

12 şas 
	cCAST


14 
´Ùeùed
:

15 cÚ¡ 
wÜd32
 
S
[8][256];

19 
CAST128_Info
 : 
public
 
FixedBlockSize
<8>,…ubliø
V¬ŸbËKeyL’gth
<16, 5, 16>

21 cÚ¡ *
	`SticAlgÜ™hmName
() { "CAST-128";}

22 
	}
};

25 
şass
 
	gCAST128
 : 
public
 
CAST128_Info
,…ubliø
	gBlockCh”Docum’tiÚ


27 
şass
 
CRYPTOPP_NO_VTABLE
 
	gBa£
 : 
public
 
CAST
,…ubliø
	gBlockCh”Im¶
<
	gCAST128_Info
>

29 
	gpublic
:

30 
UncheckedS‘Key
(cÚ¡ 
by‹
 *
u£rKey
, 
Ëngth
, cÚ¡ 
NameV®uePaœs
 &
·¿ms
);

32 
	g´Ùeùed
:

33 
boŞ
 
»duûd
;

34 
	gFixedSizeSecBlock
<
	gwÜd32
, 32> 
	gK
;

37 şas 
	cCRYPTOPP_NO_VTABLE
 
	gEnc
 : 
public
 
Ba£


39 
public
:

40 
ProûssAndXÜBlock
(cÚ¡ 
by‹
 *
šBlock
, cÚ¡ by‹ *
xÜBlock
, by‹ *
outBlock
) const;

43 şas 
	cCRYPTOPP_NO_VTABLE
 
	gDec
 : 
public
 
Ba£


45 
public
:

46 
ProûssAndXÜBlock
(cÚ¡ 
by‹
 *
šBlock
, cÚ¡ by‹ *
xÜBlock
, by‹ *
outBlock
) const;

49 
	gpublic
:

50 
BlockCh”Fš®
<
	tENCRYPTION
, 
	tEnc
> 
	tEnüy±iÚ
;

51 
	gBlockCh”Fš®
<
	tDECRYPTION
, 
	tDec
> 
	tDeüy±iÚ
;

55 
	gCAST256_Info
 : 
public
 
FixedBlockSize
<16>,…ubliø
	gV¬ŸbËKeyL’gth
<16, 16, 32>

57 cÚ¡ *
SticAlgÜ™hmName
() { "CAST-256";}

61 
şass
 
	gCAST256
 : 
public
 
CAST256_Info
,…ubliø
	gBlockCh”Docum’tiÚ


63 
şass
 
CRYPTOPP_NO_VTABLE
 
	gBa£
 : 
public
 
CAST
,…ubliø
	gBlockCh”Im¶
<
	gCAST256_Info
>

65 
	gpublic
:

66 
UncheckedS‘Key
(cÚ¡ 
by‹
 *
u£rKey
, 
Ëngth
, cÚ¡ 
NameV®uePaœs
 &
·¿ms
);

67 
ProûssAndXÜBlock
(cÚ¡ 
by‹
 *
šBlock
, cÚ¡ by‹ *
xÜBlock
, by‹ *
outBlock
) const;

69 
	g´Ùeùed
:

70 cÚ¡ 
wÜd32
 
t_m
[8][24];

71 cÚ¡ 
	gt_r
[8][24];

73 
Omega
(
i
, 
wÜd32
 
k­·
[8]);

75 
	gFixedSizeSecBlock
<
	gwÜd32
, 8*12> 
	gK
;

78 
	gpublic
:

79 
BlockCh”Fš®
<
	tENCRYPTION
, 
	tBa£
> 
	tEnüy±iÚ
;

80 
	gBlockCh”Fš®
<
	tDECRYPTION
, 
	tBa£
> 
	tDeüy±iÚ
;

83 
	gCAST128
::
	tEnüy±iÚ
 
	tCAST128Enüy±iÚ
;

84 
	gCAST128
::
	tDeüy±iÚ
 
	tCAST128Deüy±iÚ
;

86 
	gCAST256
::
	tEnüy±iÚ
 
	tCAST256Enüy±iÚ
;

87 
	gCAST256
::
	tDeüy±iÚ
 
	tCAST256Deüy±iÚ
;

89 
	gNAMESPACE_END


	@casts.cpp

1 
	~"pch.h
"

2 
	~"ÿ¡.h
"

4 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

8 cÚ¡ 
wÜd32
 
CAST
::
S
[8][256] = {

543 }
	}
};

545 
	gNAMESPACE_END


	@cbcmac.cpp

1 
	~"pch.h
"

3 #iâdeà
CRYPTOPP_IMPORTS


5 
	~"cbcmac.h
"

7 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

9 
CBC_MAC_Ba£
::
	$UncheckedS‘Key
(cÚ¡ 
by‹
 *
key
, 
Ëngth
, cÚ¡ 
NameV®uePaœs
 &
·¿ms
)

11 
	`AcûssCh”
().
	`S‘Key
(
key
, 
Ëngth
, 
·¿ms
);

12 
m_»g
.
	`CËªNew
(
	`AcûssCh”
().
	`BlockSize
());

13 
m_couÁ”
 = 0;

14 
	}
}

16 
	gCBC_MAC_Ba£
::
	$Upd©e
(cÚ¡ 
by‹
 *
šput
, 
size_t
 
Ëngth
)

18 
blockSize
 = 
	`AcûssCh”
().
	`BlockSize
();

20 
m_couÁ”
 && 
Ëngth
)

22 
m_»g
[
m_couÁ”
++] ^ğ*
šput
++;

23 ià(
m_couÁ”
 =ğ
blockSize
)

24 
	`ProûssBuf
();

25 
Ëngth
--;

28 ià(
Ëngth
 >ğ
blockSize
)

30 
size_t
 
ËáOv”
 = 
	`AcûssCh”
().
	`AdvªûdProûssBlocks
(
m_»g
, 
šput
, m_»g, 
Ëngth
, 
BlockT¿nsfÜm©iÚ
::
BT_DÚtInüem’tInOutPoš‹rs
|BlockT¿nsfÜm©iÚ::
BT_XÜIÅut
);

31 
šput
 +ğ(
Ëngth
 - 
ËáOv”
);

32 
Ëngth
 = 
ËáOv”
;

35 
Ëngth
--)

37 
m_»g
[
m_couÁ”
++] ^ğ*
šput
++;

38 ià(
m_couÁ”
 =ğ
blockSize
)

39 
	`ProûssBuf
();

41 
	}
}

43 
	gCBC_MAC_Ba£
::
	$Trunÿ‹dFš®
(
by‹
 *
mac
, 
size_t
 
size
)

45 
	`ThrowIfInv®idTrunÿ‹dSize
(
size
);

47 ià(
m_couÁ”
)

48 
	`ProûssBuf
();

50 
	`memıy
(
mac
, 
m_»g
, 
size
);

51 
	`mem£t
(
m_»g
, 0, 
	`AcûssCh”
().
	`BlockSize
());

52 
	}
}

54 
	gCBC_MAC_Ba£
::
	$ProûssBuf
()

56 
	`AcûssCh”
().
	`ProûssBlock
(
m_»g
);

57 
m_couÁ”
 = 0;

58 
	}
}

60 
	gNAMESPACE_END


	@cbcmac.h

1 #iâdeà
CRYPTOPP_CBCMAC_H


2 
	#CRYPTOPP_CBCMAC_H


	)

4 
	~"£ckey.h
"

5 
	~"£cblock.h
"

7 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

10 şas 
	cCRYPTOPP_DLL
 
CRYPTOPP_NO_VTABLE
 
CBC_MAC_Ba£
 : 
public
 
Mes§geAuth’tiÿtiÚCode


12 
public
:

13 
	$CBC_MAC_Ba£
() {}

15 
	`UncheckedS‘Key
(cÚ¡ 
by‹
 *
key
, 
Ëngth
, cÚ¡ 
NameV®uePaœs
 &
·¿ms
);

16 
	`Upd©e
(cÚ¡ 
by‹
 *
šput
, 
size_t
 
Ëngth
);

17 
	`Trunÿ‹dFš®
(
by‹
 *
mac
, 
size_t
 
size
);

18 
	$Dige¡Size
(ècÚ¡ { 
cÚ¡_ÿ¡
<
CBC_MAC_Ba£
*>(
this
)->
	`AcûssCh”
().
	`BlockSize
();
	}
}

20 
	g´Ùeùed
:

21 
vœtu®
 
BlockCh”
 & 
AcûssCh”
() =0;

23 
	g´iv©e
:

24 
ProûssBuf
();

25 
SecBy‹Block
 
	gm_»g
;

26 
	gm_couÁ”
;

33 
	g‹m¶©e
 <
şass
 
	gT
>

34 
şass
 
	gCBC_MAC
 : 
public
 
Mes§geAuth’tiÿtiÚCodeIm¶
<
CBC_MAC_Ba£
, CBC_MAC<
	gT
> >,…ubliø
	gSameKeyL’gthAs
<T>

36 
	gpublic
:

37 
CBC_MAC
() {}

38 
CBC_MAC
(cÚ¡ 
by‹
 *
key
, 
size_t
 
Ëngth
=
SameKeyL’gthAs
<
T
>::
DEFAULT_KEYLENGTH
)

39 {
this
->
S‘Key
(
key
, 
Ëngth
);}

41 
	g¡d
::
¡ršg
 
SticAlgÜ™hmName
(è{ 
¡d
::¡ršg("CBC-MAC("è+ 
T
::StaticAlgorithmName() + ")";}

43 
	g´iv©e
:

44 
BlockCh”
 & 
AcûssCh”
(è{ 
m_ch”
;}

45 
ty³Çme
 
	gT
::
Enüy±iÚ
 
m_ch”
;

48 
	gNAMESPACE_END


	@ccm.cpp

3 
	~"pch.h
"

5 #iâdeà
CRYPTOPP_IMPORTS


7 
	~"ccm.h
"

9 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

11 
CCM_Ba£
::
	$S‘KeyW™houtResync
(cÚ¡ 
by‹
 *
u£rKey
, 
size_t
 
keyËngth
, cÚ¡ 
NameV®uePaœs
 &
·¿ms
)

13 
BlockCh”
 &
blockCh”
 = 
	`AcûssBlockCh”
();

15 
blockCh”
.
	`S‘Key
(
u£rKey
, 
keyËngth
, 
·¿ms
);

17 ià(
blockCh”
.
	`BlockSize
(è!ğ
REQUIRED_BLOCKSIZE
)

18 
throw
 
	`Inv®idArgum’t
(
	`AlgÜ™hmName
() + ": block size of underlying block cipher is‚ot 16");

20 
m_dige¡Size
 = 
·¿ms
.
	`G‘IÁV®ueW™hDeçuÉ
(
Name
::
	`Dige¡Size
(), 
	`DeçuÉDige¡Size
());

21 ià(
m_dige¡Size
 % 2 > 0 || m_digestSize < 4 || m_digestSize > 16)

22 
throw
 
	`Inv®idArgum’t
(
	`AlgÜ™hmName
() + ": DigestSize must be 4, 6, 8, 10, 12, 14, or 16");

24 
m_bufãr
.
	`Grow
(2*
REQUIRED_BLOCKSIZE
);

25 
m_L
 = 8;

26 
	}
}

28 
	gCCM_Ba£
::
	$Resync
(cÚ¡ 
by‹
 *
iv
, 
size_t
 
Ën
)

30 
BlockCh”
 &
ch”
 = 
	`AcûssBlockCh”
();

32 
m_L
 = 
REQUIRED_BLOCKSIZE
-1-()
Ën
;

33 
	`as£¹
(
m_L
 >= 2);

34 ià(
m_L
 > 8)

35 
m_L
 = 8;

37 
m_bufãr
[0] = 
	`by‹
(
m_L
-1);

38 
	`memıy
(
m_bufãr
+1, 
iv
, 
Ën
);

39 
	`mem£t
(
m_bufãr
+1+
Ën
, 0, 
REQUIRED_BLOCKSIZE
-1-len);

41 ià(
m_¡©e
 >ğ
S‹_IVS‘
)

42 
m_ùr
.
	`ResynchrÚize
(
m_bufãr
, 
REQUIRED_BLOCKSIZE
);

44 
m_ùr
.
	`S‘Ch”W™hIV
(
ch”
, 
m_bufãr
);

46 
m_ùr
.
	`S“k
(
REQUIRED_BLOCKSIZE
);

47 
m_¯dL’gth
 = 0;

48 
m_mes§geL’gth
 = 0;

49 
	}
}

51 
	gCCM_Ba£
::
	$UncheckedS³cifyD©aL’gths
(
lwÜd
 
h—d”L’gth
,†wÜd 
mes§geL’gth
,†wÜd 
foÙ”L’gth
)

53 ià(
m_¡©e
 !ğ
S‹_IVS‘
)

54 
throw
 
	`BadS‹
(
	`AlgÜ™hmName
(), "SpecifyDataLengths", "or‡fter State_IVSet");

56 
m_¯dL’gth
 = 
h—d”L’gth
;

57 
m_mes§geL’gth
 = 
mes§geL’gth
;

59 
by‹
 *
cbcBufãr
 = 
	`CBC_Bufãr
();

60 cÚ¡ 
BlockCh”
 &
ch”
 = 
	`G‘BlockCh”
();

62 
cbcBufãr
[0] = 
	`by‹
(64*(
h—d”L’gth
>0è+ 8*((
m_dige¡Size
-2)/2è+ (
m_L
-1));

63 
PutWÜd
<
wÜd64
>(
Œue
, 
BIG_ENDIAN_ORDER
, 
cbcBufãr
+
REQUIRED_BLOCKSIZE
-8, 
m_mes§geL’gth
);

64 
	`memıy
(
cbcBufãr
+1, 
m_bufãr
+1, 
REQUIRED_BLOCKSIZE
-1-
m_L
);

65 
ch”
.
	`ProûssBlock
(
cbcBufãr
);

67 ià(
h—d”L’gth
>0)

69 
	`as£¹
(
m_bufã»dD©aL’gth
 == 0);

71 ià(
h—d”L’gth
 < ((1<<16) - (1<<8)))

73 
PutWÜd
<
wÜd16
>(
Œue
, 
BIG_ENDIAN_ORDER
, 
m_bufãr
, (wÜd16)
h—d”L’gth
);

74 
m_bufã»dD©aL’gth
 = 2;

76 ià(
h—d”L’gth
 < (
	`W64LIT
(1)<<32))

78 
m_bufãr
[0] = 0xff;

79 
m_bufãr
[1] = 0xfe;

80 
PutWÜd
<
wÜd32
>(
çl£
, 
BIG_ENDIAN_ORDER
, 
m_bufãr
+2, (wÜd32)
h—d”L’gth
);

81 
m_bufã»dD©aL’gth
 = 6;

85 
m_bufãr
[0] = 0xff;

86 
m_bufãr
[1] = 0xff;

87 
PutWÜd
<
wÜd64
>(
çl£
, 
BIG_ENDIAN_ORDER
, 
m_bufãr
+2, 
h—d”L’gth
);

88 
m_bufã»dD©aL’gth
 = 10;

91 
	}
}

93 
size_t
 
	gCCM_Ba£
::
	$Auth’tiÿ‹Blocks
(cÚ¡ 
by‹
 *
d©a
, 
size_t
 
Ën
)

95 
by‹
 *
cbcBufãr
 = 
	`CBC_Bufãr
();

96 cÚ¡ 
BlockCh”
 &
ch”
 = 
	`G‘BlockCh”
();

97  
ch”
.
	`AdvªûdProûssBlocks
(
cbcBufãr
, 
d©a
, cbcBufãr, 
Ën
, 
BlockT¿nsfÜm©iÚ
::
BT_DÚtInüem’tInOutPoš‹rs
|BlockT¿nsfÜm©iÚ::
BT_XÜIÅut
);

98 
	}
}

100 
	gCCM_Ba£
::
	$Auth’tiÿ‹La¡H—d”Block
()

102 
by‹
 *
cbcBufãr
 = 
	`CBC_Bufãr
();

103 cÚ¡ 
BlockCh”
 &
ch”
 = 
	`G‘BlockCh”
();

105 ià(
m_¯dL’gth
 !ğ
m_tÙ®H—d”L’gth
)

106 
throw
 
	`Inv®idArgum’t
(
	`AlgÜ™hmName
() + ": header†ength doesn't matchhat given in SpecifyDataLengths");

108 ià(
m_bufã»dD©aL’gth
 > 0)

110 
	`xÜbuf
(
cbcBufãr
, 
m_bufãr
, 
m_bufã»dD©aL’gth
);

111 
ch”
.
	`ProûssBlock
(
cbcBufãr
);

112 
m_bufã»dD©aL’gth
 = 0;

114 
	}
}

116 
	gCCM_Ba£
::
	$Auth’tiÿ‹La¡CÚfid’tŸlBlock
()

118 
by‹
 *
cbcBufãr
 = 
	`CBC_Bufãr
();

119 cÚ¡ 
BlockCh”
 &
ch”
 = 
	`G‘BlockCh”
();

121 ià(
m_mes§geL’gth
 !ğ
m_tÙ®Mes§geL’gth
)

122 
throw
 
	`Inv®idArgum’t
(
	`AlgÜ™hmName
() + ": message†ength doesn't matchhat given in SpecifyDataLengths");

124 ià(
m_bufã»dD©aL’gth
 > 0)

126 
	`xÜbuf
(
cbcBufãr
, 
m_bufãr
, 
m_bufã»dD©aL’gth
);

127 
ch”
.
	`ProûssBlock
(
cbcBufãr
);

128 
m_bufã»dD©aL’gth
 = 0;

130 
	}
}

132 
	gCCM_Ba£
::
	$Auth’tiÿ‹La¡FoÙ”Block
(
by‹
 *
mac
, 
size_t
 
macSize
)

134 
m_ùr
.
	`S“k
(0);

135 
m_ùr
.
	`ProûssD©a
(
mac
, 
	`CBC_Bufãr
(), 
macSize
);

136 
	}
}

138 
	gNAMESPACE_END


	@ccm.h

1 #iâdeà
CRYPTOPP_CCM_H


2 
	#CRYPTOPP_CCM_H


	)

4 
	~"auth’c.h
"

5 
	~"modes.h
"

7 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

10 şas 
	cCRYPTOPP_DLL
 
CRYPTOPP_NO_VTABLE
 
CCM_Ba£
 : 
public
 
Auth’tiÿ‹dSymm‘ricCh”Ba£


12 
public
:

13 
	$CCM_Ba£
()

14 : 
	`m_dige¡Size
(0), 
	$m_L
(0) {}

17 
¡d
::
¡ršg
 
	$AlgÜ™hmName
() const

18 { 
	`G‘BlockCh”
().
	`AlgÜ™hmName
(è+ 
¡d
::
	`¡ršg
("/CCM");
	}
}

19 
size_t
 
	$MšKeyL’gth
() const

20 { 
	`G‘BlockCh”
().
	`MšKeyL’gth
();
	}
}

21 
size_t
 
	$MaxKeyL’gth
() const

22 { 
	`G‘BlockCh”
().
	`MaxKeyL’gth
();
	}
}

23 
size_t
 
	$DeçuÉKeyL’gth
() const

24 { 
	`G‘BlockCh”
().
	`DeçuÉKeyL’gth
();
	}
}

25 
size_t
 
	$G‘V®idKeyL’gth
(
size_t
 
n
) const

26 { 
	`G‘BlockCh”
().
	`G‘V®idKeyL’gth
(
n
);
	}
}

27 
boŞ
 
	$IsV®idKeyL’gth
(
size_t
 
n
) const

28 { 
	`G‘BlockCh”
().
	`IsV®idKeyL’gth
(
n
);
	}
}

29 
	$O±im®D©aAlignm’t
() const

30 { 
	`G‘BlockCh”
().
	`O±im®D©aAlignm’t
();
	}
}

31 
IV_Requœem’t
 
	$IVRequœem’t
() const

32 { 
UNIQUE_IV
;
	}
}

33 
	$IVSize
() const

34 { 8;
	}
}

35 
	$MšIVL’gth
() const

36 { 7;
	}
}

37 
	$MaxIVL’gth
() const

38 { 13;
	}
}

39 
	$Dige¡Size
() const

40 { 
m_dige¡Size
;
	}
}

41 
lwÜd
 
	$MaxH—d”L’gth
() const

42 { 
	`W64LIT
(0)-1;
	}
}

43 
lwÜd
 
	$MaxMes§geL’gth
() const

44 { 
m_L
<8 ? (
	`W64LIT
(1)<<(8*m_L))-1 : W64LIT(0)-1;
	}
}

45 
boŞ
 
	$N“dsP»¥ecif›dD©aL’gths
() const

46 { 
Œue
;
	}
}

47 
UncheckedS³cifyD©aL’gths
(
lwÜd
 
h—d”L’gth
,†wÜd 
mes§geL’gth
,†wÜd 
foÙ”L’gth
);

49 
	g´Ùeùed
:

51 
boŞ
 
	$Auth’tiÿtiÚIsOnPÏš‹xt
() const

52 { 
Œue
;
	}
}

53 
	$Auth’tiÿtiÚBlockSize
() const

54 { 
	`G‘BlockCh”
().
	`BlockSize
();
	}
}

55 
S‘KeyW™houtResync
(cÚ¡ 
by‹
 *
u£rKey
, 
size_t
 
keyËngth
, cÚ¡ 
NameV®uePaœs
 &
·¿ms
);

56 
Resync
(cÚ¡ 
by‹
 *
iv
, 
size_t
 
Ën
);

57 
size_t
 
Auth’tiÿ‹Blocks
(cÚ¡ 
by‹
 *
d©a
, size_ˆ
Ën
);

58 
Auth’tiÿ‹La¡H—d”Block
();

59 
Auth’tiÿ‹La¡CÚfid’tŸlBlock
();

60 
Auth’tiÿ‹La¡FoÙ”Block
(
by‹
 *
mac
, 
size_t
 
macSize
);

61 
	gSymm‘ricCh”
 & 
	$AcûssSymm‘ricCh”
(è{ 
m_ùr
;
	}
}

63 
vœtu®
 
	gBlockCh”
 & 
AcûssBlockCh”
() =0;

64 
vœtu®
 
	$DeçuÉDige¡Size
() const =0;

66 cÚ¡ 
BlockCh”
 & 
	$G‘BlockCh”
(ècÚ¡ { 
cÚ¡_ÿ¡
<
CCM_Ba£
 *>(
this
)->
	`AcûssBlockCh”
();
	}
};

67 
by‹
 *
	$CBC_Bufãr
(è{ 
m_bufãr
+
REQUIRED_BLOCKSIZE
;
	}
}

69 ’um {
	gREQUIRED_BLOCKSIZE
 = 16};

70 
	gm_dige¡Size
, 
	gm_L
;

71 
wÜd64
 
	gm_mes§geL’gth
, 
	gm_¯dL’gth
;

72 
	gCTR_Mode_Ex‹º®Ch”
::
Enüy±iÚ
 
m_ùr
;

76 
	g‹m¶©e
 <
şass
 
	gT_BlockCh”
, 
	gT_DeçuÉDige¡Size
, 
boŞ
 
	gT_IsEnüy±iÚ
>

77 şas 
	cCCM_Fš®
 : 
public
 
CCM_Ba£


79 
public
:

80 
¡d
::
¡ršg
 
	$SticAlgÜ™hmName
()

81 { 
T_BlockCh”
::
	`SticAlgÜ™hmName
(è+ 
¡d
::
	`¡ršg
("/CCM");}

82 
boŞ
 
	$IsFÜw¬dT¿nsfÜm©iÚ
() const

83 { 
T_IsEnüy±iÚ
;
	}
}

85 
	g´iv©e
:

86 
BlockCh”
 & 
	$AcûssBlockCh”
(è{ 
m_ch”
;
	}
}

87 
	$DeçuÉDige¡Size
(ècÚ¡ { 
T_DeçuÉDige¡Size
;
	}
}

88 
ty³Çme
 
	gT_BlockCh”
::
Enüy±iÚ
 
m_ch”
;

92 
	g‹m¶©e
 <
şass
 
	gT_BlockCh”
, 
	gT_DeçuÉDige¡Size
 = 16>

93 
CCM
 : 
public
 
Auth’tiÿ‹dSymm‘ricCh”Docum’tiÚ


95 
CCM_Fš®
<
	tT_BlockCh”
, 
	tT_DeçuÉDige¡Size
, 
	tŒue
> 
	tEnüy±iÚ
;

96 
	gCCM_Fš®
<
	tT_BlockCh”
, 
	tT_DeçuÉDige¡Size
, 
	tçl£
> 
	tDeüy±iÚ
;

99 
	gNAMESPACE_END


	@channels.cpp

3 
	~"pch.h
"

5 #iâdeà
CRYPTOPP_IMPORTS


7 
	~"chªÃls.h
"

9 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

10 
	$USING_NAMESPACE
(
¡d
)

13 
Mes§geSw™ch
::
	$AddDeçuÉRou‹
(
Bufã»dT¿nsfÜm©iÚ
 &
de¡š©iÚ
, cÚ¡ 
¡d
::
¡ršg
 &
chªÃl
)

15 
m_deçuÉRou‹s
.
	`push_back
(
	`Rou‹
(&
de¡š©iÚ
, 
chªÃl
));

16 
	}
}

18 
	gMes§geSw™ch
::
	$AddRou‹
(
begš
, 
’d
, 
Bufã»dT¿nsfÜm©iÚ
 &
de¡š©iÚ
, cÚ¡ 
¡d
::
¡ršg
 &
chªÃl
)

20 
RªgeRou‹
 
	`rou‹
(
begš
, 
’d
, 
	`Rou‹
(&
de¡š©iÚ
, 
chªÃl
));

21 
Rou‹Li¡
::
™”©Ü
 
™
 = 
	`uµ”_bound
(
m_rou‹s
.
	`begš
(), m_rou‹s.
	`’d
(), 
rou‹
);

22 
m_rou‹s
.
	`š£¹
(
™
, 
rou‹
);

23 
	}
}

96 
	gChªÃlRou‹I‹¿tÜ
::
	$Re£t
(cÚ¡ 
¡d
::
¡ršg
 &
chªÃl
)

98 
m_chªÃl
 = 
chªÃl
;

99 
·œ
<
M­I‹¿tÜ
, M­I‹¿tÜ> 
¿nge
 = 
m_cs
.
m_rou‹M­
.
	`equ®_¿nge
(
chªÃl
);

100 ià(
¿nge
.
fœ¡
 =ğ¿nge.
£cÚd
)

102 
m_u£DeçuÉ
 = 
Œue
;

103 
m_™Li¡Cu¼’t
 = 
m_cs
.
m_deçuÉRou‹s
.
	`begš
();

104 
m_™Li¡End
 = 
m_cs
.
m_deçuÉRou‹s
.
	`’d
();

108 
m_u£DeçuÉ
 = 
çl£
;

109 
m_™M­Cu¼’t
 = 
¿nge
.
fœ¡
;

110 
m_™M­End
 = 
¿nge
.
£cÚd
;

112 
	}
}

114 
boŞ
 
	gChªÃlRou‹I‹¿tÜ
::
	$End
() const

116  
m_u£DeçuÉ
 ? 
m_™Li¡Cu¼’t
 =ğ
m_™Li¡End
 : 
m_™M­Cu¼’t
 =ğ
m_™M­End
;

117 
	}
}

119 
	gChªÃlRou‹I‹¿tÜ
::
	$Next
()

121 ià(
m_u£DeçuÉ
)

122 ++
m_™Li¡Cu¼’t
;

124 ++
m_™M­Cu¼’t
;

125 
	}
}

127 
	gBufã»dT¿nsfÜm©iÚ
 & 
	gChªÃlRou‹I‹¿tÜ
::
	$De¡š©iÚ
()

129  
m_u£DeçuÉ
 ? *
m_™Li¡Cu¼’t
->
fœ¡
 : *
m_™M­Cu¼’t
->
£cÚd
.first;

130 
	}
}

132 cÚ¡ 
	g¡d
::
¡ršg
 & 
ChªÃlRou‹I‹¿tÜ
::
	$ChªÃl
()

134 ià(
m_u£DeçuÉ
)

135  
m_™Li¡Cu¼’t
->
£cÚd
.
	`g‘
(è? *m_™Li¡Cu¼’t->£cÚd.g‘(è: 
m_chªÃl
;

137  
m_™M­Cu¼’t
->
£cÚd
.second;

138 
	}
}

145 
size_t
 
	gChªÃlSw™ch
::
	$ChªÃlPut2
(cÚ¡ 
¡d
::
¡ršg
 &
chªÃl
, cÚ¡ 
by‹
 *
begš
, 
size_t
 
Ëngth
, 
mes§geEnd
, 
boŞ
 
blockšg
)

147 ià(
m_blocked
)

149 
m_blocked
 = 
çl£
;

150 
WasBlocked
;

153 
m_™
.
	`Re£t
(
chªÃl
);

155 !
m_™
.
	`End
())

157 
WasBlocked
:

158 ià(
m_™
.
	`De¡š©iÚ
().
	`ChªÃlPut2
(m_™.
	`ChªÃl
(), 
begš
, 
Ëngth
, 
mes§geEnd
, 
blockšg
))

160 
m_blocked
 = 
Œue
;

164 
m_™
.
	`Next
();

168 
	}
}

170 
	gChªÃlSw™ch
::
	$IsŞ©edIn™Ÿlize
(cÚ¡ 
NameV®uePaœs
 &
·¿m‘”s
 )

172 
m_rou‹M­
.
	`ş—r
();

173 
m_deçuÉRou‹s
.
	`ş—r
();

174 
m_blocked
 = 
çl£
;

175 
	}
}

177 
boŞ
 
	gChªÃlSw™ch
::
	$ChªÃlFlush
(cÚ¡ 
¡d
::
¡ršg
 &
chªÃl
, 
boŞ
 
com¶‘eFlush
, 
´İag©iÚ
, boŞ 
blockšg
)

179 ià(
m_blocked
)

181 
m_blocked
 = 
çl£
;

182 
WasBlocked
;

185 
m_™
.
	`Re£t
(
chªÃl
);

187 !
m_™
.
	`End
())

189 
WasBlocked
:

190 ià(
m_™
.
	`De¡š©iÚ
().
	`ChªÃlFlush
(m_™.
	`ChªÃl
(), 
com¶‘eFlush
, 
´İag©iÚ
, 
blockšg
))

192 
m_blocked
 = 
Œue
;

193  
Œue
;

196 
m_™
.
	`Next
();

199  
çl£
;

200 
	}
}

202 
boŞ
 
	gChªÃlSw™ch
::
	$ChªÃlMes§geS”›sEnd
(cÚ¡ 
¡d
::
¡ršg
 &
chªÃl
, 
´İag©iÚ
, 
boŞ
 
blockšg
)

204 ià(
m_blocked
)

206 
m_blocked
 = 
çl£
;

207 
WasBlocked
;

210 
m_™
.
	`Re£t
(
chªÃl
);

212 !
m_™
.
	`End
())

214 
WasBlocked
:

215 ià(
m_™
.
	`De¡š©iÚ
().
	`ChªÃlMes§geS”›sEnd
(m_™.
	`ChªÃl
(), 
´İag©iÚ
))

217 
m_blocked
 = 
Œue
;

218  
Œue
;

221 
m_™
.
	`Next
();

224  
çl£
;

225 
	}
}

227 
by‹
 * 
	gChªÃlSw™ch
::
	$ChªÃlC»©ePutS·û
(cÚ¡ 
¡d
::
¡ršg
 &
chªÃl
, 
size_t
 &
size
)

229 
m_™
.
	`Re£t
(
chªÃl
);

230 ià(!
m_™
.
	`End
())

232 
Bufã»dT¿nsfÜm©iÚ
 &
rg‘
 = 
m_™
.
	`De¡š©iÚ
();

233 cÚ¡ 
¡d
::
¡ršg
 &
chªÃl
 = 
m_™
.
	`ChªÃl
();

234 
m_™
.
	`Next
();

235 ià(
m_™
.
	`End
())

236  
rg‘
.
	`ChªÃlC»©ePutS·û
(
chªÃl
, 
size
);

238 
size
 = 0;

239  
NULL
;

240 
	}
}

242 
size_t
 
	gChªÃlSw™ch
::
	$ChªÃlPutModifŸbË2
(cÚ¡ 
¡d
::
¡ršg
 &
chªÃl
, 
by‹
 *
šSŒšg
, 
size_t
 
Ëngth
, 
mes§geEnd
, 
boŞ
 
blockšg
)

244 
ChªÃlRou‹I‹¿tÜ
 
	`™
(*
this
);

245 
™
.
	`Re£t
(
chªÃl
);

247 ià(!
™
.
	`End
())

249 
Bufã»dT¿nsfÜm©iÚ
 &
rg‘
 = 
™
.
	`De¡š©iÚ
();

250 cÚ¡ 
¡d
::
¡ršg
 &
rg‘ChªÃl
 = 
™
.
	`ChªÃl
();

251 
™
.
	`Next
();

252 ià(
™
.
	`End
())

253  
rg‘
.
	`ChªÃlPutModifŸbË2
(
rg‘ChªÃl
, 
šSŒšg
, 
Ëngth
, 
mes§geEnd
, 
blockšg
);

256  
	`ChªÃlPut2
(
chªÃl
, 
šSŒšg
, 
Ëngth
, 
mes§geEnd
, 
blockšg
);

257 
	}
}

259 
	gChªÃlSw™ch
::
	$AddDeçuÉRou‹
(
Bufã»dT¿nsfÜm©iÚ
 &
de¡š©iÚ
)

261 
m_deçuÉRou‹s
.
	`push_back
(
	`DeçuÉRou‹
(&
de¡š©iÚ
, 
v®ue_±r
<
¡d
::
¡ršg
>(
NULL
)));

262 
	}
}

264 
	gChªÃlSw™ch
::
	$RemoveDeçuÉRou‹
(
Bufã»dT¿nsfÜm©iÚ
 &
de¡š©iÚ
)

266 
DeçuÉRou‹Li¡
::
™”©Ü
 
™
 = 
m_deçuÉRou‹s
.
	`begš
(); iˆ!ğm_deçuÉRou‹s.
	`’d
(); ++it)

267 ià(
™
->
fœ¡
 =ğ&
de¡š©iÚ
 && !™->
£cÚd
.
	`g‘
())

269 
m_deçuÉRou‹s
.
	`”a£
(
™
);

272 
	}
}

274 
	gChªÃlSw™ch
::
	$AddDeçuÉRou‹
(
Bufã»dT¿nsfÜm©iÚ
 &
de¡š©iÚ
, cÚ¡ 
¡d
::
¡ršg
 &
outChªÃl
)

276 
m_deçuÉRou‹s
.
	`push_back
(
	`DeçuÉRou‹
(&
de¡š©iÚ
, 
outChªÃl
));

277 
	}
}

279 
	gChªÃlSw™ch
::
	$RemoveDeçuÉRou‹
(
Bufã»dT¿nsfÜm©iÚ
 &
de¡š©iÚ
, cÚ¡ 
¡d
::
¡ršg
 &
outChªÃl
)

281 
DeçuÉRou‹Li¡
::
™”©Ü
 
™
 = 
m_deçuÉRou‹s
.
	`begš
(); iˆ!ğm_deçuÉRou‹s.
	`’d
(); ++it)

282 ià(
™
->
fœ¡
 =ğ&
de¡š©iÚ
 && (™->
£cÚd
.
	`g‘
(è&& *™->£cÚd =ğ
outChªÃl
))

284 
m_deçuÉRou‹s
.
	`”a£
(
™
);

287 
	}
}

289 
	gChªÃlSw™ch
::
	$AddRou‹
(cÚ¡ 
¡d
::
¡ršg
 &
šChªÃl
, 
Bufã»dT¿nsfÜm©iÚ
 &
de¡š©iÚ
, cÚ¡ std::¡ršg &
outChªÃl
)

291 
m_rou‹M­
.
	`š£¹
(
Rou‹M­
::
	`v®ue_ty³
(
šChªÃl
, 
	`Rou‹
(&
de¡š©iÚ
, 
outChªÃl
)));

292 
	}
}

294 
	gChªÃlSw™ch
::
	$RemoveRou‹
(cÚ¡ 
¡d
::
¡ršg
 &
šChªÃl
, 
Bufã»dT¿nsfÜm©iÚ
 &
de¡š©iÚ
, cÚ¡ std::¡ršg &
outChªÃl
)

296 
ChªÃlSw™ch
::
	tRou‹M­
::
	t™”©Ü
 
	tM­I‹¿tÜ
;

297 
·œ
<
M­I‹¿tÜ
, M­I‹¿tÜ> 
¿nge
 = 
m_rou‹M­
.
	`equ®_¿nge
(
šChªÃl
);

299 
M­I‹¿tÜ
 
™
 = 
¿nge
.
fœ¡
; iˆ!ğ¿nge.
£cÚd
; ++it)

300 ià(
™
->
£cÚd
.
fœ¡
 =ğ&
de¡š©iÚ
 && it->£cÚd.£cÚd =ğ
outChªÃl
)

302 
m_rou‹M­
.
	`”a£
(
™
);

305 
	}
}

307 
	gNAMESPACE_END


	@channels.h

1 #iâdeà
CRYPTOPP_CHANNELS_H


2 
	#CRYPTOPP_CHANNELS_H


	)

4 
	~"sim¶e.h
"

5 
	~"sm¬Œ.h
"

6 
	~<m­
>

7 
	~<li¡
>

9 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

13 şas 
	cMes§geSw™ch
 : 
public
 
Sšk


15 
public
:

16 
	`AddDeçuÉRou‹
(
Bufã»dT¿nsfÜm©iÚ
 &
de¡š©iÚ
, cÚ¡ 
¡d
::
¡ršg
 &
chªÃl
);

17 
	`AddRou‹
(
begš
, 
’d
, 
Bufã»dT¿nsfÜm©iÚ
 &
de¡š©iÚ
, cÚ¡ 
¡d
::
¡ršg
 &
chªÃl
);

19 
	`Put
(
by‹
 
šBy‹
);

20 
	`Put
(cÚ¡ 
by‹
 *
šSŒšg
, 
Ëngth
);

22 
	`Flush
(
boŞ
 
com¶‘eFlush
, 
´İag©iÚ
=-1);

23 
	`Mes§geEnd
(
´İag©iÚ
=-1);

24 
	`PutMes§geEnd
(cÚ¡ 
by‹
 *
šSŒšg
, 
Ëngth
, 
´İag©iÚ
=-1);

25 
	`Mes§geS”›sEnd
(
´İag©iÚ
=-1);

27 
´iv©e
:

28 
¡d
::
	t·œ
<
	tBufã»dT¿nsfÜm©iÚ
 *, 
	t¡d
::
	t¡ršg
> 
	tRou‹
;

29 
	sRªgeRou‹


31 
	`RªgeRou‹
(
begš
, 
’d
, cÚ¡ 
Rou‹
 &
rou‹
)

32 : 
	`begš
(
begš
), 
	`’d
(
’d
), 
	`rou‹
(
rou‹
) {}

33 
boŞ
 
İ”©Ü
<(cÚ¡ 
RªgeRou‹
 &
rhs
ècÚ¡ { 
begš
 <„hs.begin;}

34 
begš
, 
’d
;

35 
Rou‹
 
rou‹
;

38 
¡d
::
	tli¡
<
	tRªgeRou‹
> 
	tRou‹Li¡
;

39 
¡d
::
	tli¡
<
	tRou‹
> 
	tDeçuÉRou‹Li¡
;

41 
Rou‹Li¡
 
m_rou‹s
;

42 
DeçuÉRou‹Li¡
 
m_deçuÉRou‹s
;

43 
m_nCu¼’tMes§ge
;

44 
	}
};

47 şas 
	cChªÃlSw™chTy³defs


49 
	mpublic
:

50 
¡d
::
	t·œ
<
	tBufã»dT¿nsfÜm©iÚ
 *, 
	t¡d
::
	t¡ršg
> 
	tRou‹
;

51 
	m¡d
::
	tmuÉim­
<
	t¡d
::
	t¡ršg
, 
	tRou‹
> 
	tRou‹M­
;

53 
	m¡d
::
	t·œ
<
	tBufã»dT¿nsfÜm©iÚ
 *, 
	tv®ue_±r
<
	t¡d
::
	t¡ršg
> > 
	tDeçuÉRou‹
;

54 
	m¡d
::
	tli¡
<
	tDeçuÉRou‹
> 
	tDeçuÉRou‹Li¡
;

57 
	mRou‹M­
::
	t™”©Ü
 
	tM­I‹¿tÜ
;

58 
	mDeçuÉRou‹Li¡
::
	t™”©Ü
 
	tLi¡I‹¿tÜ
;

61 
şass
 
	gChªÃlSw™ch
;

63 şas 
	cChªÃlRou‹I‹¿tÜ
 : 
public
 
ChªÃlSw™chTy³defs


65 
public
:

66 
ChªÃlSw™ch
& 
m_cs
;

67 
	m¡d
::
¡ršg
 
m_chªÃl
;

68 
boŞ
 
	mm_u£DeçuÉ
;

69 
M­I‹¿tÜ
 
	mm_™M­Cu¼’t
, 
	mm_™M­End
;

70 
Li¡I‹¿tÜ
 
	mm_™Li¡Cu¼’t
, 
	mm_™Li¡End
;

72 
	$ChªÃlRou‹I‹¿tÜ
(
ChªÃlSw™ch
 &
cs
è: 
	$m_cs
(
cs
) {}

73 
	`Re£t
(cÚ¡ 
¡d
::
¡ršg
 &
chªÃl
);

74 
boŞ
 
	$End
() const;

75 
	`Next
();

76 
Bufã»dT¿nsfÜm©iÚ
 & 
	`De¡š©iÚ
();

77 cÚ¡ 
¡d
::
¡ršg
 & 
	`ChªÃl
();

78 
	}
};

81 
şass
 
CRYPTOPP_DLL
 
	gChªÃlSw™ch
 : 
public
 
MuÉichªÃl
<
Sšk
>,…ubliø
	gChªÃlSw™chTy³defs


83 
	gpublic
:

84 
ChªÃlSw™ch
(è: 
m_™
(*
this
), 
m_blocked
(
çl£
) {}

85 
ChªÃlSw™ch
(
Bufã»dT¿nsfÜm©iÚ
 &
de¡š©iÚ
è: 
m_™
(*
this
), 
m_blocked
(
çl£
)

87 
AddDeçuÉRou‹
(
de¡š©iÚ
);

89 
ChªÃlSw™ch
(
Bufã»dT¿nsfÜm©iÚ
 &
de¡š©iÚ
, cÚ¡ 
¡d
::
¡ršg
 &
outChªÃl
è: 
m_™
(*
this
), 
m_blocked
(
çl£
)

91 
AddDeçuÉRou‹
(
de¡š©iÚ
, 
outChªÃl
);

94 
IsŞ©edIn™Ÿlize
(cÚ¡ 
NameV®uePaœs
 &
·¿m‘”s
=
g_nuÎNameV®uePaœs
);

96 
size_t
 
ChªÃlPut2
(cÚ¡ 
¡d
::
¡ršg
 &
chªÃl
, cÚ¡ 
by‹
 *
begš
, size_ˆ
Ëngth
, 
mes§geEnd
, 
boŞ
 
blockšg
);

97 
size_t
 
ChªÃlPutModifŸbË2
(cÚ¡ 
¡d
::
¡ršg
 &
chªÃl
, 
by‹
 *
begš
, size_ˆ
Ëngth
, 
mes§geEnd
, 
boŞ
 
blockšg
);

99 
boŞ
 
ChªÃlFlush
(cÚ¡ 
¡d
::
¡ršg
 &
chªÃl
, boŞ 
com¶‘eFlush
, 
´İag©iÚ
=-1, boŞ 
blockšg
=
Œue
);

100 
boŞ
 
ChªÃlMes§geS”›sEnd
(cÚ¡ 
¡d
::
¡ršg
 &
chªÃl
, 
´İag©iÚ
=-1, boŞ 
blockšg
=
Œue
);

102 
by‹
 * 
ChªÃlC»©ePutS·û
(cÚ¡ 
¡d
::
¡ršg
 &
chªÃl
, 
size_t
 &
size
);

104 
AddDeçuÉRou‹
(
Bufã»dT¿nsfÜm©iÚ
 &
de¡š©iÚ
);

105 
RemoveDeçuÉRou‹
(
Bufã»dT¿nsfÜm©iÚ
 &
de¡š©iÚ
);

106 
AddDeçuÉRou‹
(
Bufã»dT¿nsfÜm©iÚ
 &
de¡š©iÚ
, cÚ¡ 
¡d
::
¡ršg
 &
outChªÃl
);

107 
RemoveDeçuÉRou‹
(
Bufã»dT¿nsfÜm©iÚ
 &
de¡š©iÚ
, cÚ¡ 
¡d
::
¡ršg
 &
outChªÃl
);

108 
AddRou‹
(cÚ¡ 
¡d
::
¡ršg
 &
šChªÃl
, 
Bufã»dT¿nsfÜm©iÚ
 &
de¡š©iÚ
, cÚ¡ std::¡ršg &
outChªÃl
);

109 
RemoveRou‹
(cÚ¡ 
¡d
::
¡ršg
 &
šChªÃl
, 
Bufã»dT¿nsfÜm©iÚ
 &
de¡š©iÚ
, cÚ¡ std::¡ršg &
outChªÃl
);

111 
	g´iv©e
:

112 
Rou‹M­
 
m_rou‹M­
;

113 
DeçuÉRou‹Li¡
 
	gm_deçuÉRou‹s
;

115 
ChªÃlRou‹I‹¿tÜ
 
	gm_™
;

116 
boŞ
 
	gm_blocked
;

118 
ä›nd
 
şass
 
	gChªÃlRou‹I‹¿tÜ
;

121 
	gNAMESPACE_END


	@cmac.cpp

3 
	~"pch.h
"

5 #iâdeà
CRYPTOPP_IMPORTS


7 
	~"cmac.h
"

9 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

11 
	$MulU
(
by‹
 *
k
, 
Ëngth
)

13 
by‹
 
ÿ¼y
 = 0;

15 
i
=
Ëngth
-1; i>=1; i-=2)

17 
by‹
 
ÿ¼y2
 = 
k
[
i
] >> 7;

18 
k
[
i
] +ğk[i] + 
ÿ¼y
;

19 
ÿ¼y
 = 
k
[
i
-1] >> 7;

20 
k
[
i
-1] +ğk[i-1] + 
ÿ¼y2
;

23 ià(
ÿ¼y
)

25 
Ëngth
)

28 
k
[7] ^= 0x1b;

31 
k
[15] ^= 0x87;

34 
k
[30] ^= 4;

35 
k
[31] ^= 0x23;

38 
throw
 
	`Inv®idArgum’t
("CMAC: " + 
	`IÁToSŒšg
(
Ëngth
) + " is‚ot‡ supported cipher block size");

41 
	}
}

43 
	gCMAC_Ba£
::
	$UncheckedS‘Key
(cÚ¡ 
by‹
 *
key
, 
Ëngth
, cÚ¡ 
NameV®uePaœs
 &
·¿ms
)

45 
BlockCh”
 &
ch”
 = 
	`AcûssCh”
();

46 
blockSize
 = 
ch”
.
	`BlockSize
();

48 
ch”
.
	`S‘Key
(
key
, 
Ëngth
, 
·¿ms
);

49 
m_»g
.
	`CËªNew
(3*
blockSize
);

50 
m_couÁ”
 = 0;

52 
ch”
.
	`ProûssBlock
(
m_»g
, m_»g+
blockSize
);

53 
	`MulU
(
m_»g
+
blockSize
, blockSize);

54 
	`memıy
(
m_»g
+2*
blockSize
, m_reg+blockSize, blockSize);

55 
	`MulU
(
m_»g
+2*
blockSize
, blockSize);

56 
	}
}

58 
	gCMAC_Ba£
::
	$Upd©e
(cÚ¡ 
by‹
 *
šput
, 
size_t
 
Ëngth
)

60 ià(!
Ëngth
)

63 
BlockCh”
 &
ch”
 = 
	`AcûssCh”
();

64 
blockSize
 = 
ch”
.
	`BlockSize
();

66 ià(
m_couÁ”
 > 0)

68 
Ën
 = 
	`UnsigÃdMš
(
blockSize
 - 
m_couÁ”
, 
Ëngth
);

69 
	`xÜbuf
(
m_»g
+
m_couÁ”
, 
šput
, 
Ën
);

70 
Ëngth
 -ğ
Ën
;

71 
šput
 +ğ
Ën
;

72 
m_couÁ”
 +ğ
Ën
;

74 ià(
m_couÁ”
 =ğ
blockSize
 && 
Ëngth
 > 0)

76 
ch”
.
	`ProûssBlock
(
m_»g
);

77 
m_couÁ”
 = 0;

81 ià(
Ëngth
 > 
blockSize
)

83 
	`as£¹
(
m_couÁ”
 == 0);

84 
size_t
 
ËáOv”
 = 1 + 
ch”
.
	`AdvªûdProûssBlocks
(
m_»g
, 
šput
, m_»g, 
Ëngth
-1, 
BlockT¿nsfÜm©iÚ
::
BT_DÚtInüem’tInOutPoš‹rs
|BlockT¿nsfÜm©iÚ::
BT_XÜIÅut
);

85 
šput
 +ğ(
Ëngth
 - 
ËáOv”
);

86 
Ëngth
 = 
ËáOv”
;

89 ià(
Ëngth
 > 0)

91 
	`as£¹
(
m_couÁ”
 + 
Ëngth
 <ğ
blockSize
);

92 
	`xÜbuf
(
m_»g
+
m_couÁ”
, 
šput
, 
Ëngth
);

93 
m_couÁ”
 +ğ()
Ëngth
;

96 
	`as£¹
(
m_couÁ”
 > 0);

97 
	}
}

99 
	gCMAC_Ba£
::
	$Trunÿ‹dFš®
(
by‹
 *
mac
, 
size_t
 
size
)

101 
	`ThrowIfInv®idTrunÿ‹dSize
(
size
);

103 
BlockCh”
 &
ch”
 = 
	`AcûssCh”
();

104 
blockSize
 = 
ch”
.
	`BlockSize
();

106 ià(
m_couÁ”
 < 
blockSize
)

108 
m_»g
[
m_couÁ”
] ^= 0x80;

109 
ch”
.
	`AdvªûdProûssBlocks
(
m_»g
, m_»g+2*
blockSize
, m_»g, blockSize, 
BlockT¿nsfÜm©iÚ
::
BT_DÚtInüem’tInOutPoš‹rs
|BlockT¿nsfÜm©iÚ::
BT_XÜIÅut
);

112 
ch”
.
	`AdvªûdProûssBlocks
(
m_»g
, m_»g+
blockSize
, m_»g, blockSize, 
BlockT¿nsfÜm©iÚ
::
BT_DÚtInüem’tInOutPoš‹rs
|BlockT¿nsfÜm©iÚ::
BT_XÜIÅut
);

114 
	`memıy
(
mac
, 
m_»g
, 
size
);

116 
m_couÁ”
 = 0;

117 
	`mem£t
(
m_»g
, 0, 
blockSize
);

118 
	}
}

120 
	gNAMESPACE_END


	@cmac.h

1 #iâdeà
CRYPTOPP_CMAC_H


2 
	#CRYPTOPP_CMAC_H


	)

4 
	~"£ckey.h
"

5 
	~"£cblock.h
"

7 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

10 şas 
	cCRYPTOPP_DLL
 
CRYPTOPP_NO_VTABLE
 
CMAC_Ba£
 : 
public
 
Mes§geAuth’tiÿtiÚCode


12 
public
:

13 
	$CMAC_Ba£
() {}

15 
	`UncheckedS‘Key
(cÚ¡ 
by‹
 *
key
, 
Ëngth
, cÚ¡ 
NameV®uePaœs
 &
·¿ms
);

16 
	`Upd©e
(cÚ¡ 
by‹
 *
šput
, 
size_t
 
Ëngth
);

17 
	`Trunÿ‹dFš®
(
by‹
 *
mac
, 
size_t
 
size
);

18 
	$Dige¡Size
(ècÚ¡ { 
	`G‘Ch”
().
	`BlockSize
();
	}
}

19 
	$O±im®BlockSize
(ècÚ¡ { 
	`G‘Ch”
().
	`BlockSize
();
	}
}

20 
	$O±im®D©aAlignm’t
(ècÚ¡ { 
	`G‘Ch”
().
	`O±im®D©aAlignm’t
();
	}
}

22 
	g´Ùeùed
:

23 
ä›nd
 
şass
 
EAX_Ba£
;

25 cÚ¡ 
	gBlockCh”
 & 
	$G‘Ch”
(ècÚ¡ { 
cÚ¡_ÿ¡
<
CMAC_Ba£
*>(
this
)->
	`AcûssCh”
();
	}
}

26 
vœtu®
 
	gBlockCh”
 & 
AcûssCh”
() =0;

28 
ProûssBuf
();

29 
SecBy‹Block
 
	gm_»g
;

30 
	gm_couÁ”
;

35 
	g‹m¶©e
 <
şass
 
	gT
>

36 
şass
 
	gCMAC
 : 
public
 
Mes§geAuth’tiÿtiÚCodeIm¶
<
CMAC_Ba£
, CMAC<
	gT
> >,…ubliø
	gSameKeyL’gthAs
<T>

38 
	gpublic
:

39 
CMAC
() {}

40 
CMAC
(cÚ¡ 
by‹
 *
key
, 
size_t
 
Ëngth
=
SameKeyL’gthAs
<
T
>::
DEFAULT_KEYLENGTH
)

41 {
this
->
S‘Key
(
key
, 
Ëngth
);}

43 
	g¡d
::
¡ršg
 
SticAlgÜ™hmName
(è{ 
¡d
::¡ršg("CMAC("è+ 
T
::StaticAlgorithmName() + ")";}

45 
	g´iv©e
:

46 
BlockCh”
 & 
AcûssCh”
(è{ 
m_ch”
;}

47 
ty³Çme
 
	gT
::
Enüy±iÚ
 
m_ch”
;

50 
	gNAMESPACE_END


	@config.h

1 #iâdeà
CRYPTOPP_CONFIG_H


2 
	#CRYPTOPP_CONFIG_H


	)

7 #ià!
defšed
(
IS_LITTLE_ENDIAN
è&& (defšed(
__BIG_ENDIAN__
è|| defšed(
__¥¬c
è|| defšed(
__¥¬c__
è|| defšed(
__hµa__
è|| defšed(
__MIPSEB__
è|| defšed(
__ARMEB__
è|| (defšed(
__MWERKS__
è&& !defšed(
__INTEL__
)))

8 
	#IS_BIG_ENDIAN


	)

13 #iâdeà
IS_BIG_ENDIAN


14 
	#IS_LITTLE_ENDIAN


	)

24 
	#USE_MS_CRYPTOAPI


	)

31 
	#GZIP_OS_CODE
 0

	)

43 
	#PREFER_BERKELEY_STYLE_SOCKETS


	)

47 
	#CRYPTOPP_RIJNDAEL_NAME
 "AES"

	)

53 #ifdeà
NO_NAMESPACE


54 #”rÜ 
Çme¥aû
 
suµÜt
 
is
 
now
 
»quœed


60 
	#WORKAROUND_MS_BUG_Q258000


	)

62 #ifdeà
CRYPTOPP_DOXYGEN_PROCESSING


64 
	#Cry±oPP


	)

65 
	#NAMESPACE_BEGIN
(
x
)

	)

66 
	#NAMESPACE_END


	)

68 
	#DOCUMENTED_TYPEDEF
(
x
, 
y
èşas 
	cy
 : 
public
 x {};

	)

70 
	#NAMESPACE_BEGIN
(
x
è
Çme¥aû
 x {

	)

71 
	#NAMESPACE_END
 }

	)

72 
	#DOCUMENTED_TYPEDEF
(
x
, 
y
èx 
	ty
;

	)

74 
	#ANONYMOUS_NAMESPACE_BEGIN
 
Çme¥aû
 {

	)

75 
	#USING_NAMESPACE
(
x
è
usšg
 
Çme¥aû
 x;

	)

76 
	#DOCUMENTED_NAMESPACE_BEGIN
(
x
è
Çme¥aû
 x {

	)

77 
	#DOCUMENTED_NAMESPACE_END
 }

	)

83 #iâdeà
TYPE_OF_SOCKLEN_T


84 #ià
defšed
(
_WIN32
è|| defšed(
__CYGWIN__
)

85 
	#TYPE_OF_SOCKLEN_T
 

	)

87 
	#TYPE_OF_SOCKLEN_T
 ::
sockËn_t


	)

91 #ià
defšed
(
__CYGWIN__
è&& defšed(
PREFER_WINDOWS_STYLE_SOCKETS
)

92 
	#__USE_W32_SOCKETS


	)

95 
	tby‹
;

97 
NAMESPACE_BEGIN
(
Cry±oPP
)

99 
	twÜd16
;

100 
	twÜd32
;

102 #ià
defšed
(
_MSC_VER
è|| defšed(
__BORLANDC__
)

103 
	t__št64
 
	twÜd64
;

104 
	#W64LIT
(
x
èx##
ui64


	)

106 
	twÜd64
;

107 
	#W64LIT
(
x
èx##
ULL


	)

111 
wÜd64
 
	tlwÜd
;

112 cÚ¡ 
lwÜd
 
	gLWORD_MAX
 = 
W64LIT
(0xffffffffffffffff);

114 #ifdeà
__GNUC__


115 
	#CRYPTOPP_GCC_VERSION
 (
__GNUC__
 * 10000 + 
__GNUC_MINOR__
 * 100 + 
__GNUC_PATCHLEVEL__
)

	)

120 #ià(
defšed
(
_MSC_VER
è&& (!defšed(
__INTEL_COMPILER
è|| __INTEL_COMPILER >ğ1000è&& (defšed(
_M_X64
è|| defšed(
_M_IA64
))è|| (defšed(
__DECCXX
è&& defšed(
__®pha__
)è|| (defšed(__INTEL_COMPILERè&& defšed(
__x86_64__
)è|| (defšed(
__SUNPRO_CC
) && defined(__x86_64__))

121 
wÜd32
 
	thwÜd
;

122 
wÜd64
 
	twÜd
;

124 
	#CRYPTOPP_NATIVE_DWORD_AVAILABLE


	)

125 #ià
defšed
(
__®pha__
è|| defšed(
__Ÿ64__
è|| defšed(
_ARCH_PPC64
è|| defšed(
__x86_64__
è|| defšed(
__ms64
è|| defšed(
__¥¬c64__
)

126 #ià
defšed
(
__GNUC__
è&& !defšed(
__INTEL_COMPILER
è&& !(
CRYPTOPP_GCC_VERSION
 =ğ40001 && defšed(
__APPLE__
)) && CRYPTOPP_GCC_VERSION >= 30400

129 
wÜd32
 
	thwÜd
;

130 
wÜd64
 
	twÜd
;

131 
__ušt128_t
 
	tdwÜd
;

132 
__ušt128_t
 
	twÜd128
;

133 
	#CRYPTOPP_WORD128_AVAILABLE


	)

136 
wÜd16
 
	thwÜd
;

137 
wÜd32
 
	twÜd
;

138 
wÜd64
 
	tdwÜd
;

142 
	#CRYPTOPP_BOOL_SLOW_WORD64
 1

	)

143 
wÜd16
 
	thwÜd
;

144 
wÜd32
 
	twÜd
;

145 
wÜd64
 
	tdwÜd
;

148 #iâdeà
CRYPTOPP_BOOL_SLOW_WORD64


149 
	#CRYPTOPP_BOOL_SLOW_WORD64
 0

	)

152 cÚ¡ 
	gWORD_SIZE
 = (
wÜd
);

153 cÚ¡ 
	gWORD_BITS
 = 
WORD_SIZE
 * 8;

155 
	gNAMESPACE_END


157 #iâdeà
CRYPTOPP_L1_CACHE_LINE_SIZE


159 #ià
defšed
(
_M_X64
è|| defšed(
__x86_64__
)

160 
	#CRYPTOPP_L1_CACHE_LINE_SIZE
 64

	)

163 
	#CRYPTOPP_L1_CACHE_LINE_SIZE
 32

	)

167 #ià
defšed
(
_MSC_VER
)

168 #ià
_MSC_VER
 == 1200

169 
	~<m®loc.h
>

171 #ià
_MSC_VER
 > 1200 || 
defšed
(
_mm_ä“
)

172 
	#CRYPTOPP_MSVC6PP_OR_LATER


173 #–£

	)

174 
	#CRYPTOPP_MSVC6_NO_PP


177 

	)

178 #iâdeà
CRYPTOPP_ALIGN_DATA


179 #ià
defšed
(
CRYPTOPP_MSVC6PP_OR_LATER
)

180 
	#CRYPTOPP_ALIGN_DATA
(
x
è
	`__deş¥ec
(
	`®ign
(x))

	)

181 #–ià
defšed
(
__GNUC__
)

182 
	#CRYPTOPP_ALIGN_DATA
(
x
è
	`__©Œibu‹__
((
	`®igÃd
(x)))

	)

184 
	#CRYPTOPP_ALIGN_DATA
(
x
)

	)

188 #iâdeà
CRYPTOPP_SECTION_ALIGN16


189 #ià
defšed
(
__GNUC__
è&& !defšed(
__APPLE__
)

191 
	#CRYPTOPP_SECTION_ALIGN16
 
	`__©Œibu‹__
((
	`£ùiÚ
 ("Cry±oPP_Align16")))

	)

193 
	#CRYPTOPP_SECTION_ALIGN16


	)

197 #ià
defšed
(
_MSC_VER
è|| defšed(
__ç¡ÿÎ
)

198 
	#CRYPTOPP_FASTCALL
 
__ç¡ÿÎ


	)

200 
	#CRYPTOPP_FASTCALL


	)

204 #ià
defšed
(
_MSC_VER
) && (_MSC_VER < 1300)

205 
	#CPP_TYPENAME


	)

207 
	#CPP_TYPENAME
 
ty³Çme


	)

211 #ià
defšed
(
_MSC_VER
è&& !defšed(
CRYPTOPP_MSVC6PP_OR_LATER
)

212 
	#CRYPTOPP_VC6_INT64
 (
__št64
)

	)

214 
	#CRYPTOPP_VC6_INT64


	)

217 #ifdeà
_MSC_VER


218 
	#CRYPTOPP_NO_VTABLE
 
	`__deş¥ec
(
novbË
)

	)

220 
	#CRYPTOPP_NO_VTABLE


	)

223 #ifdeà
_MSC_VER


233 #´agm¨
w¬nšg
(
di§bË
: 4231 4250 4251 4275 4660 4661 4786 4355 4910)

236 #ifdeà
__BORLANDC__


238 #´agm¨
w¬n
 -8037

241 #ià(
defšed
(
_MSC_VER
è&& _MSC_VER <ğ1300è|| defšed(
__MWERKS__
è|| defšed(
_STLPORT_VERSION
)

242 
	#CRYPTOPP_DISABLE_UNCAUGHT_EXCEPTION


	)

245 #iâdeà
CRYPTOPP_DISABLE_UNCAUGHT_EXCEPTION


246 
	#CRYPTOPP_UNCAUGHT_EXCEPTION_AVAILABLE


	)

249 #ifdeà
CRYPTOPP_DISABLE_X86ASM


250 
	#CRYPTOPP_DISABLE_ASM


	)

251 
	#CRYPTOPP_DISABLE_SSE2


	)

254 #ià!
defšed
(
CRYPTOPP_DISABLE_ASM
è&& ((defšed(
_MSC_VER
è&& defšed(
_M_IX86
)è|| (defšed(
__GNUC__
è&& (defšed(
__i386__
è|| defšed(
__x86_64__
))))

256 
	#CRYPTOPP_X86_ASM_AVAILABLE


	)

258 #ià!
defšed
(
CRYPTOPP_DISABLE_SSE2
è&& (defšed(
CRYPTOPP_MSVC6PP_OR_LATER
è|| 
CRYPTOPP_GCC_VERSION
 >= 30300)

259 
	#CRYPTOPP_BOOL_SSE2_ASM_AVAILABLE
 1

	)

261 
	#CRYPTOPP_BOOL_SSE2_ASM_AVAILABLE
 0

	)

266 #ià!
defšed
(
CRYPTOPP_DISABLE_SSSE3
è&& (
_MSC_VER
 >ğ1400 || 
CRYPTOPP_GCC_VERSION
 >= 40102)

267 
	#CRYPTOPP_BOOL_SSSE3_ASM_AVAILABLE
 1

	)

269 
	#CRYPTOPP_BOOL_SSSE3_ASM_AVAILABLE
 0

	)

273 #ià!
defšed
(
CRYPTOPP_DISABLE_ASM
è&& defšed(
_MSC_VER
è&& defšed(
_M_X64
)

274 
	#CRYPTOPP_X64_MASM_AVAILABLE


	)

277 #ià!
defšed
(
CRYPTOPP_DISABLE_ASM
è&& defšed(
__GNUC__
è&& defšed(
__x86_64__
)

278 
	#CRYPTOPP_X64_ASM_AVAILABLE


	)

281 #ià!
defšed
(
CRYPTOPP_DISABLE_SSE2
è&& (defšed(
CRYPTOPP_MSVC6PP_OR_LATER
è|| defšed(
__SSE2__
))

282 
	#CRYPTOPP_BOOL_SSE2_INTRINSICS_AVAILABLE
 1

	)

284 
	#CRYPTOPP_BOOL_SSE2_INTRINSICS_AVAILABLE
 0

	)

287 #ià!
defšed
(
CRYPTOPP_DISABLE_SSSE3
è&& !defšed(
CRYPTOPP_DISABLE_AESNI
è&& 
CRYPTOPP_BOOL_SSE2_INTRINSICS_AVAILABLE
 && (
CRYPTOPP_GCC_VERSION
 >ğ40400 || 
_MSC_FULL_VER
 >ğ150030729 || 
__INTEL_COMPILER
 >= 1110)

288 
	#CRYPTOPP_BOOL_AESNI_INTRINSICS_AVAILABLE
 1

	)

290 
	#CRYPTOPP_BOOL_AESNI_INTRINSICS_AVAILABLE
 0

	)

293 #ià
CRYPTOPP_BOOL_SSE2_INTRINSICS_AVAILABLE
 || 
CRYPTOPP_BOOL_SSE2_ASM_AVAILABLE
 || 
defšed
(
CRYPTOPP_X64_MASM_AVAILABLE
)

294 
	#CRYPTOPP_BOOL_ALIGN16_ENABLED
 1

	)

296 
	#CRYPTOPP_BOOL_ALIGN16_ENABLED
 0

	)

300 #ià
defšed
(
CRYPTOPP_MSVC6PP_OR_LATER
)

301 
	#CRYPTOPP_MM_MALLOC_AVAILABLE


	)

302 #–ià
defšed
(
__F»eBSD__
è|| defšed(
__N‘BSD__
è|| defšed(
__O³nBSD__
)

303 
	#CRYPTOPP_MALLOC_ALIGNMENT_IS_16


	)

304 #–ià
defšed
(
__lšux__
è|| defšed(
__sun__
è|| defšed(
__CYGWIN__
)

305 
	#CRYPTOPP_MEMALIGN_AVAILABLE


	)

307 
	#CRYPTOPP_NO_ALIGNED_ALLOC


	)

311 #ià
defšed
(
_MSC_VER
) && _MSC_VER >= 1300

312 
	#CRYPTOPP_NOINLINE_DOTDOTDOT


	)

313 
	#CRYPTOPP_NOINLINE
 
	`__deş¥ec
(
nošlše
)

	)

314 #–ià
defšed
(
__GNUC__
)

315 
	#CRYPTOPP_NOINLINE_DOTDOTDOT


	)

316 
	#CRYPTOPP_NOINLINE
 
	`__©Œibu‹__
((
nošlše
))

	)

318 
	#CRYPTOPP_NOINLINE_DOTDOTDOT
 ...

	)

319 
	#CRYPTOPP_NOINLINE


	)

323 #ià(
defšed
(
_MSC_VER
è&& _MSC_VER <ğ1300è|| defšed(
__INTEL_COMPILER
)

324 
	#CRYPTOPP_CONSTANT
(
x
è’um {x};

	)

326 
	#CRYPTOPP_CONSTANT
(
x
ècÚ¡ x;

	)

329 #ià
defšed
(
_M_X64
è|| defšed(
__x86_64__
)

330 
	#CRYPTOPP_BOOL_X64
 1

	)

332 
	#CRYPTOPP_BOOL_X64
 0

	)

336 #ià
defšed
(
_M_IX86
è|| defšed(
__i386__
è|| defšed(
__i386
è|| defšed(
_X86_
è|| defšed(
__I86__
è|| defšed(
__INTEL__
)

337 
	#CRYPTOPP_BOOL_X86
 1

	)

339 
	#CRYPTOPP_BOOL_X86
 0

	)

342 #ià
CRYPTOPP_BOOL_X64
 || 
CRYPTOPP_BOOL_X86
 || 
defšed
(
__pow”pc__
)

343 
	#CRYPTOPP_ALLOW_UNALIGNED_DATA_ACCESS


	)

346 
	#CRYPTOPP_VERSION
 562

	)

350 #iâdeà
NO_OS_DEPENDENCE


352 #ià
defšed
(
_WIN32
è|| defšed(
__CYGWIN__
)

353 
	#CRYPTOPP_WIN32_AVAILABLE


	)

356 #ià
defšed
(
__unix__
è|| defšed(
__MACH__
è|| defšed(
__N‘BSD__
è|| defšed(
__sun
)

357 
	#CRYPTOPP_UNIX_AVAILABLE


	)

360 #ià
defšed
(
CRYPTOPP_WIN32_AVAILABLE
è|| defšed(
CRYPTOPP_UNIX_AVAILABLE
)

361 
	#HIGHRES_TIMER_AVAILABLE


	)

364 #ifdeà
CRYPTOPP_UNIX_AVAILABLE


365 
	#HAS_BERKELEY_STYLE_SOCKETS


	)

368 #ifdeà
CRYPTOPP_WIN32_AVAILABLE


369 
	#HAS_WINDOWS_STYLE_SOCKETS


	)

372 #ià
defšed
(
HIGHRES_TIMER_AVAILABLE
è&& (defšed(
HAS_BERKELEY_STYLE_SOCKETS
è|| defšed(
HAS_WINDOWS_STYLE_SOCKETS
))

373 
	#SOCKETS_AVAILABLE


	)

376 #ià
defšed
(
HAS_WINDOWS_STYLE_SOCKETS
è&& (!defšed(
HAS_BERKELEY_STYLE_SOCKETS
è|| defšed(
PREFER_WINDOWS_STYLE_SOCKETS
))

377 
	#USE_WINDOWS_STYLE_SOCKETS


	)

379 
	#USE_BERKELEY_STYLE_SOCKETS


	)

382 #ià
defšed
(
HIGHRES_TIMER_AVAILABLE
è&& defšed(
CRYPTOPP_WIN32_AVAILABLE
è&& !defšed(
USE_BERKELEY_STYLE_SOCKETS
)

383 
	#WINDOWS_PIPES_AVAILABLE


	)

386 #ià
defšed
(
CRYPTOPP_WIN32_AVAILABLE
è&& defšed(
USE_MS_CRYPTOAPI
)

387 
	#NONBLOCKING_RNG_AVAILABLE


	)

388 
	#OS_RNG_AVAILABLE


	)

391 #ià
defšed
(
CRYPTOPP_UNIX_AVAILABLE
è|| defšed(
CRYPTOPP_DOXYGEN_PROCESSING
)

392 
	#NONBLOCKING_RNG_AVAILABLE


	)

393 
	#BLOCKING_RNG_AVAILABLE


	)

394 
	#OS_RNG_AVAILABLE


	)

395 
	#HAS_PTHREADS


	)

396 
	#THREADS_AVAILABLE


	)

399 #ifdeà
CRYPTOPP_WIN32_AVAILABLE


400 
	#HAS_WINTHREADS


	)

401 
	#THREADS_AVAILABLE


	)

408 #ià
defšed
(
CRYPTOPP_WIN32_AVAILABLE
è&& !defšed(
CRYPTOPP_DOXYGEN_PROCESSING
)

410 #ifdeà
CRYPTOPP_EXPORTS


411 
	#CRYPTOPP_IS_DLL


	)

412 
	#CRYPTOPP_DLL
 
	`__deş¥ec
(
dÎexpÜt
)

	)

413 #–ià
defšed
(
CRYPTOPP_IMPORTS
)

414 
	#CRYPTOPP_IS_DLL


	)

415 
	#CRYPTOPP_DLL
 
	`__deş¥ec
(
dÎimpÜt
)

	)

417 
	#CRYPTOPP_DLL


	)

420 
	#CRYPTOPP_API
 
__cdeş


	)

424 
	#CRYPTOPP_DLL


	)

425 
	#CRYPTOPP_API


	)

429 #ià
defšed
(
__MWERKS__
)

430 
	#CRYPTOPP_EXTERN_DLL_TEMPLATE_CLASS
 
şass
 
CRYPTOPP_DLL


	)

431 #–ià
defšed
(
__BORLANDC__
è|| defšed(
__SUNPRO_CC
)

432 
	#CRYPTOPP_EXTERN_DLL_TEMPLATE_CLASS
 
‹m¶©e
 
şass
 
CRYPTOPP_DLL


	)

434 
	#CRYPTOPP_EXTERN_DLL_TEMPLATE_CLASS
 
‹m¶©e
 
şass
 
CRYPTOPP_DLL


	)

437 #ià
defšed
(
CRYPTOPP_MANUALLY_INSTANTIATE_TEMPLATES
è&& !defšed(
CRYPTOPP_IMPORTS
)

438 
	#CRYPTOPP_DLL_TEMPLATE_CLASS
 
‹m¶©e
 
şass
 
CRYPTOPP_DLL


	)

440 
	#CRYPTOPP_DLL_TEMPLATE_CLASS
 
CRYPTOPP_EXTERN_DLL_TEMPLATE_CLASS


	)

443 #ià
defšed
(
__MWERKS__
)

444 
	#CRYPTOPP_EXTERN_STATIC_TEMPLATE_CLASS
 
şass


	)

445 #–ià
defšed
(
__BORLANDC__
è|| defšed(
__SUNPRO_CC
)

446 
	#CRYPTOPP_EXTERN_STATIC_TEMPLATE_CLASS
 
‹m¶©e
 
şass


	)

448 
	#CRYPTOPP_EXTERN_STATIC_TEMPLATE_CLASS
 
‹m¶©e
 
şass


	)

451 #ià
defšed
(
CRYPTOPP_MANUALLY_INSTANTIATE_TEMPLATES
è&& !defšed(
CRYPTOPP_EXPORTS
)

452 
	#CRYPTOPP_STATIC_TEMPLATE_CLASS
 
‹m¶©e
 
şass


	)

454 
	#CRYPTOPP_STATIC_TEMPLATE_CLASS
 
CRYPTOPP_EXTERN_STATIC_TEMPLATE_CLASS


	)

	@cpu.cpp

3 
	~"pch.h
"

5 #iâdeà
CRYPTOPP_IMPORTS


7 
	~"ıu.h
"

8 
	~"misc.h
"

9 
	~<®gÜ™hm
>

11 #iâdeà
CRYPTOPP_MS_STYLE_INLINE_ASSEMBLY


12 
	~<sigÇl.h
>

13 
	~<£tjmp.h
>

16 #ià
CRYPTOPP_BOOL_SSE2_INTRINSICS_AVAILABLE


17 
	~<emmšŒš.h
>

20 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

22 #ifdeà
CRYPTOPP_CPUID_AVAILABLE


24 #ià
_MSC_VER
 >ğ1400 && 
CRYPTOPP_BOOL_X64


26 
boŞ
 
	$CpuId
(
wÜd32
 
šput
, wÜd32 *
ouut
)

28 
	`__ıuid
((*)
ouut
, 
šput
);

29  
Œue
;

30 
	}
}

34 #iâdeà
CRYPTOPP_MS_STYLE_INLINE_ASSEMBLY


36 (*
SigHªdËr
)();

38 
jmp_buf
 
s_jmpNoCPUID
;

39 
SigIÎHªdËrCPUID
()

41 
lÚgjmp
(
s_jmpNoCPUID
, 1);

44 
jmp_buf
 
s_jmpNoSSE2
;

45 
SigIÎHªdËrSSE2
()

47 
lÚgjmp
(
s_jmpNoSSE2
, 1);

52 
boŞ
 
	$CpuId
(
wÜd32
 
šput
, wÜd32 *
ouut
)

54 #ifdeà
CRYPTOPP_MS_STYLE_INLINE_ASSEMBLY


55 
__Œy


57 
__asm


59 
mov
 
—x
, 
šput


60 
ıuid


61 
mov
 
edi
, 
ouut


62 
mov
 [
edi
], 
—x


63 
mov
 [
edi
+4], 
ebx


64 
mov
 [
edi
+8], 
ecx


65 
mov
 [
edi
+12], 
edx


68 
	`__exû±
 (1)

70  
çl£
;

72  
Œue
;

74 
SigHªdËr
 
ŞdHªdËr
 = 
	`sigÇl
(
SIGILL
, 
SigIÎHªdËrCPUID
);

75 ià(
ŞdHªdËr
 =ğ
SIG_ERR
)

76  
çl£
;

78 
boŞ
 
»suÉ
 = 
Œue
;

79 ià(
	`£tjmp
(
s_jmpNoCPUID
))

80 
»suÉ
 = 
çl£
;

83 
asm


86 #ià
CRYPTOPP_BOOL_X86


91 : "÷" (
ouut
[0]), "=D" (output[1]), "=c" (output[2]), "=d" (output[3])

92 : "a" (
šput
)

96 
	`sigÇl
(
SIGILL
, 
ŞdHªdËr
);

97  
»suÉ
;

99 
	}
}

103 
boŞ
 
	$TrySSE2
()

105 #ià
CRYPTOPP_BOOL_X64


106  
Œue
;

107 #–ià
	`defšed
(
CRYPTOPP_MS_STYLE_INLINE_ASSEMBLY
)

108 
__Œy


110 #ià
CRYPTOPP_BOOL_SSE2_ASM_AVAILABLE


111 
	`AS2
(
pÜ
 
xmm0
, xmm0)

112 #–ià
CRYPTOPP_BOOL_SSE2_INTRINSICS_AVAILABLE


113 
__m128i
 
x
 = 
	`_mm_£tz”o_si128
();

114  
	`_mm_cvtsi128_si32
(
x
) == 0;

117 
	`__exû±
 (1)

119  
çl£
;

121  
Œue
;

123 
SigHªdËr
 
ŞdHªdËr
 = 
	`sigÇl
(
SIGILL
, 
SigIÎHªdËrSSE2
);

124 ià(
ŞdHªdËr
 =ğ
SIG_ERR
)

125  
çl£
;

127 
boŞ
 
»suÉ
 = 
Œue
;

128 ià(
	`£tjmp
(
s_jmpNoSSE2
))

129 
»suÉ
 = 
çl£
;

132 #ià
CRYPTOPP_BOOL_SSE2_ASM_AVAILABLE


133 
__asm
 
	`__vŞ©e
 ("por %xmm0, %xmm0");

134 #–ià
CRYPTOPP_BOOL_SSE2_INTRINSICS_AVAILABLE


135 
__m128i
 
x
 = 
	`_mm_£tz”o_si128
();

136 
»suÉ
 = 
	`_mm_cvtsi128_si32
(
x
) == 0;

140 
	`sigÇl
(
SIGILL
, 
ŞdHªdËr
);

141  
»suÉ
;

143 
	}
}

145 
boŞ
 
g_x86D‘eùiÚDÚe
 = 
çl£
;

146 
boŞ
 
	gg_hasISSE
 = 
çl£
, 
	gg_hasSSE2
 = f®£, 
	gg_hasSSSE3
 = f®£, 
	gg_hasMMX
 = f®£, 
	gg_hasAESNI
 = f®£, 
	gg_hasCLMUL
 = f®£, 
	gg_isP4
 = false;

147 
wÜd32
 
	gg_ÿcheLšeSize
 = 
CRYPTOPP_L1_CACHE_LINE_SIZE
;

149 
	$D‘eùX86F—tu»s
()

151 
wÜd32
 
ıuid
[4], 
ıuid1
[4];

152 ià(!
	`CpuId
(0, 
ıuid
))

154 ià(!
	`CpuId
(1, 
ıuid1
))

157 
g_hasMMX
 = (
ıuid1
[3] & (1 << 23)) != 0;

158 ià((
ıuid1
[3] & (1 << 26)) != 0)

159 
g_hasSSE2
 = 
	`TrySSE2
();

160 
g_hasSSSE3
 = 
g_hasSSE2
 && (
ıuid1
[2] & (1<<9));

161 
g_hasAESNI
 = 
g_hasSSE2
 && (
ıuid1
[2] & (1<<25));

162 
g_hasCLMUL
 = 
g_hasSSE2
 && (
ıuid1
[2] & (1<<1));

164 ià((
ıuid1
[3] & (1 << 25)) != 0)

165 
g_hasISSE
 = 
Œue
;

168 
wÜd32
 
ıuid2
[4];

169 
	`CpuId
(0x080000000, 
ıuid2
);

170 ià(
ıuid2
[0] >= 0x080000001)

172 
	`CpuId
(0x080000001, 
ıuid2
);

173 
g_hasISSE
 = (
ıuid2
[3] & (1 << 22)) != 0;

177 
¡d
::
	`sw­
(
ıuid
[2], cpuid[3]);

178 ià(
	`memcmp
(
ıuid
+1, "GenuineIntel", 12) == 0)

180 
g_isP4
 = ((
ıuid1
[0] >> 8) & 0xf) == 0xf;

181 
g_ÿcheLšeSize
 = 8 * 
	`GETBYTE
(
ıuid1
[1], 1);

183 ià(
	`memcmp
(
ıuid
+1, "AuthenticAMD", 12) == 0)

185 
	`CpuId
(0x80000005, 
ıuid
);

186 
g_ÿcheLšeSize
 = 
	`GETBYTE
(
ıuid
[2], 0);

189 ià(!
g_ÿcheLšeSize
)

190 
g_ÿcheLšeSize
 = 
CRYPTOPP_L1_CACHE_LINE_SIZE
;

192 
g_x86D‘eùiÚDÚe
 = 
Œue
;

193 
	}
}

197 
	gNAMESPACE_END


	@cpu.h

1 #iâdeà
CRYPTOPP_CPU_H


2 
	#CRYPTOPP_CPU_H


	)

4 #ifdeà
CRYPTOPP_GENERATE_X64_MASM


6 
	#CRYPTOPP_X86_ASM_AVAILABLE


	)

7 
	#CRYPTOPP_BOOL_X64
 1

	)

8 
	#CRYPTOPP_BOOL_SSE2_ASM_AVAILABLE
 1

	)

9 
	#NAMESPACE_END


	)

13 
	~"cÚfig.h
"

15 #ià
CRYPTOPP_BOOL_SSE2_INTRINSICS_AVAILABLE


16 
	~<emmšŒš.h
>

19 #ià
CRYPTOPP_BOOL_AESNI_INTRINSICS_AVAILABLE


20 #ià!
defšed
(
__GNUC__
è|| defšed(
__SSSE3__
è|| defšed(
__INTEL_COMPILER
)

21 
	~<tmmšŒš.h
>

23 
__šlše
 
__m128i
 
__©Œibu‹__
((
__gnu_šlše__
, 
__®ways_šlše__
, 
__¬tificŸl__
))

24 
	$_mm_shufæe_•i8
 (
__m128i
 
a
, __m128˜
b
)

26 
	`asm
 ("pshufb %1, %0" : "+x"(
a
è: "xm"(
b
));

27  
a
;

28 
	}
}

30 #ià!
defšed
(
__GNUC__
è|| defšed(
__SSE4_1__
è|| defšed(
__INTEL_COMPILER
)

31 
	~<smmšŒš.h
>

33 
__šlše
 
__©Œibu‹__
((
__gnu_šlše__
, 
__®ways_šlše__
, 
__¬tificŸl__
))

34 
	$_mm_exŒaù_•i32
 (
__m128i
 
a
, cÚ¡ 
i
)

36 
r
;

37 
	`asm
 ("³xŒd %2, %1, %0" : "ôm"(
r
è: "x"(
a
), "i"(
i
));

38  
r
;

39 
	}
}

40 
__šlše
 
__m128i
 
__©Œibu‹__
((
__gnu_šlše__
, 
__®ways_šlše__
, 
__¬tificŸl__
))

41 
	$_mm_š£¹_•i32
 (
__m128i
 
a
, 
b
, cÚ¡ 
i
)

43 
	`asm
 ("pš¤d %2, %1, %0" : "+x"(
a
è: "rm"(
b
), "i"(
i
));

44  
a
;

45 
	}
}

47 #ià!
defšed
(
__GNUC__
è|| (defšed(
__AES__
è&& defšed(
__PCLMUL__
)è|| defšed(
__INTEL_COMPILER
)

48 
	~<wmmšŒš.h
>

50 
__šlše
 
__m128i
 
__©Œibu‹__
((
__gnu_šlše__
, 
__®ways_šlše__
, 
__¬tificŸl__
))

51 
	$_mm_şmuËpi64_si128
 (
__m128i
 
a
, __m128˜
b
, cÚ¡ 
i
)

53 
	`asm
 ("pşmulqdq %2, %1, %0" : "+x"(
a
è: "xm"(
b
), "i"(
i
));

54  
a
;

55 
	}
}

56 
__šlše
 
__m128i
 
__©Œibu‹__
((
__gnu_šlše__
, 
__®ways_šlše__
, 
__¬tificŸl__
))

57 
	$_mm_«skeyg’assi¡_si128
 (
__m128i
 
a
, cÚ¡ 
i
)

59 
__m128i
 
r
;

60 
	`asm
 ("«skeyg’assi¡ %2, %1, %0" : "=x"(
r
è: "xm"(
a
), "i"(
i
));

61  
r
;

62 
	}
}

63 
__šlše
 
__m128i
 
__©Œibu‹__
((
__gnu_šlše__
, 
__®ways_šlše__
, 
__¬tificŸl__
))

64 
	$_mm_«simc_si128
 (
__m128i
 
a
)

66 
__m128i
 
r
;

67 
	`asm
 ("«simø%1, %0" : "=x"(
r
è: "xm"(
a
));

68  
r
;

69 
	}
}

70 
__šlše
 
__m128i
 
__©Œibu‹__
((
__gnu_šlše__
, 
__®ways_šlše__
, 
__¬tificŸl__
))

71 
	$_mm_«£nc_si128
 (
__m128i
 
a
, __m128˜
b
)

73 
	`asm
 ("«£nø%1, %0" : "+x"(
a
è: "xm"(
b
));

74  
a
;

75 
	}
}

76 
__šlše
 
__m128i
 
__©Œibu‹__
((
__gnu_šlše__
, 
__®ways_šlše__
, 
__¬tificŸl__
))

77 
	$_mm_«£nşa¡_si128
 (
__m128i
 
a
, __m128˜
b
)

79 
	`asm
 ("«£nşa¡ %1, %0" : "+x"(
a
è: "xm"(
b
));

80  
a
;

81 
	}
}

82 
__šlše
 
__m128i
 
__©Œibu‹__
((
__gnu_šlše__
, 
__®ways_šlše__
, 
__¬tificŸl__
))

83 
	$_mm_«sdec_si128
 (
__m128i
 
a
, __m128˜
b
)

85 
	`asm
 ("«sdeø%1, %0" : "+x"(
a
è: "xm"(
b
));

86  
a
;

87 
	}
}

88 
__šlše
 
__m128i
 
__©Œibu‹__
((
__gnu_šlše__
, 
__®ways_šlše__
, 
__¬tificŸl__
))

89 
	$_mm_«sdeşa¡_si128
 (
__m128i
 
a
, __m128˜
b
)

91 
	`asm
 ("«sdeşa¡ %1, %0" : "+x"(
a
è: "xm"(
b
));

92  
a
;

93 
	}
}

97 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

99 #ià
CRYPTOPP_BOOL_X86
 || 
CRYPTOPP_BOOL_X64


101 
	#CRYPTOPP_CPUID_AVAILABLE


	)

104 
CRYPTOPP_DLL
 
boŞ
 
g_x86D‘eùiÚDÚe
;

105 
CRYPTOPP_DLL
 
boŞ
 
g_hasSSSE3
;

106 
CRYPTOPP_DLL
 
boŞ
 
g_hasAESNI
;

107 
CRYPTOPP_DLL
 
boŞ
 
g_hasCLMUL
;

108 
CRYPTOPP_DLL
 
boŞ
 
g_isP4
;

109 
CRYPTOPP_DLL
 
wÜd32
 
g_ÿcheLšeSize
;

110 
CRYPTOPP_DLL
 
CRYPTOPP_API
 
	`D‘eùX86F—tu»s
();

111 
CRYPTOPP_DLL
 
boŞ
 
CRYPTOPP_API
 
	`CpuId
(
wÜd32
 
šput
, wÜd32 *
ouut
);

113 #ià
CRYPTOPP_BOOL_X64


114 
šlše
 
boŞ
 
	$HasSSE2
(è{ 
Œue
;
	}
}

115 
šlše
 
boŞ
 
	$HasISSE
(è{ 
Œue
;
	}
}

116 
šlše
 
boŞ
 
	$HasMMX
(è{ 
Œue
;
	}
}

119 
CRYPTOPP_DLL
 
boŞ
 
g_hasSSE2
;

120 
CRYPTOPP_DLL
 
boŞ
 
g_hasISSE
;

121 
CRYPTOPP_DLL
 
boŞ
 
g_hasMMX
;

123 
šlše
 
boŞ
 
	$HasSSE2
()

125 ià(!
g_x86D‘eùiÚDÚe
)

126 
	`D‘eùX86F—tu»s
();

127  
g_hasSSE2
;

128 
	}
}

130 
šlše
 
boŞ
 
	$HasISSE
()

132 ià(!
g_x86D‘eùiÚDÚe
)

133 
	`D‘eùX86F—tu»s
();

134  
g_hasISSE
;

135 
	}
}

137 
šlše
 
boŞ
 
	$HasMMX
()

139 ià(!
g_x86D‘eùiÚDÚe
)

140 
	`D‘eùX86F—tu»s
();

141  
g_hasMMX
;

142 
	}
}

146 
šlše
 
boŞ
 
	$HasSSSE3
()

148 ià(!
g_x86D‘eùiÚDÚe
)

149 
	`D‘eùX86F—tu»s
();

150  
g_hasSSSE3
;

151 
	}
}

153 
šlše
 
boŞ
 
	$HasAESNI
()

155 ià(!
g_x86D‘eùiÚDÚe
)

156 
	`D‘eùX86F—tu»s
();

157  
g_hasAESNI
;

158 
	}
}

160 
šlše
 
boŞ
 
	$HasCLMUL
()

162 ià(!
g_x86D‘eùiÚDÚe
)

163 
	`D‘eùX86F—tu»s
();

164  
g_hasCLMUL
;

165 
	}
}

167 
šlše
 
boŞ
 
	$IsP4
()

169 ià(!
g_x86D‘eùiÚDÚe
)

170 
	`D‘eùX86F—tu»s
();

171  
g_isP4
;

172 
	}
}

174 
šlše
 
	$G‘CacheLšeSize
()

176 ià(!
g_x86D‘eùiÚDÚe
)

177 
	`D‘eùX86F—tu»s
();

178  
g_ÿcheLšeSize
;

179 
	}
}

183 
šlše
 
	$G‘CacheLšeSize
()

185  
CRYPTOPP_L1_CACHE_LINE_SIZE
;

186 
	}
}

192 #ifdeà
CRYPTOPP_GENERATE_X64_MASM


193 
	#AS1
(
x
èx*
Ãwlše
*

	)

194 
	#AS2
(
x
, 
y
èx, y*
Ãwlše
*

	)

195 
	#AS3
(
x
, 
y
, 
z
èx, y, z*
Ãwlše
*

	)

196 
	#ASS
(
x
, 
y
, 
a
, 
b
, 
c
, 
d
èx, y,‡*64+b*16+c*4+d*
Ãwlše
*

	)

197 
	#ASL
(
x
è
Ïb–
##x:*
Ãwlše
*

	)

198 
	#ASJ
(
x
, 
y
, 
z
èx 
Ïb–
##y*
Ãwlše
*

	)

199 
	#ASC
(
x
, 
y
èx 
Ïb–
##y*
Ãwlše
*

	)

200 
	#AS_HEX
(
y
è0##y##
h


	)

201 #–ià
defšed
(
_MSC_VER
è|| defšed(
__BORLANDC__
)

202 
	#CRYPTOPP_MS_STYLE_INLINE_ASSEMBLY


	)

203 
	#AS1
(
x
è
__asm
 {x}

	)

204 
	#AS2
(
x
, 
y
è
__asm
 {x, y}

	)

205 
	#AS3
(
x
, 
y
, 
z
è
__asm
 {x, y, z}

	)

206 
	#ASS
(
x
, 
y
, 
a
, 
b
, 
c
, 
d
è
__asm
 {x, y, (a)*64+(b)*16+(c)*4+(d)}

	)

207 
	#ASL
(
x
è
__asm
 {
Ïb–
##x:}

	)

208 
	#ASJ
(
x
, 
y
, 
z
è
__asm
 {x 
Ïb–
##y}

	)

209 
	#ASC
(
x
, 
y
è
__asm
 {x 
Ïb–
##y}

	)

210 
	#CRYPTOPP_NAKED
 
	`__deş¥ec
(
Çked
)

	)

211 
	#AS_HEX
(
y
è0x##
	)
y

213 
	#CRYPTOPP_GNU_STYLE_INLINE_ASSEMBLY


	)

215 
	#GNU_AS1
(
x
è#x ";"

	)

216 
	#GNU_AS2
(
x
, 
y
è#x ", " #y ";"

	)

217 
	#GNU_AS3
(
x
, 
y
, 
z
è#x ", " #y ", " #z ";"

	)

218 
	#GNU_ASL
(
x
è"\n" #x ":"

	)

219 
	#GNU_ASJ
(
x
, 
y
, 
z
è#x " " #y #z ";"

	)

220 
	#AS1
(
x
è
	`GNU_AS1
(x)

	)

221 
	#AS2
(
x
, 
y
è
	`GNU_AS2
(x, y)

	)

222 
	#AS3
(
x
, 
y
, 
z
è
	`GNU_AS3
(x, y, z)

	)

223 
	#ASS
(
x
, 
y
, 
a
, 
b
, 
c
, 
d
è#x ", " #y ", " #¨"*64+" #b "*16+" #ø"*4+" #d ";"

	)

224 
	#ASL
(
x
è
	`GNU_ASL
(x)

	)

225 
	#ASJ
(
x
, 
y
, 
z
è
	`GNU_ASJ
(x, y, z)

	)

226 
	#ASC
(
x
, 
y
è#x " " #y ";"

	)

227 
	#CRYPTOPP_NAKED


	)

228 
	#AS_HEX
(
y
è0x##
	)
y

231 
	#IF0
(
y
)

	)

232 
	#IF1
(
y
è
	)
y

234 #ifdeà
CRYPTOPP_GENERATE_X64_MASM


235 
	#ASM_MOD
(
x
, 
y
è((xè
	`MOD
 (y))

	)

236 
	#XMMWORD_PTR
 
XMMWORD
 
PTR


	)

239 
	#ASM_MOD
(
x
, 
y
è((x)-((x)/(y))*(y))

	)

241 
	#XMMWORD_PTR


	)

244 #ià
CRYPTOPP_BOOL_X86


245 
	#AS_REG_1
 
ecx


	)

246 
	#AS_REG_2
 
edx


	)

247 
	#AS_REG_3
 
esi


	)

248 
	#AS_REG_4
 
edi


	)

249 
	#AS_REG_5
 
—x


	)

250 
	#AS_REG_6
 
ebx


	)

251 
	#AS_REG_7
 
ebp


	)

252 
	#AS_REG_1d
 
ecx


	)

253 
	#AS_REG_2d
 
edx


	)

254 
	#AS_REG_3d
 
esi


	)

255 
	#AS_REG_4d
 
edi


	)

256 
	#AS_REG_5d
 
—x


	)

257 
	#AS_REG_6d
 
ebx


	)

258 
	#AS_REG_7d
 
ebp


	)

259 
	#WORD_SZ
 4

	)

260 
	#WORD_REG
(
x
è
e
##
	)
x

261 
	#WORD_PTR
 
DWORD
 
PTR


	)

262 
	#AS_PUSH_IF86
(
x
è
	`AS1
(
push
 
e
##x)

	)

263 
	#AS_POP_IF86
(
x
è
	`AS1
(
pİ
 
e
##x)

	)

264 
	#AS_JCXZ
 
jecxz


	)

265 #–ià
CRYPTOPP_BOOL_X64


266 #ifdeà
CRYPTOPP_GENERATE_X64_MASM


267 
	#AS_REG_1
 
rcx


	)

268 
	#AS_REG_2
 
rdx


	)

269 
	#AS_REG_3
 
r8


	)

270 
	#AS_REG_4
 
r9


	)

271 
	#AS_REG_5
 
¿x


	)

272 
	#AS_REG_6
 
r10


	)

273 
	#AS_REG_7
 
r11


	)

274 
	#AS_REG_1d
 
ecx


	)

275 
	#AS_REG_2d
 
edx


	)

276 
	#AS_REG_3d
 
r8d


	)

277 
	#AS_REG_4d
 
r9d


	)

278 
	#AS_REG_5d
 
—x


	)

279 
	#AS_REG_6d
 
r10d


	)

280 
	#AS_REG_7d
 
r11d


	)

282 
	#AS_REG_1
 
rdi


	)

283 
	#AS_REG_2
 
rsi


	)

284 
	#AS_REG_3
 
rdx


	)

285 
	#AS_REG_4
 
rcx


	)

286 
	#AS_REG_5
 
r8


	)

287 
	#AS_REG_6
 
r9


	)

288 
	#AS_REG_7
 
r10


	)

289 
	#AS_REG_1d
 
edi


	)

290 
	#AS_REG_2d
 
esi


	)

291 
	#AS_REG_3d
 
edx


	)

292 
	#AS_REG_4d
 
ecx


	)

293 
	#AS_REG_5d
 
r8d


	)

294 
	#AS_REG_6d
 
r9d


	)

295 
	#AS_REG_7d
 
r10d


	)

297 
	#WORD_SZ
 8

	)

298 
	#WORD_REG
(
x
è
r
##
	)
x

299 
	#WORD_PTR
 
QWORD
 
PTR


	)

300 
	#AS_PUSH_IF86
(
x
)

	)

301 
	#AS_POP_IF86
(
x
)

	)

302 
	#AS_JCXZ
 
jrcxz


	)

306 
	#AS_XMM_OUTPUT4
(
Ïb–P»fix
, 
šputPŒ
, 
ouutPŒ
, 
x0
, 
x1
, 
x2
, 
x3
, 
t
, 
p0
, 
p1
, 
p2
, 
p3
, 
šüem’t
)\

307 
	`AS2
Ğ
‹¡
 
šputPŒ
, inputPtr)\

308 
	`ASC
Ğ
jz
, 
Ïb–P»fix
##3)\

309 
	`AS2
Ğ
‹¡
 
šputPŒ
, 15)\

310 
	`ASC
Ğ
jnz
, 
Ïb–P»fix
##7)\

311 
	`AS2
Ğ
pxÜ
 
xmm
##
x0
, [
šputPŒ
+
p0
*16])\

312 
	`AS2
Ğ
pxÜ
 
xmm
##
x1
, [
šputPŒ
+
p1
*16])\

313 
	`AS2
Ğ
pxÜ
 
xmm
##
x2
, [
šputPŒ
+
p2
*16])\

314 
	`AS2
Ğ
pxÜ
 
xmm
##
x3
, [
šputPŒ
+
p3
*16])\

315 
	`AS2
Ğ
add
 
šputPŒ
, 
šüem’t
*16)\

316 
	`ASC
Ğ
jmp
, 
Ïb–P»fix
##3)\

317 
	`ASL
(
Ïb–P»fix
##7)\

318 
	`AS2
Ğ
movdqu
 
xmm
##
t
, [
šputPŒ
+
p0
*16])\

319 
	`AS2
Ğ
pxÜ
 
xmm
##
x0
, xmm##
t
)\

320 
	`AS2
Ğ
movdqu
 
xmm
##
t
, [
šputPŒ
+
p1
*16])\

321 
	`AS2
Ğ
pxÜ
 
xmm
##
x1
, xmm##
t
)\

322 
	`AS2
Ğ
movdqu
 
xmm
##
t
, [
šputPŒ
+
p2
*16])\

323 
	`AS2
Ğ
pxÜ
 
xmm
##
x2
, xmm##
t
)\

324 
	`AS2
Ğ
movdqu
 
xmm
##
t
, [
šputPŒ
+
p3
*16])\

325 
	`AS2
Ğ
pxÜ
 
xmm
##
x3
, xmm##
t
)\

326 
	`AS2
Ğ
add
 
šputPŒ
, 
šüem’t
*16)\

327 
	`ASL
(
Ïb–P»fix
##3)\

328 
	`AS2
Ğ
‹¡
 
ouutPŒ
, 15)\

329 
	`ASC
Ğ
jnz
, 
Ïb–P»fix
##8)\

330 
	`AS2
Ğ
movdqa
 [
ouutPŒ
+
p0
*16], 
xmm
##
x0
)\

331 
	`AS2
Ğ
movdqa
 [
ouutPŒ
+
p1
*16], 
xmm
##
x1
)\

332 
	`AS2
Ğ
movdqa
 [
ouutPŒ
+
p2
*16], 
xmm
##
x2
)\

333 
	`AS2
Ğ
movdqa
 [
ouutPŒ
+
p3
*16], 
xmm
##
x3
)\

334 
	`ASC
Ğ
jmp
, 
Ïb–P»fix
##9)\

335 
	`ASL
(
Ïb–P»fix
##8)\

336 
	`AS2
Ğ
movdqu
 [
ouutPŒ
+
p0
*16], 
xmm
##
x0
)\

337 
	`AS2
Ğ
movdqu
 [
ouutPŒ
+
p1
*16], 
xmm
##
x1
)\

338 
	`AS2
Ğ
movdqu
 [
ouutPŒ
+
p2
*16], 
xmm
##
x2
)\

339 
	`AS2
Ğ
movdqu
 [
ouutPŒ
+
p3
*16], 
xmm
##
x3
)\

340 
	`ASL
(
Ïb–P»fix
##9)\

341 
	`AS2
Ğ
add
 
ouutPŒ
, 
šüem’t
*16)

	)

343 
	gNAMESPACE_END


	@crc.cpp

3 
	~"pch.h
"

4 
	~"üc.h
"

5 
	~"misc.h
"

7 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

10 cÚ¡ 
wÜd32
 
CRC32
::
m_b
[] = {

11 #ifdeà
IS_LITTLE_ENDIAN


118 
	}
};

120 
	gCRC32
::
	$CRC32
()

122 
	`Re£t
();

123 
	}
}

125 
	gCRC32
::
	$Upd©e
(cÚ¡ 
by‹
 *
s
, 
size_t
 
n
)

127 
wÜd32
 
üc
 = 
m_üc
;

129 ; !
IsAligÃd
<
wÜd32
>(
s
è&& 
n
 > 0;‚--)

130 
üc
 = 
m_b
[
	`CRC32_INDEX
(ücè^ *
s
++] ^ 
	`CRC32_SHIFTED
(crc);

132 
n
 >= 4)

134 
üc
 ^ğ*(cÚ¡ 
wÜd32
 *)
s
;

135 
üc
 = 
m_b
[
	`CRC32_INDEX
(üc)] ^ 
	`CRC32_SHIFTED
(crc);

136 
üc
 = 
m_b
[
	`CRC32_INDEX
(üc)] ^ 
	`CRC32_SHIFTED
(crc);

137 
üc
 = 
m_b
[
	`CRC32_INDEX
(üc)] ^ 
	`CRC32_SHIFTED
(crc);

138 
üc
 = 
m_b
[
	`CRC32_INDEX
(üc)] ^ 
	`CRC32_SHIFTED
(crc);

139 
n
 -= 4;

140 
s
 += 4;

143 
n
--)

144 
üc
 = 
m_b
[
	`CRC32_INDEX
(ücè^ *
s
++] ^ 
	`CRC32_SHIFTED
(crc);

146 
m_üc
 = 
üc
;

147 
	}
}

149 
	gCRC32
::
	$Trunÿ‹dFš®
(
by‹
 *
hash
, 
size_t
 
size
)

151 
	`ThrowIfInv®idTrunÿ‹dSize
(
size
);

153 
m_üc
 ^ğ
CRC32_NEGL
;

154 
size_t
 
i
=0; i<
size
; i++)

155 
hash
[
i
] = 
	`G‘CrcBy‹
(i);

157 
	`Re£t
();

158 
	}
}

160 
	gNAMESPACE_END


	@crc.h

1 #iâdeà
CRYPTOPP_CRC32_H


2 
	#CRYPTOPP_CRC32_H


	)

4 
	~"üy±lib.h
"

6 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

8 cÚ¡ 
wÜd32
 
CRC32_NEGL
 = 0xffffffffL;

10 #ifdeà
IS_LITTLE_ENDIAN


11 
	#CRC32_INDEX
(
c
è(ø& 0xff)

	)

12 
	#CRC32_SHIFTED
(
c
è(ø>> 8)

	)

14 
	#CRC32_INDEX
(
c
è(ø>> 24)

	)

15 
	#CRC32_SHIFTED
(
c
è(ø<< 8)

	)

19 şas 
	cCRC32
 : 
public
 
HashT¿nsfÜm©iÚ


21 
public
:

22 
	$CRYPTOPP_CONSTANT
(
DIGESTSIZE
 = 4)

23 
	`CRC32
();

24 
	`Upd©e
(cÚ¡ 
by‹
 *
šput
, 
size_t
 
Ëngth
);

25 
	`Trunÿ‹dFš®
(
by‹
 *
hash
, 
size_t
 
size
);

26 
	$Dige¡Size
(ècÚ¡ { 
DIGESTSIZE
;}

27 cÚ¡ * 
	$SticAlgÜ™hmName
(è{ "CRC32";
	}
}

28 
	g¡d
::
¡ršg
 
	$AlgÜ™hmName
(ècÚ¡ { 
	`SticAlgÜ™hmName
();
	}
}

30 
	$Upd©eBy‹
(
by‹
 
b
è{
m_üc
 = 
m_b
[
	`CRC32_INDEX
(m_ücè^ b] ^ 
	`CRC32_SHIFTED
(m_üc);
	}
}

31 
by‹
 
	$G‘CrcBy‹
(
size_t
 
i
ècÚ¡ { ((
by‹
 *)&(
m_üc
))[i];
	}
}

33 
	g´iv©e
:

34 
	$Re£t
(è{
m_üc
 = 
CRC32_NEGL
;
	}
}

36 cÚ¡ 
wÜd32
 
	gm_b
[256];

37 
wÜd32
 
	gm_üc
;

40 
	gNAMESPACE_END


	@cryptlib.cpp

3 
	~"pch.h
"

5 #iâdeà
CRYPTOPP_IMPORTS


7 
	~"üy±lib.h
"

8 
	~"misc.h
"

9 
	~"f‹rs.h
"

10 
	~"®g·¿m.h
"

11 
	~"fs140.h
"

12 
	~"¬gÇmes.h
"

13 
	~"æŒim¶.h
"

14 
	~"Œdloÿl.h
"

15 
	~"o¤ng.h
"

17 
	~<memÜy
>

19 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

21 
	`CRYPTOPP_COMPILE_ASSERT
((
by‹
) == 1);

22 
	`CRYPTOPP_COMPILE_ASSERT
((
wÜd16
) == 2);

23 
	`CRYPTOPP_COMPILE_ASSERT
((
wÜd32
) == 4);

24 
	`CRYPTOPP_COMPILE_ASSERT
((
wÜd64
) == 8);

25 #ifdeà
CRYPTOPP_NATIVE_DWORD_AVAILABLE


26 
	`CRYPTOPP_COMPILE_ASSERT
((
dwÜd
è=ğ2*(
wÜd
));

29 cÚ¡ 
¡d
::
¡ršg
 
DEFAULT_CHANNEL
;

30 cÚ¡ 
¡d
::
¡ršg
 
AAD_CHANNEL
 = "AAD";

31 cÚ¡ 
¡d
::
¡ršg
 &
Bufã»dT¿nsfÜm©iÚ
::
NULL_CHANNEL
 = 
DEFAULT_CHANNEL
;

33 şas 
	cNuÎNameV®uePaœs
 : 
public
 
NameV®uePaœs


35 
public
:

36 
boŞ
 
	$G‘VoidV®ue
(cÚ¡ *
Çme
, cÚ¡ 
¡d
::
ty³_šfo
 &
v®ueTy³
, *
pV®ue
ècÚ¡ { 
çl£
;}

37 
	}
};

39 
	gsim¶e_±r
<
	gNuÎNameV®uePaœs
> 
s_pNuÎNameV®uePaœs
(
Ãw
 
NuÎNameV®uePaœs
);

40 cÚ¡ 
	gNameV®uePaœs
 &
	gg_nuÎNameV®uePaœs
 = *
s_pNuÎNameV®uePaœs
.
m_p
;

42 
	gBufã»dT¿nsfÜm©iÚ
 & 
	$TheB™Buck‘
()

44 
B™Buck‘
 
b™Buck‘
;

45  
b™Buck‘
;

46 
	}
}

48 
	gAlgÜ™hm
::
	$AlgÜ™hm
(
boŞ
 
checkS–fTe¡Stus
)

50 ià(
checkS–fTe¡Stus
 && 
	`FIPS_140_2_Com¶ŸnûEÇbËd
())

52 ià(
	`G‘Pow”UpS–fTe¡Stus
(è=ğ
POWER_UP_SELF_TEST_NOT_DONE
 && !
	`Pow”UpS–fTe¡InProg»ssOnThisTh»ad
())

53 
throw
 
	`S–fTe¡Fau»
("Cryptographic‡lgorithms‡re disabled beforehe…ower-up selfests‡re…erformed.");

55 ià(
	`G‘Pow”UpS–fTe¡Stus
(è=ğ
POWER_UP_SELF_TEST_FAILED
)

56 
throw
 
	`S–fTe¡Fau»
("Cryptographic‡lgorithms‡re disabled‡fter‡…ower-up selfest failed.");

58 
	}
}

60 
	gSim¶eKeyšgIÁ”çû
::
	$S‘Key
(cÚ¡ 
by‹
 *
key
, 
size_t
 
Ëngth
, cÚ¡ 
NameV®uePaœs
 &
·¿ms
)

62 
this
->
	`ThrowIfInv®idKeyL’gth
(
Ëngth
);

63 
this
->
	`UncheckedS‘Key
(
key
, ()
Ëngth
, 
·¿ms
);

64 
	}
}

66 
	gSim¶eKeyšgIÁ”çû
::
	$S‘KeyW™hRounds
(cÚ¡ 
by‹
 *
key
, 
size_t
 
Ëngth
, 
rounds
)

68 
	`S‘Key
(
key
, 
Ëngth
, 
	`MakeP¬am‘”s
(
Name
::
	`Rounds
(), 
rounds
));

69 
	}
}

71 
	gSim¶eKeyšgIÁ”çû
::
	$S‘KeyW™hIV
(cÚ¡ 
by‹
 *
key
, 
size_t
 
Ëngth
, cÚ¡ by‹ *
iv
, size_ˆ
ivL’gth
)

73 
	`S‘Key
(
key
, 
Ëngth
, 
	`MakeP¬am‘”s
(
Name
::
	`IV
(), 
	`CÚ¡By‹A¼ayP¬am‘”
(
iv
, 
ivL’gth
)));

74 
	}
}

76 
	gSim¶eKeyšgIÁ”çû
::
	$ThrowIfInv®idKeyL’gth
(
size_t
 
Ëngth
)

78 ià(!
	`IsV®idKeyL’gth
(
Ëngth
))

79 
throw
 
	`Inv®idKeyL’gth
(
	`G‘AlgÜ™hm
().
	`AlgÜ™hmName
(), 
Ëngth
);

80 
	}
}

82 
	gSim¶eKeyšgIÁ”çû
::
	$ThrowIfResynchrÚizabË
()

84 ià(
	`IsResynchrÚizabË
())

85 
throw
 
	`Inv®idArgum’t
(
	`G‘AlgÜ™hm
().
	`AlgÜ™hmName
() + ":his object„equires‡n IV");

86 
	}
}

88 
	gSim¶eKeyšgIÁ”çû
::
	$ThrowIfInv®idIV
(cÚ¡ 
by‹
 *
iv
)

90 ià(!
iv
 && 
	`IVRequœem’t
(è=ğ
UNPREDICTABLE_RANDOM_IV
)

91 
throw
 
	`Inv®idArgum’t
(
	`G‘AlgÜ™hm
().
	`AlgÜ™hmName
() + ":his object cannot use‡‚ull IV");

92 
	}
}

94 
size_t
 
	gSim¶eKeyšgIÁ”çû
::
	$ThrowIfInv®idIVL’gth
(
size
)

96 ià(
size
 < 0)

97  
	`IVSize
();

98 ià((
size_t
)
size
 < 
	`MšIVL’gth
())

99 
throw
 
	`Inv®idArgum’t
(
	`G‘AlgÜ™hm
().
	`AlgÜ™hmName
(è+ ": IV†’gth " + 
	`IÁToSŒšg
(
size
è+ " i Ës thªhmšimum oà" + IÁToSŒšg(
	`MšIVL’gth
()));

100 ià((
size_t
)
size
 > 
	`MaxIVL’gth
())

101 
throw
 
	`Inv®idArgum’t
(
	`G‘AlgÜ™hm
().
	`AlgÜ™hmName
(è+ ": IV†’gth " + 
	`IÁToSŒšg
(
size
è+ "ƒxûed thmaximum oà" + IÁToSŒšg(
	`MaxIVL’gth
()));

103  
size
;

104 
	}
}

106 cÚ¡ 
by‹
 * 
	gSim¶eKeyšgIÁ”çû
::
	$G‘IVAndThrowIfInv®id
(cÚ¡ 
NameV®uePaœs
 &
·¿ms
, 
size_t
 &
size
)

108 
CÚ¡By‹A¼ayP¬am‘”
 
ivW™hL’gth
;

109 cÚ¡ 
by‹
 *
iv
;

110 
boŞ
 
found
 = 
çl£
;

112 
Œy
 {
found
 = 
·¿ms
.
	`G‘V®ue
(
Name
::
	`IV
(), 
ivW™hL’gth
);}

113 
	`ÿtch
 (cÚ¡ 
NameV®uePaœs
::
V®ueTy³Mism©ch
 &) {}

115 ià(
found
)

117 
iv
 = 
ivW™hL’gth
.
	`begš
();

118 
	`ThrowIfInv®idIV
(
iv
);

119 
size
 = 
	`ThrowIfInv®idIVL’gth
(()
ivW™hL’gth
.
	`size
());

120  
iv
;

122 ià(
·¿ms
.
	`G‘V®ue
(
Name
::
	`IV
(), 
iv
))

124 
	`ThrowIfInv®idIV
(
iv
);

125 
size
 = 
	`IVSize
();

126  
iv
;

130 
	`ThrowIfResynchrÚizabË
();

131 
size
 = 0;

132  
NULL
;

134 
	}
}

136 
	gSim¶eKeyšgIÁ”çû
::
	$G‘NextIV
(
RªdomNumb”G’”©Ü
 &
ºg
, 
by‹
 *
IV
)

138 
ºg
.
	`G’”©eBlock
(
IV
, 
	`IVSize
());

139 
	}
}

141 
size_t
 
	gBlockT¿nsfÜm©iÚ
::
	$AdvªûdProûssBlocks
(cÚ¡ 
by‹
 *
šBlocks
, cÚ¡ by‹ *
xÜBlocks
, by‹ *
outBlocks
, 
size_t
 
Ëngth
, 
wÜd32
 
æags
) const

143 
size_t
 
blockSize
 = 
	`BlockSize
();

144 
size_t
 
šInüem’t
 = (
æags
 & (
BT_InBlockIsCouÁ”
|
BT_DÚtInüem’tInOutPoš‹rs
)è? 0 : 
blockSize
;

145 
size_t
 
xÜInüem’t
 = 
xÜBlocks
 ? 
blockSize
 : 0;

146 
size_t
 
outInüem’t
 = (
æags
 & 
BT_DÚtInüem’tInOutPoš‹rs
è? 0 : 
blockSize
;

148 ià(
æags
 & 
BT_Rev”£DœeùiÚ
)

150 
	`as£¹
(
Ëngth
 % 
blockSize
 == 0);

151 
šBlocks
 +ğ
Ëngth
 - 
blockSize
;

152 
xÜBlocks
 +ğ
Ëngth
 - 
blockSize
;

153 
outBlocks
 +ğ
Ëngth
 - 
blockSize
;

154 
šInüem’t
 = 0-inIncrement;

155 
xÜInüem’t
 = 0-xorIncrement;

156 
outInüem’t
 = 0-outIncrement;

159 
Ëngth
 >ğ
blockSize
)

161 ià(
æags
 & 
BT_XÜIÅut
)

163 
	`xÜbuf
(
outBlocks
, 
xÜBlocks
, 
šBlocks
, 
blockSize
);

164 
	`ProûssBlock
(
outBlocks
);

167 
	`ProûssAndXÜBlock
(
šBlocks
, 
xÜBlocks
, 
outBlocks
);

168 ià(
æags
 & 
BT_InBlockIsCouÁ”
)

169 
cÚ¡_ÿ¡
<
by‹
 *>(
šBlocks
)[
blockSize
-1]++;

170 
šBlocks
 +ğ
šInüem’t
;

171 
outBlocks
 +ğ
outInüem’t
;

172 
xÜBlocks
 +ğ
xÜInüem’t
;

173 
Ëngth
 -ğ
blockSize
;

176  
Ëngth
;

177 
	}
}

179 
	gBlockT¿nsfÜm©iÚ
::
	$O±im®D©aAlignm’t
() const

181  
G‘Alignm’tOf
<
wÜd32
>();

182 
	}
}

184 
	gSŒ—mT¿nsfÜm©iÚ
::
	$O±im®D©aAlignm’t
() const

186  
G‘Alignm’tOf
<
wÜd32
>();

187 
	}
}

189 
	gHashT¿nsfÜm©iÚ
::
	$O±im®D©aAlignm’t
() const

191  
G‘Alignm’tOf
<
wÜd32
>();

192 
	}
}

194 
	gSŒ—mT¿nsfÜm©iÚ
::
	$ProûssLa¡Block
(
by‹
 *
outSŒšg
, cÚ¡ by‹ *
šSŒšg
, 
size_t
 
Ëngth
)

196 
	`as£¹
(
	`MšLa¡BlockSize
() == 0);

198 ià(
Ëngth
 =ğ
	`Mªd©ÜyBlockSize
())

199 
	`ProûssD©a
(
outSŒšg
, 
šSŒšg
, 
Ëngth
);

200 ià(
Ëngth
 != 0)

201 
throw
 
	`NÙIm¶em’‹d
(
	`AlgÜ™hmName
() + ":his object does't support‡ special†ast block");

202 
	}
}

204 
	gAuth’tiÿ‹dSymm‘ricCh”
::
	$S³cifyD©aL’gths
(
lwÜd
 
h—d”L’gth
,†wÜd 
mes§geL’gth
,†wÜd 
foÙ”L’gth
)

206 ià(
h—d”L’gth
 > 
	`MaxH—d”L’gth
())

207 
throw
 
	`Inv®idArgum’t
(
	`G‘AlgÜ™hm
().
	`AlgÜ™hmName
(è+ ": h—d”†’gth " + 
	`IÁToSŒšg
(
h—d”L’gth
è+ "ƒxûed thmaximum oà" + IÁToSŒšg(
	`MaxH—d”L’gth
()));

209 ià(
mes§geL’gth
 > 
	`MaxMes§geL’gth
())

210 
throw
 
	`Inv®idArgum’t
(
	`G‘AlgÜ™hm
().
	`AlgÜ™hmName
(è+ ": mes§gËngth " + 
	`IÁToSŒšg
(
mes§geL’gth
è+ "ƒxûed thmaximum oà" + IÁToSŒšg(
	`MaxMes§geL’gth
()));

212 ià(
foÙ”L’gth
 > 
	`MaxFoÙ”L’gth
())

213 
throw
 
	`Inv®idArgum’t
(
	`G‘AlgÜ™hm
().
	`AlgÜ™hmName
(è+ ": foÙ”†’gth " + 
	`IÁToSŒšg
(
foÙ”L’gth
è+ "ƒxûed thmaximum oà" + IÁToSŒšg(
	`MaxFoÙ”L’gth
()));

215 
	`UncheckedS³cifyD©aL’gths
(
h—d”L’gth
, 
mes§geL’gth
, 
foÙ”L’gth
);

216 
	}
}

218 
	gAuth’tiÿ‹dSymm‘ricCh”
::
	$Enüy±AndAuth’tiÿ‹
(
by‹
 *
ch”‹xt
, by‹ *
mac
, 
size_t
 
macSize
, cÚ¡ by‹ *
iv
, 
ivL’gth
, cÚ¡ by‹ *
h—d”
, size_ˆ
h—d”L’gth
, cÚ¡ by‹ *
mes§ge
, size_ˆ
mes§geL’gth
)

220 
	`ResynchrÚize
(
iv
, 
ivL’gth
);

221 
	`S³cifyD©aL’gths
(
h—d”L’gth
, 
mes§geL’gth
);

222 
	`Upd©e
(
h—d”
, 
h—d”L’gth
);

223 
	`ProûssSŒšg
(
ch”‹xt
, 
mes§ge
, 
mes§geL’gth
);

224 
	`Trunÿ‹dFš®
(
mac
, 
macSize
);

225 
	}
}

227 
boŞ
 
	gAuth’tiÿ‹dSymm‘ricCh”
::
	$Deüy±AndV”ify
(
by‹
 *
mes§ge
, cÚ¡ by‹ *
mac
, 
size_t
 
macL’gth
, cÚ¡ by‹ *
iv
, 
ivL’gth
, cÚ¡ by‹ *
h—d”
, size_ˆ
h—d”L’gth
, cÚ¡ by‹ *
ch”‹xt
, size_ˆ
ch”‹xtL’gth
)

229 
	`ResynchrÚize
(
iv
, 
ivL’gth
);

230 
	`S³cifyD©aL’gths
(
h—d”L’gth
, 
ch”‹xtL’gth
);

231 
	`Upd©e
(
h—d”
, 
h—d”L’gth
);

232 
	`ProûssSŒšg
(
mes§ge
, 
ch”‹xt
, 
ch”‹xtL’gth
);

233  
	`Trunÿ‹dV”ify
(
mac
, 
macL’gth
);

234 
	}
}

236 
	gRªdomNumb”G’”©Ü
::
	$G’”©eB™
()

238  
	`G’”©eBy‹
() & 1;

239 
	}
}

241 
by‹
 
	gRªdomNumb”G’”©Ü
::
	$G’”©eBy‹
()

243 
by‹
 
b
;

244 
	`G’”©eBlock
(&
b
, 1);

245  
b
;

246 
	}
}

248 
wÜd32
 
	gRªdomNumb”G’”©Ü
::
	$G’”©eWÜd32
(
wÜd32
 
mš
, wÜd32 
max
)

250 
wÜd32
 
¿nge
 = 
max
-
mš
;

251 cÚ¡ 
maxB™s
 = 
	`B™P»cisiÚ
(
¿nge
);

253 
wÜd32
 
v®ue
;

257 
	`G’”©eBlock
((
by‹
 *)&
v®ue
, (value));

258 
v®ue
 = 
	`Crİ
(v®ue, 
maxB™s
);

259 } 
v®ue
 > 
¿nge
);

261  
v®ue
+
mš
;

262 
	}
}

264 
	gRªdomNumb”G’”©Ü
::
	$G’”©eBlock
(
by‹
 *
ouut
, 
size_t
 
size
)

266 
A¼aySšk
 
	`s
(
ouut
, 
size
);

267 
	`G’”©eIÁoBufã»dT¿nsfÜm©iÚ
(
s
, 
DEFAULT_CHANNEL
, 
size
);

268 
	}
}

270 
	gRªdomNumb”G’”©Ü
::
	$DisÿrdBy‹s
(
size_t
 
n
)

272 
	`G’”©eIÁoBufã»dT¿nsfÜm©iÚ
(
	`TheB™Buck‘
(), 
DEFAULT_CHANNEL
, 
n
);

273 
	}
}

275 
	gRªdomNumb”G’”©Ü
::
	$G’”©eIÁoBufã»dT¿nsfÜm©iÚ
(
Bufã»dT¿nsfÜm©iÚ
 &
rg‘
, cÚ¡ 
¡d
::
¡ršg
 &
chªÃl
, 
lwÜd
 
Ëngth
)

277 
FixedSizeSecBlock
<
by‹
, 256> 
bufãr
;

278 
Ëngth
)

280 
size_t
 
Ën
 = 
	`UnsigÃdMš
(
bufãr
.
	`size
(), 
Ëngth
);

281 
	`G’”©eBlock
(
bufãr
, 
Ën
);

282 
rg‘
.
	`ChªÃlPut
(
chªÃl
, 
bufãr
, 
Ën
);

283 
Ëngth
 -ğ
Ën
;

285 
	}
}

288 şas 
	cCÏssNuÎRNG
 : 
public
 
RªdomNumb”G’”©Ü


290 
public
:

291 
¡d
::
¡ršg
 
	$AlgÜ™hmName
() const { "NullRNG";}

292 
	$G’”©eBlock
(
by‹
 *
ouut
, 
size_t
 
size
è{
throw
 
	`NÙIm¶em’‹d
("NuÎRNG: NuÎRNG should oÆy b·s£dØfunùiÚ th© dÚ'ˆÃedØg’”©¿ndom by‹s");
	}
}

295 
	gRªdomNumb”G’”©Ü
 & 
	$NuÎRNG
()

297 
CÏssNuÎRNG
 
s_nuÎRNG
;

298  
s_nuÎRNG
;

299 
	}
}

301 
boŞ
 
	gHashT¿nsfÜm©iÚ
::
	$Trunÿ‹dV”ify
(cÚ¡ 
by‹
 *
dige¡In
, 
size_t
 
dige¡L’gth
)

303 
	`ThrowIfInv®idTrunÿ‹dSize
(
dige¡L’gth
);

304 
SecBy‹Block
 
	`dige¡
(
dige¡L’gth
);

305 
	`Trunÿ‹dFš®
(
dige¡
, 
dige¡L’gth
);

306  
	`V”ifyBufsEqu®
(
dige¡
, 
dige¡In
, 
dige¡L’gth
);

307 
	}
}

309 
	gHashT¿nsfÜm©iÚ
::
	$ThrowIfInv®idTrunÿ‹dSize
(
size_t
 
size
) const

311 ià(
size
 > 
	`Dige¡Size
())

312 
throw
 
	`Inv®idArgum’t
("HashT¿nsfÜm©iÚ: cª'ˆŒunÿ‹‡ " + 
	`IÁToSŒšg
(
	`Dige¡Size
()è+ " by‹ dige¡Ø" + IÁToSŒšg(
size
) + " bytes");

313 
	}
}

315 
	gBufã»dT¿nsfÜm©iÚ
::
	$G‘MaxWa™ObjeùCouÁ
() const

317 cÚ¡ 
Bufã»dT¿nsfÜm©iÚ
 *
t
 = 
	`A‰achedT¿nsfÜm©iÚ
();

318  
t
 ?->
	`G‘MaxWa™ObjeùCouÁ
() : 0;

319 
	}
}

321 
	gBufã»dT¿nsfÜm©iÚ
::
	$G‘Wa™Objeùs
(
Wa™ObjeùCÚš”
 &
cÚš”
, 
C®lSck
 cÚ¡& 
ÿÎSck
)

323 
Bufã»dT¿nsfÜm©iÚ
 *
t
 = 
	`A‰achedT¿nsfÜm©iÚ
();

324 ià(
t
)

325 
t
->
	`G‘Wa™Objeùs
(
cÚš”
, 
ÿÎSck
);

326 
	}
}

328 
	gBufã»dT¿nsfÜm©iÚ
::
	$In™Ÿlize
(cÚ¡ 
NameV®uePaœs
 &
·¿m‘”s
, 
´İag©iÚ
)

330 
	`as£¹
(!
	`A‰achedT¿nsfÜm©iÚ
());

331 
	`IsŞ©edIn™Ÿlize
(
·¿m‘”s
);

332 
	}
}

334 
boŞ
 
	gBufã»dT¿nsfÜm©iÚ
::
	$Flush
(
boŞ
 
h¬dFlush
, 
´İag©iÚ
, boŞ 
blockšg
)

336 
	`as£¹
(!
	`A‰achedT¿nsfÜm©iÚ
());

337  
	`IsŞ©edFlush
(
h¬dFlush
, 
blockšg
);

338 
	}
}

340 
boŞ
 
	gBufã»dT¿nsfÜm©iÚ
::
	$Mes§geS”›sEnd
(
´İag©iÚ
, 
boŞ
 
blockšg
)

342 
	`as£¹
(!
	`A‰achedT¿nsfÜm©iÚ
());

343  
	`IsŞ©edMes§geS”›sEnd
(
blockšg
);

344 
	}
}

346 
by‹
 * 
	gBufã»dT¿nsfÜm©iÚ
::
	$ChªÃlC»©ePutS·û
(cÚ¡ 
¡d
::
¡ršg
 &
chªÃl
, 
size_t
 &
size
)

348 ià(
chªÃl
.
	`em±y
())

349  
	`C»©ePutS·û
(
size
);

351 
throw
 
	`NoChªÃlSuµÜt
(
	`AlgÜ™hmName
());

352 
	}
}

354 
size_t
 
	gBufã»dT¿nsfÜm©iÚ
::
	$ChªÃlPut2
(cÚ¡ 
¡d
::
¡ršg
 &
chªÃl
, cÚ¡ 
by‹
 *
begš
, 
size_t
 
Ëngth
, 
mes§geEnd
, 
boŞ
 
blockšg
)

356 ià(
chªÃl
.
	`em±y
())

357  
	`Put2
(
begš
, 
Ëngth
, 
mes§geEnd
, 
blockšg
);

359 
throw
 
	`NoChªÃlSuµÜt
(
	`AlgÜ™hmName
());

360 
	}
}

362 
size_t
 
	gBufã»dT¿nsfÜm©iÚ
::
	$ChªÃlPutModifŸbË2
(cÚ¡ 
¡d
::
¡ršg
 &
chªÃl
, 
by‹
 *
begš
, 
size_t
 
Ëngth
, 
mes§geEnd
, 
boŞ
 
blockšg
)

364 ià(
chªÃl
.
	`em±y
())

365  
	`PutModifŸbË2
(
begš
, 
Ëngth
, 
mes§geEnd
, 
blockšg
);

367  
	`ChªÃlPut2
(
chªÃl
, 
begš
, 
Ëngth
, 
mes§geEnd
, 
blockšg
);

368 
	}
}

370 
boŞ
 
	gBufã»dT¿nsfÜm©iÚ
::
	$ChªÃlFlush
(cÚ¡ 
¡d
::
¡ršg
 &
chªÃl
, 
boŞ
 
com¶‘eFlush
, 
´İag©iÚ
, boŞ 
blockšg
)

372 ià(
chªÃl
.
	`em±y
())

373  
	`Flush
(
com¶‘eFlush
, 
´İag©iÚ
, 
blockšg
);

375 
throw
 
	`NoChªÃlSuµÜt
(
	`AlgÜ™hmName
());

376 
	}
}

378 
boŞ
 
	gBufã»dT¿nsfÜm©iÚ
::
	$ChªÃlMes§geS”›sEnd
(cÚ¡ 
¡d
::
¡ršg
 &
chªÃl
, 
´İag©iÚ
, 
boŞ
 
blockšg
)

380 ià(
chªÃl
.
	`em±y
())

381  
	`Mes§geS”›sEnd
(
´İag©iÚ
, 
blockšg
);

383 
throw
 
	`NoChªÃlSuµÜt
(
	`AlgÜ™hmName
());

384 
	}
}

386 
lwÜd
 
	gBufã»dT¿nsfÜm©iÚ
::
	$MaxR‘r›vabË
() const

388 ià(
	`A‰achedT¿nsfÜm©iÚ
())

389  
	`A‰achedT¿nsfÜm©iÚ
()->
	`MaxR‘r›vabË
();

391  
	`CİyTo
(
	`TheB™Buck‘
());

392 
	}
}

394 
boŞ
 
	gBufã»dT¿nsfÜm©iÚ
::
	$AnyR‘r›vabË
() const

396 ià(
	`A‰achedT¿nsfÜm©iÚ
())

397  
	`A‰achedT¿nsfÜm©iÚ
()->
	`AnyR‘r›vabË
();

400 
by‹
 
b
;

401  
	`P“k
(
b
) != 0;

403 
	}
}

405 
size_t
 
	gBufã»dT¿nsfÜm©iÚ
::
	$G‘
(
by‹
 &
outBy‹
)

407 ià(
	`A‰achedT¿nsfÜm©iÚ
())

408  
	`A‰achedT¿nsfÜm©iÚ
()->
	`G‘
(
outBy‹
);

410  
	`G‘
(&
outBy‹
, 1);

411 
	}
}

413 
size_t
 
	gBufã»dT¿nsfÜm©iÚ
::
	$G‘
(
by‹
 *
outSŒšg
, 
size_t
 
g‘Max
)

415 ià(
	`A‰achedT¿nsfÜm©iÚ
())

416  
	`A‰achedT¿nsfÜm©iÚ
()->
	`G‘
(
outSŒšg
, 
g‘Max
);

419 
A¼aySšk
 
	`¬¿ySšk
(
outSŒšg
, 
g‘Max
);

420  (
size_t
)
	`T¿nsãrTo
(
¬¿ySšk
, 
g‘Max
);

422 
	}
}

424 
size_t
 
	gBufã»dT¿nsfÜm©iÚ
::
	$P“k
(
by‹
 &
outBy‹
) const

426 ià(
	`A‰achedT¿nsfÜm©iÚ
())

427  
	`A‰achedT¿nsfÜm©iÚ
()->
	`P“k
(
outBy‹
);

429  
	`P“k
(&
outBy‹
, 1);

430 
	}
}

432 
size_t
 
	gBufã»dT¿nsfÜm©iÚ
::
	$P“k
(
by‹
 *
outSŒšg
, 
size_t
 
³ekMax
) const

434 ià(
	`A‰achedT¿nsfÜm©iÚ
())

435  
	`A‰achedT¿nsfÜm©iÚ
()->
	`P“k
(
outSŒšg
, 
³ekMax
);

438 
A¼aySšk
 
	`¬¿ySšk
(
outSŒšg
, 
³ekMax
);

439  (
size_t
)
	`CİyTo
(
¬¿ySšk
, 
³ekMax
);

441 
	}
}

443 
lwÜd
 
	gBufã»dT¿nsfÜm©iÚ
::
	$Sk
(
lwÜd
 
skMax
)

445 ià(
	`A‰achedT¿nsfÜm©iÚ
())

446  
	`A‰achedT¿nsfÜm©iÚ
()->
	`Sk
(
skMax
);

448  
	`T¿nsãrTo
(
	`TheB™Buck‘
(), 
skMax
);

449 
	}
}

451 
lwÜd
 
	gBufã»dT¿nsfÜm©iÚ
::
	$TÙ®By‹sR‘r›vabË
() const

453 ià(
	`A‰achedT¿nsfÜm©iÚ
())

454  
	`A‰achedT¿nsfÜm©iÚ
()->
	`TÙ®By‹sR‘r›vabË
();

456  
	`MaxR‘r›vabË
();

457 
	}
}

459 
	gBufã»dT¿nsfÜm©iÚ
::
	$Numb”OfMes§ges
() const

461 ià(
	`A‰achedT¿nsfÜm©iÚ
())

462  
	`A‰achedT¿nsfÜm©iÚ
()->
	`Numb”OfMes§ges
();

464  
	`CİyMes§gesTo
(
	`TheB™Buck‘
());

465 
	}
}

467 
boŞ
 
	gBufã»dT¿nsfÜm©iÚ
::
	$AnyMes§ges
() const

469 ià(
	`A‰achedT¿nsfÜm©iÚ
())

470  
	`A‰achedT¿nsfÜm©iÚ
()->
	`AnyMes§ges
();

472  
	`Numb”OfMes§ges
() != 0;

473 
	}
}

475 
boŞ
 
	gBufã»dT¿nsfÜm©iÚ
::
	$G‘NextMes§ge
()

477 ià(
	`A‰achedT¿nsfÜm©iÚ
())

478  
	`A‰achedT¿nsfÜm©iÚ
()->
	`G‘NextMes§ge
();

481 
	`as£¹
(!
	`AnyMes§ges
());

482  
çl£
;

484 
	}
}

486 
	gBufã»dT¿nsfÜm©iÚ
::
	$SkMes§ges
(
couÁ
)

488 ià(
	`A‰achedT¿nsfÜm©iÚ
())

489  
	`A‰achedT¿nsfÜm©iÚ
()->
	`SkMes§ges
(
couÁ
);

491  
	`T¿nsãrMes§gesTo
(
	`TheB™Buck‘
(), 
couÁ
);

492 
	}
}

494 
size_t
 
	gBufã»dT¿nsfÜm©iÚ
::
	$T¿nsãrMes§gesTo2
(
Bufã»dT¿nsfÜm©iÚ
 &
rg‘
, &
mes§geCouÁ
, cÚ¡ 
¡d
::
¡ršg
 &
chªÃl
, 
boŞ
 
blockšg
)

496 ià(
	`A‰achedT¿nsfÜm©iÚ
())

497  
	`A‰achedT¿nsfÜm©iÚ
()->
	`T¿nsãrMes§gesTo2
(
rg‘
, 
mes§geCouÁ
, 
chªÃl
, 
blockšg
);

500 
maxMes§ges
 = 
mes§geCouÁ
;

501 
mes§geCouÁ
=0; mes§geCouÁ < 
maxMes§ges
 && 
	`AnyMes§ges
(); messageCount++)

503 
size_t
 
blockedBy‹s
;

504 
lwÜd
 
Œªsã¼edBy‹s
;

506 
	`AnyR‘r›vabË
())

508 
Œªsã¼edBy‹s
 = 
LWORD_MAX
;

509 
blockedBy‹s
 = 
	`T¿nsãrTo2
(
rg‘
, 
Œªsã¼edBy‹s
, 
chªÃl
, 
blockšg
);

510 ià(
blockedBy‹s
 > 0)

511  
blockedBy‹s
;

514 ià(
rg‘
.
	`ChªÃlMes§geEnd
(
chªÃl
, 
	`G‘AutoSigÇlPrİag©iÚ
(), 
blockšg
))

517 
boŞ
 
»suÉ
 = 
	`G‘NextMes§ge
();

518 
	`as£¹
(
»suÉ
);

522 
	}
}

524 
	gBufã»dT¿nsfÜm©iÚ
::
	$CİyMes§gesTo
(
Bufã»dT¿nsfÜm©iÚ
 &
rg‘
, 
couÁ
, cÚ¡ 
¡d
::
¡ršg
 &
chªÃl
) const

526 ià(
	`A‰achedT¿nsfÜm©iÚ
())

527  
	`A‰achedT¿nsfÜm©iÚ
()->
	`CİyMes§gesTo
(
rg‘
, 
couÁ
, 
chªÃl
);

530 
	}
}

532 
	gBufã»dT¿nsfÜm©iÚ
::
	$SkAÎ
()

534 ià(
	`A‰achedT¿nsfÜm©iÚ
())

535 
	`A‰achedT¿nsfÜm©iÚ
()->
	`SkAÎ
();

538 
	`SkMes§ges
()) {}

539 
	`Sk
()) {}

541 
	}
}

543 
size_t
 
	gBufã»dT¿nsfÜm©iÚ
::
	$T¿nsãrAÎTo2
(
Bufã»dT¿nsfÜm©iÚ
 &
rg‘
, cÚ¡ 
¡d
::
¡ršg
 &
chªÃl
, 
boŞ
 
blockšg
)

545 ià(
	`A‰achedT¿nsfÜm©iÚ
())

546  
	`A‰achedT¿nsfÜm©iÚ
()->
	`T¿nsãrAÎTo2
(
rg‘
, 
chªÃl
, 
blockšg
);

549 
	`as£¹
(!
	`Numb”OfMes§geS”›s
());

551 
mes§geCouÁ
;

554 
mes§geCouÁ
 = 
UINT_MAX
;

555 
size_t
 
blockedBy‹s
 = 
	`T¿nsãrMes§gesTo2
(
rg‘
, 
mes§geCouÁ
, 
chªÃl
, 
blockšg
);

556 ià(
blockedBy‹s
)

557  
blockedBy‹s
;

559 
mes§geCouÁ
 != 0);

561 
lwÜd
 
by‹CouÁ
;

564 
by‹CouÁ
 = 
ULONG_MAX
;

565 
size_t
 
blockedBy‹s
 = 
	`T¿nsãrTo2
(
rg‘
, 
by‹CouÁ
, 
chªÃl
, 
blockšg
);

566 ià(
blockedBy‹s
)

567  
blockedBy‹s
;

569 
by‹CouÁ
 != 0);

573 
	}
}

575 
	gBufã»dT¿nsfÜm©iÚ
::
	$CİyAÎTo
(
Bufã»dT¿nsfÜm©iÚ
 &
rg‘
, cÚ¡ 
¡d
::
¡ršg
 &
chªÃl
) const

577 ià(
	`A‰achedT¿nsfÜm©iÚ
())

578 
	`A‰achedT¿nsfÜm©iÚ
()->
	`CİyAÎTo
(
rg‘
, 
chªÃl
);

581 
	`as£¹
(!
	`Numb”OfMes§geS”›s
());

582 
	`CİyMes§gesTo
(
rg‘
, 
UINT_MAX
, 
chªÃl
)) {}

584 
	}
}

586 
	gBufã»dT¿nsfÜm©iÚ
::
	$S‘R‘r›v®ChªÃl
(cÚ¡ 
¡d
::
¡ršg
 &
chªÃl
)

588 ià(
	`A‰achedT¿nsfÜm©iÚ
())

589 
	`A‰achedT¿nsfÜm©iÚ
()->
	`S‘R‘r›v®ChªÃl
(
chªÃl
);

590 
	}
}

592 
size_t
 
	gBufã»dT¿nsfÜm©iÚ
::
	$ChªÃlPutWÜd16
(cÚ¡ 
¡d
::
¡ršg
 &
chªÃl
, 
wÜd16
 
v®ue
, 
By‹Ord”
 
Üd”
, 
boŞ
 
blockšg
)

594 
	`PutWÜd
(
çl£
, 
Üd”
, 
m_buf
, 
v®ue
);

595  
	`ChªÃlPut
(
chªÃl
, 
m_buf
, 2, 
blockšg
);

596 
	}
}

598 
size_t
 
	gBufã»dT¿nsfÜm©iÚ
::
	$ChªÃlPutWÜd32
(cÚ¡ 
¡d
::
¡ršg
 &
chªÃl
, 
wÜd32
 
v®ue
, 
By‹Ord”
 
Üd”
, 
boŞ
 
blockšg
)

600 
	`PutWÜd
(
çl£
, 
Üd”
, 
m_buf
, 
v®ue
);

601  
	`ChªÃlPut
(
chªÃl
, 
m_buf
, 4, 
blockšg
);

602 
	}
}

604 
size_t
 
	gBufã»dT¿nsfÜm©iÚ
::
	$PutWÜd16
(
wÜd16
 
v®ue
, 
By‹Ord”
 
Üd”
, 
boŞ
 
blockšg
)

606  
	`ChªÃlPutWÜd16
(
DEFAULT_CHANNEL
, 
v®ue
, 
Üd”
, 
blockšg
);

607 
	}
}

609 
size_t
 
	gBufã»dT¿nsfÜm©iÚ
::
	$PutWÜd32
(
wÜd32
 
v®ue
, 
By‹Ord”
 
Üd”
, 
boŞ
 
blockšg
)

611  
	`ChªÃlPutWÜd32
(
DEFAULT_CHANNEL
, 
v®ue
, 
Üd”
, 
blockšg
);

612 
	}
}

614 
size_t
 
	gBufã»dT¿nsfÜm©iÚ
::
	$P“kWÜd16
(
wÜd16
 &
v®ue
, 
By‹Ord”
 
Üd”
) const

616 
by‹
 
buf
[2] = {0, 0};

617 
size_t
 
Ën
 = 
	`P“k
(
buf
, 2);

619 ià(
Üd”
)

620 
v®ue
 = (
buf
[0] << 8) | buf[1];

622 
v®ue
 = (
buf
[1] << 8) | buf[0];

624  
Ën
;

625 
	}
}

627 
size_t
 
	gBufã»dT¿nsfÜm©iÚ
::
	$P“kWÜd32
(
wÜd32
 &
v®ue
, 
By‹Ord”
 
Üd”
) const

629 
by‹
 
buf
[4] = {0, 0, 0, 0};

630 
size_t
 
Ën
 = 
	`P“k
(
buf
, 4);

632 ià(
Üd”
)

633 
v®ue
 = (
buf
[0] << 24) | (buf[1] << 16) | (buf[2] << 8) | buf [3];

635 
v®ue
 = (
buf
[3] << 24) | (buf[2] << 16) | (buf[1] << 8) | buf [0];

637  
Ën
;

638 
	}
}

640 
size_t
 
	gBufã»dT¿nsfÜm©iÚ
::
	$G‘WÜd16
(
wÜd16
 &
v®ue
, 
By‹Ord”
 
Üd”
)

642  (
size_t
)
	`Sk
(
	`P“kWÜd16
(
v®ue
, 
Üd”
));

643 
	}
}

645 
size_t
 
	gBufã»dT¿nsfÜm©iÚ
::
	$G‘WÜd32
(
wÜd32
 &
v®ue
, 
By‹Ord”
 
Üd”
)

647  (
size_t
)
	`Sk
(
	`P“kWÜd32
(
v®ue
, 
Üd”
));

648 
	}
}

650 
	gBufã»dT¿nsfÜm©iÚ
::
	$A‰ach
(
Bufã»dT¿nsfÜm©iÚ
 *
ÃwOut
)

652 ià(
	`A‰achedT¿nsfÜm©iÚ
(è&& A‰achedT¿nsfÜm©iÚ()->
	`A‰achabË
())

653 
	`A‰achedT¿nsfÜm©iÚ
()->
	`A‰ach
(
ÃwOut
);

655 
	`D‘ach
(
ÃwOut
);

656 
	}
}

658 
	gG’”©abËCry±oM©”Ÿl
::
	$G’”©eRªdomW™hKeySize
(
RªdomNumb”G’”©Ü
 &
ºg
, 
keySize
)

660 
	`G’”©eRªdom
(
ºg
, 
	`MakeP¬am‘”s
("KeySize", ()
keySize
));

661 
	}
}

663 
şass
 
	gPK_DeçuÉEnüy±iÚF‹r
 : 
public
 
UnæushabË
<
F‹r
>

665 
public
:

666 
PK_DeçuÉEnüy±iÚF‹r
(
RªdomNumb”G’”©Ü
 &
ºg
, cÚ¡ 
PK_Enüy±Ü
 &
’üy±Ü
, 
Bufã»dT¿nsfÜm©iÚ
 *
©chm’t
, cÚ¡ 
NameV®uePaœs
 &
·¿m‘”s
)

667 : 
m_ºg
(
ºg
), 
m_’üy±Ü
(
’üy±Ü
), 
m_·¿m‘”s
(
·¿m‘”s
)

669 
D‘ach
(
©chm’t
);

672 
size_t
 
Put2
(cÚ¡ 
by‹
 *
šSŒšg
, size_ˆ
Ëngth
, 
mes§geEnd
, 
boŞ
 
blockšg
)

674 
	gFILTER_BEGIN
;

675 
	gm_¶aš‹xtQueue
.
Put
(
šSŒšg
, 
Ëngth
);

677 ià(
	gmes§geEnd
)

680 
size_t
 
	g¶aš‹xtL’gth
;

681 ià(!
SaãCÚv”t
(
m_¶aš‹xtQueue
.
Cu¼’tSize
(), 
¶aš‹xtL’gth
))

682 
throw
 
Inv®idArgum’t
("PK_DefaultEncryptionFilter:…laintextoo†ong");

683 
size_t
 
	gch”‹xtL’gth
 = 
m_’üy±Ü
.
Ch”‹xtL’gth
(
¶aš‹xtL’gth
);

685 
SecBy‹Block
 
¶aš‹xt
(
¶aš‹xtL’gth
);

686 
	gm_¶aš‹xtQueue
.
G‘
(
¶aš‹xt
, 
¶aš‹xtL’gth
);

687 
	gm_ch”‹xt
.
»size
(
ch”‹xtL’gth
);

688 
	gm_’üy±Ü
.
Enüy±
(
m_ºg
, 
¶aš‹xt
, 
¶aš‹xtL’gth
, 
m_ch”‹xt
, 
m_·¿m‘”s
);

691 
FILTER_OUTPUT
(1, 
m_ch”‹xt
, m_ch”‹xt.
size
(), 
mes§geEnd
);

693 
	gFILTER_END_NO_MESSAGE_END
;

696 
	gRªdomNumb”G’”©Ü
 &
	gm_ºg
;

697 cÚ¡ 
	gPK_Enüy±Ü
 &
	gm_’üy±Ü
;

698 cÚ¡ 
	gNameV®uePaœs
 &
	gm_·¿m‘”s
;

699 
By‹Queue
 
	gm_¶aš‹xtQueue
;

700 
SecBy‹Block
 
	gm_ch”‹xt
;

703 
Bufã»dT¿nsfÜm©iÚ
 * 
	gPK_Enüy±Ü
::
	$C»©eEnüy±iÚF‹r
(
RªdomNumb”G’”©Ü
 &
ºg
, 
Bufã»dT¿nsfÜm©iÚ
 *
©chm’t
, cÚ¡ 
NameV®uePaœs
 &
·¿m‘”s
) const

705  
Ãw
 
	`PK_DeçuÉEnüy±iÚF‹r
(
ºg
, *
this
, 
©chm’t
, 
·¿m‘”s
);

706 
	}
}

708 
şass
 
	gPK_DeçuÉDeüy±iÚF‹r
 : 
public
 
UnæushabË
<
F‹r
>

710 
public
:

711 
PK_DeçuÉDeüy±iÚF‹r
(
RªdomNumb”G’”©Ü
 &
ºg
, cÚ¡ 
PK_Deüy±Ü
 &
deüy±Ü
, 
Bufã»dT¿nsfÜm©iÚ
 *
©chm’t
, cÚ¡ 
NameV®uePaœs
 &
·¿m‘”s
)

712 : 
m_ºg
(
ºg
), 
m_deüy±Ü
(
deüy±Ü
), 
m_·¿m‘”s
(
·¿m‘”s
)

714 
D‘ach
(
©chm’t
);

717 
size_t
 
Put2
(cÚ¡ 
by‹
 *
šSŒšg
, size_ˆ
Ëngth
, 
mes§geEnd
, 
boŞ
 
blockšg
)

719 
	gFILTER_BEGIN
;

720 
	gm_ch”‹xtQueue
.
Put
(
šSŒšg
, 
Ëngth
);

722 ià(
	gmes§geEnd
)

725 
size_t
 
	gch”‹xtL’gth
;

726 ià(!
SaãCÚv”t
(
m_ch”‹xtQueue
.
Cu¼’tSize
(), 
ch”‹xtL’gth
))

727 
throw
 
Inv®idArgum’t
("PK_DefaultDecryptionFilter: ciphertextoo†ong");

728 
size_t
 
	gmaxPÏš‹xtL’gth
 = 
m_deüy±Ü
.
MaxPÏš‹xtL’gth
(
ch”‹xtL’gth
);

730 
SecBy‹Block
 
ch”‹xt
(
ch”‹xtL’gth
);

731 
	gm_ch”‹xtQueue
.
G‘
(
ch”‹xt
, 
ch”‹xtL’gth
);

732 
	gm_¶aš‹xt
.
»size
(
maxPÏš‹xtL’gth
);

733 
	gm_»suÉ
 = 
m_deüy±Ü
.
Deüy±
(
m_ºg
, 
ch”‹xt
, 
ch”‹xtL’gth
, 
m_¶aš‹xt
, 
m_·¿m‘”s
);

734 ià(!
	gm_»suÉ
.
	gisV®idCodšg
)

735 
throw
 
Inv®idCh”‹xt
(
m_deüy±Ü
.
AlgÜ™hmName
() + ": invalid ciphertext");

738 
FILTER_OUTPUT
(1, 
m_¶aš‹xt
, 
m_»suÉ
.
mes§geL’gth
, 
mes§geEnd
);

740 
	gFILTER_END_NO_MESSAGE_END
;

743 
	gRªdomNumb”G’”©Ü
 &
	gm_ºg
;

744 cÚ¡ 
	gPK_Deüy±Ü
 &
	gm_deüy±Ü
;

745 cÚ¡ 
	gNameV®uePaœs
 &
	gm_·¿m‘”s
;

746 
By‹Queue
 
	gm_ch”‹xtQueue
;

747 
SecBy‹Block
 
	gm_¶aš‹xt
;

748 
DecodšgResuÉ
 
	gm_»suÉ
;

751 
Bufã»dT¿nsfÜm©iÚ
 * 
	gPK_Deüy±Ü
::
	$C»©eDeüy±iÚF‹r
(
RªdomNumb”G’”©Ü
 &
ºg
, 
Bufã»dT¿nsfÜm©iÚ
 *
©chm’t
, cÚ¡ 
NameV®uePaœs
 &
·¿m‘”s
) const

753  
Ãw
 
	`PK_DeçuÉDeüy±iÚF‹r
(
ºg
, *
this
, 
©chm’t
, 
·¿m‘”s
);

754 
	}
}

756 
size_t
 
	gPK_SigÃr
::
	$Sign
(
RªdomNumb”G’”©Ü
 &
ºg
, 
PK_Mes§geAccumuÏtÜ
 *
mes§geAccumuÏtÜ
, 
by‹
 *
sigÇtu»
) const

758 
¡d
::
auto_±r
<
PK_Mes§geAccumuÏtÜ
> 
	`m
(
mes§geAccumuÏtÜ
);

759  
	`SignAndRe¡¬t
(
ºg
, *
m
, 
sigÇtu»
, 
çl£
);

760 
	}
}

762 
size_t
 
	gPK_SigÃr
::
	$SignMes§ge
(
RªdomNumb”G’”©Ü
 &
ºg
, cÚ¡ 
by‹
 *
mes§ge
, 
size_t
 
mes§geL’
, by‹ *
sigÇtu»
) const

764 
¡d
::
auto_±r
<
PK_Mes§geAccumuÏtÜ
> 
	`m
(
	`NewSigÇtu»AccumuÏtÜ
(
ºg
));

765 
m
->
	`Upd©e
(
mes§ge
, 
mes§geL’
);

766  
	`SignAndRe¡¬t
(
ºg
, *
m
, 
sigÇtu»
, 
çl£
);

767 
	}
}

769 
size_t
 
	gPK_SigÃr
::
	$SignMes§geW™hRecov”y
(
RªdomNumb”G’”©Ü
 &
ºg
, cÚ¡ 
by‹
 *
»cov”abËMes§ge
, 
size_t
 
»cov”abËMes§geL’gth
,

770 cÚ¡ 
by‹
 *
nÚ»cov”abËMes§ge
, 
size_t
 
nÚ»cov”abËMes§geL’gth
, by‹ *
sigÇtu»
) const

772 
¡d
::
auto_±r
<
PK_Mes§geAccumuÏtÜ
> 
	`m
(
	`NewSigÇtu»AccumuÏtÜ
(
ºg
));

773 
	`IÅutRecov”abËMes§ge
(*
m
, 
»cov”abËMes§ge
, 
»cov”abËMes§geL’gth
);

774 
m
->
	`Upd©e
(
nÚ»cov”abËMes§ge
, 
nÚ»cov”abËMes§geL’gth
);

775  
	`SignAndRe¡¬t
(
ºg
, *
m
, 
sigÇtu»
, 
çl£
);

776 
	}
}

778 
boŞ
 
	gPK_V”if›r
::
	$V”ify
(
PK_Mes§geAccumuÏtÜ
 *
mes§geAccumuÏtÜ
) const

780 
¡d
::
auto_±r
<
PK_Mes§geAccumuÏtÜ
> 
	`m
(
mes§geAccumuÏtÜ
);

781  
	`V”ifyAndRe¡¬t
(*
m
);

782 
	}
}

784 
boŞ
 
	gPK_V”if›r
::
	$V”ifyMes§ge
(cÚ¡ 
by‹
 *
mes§ge
, 
size_t
 
mes§geL’
, cÚ¡ by‹ *
sigÇtu»
, size_ˆ
sigÇtu»L’gth
) const

786 
¡d
::
auto_±r
<
PK_Mes§geAccumuÏtÜ
> 
	`m
(
	`NewV”ifiÿtiÚAccumuÏtÜ
());

787 
	`IÅutSigÇtu»
(*
m
, 
sigÇtu»
, 
sigÇtu»L’gth
);

788 
m
->
	`Upd©e
(
mes§ge
, 
mes§geL’
);

789  
	`V”ifyAndRe¡¬t
(*
m
);

790 
	}
}

792 
DecodšgResuÉ
 
	gPK_V”if›r
::
	$Recov”
(
by‹
 *
»cov”edMes§ge
, 
PK_Mes§geAccumuÏtÜ
 *
mes§geAccumuÏtÜ
) const

794 
¡d
::
auto_±r
<
PK_Mes§geAccumuÏtÜ
> 
	`m
(
mes§geAccumuÏtÜ
);

795  
	`Recov”AndRe¡¬t
(
»cov”edMes§ge
, *
m
);

796 
	}
}

798 
DecodšgResuÉ
 
	gPK_V”if›r
::
	$Recov”Mes§ge
(
by‹
 *
»cov”edMes§ge
,

799 cÚ¡ 
by‹
 *
nÚ»cov”abËMes§ge
, 
size_t
 
nÚ»cov”abËMes§geL’gth
,

800 cÚ¡ 
by‹
 *
sigÇtu»
, 
size_t
 
sigÇtu»L’gth
) const

802 
¡d
::
auto_±r
<
PK_Mes§geAccumuÏtÜ
> 
	`m
(
	`NewV”ifiÿtiÚAccumuÏtÜ
());

803 
	`IÅutSigÇtu»
(*
m
, 
sigÇtu»
, 
sigÇtu»L’gth
);

804 
m
->
	`Upd©e
(
nÚ»cov”abËMes§ge
, 
nÚ»cov”abËMes§geL’gth
);

805  
	`Recov”AndRe¡¬t
(
»cov”edMes§ge
, *
m
);

806 
	}
}

808 
	gSim¶eKeyAg»em’tDomaš
::
	$G’”©eKeyPaœ
(
RªdomNumb”G’”©Ü
 &
ºg
, 
by‹
 *
´iv©eKey
, by‹ *
publicKey
) const

810 
	`G’”©ePriv©eKey
(
ºg
, 
´iv©eKey
);

811 
	`G’”©ePublicKey
(
ºg
, 
´iv©eKey
, 
publicKey
);

812 
	}
}

814 
	gAuth’tiÿ‹dKeyAg»em’tDomaš
::
	$G’”©eSticKeyPaœ
(
RªdomNumb”G’”©Ü
 &
ºg
, 
by‹
 *
´iv©eKey
, by‹ *
publicKey
) const

816 
	`G’”©eSticPriv©eKey
(
ºg
, 
´iv©eKey
);

817 
	`G’”©eSticPublicKey
(
ºg
, 
´iv©eKey
, 
publicKey
);

818 
	}
}

820 
	gAuth’tiÿ‹dKeyAg»em’tDomaš
::
	$G’”©eEphem”®KeyPaœ
(
RªdomNumb”G’”©Ü
 &
ºg
, 
by‹
 *
´iv©eKey
, by‹ *
publicKey
) const

822 
	`G’”©eEphem”®Priv©eKey
(
ºg
, 
´iv©eKey
);

823 
	`G’”©eEphem”®PublicKey
(
ºg
, 
´iv©eKey
, 
publicKey
);

824 
	}
}

826 
	gNAMESPACE_END


	@cryptlib.h

79 #iâdeà
CRYPTOPP_CRYPTLIB_H


80 
	#CRYPTOPP_CRYPTLIB_H


	)

82 
	~"cÚfig.h
"

83 
	~"¡dıp.h
"

85 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

88 
şass
 
IÁeg”
;

89 
şass
 
RªdomNumb”G’”©Ü
;

90 
şass
 
Bufã»dT¿nsfÜm©iÚ
;

93 
	eCh”Dœ
 {
ENCRYPTION
, 
DECRYPTION
};

96 cÚ¡ 
INFINITE_TIME
 = 
ULONG_MAX
;

99 
‹m¶©e
 <
ty³Çme
 
ENUM_TYPE
, 
VALUE
>

100 
	sEnumToTy³


102 
ENUM_TYPE
 
	`ToEnum
(è{ (ENUM_TYPE)
VALUE
;}

105 
	eBy‹Ord”
 {
LITTLE_ENDIAN_ORDER
 = 0, 
BIG_ENDIAN_ORDER
 = 1};

106 
EnumToTy³
<
	tBy‹Ord”
, 
	tLITTLE_ENDIAN_ORDER
> 
	tL™eEndŸn
;

107 
EnumToTy³
<
	tBy‹Ord”
, 
	tBIG_ENDIAN_ORDER
> 
	tBigEndŸn
;

110 şas 
	cCRYPTOPP_DLL
 
Exû±iÚ
 : 
public
 
¡d
::
exû±iÚ


112 
public
:

114 
	eE¼ÜTy³
 {

116 
NOT_IMPLEMENTED
,

118 
INVALID_ARGUMENT
,

120 
CANNOT_FLUSH
,

122 
DATA_INTEGRITY_CHECK_FAILED
,

124 
INVALID_DATA_FORMAT
,

126 
IO_ERROR
,

128 
OTHER_ERROR


131 
ex¶ic™
 
	$Exû±iÚ
(
E¼ÜTy³
 
”rÜTy³
, cÚ¡ 
¡d
::
¡ršg
 &
s
è: 
	`m_”rÜTy³
Ó¼ÜTy³), 
	$m_wh©
(
s
è{
	}
}

132 
	gvœtu®
 ~
	$Exû±iÚ
(è
	$throw
(è{
	}
}

133 cÚ¡ *
	$wh©
(ècÚ¡ 
	$throw
(è{ (
m_wh©
.
	`c_¡r
());
	}
}

134 cÚ¡ 
	g¡d
::
¡ršg
 &
	$G‘Wh©
(ècÚ¡ { 
m_wh©
;
	}
}

135 
	$S‘Wh©
(cÚ¡ 
¡d
::
¡ršg
 &
s
è{
m_wh©
 = s;
	}
}

136 
E¼ÜTy³
 
	$G‘E¼ÜTy³
(ècÚ¡ { 
m_”rÜTy³
;
	}
}

137 
	$S‘E¼ÜTy³
(
E¼ÜTy³
 
”rÜTy³
è{
m_”rÜTy³
 =ƒ¼ÜTy³;
	}
}

139 
	g´iv©e
:

140 
E¼ÜTy³
 
m_”rÜTy³
;

141 
	g¡d
::
¡ršg
 
m_wh©
;

145 şas 
	cCRYPTOPP_DLL
 
	mInv®idArgum’t
 : 
public
 
Exû±iÚ


147 
public
:

148 
ex¶ic™
 
	$Inv®idArgum’t
(cÚ¡ 
¡d
::
¡ršg
 &
s
è: 
	$Exû±iÚ
(
INVALID_ARGUMENT
, 
s
) {}

149 
	}
};

152 şas 
	cCRYPTOPP_DLL
 
	mInv®idD©aFÜm©
 : 
public
 
Exû±iÚ


154 
public
:

155 
ex¶ic™
 
	$Inv®idD©aFÜm©
(cÚ¡ 
¡d
::
¡ršg
 &
s
è: 
	$Exû±iÚ
(
INVALID_DATA_FORMAT
, 
s
) {}

156 
	}
};

159 şas 
	cCRYPTOPP_DLL
 
	mInv®idCh”‹xt
 : 
public
 
Inv®idD©aFÜm©


161 
public
:

162 
ex¶ic™
 
	$Inv®idCh”‹xt
(cÚ¡ 
¡d
::
¡ršg
 &
s
è: 
	$Inv®idD©aFÜm©
(
s
) {}

163 
	}
};

166 şas 
	cCRYPTOPP_DLL
 
	mNÙIm¶em’‹d
 : 
public
 
Exû±iÚ


168 
public
:

169 
ex¶ic™
 
	$NÙIm¶em’‹d
(cÚ¡ 
¡d
::
¡ršg
 &
s
è: 
	$Exû±iÚ
(
NOT_IMPLEMENTED
, 
s
) {}

170 
	}
};

173 şas 
	cCRYPTOPP_DLL
 
	mCªnÙFlush
 : 
public
 
Exû±iÚ


175 
public
:

176 
ex¶ic™
 
	$CªnÙFlush
(cÚ¡ 
¡d
::
¡ršg
 &
s
è: 
	$Exû±iÚ
(
CANNOT_FLUSH
, 
s
) {}

177 
	}
};

180 şas 
	cCRYPTOPP_DLL
 
	mOS_E¼Ü
 : 
public
 
Exû±iÚ


182 
public
:

183 
	$OS_E¼Ü
(
E¼ÜTy³
 
”rÜTy³
, cÚ¡ 
¡d
::
¡ršg
 &
s
, cÚ¡ std::¡ršg& 
İ”©iÚ
, 
”rÜCode
)

184 : 
	`Exû±iÚ
(
”rÜTy³
, 
s
), 
	`m_İ”©iÚ
(
İ”©iÚ
), 
	$m_”rÜCode
(
”rÜCode
) {}

185 ~
	$OS_E¼Ü
(è
	$throw
(è{
	}
}

188 cÚ¡ 
	g¡d
::
¡ršg
 & 
	$G‘O³¿tiÚ
(ècÚ¡ { 
m_İ”©iÚ
;
	}
}

190 
	$G‘E¼ÜCode
(ècÚ¡ { 
m_”rÜCode
;
	}
}

192 
	g´Ùeùed
:

193 
¡d
::
¡ršg
 
m_İ”©iÚ
;

194 
	gm_”rÜCode
;

198 
CRYPTOPP_DLL
 
	gDecodšgResuÉ


200 
ex¶ic™
 
DecodšgResuÉ
(è: 
isV®idCodšg
(
çl£
), 
mes§geL’gth
(0) {}

201 
ex¶ic™
 
DecodšgResuÉ
(
size_t
 
Ën
è: 
isV®idCodšg
(
Œue
), 
mes§geL’gth
(len) {}

203 
boŞ
 
	gİ”©Ü
==(cÚ¡ 
DecodšgResuÉ
 &
rhs
ècÚ¡ { 
isV®idCodšg
 =ğrhs.isV®idCodšg && 
mes§geL’gth
 ==„hs.messageLength;}

204 
boŞ
 
	gİ”©Ü
!=(cÚ¡ 
DecodšgResuÉ
 &
rhs
ècÚ¡ { !
İ”©Ü
==(rhs);}

206 
boŞ
 
	gisV®idCodšg
;

207 
size_t
 
	gmes§geL’gth
;

209 #ifdeà
CRYPTOPP_MAINTAIN_BACKWARDS_COMPATIBILITY


210 
İ”©Ü
 
size_t
(ècÚ¡ { 
	gisV®idCodšg
 ? 
	gmes§geL’gth
 : 0;}

225 şas 
	cCRYPTOPP_NO_VTABLE
 
	mNameV®uePaœs


227 
	mpublic
:

228 
vœtu®
 ~
	$NameV®uePaœs
() {}

231 şas 
	cCRYPTOPP_DLL
 
V®ueTy³Mism©ch
 : 
public
 
Inv®idArgum’t


233 
public
:

234 
	`V®ueTy³Mism©ch
(cÚ¡ 
¡d
::
¡ršg
 &
Çme
, cÚ¡ std::
ty³_šfo
 &
¡Üed
, cÚ¡ std::ty³_šfØ&
»Œ›všg
)

235 : 
	`Inv®idArgum’t
("NameV®uePaœs:y³ mism©ch fÜ '" + 
Çme
 + "', stÜed '" + 
¡Üed
.
	`Çme
(è+ "',ryšgØ»Œ›v'" + 
»Œ›všg
.name() + "'")

236 , 
	`m_¡Üed
(
¡Üed
), 
	`m_»Œ›všg
(
»Œ›všg
) {}

238 cÚ¡ 
¡d
::
ty³_šfo
 & 
	`G‘StÜedTy³Info
(ècÚ¡ { 
m_¡Üed
;}

239 cÚ¡ 
¡d
::
ty³_šfo
 & 
	`G‘R‘r›všgTy³Info
(ècÚ¡ { 
m_»Œ›všg
;}

241 
´iv©e
:

242 cÚ¡ 
¡d
::
ty³_šfo
 &
m_¡Üed
;

243 cÚ¡ 
¡d
::
ty³_šfo
 &
m_»Œ›všg
;

244 
	}
};

247 
	g‹m¶©e
 <
şass
 
	gT
>

248 
boŞ
 
	$G‘ThisObjeù
(
T
 &
objeù
) const

250  
	`G‘V®ue
((
¡d
::
	`¡ršg
("ThisObjeù:")+
	`ty³id
(
T
).
	`Çme
()).
	`c_¡r
(), 
objeù
);

251 
	}
}

254 
	g‹m¶©e
 <
şass
 
	gT
>

255 
boŞ
 
	$G‘ThisPoš‹r
(
T
 *&
p
) const

257  
	`G‘V®ue
((
¡d
::
	`¡ršg
("ThisPoš‹r:")+
	`ty³id
(
T
).
	`Çme
()).
	`c_¡r
(), 
p
);

258 
	}
}

261 
	g‹m¶©e
 <
şass
 
	gT
>

262 
boŞ
 
	$G‘V®ue
(cÚ¡ *
Çme
, 
T
 &
v®ue
) const

264  
	`G‘VoidV®ue
(
Çme
, 
	`ty³id
(
T
), &
v®ue
);

265 
	}
}

268 
	g‹m¶©e
 <
şass
 
	gT
>

269 
T
 
	$G‘V®ueW™hDeçuÉ
(cÚ¡ *
Çme
, 
T
 
deçuÉV®ue
) const

271 
	`G‘V®ue
(
Çme
, 
deçuÉV®ue
);

272  
deçuÉV®ue
;

273 
	}
}

276 
CRYPTOPP_DLL
 
	g¡d
::
¡ršg
 
	$G‘V®ueNames
() const

277 {
¡d
::
¡ršg
 
»suÉ
; 
	`G‘V®ue
("V®ueNames",„esuÉ); „esuÉ;
	}
}

282 
CRYPTOPP_DLL
 
boŞ
 
	$G‘IÁV®ue
(cÚ¡ *
Çme
, &
v®ue
) const

283 { 
	`G‘V®ue
(
Çme
, 
v®ue
);
	}
}

286 
CRYPTOPP_DLL
 
	$G‘IÁV®ueW™hDeçuÉ
(cÚ¡ *
Çme
, 
deçuÉV®ue
) const

287 { 
	`G‘V®ueW™hDeçuÉ
(
Çme
, 
deçuÉV®ue
);
	}
}

290 
CRYPTOPP_DLL
 
CRYPTOPP_API
 
	$ThrowIfTy³Mism©ch
(cÚ¡ *
Çme
, cÚ¡ 
¡d
::
ty³_šfo
 &
¡Üed
, cÚ¡ std::ty³_šfØ&
»Œ›všg
)

291 {ià(
¡Üed
 !ğ
»Œ›všg
è
throw
 
	`V®ueTy³Mism©ch
(
Çme
, stÜed,„‘r›všg);
	}
}

293 
	g‹m¶©e
 <
şass
 
	gT
>

294 
	$G‘RequœedP¬am‘”
(cÚ¡ *
şassName
, cÚ¡ *
Çme
, 
T
 &
v®ue
) const

296 ià(!
	`G‘V®ue
(
Çme
, 
v®ue
))

297 
throw
 
	`Inv®idArgum’t
(
¡d
::
	`¡ršg
(
şassName
è+ ": missšg„equœed…¬am‘” '" + 
Çme
 + "'");

298 
	}
}

300 
CRYPTOPP_DLL
 
	$G‘RequœedIÁP¬am‘”
(cÚ¡ *
şassName
, cÚ¡ *
Çme
, &
v®ue
) const

302 ià(!
	`G‘IÁV®ue
(
Çme
, 
v®ue
))

303 
throw
 
	`Inv®idArgum’t
(
¡d
::
	`¡ršg
(
şassName
è+ ": missšg„equœed…¬am‘” '" + 
Çme
 + "'");

304 
	}
}

307 
CRYPTOPP_DLL
 
vœtu®
 
boŞ
 
	$G‘VoidV®ue
(cÚ¡ *
Çme
, cÚ¡ 
¡d
::
ty³_šfo
 &
v®ueTy³
, *
pV®ue
) const =0;

308 
	}
};

316 
	$DOCUMENTED_NAMESPACE_BEGIN
(
Name
)

318 
DOCUMENTED_NAMESPACE_END


321 
CRYPTOPP_DLL
 cÚ¡ 
NameV®uePaœs
 &
g_nuÎNameV®uePaœs
;

326 şas 
	cCRYPTOPP_DLL
 
CRYPTOPP_NO_VTABLE
 
ClÚabË


328 
public
:

329 
vœtu®
 ~
	$ClÚabË
() {}

331 
vœtu®
 
ClÚabË
* 
	$ClÚe
(ècÚ¡ {
throw
 
	`NÙIm¶em’‹d
("ClÚe(èi nÙ im¶em’‹d y‘.");
	}
}

336 şas 
	cCRYPTOPP_DLL
 
CRYPTOPP_NO_VTABLE
 
	mAlgÜ™hm
 : 
public
 
ClÚabË


338 
public
:

341 
AlgÜ™hm
(
boŞ
 
checkS–fTe¡Stus
 = 
Œue
);

343 
vœtu®
 
	m¡d
::
¡ršg
 
	$AlgÜ™hmName
() const { "unknown";}

344 
	}
};

347 şas 
	cCRYPTOPP_DLL
 
CRYPTOPP_NO_VTABLE
 
	mSim¶eKeyšgIÁ”çû


349 
	mpublic
:

350 
vœtu®
 ~
	$Sim¶eKeyšgIÁ”çû
() {}

353 
vœtu®
 
size_t
 
	$MšKeyL’gth
() const =0;

355 
vœtu®
 
size_t
 
	$MaxKeyL’gth
() const =0;

357 
vœtu®
 
size_t
 
	$DeçuÉKeyL’gth
() const =0;

360 
vœtu®
 
size_t
 
	$G‘V®idKeyL’gth
(
size_t
 
n
) const =0;

363 
vœtu®
 
boŞ
 
	$IsV®idKeyL’gth
(
size_t
 
n
) const

364 { 
n
 =ğ
	`G‘V®idKeyL’gth
Ò);
	}
}

368 
vœtu®
 
S‘Key
(cÚ¡ 
by‹
 *
key
, 
size_t
 
Ëngth
, cÚ¡ 
NameV®uePaœs
 &
·¿ms
 = 
g_nuÎNameV®uePaœs
);

371 
S‘KeyW™hRounds
(cÚ¡ 
by‹
 *
key
, 
size_t
 
Ëngth
, 
rounds
);

374 
S‘KeyW™hIV
(cÚ¡ 
by‹
 *
key
, 
size_t
 
Ëngth
, cÚ¡ by‹ *
iv
, size_ˆ
ivL’gth
);

377 
	$S‘KeyW™hIV
(cÚ¡ 
by‹
 *
key
, 
size_t
 
Ëngth
, cÚ¡ by‹ *
iv
)

378 {
	`S‘KeyW™hIV
(
key
, 
Ëngth
, 
iv
, 
	`IVSize
());
	}
}

380 
	eIV_Requœem’t
 {
	gUNIQUE_IV
 = 0, 
	gRANDOM_IV
, 
	gUNPREDICTABLE_RANDOM_IV
, 
	gINTERNALLY_GENERATED_IV
, 
	gNOT_RESYNCHRONIZABLE
};

382 
vœtu®
 
IV_Requœem’t
 
	$IVRequœem’t
() const =0;

386 
boŞ
 
	$IsResynchrÚizabË
(ècÚ¡ { 
	`IVRequœem’t
(è< 
NOT_RESYNCHRONIZABLE
;
	}
}

388 
boŞ
 
	$CªU£RªdomIVs
(ècÚ¡ { 
	`IVRequœem’t
(è<ğ
UNPREDICTABLE_RANDOM_IV
;
	}
}

390 
boŞ
 
	$CªU£P»diùabËIVs
(ècÚ¡ { 
	`IVRequœem’t
(è<ğ
RANDOM_IV
;
	}
}

392 
boŞ
 
	$CªU£SŒuùu»dIVs
(ècÚ¡ { 
	`IVRequœem’t
(è<ğ
UNIQUE_IV
;
	}
}

394 
vœtu®
 
	$IVSize
(ècÚ¡ {
throw
 
	`NÙIm¶em’‹d
(
	`G‘AlgÜ™hm
().
	`AlgÜ™hmName
(è+ ":hi objeù dÛ¢'ˆsuµÜˆ»synchrÚiz©iÚ");
	}
}

396 
	$DeçuÉIVL’gth
(ècÚ¡ { 
	`IVSize
();
	}
}

398 
vœtu®
 
	$MšIVL’gth
(ècÚ¡ { 
	`IVSize
();
	}
}

400 
vœtu®
 
	$MaxIVL’gth
(ècÚ¡ { 
	`IVSize
();
	}
}

402 
vœtu®
 
ResynchrÚize
(cÚ¡ 
by‹
 *
iv
, 
ivL’gth
=-1è{
throw
 
NÙIm¶em’‹d
(
G‘AlgÜ™hm
().
AlgÜ™hmName
() + ":his object doesn't support„esynchronization");}

407 
vœtu®
 
G‘NextIV
(
RªdomNumb”G’”©Ü
 &
ºg
, 
by‹
 *
IV
);

409 
	g´Ùeùed
:

410 
vœtu®
 cÚ¡ 
AlgÜ™hm
 & 
	$G‘AlgÜ™hm
() const =0;

411 
vœtu®
 
	`UncheckedS‘Key
(cÚ¡ 
by‹
 *
key
, 
Ëngth
, cÚ¡ 
NameV®uePaœs
 &
·¿ms
) =0;

413 
	`ThrowIfInv®idKeyL’gth
(
size_t
 
Ëngth
);

414 
	`ThrowIfResynchrÚizabË
();

415 
	`ThrowIfInv®idIV
(cÚ¡ 
by‹
 *
iv
);

416 
size_t
 
	`ThrowIfInv®idIVL’gth
(
size
);

417 cÚ¡ 
by‹
 * 
	`G‘IVAndThrowIfInv®id
(cÚ¡ 
NameV®uePaœs
 &
·¿ms
, 
size_t
 &
size
);

418 
šlše
 
	$As£¹V®idKeyL’gth
(
size_t
 
Ëngth
) const

419 {
	`as£¹
(
	`IsV®idKeyL’gth
(
Ëngth
));
	}
}

429 şas 
	cCRYPTOPP_DLL
 
CRYPTOPP_NO_VTABLE
 
	mBlockT¿nsfÜm©iÚ
 : 
public
 
AlgÜ™hm


431 
public
:

433 
vœtu®
 
	$ProûssAndXÜBlock
(cÚ¡ 
by‹
 *
šBlock
, cÚ¡ by‹ *
xÜBlock
, by‹ *
outBlock
) const =0;

437 
	$ProûssBlock
(cÚ¡ 
by‹
 *
šBlock
, by‹ *
outBlock
) const

438 {
	`ProûssAndXÜBlock
(
šBlock
, 
NULL
, 
outBlock
);}

441 
	$ProûssBlock
(
by‹
 *
šoutBlock
) const

442 {
	`ProûssAndXÜBlock
(
šoutBlock
, 
NULL
, inoutBlock);
	}
}

445 
vœtu®
 
	$BlockSize
() const =0;

448 
vœtu®
 
	$O±im®D©aAlignm’t
() const;

451 
vœtu®
 
boŞ
 
	$IsP”mutiÚ
(ècÚ¡ { 
Œue
;
	}
}

454 
vœtu®
 
boŞ
 
	$IsFÜw¬dT¿nsfÜm©iÚ
() const =0;

457 
vœtu®
 
	$O±im®Numb”OfP¬®ËlBlocks
(ècÚ¡ { 1;
	}
}

459 ’um {
	gBT_InBlockIsCouÁ”
=1, 
	gBT_DÚtInüem’tInOutPoš‹rs
=2, 
	gBT_XÜIÅut
=4, 
	gBT_Rev”£DœeùiÚ
=8, 
	gBT_AÎowP¬®Ël
=16} 
	gFÏgsFÜAdvªûdProûssBlocks
;

463 
vœtu®
 
size_t
 
	$AdvªûdProûssBlocks
(cÚ¡ 
by‹
 *
šBlocks
, cÚ¡ by‹ *
xÜBlocks
, by‹ *
outBlocks
, 
size_t
 
Ëngth
, 
wÜd32
 
æags
) const;

465 
šlše
 
Ch”Dœ
 
	$G‘Ch”DœeùiÚ
(ècÚ¡ { 
	`IsFÜw¬dT¿nsfÜm©iÚ
(è? 
ENCRYPTION
 : 
DECRYPTION
;
	}
}

470 şas 
	cCRYPTOPP_DLL
 
CRYPTOPP_NO_VTABLE
 
	mSŒ—mT¿nsfÜm©iÚ
 : 
public
 
AlgÜ™hm


472 
public
:

474 
SŒ—mT¿nsfÜm©iÚ
& 
	$Ref
(è{ *
this
;}

477 
vœtu®
 
	$Mªd©ÜyBlockSize
(ècÚ¡ { 1;
	}
}

481 
vœtu®
 
	$O±im®BlockSize
(ècÚ¡ { 
	`Mªd©ÜyBlockSize
();
	}
}

483 
vœtu®
 
	$G‘O±im®BlockSizeU£d
(ècÚ¡ { 0;
	}
}

486 
vœtu®
 
	$O±im®D©aAlignm’t
() const;

490 
vœtu®
 
	`ProûssD©a
(
by‹
 *
outSŒšg
, cÚ¡ by‹ *
šSŒšg
, 
size_t
 
Ëngth
) =0;

494 
vœtu®
 
	`ProûssLa¡Block
(
by‹
 *
outSŒšg
, cÚ¡ by‹ *
šSŒšg
, 
size_t
 
Ëngth
);

496 
vœtu®
 
	$MšLa¡BlockSize
(ècÚ¡ { 0;
	}
}

499 
šlše
 
	$ProûssSŒšg
(
by‹
 *
šoutSŒšg
, 
size_t
 
Ëngth
)

500 {
	`ProûssD©a
(
šoutSŒšg
, inoutSŒšg, 
Ëngth
);
	}
}

502 
šlše
 
	$ProûssSŒšg
(
by‹
 *
outSŒšg
, cÚ¡ by‹ *
šSŒšg
, 
size_t
 
Ëngth
)

503 {
	`ProûssD©a
(
outSŒšg
, 
šSŒšg
, 
Ëngth
);
	}
}

505 
šlše
 
by‹
 
	$ProûssBy‹
(
by‹
 
šput
)

506 {
	`ProûssD©a
(&
šput
, &šput, 1);  iÅut;
	}
}

509 
vœtu®
 
boŞ
 
	$IsRªdomAcûss
() const =0;

511 
vœtu®
 
	$S“k
(
lwÜd
 
n
)

513 
	`as£¹
(!
	`IsRªdomAcûss
());

514 
throw
 
	`NÙIm¶em’‹d
("StreamTransformation:his object doesn't support„andom‡ccess");

515 
	}
}

518 
vœtu®
 
boŞ
 
	$IsS–fInv”tšg
() const =0;

520 
vœtu®
 
boŞ
 
	$IsFÜw¬dT¿nsfÜm©iÚ
() const =0;

521 
	}
};

531 şas 
	cCRYPTOPP_DLL
 
CRYPTOPP_NO_VTABLE
 
	mHashT¿nsfÜm©iÚ
 : 
public
 
AlgÜ™hm


533 
public
:

535 
HashT¿nsfÜm©iÚ
& 
	$Ref
(è{ *
this
;}

538 
vœtu®
 
	`Upd©e
(cÚ¡ 
by‹
 *
šput
, 
size_t
 
Ëngth
) =0;

541 
vœtu®
 
by‹
 * 
	$C»©eUpd©eS·û
(
size_t
 &
size
è{size=0;  
NULL
;
	}
}

545 
vœtu®
 
	$Fš®
(
by‹
 *
dige¡
)

546 {
	`Trunÿ‹dFš®
(
dige¡
, 
	`Dige¡Size
());
	}
}

549 
vœtu®
 
	$Re¡¬t
()

550 {
	`Trunÿ‹dFš®
(
NULL
, 0);
	}
}

553 
vœtu®
 
	$Dige¡Size
() const =0;

556 
	$TagSize
(ècÚ¡ { 
	`Dige¡Size
();
	}
}

560 
vœtu®
 
	$BlockSize
(ècÚ¡ { 0;
	}
}

563 
vœtu®
 
	$O±im®BlockSize
(ècÚ¡ { 1;
	}
}

566 
vœtu®
 
	$O±im®D©aAlignm’t
() const;

569 
vœtu®
 
	$C®cuÏ‹Dige¡
(
by‹
 *
dige¡
, cÚ¡ by‹ *
šput
, 
size_t
 
Ëngth
)

570 {
	`Upd©e
(
šput
, 
Ëngth
); 
	`Fš®
(
dige¡
);
	}
}

575 
vœtu®
 
boŞ
 
	$V”ify
(cÚ¡ 
by‹
 *
dige¡
)

576 { 
	`Trunÿ‹dV”ify
(
dige¡
, 
	`Dige¡Size
());
	}
}

579 
vœtu®
 
boŞ
 
	$V”ifyDige¡
(cÚ¡ 
by‹
 *
dige¡
, cÚ¡ by‹ *
šput
, 
size_t
 
Ëngth
)

580 {
	`Upd©e
(
šput
, 
Ëngth
);  
	`V”ify
(
dige¡
);
	}
}

583 
vœtu®
 
Trunÿ‹dFš®
(
by‹
 *
dige¡
, 
size_t
 
dige¡Size
) =0;

586 
vœtu®
 
	$C®cuÏ‹Trunÿ‹dDige¡
(
by‹
 *
dige¡
, 
size_t
 
dige¡Size
, cÚ¡ by‹ *
šput
, size_ˆ
Ëngth
)

587 {
	`Upd©e
(
šput
, 
Ëngth
); 
	`Trunÿ‹dFš®
(
dige¡
, 
dige¡Size
);
	}
}

590 
vœtu®
 
boŞ
 
Trunÿ‹dV”ify
(cÚ¡ 
by‹
 *
dige¡
, 
size_t
 
dige¡L’gth
);

593 
vœtu®
 
boŞ
 
	$V”ifyTrunÿ‹dDige¡
(cÚ¡ 
by‹
 *
dige¡
, 
size_t
 
dige¡L’gth
, cÚ¡ by‹ *
šput
, size_ˆ
Ëngth
)

594 {
	`Upd©e
(
šput
, 
Ëngth
);  
	`Trunÿ‹dV”ify
(
dige¡
, 
dige¡L’gth
);
	}
}

596 
	g´Ùeùed
:

597 
	$ThrowIfInv®idTrunÿ‹dSize
(
size_t
 
size
) const;

598 
	}
};

600 
HashT¿nsfÜm©iÚ
 
	tHashFunùiÚ
;

604 
şass
 
CRYPTOPP_DLL
 
CRYPTOPP_NO_VTABLE
 
	gBlockCh”
 : 
public
 
Sim¶eKeyšgIÁ”çû
,…ubliø
	gBlockT¿nsfÜm©iÚ


606 
	g´Ùeùed
:

607 cÚ¡ 
AlgÜ™hm
 & 
G‘AlgÜ™hm
(ècÚ¡ { *
this
;}

611 
şass
 
CRYPTOPP_DLL
 
CRYPTOPP_NO_VTABLE
 
	gSymm‘ricCh”
 : 
public
 
Sim¶eKeyšgIÁ”çû
,…ubliø
	gSŒ—mT¿nsfÜm©iÚ


613 
	g´Ùeùed
:

614 cÚ¡ 
AlgÜ™hm
 & 
G‘AlgÜ™hm
(ècÚ¡ { *
this
;}

618 
şass
 
CRYPTOPP_DLL
 
CRYPTOPP_NO_VTABLE
 
	gMes§geAuth’tiÿtiÚCode
 : 
public
 
Sim¶eKeyšgIÁ”çû
,…ubliø
	gHashT¿nsfÜm©iÚ


620 
	g´Ùeùed
:

621 cÚ¡ 
AlgÜ™hm
 & 
G‘AlgÜ™hm
(ècÚ¡ { *
this
;}

627 
şass
 
CRYPTOPP_DLL
 
CRYPTOPP_NO_VTABLE
 
	gAuth’tiÿ‹dSymm‘ricCh”
 : 
public
 
Mes§geAuth’tiÿtiÚCode
,…ubliø
	gSŒ—mT¿nsfÜm©iÚ


629 
	gpublic
:

631 şas 
	cBadS‹
 : 
public
 
Exû±iÚ


633 
public
:

634 
ex¶ic™
 
BadS‹
(cÚ¡ 
¡d
::
¡ršg
 &
Çme
, cÚ¡ *
mes§ge
è: 
Exû±iÚ
(
OTHER_ERROR
,‚ame + ": " + message) {}

635 
ex¶ic™
 
BadS‹
(cÚ¡ 
¡d
::
¡ršg
 &
Çme
, cÚ¡ *
funùiÚ
, cÚ¡ *
¡©e
è: 
Exû±iÚ
(
OTHER_ERROR
,‚ame + ": " + function + " was called before " + state) {}

639 
vœtu®
 
lwÜd
 
	$MaxH—d”L’gth
() const =0;

641 
vœtu®
 
lwÜd
 
	$MaxMes§geL’gth
() const =0;

643 
vœtu®
 
lwÜd
 
	$MaxFoÙ”L’gth
(ècÚ¡ { 0;
	}
}

646 
vœtu®
 
boŞ
 
	$N“dsP»¥ecif›dD©aL’gths
(ècÚ¡ { 
çl£
;
	}
}

648 
S³cifyD©aL’gths
(
lwÜd
 
h—d”L’gth
,†wÜd 
mes§geL’gth
,†wÜd 
foÙ”L’gth
=0);

650 
vœtu®
 
Enüy±AndAuth’tiÿ‹
(
by‹
 *
ch”‹xt
, by‹ *
mac
, 
size_t
 
macSize
, cÚ¡ by‹ *
iv
, 
ivL’gth
, cÚ¡ by‹ *
h—d”
, size_ˆ
h—d”L’gth
, cÚ¡ by‹ *
mes§ge
, size_ˆ
mes§geL’gth
);

652 
vœtu®
 
boŞ
 
Deüy±AndV”ify
(
by‹
 *
mes§ge
, cÚ¡ by‹ *
mac
, 
size_t
 
macL’gth
, cÚ¡ by‹ *
iv
, 
ivL’gth
, cÚ¡ by‹ *
h—d”
, size_ˆ
h—d”L’gth
, cÚ¡ by‹ *
ch”‹xt
, size_ˆ
ch”‹xtL’gth
);

655 
vœtu®
 
	g¡d
::
¡ršg
 
	$AlgÜ™hmName
() const =0;

657 
´Ùeùed
:

658 cÚ¡ 
AlgÜ™hm
 & 
	$G‘AlgÜ™hm
(ècÚ¡ { *
¡©ic_ÿ¡
<cÚ¡ 
Mes§geAuth’tiÿtiÚCode
 *>(
this
);
	}
}

659 
vœtu®
 
	$UncheckedS³cifyD©aL’gths
(
lwÜd
 
h—d”L’gth
,†wÜd 
mes§geL’gth
,†wÜd 
foÙ”L’gth
è{
	}
}

662 #ifdeà
CRYPTOPP_MAINTAIN_BACKWARDS_COMPATIBILITY


663 
Symm‘ricCh”
 
	tSŒ—mCh”
;

669 şas 
	cCRYPTOPP_DLL
 
CRYPTOPP_NO_VTABLE
 
	mRªdomNumb”G’”©Ü
 : 
public
 
AlgÜ™hm


671 
public
:

673 
vœtu®
 
	$IncÜpÜ©eEÁrİy
(cÚ¡ 
by‹
 *
šput
, 
size_t
 
Ëngth
è{
throw
 
	`NÙIm¶em’‹d
("RandomNumberGenerator: IncorporateEntropy‚ot implemented");}

676 
vœtu®
 
boŞ
 
	$CªIncÜpÜ©eEÁrİy
(ècÚ¡ { 
çl£
;
	}
}

679 
vœtu®
 
by‹
 
G’”©eBy‹
();

683 
vœtu®
 
G’”©eB™
();

686 
vœtu®
 
wÜd32
 
G’”©eWÜd32
(wÜd32 
a
=0, wÜd32 
b
=0xffffffffL);

689 
vœtu®
 
G’”©eBlock
(
by‹
 *
ouut
, 
size_t
 
size
);

692 
vœtu®
 
DisÿrdBy‹s
(
size_t
 
n
);

695 
vœtu®
 
G’”©eIÁoBufã»dT¿nsfÜm©iÚ
(
Bufã»dT¿nsfÜm©iÚ
 &
rg‘
, cÚ¡ 
¡d
::
¡ršg
 &
chªÃl
, 
lwÜd
 
Ëngth
);

698 
	g‹m¶©e
 <
şass
 
	gIT
> 
	$Shufæe
(
IT
 
begš
, IT 
’d
)

700 ; 
begš
 !ğ
’d
; ++begin)

701 
¡d
::
	`™”_sw­
(
begš
, begš + 
	`G’”©eWÜd32
(0, 
’d
-begin-1));

702 
	}
}

704 #ifdeà
CRYPTOPP_MAINTAIN_BACKWARDS_COMPATIBILITY


705 
by‹
 
	$G‘By‹
(è{ 
	`G’”©eBy‹
();
	}
}

706 
	$G‘B™
(è{ 
	`G’”©eB™
();
	}
}

707 
wÜd32
 
	$G‘LÚg
(
wÜd32
 
a
=0, wÜd32 
b
=0xffffffffLè{ 
	`G’”©eWÜd32
×, b);
	}
}

708 
wÜd16
 
	$G‘ShÜt
(
wÜd16
 
a
=0, wÜd16 
b
=0xffffè{ (wÜd16)
	`G’”©eWÜd32
×, b);
	}
}

709 
	$G‘Block
(
by‹
 *
ouut
, 
size_t
 
size
è{
	`G’”©eBlock
(ouut, size);
	}
}

714 
CRYPTOPP_DLL
 
	gRªdomNumb”G’”©Ü
 & 
CRYPTOPP_API
 
NuÎRNG
();

716 
şass
 
	gWa™ObjeùCÚš”
;

717 
şass
 
	gC®lSck
;

721 şas 
	cCRYPTOPP_NO_VTABLE
 
	mWa™abË


723 
	mpublic
:

724 
vœtu®
 ~
	$Wa™abË
() {}

727 
vœtu®
 
	$G‘MaxWa™ObjeùCouÁ
() const =0;

733 
vœtu®
 
	`G‘Wa™Objeùs
(
Wa™ObjeùCÚš”
 &
cÚš”
, 
C®lSck
 cÚ¡& 
ÿÎSck
) =0;

736 
boŞ
 
	`Wa™
(
mli£cÚds
, 
C®lSck
 cÚ¡& 
ÿÎSck
);

737 
	}
};

740 
CRYPTOPP_DLL
 cÚ¡ 
¡d
::
¡ršg
 
DEFAULT_CHANNEL
;

743 
CRYPTOPP_DLL
 cÚ¡ 
¡d
::
¡ršg
 
AAD_CHANNEL
;

771 
şass
 
CRYPTOPP_DLL
 
CRYPTOPP_NO_VTABLE
 
	gBufã»dT¿nsfÜm©iÚ
 : 
public
 
AlgÜ™hm
,…ubliø
	gWa™abË


773 
	gpublic
:

775 cÚ¡ 
¡d
::
¡ršg
 &
NULL_CHANNEL
;

777 
Bufã»dT¿nsfÜm©iÚ
(è: 
AlgÜ™hm
(
çl£
) {}

780 
Bufã»dT¿nsfÜm©iÚ
& 
Ref
(è{ *
this
;}

785 
size_t
 
Put
(
by‹
 
šBy‹
, 
boŞ
 
blockšg
=
Œue
)

786 { 
Put
(&
šBy‹
, 1, 
blockšg
);}

788 
size_t
 
Put
(cÚ¡ 
by‹
 *
šSŒšg
, size_ˆ
Ëngth
, 
boŞ
 
blockšg
=
Œue
)

789 { 
Put2
(
šSŒšg
, 
Ëngth
, 0, 
blockšg
);}

792 
size_t
 
PutWÜd16
(
wÜd16
 
v®ue
, 
By‹Ord”
 
Üd”
=
BIG_ENDIAN_ORDER
, 
boŞ
 
blockšg
=
Œue
);

794 
size_t
 
PutWÜd32
(
wÜd32
 
v®ue
, 
By‹Ord”
 
Üd”
=
BIG_ENDIAN_ORDER
, 
boŞ
 
blockšg
=
Œue
);

799 
vœtu®
 
by‹
 * 
C»©ePutS·û
(
size_t
 &
size
è{
	gsize
=0;  
	gNULL
;}

801 
vœtu®
 
boŞ
 
CªModifyIÅut
(ècÚ¡ { 
	gçl£
;}

804 
size_t
 
PutModifŸbË
(
by‹
 *
šSŒšg
, size_ˆ
Ëngth
, 
boŞ
 
blockšg
=
Œue
)

805 { 
PutModifŸbË2
(
šSŒšg
, 
Ëngth
, 0, 
blockšg
);}

807 
boŞ
 
Mes§geEnd
(
´İag©iÚ
=-1, boŞ 
blockšg
=
Œue
)

808 { !!
Put2
(
NULL
, 0, 
´İag©iÚ
 < 0 ? -1 :…rİag©iÚ+1, 
blockšg
);}

809 
size_t
 
PutMes§geEnd
(cÚ¡ 
by‹
 *
šSŒšg
, size_ˆ
Ëngth
, 
´İag©iÚ
=-1, 
boŞ
 
blockšg
=
Œue
)

810 { 
Put2
(
šSŒšg
, 
Ëngth
, 
´İag©iÚ
 < 0 ? -1 :…rİag©iÚ+1, 
blockšg
);}

814 
vœtu®
 
size_t
 
Put2
(cÚ¡ 
by‹
 *
šSŒšg
, size_ˆ
Ëngth
, 
mes§geEnd
, 
boŞ
 
blockšg
) =0;

817 
vœtu®
 
size_t
 
PutModifŸbË2
(
by‹
 *
šSŒšg
, size_ˆ
Ëngth
, 
mes§geEnd
, 
boŞ
 
blockšg
)

818 { 
Put2
(
šSŒšg
, 
Ëngth
, 
mes§geEnd
, 
blockšg
);}

821 
	gBlockšgIÅutOÆy
 : 
public
 
NÙIm¶em’‹d


822 {
BlockšgIÅutOÆy
(cÚ¡ 
¡d
::
¡ršg
 &
s
è: 
NÙIm¶em’‹d
(s + ": Nonblocking input is‚ot implemented byhis object.") {}};

827 
G‘MaxWa™ObjeùCouÁ
() const;

828 
G‘Wa™Objeùs
(
Wa™ObjeùCÚš”
 &
cÚš”
, 
C®lSck
 cÚ¡& 
ÿÎSck
);

833 
vœtu®
 
IsŞ©edIn™Ÿlize
(cÚ¡ 
NameV®uePaœs
 &
·¿m‘”s
è{
throw
 
NÙIm¶em’‹d
("BufferedTransformation:his object can't be„einitialized");}

834 
vœtu®
 
boŞ
 
IsŞ©edFlush
(boŞ 
h¬dFlush
, boŞ 
blockšg
) =0;

835 
vœtu®
 
boŞ
 
IsŞ©edMes§geS”›sEnd
(boŞ 
blockšg
è{ 
	gçl£
;}

838 
vœtu®
 
In™Ÿlize
(cÚ¡ 
NameV®uePaœs
 &
·¿m‘”s
=
g_nuÎNameV®uePaœs
, 
´İag©iÚ
=-1);

850 
vœtu®
 
boŞ
 
Flush
(boŞ 
h¬dFlush
, 
´İag©iÚ
=-1, boŞ 
blockšg
=
Œue
);

853 
vœtu®
 
boŞ
 
Mes§geS”›sEnd
(
´İag©iÚ
=-1, boŞ 
blockšg
=
Œue
);

857 
vœtu®
 
S‘AutoSigÇlPrİag©iÚ
(
´İag©iÚ
) {}

860 
vœtu®
 
G‘AutoSigÇlPrİag©iÚ
() const { 0;}

861 
	gpublic
:

863 #ifdeà
CRYPTOPP_MAINTAIN_BACKWARDS_COMPATIBILITY


864 
Clo£
(è{
Mes§geEnd
();}

874 
vœtu®
 
lwÜd
 
MaxR‘r›vabË
() const;

877 
vœtu®
 
boŞ
 
AnyR‘r›vabË
() const;

880 
vœtu®
 
size_t
 
G‘
(
by‹
 &
outBy‹
);

882 
vœtu®
 
size_t
 
G‘
(
by‹
 *
outSŒšg
, size_ˆ
g‘Max
);

885 
vœtu®
 
size_t
 
P“k
(
by‹
 &
outBy‹
) const;

887 
vœtu®
 
size_t
 
P“k
(
by‹
 *
outSŒšg
, size_ˆ
³ekMax
) const;

890 
size_t
 
G‘WÜd16
(
wÜd16
 &
v®ue
, 
By‹Ord”
 
Üd”
=
BIG_ENDIAN_ORDER
);

892 
size_t
 
G‘WÜd32
(
wÜd32
 &
v®ue
, 
By‹Ord”
 
Üd”
=
BIG_ENDIAN_ORDER
);

895 
size_t
 
P“kWÜd16
(
wÜd16
 &
v®ue
, 
By‹Ord”
 
Üd”
=
BIG_ENDIAN_ORDER
) const;

897 
size_t
 
P“kWÜd32
(
wÜd32
 &
v®ue
, 
By‹Ord”
 
Üd”
=
BIG_ENDIAN_ORDER
) const;

900 
lwÜd
 
T¿nsãrTo
(
Bufã»dT¿nsfÜm©iÚ
 &
rg‘
,†wÜd 
ŒªsãrMax
=
LWORD_MAX
, cÚ¡ 
¡d
::
¡ršg
 &
chªÃl
=
DEFAULT_CHANNEL
)

901 {
T¿nsãrTo2
(
rg‘
, 
ŒªsãrMax
, 
chªÃl
);  
	gŒªsãrMax
;}

904 
vœtu®
 
lwÜd
 
Sk
ÖwÜd 
skMax
=
LWORD_MAX
);

907 
lwÜd
 
CİyTo
(
Bufã»dT¿nsfÜm©iÚ
 &
rg‘
,†wÜd 
cİyMax
=
LWORD_MAX
, cÚ¡ 
¡d
::
¡ršg
 &
chªÃl
=
DEFAULT_CHANNEL
) const

908 { 
CİyRªgeTo
(
rg‘
, 0, 
cİyMax
, 
chªÃl
);}

911 
lwÜd
 
CİyRªgeTo
(
Bufã»dT¿nsfÜm©iÚ
 &
rg‘
,†wÜd 
pos™iÚ
,†wÜd 
cİyMax
=
LWORD_MAX
, cÚ¡ 
¡d
::
¡ršg
 &
chªÃl
=
DEFAULT_CHANNEL
) const

912 {
lwÜd
 
i
 = 
pos™iÚ
; 
CİyRªgeTo2
(
rg‘
, i, i+
cİyMax
, 
chªÃl
);  
	gi
-
	gpos™iÚ
;}

914 #ifdeà
CRYPTOPP_MAINTAIN_BACKWARDS_COMPATIBILITY


915 
MaxR‘r›v—bË
(ècÚ¡ { 
MaxR‘r›vabË
();}

922 
vœtu®
 
lwÜd
 
TÙ®By‹sR‘r›vabË
() const;

924 
vœtu®
 
Numb”OfMes§ges
() const;

926 
vœtu®
 
boŞ
 
AnyMes§ges
() const;

932 
vœtu®
 
boŞ
 
G‘NextMes§ge
();

934 
vœtu®
 
SkMes§ges
(
couÁ
=
UINT_MAX
);

936 
T¿nsãrMes§gesTo
(
Bufã»dT¿nsfÜm©iÚ
 &
rg‘
, 
couÁ
=
UINT_MAX
, cÚ¡ 
¡d
::
¡ršg
 &
chªÃl
=
DEFAULT_CHANNEL
)

937 {
T¿nsãrMes§gesTo2
(
rg‘
, 
couÁ
, 
chªÃl
);  
	gcouÁ
;}

939 
CİyMes§gesTo
(
Bufã»dT¿nsfÜm©iÚ
 &
rg‘
, 
couÁ
=
UINT_MAX
, cÚ¡ 
¡d
::
¡ršg
 &
chªÃl
=
DEFAULT_CHANNEL
) const;

942 
vœtu®
 
SkAÎ
();

944 
T¿nsãrAÎTo
(
Bufã»dT¿nsfÜm©iÚ
 &
rg‘
, cÚ¡ 
¡d
::
¡ršg
 &
chªÃl
=
DEFAULT_CHANNEL
)

945 {
T¿nsãrAÎTo2
(
rg‘
, 
chªÃl
);}

947 
CİyAÎTo
(
Bufã»dT¿nsfÜm©iÚ
 &
rg‘
, cÚ¡ 
¡d
::
¡ršg
 &
chªÃl
=
DEFAULT_CHANNEL
) const;

949 
vœtu®
 
boŞ
 
G‘NextMes§geS”›s
(è{ 
	gçl£
;}

950 
vœtu®
 
Numb”OfMes§gesInThisS”›s
(ècÚ¡ { 
Numb”OfMes§ges
();}

951 
vœtu®
 
Numb”OfMes§geS”›s
() const { 0;}

957 
vœtu®
 
size_t
 
T¿nsãrTo2
(
Bufã»dT¿nsfÜm©iÚ
 &
rg‘
, 
lwÜd
 &
by‹CouÁ
, cÚ¡ 
¡d
::
¡ršg
 &
chªÃl
=
DEFAULT_CHANNEL
, 
boŞ
 
blockšg
=
Œue
) =0;

959 
vœtu®
 
size_t
 
CİyRªgeTo2
(
Bufã»dT¿nsfÜm©iÚ
 &
rg‘
, 
lwÜd
 &
begš
,†wÜd 
’d
=
LWORD_MAX
, cÚ¡ 
¡d
::
¡ršg
 &
chªÃl
=
DEFAULT_CHANNEL
, 
boŞ
 
blockšg
=
Œue
) const =0;

961 
size_t
 
T¿nsãrMes§gesTo2
(
Bufã»dT¿nsfÜm©iÚ
 &
rg‘
, &
mes§geCouÁ
, cÚ¡ 
¡d
::
¡ršg
 &
chªÃl
=
DEFAULT_CHANNEL
, 
boŞ
 
blockšg
=
Œue
);

963 
size_t
 
T¿nsãrAÎTo2
(
Bufã»dT¿nsfÜm©iÚ
 &
rg‘
, cÚ¡ 
¡d
::
¡ršg
 &
chªÃl
=
DEFAULT_CHANNEL
, 
boŞ
 
blockšg
=
Œue
);

968 
	gNoChªÃlSuµÜt
 : 
public
 
NÙIm¶em’‹d


969 {
NoChªÃlSuµÜt
(cÚ¡ 
¡d
::
¡ršg
 &
Çme
è: 
NÙIm¶em’‹d
(name + ":his object doesn't support multiple channels") {}};

970 
	gInv®idChªÃlName
 : 
public
 
Inv®idArgum’t


971 {
Inv®idChªÃlName
(cÚ¡ 
¡d
::
¡ršg
 &
Çme
, cÚ¡ std::¡ršg &
chªÃl
è: 
Inv®idArgum’t
(name + ": unexpected channel‚ame \"" + channel + "\"") {}};

973 
size_t
 
ChªÃlPut
(cÚ¡ 
¡d
::
¡ršg
 &
chªÃl
, 
by‹
 
šBy‹
, 
boŞ
 
blockšg
=
Œue
)

974 { 
ChªÃlPut
(
chªÃl
, &
šBy‹
, 1, 
blockšg
);}

975 
size_t
 
ChªÃlPut
(cÚ¡ 
¡d
::
¡ršg
 &
chªÃl
, cÚ¡ 
by‹
 *
šSŒšg
, size_ˆ
Ëngth
, 
boŞ
 
blockšg
=
Œue
)

976 { 
ChªÃlPut2
(
chªÃl
, 
šSŒšg
, 
Ëngth
, 0, 
blockšg
);}

978 
size_t
 
ChªÃlPutModifŸbË
(cÚ¡ 
¡d
::
¡ršg
 &
chªÃl
, 
by‹
 *
šSŒšg
, size_ˆ
Ëngth
, 
boŞ
 
blockšg
=
Œue
)

979 { 
ChªÃlPutModifŸbË2
(
chªÃl
, 
šSŒšg
, 
Ëngth
, 0, 
blockšg
);}

981 
size_t
 
ChªÃlPutWÜd16
(cÚ¡ 
¡d
::
¡ršg
 &
chªÃl
, 
wÜd16
 
v®ue
, 
By‹Ord”
 
Üd”
=
BIG_ENDIAN_ORDER
, 
boŞ
 
blockšg
=
Œue
);

982 
size_t
 
ChªÃlPutWÜd32
(cÚ¡ 
¡d
::
¡ršg
 &
chªÃl
, 
wÜd32
 
v®ue
, 
By‹Ord”
 
Üd”
=
BIG_ENDIAN_ORDER
, 
boŞ
 
blockšg
=
Œue
);

984 
boŞ
 
ChªÃlMes§geEnd
(cÚ¡ 
¡d
::
¡ršg
 &
chªÃl
, 
´İag©iÚ
=-1, boŞ 
blockšg
=
Œue
)

985 { !!
ChªÃlPut2
(
chªÃl
, 
NULL
, 0, 
´İag©iÚ
 < 0 ? -1 :…rİag©iÚ+1, 
blockšg
);}

986 
size_t
 
ChªÃlPutMes§geEnd
(cÚ¡ 
¡d
::
¡ršg
 &
chªÃl
, cÚ¡ 
by‹
 *
šSŒšg
, size_ˆ
Ëngth
, 
´İag©iÚ
=-1, 
boŞ
 
blockšg
=
Œue
)

987 { 
ChªÃlPut2
(
chªÃl
, 
šSŒšg
, 
Ëngth
, 
´İag©iÚ
 < 0 ? -1 :…rİag©iÚ+1, 
blockšg
);}

989 
vœtu®
 
by‹
 * 
ChªÃlC»©ePutS·û
(cÚ¡ 
¡d
::
¡ršg
 &
chªÃl
, 
size_t
 &
size
);

991 
vœtu®
 
size_t
 
ChªÃlPut2
(cÚ¡ 
¡d
::
¡ršg
 &
chªÃl
, cÚ¡ 
by‹
 *
begš
, size_ˆ
Ëngth
, 
mes§geEnd
, 
boŞ
 
blockšg
);

992 
vœtu®
 
size_t
 
ChªÃlPutModifŸbË2
(cÚ¡ 
¡d
::
¡ršg
 &
chªÃl
, 
by‹
 *
begš
, size_ˆ
Ëngth
, 
mes§geEnd
, 
boŞ
 
blockšg
);

994 
vœtu®
 
boŞ
 
ChªÃlFlush
(cÚ¡ 
¡d
::
¡ršg
 &
chªÃl
, boŞ 
h¬dFlush
, 
´İag©iÚ
=-1, boŞ 
blockšg
=
Œue
);

995 
vœtu®
 
boŞ
 
ChªÃlMes§geS”›sEnd
(cÚ¡ 
¡d
::
¡ršg
 &
chªÃl
, 
´İag©iÚ
=-1, boŞ 
blockšg
=
Œue
);

997 
vœtu®
 
S‘R‘r›v®ChªÃl
(cÚ¡ 
¡d
::
¡ršg
 &
chªÃl
);

1009 
vœtu®
 
boŞ
 
A‰achabË
(è{ 
	gçl£
;}

1011 
vœtu®
 
Bufã»dT¿nsfÜm©iÚ
 *
A‰achedT¿nsfÜm©iÚ
(è{
as£¹
(!
A‰achabË
());  0;}

1013 
vœtu®
 cÚ¡ 
Bufã»dT¿nsfÜm©iÚ
 *
A‰achedT¿nsfÜm©iÚ
() const

1014 { 
	gcÚ¡_ÿ¡
<
	gBufã»dT¿nsfÜm©iÚ
 *>(
	gthis
)->
A‰achedT¿nsfÜm©iÚ
();}

1016 
vœtu®
 
D‘ach
(
Bufã»dT¿nsfÜm©iÚ
 *
ÃwA‰achm’t
 = 0)

1017 {
as£¹
(!
A‰achabË
()); 
throw
 
NÙIm¶em’‹d
("BufferedTransformation:his object is‚ot‡ttachable");}

1019 
vœtu®
 
A‰ach
(
Bufã»dT¿nsfÜm©iÚ
 *
ÃwA‰achm’t
);

1022 
	g´Ùeùed
:

1023 
Deüem’tPrİag©iÚ
(
´İag©iÚ
)

1024 { 
´İag©iÚ
 != 0 ?…ropagation - 1 : 0;}

1026 
	g´iv©e
:

1027 
by‹
 
m_buf
[4];

1031 
	gBufã»dT¿nsfÜm©iÚ
 & 
TheB™Buck‘
();

1035 şas 
	cCRYPTOPP_DLL
 
CRYPTOPP_NO_VTABLE
 
	mCry±oM©”Ÿl
 : 
public
 
NameV®uePaœs


1037 
public
:

1039 şas 
	cCRYPTOPP_DLL
 
Inv®idM©”Ÿl
 : 
public
 
Inv®idD©aFÜm©


1041 
public
:

1042 
ex¶ic™
 
Inv®idM©”Ÿl
(cÚ¡ 
¡d
::
¡ršg
 &
s
è: 
Inv®idD©aFÜm©
(s) {}

1047 
vœtu®
 
AssignFrom
(cÚ¡ 
NameV®uePaœs
 &
sourû
) =0;

1056 
vœtu®
 
boŞ
 
	$V®id©e
(
RªdomNumb”G’”©Ü
 &
ºg
, 
Ëv–
) const =0;

1059 
vœtu®
 
	$ThrowIfInv®id
(
RªdomNumb”G’”©Ü
 &
ºg
, 
Ëv–
) const

1060 {ià(!
	`V®id©e
(
ºg
, 
Ëv–
)è
throw
 
	`Inv®idM©”Ÿl
("Cry±oM©”Ÿl:hi objeù cÚš šv®id v®ues");
	}
}

1065 
vœtu®
 
	$Save
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
) const

1066 {
throw
 
	`NÙIm¶em’‹d
("Cry±oM©”Ÿl:hi objeù dÛ nÙ suµÜˆ§všg");
	}
}

1072 
vœtu®
 
	$Lßd
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
)

1073 {
throw
 
	`NÙIm¶em’‹d
("Cry±oM©”Ÿl:hi objeù dÛ nÙ suµÜˆlßdšg");
	}
}

1076 
vœtu®
 
boŞ
 
	$SuµÜtsP»computiÚ
(ècÚ¡ { 
çl£
;
	}
}

1081 
vœtu®
 
	$P»compu‹
(
n
)

1082 {
	`as£¹
(!
	`SuµÜtsP»computiÚ
()); 
throw
 
	`NÙIm¶em’‹d
("Cry±oM©”Ÿl:hi objeù dÛ nÙ suµÜˆ´ecomputiÚ");
	}
}

1084 
vœtu®
 
	$LßdP»computiÚ
(
Bufã»dT¿nsfÜm©iÚ
 &
¡ÜedP»computiÚ
)

1085 {
	`as£¹
(!
	`SuµÜtsP»computiÚ
()); 
throw
 
	`NÙIm¶em’‹d
("Cry±oM©”Ÿl:hi objeù dÛ nÙ suµÜˆ´ecomputiÚ");
	}
}

1087 
vœtu®
 
	$SaveP»computiÚ
(
Bufã»dT¿nsfÜm©iÚ
 &
¡ÜedP»computiÚ
) const

1088 {
	`as£¹
(!
	`SuµÜtsP»computiÚ
()); 
throw
 
	`NÙIm¶em’‹d
("Cry±oM©”Ÿl:hi objeù dÛ nÙ suµÜˆ´ecomputiÚ");
	}
}

1091 
	$DoQuickSª™yCheck
(ècÚ¡ {
	`ThrowIfInv®id
(
	`NuÎRNG
(), 0);
	}
}

1093 #ià(
defšed
(
__SUNPRO_CC
) && __SUNPRO_CC < 0x590)

1095 
	gm_sunCCwÜk¬ound
;

1101 şas 
	cCRYPTOPP_DLL
 
CRYPTOPP_NO_VTABLE
 
	mG’”©abËCry±oM©”Ÿl
 : 
vœtu®
 
public
 
Cry±oM©”Ÿl


1103 
public
:

1107 
vœtu®
 
	$G’”©eRªdom
(
RªdomNumb”G’”©Ü
 &
ºg
, cÚ¡ 
NameV®uePaœs
 &
·¿ms
 = 
g_nuÎNameV®uePaœs
)

1108 {
throw
 
	`NÙIm¶em’‹d
("GeneratableCryptoMaterial:his object does‚ot support key/parameter generation");}

1111 
	`G’”©eRªdomW™hKeySize
(
RªdomNumb”G’”©Ü
 &
ºg
, 
keySize
);

1112 
	}
};

1116 şas 
	cCRYPTOPP_DLL
 
CRYPTOPP_NO_VTABLE
 
	mPublicKey
 : 
vœtu®
 
public
 
Cry±oM©”Ÿl


1122 şas 
	cCRYPTOPP_DLL
 
CRYPTOPP_NO_VTABLE
 
	mPriv©eKey
 : 
public
 
G’”©abËCry±oM©”Ÿl


1128 şas 
	cCRYPTOPP_DLL
 
CRYPTOPP_NO_VTABLE
 
	mCry±oP¬am‘”s
 : 
public
 
G’”©abËCry±oM©”Ÿl


1134 şas 
	cCRYPTOPP_DLL
 
CRYPTOPP_NO_VTABLE
 
	mAsymm‘ricAlgÜ™hm
 : 
public
 
AlgÜ™hm


1136 
public
:

1138 
vœtu®
 
Cry±oM©”Ÿl
 & 
AcûssM©”Ÿl
() =0;

1140 
vœtu®
 cÚ¡ 
	mCry±oM©”Ÿl
 & 
	$G‘M©”Ÿl
() const =0;

1143 
	$BERDecode
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
)

1144 {
	`AcûssM©”Ÿl
().
	`Lßd
(
bt
);}

1146 
	$DEREncode
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
) const

1147 {
	`G‘M©”Ÿl
().
	`Save
(
bt
);
	}
}

1152 şas 
	cCRYPTOPP_DLL
 
CRYPTOPP_NO_VTABLE
 
	mPublicKeyAlgÜ™hm
 : 
public
 
Asymm‘ricAlgÜ™hm


1154 
public
:

1156 
Cry±oM©”Ÿl
 & 
	$AcûssM©”Ÿl
(è{ 
	`AcûssPublicKey
();}

1157 cÚ¡ 
Cry±oM©”Ÿl
 & 
	$G‘M©”Ÿl
(ècÚ¡ { 
	`G‘PublicKey
();
	}
}

1159 
vœtu®
 
	gPublicKey
 & 
AcûssPublicKey
() =0;

1160 
vœtu®
 cÚ¡ 
	gPublicKey
 & 
	$G‘PublicKey
(ècÚ¡ { 
cÚ¡_ÿ¡
<
PublicKeyAlgÜ™hm
 *>(
this
)->
	`AcûssPublicKey
();
	}
}

1165 şas 
	cCRYPTOPP_DLL
 
CRYPTOPP_NO_VTABLE
 
	mPriv©eKeyAlgÜ™hm
 : 
public
 
Asymm‘ricAlgÜ™hm


1167 
public
:

1168 
Cry±oM©”Ÿl
 & 
	$AcûssM©”Ÿl
(è{ 
	`AcûssPriv©eKey
();}

1169 cÚ¡ 
Cry±oM©”Ÿl
 & 
	$G‘M©”Ÿl
(ècÚ¡ { 
	`G‘Priv©eKey
();
	}
}

1171 
vœtu®
 
	gPriv©eKey
 & 
AcûssPriv©eKey
() =0;

1172 
vœtu®
 cÚ¡ 
	gPriv©eKey
 & 
	$G‘Priv©eKey
(ècÚ¡ { 
cÚ¡_ÿ¡
<
Priv©eKeyAlgÜ™hm
 *>(
this
)->
	`AcûssPriv©eKey
();
	}
}

1177 şas 
	cCRYPTOPP_DLL
 
CRYPTOPP_NO_VTABLE
 
	mKeyAg»em’tAlgÜ™hm
 : 
public
 
Asymm‘ricAlgÜ™hm


1179 
public
:

1180 
Cry±oM©”Ÿl
 & 
	$AcûssM©”Ÿl
(è{ 
	`AcûssCry±oP¬am‘”s
();}

1181 cÚ¡ 
Cry±oM©”Ÿl
 & 
	$G‘M©”Ÿl
(ècÚ¡ { 
	`G‘Cry±oP¬am‘”s
();
	}
}

1183 
vœtu®
 
	gCry±oP¬am‘”s
 & 
AcûssCry±oP¬am‘”s
() =0;

1184 
vœtu®
 cÚ¡ 
	gCry±oP¬am‘”s
 & 
	$G‘Cry±oP¬am‘”s
(ècÚ¡ { 
cÚ¡_ÿ¡
<
KeyAg»em’tAlgÜ™hm
 *>(
this
)->
	`AcûssCry±oP¬am‘”s
();
	}
}

1192 şas 
	cCRYPTOPP_DLL
 
CRYPTOPP_NO_VTABLE
 
	mPK_Cry±oSy¡em


1194 
	mpublic
:

1195 
vœtu®
 ~
	$PK_Cry±oSy¡em
() {}

1199 
vœtu®
 
size_t
 
	$MaxPÏš‹xtL’gth
(
size_t
 
ch”‹xtL’gth
) const =0;

1203 
vœtu®
 
size_t
 
	$Ch”‹xtL’gth
(
size_t
 
¶aš‹xtL’gth
) const =0;

1207 
vœtu®
 
boŞ
 
	$P¬am‘”SuµÜ‹d
(cÚ¡ *
Çme
) const =0;

1212 
vœtu®
 
size_t
 
	$FixedCh”‹xtL’gth
(ècÚ¡ { 0;
	}
}

1215 
vœtu®
 
size_t
 
	$FixedMaxPÏš‹xtL’gth
(ècÚ¡ { 0;
	}
}

1217 #ifdeà
CRYPTOPP_MAINTAIN_BACKWARDS_COMPATIBILITY


1218 
size_t
 
	$MaxPÏšTextL’gth
(
size_t
 
ch”TextL’gth
ècÚ¡ { 
	`MaxPÏš‹xtL’gth
(ch”TextL’gth);
	}
}

1219 
size_t
 
	$Ch”TextL’gth
(
size_t
 
¶ašTextL’gth
ècÚ¡ { 
	`Ch”‹xtL’gth
ÕÏšTextL’gth);
	}
}

1224 
şass
 
CRYPTOPP_DLL
 
CRYPTOPP_NO_VTABLE
 
	gPK_Enüy±Ü
 : 
public
 
PK_Cry±oSy¡em
,…ubliø
	gPublicKeyAlgÜ™hm


1226 
	gpublic
:

1228 şas 
	cCRYPTOPP_DLL
 
Inv®idPÏš‹xtL’gth
 : 
public
 
Exû±iÚ


1230 
public
:

1231 
Inv®idPÏš‹xtL’gth
(è: 
Exû±iÚ
(
OTHER_ERROR
, "PK_Encryptor: invalid…laintext†ength") {}

1238 
vœtu®
 
	$Enüy±
(
RªdomNumb”G’”©Ü
 &
ºg
,

1239 cÚ¡ 
by‹
 *
¶aš‹xt
, 
size_t
 
¶aš‹xtL’gth
,

1240 
by‹
 *
ch”‹xt
, cÚ¡ 
NameV®uePaœs
 &
·¿m‘”s
 = 
g_nuÎNameV®uePaœs
) const =0;

1246 
vœtu®
 
Bufã»dT¿nsfÜm©iÚ
 * 
	$C»©eEnüy±iÚF‹r
(
RªdomNumb”G’”©Ü
 &
ºg
,

1247 
Bufã»dT¿nsfÜm©iÚ
 *
©chm’t
=
NULL
, cÚ¡ 
NameV®uePaœs
 &
·¿m‘”s
 = 
g_nuÎNameV®uePaœs
) const;

1248 
	}
};

1252 
şass
 
CRYPTOPP_DLL
 
CRYPTOPP_NO_VTABLE
 
	gPK_Deüy±Ü
 : 
public
 
PK_Cry±oSy¡em
,…ubliø
	gPriv©eKeyAlgÜ™hm


1254 
	gpublic
:

1259 
vœtu®
 
DecodšgResuÉ
 
Deüy±
(
RªdomNumb”G’”©Ü
 &
ºg
,

1260 cÚ¡ 
by‹
 *
ch”‹xt
, 
size_t
 
ch”‹xtL’gth
,

1261 
by‹
 *
¶aš‹xt
, cÚ¡ 
NameV®uePaœs
 &
·¿m‘”s
 = 
g_nuÎNameV®uePaœs
) const =0;

1266 
vœtu®
 
Bufã»dT¿nsfÜm©iÚ
 * 
C»©eDeüy±iÚF‹r
(
RªdomNumb”G’”©Ü
 &
ºg
,

1267 
Bufã»dT¿nsfÜm©iÚ
 *
©chm’t
=
NULL
, cÚ¡ 
NameV®uePaœs
 &
·¿m‘”s
 = 
g_nuÎNameV®uePaœs
) const;

1270 
DecodšgResuÉ
 
FixedL’gthDeüy±
(
RªdomNumb”G’”©Ü
 &
ºg
, cÚ¡ 
by‹
 *
ch”‹xt
, by‹ *
¶aš‹xt
, cÚ¡ 
NameV®uePaœs
 &
·¿m‘”s
 = 
g_nuÎNameV®uePaœs
) const

1271 { 
Deüy±
(
ºg
, 
ch”‹xt
, 
FixedCh”‹xtL’gth
(), 
¶aš‹xt
, 
·¿m‘”s
);}

1274 #ifdeà
CRYPTOPP_MAINTAIN_BACKWARDS_COMPATIBILITY


1275 
PK_Cry±oSy¡em
 
	tPK_FixedL’gthCry±oSy¡em
;

1276 
PK_Enüy±Ü
 
	tPK_FixedL’gthEnüy±Ü
;

1277 
PK_Deüy±Ü
 
	tPK_FixedL’gthDeüy±Ü
;

1285 şas 
	cCRYPTOPP_DLL
 
CRYPTOPP_NO_VTABLE
 
	mPK_SigÇtu»Scheme


1287 
	mpublic
:

1289 şas 
	cCRYPTOPP_DLL
 
Inv®idKeyL’gth
 : 
public
 
Exû±iÚ


1291 
public
:

1292 
Inv®idKeyL’gth
(cÚ¡ 
¡d
::
¡ršg
 &
mes§ge
è: 
Exû±iÚ
(
OTHER_ERROR
, message) {}

1296 şas 
	cCRYPTOPP_DLL
 
	gKeyTooShÜt
 : 
public
 
Inv®idKeyL’gth


1298 
public
:

1299 
KeyTooShÜt
(è: 
Inv®idKeyL’gth
("PK_Signer: keyoo short forhis signature scheme") {}

1302 
	gvœtu®
 ~
	$PK_SigÇtu»Scheme
(è{
	}
}

1305 
vœtu®
 
size_t
 
	$SigÇtu»L’gth
() const =0;

1308 
vœtu®
 
size_t
 
	$MaxSigÇtu»L’gth
(
size_t
 
»cov”abËP¬tL’gth
 = 0ècÚ¡ { 
	`SigÇtu»L’gth
();
	}
}

1311 
vœtu®
 
size_t
 
	$MaxRecov”abËL’gth
() const =0;

1314 
vœtu®
 
size_t
 
	$MaxRecov”abËL’gthFromSigÇtu»L’gth
(
size_t
 
sigÇtu»L’gth
) const =0;

1318 
vœtu®
 
boŞ
 
	$IsProbabi¡ic
() const =0;

1321 
vœtu®
 
boŞ
 
	$AÎowNÚ»cov”abËP¬t
() const =0;

1324 
vœtu®
 
boŞ
 
	$SigÇtu»UpäÚt
(ècÚ¡ { 
çl£
;
	}
}

1327 
vœtu®
 
boŞ
 
	$Recov”abËP¬tFœ¡
() const =0;

1328 
	}
};

1334 şas 
	cCRYPTOPP_DLL
 
CRYPTOPP_NO_VTABLE
 
	mPK_Mes§geAccumuÏtÜ
 : 
public
 
HashT¿nsfÜm©iÚ


1336 
public
:

1338 
	$Dige¡Size
() const

1339 {
throw
 
	`NÙIm¶em’‹d
("PK_MessageAccumulator: DigestSize() should‚ot be called");}

1341 
	$Trunÿ‹dFš®
(
by‹
 *
dige¡
, 
size_t
 
dige¡Size
)

1342 {
throw
 
	`NÙIm¶em’‹d
("PK_Mes§geAccumuÏtÜ: Trunÿ‹dFš®(èshould‚Ù bÿÎed");
	}
}

1347 
şass
 
CRYPTOPP_DLL
 
CRYPTOPP_NO_VTABLE
 
	gPK_SigÃr
 : 
public
 
PK_SigÇtu»Scheme
,…ubliø
	gPriv©eKeyAlgÜ™hm


1349 
	gpublic
:

1351 
vœtu®
 
PK_Mes§geAccumuÏtÜ
 * 
NewSigÇtu»AccumuÏtÜ
(
RªdomNumb”G’”©Ü
 &
ºg
) const =0;

1353 
vœtu®
 
IÅutRecov”abËMes§ge
(
PK_Mes§geAccumuÏtÜ
 &
mes§geAccumuÏtÜ
, cÚ¡ 
by‹
 *
»cov”abËMes§ge
, 
size_t
 
»cov”abËMes§geL’gth
) const =0;

1359 
vœtu®
 
size_t
 
Sign
(
RªdomNumb”G’”©Ü
 &
ºg
, 
PK_Mes§geAccumuÏtÜ
 *
mes§geAccumuÏtÜ
, 
by‹
 *
sigÇtu»
) const;

1365 
vœtu®
 
size_t
 
SignAndRe¡¬t
(
RªdomNumb”G’”©Ü
 &
ºg
, 
PK_Mes§geAccumuÏtÜ
 &
mes§geAccumuÏtÜ
, 
by‹
 *
sigÇtu»
, 
boŞ
 
»¡¬t
=
Œue
) const =0;

1371 
vœtu®
 
size_t
 
SignMes§ge
(
RªdomNumb”G’”©Ü
 &
ºg
, cÚ¡ 
by‹
 *
mes§ge
, size_ˆ
mes§geL’
, by‹ *
sigÇtu»
) const;

1377 
vœtu®
 
size_t
 
SignMes§geW™hRecov”y
(
RªdomNumb”G’”©Ü
 &
ºg
, cÚ¡ 
by‹
 *
»cov”abËMes§ge
, size_ˆ
»cov”abËMes§geL’gth
,

1378 cÚ¡ 
by‹
 *
nÚ»cov”abËMes§ge
, 
size_t
 
nÚ»cov”abËMes§geL’gth
, by‹ *
sigÇtu»
) const;

1388 
şass
 
CRYPTOPP_DLL
 
CRYPTOPP_NO_VTABLE
 
	gPK_V”if›r
 : 
public
 
PK_SigÇtu»Scheme
,…ubliø
	gPublicKeyAlgÜ™hm


1390 
	gpublic
:

1392 
vœtu®
 
PK_Mes§geAccumuÏtÜ
 * 
NewV”ifiÿtiÚAccumuÏtÜ
() const =0;

1395 
vœtu®
 
IÅutSigÇtu»
(
PK_Mes§geAccumuÏtÜ
 &
mes§geAccumuÏtÜ
, cÚ¡ 
by‹
 *
sigÇtu»
, 
size_t
 
sigÇtu»L’gth
) const =0;

1398 
vœtu®
 
boŞ
 
V”ify
(
PK_Mes§geAccumuÏtÜ
 *
mes§geAccumuÏtÜ
) const;

1401 
vœtu®
 
boŞ
 
V”ifyAndRe¡¬t
(
PK_Mes§geAccumuÏtÜ
 &
mes§geAccumuÏtÜ
) const =0;

1404 
vœtu®
 
boŞ
 
V”ifyMes§ge
(cÚ¡ 
by‹
 *
mes§ge
, 
size_t
 
mes§geL’
,

1405 cÚ¡ 
by‹
 *
sigÇtu»
, 
size_t
 
sigÇtu»L’gth
) const;

1410 
vœtu®
 
DecodšgResuÉ
 
Recov”
(
by‹
 *
»cov”edMes§ge
, 
PK_Mes§geAccumuÏtÜ
 *
mes§geAccumuÏtÜ
) const;

1415 
vœtu®
 
DecodšgResuÉ
 
Recov”AndRe¡¬t
(
by‹
 *
»cov”edMes§ge
, 
PK_Mes§geAccumuÏtÜ
 &
mes§geAccumuÏtÜ
) const =0;

1420 
vœtu®
 
DecodšgResuÉ
 
Recov”Mes§ge
(
by‹
 *
»cov”edMes§ge
,

1421 cÚ¡ 
by‹
 *
nÚ»cov”abËMes§ge
, 
size_t
 
nÚ»cov”abËMes§geL’gth
,

1422 cÚ¡ 
by‹
 *
sigÇtu»
, 
size_t
 
sigÇtu»L’gth
) const;

1431 şas 
	cCRYPTOPP_DLL
 
CRYPTOPP_NO_VTABLE
 
	mSim¶eKeyAg»em’tDomaš
 : 
public
 
KeyAg»em’tAlgÜ™hm


1433 
public
:

1435 
vœtu®
 
	$Ag»edV®ueL’gth
() const =0;

1437 
vœtu®
 
	$Priv©eKeyL’gth
() const =0;

1439 
vœtu®
 
	$PublicKeyL’gth
() const =0;

1442 
vœtu®
 
	$G’”©ePriv©eKey
(
RªdomNumb”G’”©Ü
 &
ºg
, 
by‹
 *
´iv©eKey
) const =0;

1445 
vœtu®
 
	$G’”©ePublicKey
(
RªdomNumb”G’”©Ü
 &
ºg
, cÚ¡ 
by‹
 *
´iv©eKey
, by‹ *
publicKey
) const =0;

1448 
vœtu®
 
	$G’”©eKeyPaœ
(
RªdomNumb”G’”©Ü
 &
ºg
, 
by‹
 *
´iv©eKey
, by‹ *
publicKey
) const;

1455 
vœtu®
 
boŞ
 
	$Ag»e
(
by‹
 *
ag»edV®ue
, cÚ¡ by‹ *
´iv©eKey
, cÚ¡ by‹ *
Ùh”PublicKey
, 
boŞ
 
v®id©eOth”PublicKey
=
Œue
) const =0;

1457 #ifdeà
CRYPTOPP_MAINTAIN_BACKWARDS_COMPATIBILITY


1458 
boŞ
 
	$V®id©eDomašP¬am‘”s
(
RªdomNumb”G’”©Ü
 &
ºg
) const

1459 { 
	`G‘Cry±oP¬am‘”s
().
	`V®id©e
(
ºg
, 2);}

1461 
	}
};

1469 şas 
	cCRYPTOPP_DLL
 
CRYPTOPP_NO_VTABLE
 
	mAuth’tiÿ‹dKeyAg»em’tDomaš
 : 
public
 
KeyAg»em’tAlgÜ™hm


1471 
public
:

1473 
vœtu®
 
	$Ag»edV®ueL’gth
() const =0;

1476 
vœtu®
 
	$SticPriv©eKeyL’gth
() const =0;

1478 
vœtu®
 
	$SticPublicKeyL’gth
() const =0;

1481 
vœtu®
 
	$G’”©eSticPriv©eKey
(
RªdomNumb”G’”©Ü
 &
ºg
, 
by‹
 *
´iv©eKey
) const =0;

1484 
vœtu®
 
	$G’”©eSticPublicKey
(
RªdomNumb”G’”©Ü
 &
ºg
, cÚ¡ 
by‹
 *
´iv©eKey
, by‹ *
publicKey
) const =0;

1487 
vœtu®
 
	$G’”©eSticKeyPaœ
(
RªdomNumb”G’”©Ü
 &
ºg
, 
by‹
 *
´iv©eKey
, by‹ *
publicKey
) const;

1490 
vœtu®
 
	$Ephem”®Priv©eKeyL’gth
() const =0;

1492 
vœtu®
 
	$Ephem”®PublicKeyL’gth
() const =0;

1495 
vœtu®
 
	$G’”©eEphem”®Priv©eKey
(
RªdomNumb”G’”©Ü
 &
ºg
, 
by‹
 *
´iv©eKey
) const =0;

1498 
vœtu®
 
	$G’”©eEphem”®PublicKey
(
RªdomNumb”G’”©Ü
 &
ºg
, cÚ¡ 
by‹
 *
´iv©eKey
, by‹ *
publicKey
) const =0;

1501 
vœtu®
 
	$G’”©eEphem”®KeyPaœ
(
RªdomNumb”G’”©Ü
 &
ºg
, 
by‹
 *
´iv©eKey
, by‹ *
publicKey
) const;

1512 
vœtu®
 
boŞ
 
	$Ag»e
(
by‹
 *
ag»edV®ue
,

1513 cÚ¡ 
by‹
 *
¡©icPriv©eKey
, cÚ¡ by‹ *
•hem”®Priv©eKey
,

1514 cÚ¡ 
by‹
 *
¡©icOth”PublicKey
, cÚ¡ by‹ *
•hem”®Oth”PublicKey
,

1515 
boŞ
 
v®id©eSticOth”PublicKey
=
Œue
) const =0;

1517 #ifdeà
CRYPTOPP_MAINTAIN_BACKWARDS_COMPATIBILITY


1518 
boŞ
 
	$V®id©eDomašP¬am‘”s
(
RªdomNumb”G’”©Ü
 &
ºg
) const

1519 { 
	`G‘Cry±oP¬am‘”s
().
	`V®id©e
(
ºg
, 2);}

1521 
	}
};

1546 şas 
	cPrÙocŞSessiÚ


1548 
	mpublic
:

1550 şas 
	cPrÙocŞE¼Ü
 : 
public
 
Exû±iÚ


1552 
public
:

1553 
PrÙocŞE¼Ü
(
E¼ÜTy³
 
”rÜTy³
, cÚ¡ 
¡d
::
¡ršg
 &
s
è: 
Exû±iÚ
(errorType, s) {}

1558 şas 
	cUÃx³ùedM‘hodC®l
 : 
public
 
Exû±iÚ


1560 
public
:

1561 
UÃx³ùedM‘hodC®l
(cÚ¡ 
¡d
::
¡ršg
 &
s
è: 
Exû±iÚ
(
OTHER_ERROR
, s) {}

1564 
	$PrÙocŞSessiÚ
(è: 
	`m_ºg
(
NULL
), 
	`m_throwOnPrÙocŞE¼Ü
(
Œue
), 
	$m_v®idS‹
(
çl£
è{
	}
}

1565 
	gvœtu®
 ~
	$PrÙocŞSessiÚ
(è{
	}
}

1567 
vœtu®
 
In™ŸlizeSessiÚ
(
RªdomNumb”G’”©Ü
 &
ºg
, cÚ¡ 
NameV®uePaœs
 &
·¿m‘”s
) =0;

1569 
boŞ
 
	$G‘ThrowOnPrÙocŞE¼Ü
(ècÚ¡ { 
m_throwOnPrÙocŞE¼Ü
;
	}
}

1570 
	$S‘ThrowOnPrÙocŞE¼Ü
(
boŞ
 
throwOnPrÙocŞE¼Ü
è{
m_throwOnPrÙocŞE¼Ü
 =hrowOnPrÙocŞE¼Ü;
	}
}

1572 
boŞ
 
	$HasV®idS‹
(ècÚ¡ { 
m_v®idS‹
;
	}
}

1574 
vœtu®
 
boŞ
 
	$OutgošgMes§geAvaabË
() const =0;

1575 
vœtu®
 
	$G‘OutgošgMes§geL’gth
() const =0;

1576 
vœtu®
 
	`G‘OutgošgMes§ge
(
by‹
 *
mes§ge
) =0;

1578 
vœtu®
 
boŞ
 
	$La¡Mes§geProûs£d
() const =0;

1579 
vœtu®
 
	`ProûssIncomšgMes§ge
(cÚ¡ 
by‹
 *
mes§ge
, 
mes§geL’gth
) =0;

1581 
´Ùeùed
:

1582 
	$HªdËPrÙocŞE¼Ü
(
Exû±iÚ
::
E¼ÜTy³
 
”rÜTy³
, cÚ¡ 
¡d
::
¡ršg
 &
s
) const;

1583 
	$CheckAndHªdËInv®idS‹
() const;

1584 
	$S‘V®idS‹
(
boŞ
 
v®id
è{
m_v®idS‹
 = v®id;
	}
}

1586 
RªdomNumb”G’”©Ü
 *
	gm_ºg
;

1588 
	g´iv©e
:

1589 
boŞ
 
m_throwOnPrÙocŞE¼Ü
, 
	gm_v®idS‹
;

1592 şas 
	cKeyAg»em’tSessiÚ
 : 
public
 
PrÙocŞSessiÚ


1594 
public
:

1595 
vœtu®
 
	$G‘Ag»edV®ueL’gth
() const =0;

1596 
vœtu®
 
	$G‘Ag»edV®ue
(
by‹
 *
ag»edV®ue
) const =0;

1599 şas 
	cPasswÜdAuth’tiÿ‹dKeyAg»em’tSessiÚ
 : 
public
 
KeyAg»em’tSessiÚ


1601 
public
:

1602 
	`In™ŸlizePasswÜdAuth’tiÿ‹dKeyAg»em’tSessiÚ
(
RªdomNumb”G’”©Ü
 &
ºg
,

1603 cÚ¡ 
by‹
 *
myId
, 
myIdL’gth
,

1604 cÚ¡ 
by‹
 *
couÁ”P¬tyId
, 
couÁ”P¬tyIdL’gth
,

1605 cÚ¡ 
by‹
 *
·sswÜdOrV”if›r
, 
·sswÜdOrV”if›rL’gth
);

1608 şas 
	cPasswÜdAuth’tiÿ‹dKeyAg»em’tDomaš
 : 
public
 
KeyAg»em’tAlgÜ™hm


1610 
public
:

1612 
vœtu®
 
boŞ
 
	$V®id©eDomašP¬am‘”s
(
RªdomNumb”G’”©Ü
 &
ºg
) const

1613 { 
	`G‘Cry±oP¬am‘”s
().
	`V®id©e
(
ºg
, 2);}

1615 
vœtu®
 
	$G‘PasswÜdV”if›rL’gth
(cÚ¡ 
by‹
 *
·sswÜd
, 
·sswÜdL’gth
) const =0;

1616 
vœtu®
 
	$G’”©ePasswÜdV”if›r
(
RªdomNumb”G’”©Ü
 &
ºg
, cÚ¡ 
by‹
 *
u£rId
, 
u£rIdL’gth
, cÚ¡ by‹ *
·sswÜd
, 
·sswÜdL’gth
, by‹ *
v”if›r
) const =0;

1618 
	eRŞeFÏgs
 {
CLIENT
=1, 
SERVER
=2, 
INITIATOR
=4, 
RESPONDER
=8
	}
};

1620 
vœtu®
 
boŞ
 
IsV®idRŞe
(
rŞe
) =0;

1621 
vœtu®
 
PasswÜdAuth’tiÿ‹dKeyAg»em’tSessiÚ
 * 
	$C»©ePrÙocŞSessiÚ
(
rŞe
) const =0;

1622 
	}
};

1626 şas 
	cCRYPTOPP_DLL
 
	mBERDecodeE¼
 : 
public
 
Inv®idArgum’t


1628 
public
:

1629 
	$BERDecodeE¼
(è: 
	`Inv®idArgum’t
("BER decodeƒrror") {}

1630 
	$BERDecodeE¼
(cÚ¡ 
¡d
::
¡ršg
 &
s
è: 
	$Inv®idArgum’t
(
s
è{
	}
}

1634 şas 
	cCRYPTOPP_DLL
 
CRYPTOPP_NO_VTABLE
 
	mASN1Objeù


1636 
	mpublic
:

1637 
vœtu®
 ~
	$ASN1Objeù
() {}

1639 
vœtu®
 
	`BERDecode
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
) =0;

1641 
vœtu®
 
	$DEREncode
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
) const =0;

1644 
vœtu®
 
	$BEREncode
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
ècÚ¡ {
	`DEREncode
(bt);
	}
}

1647 #ifdeà
CRYPTOPP_MAINTAIN_BACKWARDS_COMPATIBILITY


1648 
PK_SigÇtu»Scheme
 
	tPK_SigÇtu»Sy¡em
;

1649 
Sim¶eKeyAg»em’tDomaš
 
	tPK_Sim¶eKeyAg»em’tDomaš
;

1650 
Auth’tiÿ‹dKeyAg»em’tDomaš
 
	tPK_Auth’tiÿ‹dKeyAg»em’tDomaš
;

1653 
	gNAMESPACE_END


	@cryptlib_bds.cpp

7 
	#Lib¿ry


	)

	@datatest.cpp

1 
	~"çùÜy.h
"

2 
	~"š‹g”.h
"

3 
	~"f‹rs.h
"

4 
	~"hex.h
"

5 
	~"¿ndpoŞ.h
"

6 
	~"fes.h
"

7 
	~"Œunhash.h
"

8 
	~"queue.h
"

9 
	~"v®id©e.h
"

10 
	~<io¡»am
>

11 
	~<memÜy
>

13 
	$USING_NAMESPACE
(
Cry±oPP
)

14 
	$USING_NAMESPACE
(
¡d
)

16 
¡d
::
	tm­
<
	t¡d
::
	t¡ršg
, std::¡ršg> 
	tTe¡D©a
;

17 
boŞ
 
s_thÜough
;

19 şas 
	cTe¡Fau»
 : 
public
 
Exû±iÚ


21 
public
:

22 
	$Te¡Fau»
(è: 
	`Exû±iÚ
(
OTHER_ERROR
, "Validationest failed") {}

23 
	}
};

25 cÚ¡ 
Te¡D©a
 *
	gs_cu¼’tTe¡D©a
 = 
NULL
;

27 
	$OuutTe¡D©a
(cÚ¡ 
Te¡D©a
 &
v
)

29 
Te¡D©a
::
cÚ¡_™”©Ü
 
i
 = 
v
.
	`begš
(); i !ğv.
	`’d
(); ++i)

31 
û¼
 << 
i
->
fœ¡
 << ": " << i->
£cÚd
 << 
’dl
;

33 
	}
}

35 
	$SigÇlTe¡Fau»
()

37 
	`OuutTe¡D©a
(*
s_cu¼’tTe¡D©a
);

38 
throw
 
	`Te¡Fau»
();

39 
	}
}

41 
	$SigÇlTe¡E¼Ü
()

43 
	`OuutTe¡D©a
(*
s_cu¼’tTe¡D©a
);

44 
throw
 
	`Exû±iÚ
(
Exû±iÚ
::
OTHER_ERROR
, "Unexpectedƒrror during validationest");

45 
	}
}

47 
boŞ
 
	$D©aExi¡s
(cÚ¡ 
Te¡D©a
 &
d©a
, cÚ¡ *
Çme
)

49 
Te¡D©a
::
cÚ¡_™”©Ü
 
i
 = 
d©a
.
	`fšd
(
Çme
);

50  (
i
 !ğ
d©a
.
	`’d
());

51 
	}
}

53 cÚ¡ 
	g¡d
::
¡ršg
 & 
	$G‘RequœedD©um
(cÚ¡ 
Te¡D©a
 &
d©a
, cÚ¡ *
Çme
)

55 
Te¡D©a
::
cÚ¡_™”©Ü
 
i
 = 
d©a
.
	`fšd
(
Çme
);

56 ià(
i
 =ğ
d©a
.
	`’d
())

57 
	`SigÇlTe¡E¼Ü
();

58  
i
->
£cÚd
;

59 
	}
}

61 
	$RªdomizedT¿nsãr
(
Bufã»dT¿nsfÜm©iÚ
 &
sourû
, Bufã»dT¿nsfÜm©iÚ &
rg‘
, 
boŞ
 
fšish
, cÚ¡ 
¡d
::
¡ršg
 &
chªÃl
=
DEFAULT_CHANNEL
)

63 
sourû
.
	`MaxR‘r›vabË
(è> (
fšish
 ? 0 : 4096))

65 
by‹
 
buf
[4096+64];

66 
size_t
 
¡¬t
 = 
	`Glob®RNG
().
	`G’”©eWÜd32
(0, 63);

67 
size_t
 
Ën
 = 
	`Glob®RNG
().
	`G’”©eWÜd32
(1, 
	`UnsigÃdMš
(4096U, 3*
sourû
.
	`MaxR‘r›vabË
()/2));

68 
Ën
 = 
sourû
.
	`G‘
(
buf
+
¡¬t
,†en);

69 
rg‘
.
	`ChªÃlPut
(
chªÃl
, 
buf
+
¡¬t
, 
Ën
);

71 
	}
}

73 
	$PutDecodedD©umIÁo
(cÚ¡ 
Te¡D©a
 &
d©a
, cÚ¡ *
Çme
, 
Bufã»dT¿nsfÜm©iÚ
 &
rg‘
)

75 
¡d
::
¡ršg
 
s1
 = 
	`G‘RequœedD©um
(
d©a
, 
Çme
), 
s2
;

76 
By‹Queue
 
q
;

78 !
s1
.
	`em±y
())

80 
s1
[0] == ' ')

82 
s1
 = s1.
	`sub¡r
(1);

83 ià(
s1
.
	`em±y
())

84 
’d
;

87 
»³©
 = 1;

88 ià(
s1
[0] == 'r')

90 
»³©
 = 
	`©oi
(
s1
.
	`c_¡r
()+1);

91 
s1
 = s1.
	`sub¡r
(s1.
	`fšd
(' ')+1);

94 
s2
 = "";

96 ià(
s1
[0] == '\"')

98 
s2
 = 
s1
.
	`sub¡r
(1, s1.
	`fšd
('\"', 1)-1);

99 
s1
 = s1.
	`sub¡r
(
s2
.
	`Ëngth
() + 2);

101 ià(
s1
.
	`sub¡r
(0, 2) == "0x")

103 
	`SŒšgSourû
(
s1
.
	`sub¡r
(2, s1.
	`fšd
(' ')), 
Œue
, 
Ãw
 
	`HexDecod”
Òew 
	`SŒšgSšk
(
s2
)));

104 
s1
 = s1.
	`sub¡r
(
	`STDMIN
(s1.
	`fšd
(' '), s1.
	`Ëngth
()));

108 
	`SŒšgSourû
(
s1
.
	`sub¡r
(0, s1.
	`fšd
(' ')), 
Œue
, 
Ãw
 
	`HexDecod”
Òew 
	`SŒšgSšk
(
s2
)));

109 
s1
 = s1.
	`sub¡r
(
	`STDMIN
(s1.
	`fšd
(' '), s1.
	`Ëngth
()));

112 
»³©
--)

114 
q
.
	`Put
((cÚ¡ 
by‹
 *)
s2
.
	`d©a
(), s2.
	`size
());

115 
	`RªdomizedT¿nsãr
(
q
, 
rg‘
, 
çl£
);

119 
’d
:

120 
	`RªdomizedT¿nsãr
(
q
, 
rg‘
, 
Œue
);

121 
	}
}

123 
	g¡d
::
¡ršg
 
	$G‘DecodedD©um
(cÚ¡ 
Te¡D©a
 &
d©a
, cÚ¡ *
Çme
)

125 
¡d
::
¡ršg
 
s
;

126 
	`PutDecodedD©umIÁo
(
d©a
, 
Çme
, 
	`SŒšgSšk
(
s
).
	`Ref
());

127  
s
;

128 
	}
}

130 
	g¡d
::
¡ršg
 
	$G‘O±iÚ®DecodedD©um
(cÚ¡ 
Te¡D©a
 &
d©a
, cÚ¡ *
Çme
)

132 
¡d
::
¡ršg
 
s
;

133 ià(
	`D©aExi¡s
(
d©a
, 
Çme
))

134 
	`PutDecodedD©umIÁo
(
d©a
, 
Çme
, 
	`SŒšgSšk
(
s
).
	`Ref
());

135  
s
;

136 
	}
}

138 şas 
	cTe¡D©aNameV®uePaœs
 : 
public
 
NameV®uePaœs


140 
public
:

141 
	$Te¡D©aNameV®uePaœs
(cÚ¡ 
Te¡D©a
 &
d©a
è: 
	$m_d©a
(
d©a
) {}

143 
vœtu®
 
boŞ
 
	$G‘VoidV®ue
(cÚ¡ *
Çme
, cÚ¡ 
¡d
::
ty³_šfo
 &
v®ueTy³
, *
pV®ue
) const

145 
Te¡D©a
::
cÚ¡_™”©Ü
 
i
 = 
m_d©a
.
	`fšd
(
Çme
);

146 ià(
i
 =ğ
m_d©a
.
	`’d
())

148 ià(
¡d
::
	`¡ršg
(
Çme
è=ğ
Name
::
	`Dige¡Size
(è&& 
v®ueTy³
 =ğ
	`ty³id
())

150 
i
 = 
m_d©a
.
	`fšd
("MAC");

151 ià(
i
 =ğ
m_d©a
.
	`’d
())

152 
i
 = 
m_d©a
.
	`fšd
("Digest");

153 ià(
i
 =ğ
m_d©a
.
	`’d
())

154  
çl£
;

156 
m_‹mp
.
	`»size
(0);

157 
	`PutDecodedD©umIÁo
(
m_d©a
, 
i
->
fœ¡
.
	`c_¡r
(), 
	`SŒšgSšk
(
m_‹mp
).
	`Ref
());

158 *
»š‹½»t_ÿ¡
<*>(
pV®ue
èğ()
m_‹mp
.
	`size
();

159  
Œue
;

162  
çl£
;

165 cÚ¡ 
¡d
::
¡ršg
 &
v®ue
 = 
i
->
£cÚd
;

167 ià(
v®ueTy³
 =ğ
	`ty³id
())

168 *
»š‹½»t_ÿ¡
<*>(
pV®ue
èğ
	`©oi
(
v®ue
.
	`c_¡r
());

169 ià(
v®ueTy³
 =ğ
	`ty³id
(
IÁeg”
))

170 *
»š‹½»t_ÿ¡
<
IÁeg”
 *>(
pV®ue
èğ
	`IÁeg”
((
¡d
::
	`¡ršg
(
v®ue
è+ "h").
	`c_¡r
());

171 ià(
v®ueTy³
 =ğ
	`ty³id
(
CÚ¡By‹A¼ayP¬am‘”
))

173 
m_‹mp
.
	`»size
(0);

174 
	`PutDecodedD©umIÁo
(
m_d©a
, 
Çme
, 
	`SŒšgSšk
(
m_‹mp
).
	`Ref
());

175 
»š‹½»t_ÿ¡
<
CÚ¡By‹A¼ayP¬am‘”
 *>(
pV®ue
)->
	`Assign
((cÚ¡ 
by‹
 *)
m_‹mp
.
	`d©a
(), m_‹mp.
	`size
(), 
çl£
);

178 
throw
 
	`V®ueTy³Mism©ch
(
Çme
, 
	`ty³id
(
¡d
::
¡ršg
), 
v®ueTy³
);

180  
Œue
;

181 
	}
}

183 
	g´iv©e
:

184 cÚ¡ 
Te¡D©a
 &
m_d©a
;

185 
mubË
 
	g¡d
::
¡ršg
 
m_‹mp
;

188 
	$Te¡KeyPaœV®idAndCÚsi¡’t
(
Cry±oM©”Ÿl
 &
pub
, cÚ¡ Cry±oM©”ŸÈ&
´iv
)

190 ià(!
pub
.
	`V®id©e
(
	`Glob®RNG
(), 2+
s_thÜough
))

191 
	`SigÇlTe¡Fau»
();

192 ià(!
´iv
.
	`V®id©e
(
	`Glob®RNG
(), 2+
s_thÜough
))

193 
	`SigÇlTe¡Fau»
();

195 
By‹Queue
 
bq1
, 
bq2
;

196 
pub
.
	`Save
(
bq1
);

197 
pub
.
	`AssignFrom
(
´iv
);

198 
pub
.
	`Save
(
bq2
);

199 ià(
bq1
 !ğ
bq2
)

200 
	`SigÇlTe¡Fau»
();

201 
	}
}

203 
	$Te¡SigÇtu»Scheme
(
Te¡D©a
 &
v
)

205 
¡d
::
¡ršg
 
Çme
 = 
	`G‘RequœedD©um
(
v
, "Name");

206 
¡d
::
¡ršg
 
‹¡
 = 
	`G‘RequœedD©um
(
v
, "Test");

208 
¡d
::
auto_±r
<
PK_SigÃr
> 
	`sigÃr
(
ObjeùFaùÜyRegi¡ry
<PK_SigÃr>::
	`Regi¡ry
().
	`C»©eObjeù
(
Çme
.
	`c_¡r
()));

209 
¡d
::
auto_±r
<
PK_V”if›r
> 
	`v”if›r
(
ObjeùFaùÜyRegi¡ry
<PK_V”if›r>::
	`Regi¡ry
().
	`C»©eObjeù
(
Çme
.
	`c_¡r
()));

211 
Te¡D©aNameV®uePaœs
 
	`·œs
(
v
);

213 ià(
‹¡
 == "GenerateKey")

215 
sigÃr
->
	`AcûssPriv©eKey
().
	`G’”©eRªdom
(
	`Glob®RNG
(), 
·œs
);

216 
v”if›r
->
	`AcûssPublicKey
().
	`AssignFrom
(
sigÃr
->
	`AcûssPriv©eKey
());

220 
¡d
::
¡ršg
 
keyFÜm©
 = 
	`G‘RequœedD©um
(
v
, "KeyFormat");

222 ià(
keyFÜm©
 == "DER")

223 
v”if›r
->
	`AcûssM©”Ÿl
().
	`Lßd
(
	`SŒšgStÜe
(
	`G‘DecodedD©um
(
v
, "PublicKey")).
	`Ref
());

224 ià(
keyFÜm©
 == "Component")

225 
v”if›r
->
	`AcûssM©”Ÿl
().
	`AssignFrom
(
·œs
);

227 ià(
‹¡
 == "Verify" ||est == "NotVerify")

229 
V”if›rF‹r
 
	`v”if›rF‹r
(*
v”if›r
, 
NULL
, V”if›rF‹r::
SIGNATURE_AT_BEGIN
);

230 
	`PutDecodedD©umIÁo
(
v
, "SigÇtu»", 
v”if›rF‹r
);

231 
	`PutDecodedD©umIÁo
(
v
, "Mes§ge", 
v”if›rF‹r
);

232 
v”if›rF‹r
.
	`Mes§geEnd
();

233 ià(
v”if›rF‹r
.
	`G‘La¡ResuÉ
(è=ğ(
‹¡
 == "NotVerify"))

234 
	`SigÇlTe¡Fau»
();

237 ià(
‹¡
 == "PublicKeyValid")

239 ià(!
v”if›r
->
	`G‘M©”Ÿl
().
	`V®id©e
(
	`Glob®RNG
(), 3))

240 
	`SigÇlTe¡Fau»
();

244 ià(
keyFÜm©
 == "DER")

245 
sigÃr
->
	`AcûssM©”Ÿl
().
	`Lßd
(
	`SŒšgStÜe
(
	`G‘DecodedD©um
(
v
, "Priv©eKey")).
	`Ref
());

246 ià(
keyFÜm©
 == "Component")

247 
sigÃr
->
	`AcûssM©”Ÿl
().
	`AssignFrom
(
·œs
);

250 ià(
‹¡
 == "GenerateKey" ||est == "KeyPairValidAndConsistent")

252 
	`Te¡KeyPaœV®idAndCÚsi¡’t
(
v”if›r
->
	`AcûssM©”Ÿl
(), 
sigÃr
->
	`G‘M©”Ÿl
());

253 
V”if›rF‹r
 
	`v”if›rF‹r
(*
v”if›r
, 
NULL
, V”if›rF‹r::
THROW_EXCEPTION
);

254 
v”if›rF‹r
.
	`Put
((cÚ¡ 
by‹
 *)"abc", 3);

255 
SŒšgSourû
 
	`ss
("abc", 
Œue
, 
Ãw
 
	`SigÃrF‹r
(
	`Glob®RNG
(), *
sigÃr
,‚ew 
	`RedœeùÜ
(
v”if›rF‹r
)));

257 ià(
‹¡
 == "Sign")

259 
SigÃrF‹r
 
	`f
(
	`Glob®RNG
(), *
sigÃr
, 
Ãw
 
	`HexEncod”
Òew 
	`FeSšk
(
cout
)));

260 
SŒšgSourû
 
	`ss
(
	`G‘DecodedD©um
(
v
, "Mes§ge"), 
Œue
, 
Ãw
 
	`RedœeùÜ
(
f
));

261 
	`SigÇlTe¡Fau»
();

263 ià(
‹¡
 == "DeterministicSign")

265 
	`SigÇlTe¡E¼Ü
();

266 
	`as£¹
(
çl£
);

268 ià(
‹¡
 == "RandomSign")

270 
	`SigÇlTe¡E¼Ü
();

271 
	`as£¹
(
çl£
);

275 
	`SigÇlTe¡E¼Ü
();

276 
	`as£¹
(
çl£
);

278 
	}
}

280 
	$Te¡Asymm‘ricCh”
(
Te¡D©a
 &
v
)

282 
¡d
::
¡ršg
 
Çme
 = 
	`G‘RequœedD©um
(
v
, "Name");

283 
¡d
::
¡ršg
 
‹¡
 = 
	`G‘RequœedD©um
(
v
, "Test");

285 
¡d
::
auto_±r
<
PK_Enüy±Ü
> 
	`’üy±Ü
(
ObjeùFaùÜyRegi¡ry
<PK_Enüy±Ü>::
	`Regi¡ry
().
	`C»©eObjeù
(
Çme
.
	`c_¡r
()));

286 
¡d
::
auto_±r
<
PK_Deüy±Ü
> 
	`deüy±Ü
(
ObjeùFaùÜyRegi¡ry
<PK_Deüy±Ü>::
	`Regi¡ry
().
	`C»©eObjeù
(
Çme
.
	`c_¡r
()));

288 
¡d
::
¡ršg
 
keyFÜm©
 = 
	`G‘RequœedD©um
(
v
, "KeyFormat");

290 ià(
keyFÜm©
 == "DER")

292 
deüy±Ü
->
	`AcûssM©”Ÿl
().
	`Lßd
(
	`SŒšgStÜe
(
	`G‘DecodedD©um
(
v
, "Priv©eKey")).
	`Ref
());

293 
’üy±Ü
->
	`AcûssM©”Ÿl
().
	`Lßd
(
	`SŒšgStÜe
(
	`G‘DecodedD©um
(
v
, "PublicKey")).
	`Ref
());

295 ià(
keyFÜm©
 == "Component")

297 
Te¡D©aNameV®uePaœs
 
	`·œs
(
v
);

298 
deüy±Ü
->
	`AcûssM©”Ÿl
().
	`AssignFrom
(
·œs
);

299 
’üy±Ü
->
	`AcûssM©”Ÿl
().
	`AssignFrom
(
·œs
);

302 ià(
‹¡
 == "DecryptMatch")

304 
¡d
::
¡ršg
 
deüy±ed
, 
ex³ùed
 = 
	`G‘DecodedD©um
(
v
, "Plaintext");

305 
SŒšgSourû
 
	`ss
(
	`G‘DecodedD©um
(
v
, "Ch”‹xt"), 
Œue
, 
Ãw
 
	`PK_Deüy±ÜF‹r
(
	`Glob®RNG
(), *
deüy±Ü
,‚ew 
	`SŒšgSšk
(
deüy±ed
)));

306 ià(
deüy±ed
 !ğ
ex³ùed
)

307 
	`SigÇlTe¡Fau»
();

309 ià(
‹¡
 == "KeyPairValidAndConsistent")

311 
	`Te¡KeyPaœV®idAndCÚsi¡’t
(
’üy±Ü
->
	`AcûssM©”Ÿl
(), 
deüy±Ü
->
	`G‘M©”Ÿl
());

315 
	`SigÇlTe¡E¼Ü
();

316 
	`as£¹
(
çl£
);

318 
	}
}

320 
	$Te¡Symm‘ricCh”
(
Te¡D©a
 &
v
, cÚ¡ 
NameV®uePaœs
 &
ov”rideP¬am‘”s
)

322 
¡d
::
¡ršg
 
Çme
 = 
	`G‘RequœedD©um
(
v
, "Name");

323 
¡d
::
¡ršg
 
‹¡
 = 
	`G‘RequœedD©um
(
v
, "Test");

325 
¡d
::
¡ršg
 
key
 = 
	`G‘DecodedD©um
(
v
, "Key");

326 
¡d
::
¡ršg
 
¶aš‹xt
 = 
	`G‘DecodedD©um
(
v
, "Plaintext");

328 
Te¡D©aNameV®uePaœs
 
	`‹¡D©aPaœs
(
v
);

329 
CombšedNameV®uePaœs
 
	`·œs
(
ov”rideP¬am‘”s
, 
‹¡D©aPaœs
);

331 ià(
‹¡
 == "Encrypt" ||est == "EncryptXorDigest" ||est == "Resync" ||est == "EncryptionMCT" ||est == "DecryptionMCT")

333 
memb”_±r
<
Symm‘ricCh”
> 
’üy±Ü
, 
deüy±Ü
;

334 
¡d
::
¡ršg
 
Ï¡Name
;

336 ià(
Çme
 !ğ
Ï¡Name
)

338 
’üy±Ü
.
	`»£t
(
ObjeùFaùÜyRegi¡ry
<
Symm‘ricCh”
, 
ENCRYPTION
>::
	`Regi¡ry
().
	`C»©eObjeù
(
Çme
.
	`c_¡r
()));

339 
deüy±Ü
.
	`»£t
(
ObjeùFaùÜyRegi¡ry
<
Symm‘ricCh”
, 
DECRYPTION
>::
	`Regi¡ry
().
	`C»©eObjeù
(
Çme
.
	`c_¡r
()));

340 
Ï¡Name
 = 
Çme
;

343 
CÚ¡By‹A¼ayP¬am‘”
 
iv
;

344 ià(
·œs
.
	`G‘V®ue
(
Name
::
	`IV
(), 
iv
è&& iv.
	`size
(è!ğ
’üy±Ü
->
	`IVSize
())

345 
	`SigÇlTe¡Fau»
();

347 ià(
‹¡
 == "Resync")

349 
’üy±Ü
->
	`ResynchrÚize
(
iv
.
	`begš
(), ()iv.
	`size
());

350 
deüy±Ü
->
	`ResynchrÚize
(
iv
.
	`begš
(), ()iv.
	`size
());

354 
’üy±Ü
->
	`S‘Key
((cÚ¡ 
by‹
 *)
key
.
	`d©a
(), key.
	`size
(), 
·œs
);

355 
deüy±Ü
->
	`S‘Key
((cÚ¡ 
by‹
 *)
key
.
	`d©a
(), key.
	`size
(), 
·œs
);

358 
£ek
 = 
·œs
.
	`G‘IÁV®ueW™hDeçuÉ
("Seek", 0);

359 ià(
£ek
)

361 
’üy±Ü
->
	`S“k
(
£ek
);

362 
deüy±Ü
->
	`S“k
(
£ek
);

365 
¡d
::
¡ršg
 
’üy±ed
, 
xÜDige¡
, 
ch”‹xt
, 
ch”‹xtXÜDige¡
;

366 ià(
‹¡
 == "EncryptionMCT" ||est == "DecryptionMCT")

368 
Symm‘ricCh”
 *
ch”
 = 
’üy±Ü
.
	`g‘
();

369 
SecBy‹Block
 
	`buf
((
by‹
 *)
¶aš‹xt
.
	`d©a
(),…Ïš‹xt.
	`size
()), 
	`keybuf
((by‹ *)
key
.data(), key.size());

371 ià(
‹¡
 == "DecryptionMCT")

373 
ch”
 = 
deüy±Ü
.
	`g‘
();

374 
ch”‹xt
 = 
	`G‘DecodedD©um
(
v
, "Ciphertext");

375 
buf
.
	`Assign
((
by‹
 *)
ch”‹xt
.
	`d©a
(), ch”‹xt.
	`size
());

378 
i
=0; i<400; i++)

380 
’üy±ed
.
	`»£rve
(10000 * 
¶aš‹xt
.
	`size
());

381 
j
=0; j<10000; j++)

383 
ch”
->
	`ProûssSŒšg
(
buf
.
	`begš
(), buf.
	`size
());

384 
’üy±ed
.
	`­³nd
((*)
buf
.
	`begš
(), buf.
	`size
());

387 
’üy±ed
.
	`”a£
(0,ƒnüy±ed.
	`size
(è- 
keybuf
.size());

388 
	`xÜbuf
(
keybuf
.
	`begš
(), (cÚ¡ 
by‹
 *)
’üy±ed
.
	`d©a
(), keybuf.
	`size
());

389 
ch”
->
	`S‘Key
(
keybuf
, keybuf.
	`size
());

391 
’üy±ed
.
	`assign
((*)
buf
.
	`begš
(), buf.
	`size
());

392 
ch”‹xt
 = 
	`G‘DecodedD©um
(
v
, 
‹¡
 == "EncryptionMCT" ? "Ciphertext" : "Plaintext");

393 ià(
’üy±ed
 !ğ
ch”‹xt
)

395 
¡d
::
cout
 << "incorrectlyƒncrypted: ";

396 
SŒšgSourû
 
	`xx
(
’üy±ed
, 
çl£
, 
Ãw
 
	`HexEncod”
Òew 
	`FeSšk
(
¡d
::
cout
)));

397 
xx
.
	`Pump
(256); xx.
	`Flush
(
çl£
);

398 
¡d
::
cout
 << "\n";

399 
	`SigÇlTe¡Fau»
();

404 
SŒ—mT¿nsfÜm©iÚF‹r
 
	`’cF‹r
(*
’üy±Ü
, 
Ãw
 
	`SŒšgSšk
(
’üy±ed
), SŒ—mT¿nsfÜm©iÚF‹r::
NO_PADDING
);

405 
	`RªdomizedT¿nsãr
(
	`SŒšgStÜe
(
¶aš‹xt
).
	`Ref
(), 
’cF‹r
, 
Œue
);

406 
’cF‹r
.
	`Mes§geEnd
();

416 ià(
‹¡
 != "EncryptXorDigest")

417 
ch”‹xt
 = 
	`G‘DecodedD©um
(
v
, "Ciphertext");

420 
ch”‹xtXÜDige¡
 = 
	`G‘DecodedD©um
(
v
, "CiphertextXorDigest");

421 
xÜDige¡
.
	`­³nd
(
’üy±ed
, 0, 64);

422 
size_t
 
i
=64; i<
’üy±ed
.
	`size
(); i++)

423 
xÜDige¡
[
i
%64] ^ğ
’üy±ed
[i];

425 ià(
‹¡
 !ğ"Enüy±XÜDige¡" ? 
’üy±ed
 !ğ
ch”‹xt
 : 
xÜDige¡
 !ğ
ch”‹xtXÜDige¡
)

427 
¡d
::
cout
 << "incorrectlyƒncrypted: ";

428 
SŒšgSourû
 
	`xx
(
’üy±ed
, 
çl£
, 
Ãw
 
	`HexEncod”
Òew 
	`FeSšk
(
¡d
::
cout
)));

429 
xx
.
	`Pump
(2048); xx.
	`Flush
(
çl£
);

430 
¡d
::
cout
 << "\n";

431 
	`SigÇlTe¡Fau»
();

433 
¡d
::
¡ršg
 
deüy±ed
;

434 
SŒ—mT¿nsfÜm©iÚF‹r
 
	`decF‹r
(*
deüy±Ü
, 
Ãw
 
	`SŒšgSšk
(
deüy±ed
), SŒ—mT¿nsfÜm©iÚF‹r::
NO_PADDING
);

435 
	`RªdomizedT¿nsãr
(
	`SŒšgStÜe
(
’üy±ed
).
	`Ref
(), 
decF‹r
, 
Œue
);

436 
decF‹r
.
	`Mes§geEnd
();

437 ià(
deüy±ed
 !ğ
¶aš‹xt
)

439 
¡d
::
cout
 << "incorrectly decrypted: ";

440 
SŒšgSourû
 
	`xx
(
deüy±ed
, 
çl£
, 
Ãw
 
	`HexEncod”
Òew 
	`FeSšk
(
¡d
::
cout
)));

441 
xx
.
	`Pump
(256); xx.
	`Flush
(
çl£
);

442 
¡d
::
cout
 << "\n";

443 
	`SigÇlTe¡Fau»
();

448 
¡d
::
cout
 << "unexpectedest‚ame\n";

449 
	`SigÇlTe¡E¼Ü
();

451 
	}
}

453 
	$Te¡Auth’tiÿ‹dSymm‘ricCh”
(
Te¡D©a
 &
v
, cÚ¡ 
NameV®uePaœs
 &
ov”rideP¬am‘”s
)

455 
¡d
::
¡ršg
 
ty³
 = 
	`G‘RequœedD©um
(
v
, "AlgorithmType");

456 
¡d
::
¡ršg
 
Çme
 = 
	`G‘RequœedD©um
(
v
, "Name");

457 
¡d
::
¡ršg
 
‹¡
 = 
	`G‘RequœedD©um
(
v
, "Test");

458 
¡d
::
¡ršg
 
key
 = 
	`G‘DecodedD©um
(
v
, "Key");

460 
¡d
::
¡ršg
 
¶aš‹xt
 = 
	`G‘O±iÚ®DecodedD©um
(
v
, "Plaintext");

461 
¡d
::
¡ršg
 
ch”‹xt
 = 
	`G‘O±iÚ®DecodedD©um
(
v
, "Ciphertext");

462 
¡d
::
¡ršg
 
h—d”
 = 
	`G‘O±iÚ®DecodedD©um
(
v
, "Header");

463 
¡d
::
¡ršg
 
foÙ”
 = 
	`G‘O±iÚ®DecodedD©um
(
v
, "Footer");

464 
¡d
::
¡ršg
 
mac
 = 
	`G‘O±iÚ®DecodedD©um
(
v
, "MAC");

466 
Te¡D©aNameV®uePaœs
 
	`‹¡D©aPaœs
(
v
);

467 
CombšedNameV®uePaœs
 
	`·œs
(
ov”rideP¬am‘”s
, 
‹¡D©aPaœs
);

469 ià(
‹¡
 == "Encrypt" ||est == "EncryptXorDigest" ||est == "NotVerify")

471 
memb”_±r
<
Auth’tiÿ‹dSymm‘ricCh”
> 
asc1
, 
asc2
;

472 
asc1
.
	`»£t
(
ObjeùFaùÜyRegi¡ry
<
Auth’tiÿ‹dSymm‘ricCh”
, 
ENCRYPTION
>::
	`Regi¡ry
().
	`C»©eObjeù
(
Çme
.
	`c_¡r
()));

473 
asc2
.
	`»£t
(
ObjeùFaùÜyRegi¡ry
<
Auth’tiÿ‹dSymm‘ricCh”
, 
DECRYPTION
>::
	`Regi¡ry
().
	`C»©eObjeù
(
Çme
.
	`c_¡r
()));

474 
asc1
->
	`S‘Key
((cÚ¡ 
by‹
 *)
key
.
	`d©a
(), key.
	`size
(), 
·œs
);

475 
asc2
->
	`S‘Key
((cÚ¡ 
by‹
 *)
key
.
	`d©a
(), key.
	`size
(), 
·œs
);

477 
¡d
::
¡ršg
 
’üy±ed
, 
deüy±ed
;

478 
Auth’tiÿ‹dEnüy±iÚF‹r
 
	`ef
(*
asc1
, 
Ãw
 
	`SŒšgSšk
(
’üy±ed
));

479 
boŞ
 
macAtBegš
 = !
mac
.
	`em±y
(è&& !
	`Glob®RNG
().
	`G’”©eB™
();

480 
Auth’tiÿ‹dDeüy±iÚF‹r
 
	`df
(*
asc2
, 
Ãw
 
	`SŒšgSšk
(
deüy±ed
), 
macAtBegš
 ? Auth’tiÿ‹dDeüy±iÚF‹r::
MAC_AT_BEGIN
 : 0);

482 ià(
asc1
->
	`N“dsP»¥ecif›dD©aL’gths
())

484 
asc1
->
	`S³cifyD©aL’gths
(
h—d”
.
	`size
(), 
¶aš‹xt
.size(), 
foÙ”
.size());

485 
asc2
->
	`S³cifyD©aL’gths
(
h—d”
.
	`size
(), 
¶aš‹xt
.size(), 
foÙ”
.size());

488 
SŒšgStÜe
 
	`sh
(
h—d”
), 
	`¥
(
¶aš‹xt
), 
	`sc
(
ch”‹xt
), 
	`sf
(
foÙ”
), 
	`sm
(
mac
);

490 ià(
macAtBegš
)

491 
	`RªdomizedT¿nsãr
(
sm
, 
df
, 
Œue
);

492 
sh
.
	`CİyTo
(
df
, 
LWORD_MAX
, 
AAD_CHANNEL
);

493 
	`RªdomizedT¿nsãr
(
sc
, 
df
, 
Œue
);

494 
sf
.
	`CİyTo
(
df
, 
LWORD_MAX
, 
AAD_CHANNEL
);

495 ià(!
macAtBegš
)

496 
	`RªdomizedT¿nsãr
(
sm
, 
df
, 
Œue
);

497 
df
.
	`Mes§geEnd
();

499 
	`RªdomizedT¿nsãr
(
sh
, 
ef
, 
Œue
, 
AAD_CHANNEL
);

500 
	`RªdomizedT¿nsãr
(
¥
, 
ef
, 
Œue
);

501 
	`RªdomizedT¿nsãr
(
sf
, 
ef
, 
Œue
, 
AAD_CHANNEL
);

502 
ef
.
	`Mes§geEnd
();

504 ià(
‹¡
 =ğ"Enüy±" && 
’üy±ed
 !ğ
ch”‹xt
+
mac
)

506 
¡d
::
cout
 << "incorrectlyƒncrypted: ";

507 
SŒšgSourû
 
	`xx
(
’üy±ed
, 
çl£
, 
Ãw
 
	`HexEncod”
Òew 
	`FeSšk
(
¡d
::
cout
)));

508 
xx
.
	`Pump
(2048); xx.
	`Flush
(
çl£
);

509 
¡d
::
cout
 << "\n";

510 
	`SigÇlTe¡Fau»
();

512 ià(
‹¡
 =ğ"Enüy±" && 
deüy±ed
 !ğ
¶aš‹xt
)

514 
¡d
::
cout
 << "incorrectly decrypted: ";

515 
SŒšgSourû
 
	`xx
(
deüy±ed
, 
çl£
, 
Ãw
 
	`HexEncod”
Òew 
	`FeSšk
(
¡d
::
cout
)));

516 
xx
.
	`Pump
(256); xx.
	`Flush
(
çl£
);

517 
¡d
::
cout
 << "\n";

518 
	`SigÇlTe¡Fau»
();

521 ià(
ch”‹xt
.
	`size
()+
mac
.size()-
¶aš‹xt
.size(è!ğ
asc1
->
	`Dige¡Size
())

523 
¡d
::
cout
 << "bad MAC size\n";

524 
	`SigÇlTe¡Fau»
();

526 ià(
df
.
	`G‘La¡ResuÉ
(è!ğ(
‹¡
 == "Encrypt"))

528 
¡d
::
cout
 << "MAC incorrectly verified\n";

529 
	`SigÇlTe¡Fau»
();

534 
¡d
::
cout
 << "unexpectedest‚ame\n";

535 
	`SigÇlTe¡E¼Ü
();

537 
	}
}

539 
	$Te¡Dige¡OrMAC
(
Te¡D©a
 &
v
, 
boŞ
 
‹¡Dige¡
)

541 
¡d
::
¡ršg
 
Çme
 = 
	`G‘RequœedD©um
(
v
, "Name");

542 
¡d
::
¡ršg
 
‹¡
 = 
	`G‘RequœedD©um
(
v
, "Test");

543 cÚ¡ *
dige¡Name
 = 
‹¡Dige¡
 ? "Digest" : "MAC";

545 
memb”_±r
<
Mes§geAuth’tiÿtiÚCode
> 
mac
;

546 
memb”_±r
<
HashT¿nsfÜm©iÚ
> 
hash
;

547 
HashT¿nsfÜm©iÚ
 *
pHash
 = 
NULL
;

549 
Te¡D©aNameV®uePaœs
 
	`·œs
(
v
);

551 ià(
‹¡Dige¡
)

553 
hash
.
	`»£t
(
ObjeùFaùÜyRegi¡ry
<
HashT¿nsfÜm©iÚ
>::
	`Regi¡ry
().
	`C»©eObjeù
(
Çme
.
	`c_¡r
()));

554 
pHash
 = 
hash
.
	`g‘
();

558 
mac
.
	`»£t
(
ObjeùFaùÜyRegi¡ry
<
Mes§geAuth’tiÿtiÚCode
>::
	`Regi¡ry
().
	`C»©eObjeù
(
Çme
.
	`c_¡r
()));

559 
pHash
 = 
mac
.
	`g‘
();

560 
¡d
::
¡ršg
 
key
 = 
	`G‘DecodedD©um
(
v
, "Key");

561 
mac
->
	`S‘Key
((cÚ¡ 
by‹
 *)
key
.
	`c_¡r
(), key.
	`size
(), 
·œs
);

564 ià(
‹¡
 == "Verify" ||est == "VerifyTruncated" ||est == "NotVerify")

566 
dige¡Size
 = -1;

567 ià(
‹¡
 == "VerifyTruncated")

568 
·œs
.
	`G‘IÁV®ue
(
Name
::
	`Dige¡Size
(), 
dige¡Size
);

569 
HashV”ifiÿtiÚF‹r
 
	`v”if›rF‹r
(*
pHash
, 
NULL
, HashV”ifiÿtiÚF‹r::
HASH_AT_BEGIN
, 
dige¡Size
);

570 
	`PutDecodedD©umIÁo
(
v
, 
dige¡Name
, 
v”if›rF‹r
);

571 
	`PutDecodedD©umIÁo
(
v
, "Mes§ge", 
v”if›rF‹r
);

572 
v”if›rF‹r
.
	`Mes§geEnd
();

573 ià(
v”if›rF‹r
.
	`G‘La¡ResuÉ
(è=ğ(
‹¡
 == "NotVerify"))

574 
	`SigÇlTe¡Fau»
();

578 
	`SigÇlTe¡E¼Ü
();

579 
	`as£¹
(
çl£
);

581 
	}
}

583 
boŞ
 
	$G‘F›ld
(
¡d
::
i¡»am
 &
is
, std::
¡ršg
 &
Çme
, std::¡ršg &
v®ue
)

585 
Çme
.
	`»size
(0);

586 
is
 >> 
Çme
;

587 ià(
Çme
.
	`em±y
())

588  
çl£
;

590 ià(
Çme
[Çme.
	`size
()-1] != ':')

592 
c
;

593 
is
 >> 
skws
 >> 
c
;

594 ià(
c
 != ':')

595 
	`SigÇlTe¡E¼Ü
();

598 
Çme
.
	`”a£
Òame.
	`size
()-1);

600 
is
.
	`³ek
() == ' ')

601 
is
.
	`ignÜe
(1);

604 
bufãr
[128];

605 
v®ue
.
	`»size
(0);

606 
boŞ
 
cÚtšueLše
;

612 
is
.
	`g‘
(
bufãr
, (buffer));

613 
v®ue
 +ğ
bufãr
;

615 
bufãr
[0] != 0);

616 
is
.
	`ş—r
();

617 
is
.
	`ignÜe
();

619 ià(!
v®ue
.
	`em±y
(è&& v®ue[v®ue.
	`size
()-1] == '\r')

620 
v®ue
.
	`»size
(v®ue.
	`size
()-1);

622 ià(!
v®ue
.
	`em±y
(è&& v®ue[v®ue.
	`size
()-1] == '\\')

624 
v®ue
.
	`»size
(v®ue.
	`size
()-1);

625 
cÚtšueLše
 = 
Œue
;

628 
cÚtšueLše
 = 
çl£
;

630 
¡d
::
¡ršg
::
size_ty³
 
i
 = 
v®ue
.
	`fšd
('#');

631 ià(
i
 !ğ
¡d
::
¡ršg
::
Åos
)

632 
v®ue
.
	`”a£
(
i
);

634 
cÚtšueLše
);

636  
Œue
;

637 
	}
}

639 
	$OuutPaœ
(cÚ¡ 
NameV®uePaœs
 &
v
, cÚ¡ *
Çme
)

641 
IÁeg”
 
x
;

642 
boŞ
 
b
 = 
v
.
	`G‘V®ue
(
Çme
, 
x
);

643 
	`as£¹
(
b
);

644 
cout
 << 
Çme
 << ": \\\n ";

645 
x
.
	`Encode
(
	`HexEncod”
(
Ãw
 
	`FeSšk
(
cout
), 
çl£
, 64, "\\\À ").
	`Ref
(), x.
	`MšEncodedSize
());

646 
cout
 << 
’dl
;

647 
	}
}

649 
	$OuutNameV®uePaœs
(cÚ¡ 
NameV®uePaœs
 &
v
)

651 
¡d
::
¡ršg
 
Çmes
 = 
v
.
	`G‘V®ueNames
();

652 
¡ršg
::
size_ty³
 
i
 = 0;

653 
i
 < 
Çmes
.
	`size
())

655 
¡ršg
::
size_ty³
 
j
 = 
Çmes
.
	`fšd_fœ¡_of
 (';', 
i
);

657 ià(
j
 =ğ
¡ršg
::
Åos
)

661 
¡d
::
¡ršg
 
Çme
 = 
Çmes
.
	`sub¡r
(
i
, 
j
-i);

662 ià(
Çme
.
	`fšd
(':'è=ğ
¡ršg
::
Åos
)

663 
	`OuutPaœ
(
v
, 
Çme
.
	`c_¡r
());

666 
i
 = 
j
 + 1;

668 
	}
}

670 
	$Te¡D©aFe
(cÚ¡ 
¡d
::
¡ršg
 &
f’ame
, cÚ¡ 
NameV®uePaœs
 &
ov”rideP¬am‘”s
, &
tÙ®Te¡s
, &
çedTe¡s
)

672 
¡d
::
if¡»am
 
	`fe
(
f’ame
.
	`c_¡r
());

673 ià(!
fe
.
	`good
())

674 
throw
 
	`Exû±iÚ
(
Exû±iÚ
::
OTHER_ERROR
, "Cª‚Ù o³Àf" + 
f’ame
 + " for„eading");

675 
Te¡D©a
 
v
;

676 
s_cu¼’tTe¡D©a
 = &
v
;

677 
¡d
::
¡ršg
 
Çme
, 
v®ue
, 
Ï¡AlgName
;

679 
fe
)

681 
fe
.
	`³ek
() == '#')

682 
fe
.
	`ignÜe
(
INT_MAX
, '\n');

684 ià(
fe
.
	`³ek
() == '\n' || file.peek() == '\r')

685 
v
.
	`ş—r
();

687 ià(!
	`G‘F›ld
(
fe
, 
Çme
, 
v®ue
))

689 
v
[
Çme
] = 
v®ue
;

691 ià(
Çme
 =ğ"Te¡" && (
s_thÜough
 || 
v
["SlowTest"] != "1"))

693 
boŞ
 
çed
 = 
Œue
;

694 
¡d
::
¡ršg
 
®gTy³
 = 
	`G‘RequœedD©um
(
v
, "AlgorithmType");

696 ià(
Ï¡AlgName
 !ğ
	`G‘RequœedD©um
(
v
, "Name"))

698 
Ï¡AlgName
 = 
	`G‘RequœedD©um
(
v
, "Name");

699 
cout
 << "\nTe¡šg " << 
®gTy³
.
	`c_¡r
(è<< "‡lgÜ™hm " << 
Ï¡AlgName
.c_str() << ".\n";

702 
Œy


704 ià(
®gTy³
 == "Signature")

705 
	`Te¡SigÇtu»Scheme
(
v
);

706 ià(
®gTy³
 == "SymmetricCipher")

707 
	`Te¡Symm‘ricCh”
(
v
, 
ov”rideP¬am‘”s
);

708 ià(
®gTy³
 == "AuthenticatedSymmetricCipher")

709 
	`Te¡Auth’tiÿ‹dSymm‘ricCh”
(
v
, 
ov”rideP¬am‘”s
);

710 ià(
®gTy³
 == "AsymmetricCipher")

711 
	`Te¡Asymm‘ricCh”
(
v
);

712 ià(
®gTy³
 == "MessageDigest")

713 
	`Te¡Dige¡OrMAC
(
v
, 
Œue
);

714 ià(
®gTy³
 == "MAC")

715 
	`Te¡Dige¡OrMAC
(
v
, 
çl£
);

716 ià(
®gTy³
 == "FileList")

717 
	`Te¡D©aFe
(
	`G‘RequœedD©um
(
v
, "Te¡"), 
g_nuÎNameV®uePaœs
, 
tÙ®Te¡s
, 
çedTe¡s
);

719 
	`SigÇlTe¡E¼Ü
();

720 
çed
 = 
çl£
;

722 
	`ÿtch
 (
Te¡Fau»
 &)

724 
cout
 << "\nTest failed.\n";

726 
	`ÿtch
 (
Cry±oPP
::
Exû±iÚ
 &
e
)

728 
cout
 << "\nCry±oPP::Exû±iÚ caught: " << 
e
.
	`wh©
(è<< 
’dl
;

730 
	`ÿtch
 (
¡d
::
exû±iÚ
 &
e
)

732 
cout
 << "\n¡d::exû±iÚ caught: " << 
e
.
	`wh©
(è<< 
’dl
;

735 ià(
çed
)

737 
cout
 << "Skippingo‚extest.\n";

738 
çedTe¡s
++;

741 
cout
 << "." << 
æush
;

743 
tÙ®Te¡s
++;

746 
	}
}

748 
boŞ
 
	$RunTe¡D©aFe
(cÚ¡ *
f’ame
, cÚ¡ 
NameV®uePaœs
 &
ov”rideP¬am‘”s
, 
boŞ
 
thÜough
)

750 
s_thÜough
 = 
thÜough
;

751 
tÙ®Te¡s
 = 0, 
çedTe¡s
 = 0;

752 
	`Te¡D©aFe
(
f’ame
, 
ov”rideP¬am‘”s
, 
tÙ®Te¡s
, 
çedTe¡s
);

753 
cout
 << 
dec
 << "\nTe¡ com¶‘e. TÙ®e¡ ğ" << 
tÙ®Te¡s
 << ". Faede¡ ğ" << 
çedTe¡s
 << ".\n";

754 ià(
çedTe¡s
 != 0)

755 
cout
 << "SOME TESTS FAILED!\n";

756  
çedTe¡s
 == 0;

757 
	}
}

	@default.cpp

3 
	~"pch.h
"

4 
	~"deçuÉ.h
"

5 
	~"queue.h
"

6 
	~<time.h
>

7 
	~<memÜy
>

9 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

11 cÚ¡ 
MASH_ITERATIONS
 = 200;

12 cÚ¡ 
SALTLENGTH
 = 8;

13 cÚ¡ 
BLOCKSIZE
 = 
DeçuÉ_BlockCh”
::
Enüy±iÚ
::BLOCKSIZE;

14 cÚ¡ 
KEYLENGTH
 = 
DeçuÉ_BlockCh”
::
Enüy±iÚ
::
DEFAULT_KEYLENGTH
;

22 
	$Mash
(cÚ¡ 
by‹
 *
š
, 
size_t
 
šL’
, by‹ *
out
, size_ˆ
outL’
, 
™”©iÚs
)

24 ià(
	`By‹P»cisiÚ
(
outL’
) > 2)

25 
throw
 
	`Inv®idArgum’t
("Mash: output†egnthoo†arge");

27 
size_t
 
bufSize
 = 
	`RoundUpToMuÉËOf
(
outL’
, (size_t)
DeçuÉHashModuË
::
DIGESTSIZE
);

28 
by‹
 
b
[2];

29 
SecBy‹Block
 
	`buf
(
bufSize
);

30 
SecBy‹Block
 
	`outBuf
(
bufSize
);

31 
DeçuÉHashModuË
 
hash
;

33 
i
;

34 
i
=0; i<
outL’
; i+=
DeçuÉHashModuË
::
DIGESTSIZE
)

36 
b
[0] = (
by‹
è(
i
 >> 8);

37 
b
[1] = (
by‹
è
i
;

38 
hash
.
	`Upd©e
(
b
, 2);

39 
hash
.
	`Upd©e
(
š
, 
šL’
);

40 
hash
.
	`Fš®
(
outBuf
+
i
);

43 
™”©iÚs
-- > 1)

45 
	`memıy
(
buf
, 
outBuf
, 
bufSize
);

46 
i
=0; i<
bufSize
; i+=
DeçuÉHashModuË
::
DIGESTSIZE
)

48 
b
[0] = (
by‹
è(
i
 >> 8);

49 
b
[1] = (
by‹
è
i
;

50 
hash
.
	`Upd©e
(
b
, 2);

51 
hash
.
	`Upd©e
(
buf
, 
bufSize
);

52 
hash
.
	`Fš®
(
outBuf
+
i
);

56 
	`memıy
(
out
, 
outBuf
, 
outL’
);

57 
	}
}

59 
	$G’”©eKeyIV
(cÚ¡ 
by‹
 *
·s¥h¿£
, 
size_t
 
·s¥h¿£L’gth
, cÚ¡ by‹ *
§É
, size_ˆ
§ÉL’gth
, by‹ *
key
, by‹ *
IV
)

61 
SecBy‹Block
 
	`‹mp
(
·s¥h¿£L’gth
+
§ÉL’gth
);

62 
	`memıy
(
‹mp
, 
·s¥h¿£
, 
·s¥h¿£L’gth
);

63 
	`memıy
(
‹mp
+
·s¥h¿£L’gth
, 
§É
, 
§ÉL’gth
);

64 
SecBy‹Block
 
	`keyIV
(
KEYLENGTH
+
BLOCKSIZE
);

65 
	`Mash
(
‹mp
, 
·s¥h¿£L’gth
 + 
§ÉL’gth
, 
keyIV
, 
KEYLENGTH
+
BLOCKSIZE
, 
MASH_ITERATIONS
);

66 
	`memıy
(
key
, 
keyIV
, 
KEYLENGTH
);

67 
	`memıy
(
IV
, 
keyIV
+
KEYLENGTH
, 
BLOCKSIZE
);

68 
	}
}

72 
	gDeçuÉEnüy±Ü
::
	$DeçuÉEnüy±Ü
(cÚ¡ *
·s¥h¿£
, 
Bufã»dT¿nsfÜm©iÚ
 *
©chm’t
)

73 : 
	`ProxyF‹r
(
NULL
, 0, 0, 
©chm’t
), 
	`m_·s¥h¿£
((cÚ¡ 
by‹
 *)
·s¥h¿£
, 
	$¡¾’
(
·s¥h¿£
))

75 
	}
}

77 
	gDeçuÉEnüy±Ü
::
	$DeçuÉEnüy±Ü
(cÚ¡ 
by‹
 *
·s¥h¿£
, 
size_t
 
·s¥h¿£L’gth
, 
Bufã»dT¿nsfÜm©iÚ
 *
©chm’t
)

78 : 
	`ProxyF‹r
(
NULL
, 0, 0, 
©chm’t
), 
	$m_·s¥h¿£
(
·s¥h¿£
, 
·s¥h¿£L’gth
)

80 
	}
}

83 
	gDeçuÉEnüy±Ü
::
	$Fœ¡Put
(cÚ¡ 
by‹
 *)

86 
	`CRYPTOPP_COMPILE_ASSERT_INSTANCE
(
SALTLENGTH
 <ğ
DeçuÉHashModuË
::
DIGESTSIZE
, 1);

87 
	`CRYPTOPP_COMPILE_ASSERT_INSTANCE
(
BLOCKSIZE
 <ğ
DeçuÉHashModuË
::
DIGESTSIZE
, 2);

89 
SecBy‹Block
 
	`§É
(
DeçuÉHashModuË
::
DIGESTSIZE
), 
	`keyCheck
(DefaultHashModule::DIGESTSIZE);

90 
DeçuÉHashModuË
 
hash
;

93 
hash
.
	`Upd©e
(
m_·s¥h¿£
, m_·s¥h¿£.
	`size
());

94 
time_t
 
t
=
	`time
(0);

95 
hash
.
	`Upd©e
((
by‹
 *)&
t
, (t));

96 
şock_t
 
c
=
	`şock
();

97 
hash
.
	`Upd©e
((
by‹
 *)&
c
, (c));

98 
hash
.
	`Fš®
(
§É
);

101 
hash
.
	`Upd©e
(
m_·s¥h¿£
, m_·s¥h¿£.
	`size
());

102 
hash
.
	`Upd©e
(
§É
, 
SALTLENGTH
);

103 
hash
.
	`Fš®
(
keyCheck
);

105 
	`A‰achedT¿nsfÜm©iÚ
()->
	`Put
(
§É
, 
SALTLENGTH
);

108 
SecBy‹Block
 
	`key
(
KEYLENGTH
);

109 
SecBy‹Block
 
	`IV
(
BLOCKSIZE
);

110 
	`G’”©eKeyIV
(
m_·s¥h¿£
, m_·s¥h¿£.
	`size
(), 
§É
, 
SALTLENGTH
, 
key
, 
IV
);

112 
m_ch”
.
	`S‘KeyW™hIV
(
key
, key.
	`size
(), 
IV
);

113 
	`S‘F‹r
(
Ãw
 
	`SŒ—mT¿nsfÜm©iÚF‹r
(
m_ch”
));

115 
m_f‹r
->
	`Put
(
keyCheck
, 
BLOCKSIZE
);

116 
	}
}

118 
	gDeçuÉEnüy±Ü
::
	$La¡Put
(cÚ¡ 
by‹
 *
šSŒšg
, 
size_t
 
Ëngth
)

120 
m_f‹r
->
	`Mes§geEnd
();

121 
	}
}

125 
	gDeçuÉDeüy±Ü
::
	$DeçuÉDeüy±Ü
(cÚ¡ *
p
, 
Bufã»dT¿nsfÜm©iÚ
 *
©chm’t
, 
boŞ
 
throwExû±iÚ
)

126 : 
	`ProxyF‹r
(
NULL
, 
SALTLENGTH
+
BLOCKSIZE
, 0, 
©chm’t
)

127 , 
	`m_¡©e
(
WAITING_FOR_KEYCHECK
)

128 , 
	`m_·s¥h¿£
((cÚ¡ 
by‹
 *)
p
, 
	`¡¾’
(p))

129 , 
	$m_throwExû±iÚ
(
throwExû±iÚ
)

131 
	}
}

133 
	gDeçuÉDeüy±Ü
::
	$DeçuÉDeüy±Ü
(cÚ¡ 
by‹
 *
·s¥h¿£
, 
size_t
 
·s¥h¿£L’gth
, 
Bufã»dT¿nsfÜm©iÚ
 *
©chm’t
, 
boŞ
 
throwExû±iÚ
)

134 : 
	`ProxyF‹r
(
NULL
, 
SALTLENGTH
+
BLOCKSIZE
, 0, 
©chm’t
)

135 , 
	`m_¡©e
(
WAITING_FOR_KEYCHECK
)

136 , 
	`m_·s¥h¿£
(
·s¥h¿£
, 
·s¥h¿£L’gth
)

137 , 
	$m_throwExû±iÚ
(
throwExû±iÚ
)

139 
	}
}

141 
	gDeçuÉDeüy±Ü
::
	$Fœ¡Put
(cÚ¡ 
by‹
 *
šSŒšg
)

143 
	`CheckKey
(
šSŒšg
, inSŒšg+
SALTLENGTH
);

144 
	}
}

146 
	gDeçuÉDeüy±Ü
::
	$La¡Put
(cÚ¡ 
by‹
 *
šSŒšg
, 
size_t
 
Ëngth
)

148 ià(
m_f‹r
.
	`g‘
(è=ğ
NULL
)

150 
m_¡©e
 = 
KEY_BAD
;

151 ià(
m_throwExû±iÚ
)

152 
throw
 
	`KeyBadE¼
();

156 
m_f‹r
->
	`Mes§geEnd
();

157 
m_¡©e
 = 
WAITING_FOR_KEYCHECK
;

159 
	}
}

161 
	gDeçuÉDeüy±Ü
::
	$CheckKey
(cÚ¡ 
by‹
 *
§É
, cÚ¡ by‹ *
keyCheck
)

163 
SecBy‹Block
 
	`check
(
	`STDMAX
(()2*
BLOCKSIZE
, ()
DeçuÉHashModuË
::
DIGESTSIZE
));

165 
DeçuÉHashModuË
 
hash
;

166 
hash
.
	`Upd©e
(
m_·s¥h¿£
, m_·s¥h¿£.
	`size
());

167 
hash
.
	`Upd©e
(
§É
, 
SALTLENGTH
);

168 
hash
.
	`Fš®
(
check
);

170 
SecBy‹Block
 
	`key
(
KEYLENGTH
);

171 
SecBy‹Block
 
	`IV
(
BLOCKSIZE
);

172 
	`G’”©eKeyIV
(
m_·s¥h¿£
, m_·s¥h¿£.
	`size
(), 
§É
, 
SALTLENGTH
, 
key
, 
IV
);

174 
m_ch”
.
	`S‘KeyW™hIV
(
key
, key.
	`size
(), 
IV
);

175 
¡d
::
auto_±r
<
SŒ—mT¿nsfÜm©iÚF‹r
> 
	`deüy±Ü
(
Ãw
 
	`SŒ—mT¿nsfÜm©iÚF‹r
(
m_ch”
));

177 
deüy±Ü
->
	`Put
(
keyCheck
, 
BLOCKSIZE
);

178 
deüy±Ü
->
	`FÜûNextPut
();

179 
deüy±Ü
->
	`G‘
(
check
+
BLOCKSIZE
, BLOCKSIZE);

181 
	`S‘F‹r
(
deüy±Ü
.
	`»Ëa£
());

183 ià(!
	`V”ifyBufsEqu®
(
check
, check+
BLOCKSIZE
, BLOCKSIZE))

185 
m_¡©e
 = 
KEY_BAD
;

186 ià(
m_throwExû±iÚ
)

187 
throw
 
	`KeyBadE¼
();

190 
m_¡©e
 = 
KEY_GOOD
;

191 
	}
}

195 
DeçuÉMAC
 * 
	$NewDeçuÉEnüy±ÜMAC
(cÚ¡ 
by‹
 *
·s¥h¿£
, 
size_t
 
·s¥h¿£L’gth
)

197 
size_t
 
macKeyL’gth
 = 
DeçuÉMAC
::
	`SticG‘V®idKeyL’gth
(16);

198 
SecBy‹Block
 
	`macKey
(
macKeyL’gth
);

200 
	`Mash
(
·s¥h¿£
, 
·s¥h¿£L’gth
, 
macKey
, 
macKeyL’gth
, 1);

201  
Ãw
 
	`DeçuÉMAC
(
macKey
, 
macKeyL’gth
);

202 
	}
}

204 
	gDeçuÉEnüy±ÜW™hMAC
::
	$DeçuÉEnüy±ÜW™hMAC
(cÚ¡ *
·s¥h¿£
, 
Bufã»dT¿nsfÜm©iÚ
 *
©chm’t
)

205 : 
	`ProxyF‹r
(
NULL
, 0, 0, 
©chm’t
)

206 , 
	`m_mac
(
	`NewDeçuÉEnüy±ÜMAC
((cÚ¡ 
by‹
 *)
·s¥h¿£
, 
	$¡¾’
(
·s¥h¿£
)))

208 
	`S‘F‹r
(
Ãw
 
	`HashF‹r
(*
m_mac
,‚ew 
	`DeçuÉEnüy±Ü
(
·s¥h¿£
), 
Œue
));

209 
	}
}

211 
	gDeçuÉEnüy±ÜW™hMAC
::
	$DeçuÉEnüy±ÜW™hMAC
(cÚ¡ 
by‹
 *
·s¥h¿£
, 
size_t
 
·s¥h¿£L’gth
, 
Bufã»dT¿nsfÜm©iÚ
 *
©chm’t
)

212 : 
	`ProxyF‹r
(
NULL
, 0, 0, 
©chm’t
)

213 , 
	`m_mac
(
	$NewDeçuÉEnüy±ÜMAC
(
·s¥h¿£
, 
·s¥h¿£L’gth
))

215 
	`S‘F‹r
(
Ãw
 
	`HashF‹r
(*
m_mac
,‚ew 
	`DeçuÉEnüy±Ü
(
·s¥h¿£
, 
·s¥h¿£L’gth
), 
Œue
));

216 
	}
}

218 
	gDeçuÉEnüy±ÜW™hMAC
::
	$La¡Put
(cÚ¡ 
by‹
 *
šSŒšg
, 
size_t
 
Ëngth
)

220 
m_f‹r
->
	`Mes§geEnd
();

221 
	}
}

225 
	gDeçuÉDeüy±ÜW™hMAC
::
	$DeçuÉDeüy±ÜW™hMAC
(cÚ¡ *
·s¥h¿£
, 
Bufã»dT¿nsfÜm©iÚ
 *
©chm’t
, 
boŞ
 
throwExû±iÚ
)

226 : 
	`ProxyF‹r
(
NULL
, 0, 0, 
©chm’t
)

227 , 
	`m_mac
(
	`NewDeçuÉEnüy±ÜMAC
((cÚ¡ 
by‹
 *)
·s¥h¿£
, 
	`¡¾’
(passphrase)))

228 , 
	$m_throwExû±iÚ
(
throwExû±iÚ
)

230 
	`S‘F‹r
(
Ãw
 
	`DeçuÉDeüy±Ü
(
·s¥h¿£
, 
m_hashV”if›r
òew 
	`HashV”if›r
(*
m_mac
, 
NULL
, 
HashV”if›r
::
PUT_MESSAGE
), 
throwExû±iÚ
));

231 
	}
}

233 
	gDeçuÉDeüy±ÜW™hMAC
::
	$DeçuÉDeüy±ÜW™hMAC
(cÚ¡ 
by‹
 *
·s¥h¿£
, 
size_t
 
·s¥h¿£L’gth
, 
Bufã»dT¿nsfÜm©iÚ
 *
©chm’t
, 
boŞ
 
throwExû±iÚ
)

234 : 
	`ProxyF‹r
(
NULL
, 0, 0, 
©chm’t
)

235 , 
	`m_mac
(
	`NewDeçuÉEnüy±ÜMAC
(
·s¥h¿£
, 
·s¥h¿£L’gth
))

236 , 
	$m_throwExû±iÚ
(
throwExû±iÚ
)

238 
	`S‘F‹r
(
Ãw
 
	`DeçuÉDeüy±Ü
(
·s¥h¿£
, 
·s¥h¿£L’gth
, 
m_hashV”if›r
òew 
	`HashV”if›r
(*
m_mac
, 
NULL
, 
HashV”if›r
::
PUT_MESSAGE
), 
throwExû±iÚ
));

239 
	}
}

241 
	gDeçuÉDeüy±Ü
::
S‹
 
DeçuÉDeüy±ÜW™hMAC
::
	$Cu¼’tS‹
() const

243  
¡©ic_ÿ¡
<cÚ¡ 
DeçuÉDeüy±Ü
 *>(
m_f‹r
.
	`g‘
())->
	`Cu¼’tS‹
();

244 
	}
}

246 
boŞ
 
	gDeçuÉDeüy±ÜW™hMAC
::
	$CheckLa¡MAC
() const

248  
m_hashV”if›r
->
	`G‘La¡ResuÉ
();

249 
	}
}

251 
	gDeçuÉDeüy±ÜW™hMAC
::
	$La¡Put
(cÚ¡ 
by‹
 *
šSŒšg
, 
size_t
 
Ëngth
)

253 
m_f‹r
->
	`Mes§geEnd
();

254 ià(
m_throwExû±iÚ
 && !
	`CheckLa¡MAC
())

255 
throw
 
	`MACBadE¼
();

256 
	}
}

258 
	gNAMESPACE_END


	@default.h

1 #iâdeà
CRYPTOPP_DEFAULT_H


2 
	#CRYPTOPP_DEFAULT_H


	)

4 
	~"sha.h
"

5 
	~"hmac.h
"

6 
	~"des.h
"

7 
	~"f‹rs.h
"

8 
	~"modes.h
"

10 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

12 
DES_EDE2
 
	tDeçuÉ_BlockCh”
;

13 
SHA
 
	tDeçuÉHashModuË
;

14 
HMAC
<
	tDeçuÉHashModuË
> 
	tDeçuÉMAC
;

17 şas 
	cDeçuÉEnüy±Ü
 : 
public
 
ProxyF‹r


19 
public
:

20 
	`DeçuÉEnüy±Ü
(cÚ¡ *
·s¥h¿£
, 
Bufã»dT¿nsfÜm©iÚ
 *
©chm’t
 = 
NULL
);

21 
	`DeçuÉEnüy±Ü
(cÚ¡ 
by‹
 *
·s¥h¿£
, 
size_t
 
·s¥h¿£L’gth
, 
Bufã»dT¿nsfÜm©iÚ
 *
©chm’t
 = 
NULL
);

23 
´Ùeùed
:

24 
	`Fœ¡Put
(cÚ¡ 
by‹
 *);

25 
	`La¡Put
(cÚ¡ 
by‹
 *
šSŒšg
, 
size_t
 
Ëngth
);

27 
´iv©e
:

28 
SecBy‹Block
 
m_·s¥h¿£
;

29 
CBC_Mode
<
DeçuÉ_BlockCh”
>::
Enüy±iÚ
 
m_ch”
;

33 şas 
	cDeçuÉDeüy±Ü
 : 
public
 
ProxyF‹r


35 
public
:

36 
	`DeçuÉDeüy±Ü
(cÚ¡ *
·s¥h¿£
, 
Bufã»dT¿nsfÜm©iÚ
 *
©chm’t
 = 
NULL
, 
boŞ
 
throwExû±iÚ
=
Œue
);

37 
	`DeçuÉDeüy±Ü
(cÚ¡ 
by‹
 *
·s¥h¿£
, 
size_t
 
·s¥h¿£L’gth
, 
Bufã»dT¿nsfÜm©iÚ
 *
©chm’t
 = 
NULL
, 
boŞ
 
throwExû±iÚ
=
Œue
);

39 şas 
	cE¼
 : 
public
 
Exû±iÚ


41 
public
:

42 
	`E¼
(cÚ¡ 
¡d
::
¡ršg
 &
s
)

43 : 
	`Exû±iÚ
(
DATA_INTEGRITY_CHECK_FAILED
, 
s
) {}

45 şas 
	cKeyBadE¼
 : 
public
 
E¼
 {public: 
	`KeyBadE¼
(è: 
	`E¼
("DeçuÉDeüy±Ü: cªnÙ deüy± mes§gw™hhi ·s¥h¿£"è{}
	}
};

47 
	eS‹
 {
	gWAITING_FOR_KEYCHECK
, 
	gKEY_GOOD
, 
	gKEY_BAD
};

48 
S‹
 
	$Cu¼’tS‹
(ècÚ¡ { 
m_¡©e
;
	}
}

50 
	g´Ùeùed
:

51 
Fœ¡Put
(cÚ¡ 
by‹
 *
šSŒšg
);

52 
La¡Put
(cÚ¡ 
by‹
 *
šSŒšg
, 
size_t
 
Ëngth
);

54 
S‹
 
	gm_¡©e
;

56 
	g´iv©e
:

57 
CheckKey
(cÚ¡ 
by‹
 *
§É
, cÚ¡ by‹ *
keyCheck
);

59 
SecBy‹Block
 
	gm_·s¥h¿£
;

60 
	gCBC_Mode
<
	gDeçuÉ_BlockCh”
>::
Deüy±iÚ
 
m_ch”
;

61 
	gmemb”_±r
<
	gF‹rW™hBufã»dIÅut
> 
	gm_deüy±Ü
;

62 
boŞ
 
	gm_throwExû±iÚ
;

66 şas 
	cDeçuÉEnüy±ÜW™hMAC
 : 
public
 
ProxyF‹r


68 
public
:

69 
DeçuÉEnüy±ÜW™hMAC
(cÚ¡ *
·s¥h¿£
, 
Bufã»dT¿nsfÜm©iÚ
 *
©chm’t
 = 
NULL
);

70 
DeçuÉEnüy±ÜW™hMAC
(cÚ¡ 
by‹
 *
·s¥h¿£
, 
size_t
 
·s¥h¿£L’gth
, 
Bufã»dT¿nsfÜm©iÚ
 *
©chm’t
 = 
NULL
);

72 
	m´Ùeùed
:

73 
	$Fœ¡Put
(cÚ¡ 
by‹
 *
šSŒšg
) {}

74 
	`La¡Put
(cÚ¡ 
by‹
 *
šSŒšg
, 
size_t
 
Ëngth
);

76 
´iv©e
:

77 
memb”_±r
<
DeçuÉMAC
> 
m_mac
;

78 
	}
};

81 şas 
	cDeçuÉDeüy±ÜW™hMAC
 : 
public
 
ProxyF‹r


83 
public
:

84 şas 
	cMACBadE¼
 : 
public
 
DeçuÉDeüy±Ü
::
E¼
 {public: 
MACBadE¼
() : DefaultDecryptor::Err("DefaultDecryptorWithMAC: MAC check failed") {}};

86 
DeçuÉDeüy±ÜW™hMAC
(cÚ¡ *
·s¥h¿£
, 
Bufã»dT¿nsfÜm©iÚ
 *
©chm’t
 = 
NULL
, 
boŞ
 
throwExû±iÚ
=
Œue
);

87 
DeçuÉDeüy±ÜW™hMAC
(cÚ¡ 
by‹
 *
·s¥h¿£
, 
size_t
 
·s¥h¿£L’gth
, 
Bufã»dT¿nsfÜm©iÚ
 *
©chm’t
 = 
NULL
, 
boŞ
 
throwExû±iÚ
=
Œue
);

89 
	gDeçuÉDeüy±Ü
::
S‹
 
	$Cu¼’tS‹
() const;

90 
boŞ
 
	$CheckLa¡MAC
() const;

92 
´Ùeùed
:

93 
	$Fœ¡Put
(cÚ¡ 
by‹
 *
šSŒšg
è{
	}
}

94 
La¡Put
(cÚ¡ 
by‹
 *
šSŒšg
, 
size_t
 
Ëngth
);

96 
	g´iv©e
:

97 
memb”_±r
<
DeçuÉMAC
> 
m_mac
;

98 
HashV”if›r
 *
	gm_hashV”if›r
;

99 
boŞ
 
	gm_throwExû±iÚ
;

102 
	gNAMESPACE_END


	@des.cpp

17 
	~"pch.h
"

18 
	~"misc.h
"

19 
	~"des.h
"

21 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

23 
BlockG‘AndPut
<
	twÜd32
, 
	tBigEndŸn
> 
	tBlock
;

76 
šlše
 
	$IPERM
(
wÜd32
 &
Ëá
, wÜd32 &
right
)

78 
wÜd32
 
wÜk
;

80 
right
 = 
	`rÙlFixed
(right, 4U);

81 
wÜk
 = (
Ëá
 ^ 
right
) & 0xf0f0f0f0;

82 
Ëá
 ^ğ
wÜk
;

83 
right
 = 
	`rÙrFixed
Ôight^
wÜk
, 20U);

84 
wÜk
 = (
Ëá
 ^ 
right
) & 0xffff0000;

85 
Ëá
 ^ğ
wÜk
;

86 
right
 = 
	`rÙrFixed
Ôight^
wÜk
, 18U);

87 
wÜk
 = (
Ëá
 ^ 
right
) & 0x33333333;

88 
Ëá
 ^ğ
wÜk
;

89 
right
 = 
	`rÙrFixed
Ôight^
wÜk
, 6U);

90 
wÜk
 = (
Ëá
 ^ 
right
) & 0x00ff00ff;

91 
Ëá
 ^ğ
wÜk
;

92 
right
 = 
	`rÙlFixed
Ôight^
wÜk
, 9U);

93 
wÜk
 = (
Ëá
 ^ 
right
) & 0xaaaaaaaa;

94 
Ëá
 = 
	`rÙlFixed
Öeá^
wÜk
, 1U);

95 
right
 ^ğ
wÜk
;

96 
	}
}

98 
šlše
 
	$FPERM
(
wÜd32
 &
Ëá
, wÜd32 &
right
)

100 
wÜd32
 
wÜk
;

102 
right
 = 
	`rÙrFixed
(right, 1U);

103 
wÜk
 = (
Ëá
 ^ 
right
) & 0xaaaaaaaa;

104 
right
 ^ğ
wÜk
;

105 
Ëá
 = 
	`rÙrFixed
Öeá^
wÜk
, 9U);

106 
wÜk
 = (
Ëá
 ^ 
right
) & 0x00ff00ff;

107 
right
 ^ğ
wÜk
;

108 
Ëá
 = 
	`rÙlFixed
Öeá^
wÜk
, 6U);

109 
wÜk
 = (
Ëá
 ^ 
right
) & 0x33333333;

110 
right
 ^ğ
wÜk
;

111 
Ëá
 = 
	`rÙlFixed
Öeá^
wÜk
, 18U);

112 
wÜk
 = (
Ëá
 ^ 
right
) & 0xffff0000;

113 
right
 ^ğ
wÜk
;

114 
Ëá
 = 
	`rÙlFixed
Öeá^
wÜk
, 20U);

115 
wÜk
 = (
Ëá
 ^ 
right
) & 0xf0f0f0f0;

116 
right
 ^ğ
wÜk
;

117 
Ëá
 = 
	`rÙrFixed
Öeá^
wÜk
, 4U);

118 
	}
}

120 
	gDES
::
Ba£
::
	$UncheckedS‘Key
(cÚ¡ 
by‹
 *
u£rKey
, 
Ëngth
, cÚ¡ 
NameV®uePaœs
 &)

122 
	`As£¹V®idKeyL’gth
(
Ëngth
);

124 
	`RawS‘Key
(
	`G‘Ch”DœeùiÚ
(), 
u£rKey
);

125 
	}
}

127 #iâdeà
CRYPTOPP_IMPORTS


137 #ifdeà
nÙdef


139 
by‹
 
	g
[] = {

151 
by‹
 
	gå
[] = {

162 
by‹
 
	gei
[] = {

173 
by‹
 
	gsbox
[8][64] = {

224 
by‹
 
	gp32i
[] = {

237 cÚ¡ 
by‹
 
	gpc1
[] = {

250 cÚ¡ 
by‹
 
	gtÙrÙ
[] = {

255 cÚ¡ 
by‹
 
	gpc2
[] = {

269 cÚ¡ 
	gby‹b™
[] = {

274 
	gRawDES
::
	$RawS‘Key
(
Ch”Dœ
 
dœ
, cÚ¡ 
by‹
 *
key
)

276 
SecBy‹Block
 
	`bufãr
(56+56+8);

277 
by‹
 *cÚ¡ 
pc1m
=
bufãr
;

278 
by‹
 *cÚ¡ 
pü
=
pc1m
+56;

279 
by‹
 *cÚ¡ 
ks
=
pü
+56;

280 
i
,
j
,
l
;

281 
m
;

283 
j
=0; j<56; j++) {

284 
l
=
pc1
[
j
]-1;

285 
m
 = 
l
 & 07;

286 
pc1m
[
j
]=(
key
[
l
>>3] &

287 
by‹b™
[
m
])

290 
i
=0; i<16; i++) {

291 
	`mem£t
(
ks
,0,8);

292 
j
=0; j<56; j++)

293 
pü
[
j
] = 
pc1m
[(
l
=j+
tÙrÙ
[
i
])<(j<28? 28 : 56) ?†:†-28];

295 
j
=0; j<48; j++){

297 ià(
pü
[
pc2
[
j
]-1]){

299 
l
ğ
j
 % 6;

300 
ks
[
j
/6] |ğ
by‹b™
[
l
] >> 2;

304 
k
[2*
i
] = ((
wÜd32
)
ks
[0] << 24)

305 | ((
wÜd32
)
ks
[2] << 16)

306 | ((
wÜd32
)
ks
[4] << 8)

307 | ((
wÜd32
)
ks
[6]);

308 
k
[2*
i
+1] = ((
wÜd32
)
ks
[1] << 24)

309 | ((
wÜd32
)
ks
[3] << 16)

310 | ((
wÜd32
)
ks
[5] << 8)

311 | ((
wÜd32
)
ks
[7]);

314 ià(
dœ
==
DECRYPTION
)

315 
i
=0; i<16; i+=2)

317 
¡d
::
	`sw­
(
k
[
i
], k[32-2-i]);

318 
¡d
::
	`sw­
(
k
[
i
+1], k[32-1-i]);

320 
	}
}

322 
	gRawDES
::
	$RawProûssBlock
(
wÜd32
 &
l_
, wÜd32 &
r_
) const

324 
wÜd32
 
l
 = 
l_
, 
r
 = 
r_
;

325 cÚ¡ 
wÜd32
 *
k±r
=
k
;

327 
i
=0; i<8; i++)

329 
wÜd32
 
wÜk
 = 
	`rÙrFixed
(
r
, 4Uè^ 
k±r
[4*
i
+0];

330 
l
 ^ğ
Spbox
[6][(
wÜk
) & 0x3f]

331 ^ 
Spbox
[4][(
wÜk
 >> 8) & 0x3f]

332 ^ 
Spbox
[2][(
wÜk
 >> 16) & 0x3f]

333 ^ 
Spbox
[0][(
wÜk
 >> 24) & 0x3f];

334 
wÜk
 = 
r
 ^ 
k±r
[4*
i
+1];

335 
l
 ^ğ
Spbox
[7][(
wÜk
) & 0x3f]

336 ^ 
Spbox
[5][(
wÜk
 >> 8) & 0x3f]

337 ^ 
Spbox
[3][(
wÜk
 >> 16) & 0x3f]

338 ^ 
Spbox
[1][(
wÜk
 >> 24) & 0x3f];

340 
wÜk
 = 
	`rÙrFixed
(
l
, 4Uè^ 
k±r
[4*
i
+2];

341 
r
 ^ğ
Spbox
[6][(
wÜk
) & 0x3f]

342 ^ 
Spbox
[4][(
wÜk
 >> 8) & 0x3f]

343 ^ 
Spbox
[2][(
wÜk
 >> 16) & 0x3f]

344 ^ 
Spbox
[0][(
wÜk
 >> 24) & 0x3f];

345 
wÜk
 = 
l
 ^ 
k±r
[4*
i
+3];

346 
r
 ^ğ
Spbox
[7][(
wÜk
) & 0x3f]

347 ^ 
Spbox
[5][(
wÜk
 >> 8) & 0x3f]

348 ^ 
Spbox
[3][(
wÜk
 >> 16) & 0x3f]

349 ^ 
Spbox
[1][(
wÜk
 >> 24) & 0x3f];

352 
l_
 = 
l
; 
r_
 = 
r
;

353 
	}
}

355 
	gDES_EDE2
::
Ba£
::
	$UncheckedS‘Key
(cÚ¡ 
by‹
 *
u£rKey
, 
Ëngth
, cÚ¡ 
NameV®uePaœs
 &)

357 
	`As£¹V®idKeyL’gth
(
Ëngth
);

359 
m_des1
.
	`RawS‘Key
(
	`G‘Ch”DœeùiÚ
(), 
u£rKey
);

360 
m_des2
.
	`RawS‘Key
(
	`Rev”£Ch”Dœ
(
	`G‘Ch”DœeùiÚ
()), 
u£rKey
+8);

361 
	}
}

363 
	gDES_EDE2
::
Ba£
::
	$ProûssAndXÜBlock
(cÚ¡ 
by‹
 *
šBlock
, cÚ¡ by‹ *
xÜBlock
, by‹ *
outBlock
) const

365 
wÜd32
 
l
,
r
;

366 
Block
::
	`G‘
(
šBlock
)(
l
)(
r
);

367 
	`IPERM
(
l
,
r
);

368 
m_des1
.
	`RawProûssBlock
(
l
, 
r
);

369 
m_des2
.
	`RawProûssBlock
(
r
, 
l
);

370 
m_des1
.
	`RawProûssBlock
(
l
, 
r
);

371 
	`FPERM
(
l
,
r
);

372 
Block
::
	`Put
(
xÜBlock
, 
outBlock
)(
r
)(
l
);

373 
	}
}

375 
	gDES_EDE3
::
Ba£
::
	$UncheckedS‘Key
(cÚ¡ 
by‹
 *
u£rKey
, 
Ëngth
, cÚ¡ 
NameV®uePaœs
 &)

377 
	`As£¹V®idKeyL’gth
(
Ëngth
);

379 
m_des1
.
	`RawS‘Key
(
	`G‘Ch”DœeùiÚ
(), 
u£rKey
 + (
	`IsFÜw¬dT¿nsfÜm©iÚ
() ? 0 : 16));

380 
m_des2
.
	`RawS‘Key
(
	`Rev”£Ch”Dœ
(
	`G‘Ch”DœeùiÚ
()), 
u£rKey
 + 8);

381 
m_des3
.
	`RawS‘Key
(
	`G‘Ch”DœeùiÚ
(), 
u£rKey
 + (
	`IsFÜw¬dT¿nsfÜm©iÚ
() ? 16 : 0));

382 
	}
}

384 
	gDES_EDE3
::
Ba£
::
	$ProûssAndXÜBlock
(cÚ¡ 
by‹
 *
šBlock
, cÚ¡ by‹ *
xÜBlock
, by‹ *
outBlock
) const

386 
wÜd32
 
l
,
r
;

387 
Block
::
	`G‘
(
šBlock
)(
l
)(
r
);

388 
	`IPERM
(
l
,
r
);

389 
m_des1
.
	`RawProûssBlock
(
l
, 
r
);

390 
m_des2
.
	`RawProûssBlock
(
r
, 
l
);

391 
m_des3
.
	`RawProûssBlock
(
l
, 
r
);

392 
	`FPERM
(
l
,
r
);

393 
Block
::
	`Put
(
xÜBlock
, 
outBlock
)(
r
)(
l
);

394 
	}
}

398 
šlše
 
boŞ
 
	$CheckP¬™y
(
by‹
 
b
)

400 
a
 = 
b
 ^ (b >> 4);

401  ((
a
 ^ (a>>1) ^ (a>>2) ^ (a>>3)) & 1) == 1;

402 
	}
}

404 
boŞ
 
	gDES
::
	$CheckKeyP¬™yB™s
(cÚ¡ 
by‹
 *
key
)

406 
i
=0; i<8; i++)

407 ià(!
	`CheckP¬™y
(
key
[
i
]))

408  
çl£
;

409  
Œue
;

410 
	}
}

412 
	gDES
::
	$CÜ»ùKeyP¬™yB™s
(
by‹
 *
key
)

414 
i
=0; i<8; i++)

415 ià(!
	`CheckP¬™y
(
key
[
i
]))

416 
key
[
i
] ^= 1;

417 
	}
}

420 
	gDES
::
Ba£
::
	$ProûssAndXÜBlock
(cÚ¡ 
by‹
 *
šBlock
, cÚ¡ by‹ *
xÜBlock
, by‹ *
outBlock
) const

422 
wÜd32
 
l
,
r
;

423 
Block
::
	`G‘
(
šBlock
)(
l
)(
r
);

424 
	`IPERM
(
l
,
r
);

425 
	`RawProûssBlock
(
l
, 
r
);

426 
	`FPERM
(
l
,
r
);

427 
Block
::
	`Put
(
xÜBlock
, 
outBlock
)(
r
)(
l
);

428 
	}
}

430 
	gDES_XEX3
::
Ba£
::
	$UncheckedS‘Key
(cÚ¡ 
by‹
 *
key
, 
Ëngth
, cÚ¡ 
NameV®uePaœs
 &)

432 
	`As£¹V®idKeyL’gth
(
Ëngth
);

434 ià(!
m_des
.
	`g‘
())

435 
m_des
.
	`»£t
(
Ãw
 
DES
::
Enüy±iÚ
);

437 
	`memıy
(
m_x1
, 
key
 + (
	`IsFÜw¬dT¿nsfÜm©iÚ
(è? 0 : 16), 
BLOCKSIZE
);

438 
m_des
->
	`RawS‘Key
(
	`G‘Ch”DœeùiÚ
(), 
key
 + 8);

439 
	`memıy
(
m_x3
, 
key
 + (
	`IsFÜw¬dT¿nsfÜm©iÚ
(è? 16 : 0), 
BLOCKSIZE
);

440 
	}
}

442 
	gDES_XEX3
::
Ba£
::
	$ProûssAndXÜBlock
(cÚ¡ 
by‹
 *
šBlock
, cÚ¡ by‹ *
xÜBlock
, by‹ *
outBlock
) const

444 
	`xÜbuf
(
outBlock
, 
šBlock
, 
m_x1
, 
BLOCKSIZE
);

445 
m_des
->
	`ProûssAndXÜBlock
(
outBlock
, 
xÜBlock
, outBlock);

446 
	`xÜbuf
(
outBlock
, 
m_x3
, 
BLOCKSIZE
);

447 
	}
}

449 
	gNAMESPACE_END


	@des.h

1 #iâdeà
CRYPTOPP_DES_H


2 
	#CRYPTOPP_DES_H


	)

7 
	~"£ckey.h
"

8 
	~"£cblock.h
"

10 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

12 şas 
	cCRYPTOPP_DLL
 
RawDES


14 
public
:

15 
	`RawS‘Key
(
Ch”Dœ
 
dœeùiÚ
, cÚ¡ 
by‹
 *
u£rKey
);

16 
	$RawProûssBlock
(
wÜd32
 &
l
, wÜd32 &
r
) const;

18 
´Ùeùed
:

19 cÚ¡ 
wÜd32
 
Spbox
[8][64];

21 
FixedSizeSecBlock
<
wÜd32
, 32> 
k
;

25 
DES_Info
 : 
public
 
FixedBlockSize
<8>,…ubliø
FixedKeyL’gth
<8>

28 cÚ¡ * 
	`SticAlgÜ™hmName
() { "DES";}

29 
	}
};

36 
şass
 
	gDES
 : 
public
 
DES_Info
,…ubliø
	gBlockCh”Docum’tiÚ


38 
şass
 
CRYPTOPP_NO_VTABLE
 
	gBa£
 : 
public
 
BlockCh”Im¶
<
DES_Info
>,…ubliø
	gRawDES


40 
	gpublic
:

41 
UncheckedS‘Key
(cÚ¡ 
by‹
 *
u£rKey
, 
Ëngth
, cÚ¡ 
NameV®uePaœs
 &
·¿ms
);

42 
ProûssAndXÜBlock
(cÚ¡ 
by‹
 *
šBlock
, cÚ¡ by‹ *
xÜBlock
, by‹ *
outBlock
) const;

45 
	gpublic
:

47 
boŞ
 
CheckKeyP¬™yB™s
(cÚ¡ 
by‹
 *
key
);

49 
CÜ»ùKeyP¬™yB™s
(
by‹
 *
key
);

51 
	gBlockCh”Fš®
<
	tENCRYPTION
, 
	tBa£
> 
	tEnüy±iÚ
;

52 
	gBlockCh”Fš®
<
	tDECRYPTION
, 
	tBa£
> 
	tDeüy±iÚ
;

56 
	gDES_EDE2_Info
 : 
public
 
FixedBlockSize
<8>,…ubliø
	gFixedKeyL’gth
<16>

58 
CRYPTOPP_DLL
 cÚ¡ * 
CRYPTOPP_API
 
SticAlgÜ™hmName
() { "DES-EDE2";}

62 
şass
 
	gDES_EDE2
 : 
public
 
DES_EDE2_Info
,…ubliø
	gBlockCh”Docum’tiÚ


64 
şass
 
CRYPTOPP_DLL
 
CRYPTOPP_NO_VTABLE
 
	gBa£
 : 
public
 
BlockCh”Im¶
<
DES_EDE2_Info
>

66 
public
:

67 
UncheckedS‘Key
(cÚ¡ 
by‹
 *
u£rKey
, 
Ëngth
, cÚ¡ 
NameV®uePaœs
 &
·¿ms
);

68 
ProûssAndXÜBlock
(cÚ¡ 
by‹
 *
šBlock
, cÚ¡ by‹ *
xÜBlock
, by‹ *
outBlock
) const;

70 
	g´Ùeùed
:

71 
RawDES
 
m_des1
, 
	gm_des2
;

74 
	gpublic
:

75 
BlockCh”Fš®
<
	tENCRYPTION
, 
	tBa£
> 
	tEnüy±iÚ
;

76 
	gBlockCh”Fš®
<
	tDECRYPTION
, 
	tBa£
> 
	tDeüy±iÚ
;

80 
	gDES_EDE3_Info
 : 
public
 
FixedBlockSize
<8>,…ubliø
	gFixedKeyL’gth
<24>

82 
CRYPTOPP_DLL
 cÚ¡ * 
CRYPTOPP_API
 
SticAlgÜ™hmName
() { "DES-EDE3";}

86 
şass
 
	gDES_EDE3
 : 
public
 
DES_EDE3_Info
,…ubliø
	gBlockCh”Docum’tiÚ


88 
şass
 
CRYPTOPP_DLL
 
CRYPTOPP_NO_VTABLE
 
	gBa£
 : 
public
 
BlockCh”Im¶
<
DES_EDE3_Info
>

90 
public
:

91 
UncheckedS‘Key
(cÚ¡ 
by‹
 *
u£rKey
, 
Ëngth
, cÚ¡ 
NameV®uePaœs
 &
·¿ms
);

92 
ProûssAndXÜBlock
(cÚ¡ 
by‹
 *
šBlock
, cÚ¡ by‹ *
xÜBlock
, by‹ *
outBlock
) const;

94 
	g´Ùeùed
:

95 
RawDES
 
m_des1
, 
	gm_des2
, 
	gm_des3
;

98 
	gpublic
:

99 
BlockCh”Fš®
<
	tENCRYPTION
, 
	tBa£
> 
	tEnüy±iÚ
;

100 
	gBlockCh”Fš®
<
	tDECRYPTION
, 
	tBa£
> 
	tDeüy±iÚ
;

104 
	gDES_XEX3_Info
 : 
public
 
FixedBlockSize
<8>,…ubliø
	gFixedKeyL’gth
<24>

106 cÚ¡ *
SticAlgÜ™hmName
() { "DES-XEX3";}

110 
şass
 
	gDES_XEX3
 : 
public
 
DES_XEX3_Info
,…ubliø
	gBlockCh”Docum’tiÚ


112 
şass
 
CRYPTOPP_NO_VTABLE
 
	gBa£
 : 
public
 
BlockCh”Im¶
<
DES_XEX3_Info
>

114 
public
:

115 
UncheckedS‘Key
(cÚ¡ 
by‹
 *
u£rKey
, 
Ëngth
, cÚ¡ 
NameV®uePaœs
 &
·¿ms
);

116 
ProûssAndXÜBlock
(cÚ¡ 
by‹
 *
šBlock
, cÚ¡ by‹ *
xÜBlock
, by‹ *
outBlock
) const;

118 
	g´Ùeùed
:

119 
FixedSizeSecBlock
<
by‹
, 
	gBLOCKSIZE
> 
	gm_x1
, 
	gm_x3
;

122 
	gv®ue_±r
<
	gDES
::
Enüy±iÚ
> 
m_des
;

125 
	gpublic
:

126 
BlockCh”Fš®
<
	tENCRYPTION
, 
	tBa£
> 
	tEnüy±iÚ
;

127 
	gBlockCh”Fš®
<
	tDECRYPTION
, 
	tBa£
> 
	tDeüy±iÚ
;

130 
	gDES
::
	tEnüy±iÚ
 
	tDESEnüy±iÚ
;

131 
	gDES
::
	tDeüy±iÚ
 
	tDESDeüy±iÚ
;

133 
	gDES_EDE2
::
	tEnüy±iÚ
 
	tDES_EDE2_Enüy±iÚ
;

134 
	gDES_EDE2
::
	tDeüy±iÚ
 
	tDES_EDE2_Deüy±iÚ
;

136 
	gDES_EDE3
::
	tEnüy±iÚ
 
	tDES_EDE3_Enüy±iÚ
;

137 
	gDES_EDE3
::
	tDeüy±iÚ
 
	tDES_EDE3_Deüy±iÚ
;

139 
	gDES_XEX3
::
	tEnüy±iÚ
 
	tDES_XEX3_Enüy±iÚ
;

140 
	gDES_XEX3
::
	tDeüy±iÚ
 
	tDES_XEX3_Deüy±iÚ
;

142 
	gNAMESPACE_END


	@dessp.cpp

3 
	~"pch.h
"

5 #iâdeà
CRYPTOPP_IMPORTS


7 
	~"des.h
"

9 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

14 
	$DES_VC60WÜk¬ound
()

16 
	}
}

18 cÚ¡ 
wÜd32
 
	gRawDES
::
Spbox
[8][64] = {

93 
	gNAMESPACE_END


	@dh.cpp

3 
	~"pch.h
"

5 #iâdeà
CRYPTOPP_IMPORTS


7 
	~"dh.h
"

9 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

11 
	$DH_Te¡In¡ªtŸtiÚs
()

13 
DH
 
dh1
;

14 
DH
 
	`dh2
(
	`NuÎRNG
(), 10);

15 
	}
}

17 
	gNAMESPACE_END


	@dh.h

1 #iâdeà
CRYPTOPP_DH_H


2 
	#CRYPTOPP_DH_H


	)

7 
	~"gåüy±.h
"

9 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

12 
‹m¶©e
 <
şass
 
GROUP_PARAMETERS
, cÏs 
COFACTOR_OPTION
 = 
CPP_TYPENAME
 GROUP_PARAMETERS::
DeçuÉCoçùÜO±iÚ
>

13 
şass
 
DH_Domaš
 : 
public
 
DL_Sim¶eKeyAg»em’tDomašBa£
<
ty³Çme
 
GROUP_PARAMETERS
::
EËm’t
>

15 
DL_Sim¶eKeyAg»em’tDomašBa£
<
	tty³Çme
 
	tGROUP_PARAMETERS
::
	tEËm’t
> 
	tBa£
;

17 
public
:

18 
GROUP_PARAMETERS
 
	tGroupP¬am‘”s
;

19 
ty³Çme
 
	tGroupP¬am‘”s
::
	tEËm’t
 Element;

20 
DL_KeyAg»em’tAlgÜ™hm_DH
<
	tEËm’t
, 
	tCOFACTOR_OPTION
> 
	tDH_AlgÜ™hm
;

21 
DH_Domaš
<
	tGROUP_PARAMETERS
, 
	tCOFACTOR_OPTION
> 
	tDomaš
;

23 
	`DH_Domaš
() {}

25 
	`DH_Domaš
(cÚ¡ 
GroupP¬am‘”s
 &
·¿ms
)

26 : 
	`m_groupP¬am‘”s
(
·¿ms
) {}

28 
	`DH_Domaš
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
)

29 {
m_groupP¬am‘”s
.
	`BERDecode
(
bt
);}

31 
‹m¶©e
 <
şass
 
T2
>

32 
	`DH_Domaš
(
RªdomNumb”G’”©Ü
 &
v1
, cÚ¡ 
T2
 &
v2
)

33 {
m_groupP¬am‘”s
.
	`In™Ÿlize
(
v1
, 
v2
);}

35 
‹m¶©e
 <
şass
 
T2
, cÏs 
T3
>

36 
	`DH_Domaš
(
RªdomNumb”G’”©Ü
 &
v1
, cÚ¡ 
T2
 &
v2
, cÚ¡ 
T3
 &
v3
)

37 {
m_groupP¬am‘”s
.
	`In™Ÿlize
(
v1
, 
v2
, 
v3
);}

39 
‹m¶©e
 <
şass
 
T2
, cÏs 
T3
, cÏs 
T4
>

40 
	`DH_Domaš
(
RªdomNumb”G’”©Ü
 &
v1
, cÚ¡ 
T2
 &
v2
, cÚ¡ 
T3
 &
v3
, cÚ¡ 
T4
 &
v4
)

41 {
m_groupP¬am‘”s
.
	`In™Ÿlize
(
v1
, 
v2
, 
v3
, 
v4
);}

43 
‹m¶©e
 <
şass
 
T1
, cÏs 
T2
>

44 
	`DH_Domaš
(cÚ¡ 
T1
 &
v1
, cÚ¡ 
T2
 &
v2
)

45 {
m_groupP¬am‘”s
.
	`In™Ÿlize
(
v1
, 
v2
);}

47 
‹m¶©e
 <
şass
 
T1
, cÏs 
T2
, cÏs 
T3
>

48 
	`DH_Domaš
(cÚ¡ 
T1
 &
v1
, cÚ¡ 
T2
 &
v2
, cÚ¡ 
T3
 &
v3
)

49 {
m_groupP¬am‘”s
.
	`In™Ÿlize
(
v1
, 
v2
, 
v3
);}

51 
‹m¶©e
 <
şass
 
T1
, cÏs 
T2
, cÏs 
T3
, cÏs 
T4
>

52 
	`DH_Domaš
(cÚ¡ 
T1
 &
v1
, cÚ¡ 
T2
 &
v2
, cÚ¡ 
T3
 &
v3
, cÚ¡ 
T4
 &
v4
)

53 {
m_groupP¬am‘”s
.
	`In™Ÿlize
(
v1
, 
v2
, 
v3
, 
v4
);}

55 cÚ¡ 
GroupP¬am‘”s
 & 
	`G‘GroupP¬am‘”s
(ècÚ¡ { 
m_groupP¬am‘”s
;}

56 
GroupP¬am‘”s
 & 
	`AcûssGroupP¬am‘”s
(è{ 
m_groupP¬am‘”s
;}

58 
	`G’”©ePublicKey
(
RªdomNumb”G’”©Ü
 &
ºg
, cÚ¡ 
by‹
 *
´iv©eKey
, by‹ *
publicKey
) const

60 
Ba£
::
	`G’”©ePublicKey
(
ºg
, 
´iv©eKey
, 
publicKey
);

62 ià(
	`FIPS_140_2_Com¶ŸnûEÇbËd
())

64 
SecBy‹Block
 
	`´iv©eKey2
(
this
->
	`Priv©eKeyL’gth
());

65 
this
->
	`G’”©ePriv©eKey
(
ºg
, 
´iv©eKey2
);

67 
SecBy‹Block
 
	`publicKey2
(
this
->
	`PublicKeyL’gth
());

68 
Ba£
::
	`G’”©ePublicKey
(
ºg
, 
´iv©eKey2
, 
publicKey2
);

70 
SecBy‹Block
 
	`ag»edV®ue
(
this
->
	`Ag»edV®ueL’gth
()), 
	`ag»edV®ue2
(this->AgreedValueLength());

71 
boŞ
 
ag»ed1
 = 
this
->
	`Ag»e
(
ag»edV®ue
, 
´iv©eKey
, 
publicKey2
);

72 
boŞ
 
ag»ed2
 = 
this
->
	`Ag»e
(
ag»edV®ue2
, 
´iv©eKey2
, 
publicKey
);

74 ià(!
ag»ed1
 || !
ag»ed2
 || 
ag»edV®ue
 !ğ
ag»edV®ue2
)

75 
throw
 
	`S–fTe¡Fau»
(
this
->
	`AlgÜ™hmName
() + ":…airwise consistencyest failed");

79 
¡d
::
¡ršg
 
CRYPTOPP_API
 
	`SticAlgÜ™hmName
()

80 { 
GroupP¬am‘”s
::
	`SticAlgÜ™hmNameP»fix
(è+ 
DH_AlgÜ™hm
::
	`SticAlgÜ™hmName
();}

81 
¡d
::
¡ršg
 
	`AlgÜ™hmName
(ècÚ¡ { 
	`SticAlgÜ™hmName
();}

83 
´iv©e
:

84 cÚ¡ 
DL_KeyAg»em’tAlgÜ™hm
<
EËm’t
> & 
	`G‘KeyAg»em’tAlgÜ™hm
() const

85 { 
SšgËtÚ
<
DH_AlgÜ™hm
>().
	`Ref
();}

86 
DL_GroupP¬am‘”s
<
EËm’t
> & 
	`AcûssAb¡¿ùGroupP¬am‘”s
()

87 { 
m_groupP¬am‘”s
;}

89 
GroupP¬am‘”s
 
m_groupP¬am‘”s
;

90 
	}
};

92 
CRYPTOPP_DLL_TEMPLATE_CLASS
 
	gDH_Domaš
<
	gDL_GroupP¬am‘”s_GFP_DeçuÉSaãPrime
>;

95 
	gDH_Domaš
<
	tDL_GroupP¬am‘”s_GFP_DeçuÉSaãPrime
> 
	tDH
;

97 
	gNAMESPACE_END


	@dh2.cpp

3 
	~"pch.h
"

4 
	~"dh2.h
"

6 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

8 
	$DH2_Te¡In¡ªtŸtiÚs
()

10 
DH2
 
	`dh
(*(
Sim¶eKeyAg»em’tDomaš
*)
NULL
);

11 
	}
}

13 
boŞ
 
	gDH2
::
	$Ag»e
(
by‹
 *
ag»edV®ue
,

14 cÚ¡ 
by‹
 *
¡©icSeü‘Key
, cÚ¡ by‹ *
•hem”®Seü‘Key
,

15 cÚ¡ 
by‹
 *
¡©icOth”PublicKey
, cÚ¡ by‹ *
•hem”®Oth”PublicKey
,

16 
boŞ
 
v®id©eSticOth”PublicKey
) const

18  
d1
.
	`Ag»e
(
ag»edV®ue
, 
¡©icSeü‘Key
, 
¡©icOth”PublicKey
, 
v®id©eSticOth”PublicKey
)

19 && 
d2
.
	`Ag»e
(
ag»edV®ue
+
d1
.
	`Ag»edV®ueL’gth
(), 
•hem”®Seü‘Key
, 
•hem”®Oth”PublicKey
, 
Œue
);

20 
	}
}

22 
	gNAMESPACE_END


	@dh2.h

1 #iâdeà
CRYPTOPP_DH2_H


2 
	#CRYPTOPP_DH2_H


	)

7 
	~"üy±lib.h
"

9 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

12 şas 
	cDH2
 : 
public
 
Auth’tiÿ‹dKeyAg»em’tDomaš


14 
public
:

15 
	$DH2
(
Sim¶eKeyAg»em’tDomaš
 &
domaš
)

16 : 
	`d1
(
domaš
), 
	$d2
(
domaš
) {}

17 
	$DH2
(
Sim¶eKeyAg»em’tDomaš
 &
¡©icDomaš
, Sim¶eKeyAg»em’tDomaš &
•hem”®Domaš
)

18 : 
	`d1
(
¡©icDomaš
), 
	$d2
(
•hem”®Domaš
è{
	}
}

20 
	gCry±oP¬am‘”s
 & 
	$AcûssCry±oP¬am‘”s
(è{ 
d1
.
	`AcûssCry±oP¬am‘”s
();
	}
}

22 
	$Ag»edV®ueL’gth
() const

23 { 
d1
.
	`Ag»edV®ueL’gth
(è+ 
d2
.Ag»edV®ueL’gth();
	}
}

25 
	$SticPriv©eKeyL’gth
() const

26 { 
d1
.
	`Priv©eKeyL’gth
();
	}
}

27 
	$SticPublicKeyL’gth
() const

28 { 
d1
.
	`PublicKeyL’gth
();
	}
}

29 
	$G’”©eSticPriv©eKey
(
RªdomNumb”G’”©Ü
 &
ºg
, 
by‹
 *
´iv©eKey
) const

30 {
d1
.
	`G’”©ePriv©eKey
(
ºg
, 
´iv©eKey
);
	}
}

31 
	$G’”©eSticPublicKey
(
RªdomNumb”G’”©Ü
 &
ºg
, cÚ¡ 
by‹
 *
´iv©eKey
, by‹ *
publicKey
) const

32 {
d1
.
	`G’”©ePublicKey
(
ºg
, 
´iv©eKey
, 
publicKey
);
	}
}

33 
	$G’”©eSticKeyPaœ
(
RªdomNumb”G’”©Ü
 &
ºg
, 
by‹
 *
´iv©eKey
, by‹ *
publicKey
) const

34 {
d1
.
	`G’”©eKeyPaœ
(
ºg
, 
´iv©eKey
, 
publicKey
);
	}
}

36 
	$Ephem”®Priv©eKeyL’gth
() const

37 { 
d2
.
	`Priv©eKeyL’gth
();
	}
}

38 
	$Ephem”®PublicKeyL’gth
() const

39 { 
d2
.
	`PublicKeyL’gth
();
	}
}

40 
	$G’”©eEphem”®Priv©eKey
(
RªdomNumb”G’”©Ü
 &
ºg
, 
by‹
 *
´iv©eKey
) const

41 {
d2
.
	`G’”©ePriv©eKey
(
ºg
, 
´iv©eKey
);
	}
}

42 
	$G’”©eEphem”®PublicKey
(
RªdomNumb”G’”©Ü
 &
ºg
, cÚ¡ 
by‹
 *
´iv©eKey
, by‹ *
publicKey
) const

43 {
d2
.
	`G’”©ePublicKey
(
ºg
, 
´iv©eKey
, 
publicKey
);
	}
}

44 
	$G’”©eEphem”®KeyPaœ
(
RªdomNumb”G’”©Ü
 &
ºg
, 
by‹
 *
´iv©eKey
, by‹ *
publicKey
) const

45 {
d2
.
	`G’”©eKeyPaœ
(
ºg
, 
´iv©eKey
, 
publicKey
);
	}
}

47 
boŞ
 
	$Ag»e
(
by‹
 *
ag»edV®ue
,

48 cÚ¡ 
by‹
 *
¡©icPriv©eKey
, cÚ¡ by‹ *
•hem”®Priv©eKey
,

49 cÚ¡ 
by‹
 *
¡©icOth”PublicKey
, cÚ¡ by‹ *
•hem”®Oth”PublicKey
,

50 
boŞ
 
v®id©eSticOth”PublicKey
=
Œue
) const;

52 
´Ùeùed
:

53 
Sim¶eKeyAg»em’tDomaš
 &
d1
, &
d2
;

54 
	}
};

56 
	gNAMESPACE_END


	@dll.cpp

3 
	#CRYPTOPP_MANUALLY_INSTANTIATE_TEMPLATES


	)

4 
	#CRYPTOPP_DEFAULT_NO_DLL


	)

6 
	~"dÎ.h
"

7 #´agm¨
w¬nšg
(: 4660)

9 #ià
defšed
(
CRYPTOPP_EXPORTS
è&& defšed(
CRYPTOPP_WIN32_AVAILABLE
)

10 
	~<wšdows.h
>

13 #iâdeà
CRYPTOPP_IMPORTS


15 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

17 
‹m¶©e
<> cÚ¡ 
by‹
 
PKCS_Dige¡DecÜ©iÚ
<
SHA1
>::
decÜ©iÚ
[] = {0x30,0x21,0x30,0x09,0x06,0x05,0x2B,0x0E,0x03,0x02,0x1A,0x05,0x00,0x04,0x14
	}
};

18 
	g‹m¶©e
<> cÚ¡ 
	gPKCS_Dige¡DecÜ©iÚ
<
	gSHA1
>::
Ëngth
 = (
PKCS_Dige¡DecÜ©iÚ
<
SHA1
>::
decÜ©iÚ
);

20 
	g‹m¶©e
<> cÚ¡ 
by‹
 
	gPKCS_Dige¡DecÜ©iÚ
<
	gSHA224
>::
decÜ©iÚ
[] = {0x30,0x2d,0x30,0x0d,0x06,0x09,0x60,0x86,0x48,0x01,0x65,0x03,0x04,0x02,0x04,0x05,0x00,0x04,0x1c};

21 
	g‹m¶©e
<> cÚ¡ 
	gPKCS_Dige¡DecÜ©iÚ
<
	gSHA224
>::
Ëngth
 = (
PKCS_Dige¡DecÜ©iÚ
<
SHA224
>::
decÜ©iÚ
);

23 
	g‹m¶©e
<> cÚ¡ 
by‹
 
	gPKCS_Dige¡DecÜ©iÚ
<
	gSHA256
>::
decÜ©iÚ
[] = {0x30,0x31,0x30,0x0d,0x06,0x09,0x60,0x86,0x48,0x01,0x65,0x03,0x04,0x02,0x01,0x05,0x00,0x04,0x20};

24 
	g‹m¶©e
<> cÚ¡ 
	gPKCS_Dige¡DecÜ©iÚ
<
	gSHA256
>::
Ëngth
 = (
PKCS_Dige¡DecÜ©iÚ
<
SHA256
>::
decÜ©iÚ
);

26 
	g‹m¶©e
<> cÚ¡ 
by‹
 
	gPKCS_Dige¡DecÜ©iÚ
<
	gSHA384
>::
decÜ©iÚ
[] = {0x30,0x41,0x30,0x0d,0x06,0x09,0x60,0x86,0x48,0x01,0x65,0x03,0x04,0x02,0x02,0x05,0x00,0x04,0x30};

27 
	g‹m¶©e
<> cÚ¡ 
	gPKCS_Dige¡DecÜ©iÚ
<
	gSHA384
>::
Ëngth
 = (
PKCS_Dige¡DecÜ©iÚ
<
SHA384
>::
decÜ©iÚ
);

29 
	g‹m¶©e
<> cÚ¡ 
by‹
 
	gPKCS_Dige¡DecÜ©iÚ
<
	gSHA512
>::
decÜ©iÚ
[] = {0x30,0x51,0x30,0x0d,0x06,0x09,0x60,0x86,0x48,0x01,0x65,0x03,0x04,0x02,0x03,0x05,0x00,0x04,0x40};

30 
	g‹m¶©e
<> cÚ¡ 
	gPKCS_Dige¡DecÜ©iÚ
<
	gSHA512
>::
Ëngth
 = (
PKCS_Dige¡DecÜ©iÚ
<
SHA512
>::
decÜ©iÚ
);

32 
	g‹m¶©e
<> cÚ¡ 
by‹
 
	gEMSA2HashId
<
	gSHA
>::
id
 = 0x33;

33 
	g‹m¶©e
<> cÚ¡ 
by‹
 
	gEMSA2HashId
<
	gSHA224
>::
id
 = 0x38;

34 
	g‹m¶©e
<> cÚ¡ 
by‹
 
	gEMSA2HashId
<
	gSHA256
>::
id
 = 0x34;

35 
	g‹m¶©e
<> cÚ¡ 
by‹
 
	gEMSA2HashId
<
	gSHA384
>::
id
 = 0x36;

36 
	g‹m¶©e
<> cÚ¡ 
by‹
 
	gEMSA2HashId
<
	gSHA512
>::
id
 = 0x35;

38 
	gNAMESPACE_END


42 #ifdeà
CRYPTOPP_EXPORTS


44 
	$USING_NAMESPACE
(
Cry±oPP
)

46 #ià!(
	`defšed
(
_MSC_VER
) && (_MSC_VER < 1300))

47 
usšg
 
¡d
::
£t_Ãw_hªdËr
;

50 
PNew
 
s_pNew
 = 
NULL
;

51 
PD–‘e
 
s_pD–‘e
 = 
NULL
;

53 * 
	$New
 (
size_t
 
size
)

55 *
p
;

56 !(
p
 = 
	`m®loc
(
size
)))

57 
	`C®lNewHªdËr
();

59  
p
;

60 
	}
}

62 
	$S‘NewAndD–‘eFunùiÚPoš‹rs
()

64 *
p
 = 
NULL
;

65 
HMODULE
 
hModuË
 = 
NULL
;

66 
MEMORY_BASIC_INFORMATION
 
mbi
;

68 
Œue
)

70 
	`Vœtu®Qu”y
(
p
, &
mbi
, (mbi));

72 ià(
p
 >ğ(*)
mbi
.
Ba£Add»ss
 + mbi.
RegiÚSize
)

75 
p
 = (*)
mbi
.
Ba£Add»ss
 + mbi.
RegiÚSize
;

77 ià(!
mbi
.
AÎoÿtiÚBa£
 || mbi.AÎoÿtiÚBa£ =ğ
hModuË
)

80 
hModuË
 = 
	`HMODULE
(
mbi
.
AÎoÿtiÚBa£
);

82 
PG‘NewAndD–‘e
 
pG‘NewAndD–‘e
 = (PG‘NewAndD–‘e)
	`G‘ProcAdd»ss
(
hModuË
, "GetNewAndDeleteForCryptoPP");

83 ià(
pG‘NewAndD–‘e
)

85 
	`pG‘NewAndD–‘e
(
s_pNew
, 
s_pD–‘e
);

89 
PS‘NewAndD–‘e
 
pS‘NewAndD–‘e
 = (PS‘NewAndD–‘e)
	`G‘ProcAdd»ss
(
hModuË
, "SetNewAndDeleteFromCryptoPP");

90 ià(
pS‘NewAndD–‘e
)

92 
s_pNew
 = &
New
;

93 
s_pD–‘e
 = &
ä“
;

94 
	`pS‘NewAndD–‘e
(
s_pNew
, 
s_pD–‘e
, &
£t_Ãw_hªdËr
);

101 
hModuË
 = 
	`G‘ModuËHªdË
("msvcrtd");

102 ià(!
hModuË
)

103 
hModuË
 = 
	`G‘ModuËHªdË
("msvcrt");

104 ià(
hModuË
)

107 
s_pNew
 = (
PNew
)
	`G‘ProcAdd»ss
(
hModuË
, "??2@YAPAXI@Z");

108 
s_pD–‘e
 = (
PD–‘e
)
	`G‘ProcAdd»ss
(
hModuË
, "??3@YAXPAX@Z");

109 ià(
s_pNew
 && 
s_pD–‘e
)

113 
s_pNew
 = (
PNew
)
	`G‘ProcAdd»ss
(
hModuË
, "??2@YAPEAX_K@Z");

114 
s_pD–‘e
 = (
PD–‘e
)
	`G‘ProcAdd»ss
(
hModuË
, "??3@YAXPEAX@Z");

115 ià(
s_pNew
 && 
s_pD–‘e
)

119 
	`OuutDebugSŒšg
("Crypto++ was‚ot‡bleo obtain‚ew‡nd delete function…ointers.\n");

120 
throw
 0;

121 
	}
}

123 * 
İ”©Ü
 
	$Ãw
 (
size_t
 
size
)

125 ià(!
s_pNew
)

126 
	`S‘NewAndD–‘eFunùiÚPoš‹rs
();

128  
	`s_pNew
(
size
);

129 
	}
}

131 
İ”©Ü
 
	$d–‘e
 (* 
p
)

133 
	`s_pD–‘e
(
p
);

134 
	}
}

136 * 
İ”©Ü
 
	gÃw
 [] (
size_t
 
	gsize
)

138  
İ”©Ü
 
Ãw
 (
size
);

141 
İ”©Ü
 
	gd–‘e
 [] (* 
	gp
)

143 
İ”©Ü
 
d–‘e
 (
p
);

	@dll.h

1 #iâdeà
CRYPTOPP_DLL_H


2 
	#CRYPTOPP_DLL_H


	)

4 #ià!
defšed
(
CRYPTOPP_IMPORTS
è&& !defšed(
CRYPTOPP_EXPORTS
è&& !defšed(
CRYPTOPP_DEFAULT_NO_DLL
)

5 #ifdeà
CRYPTOPP_CONFIG_H


6 #”rÜ 
To
 
u£
 
the
 
DLL
 
v”siÚ
 
of
 
Cry±o
++, 
this
 
fe
 
mu¡
 
be
 
šşuded
 
befÜe
 
ªy
 
Ùh”
 Cry±o++ 
h—d”
 
fes
.

8 
	#CRYPTOPP_IMPORTS


	)

11 
	~"«s.h
"

12 
	~"cbcmac.h
"

13 
	~"ccm.h
"

14 
	~"cmac.h
"

15 
	~"chªÃls.h
"

16 
	~"des.h
"

17 
	~"dh.h
"

18 
	~"d§.h
"

19 
	~"ec2n.h
"

20 
	~"ecüy±o.h
"

21 
	~"eı.h
"

22 
	~"fes.h
"

23 
	~"fs140.h
"

24 
	~"gcm.h
"

25 
	~"hex.h
"

26 
	~"hmac.h
"

27 
	~"modes.h
"

28 
	~"mqueue.h
"

29 
	~"nbtheÜy.h
"

30 
	~"o¤ng.h
"

31 
	~"pkc¥ad.h
"

32 
	~"ps¤.h
"

33 
	~"¿ndpoŞ.h
"

34 
	~"r§.h
"

35 
	~"rw.h
"

36 
	~"sha.h
"

37 
	~"skjack.h
"

38 
	~"Œdloÿl.h
"

40 #ifdeà
CRYPTOPP_IMPORTS


42 #ifdeà
_DLL


44 #ifdeà
NDEBUG


45 #´agm¨
comm’t
(
lib
, "msvcrt")

47 #´agm¨
comm’t
(
lib
, "msvcrtd")

51 #´agm¨
comm’t
(
lib
, "cryptopp")

55 
	~<Ãw
>

57 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

59 #ià!(
	`defšed
(
_MSC_VER
) && (_MSC_VER < 1300))

60 
usšg
 
¡d
::
Ãw_hªdËr
;

63 * (
	tCRYPTOPP_API
 * 
	tPNew
)(
	tsize_t
);

64 (
	tCRYPTOPP_API
 * 
	tPD–‘e
)(*);

65 (
	tCRYPTOPP_API
 * 
	tPG‘NewAndD–‘e
)(
	tPNew
 &, 
	tPD–‘e
 &);

66 
	$Ãw_hªdËr
 (
	tCRYPTOPP_API
 * 
	tPS‘NewHªdËr
)(
	tÃw_hªdËr
);

67 (
	tCRYPTOPP_API
 * 
	tPS‘NewAndD–‘e
)(
	tPNew
, 
	tPD–‘e
, 
	tPS‘NewHªdËr
);

69 
NAMESPACE_END


	@dlltest.cpp

1 #iâdeà
CRYPTOPP_DLL_ONLY


2 
	#CRYPTOPP_DEFAULT_NO_DLL


	)

5 
	~"dÎ.h
"

7 
	$USING_NAMESPACE
(
Cry±oPP
)

8 
	$USING_NAMESPACE
(
¡d
)

10 
	$FIPS140_Sam¶eAµliÿtiÚ
()

12 ià(!
	`FIPS_140_2_Com¶ŸnûEÇbËd
())

14 
û¼
 << "FIPS 140-2 compliance wasurned off‡t compileime.\n";

15 
	`abÜt
();

19 ià(
	`G‘Pow”UpS–fTe¡Stus
(è!ğ
POWER_UP_SELF_TEST_PASSED
)

21 
û¼
 << "Automatic…ower-up selfest failed.\n";

22 
	`abÜt
();

24 
cout
 << "0. Automatic…ower-up selfest…assed.\n";

27 
	`SimuÏ‹Pow”UpS–fTe¡Fau»
();

28 
Œy


31 
AES
::
Enüy±iÚ
 
«s
;

34 
û¼
 << "Use of AES failedo cause‡nƒxception‡fter…ower-up selfestƒrror.\n";

35 
	`abÜt
();

37 
	`ÿtch
 (
S–fTe¡Fau»
 &
e
)

39 
cout
 << "1. Caughtƒxpectedƒxception when simulating selfest failure. Exception message follows: ";

40 
cout
 << 
e
.
	`wh©
(è<< 
’dl
;

44 
	`DoDÎPow”UpS–fTe¡
();

45 ià(
	`G‘Pow”UpS–fTe¡Stus
(è!ğ
POWER_UP_SELF_TEST_PASSED
)

47 
û¼
 << "Re-do…ower-up selfest failed.\n";

48 
	`abÜt
();

50 
cout
 << "2. Re-do…ower-up selfest…assed.\n";

53 cÚ¡ 
by‹
 
key
[] = {0x01,0x23,0x45,0x67,0x89,0xab,0xcd,0xef, 0x01,0x23,0x45,0x67,0x89,0xab,0xcd,0xef, 0x01,0x23,0x45,0x67,0x89,0xab,0xcd,0xef};

54 cÚ¡ 
by‹
 
iv
[] = {0x12,0x34,0x56,0x78,0x90,0xab,0xcd,0xef};

55 cÚ¡ 
by‹
 
¶aš‹xt
[] = {

59 
by‹
 
ch”‹xt
[24];

60 
by‹
 
deüy±ed
[24];

62 
CFB_FIPS_Mode
<
DES_EDE3
>::
Enüy±iÚ
 
’üy±iÚ_DES_EDE3_CFB
;

63 
’üy±iÚ_DES_EDE3_CFB
.
	`S‘KeyW™hIV
(
key
, (key), 
iv
);

64 
’üy±iÚ_DES_EDE3_CFB
.
	`ProûssSŒšg
(
ch”‹xt
, 
¶aš‹xt
, 24);

66 
CFB_FIPS_Mode
<
DES_EDE3
>::
Deüy±iÚ
 
deüy±iÚ_DES_EDE3_CFB
;

67 
deüy±iÚ_DES_EDE3_CFB
.
	`S‘KeyW™hIV
(
key
, (key), 
iv
);

68 
deüy±iÚ_DES_EDE3_CFB
.
	`ProûssSŒšg
(
deüy±ed
, 
ch”‹xt
, 24);

70 ià(
	`memcmp
(
¶aš‹xt
, 
deüy±ed
, 24) != 0)

72 
û¼
 << "DES-EDE3-CFB Encryption/decryption failed.\n";

73 
	`abÜt
();

75 
cout
 << "3. DES-EDE3-CFB Encryption/decryption succeeded.\n";

78 cÚ¡ 
by‹
 
mes§ge
[] = {'a', 'b', 'c'};

79 cÚ¡ 
by‹
 
ex³ùedDige¡
[] = {0xA9,0x99,0x3E,0x36,0x47,0x06,0x81,0x6A,0xBA,0x3E,0x25,0x71,0x78,0x50,0xC2,0x6C,0x9C,0xD0,0xD8,0x9D};

80 
by‹
 
dige¡
[20];

82 
SHA1
 
sha
;

83 
sha
.
	`Upd©e
(
mes§ge
, 3);

84 
sha
.
	`Fš®
(
dige¡
);

86 ià(
	`memcmp
(
dige¡
, 
ex³ùedDige¡
, 20) != 0)

88 
û¼
 << "SHA-1 hash failed.\n";

89 
	`abÜt
();

91 
cout
 << "4. SHA-1 hash succeeded.\n";

94 #ifdeà
OS_RNG_AVAILABLE


95 
AutoS“dedX917RNG
<
AES
> 
ºg
;

98 
RªdomNumb”G’”©Ü
 &
	`ºg
(
	`NuÎRNG
());

102 
DSA
::
Priv©eKey
 
d§Priv©eKey
;

103 
d§Priv©eKey
.
	`G’”©eRªdomW™hKeySize
(
ºg
, 1024);

104 
DSA
::
PublicKey
 
d§PublicKey
;

105 
d§PublicKey
.
	`AssignFrom
(
d§Priv©eKey
);

106 ià(!
d§Priv©eKey
.
	`V®id©e
(
ºg
, 3è|| !
d§PublicKey
.Validate(rng, 3))

108 
û¼
 << "DSA key generation failed.\n";

109 
	`abÜt
();

111 
cout
 << "5. DSA key generation succeeded.\n";

114 
¡d
::
¡ršg
 
’codedD§PublicKey
, 
’codedD§Priv©eKey
;

115 
d§PublicKey
.
	`DEREncode
(
	`SŒšgSšk
(
’codedD§PublicKey
).
	`Ref
());

116 
d§Priv©eKey
.
	`DEREncode
(
	`SŒšgSšk
(
’codedD§Priv©eKey
).
	`Ref
());

119 
DSA
::
Priv©eKey
 
decodedD§Priv©eKey
;

120 
decodedD§Priv©eKey
.
	`BERDecode
(
	`SŒšgStÜe
(
’codedD§Priv©eKey
).
	`Ref
());

121 
DSA
::
PublicKey
 
decodedD§PublicKey
;

122 
decodedD§PublicKey
.
	`BERDecode
(
	`SŒšgStÜe
(
’codedD§PublicKey
).
	`Ref
());

124 ià(!
decodedD§Priv©eKey
.
	`V®id©e
(
ºg
, 3è|| !
decodedD§PublicKey
.Validate(rng, 3))

126 
û¼
 << "DSA keyƒncode/decode failed.\n";

127 
	`abÜt
();

129 
cout
 << "6. DSA keyƒncode/decode succeeded.\n";

132 
by‹
 
sigÇtu»
[40];

133 
DSA
::
SigÃr
 
	`sigÃr
(
d§Priv©eKey
);

134 
	`as£¹
(
sigÃr
.
	`SigÇtu»L’gth
() == 40);

135 
sigÃr
.
	`SignMes§ge
(
ºg
, 
mes§ge
, 3, 
sigÇtu»
);

137 
DSA
::
V”if›r
 
	`v”if›r
(
d§PublicKey
);

138 ià(!
v”if›r
.
	`V”ifyMes§ge
(
mes§ge
, 3, 
sigÇtu»
, (signature)))

140 
û¼
 << "DSA signature‡nd verification failed.\n";

141 
	`abÜt
();

143 
cout
 << "7. DSA signature‡nd verification succeeded.\n";

147 
sigÇtu»
[0] ^= 1;

148 ià(
v”if›r
.
	`V”ifyMes§ge
(
mes§ge
, 3, 
sigÇtu»
, (signature)))

150 
û¼
 << "DSA signature verification failedo detect bad signature.\n";

151 
	`abÜt
();

153 
cout
 << "8. DSA signature verification successfully detected bad signature.\n";

156 
Œy


158 
ECB_Mode
<
DES_EDE3
>::
Enüy±iÚ
 
’üy±iÚ_DES_EDE3_ECB
;

159 
’üy±iÚ_DES_EDE3_ECB
.
	`S‘Key
(
key
, 5);

162 
û¼
 << "DES-EDE3 implementation did‚ot detect use of invalid key†ength.\n";

163 
	`abÜt
();

165 
	`ÿtch
 (
Inv®idArgum’t
 &
e
)

167 
cout
 << "9. Caughtƒxpectedƒxception when using invalid key†ength. Exception message follows: ";

168 
cout
 << 
e
.
	`wh©
(è<< 
’dl
;

171 
cout
 << "\nFIPS 140-2 Sample Application completed‚ormally.\n";

172 
	}
}

174 #ifdeà
CRYPTOPP_IMPORTS


176 
PNew
 
	gs_pNew
 = 
NULL
;

177 
PD–‘e
 
	gs_pD–‘e
 = 
NULL
;

179 "C" 
	$__deş¥ec
(
dÎexpÜt
è
__cdeş
 
	$S‘NewAndD–‘eFromCry±oPP
(
PNew
 
pNew
, 
PD–‘e
 
pD–‘e
, 
PS‘NewHªdËr
 
pS‘NewHªdËr
)

181 
s_pNew
 = 
pNew
;

182 
s_pD–‘e
 = 
pD–‘e
;

183 
	}
}

185 * 
__cdeş
 
İ”©Ü
 
	$Ãw
 (
size_t
 
size
)

187  
	`s_pNew
(
size
);

188 
	}
}

190 
__cdeş
 
İ”©Ü
 
	$d–‘e
 (* 
p
)

192 
	`s_pD–‘e
(
p
);

193 
	}
}

197 #ifdeà
CRYPTOPP_DLL_ONLY


199 
__cdeş
 
	$maš
()

201 
	`FIPS140_Sam¶eAµliÿtiÚ
();

203 
	}
}

	@dmac.h

1 #iâdeà
CRYPTOPP_DMAC_H


2 
	#CRYPTOPP_DMAC_H


	)

4 
	~"cbcmac.h
"

6 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

9 
‹m¶©e
 <
şass
 
T
>

10 
şass
 
CRYPTOPP_NO_VTABLE
 
DMAC_Ba£
 : 
public
 
SameKeyL’gthAs
<
T
>,…ubliø
Mes§geAuth’tiÿtiÚCode


12 
public
:

13 
¡d
::
¡ršg
 
	`SticAlgÜ™hmName
(è{ std::
	`¡ršg
("DMAC("è+ 
T
::StaticAlgorithmName() + ")";}

15 
	`CRYPTOPP_CONSTANT
(
DIGESTSIZE
=
T
::
BLOCKSIZE
)

17 
	`DMAC_Ba£
() {}

19 
	`UncheckedS‘Key
(cÚ¡ 
by‹
 *
key
, 
Ëngth
, cÚ¡ 
NameV®uePaœs
 &
·¿ms
);

20 
	`Upd©e
(cÚ¡ 
by‹
 *
šput
, 
size_t
 
Ëngth
);

21 
	`Trunÿ‹dFš®
(
by‹
 *
mac
, 
size_t
 
size
);

22 
	`Dige¡Size
(ècÚ¡ { 
DIGESTSIZE
;}

24 
´iv©e
:

25 
by‹
 *
	`G’”©eSubKeys
(cÚ¡ by‹ *
key
, 
size_t
 
keyËngth
);

27 
size_t
 
m_subkeyËngth
;

28 
SecBy‹Block
 
m_subkeys
;

29 
CBC_MAC
<
T
> 
m_mac1
;

30 
ty³Çme
 
T
::
Enüy±iÚ
 
m_f2
;

31 
m_couÁ”
;

32 
	}
};

38 
	g‹m¶©e
 <
şass
 
	gT
>

39 
şass
 
	gDMAC
 : 
public
 
Mes§geAuth’tiÿtiÚCodeFš®
<
DMAC_Ba£
<
T
> >

41 
public
:

42 
DMAC
() {}

43 
DMAC
(cÚ¡ 
by‹
 *
key
, 
size_t
 
Ëngth
=
DMAC_Ba£
<
T
>::
DEFAULT_KEYLENGTH
)

44 {
this
->
S‘Key
(
key
, 
Ëngth
);}

47 
	g‹m¶©e
 <
şass
 
	gT
>

48 
	gDMAC_Ba£
<
	gT
>::
	$UncheckedS‘Key
(cÚ¡ 
by‹
 *
key
, 
Ëngth
, cÚ¡ 
NameV®uePaœs
 &
·¿ms
)

50 
m_subkeyËngth
 = 
T
::
	`SticG‘V®idKeyL’gth
(T::
BLOCKSIZE
);

51 
m_subkeys
.
	`»size
(2*
	`UnsigÃdMš
(()
T
::
BLOCKSIZE
, 
m_subkeyËngth
));

52 
m_mac1
.
	`S‘Key
(
	`G’”©eSubKeys
(
key
, 
Ëngth
), 
m_subkeyËngth
, 
·¿ms
);

53 
m_f2
.
	`S‘Key
(
m_subkeys
+m_subkeys.
	`size
()/2, 
m_subkeyËngth
, 
·¿ms
);

54 
m_couÁ”
 = 0;

55 
m_subkeys
.
	`»size
(0);

56 
	}
}

58 
	g‹m¶©e
 <
şass
 
	gT
>

59 
	gDMAC_Ba£
<
	gT
>::
	$Upd©e
(cÚ¡ 
by‹
 *
šput
, 
size_t
 
Ëngth
)

61 
m_mac1
.
	`Upd©e
(
šput
, 
Ëngth
);

62 
m_couÁ”
 = ()((m_couÁ” + 
Ëngth
è% 
T
::
BLOCKSIZE
);

63 
	}
}

65 
	g‹m¶©e
 <
şass
 
	gT
>

66 
	gDMAC_Ba£
<
	gT
>::
	$Trunÿ‹dFš®
(
by‹
 *
mac
, 
size_t
 
size
)

68 
	`ThrowIfInv®idTrunÿ‹dSize
(
size
);

70 
by‹
 
·d
[
T
::
BLOCKSIZE
];

71 
by‹
 
·dBy‹
 = 
	`by‹
(
T
::
BLOCKSIZE
-
m_couÁ”
);

72 
	`mem£t
(
·d
, 
·dBy‹
,…adByte);

73 
m_mac1
.
	`Upd©e
(
·d
, 
·dBy‹
);

74 
m_mac1
.
	`Trunÿ‹dFš®
(
mac
, 
size
);

75 
m_f2
.
	`ProûssBlock
(
mac
);

77 
m_couÁ”
 = 0;

78 
	}
}

80 
	g‹m¶©e
 <
şass
 
	gT
>

81 
by‹
 *
	gDMAC_Ba£
<
	gT
>::
	$G’”©eSubKeys
(cÚ¡ 
by‹
 *
key
, 
size_t
 
keyËngth
)

83 
ty³Çme
 
T
::
Enüy±iÚ
 
	`ch”
(
key
, 
keyËngth
);

84 
	`mem£t
(
m_subkeys
, 0, m_subkeys.
	`size
());

85 
ch”
.
	`ProûssBlock
(
m_subkeys
);

86 
m_subkeys
[m_subkeys.
	`size
()/2 + 
T
::
BLOCKSIZE
 - 1] = 1;

87 
ch”
.
	`ProûssBlock
(
m_subkeys
+m_subkeys.
	`size
()/2);

88  
m_subkeys
;

89 
	}
}

91 
	gNAMESPACE_END


	@dsa.cpp

3 
	~"pch.h
"

5 #iâdeà
CRYPTOPP_IMPORTS


7 
	~"d§.h
"

8 
	~"nbtheÜy.h
"

10 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

12 
size_t
 
	$DSACÚv”tSigÇtu»FÜm©
(
by‹
 *
bufãr
, 
size_t
 
bufãrSize
, 
DSASigÇtu»FÜm©
 
toFÜm©
, cÚ¡ by‹ *
sigÇtu»
, size_ˆ
sigÇtu»L’
, DSASigÇtu»FÜm© 
äomFÜm©
)

14 
IÁeg”
 
r
, 
s
;

15 
SŒšgStÜe
 
	`¡Üe
(
sigÇtu»
, 
sigÇtu»L’
);

16 
A¼aySšk
 
	`sšk
(
bufãr
, 
bufãrSize
);

18 
äomFÜm©
)

20 
DSA_P1363
:

21 
r
.
	`Decode
(
¡Üe
, 
sigÇtu»L’
/2);

22 
s
.
	`Decode
(
¡Üe
, 
sigÇtu»L’
/2);

24 
DSA_DER
:

26 
BERSequ’ûDecod”
 
	`£q
(
¡Üe
);

27 
r
.
	`BERDecode
(
£q
);

28 
s
.
	`BERDecode
(
£q
);

29 
£q
.
	`Mes§geEnd
();

32 
DSA_OPENPGP
:

33 
r
.
	`O³nPGPDecode
(
¡Üe
);

34 
s
.
	`O³nPGPDecode
(
¡Üe
);

38 
toFÜm©
)

40 
DSA_P1363
:

41 
r
.
	`Encode
(
sšk
, 
bufãrSize
/2);

42 
s
.
	`Encode
(
sšk
, 
bufãrSize
/2);

44 
DSA_DER
:

46 
DERSequ’ûEncod”
 
	`£q
(
sšk
);

47 
r
.
	`DEREncode
(
£q
);

48 
s
.
	`DEREncode
(
£q
);

49 
£q
.
	`Mes§geEnd
();

52 
DSA_OPENPGP
:

53 
r
.
	`O³nPGPEncode
(
sšk
);

54 
s
.
	`O³nPGPEncode
(
sšk
);

58  (
size_t
)
sšk
.
	`TÙ®PutL’gth
();

59 
	}
}

61 
	gNAMESPACE_END


	@dsa.h

1 #iâdeà
CRYPTOPP_DSA_H


2 
	#CRYPTOPP_DSA_H


	)

7 
	~"gåüy±.h
"

9 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

13 
	eDSASigÇtu»FÜm©
 {
DSA_P1363
, 
DSA_DER
, 
DSA_OPENPGP
};

16 
size_t
 
	`DSACÚv”tSigÇtu»FÜm©
(
by‹
 *
bufãr
, size_ˆ
bufãrSize
, 
DSASigÇtu»FÜm©
 
toFÜm©
,

17 cÚ¡ 
by‹
 *
sigÇtu»
, 
size_t
 
sigÇtu»L’
, 
DSASigÇtu»FÜm©
 
äomFÜm©
);

19 #ifdeà
CRYPTOPP_MAINTAIN_BACKWARDS_COMPATIBILITY


21 
DSA
::
	tSigÃr
 
	tDSAPriv©eKey
;

22 
DSA
::
	tV”if›r
 
	tDSAPublicKey
;

24 cÚ¡ 
MIN_DSA_PRIME_LENGTH
 = 
DSA
::
MIN_PRIME_LENGTH
;

25 cÚ¡ 
MAX_DSA_PRIME_LENGTH
 = 
DSA
::
MAX_PRIME_LENGTH
;

26 cÚ¡ 
DSA_PRIME_LENGTH_MULTIPLE
 = 
DSA
::
PRIME_LENGTH_MULTIPLE
;

28 
šlše
 
boŞ
 
	$G’”©eDSAPrimes
(cÚ¡ 
by‹
 *
£ed
, 
size_t
 
£edL’gth
, &
couÁ”
, 
IÁeg”
 &
p
, 
´imeL’gth
, IÁeg” &
q
)

29 { 
DSA
::
	`G’”©ePrimes
(
£ed
, 
£edL’gth
, 
couÁ”
, 
p
, 
´imeL’gth
, 
q
);
	}
}

33 
	gNAMESPACE_END


	@eax.cpp

3 
	~"pch.h
"

4 
	~"—x.h
"

6 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

8 
EAX_Ba£
::
	$S‘KeyW™houtResync
(cÚ¡ 
by‹
 *
u£rKey
, 
size_t
 
keyËngth
, cÚ¡ 
NameV®uePaœs
 &
·¿ms
)

10 
	`AcûssMAC
().
	`S‘Key
(
u£rKey
, 
keyËngth
, 
·¿ms
);

11 
m_bufãr
.
	`New
(2*
	`AcûssMAC
().
	`TagSize
());

12 
	}
}

14 
	gEAX_Ba£
::
	$Resync
(cÚ¡ 
by‹
 *
iv
, 
size_t
 
Ën
)

16 
Mes§geAuth’tiÿtiÚCode
 &
mac
 = 
	`AcûssMAC
();

17 
blockSize
 = 
mac
.
	`TagSize
();

19 
	`mem£t
(
m_bufãr
, 0, 
blockSize
);

20 
mac
.
	`Upd©e
(
m_bufãr
, 
blockSize
);

21 
mac
.
	`C®cuÏ‹Dige¡
(
m_bufãr
+
blockSize
, 
iv
, 
Ën
);

23 
m_bufãr
[
blockSize
-1] = 1;

24 
mac
.
	`Upd©e
(
m_bufãr
, 
blockSize
);

26 
m_ùr
.
	`S‘Ch”W™hIV
(
	`AcûssMAC
().
	`AcûssCh”
(), 
m_bufãr
+
blockSize
, blockSize);

27 
	}
}

29 
size_t
 
	gEAX_Ba£
::
	$Auth’tiÿ‹Blocks
(cÚ¡ 
by‹
 *
d©a
, 
size_t
 
Ën
)

31 
	`AcûssMAC
().
	`Upd©e
(
d©a
, 
Ën
);

33 
	}
}

35 
	gEAX_Ba£
::
	$Auth’tiÿ‹La¡H—d”Block
()

37 
	`as£¹
(
m_bufã»dD©aL’gth
 == 0);

38 
Mes§geAuth’tiÿtiÚCode
 &
mac
 = 
	`AcûssMAC
();

39 
blockSize
 = 
mac
.
	`TagSize
();

41 
mac
.
	`Fš®
(
m_bufãr
);

42 
	`xÜbuf
(
m_bufãr
+
blockSize
, m_buffer, blockSize);

44 
	`mem£t
(
m_bufãr
, 0, 
blockSize
);

45 
m_bufãr
[
blockSize
-1] = 2;

46 
mac
.
	`Upd©e
(
m_bufãr
, 
blockSize
);

47 
	}
}

49 
	gEAX_Ba£
::
	$Auth’tiÿ‹La¡FoÙ”Block
(
by‹
 *
g
, 
size_t
 
macSize
)

51 
	`as£¹
(
m_bufã»dD©aL’gth
 == 0);

52 
Mes§geAuth’tiÿtiÚCode
 &
mac
 = 
	`AcûssMAC
();

53 
blockSize
 = 
mac
.
	`TagSize
();

55 
mac
.
	`Trunÿ‹dFš®
(
m_bufãr
, 
macSize
);

56 
	`xÜbuf
(
g
, 
m_bufãr
, m_bufãr+
blockSize
, 
macSize
);

57 
	}
}

59 
	gNAMESPACE_END


	@eax.h

1 #iâdeà
CRYPTOPP_EAX_H


2 
	#CRYPTOPP_EAX_H


	)

4 
	~"auth’c.h
"

5 
	~"modes.h
"

6 
	~"cmac.h
"

8 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

11 şas 
	cCRYPTOPP_NO_VTABLE
 
EAX_Ba£
 : 
public
 
Auth’tiÿ‹dSymm‘ricCh”Ba£


13 
public
:

15 
¡d
::
¡ršg
 
	$AlgÜ™hmName
() const

16 { 
	`G‘MAC
().
	`G‘Ch”
().
	`AlgÜ™hmName
(è+ 
¡d
::
	`¡ršg
("/EAX");}

17 
size_t
 
	$MšKeyL’gth
() const

18 { 
	`G‘MAC
().
	`MšKeyL’gth
();
	}
}

19 
size_t
 
	$MaxKeyL’gth
() const

20 { 
	`G‘MAC
().
	`MaxKeyL’gth
();
	}
}

21 
size_t
 
	$DeçuÉKeyL’gth
() const

22 { 
	`G‘MAC
().
	`DeçuÉKeyL’gth
();
	}
}

23 
size_t
 
	$G‘V®idKeyL’gth
(
size_t
 
n
) const

24 { 
	`G‘MAC
().
	`G‘V®idKeyL’gth
(
n
);
	}
}

25 
boŞ
 
	$IsV®idKeyL’gth
(
size_t
 
n
) const

26 { 
	`G‘MAC
().
	`IsV®idKeyL’gth
(
n
);
	}
}

27 
	$O±im®D©aAlignm’t
() const

28 { 
	`G‘MAC
().
	`O±im®D©aAlignm’t
();
	}
}

29 
IV_Requœem’t
 
	$IVRequœem’t
() const

30 { 
UNIQUE_IV
;
	}
}

31 
	$IVSize
() const

32 { 
	`G‘MAC
().
	`TagSize
();
	}
}

33 
	$MšIVL’gth
() const

34 { 0;
	}
}

35 
	$MaxIVL’gth
() const

36 { 
UINT_MAX
;
	}
}

37 
	$Dige¡Size
() const

38 { 
	`G‘MAC
().
	`TagSize
();
	}
}

39 
lwÜd
 
	$MaxH—d”L’gth
() const

40 { 
LWORD_MAX
;
	}
}

41 
lwÜd
 
	$MaxMes§geL’gth
() const

42 { 
LWORD_MAX
;
	}
}

44 
	g´Ùeùed
:

46 
boŞ
 
	$Auth’tiÿtiÚIsOnPÏš‹xt
() const

47 { 
çl£
;
	}
}

48 
	$Auth’tiÿtiÚBlockSize
() const

49 { 1;
	}
}

50 
S‘KeyW™houtResync
(cÚ¡ 
by‹
 *
u£rKey
, 
size_t
 
keyËngth
, cÚ¡ 
NameV®uePaœs
 &
·¿ms
);

51 
Resync
(cÚ¡ 
by‹
 *
iv
, 
size_t
 
Ën
);

52 
size_t
 
Auth’tiÿ‹Blocks
(cÚ¡ 
by‹
 *
d©a
, size_ˆ
Ën
);

53 
Auth’tiÿ‹La¡H—d”Block
();

54 
Auth’tiÿ‹La¡FoÙ”Block
(
by‹
 *
mac
, 
size_t
 
macSize
);

55 
	gSymm‘ricCh”
 & 
	$AcûssSymm‘ricCh”
(è{ 
m_ùr
;
	}
}

56 cÚ¡ 
	gCMAC_Ba£
 & 
	$G‘MAC
(ècÚ¡ { 
cÚ¡_ÿ¡
<
EAX_Ba£
 *>(
this
)->
	`AcûssMAC
();
	}
}

57 
vœtu®
 
	gCMAC_Ba£
 & 
AcûssMAC
() =0;

59 
	gCTR_Mode_Ex‹º®Ch”
::
Enüy±iÚ
 
m_ùr
;

63 
	g‹m¶©e
 <
şass
 
	gT_BlockCh”
, 
boŞ
 
	gT_IsEnüy±iÚ
>

64 şas 
	cEAX_Fš®
 : 
public
 
EAX_Ba£


66 
public
:

67 
¡d
::
¡ršg
 
	$SticAlgÜ™hmName
()

68 { 
T_BlockCh”
::
	`SticAlgÜ™hmName
(è+ 
¡d
::
	`¡ršg
("/EAX");}

69 
boŞ
 
	$IsFÜw¬dT¿nsfÜm©iÚ
() const

70 { 
T_IsEnüy±iÚ
;
	}
}

72 
	g´iv©e
:

73 
CMAC_Ba£
 & 
	$AcûssMAC
(è{ 
m_cmac
;
	}
}

74 
	gCMAC
<
	gT_BlockCh”
> 
	gm_cmac
;

77 #ifdeà
EAX


78 #undeà
EAX


82 
	g‹m¶©e
 <
şass
 
	gT_BlockCh”
>

83 
	gEAX
 : 
public
 
Auth’tiÿ‹dSymm‘ricCh”Docum’tiÚ


85 
EAX_Fš®
<
	tT_BlockCh”
, 
	tŒue
> 
	tEnüy±iÚ
;

86 
	gEAX_Fš®
<
	tT_BlockCh”
, 
	tçl£
> 
	tDeüy±iÚ
;

89 
	gNAMESPACE_END


	@ec2n.cpp

3 
	~"pch.h
"

5 #iâdeà
CRYPTOPP_IMPORTS


7 
	~"ec2n.h
"

8 
	~"a¢.h
"

10 
	~"®geb¿.ıp
"

11 
	~"•»comp.ıp
"

13 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

15 
EC2N
::
	$EC2N
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
)

16 : 
	`m_f›ld
(
	$BERDecodeGF2NP
(
bt
))

18 
BERSequ’ûDecod”
 
	`£q
(
bt
);

19 
m_f›ld
->
	`BERDecodeEËm’t
(
£q
, 
m_a
);

20 
m_f›ld
->
	`BERDecodeEËm’t
(
£q
, 
m_b
);

22 ià(!
£q
.
	`EndR—ched
())

24 
SecBy‹Block
 
£ed
;

25 
unu£d
;

26 
	`BERDecodeB™SŒšg
(
£q
, 
£ed
, 
unu£d
);

28 
£q
.
	`Mes§geEnd
();

29 
	}
}

31 
	gEC2N
::
	$DEREncode
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
) const

33 
m_f›ld
->
	`DEREncode
(
bt
);

34 
DERSequ’ûEncod”
 
	`£q
(
bt
);

35 
m_f›ld
->
	`DEREncodeEËm’t
(
£q
, 
m_a
);

36 
m_f›ld
->
	`DEREncodeEËm’t
(
£q
, 
m_b
);

37 
£q
.
	`Mes§geEnd
();

38 
	}
}

40 
boŞ
 
	gEC2N
::
	$DecodePošt
(
EC2N
::
Pošt
 &
P
, cÚ¡ 
by‹
 *
’codedPošt
, 
size_t
 
’codedPoštL’
) const

42 
SŒšgStÜe
 
	`¡Üe
(
’codedPošt
, 
’codedPoštL’
);

43  
	`DecodePošt
(
P
, 
¡Üe
, 
’codedPoštL’
);

44 
	}
}

46 
boŞ
 
	gEC2N
::
	$DecodePošt
(
EC2N
::
Pošt
 &
P
, 
Bufã»dT¿nsfÜm©iÚ
 &
bt
, 
size_t
 
’codedPoštL’
) const

48 
by‹
 
ty³
;

49 ià(
’codedPoštL’
 < 1 || !
bt
.
	`G‘
(
ty³
))

50  
çl£
;

52 
ty³
)

55 
P
.
id’t™y
 = 
Œue
;

56  
Œue
;

60 ià(
’codedPoštL’
 !ğ
	`EncodedPoštSize
(
Œue
))

61  
çl£
;

63 
P
.
id’t™y
 = 
çl£
;

64 
P
.
x
.
	`Decode
(
bt
, 
m_f›ld
->
	`MaxEËm’tBy‹L’gth
());

66 ià(
P
.
x
.
	`IsZ”o
())

68 
P
.
y
 = 
m_f›ld
->
	`Squ¬eRoÙ
(
m_b
);

69  
Œue
;

72 
F›ldEËm’t
 
z
 = 
m_f›ld
->
	`Squ¬e
(
P
.
x
);

73 
	`as£¹
(
P
.
x
 =ğ
m_f›ld
->
	`Squ¬eRoÙ
(
z
));

74 
P
.
y
 = 
m_f›ld
->
	`Divide
(m_f›ld->
	`Add
(m_f›ld->
	`MuÉly
(
z
, m_f›ld->Add(P.
x
, 
m_a
)), 
m_b
), z);

75 
	`as£¹
(
P
.
x
 =ğ
m_f›ld
->
	`SubŒaù
(m_f›ld->
	`Divide
(m_f›ld->SubŒaù(m_f›ld->
	`MuÉly
(P.
y
, 
z
), 
m_b
), z), 
m_a
));

76 
z
 = 
m_f›ld
->
	`SŞveQuad¿ticEqu©iÚ
(
P
.
y
);

77 
	`as£¹
(
m_f›ld
->
	`Add
(m_f›ld->
	`Squ¬e
(
z
), zè=ğ
P
.
y
);

78 
z
.
	`S‘CÛffic›Á
(0, 
ty³
 & 1);

80 
P
.
y
 = 
m_f›ld
->
	`MuÉly
(
z
, P.
x
);

81  
Œue
;

85 ià(
’codedPoštL’
 !ğ
	`EncodedPoštSize
(
çl£
))

86  
çl£
;

88 
Ën
 = 
m_f›ld
->
	`MaxEËm’tBy‹L’gth
();

89 
P
.
id’t™y
 = 
çl£
;

90 
P
.
x
.
	`Decode
(
bt
, 
Ën
);

91 
P
.
y
.
	`Decode
(
bt
, 
Ën
);

92  
Œue
;

95  
çl£
;

97 
	}
}

99 
	gEC2N
::
	$EncodePošt
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
, cÚ¡ 
Pošt
 &
P
, 
boŞ
 
com´es£d
) const

101 ià(
P
.
id’t™y
)

102 
	`NuÎStÜe
().
	`T¿nsãrTo
(
bt
, 
	`EncodedPoštSize
(
com´es£d
));

103 ià(
com´es£d
)

105 
bt
.
	`Put
(2 + (!
P
.
x
 ? 0 : 
m_f›ld
->
	`Divide
(P.
y
, P.x).
	`G‘B™
(0)));

106 
P
.
x
.
	`Encode
(
bt
, 
m_f›ld
->
	`MaxEËm’tBy‹L’gth
());

110 
Ën
 = 
m_f›ld
->
	`MaxEËm’tBy‹L’gth
();

111 
bt
.
	`Put
(4);

112 
P
.
x
.
	`Encode
(
bt
, 
Ën
);

113 
P
.
y
.
	`Encode
(
bt
, 
Ën
);

115 
	}
}

117 
	gEC2N
::
	$EncodePošt
(
by‹
 *
’codedPošt
, cÚ¡ 
Pošt
 &
P
, 
boŞ
 
com´es£d
) const

119 
A¼aySšk
 
	`sšk
(
’codedPošt
, 
	`EncodedPoštSize
(
com´es£d
));

120 
	`EncodePošt
(
sšk
, 
P
, 
com´es£d
);

121 
	`as£¹
(
sšk
.
	`TÙ®PutL’gth
(è=ğ
	`EncodedPoštSize
(
com´es£d
));

122 
	}
}

124 
	gEC2N
::
Pošt
 
EC2N
::
	$BERDecodePošt
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
) const

126 
SecBy‹Block
 
¡r
;

127 
	`BERDecodeOù‘SŒšg
(
bt
, 
¡r
);

128 
Pošt
 
P
;

129 ià(!
	`DecodePošt
(
P
, 
¡r
, sŒ.
	`size
()))

130 
	`BERDecodeE¼Ü
();

131  
P
;

132 
	}
}

134 
	gEC2N
::
	$DEREncodePošt
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
, cÚ¡ 
Pošt
 &
P
, 
boŞ
 
com´es£d
) const

136 
SecBy‹Block
 
	`¡r
(
	`EncodedPoštSize
(
com´es£d
));

137 
	`EncodePošt
(
¡r
, 
P
, 
com´es£d
);

138 
	`DEREncodeOù‘SŒšg
(
bt
, 
¡r
);

139 
	}
}

141 
boŞ
 
	gEC2N
::
	$V®id©eP¬am‘”s
(
RªdomNumb”G’”©Ü
 &
ºg
, 
Ëv–
) const

143 
boŞ
 
·ss
 = !!
m_b
;

144 
·ss
 =…as && 
m_a
.
	`CÛffic›ÁCouÁ
(è<ğ
m_f›ld
->
	`MaxEËm’tB™L’gth
();

145 
·ss
 =…as && 
m_b
.
	`CÛffic›ÁCouÁ
(è<ğ
m_f›ld
->
	`MaxEËm’tB™L’gth
();

147 ià(
Ëv–
 >= 1)

148 
·ss
 =…as && 
m_f›ld
->
	`G‘Modulus
().
	`IsI¼educibË
();

150  
·ss
;

151 
	}
}

153 
boŞ
 
	gEC2N
::
	$V”ifyPošt
(cÚ¡ 
Pošt
 &
P
) const

155 cÚ¡ 
F›ldEËm’t
 &
x
 = 
P
.x, &
y
 = P.y;

156  
P
.
id’t™y
 ||

157 (
x
.
	`CÛffic›ÁCouÁ
(è<ğ
m_f›ld
->
	`MaxEËm’tB™L’gth
()

158 && 
y
.
	`CÛffic›ÁCouÁ
(è<ğ
m_f›ld
->
	`MaxEËm’tB™L’gth
()

159 && !(((
x
+
m_a
)*x*x+
m_b
-(x+
y
)*y)%
m_f›ld
->
	`G‘Modulus
()));

160 
	}
}

162 
boŞ
 
	gEC2N
::
	$Equ®
(cÚ¡ 
Pošt
 &
P
, cÚ¡ Pošˆ&
Q
) const

164 ià(
P
.
id’t™y
 && 
Q
.identity)

165  
Œue
;

167 ià(
P
.
id’t™y
 && !
Q
.identity)

168  
çl£
;

170 ià(!
P
.
id’t™y
 && 
Q
.identity)

171  
çl£
;

173  (
m_f›ld
->
	`Equ®
(
P
.
x
,
Q
.xè&& m_f›ld->Equ®(P.
y
,Q.y));

174 
	}
}

176 cÚ¡ 
	gEC2N
::
Pošt
& 
EC2N
::
	$Id’t™y
() const

178  
SšgËtÚ
<
Pošt
>().
	`Ref
();

179 
	}
}

181 cÚ¡ 
	gEC2N
::
Pošt
& 
EC2N
::
	$Inv”£
(cÚ¡ 
Pošt
 &
P
) const

183 ià(
P
.
id’t™y
)

184  
P
;

187 
m_R
.
id’t™y
 = 
çl£
;

188 
m_R
.
y
 = 
m_f›ld
->
	`Add
(
P
.
x
, P.y);

189 
m_R
.
x
 = 
P
.x;

190  
m_R
;

192 
	}
}

194 cÚ¡ 
	gEC2N
::
Pošt
& 
EC2N
::
	$Add
(cÚ¡ 
Pošt
 &
P
, cÚ¡ Pošˆ&
Q
) const

196 ià(
P
.
id’t™y
è 
Q
;

197 ià(
Q
.
id’t™y
è 
P
;

198 ià(
	`Equ®
(
P
, 
Q
)è 
	`DoubË
(P);

199 ià(
m_f›ld
->
	`Equ®
(
P
.
x
, 
Q
.xè&& m_f›ld->Equ®(P.
y
, m_f›ld->
	`Add
(Q.x, Q.y))è 
	`Id’t™y
();

201 
F›ldEËm’t
 
t
 = 
m_f›ld
->
	`Add
(
P
.
y
, 
Q
.y);

202 
t
 = 
m_f›ld
->
	`Divide
Ñ, m_f›ld->
	`Add
(
P
.
x
, 
Q
.x));

203 
F›ldEËm’t
 
x
 = 
m_f›ld
->
	`Squ¬e
(
t
);

204 
m_f›ld
->
	`AccumuÏ‹
(
x
, 
t
);

205 
m_f›ld
->
	`AccumuÏ‹
(
x
, 
Q
.x);

206 
m_f›ld
->
	`AccumuÏ‹
(
x
, 
m_a
);

207 
m_R
.
y
 = 
m_f›ld
->
	`Add
(
P
.y, m_f›ld->
	`MuÉly
(
t
, 
x
));

208 
m_f›ld
->
	`AccumuÏ‹
(
x
, 
P
.x);

209 
m_f›ld
->
	`AccumuÏ‹
(
m_R
.
y
, 
x
);

211 
m_R
.
x
.
	`sw­
(x);

212 
m_R
.
id’t™y
 = 
çl£
;

213  
m_R
;

214 
	}
}

216 cÚ¡ 
	gEC2N
::
Pošt
& 
EC2N
::
	$DoubË
(cÚ¡ 
Pošt
 &
P
) const

218 ià(
P
.
id’t™y
)  P;

219 ià(!
m_f›ld
->
	`IsUn™
(
P
.
x
)è 
	`Id’t™y
();

221 
F›ldEËm’t
 
t
 = 
m_f›ld
->
	`Divide
(
P
.
y
, P.
x
);

222 
m_f›ld
->
	`AccumuÏ‹
(
t
, 
P
.
x
);

223 
m_R
.
y
 = 
m_f›ld
->
	`Squ¬e
(
P
.
x
);

224 
m_R
.
x
 = 
m_f›ld
->
	`Squ¬e
(
t
);

225 
m_f›ld
->
	`AccumuÏ‹
(
m_R
.
x
, 
t
);

226 
m_f›ld
->
	`AccumuÏ‹
(
m_R
.
x
, 
m_a
);

227 
m_f›ld
->
	`AccumuÏ‹
(
m_R
.
y
, m_f›ld->
	`MuÉly
(
t
, m_R.
x
));

228 
m_f›ld
->
	`AccumuÏ‹
(
m_R
.
y
, m_R.
x
);

230 
m_R
.
id’t™y
 = 
çl£
;

231  
m_R
;

232 
	}
}

290 
	gNAMESPACE_END


	@ec2n.h

1 #iâdeà
CRYPTOPP_EC2N_H


2 
	#CRYPTOPP_EC2N_H


	)

4 
	~"gf2n.h
"

5 
	~"•»comp.h
"

6 
	~"sm¬Œ.h
"

7 
	~"pubkey.h
"

9 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

12 
CRYPTOPP_DLL
 
EC2NPošt


14 
	`EC2NPošt
(è: 
	`id’t™y
(
Œue
) {}

15 
	`EC2NPošt
(cÚ¡ 
PŞynomŸlMod2
 &
x
, cÚ¡ PŞynomŸlMod2 &
y
)

16 : 
	`id’t™y
(
çl£
), 
	`x
(
x
), 
	`y
(
y
) {}

18 
boŞ
 
İ”©Ü
==(cÚ¡ 
EC2NPošt
 &
t
) const

19 { (
id’t™y
 && 
t
.id’t™yè|| (!id’t™y && !t.id’t™y && 
x
=ñ.x && 
y
==t.y);}

20 
boŞ
 
İ”©Ü
< (cÚ¡ 
EC2NPošt
 &
t
) const

21 { 
id’t™y
 ? !
t
.id’t™y : (!t.id’t™y && (
x
<t.x || (x=ñ.x && 
y
<t.y)));}

23 
boŞ
 
id’t™y
;

24 
PŞynomŸlMod2
 
x
, 
y
;

25 
	}
};

27 
CRYPTOPP_DLL_TEMPLATE_CLASS
 
	gAb¡¿ùGroup
<
	gEC2NPošt
>;

30 
şass
 
CRYPTOPP_DLL
 
	gEC2N
 : 
public
 
Ab¡¿ùGroup
<
EC2NPošt
>

32 
public
:

33 
GF2NP
 
	tF›ld
;

34 
	gF›ld
::
	tEËm’t
 
	tF›ldEËm’t
;

35 
EC2NPošt
 
	tPošt
;

37 
EC2N
() {}

38 
EC2N
(cÚ¡ 
F›ld
 &
f›ld
, cÚ¡ F›ld::
EËm’t
 &
a
, cÚ¡ F›ld::EËm’ˆ&
b
)

39 : 
m_f›ld
(
f›ld
), 
m_a
(
a
), 
m_b
(
b
) {}

42 
EC2N
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
);

45 
DEREncode
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
) const;

47 
boŞ
 
Equ®
(cÚ¡ 
Pošt
 &
P
, cÚ¡ Pošˆ&
Q
) const;

48 cÚ¡ 
	gPošt
& 
Id’t™y
() const;

49 cÚ¡ 
	gPošt
& 
Inv”£
(cÚ¡ 
Pošt
 &
P
) const;

50 
boŞ
 
Inv”siÚIsFa¡
(ècÚ¡ { 
	gŒue
;}

51 cÚ¡ 
	gPošt
& 
Add
(cÚ¡ 
Pošt
 &
P
, cÚ¡ Pošˆ&
Q
) const;

52 cÚ¡ 
	gPošt
& 
DoubË
(cÚ¡ 
Pošt
 &
P
) const;

54 
Pošt
 
MuÉly
(cÚ¡ 
IÁeg”
 &
k
, cÚ¡ Pošˆ&
P
) const

55 { 
SÿÏrMuÉly
(
P
, 
k
);}

56 
Pošt
 
CasÿdeMuÉly
(cÚ¡ 
IÁeg”
 &
k1
, cÚ¡ Pošˆ&
P
, cÚ¡ IÁeg” &
k2
, cÚ¡ Pošˆ&
Q
) const

57 { 
CasÿdeSÿÏrMuÉly
(
P
, 
k1
, 
Q
, 
k2
);}

59 
boŞ
 
V®id©eP¬am‘”s
(
RªdomNumb”G’”©Ü
 &
ºg
, 
Ëv–
=3) const;

60 
boŞ
 
V”ifyPošt
(cÚ¡ 
Pošt
 &
P
) const;

62 
EncodedPoštSize
(
boŞ
 
com´es£d
 = 
çl£
) const

63 { 1 + (
com´es£d
?1:2)*
m_f›ld
->
MaxEËm’tBy‹L’gth
();}

65 
boŞ
 
DecodePošt
(
Pošt
 &
P
, 
Bufã»dT¿nsfÜm©iÚ
 &
bt
, 
size_t
 
Ën
) const;

66 
boŞ
 
DecodePošt
(
Pošt
 &
P
, cÚ¡ 
by‹
 *
’codedPošt
, 
size_t
 
Ën
) const;

67 
EncodePošt
(
by‹
 *
’codedPošt
, cÚ¡ 
Pošt
 &
P
, 
boŞ
 
com´es£d
) const;

68 
EncodePošt
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
, cÚ¡ 
Pošt
 &
P
, 
boŞ
 
com´es£d
) const;

70 
Pošt
 
BERDecodePošt
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
) const;

71 
DEREncodePošt
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
, cÚ¡ 
Pošt
 &
P
, 
boŞ
 
com´es£d
) const;

73 
IÁeg”
 
F›ldSize
(ècÚ¡ { 
	gIÁeg”
::
Pow”2
(
m_f›ld
->
MaxEËm’tB™L’gth
());}

74 cÚ¡ 
	gF›ld
 & 
G‘F›ld
(ècÚ¡ { *
	gm_f›ld
;}

75 cÚ¡ 
	gF›ldEËm’t
 & 
G‘A
(ècÚ¡ { 
	gm_a
;}

76 cÚ¡ 
	gF›ldEËm’t
 & 
G‘B
(ècÚ¡ { 
	gm_b
;}

78 
boŞ
 
	gİ”©Ü
==(cÚ¡ 
EC2N
 &
rhs
) const

79 { 
G‘F›ld
(è=ğ
rhs
.G‘F›ld(è&& 
m_a
 =ğrhs.m_¨&& 
m_b
 ==„hs.m_b;}

81 
	g´iv©e
:

82 
şÚabË_±r
<
F›ld
> 
m_f›ld
;

83 
F›ldEËm’t
 
	gm_a
, 
	gm_b
;

84 
mubË
 
Pošt
 
	gm_R
;

87 
CRYPTOPP_DLL_TEMPLATE_CLASS
 
	gDL_FixedBa£P»computiÚIm¶
<
	gEC2N
::
Pošt
>;

88 
CRYPTOPP_DLL_TEMPLATE_CLASS
 
	gDL_GroupP»computiÚ
<
	gEC2N
::
Pošt
>;

90 
	g‹m¶©e
 <
şass
 
	gT
> cÏs 
	gEcP»computiÚ
;

93 
	g‹m¶©e
<> 
şass
 
	gEcP»computiÚ
<
	gEC2N
> : 
public
 
DL_GroupP»computiÚ
<
EC2N
::
Pošt
>

95 
public
:

96 
EC2N
 
	tEÎticCurve
;

99 cÚ¡ 
	gAb¡¿ùGroup
<
	gEËm’t
> & 
G‘Group
(ècÚ¡ { 
	gm_ec
;}

100 
EËm’t
 
BERDecodeEËm’t
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
ècÚ¡ { 
	gm_ec
.
BERDecodePošt
(bt);}

101 
DEREncodeEËm’t
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
, cÚ¡ 
EËm’t
 &
v
ècÚ¡ {
	gm_ec
.
DEREncodePošt
(bt, v, 
çl£
);}

104 
S‘Curve
(cÚ¡ 
EC2N
 &
ec
è{
	gm_ec
 =ƒc;}

105 cÚ¡ 
	gEC2N
 & 
G‘Curve
(ècÚ¡ { 
	gm_ec
;}

107 
	g´iv©e
:

108 
EC2N
 
m_ec
;

111 
	gNAMESPACE_END


	@eccrypto.cpp

3 
	~"pch.h
"

5 #iâdeà
CRYPTOPP_IMPORTS


7 
	~"ecüy±o.h
"

8 
	~"nbtheÜy.h
"

9 
	~"oids.h
"

10 
	~"hex.h
"

11 
	~"¬gÇmes.h
"

12 
	~"ec2n.h
"

14 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

17 
	$ECDSA_Te¡In¡ªtŸtiÚs
()

19 
ECDSA
<
EC2N
>::
SigÃr
 
t1
;

20 
ECDSA
<
EC2N
>::
V”if›r
 
	`t2
(
t1
);

21 
ECNR
<
ECP
>::
SigÃr
 
t3
;

22 
ECNR
<
ECP
>::
V”if›r
 
	`t4
(
t3
);

23 
ECIES
<
ECP
>::
Enüy±Ü
 
t5
;

24 
ECIES
<
EC2N
>::
Deüy±Ü
 
t6
;

25 
ECDH
<
ECP
>::
Domaš
 
t7
;

26 
ECMQV
<
ECP
>::
Domaš
 
t8
;

27 
	}
}

31 
IÁeg”
 
	$CÚv”tToIÁeg”
(cÚ¡ 
PŞynomŸlMod2
 &
x
)

33 
l
 = 
x
.
	`By‹CouÁ
();

34 
SecBy‹Block
 
	`‹mp
(
l
);

35 
x
.
	`Encode
(
‹mp
, 
l
);

36  
	`IÁeg”
(
‹mp
, 
l
);

37 
	}
}

39 
šlše
 
IÁeg”
 
	$CÚv”tToIÁeg”
(cÚ¡ 
IÁeg”
 &
x
)

41  
x
;

42 
	}
}

44 
boŞ
 
	$CheckMOVCÚd™iÚ
(cÚ¡ 
IÁeg”
 &
q
, cÚ¡ IÁeg” &
r
)

47 
IÁeg”
 
t
 = 1;

48 
n
 = 
q
.
	`IsEv’
(è? 1 : q.
	`B™CouÁ
(), 
m
 = 
r
.BitCount();

50 
i
=
n
; 
	`Disü‘eLogWÜkFaùÜ
(i)<
m
/2; i+=n)

52 ià(
q
.
	`IsEv’
())

53 
t
 = (t+t)%
r
;

55 
t
 = (t*
q
)%
r
;

56 ià(
t
 == 1)

57  
çl£
;

59  
Œue
;

60 
	}
}

64 
	g‹m¶©e
 <
şass
 
	gT
> 
	gEcRecomm’dedP¬am‘”s
;

66 
	g‹m¶©e
<> 
	gEcRecomm’dedP¬am‘”s
<
	gEC2N
>

68 
EcRecomm’dedP¬am‘”s
(cÚ¡ 
OID
 &
oid
, 
t2
, 
t3
, 
t4
, cÚ¡ *
a
, cÚ¡ *
b
, cÚ¡ *
g
, cÚ¡ *
n
, 
h
)

69 : 
oid
(oid), 
t0
(0), 
t1
(0), 
t2
Ñ2), 
t3
Ñ3), 
t4
Ñ4), 
a
×), 
b
(b), 
g
(g), 
n
Ò), 
h
(h) {}

70 
EcRecomm’dedP¬am‘”s
(cÚ¡ 
OID
 &
oid
, 
t0
, 
t1
, 
t2
, 
t3
, 
t4
, cÚ¡ *
a
, cÚ¡ *
b
, cÚ¡ *
g
, cÚ¡ *
n
, 
h
)

71 : 
oid
(oid), 
t0
Ñ0), 
t1
Ñ1), 
t2
Ñ2), 
t3
Ñ3), 
t4
Ñ4), 
a
×), 
b
(b), 
g
(g), 
n
Ò), 
h
(h) {}

72 
EC2N
 *
NewEC
() const

74 
SŒšgSourû
 
ssA
(
a
, 
Œue
, 
Ãw
 
HexDecod”
);

75 
SŒšgSourû
 
ssB
(
b
, 
Œue
, 
Ãw
 
HexDecod”
);

76 ià(
	gt0
 == 0)

77  
Ãw
 
EC2N
(
GF2NT
(
t2
, 
t3
, 
t4
), EC2N::
F›ldEËm’t
(
ssA
, (
size_t
)ssA.
MaxR‘r›vabË
()), EC2N::F›ldEËm’t(
ssB
, (size_t)ssB.MaxRetrievable()));

79  
Ãw
 
EC2N
(
GF2NPP
(
t0
, 
t1
, 
t2
, 
t3
, 
t4
), EC2N::
F›ldEËm’t
(
ssA
, (
size_t
)ssA.
MaxR‘r›vabË
()), EC2N::F›ldEËm’t(
ssB
, (size_t)ssB.MaxRetrievable()));

82 
OID
 
	goid
;

83 
	gt0
, 
	gt1
, 
	gt2
, 
	gt3
, 
	gt4
;

84 cÚ¡ *
	ga
, *
	gb
, *
	gg
, *
	gn
;

85 
	gh
;

88 
	g‹m¶©e
<> 
	gEcRecomm’dedP¬am‘”s
<
	gECP
>

90 
EcRecomm’dedP¬am‘”s
(cÚ¡ 
OID
 &
oid
, cÚ¡ *
p
, cÚ¡ *
a
, cÚ¡ *
b
, cÚ¡ *
g
, cÚ¡ *
n
, 
h
)

91 : 
oid
(oid), 
p
Õ), 
a
×), 
b
(b), 
g
(g), 
n
Ò), 
h
(h) {}

92 
ECP
 *
NewEC
() const

94 
SŒšgSourû
 
ssP
(
p
, 
Œue
, 
Ãw
 
HexDecod”
);

95 
SŒšgSourû
 
ssA
(
a
, 
Œue
, 
Ãw
 
HexDecod”
);

96 
SŒšgSourû
 
ssB
(
b
, 
Œue
, 
Ãw
 
HexDecod”
);

97  
Ãw
 
ECP
(
IÁeg”
(
ssP
, (
size_t
)ssP.
MaxR‘r›vabË
()), ECP::
F›ldEËm’t
(
ssA
, (size_t)ssA.MaxR‘r›vabË()), ECP::F›ldEËm’t(
ssB
, (size_t)ssB.MaxRetrievable()));

100 
OID
 
	goid
;

101 cÚ¡ *
	gp
;

102 cÚ¡ *
	ga
, *
	gb
, *
	gg
, *
	gn
;

103 
	gh
;

106 
	sOIDLessThª


108 
	m‹m¶©e
 <
ty³Çme
 
	mT
>

109 
šlše
 
boŞ
 
İ”©Ü
()(cÚ¡ 
	mEcRecomm’dedP¬am‘”s
<
	mT
>& 
	ma
, cÚ¡ 
	mOID
& 
	mb
è{‡.
	moid
 < b;}

110 
	m‹m¶©e
 <
ty³Çme
 
	mT
>

111 
šlše
 
boŞ
 
İ”©Ü
()(cÚ¡ 
	mOID
& 
	ma
, cÚ¡ 
	mEcRecomm’dedP¬am‘”s
<
	mT
>& 
	mb
è{‡ < b.
	moid
;}

112 
	m‹m¶©e
 <
ty³Çme
 
	mT
>

113 
šlše
 
boŞ
 
İ”©Ü
()(cÚ¡ 
	mEcRecomm’dedP¬am‘”s
<
	mT
>& 
	ma
, cÚ¡ EcRecomm’dedP¬am‘”s<T>& 
	mb
è{‡.
	moid
 < b.oid;}

116 
G‘Recomm’dedP¬am‘”s
(cÚ¡ 
EcRecomm’dedP¬am‘”s
<
EC2N
> *&
begš
, cÚ¡ EcRecomm’dedP¬am‘”s<EC2N> *&
’d
)

119 cÚ¡ 
	gEcRecomm’dedP¬am‘”s
<
	gEC2N
> 
	g»c
[] = {

120 
EcRecomm’dedP¬am‘”s
<
EC2N
>(
ASN1
::
£ù163k1
(),

127 
EcRecomm’dedP¬am‘”s
<
EC2N
>(
ASN1
::
£ù163r1
(),

134 
EcRecomm’dedP¬am‘”s
<
EC2N
>(
ASN1
::
£ù239k1
(),

141 
EcRecomm’dedP¬am‘”s
<
EC2N
>(
ASN1
::
£ù113r1
(),

148 
EcRecomm’dedP¬am‘”s
<
EC2N
>(
ASN1
::
£ù113r2
(),

155 
EcRecomm’dedP¬am‘”s
<
EC2N
>(
ASN1
::
£ù163r2
(),

162 
EcRecomm’dedP¬am‘”s
<
EC2N
>(
ASN1
::
£ù283k1
(),

169 
EcRecomm’dedP¬am‘”s
<
EC2N
>(
ASN1
::
£ù283r1
(),

176 
EcRecomm’dedP¬am‘”s
<
EC2N
>(
ASN1
::
£ù131r1
(),

183 
EcRecomm’dedP¬am‘”s
<
EC2N
>(
ASN1
::
£ù131r2
(),

190 
EcRecomm’dedP¬am‘”s
<
EC2N
>(
ASN1
::
£ù193r1
(),

197 
EcRecomm’dedP¬am‘”s
<
EC2N
>(
ASN1
::
£ù193r2
(),

204 
EcRecomm’dedP¬am‘”s
<
EC2N
>(
ASN1
::
£ù233k1
(),

211 
EcRecomm’dedP¬am‘”s
<
EC2N
>(
ASN1
::
£ù233r1
(),

218 
EcRecomm’dedP¬am‘”s
<
EC2N
>(
ASN1
::
£ù409k1
(),

225 
EcRecomm’dedP¬am‘”s
<
EC2N
>(
ASN1
::
£ù409r1
(),

232 
EcRecomm’dedP¬am‘”s
<
EC2N
>(
ASN1
::
£ù571k1
(),

239 
EcRecomm’dedP¬am‘”s
<
EC2N
>(
ASN1
::
£ù571r1
(),

247 
	gbegš
 = 
»c
;

248 
	g’d
 = 
»c
 + (rec)/(rec[0]);

251 
G‘Recomm’dedP¬am‘”s
(cÚ¡ 
EcRecomm’dedP¬am‘”s
<
ECP
> *&
begš
, cÚ¡ EcRecomm’dedP¬am‘”s<ECP> *&
’d
)

254 cÚ¡ 
	gEcRecomm’dedP¬am‘”s
<
	gECP
> 
	g»c
[] = {

255 
EcRecomm’dedP¬am‘”s
<
ECP
>(
ASN1
::
£ı192r1
(),

262 
EcRecomm’dedP¬am‘”s
<
ECP
>(
ASN1
::
£ı256r1
(),

269 
EcRecomm’dedP¬am‘”s
<
ECP
>(
ASN1
::
b¿špoŞP160r1
(),

276 
EcRecomm’dedP¬am‘”s
<
ECP
>(
ASN1
::
b¿špoŞP192r1
(),

283 
EcRecomm’dedP¬am‘”s
<
ECP
>(
ASN1
::
b¿špoŞP224r1
(),

290 
EcRecomm’dedP¬am‘”s
<
ECP
>(
ASN1
::
b¿špoŞP256r1
(),

297 
EcRecomm’dedP¬am‘”s
<
ECP
>(
ASN1
::
b¿špoŞP320r1
(),

304 
EcRecomm’dedP¬am‘”s
<
ECP
>(
ASN1
::
b¿špoŞP384r1
(),

311 
EcRecomm’dedP¬am‘”s
<
ECP
>(
ASN1
::
b¿špoŞP512r1
(),

318 
EcRecomm’dedP¬am‘”s
<
ECP
>(
ASN1
::
£ı112r1
(),

325 
EcRecomm’dedP¬am‘”s
<
ECP
>(
ASN1
::
£ı112r2
(),

332 
EcRecomm’dedP¬am‘”s
<
ECP
>(
ASN1
::
£ı160r1
(),

339 
EcRecomm’dedP¬am‘”s
<
ECP
>(
ASN1
::
£ı160k1
(),

346 
EcRecomm’dedP¬am‘”s
<
ECP
>(
ASN1
::
£ı256k1
(),

353 
EcRecomm’dedP¬am‘”s
<
ECP
>(
ASN1
::
£ı128r1
(),

360 
EcRecomm’dedP¬am‘”s
<
ECP
>(
ASN1
::
£ı128r2
(),

367 
EcRecomm’dedP¬am‘”s
<
ECP
>(
ASN1
::
£ı160r2
(),

374 
EcRecomm’dedP¬am‘”s
<
ECP
>(
ASN1
::
£ı192k1
(),

381 
EcRecomm’dedP¬am‘”s
<
ECP
>(
ASN1
::
£ı224k1
(),

388 
EcRecomm’dedP¬am‘”s
<
ECP
>(
ASN1
::
£ı224r1
(),

395 
EcRecomm’dedP¬am‘”s
<
ECP
>(
ASN1
::
£ı384r1
(),

402 
EcRecomm’dedP¬am‘”s
<
ECP
>(
ASN1
::
£ı521r1
(),

410 
	gbegš
 = 
»c
;

411 
	g’d
 = 
»c
 + (rec)/(rec[0]);

414 
	g‹m¶©e
 <
şass
 
	gEC
> 
OID
 
	gDL_GroupP¬am‘”s_EC
<EC>::
	$G‘NextRecomm’dedP¬am‘”sOID
(cÚ¡ 
OID
 &
oid
)

416 cÚ¡ 
EcRecomm’dedP¬am‘”s
<
EÎticCurve
> *
begš
, *
’d
;

417 
	`G‘Recomm’dedP¬am‘”s
(
begš
, 
’d
);

418 cÚ¡ 
EcRecomm’dedP¬am‘”s
<
EÎticCurve
> *
™
 = 
¡d
::
	`uµ”_bound
(
begš
, 
’d
, 
oid
, 
	`OIDLessThª
());

419  (
™
 =ğ
’d
 ? 
	`OID
(è: it->
oid
);

420 
	}
}

422 
	g‹m¶©e
 <
şass
 
	gEC
> 
	gDL_GroupP¬am‘”s_EC
<EC>::
	$In™Ÿlize
(cÚ¡ 
OID
 &
oid
)

424 cÚ¡ 
EcRecomm’dedP¬am‘”s
<
EÎticCurve
> *
begš
, *
’d
;

425 
	`G‘Recomm’dedP¬am‘”s
(
begš
, 
’d
);

426 cÚ¡ 
EcRecomm’dedP¬am‘”s
<
EÎticCurve
> *
™
 = 
¡d
::
	`low”_bound
(
begš
, 
’d
, 
oid
, 
	`OIDLessThª
());

427 ià(
™
 =ğ
’d
 || it->
oid
 != oid)

428 
throw
 
	`UnknownOID
();

430 cÚ¡ 
EcRecomm’dedP¬am‘”s
<
EÎticCurve
> &
·¿m
 = *
™
;

431 
m_oid
 = 
oid
;

432 
¡d
::
auto_±r
<
EÎticCurve
> 
	`ec
(
·¿m
.
	`NewEC
());

433 
this
->
m_groupP»computiÚ
.
	`S‘Curve
(*
ec
);

435 
SŒšgSourû
 
	`ssG
(
·¿m
.
g
, 
Œue
, 
Ãw
 
HexDecod”
);

436 
EËm’t
 
G
;

437 
boŞ
 
»suÉ
 = 
	`G‘Curve
().
	`DecodePošt
(
G
, 
ssG
, (
size_t
)ssG.
	`MaxR‘r›vabË
());

438 
this
->
	`S‘SubgroupG’”©Ü
(
G
);

439 
	`as£¹
(
»suÉ
);

441 
SŒšgSourû
 
	`ssN
(
·¿m
.
n
, 
Œue
, 
Ãw
 
HexDecod”
);

442 
m_n
.
	`Decode
(
ssN
, (
size_t
)ssN.
	`MaxR‘r›vabË
());

443 
m_k
 = 
·¿m
.
h
;

444 
	}
}

446 
	g‹m¶©e
 <
şass
 
	gEC
>

447 
boŞ
 
	gDL_GroupP¬am‘”s_EC
<
	gEC
>::
	$G‘VoidV®ue
(cÚ¡ *
Çme
, cÚ¡ 
¡d
::
ty³_šfo
 &
v®ueTy³
, *
pV®ue
) const

449 ià(
	`¡rcmp
(
Çme
, 
Name
::
	`GroupOID
()) == 0)

451 ià(
m_oid
.
m_v®ues
.
	`em±y
())

452  
çl£
;

454 
this
->
	`ThrowIfTy³Mism©ch
(
Çme
, 
	`ty³id
(
OID
), 
v®ueTy³
);

455 *
»š‹½»t_ÿ¡
<
OID
 *>(
pV®ue
èğ
m_oid
;

456  
Œue
;

459  
G‘V®ueH–³r
<
DL_GroupP¬am‘”s
<
EËm’t
> >(
this
, 
Çme
, 
v®ueTy³
, 
pV®ue
).
	`AssigÇbË
()

460 
	`CRYPTOPP_GET_FUNCTION_ENTRY
(
Curve
);

461 
	}
}

463 
	g‹m¶©e
 <
şass
 
	gEC
>

464 
	gDL_GroupP¬am‘”s_EC
<
	gEC
>::
	$AssignFrom
(cÚ¡ 
NameV®uePaœs
 &
sourû
)

466 
OID
 
oid
;

467 ià(
sourû
.
	`G‘V®ue
(
Name
::
	`GroupOID
(), 
oid
))

468 
	`In™Ÿlize
(
oid
);

471 
EÎticCurve
 
ec
;

472 
Pošt
 
G
;

473 
IÁeg”
 
n
;

475 
sourû
.
	`G‘RequœedP¬am‘”
("DL_GroupP¬am‘”s_EC<EC>", 
Name
::
	`Curve
(), 
ec
);

476 
sourû
.
	`G‘RequœedP¬am‘”
("DL_GroupP¬am‘”s_EC<EC>", 
Name
::
	`SubgroupG’”©Ü
(), 
G
);

477 
sourû
.
	`G‘RequœedP¬am‘”
("DL_GroupP¬am‘”s_EC<EC>", 
Name
::
	`SubgroupOrd”
(), 
n
);

478 
IÁeg”
 
k
 = 
sourû
.
	`G‘V®ueW™hDeçuÉ
(
Name
::
	`CoçùÜ
(), IÁeg”::
	`Z”o
());

480 
	`In™Ÿlize
(
ec
, 
G
, 
n
, 
k
);

482 
	}
}

484 
	g‹m¶©e
 <
şass
 
	gEC
>

485 
	gDL_GroupP¬am‘”s_EC
<
	gEC
>::
	$G’”©eRªdom
(
RªdomNumb”G’”©Ü
 &
ºg
, cÚ¡ 
NameV®uePaœs
 &
®g
)

487 
Œy


489 
	`AssignFrom
(
®g
);

491 
	`ÿtch
 (
Inv®idArgum’t
 &)

493 
throw
 
	`NÙIm¶em’‹d
("DL_GroupParameters_EC<EC>: curve generation is‚ot implemented yet");

495 
	}
}

497 
	g‹m¶©e
 <
şass
 
	gEC
>

498 
	gDL_GroupP¬am‘”s_EC
<
	gEC
>::
	$BERDecode
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
)

500 
by‹
 
b
;

501 ià(!
bt
.
	`P“k
(
b
))

502 
	`BERDecodeE¼Ü
();

503 ià(
b
 =ğ
OBJECT_IDENTIFIER
)

504 
	`In™Ÿlize
(
	`OID
(
bt
));

507 
BERSequ’ûDecod”
 
	`£q
(
bt
);

508 
wÜd32
 
v”siÚ
;

509 
BERDecodeUnsigÃd
<
wÜd32
>(
£q
, 
v”siÚ
, 
INTEGER
, 1, 1);

510 
EÎticCurve
 
	`ec
(
£q
);

511 
Pošt
 
G
 = 
ec
.
	`BERDecodePošt
(
£q
);

512 
IÁeg”
 
	`n
(
£q
);

513 
IÁeg”
 
k
;

514 
boŞ
 
coçùÜP»£Á
 = !
£q
.
	`EndR—ched
();

515 ià(
coçùÜP»£Á
)

516 
k
.
	`BERDecode
(
£q
);

518 
k
 = 
IÁeg”
::
	`Z”o
();

519 
£q
.
	`Mes§geEnd
();

521 
	`In™Ÿlize
(
ec
, 
G
, 
n
, 
k
);

523 
	}
}

525 
	g‹m¶©e
 <
şass
 
	gEC
>

526 
	gDL_GroupP¬am‘”s_EC
<
	gEC
>::
	$DEREncode
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
) const

528 ià(
m_’codeAsOID
 && !
m_oid
.
m_v®ues
.
	`em±y
())

529 
m_oid
.
	`DEREncode
(
bt
);

532 
DERSequ’ûEncod”
 
	`£q
(
bt
);

533 
DEREncodeUnsigÃd
<
wÜd32
>(
£q
, 1);

534 
	`G‘Curve
().
	`DEREncode
(
£q
);

535 
	`G‘Curve
().
	`DEREncodePošt
(
£q
, 
this
->
	`G‘SubgroupG’”©Ü
(), 
m_com´ess
);

536 
m_n
.
	`DEREncode
(
£q
);

537 ià(
m_k
.
	`NÙZ”o
())

538 
m_k
.
	`DEREncode
(
£q
);

539 
£q
.
	`Mes§geEnd
();

541 
	}
}

543 
	g‹m¶©e
 <
şass
 
	gEC
>

544 
IÁeg”
 
	gDL_GroupP¬am‘”s_EC
<
	gEC
>::
	$G‘CoçùÜ
() const

546 ià(!
m_k
)

548 
IÁeg”
 
q
 = 
	`G‘Curve
().
	`F›ldSize
();

549 
IÁeg”
 
qSq¹
 = 
q
.
	`Squ¬eRoÙ
();

550 
m_k
 = (
q
+2*
qSq¹
+1)/
m_n
;

553  
m_k
;

554 
	}
}

556 
	g‹m¶©e
 <
şass
 
	gEC
>

557 
IÁeg”
 
	gDL_GroupP¬am‘”s_EC
<
	gEC
>::
	$CÚv”tEËm’tToIÁeg”
(cÚ¡ 
EËm’t
 &
–em’t
) const

559  
	`CÚv”tToIÁeg”
(
–em’t
.
x
);

560 
	}
};

562 
	g‹m¶©e
 <
şass
 
	gEC
>

563 
boŞ
 
	gDL_GroupP¬am‘”s_EC
<
	gEC
>::
	$V®id©eGroup
(
RªdomNumb”G’”©Ü
 &
ºg
, 
Ëv–
) const

565 
boŞ
 
·ss
 = 
	`G‘Curve
().
	`V®id©eP¬am‘”s
(
ºg
, 
Ëv–
);

567 
IÁeg”
 
q
 = 
	`G‘Curve
().
	`F›ldSize
();

568 
·ss
 =…as && 
m_n
!=
q
;

570 ià(
Ëv–
 >= 2)

572 
IÁeg”
 
qSq¹
 = 
q
.
	`Squ¬eRoÙ
();

573 
·ss
 =…as && 
m_n
>4*
qSq¹
;

574 
·ss
 =…as && 
	`V”ifyPrime
(
ºg
, 
m_n
, 
Ëv–
-2);

575 
·ss
 =…as && (
m_k
.
	`IsZ”o
(è|| m_k =ğ(
q
+2*
qSq¹
+1)/
m_n
);

576 
·ss
 =…as && 
	`CheckMOVCÚd™iÚ
(
q
, 
m_n
);

579  
·ss
;

580 
	}
}

582 
	g‹m¶©e
 <
şass
 
	gEC
>

583 
boŞ
 
	gDL_GroupP¬am‘”s_EC
<
	gEC
>::
V®id©eEËm’t
(
Ëv–
, cÚ¡ 
EËm’t
 &
g
, cÚ¡ 
DL_FixedBa£P»computiÚ
<EËm’t> *
gpc
) const

585 
boŞ
 
	g·ss
 = !
IsId’t™y
(
g
è&& 
G‘Curve
().
V”ifyPošt
(g);

586 ià(
	gËv–
 >= 1)

588 ià(
gpc
)

589 
·ss
 =…as && 
gpc
->
ExpÚ’tŸ‹
(
this
->
G‘GroupP»computiÚ
(), 
IÁeg”
::
OÃ
()è=ğ
g
;

591 ià(
	gËv–
 >ğ2 && 
·ss
)

593 cÚ¡ 
IÁeg”
 &
q
 = 
G‘SubgroupOrd”
();

594 
EËm’t
 
	ggq
 = 
gpc
 ? gpc->
ExpÚ’tŸ‹
(
this
->
G‘GroupP»computiÚ
(), 
q
è:his->
ExpÚ’tŸ‹EËm’t
(
g
, q);

595 
	g·ss
 = 
·ss
 && 
IsId’t™y
(
gq
);

597  
	g·ss
;

600 
	g‹m¶©e
 <
şass
 
	gEC
>

601 
	gDL_GroupP¬am‘”s_EC
<
	gEC
>::
	$SimuÉªeousExpÚ’tŸ‹
(
EËm’t
 *
»suÉs
, cÚ¡ EËm’ˆ&
ba£
, cÚ¡ 
IÁeg”
 *
expÚ’ts
, 
expÚ’tsCouÁ
) const

603 
	`G‘Curve
().
	`SimuÉªeousMuÉly
(
»suÉs
, 
ba£
, 
expÚ’ts
, 
expÚ’tsCouÁ
);

604 
	}
}

606 
	g‹m¶©e
 <
şass
 
	gEC
>

607 
CPP_TYPENAME
 
	gDL_GroupP¬am‘”s_EC
<
	gEC
>::
EËm’t
 
DL_GroupP¬am‘”s_EC
<
EC
>::
	$MuÉlyEËm’ts
(cÚ¡ 
EËm’t
 &
a
, cÚ¡ EËm’ˆ&
b
) const

609  
	`G‘Curve
().
	`Add
(
a
, 
b
);

610 
	}
}

612 
	g‹m¶©e
 <
şass
 
	gEC
>

613 
CPP_TYPENAME
 
	gDL_GroupP¬am‘”s_EC
<
	gEC
>::
EËm’t
 
DL_GroupP¬am‘”s_EC
<
EC
>::
	$CasÿdeExpÚ’tŸ‹
(cÚ¡ 
EËm’t
 &
–em’t1
, cÚ¡ 
IÁeg”
 &
expÚ’t1
, cÚ¡ EËm’ˆ&
–em’t2
, cÚ¡ IÁeg” &
expÚ’t2
) const

615  
	`G‘Curve
().
	`CasÿdeMuÉly
(
expÚ’t1
, 
–em’t1
, 
expÚ’t2
, 
–em’t2
);

616 
	}
}

618 
	g‹m¶©e
 <
şass
 
	gEC
>

619 
OID
 
	gDL_GroupP¬am‘”s_EC
<
	gEC
>::
	$G‘AlgÜ™hmID
() const

621  
ASN1
::
	`id_ecPublicKey
();

622 
	}
}

626 
	g‹m¶©e
 <
şass
 
	gEC
>

627 
	gDL_PublicKey_EC
<
	gEC
>::
	$BERDecodePublicKey
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
, 
boŞ
 
·¿m‘”sP»£Á
, 
size_t
 
size
)

629 
ty³Çme
 
EC
::
Pošt
 
P
;

630 ià(!
this
->
	`G‘GroupP¬am‘”s
().
	`G‘Curve
().
	`DecodePošt
(
P
, 
bt
, 
size
))

631 
	`BERDecodeE¼Ü
();

632 
this
->
	`S‘PublicEËm’t
(
P
);

633 
	}
}

635 
	g‹m¶©e
 <
şass
 
	gEC
>

636 
	gDL_PublicKey_EC
<
	gEC
>::
	$DEREncodePublicKey
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
) const

638 
this
->
	`G‘GroupP¬am‘”s
().
	`G‘Curve
().
	`EncodePošt
(
bt
,his->
	`G‘PublicEËm’t
(),his->G‘GroupP¬am‘”s().
	`G‘PoštCom´essiÚ
());

639 
	}
}

643 
	g‹m¶©e
 <
şass
 
	gEC
>

644 
	gDL_Priv©eKey_EC
<
	gEC
>::
	$BERDecodePriv©eKey
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
, 
boŞ
 
·¿m‘”sP»£Á
, 
size_t
 
size
)

646 
BERSequ’ûDecod”
 
	`£q
(
bt
);

647 
wÜd32
 
v”siÚ
;

648 
BERDecodeUnsigÃd
<
wÜd32
>(
£q
, 
v”siÚ
, 
INTEGER
, 1, 1);

650 
BERG’”®Decod”
 
	`dec
(
£q
, 
OCTET_STRING
);

651 ià(!
dec
.
	`IsDefš™eL’gth
())

652 
	`BERDecodeE¼Ü
();

653 
IÁeg”
 
x
;

654 
x
.
	`Decode
(
dec
, (
size_t
)dec.
	`RemaššgL’gth
());

655 
dec
.
	`Mes§geEnd
();

656 ià(!
·¿m‘”sP»£Á
 && 
£q
.
	`P“kBy‹
(è!ğ(
CONTEXT_SPECIFIC
 | 
CONSTRUCTED
 | 0))

657 
	`BERDecodeE¼Ü
();

658 ià(!
£q
.
	`EndR—ched
(è&& seq.
	`P“kBy‹
(è=ğ(
CONTEXT_SPECIFIC
 | 
CONSTRUCTED
 | 0))

660 
BERG’”®Decod”
 
	`·¿m‘”s
(
£q
, 
CONTEXT_SPECIFIC
 | 
CONSTRUCTED
 | 0);

661 
this
->
	`AcûssGroupP¬am‘”s
().
	`BERDecode
(
·¿m‘”s
);

662 
·¿m‘”s
.
	`Mes§geEnd
();

664 ià(!
£q
.
	`EndR—ched
())

667 
SecBy‹Block
 
subjeùPublicKey
;

668 
unu£dB™s
;

669 
BERG’”®Decod”
 
	`publicKey
(
£q
, 
CONTEXT_SPECIFIC
 | 
CONSTRUCTED
 | 1);

670 
	`BERDecodeB™SŒšg
(
publicKey
, 
subjeùPublicKey
, 
unu£dB™s
);

671 
publicKey
.
	`Mes§geEnd
();

672 
EËm’t
 
Q
;

673 ià(!(
unu£dB™s
 =ğ0 && 
this
->
	`G‘GroupP¬am‘”s
().
	`G‘Curve
().
	`DecodePošt
(
Q
, 
subjeùPublicKey
, subjeùPublicKey.
	`size
())))

674 
	`BERDecodeE¼Ü
();

676 
£q
.
	`Mes§geEnd
();

678 
this
->
	`S‘Priv©eExpÚ’t
(
x
);

679 
	}
}

681 
	g‹m¶©e
 <
şass
 
	gEC
>

682 
	gDL_Priv©eKey_EC
<
	gEC
>::
	$DEREncodePriv©eKey
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
) const

684 
DERSequ’ûEncod”
 
	`´iv©eKey
(
bt
);

685 
DEREncodeUnsigÃd
<
wÜd32
>(
´iv©eKey
, 1);

688 
this
->
	`G‘Priv©eExpÚ’t
().
	`DEREncodeAsOù‘SŒšg
(
´iv©eKey
,his->
	`G‘GroupP¬am‘”s
().
	`G‘SubgroupOrd”
().
	`By‹CouÁ
());

689 
´iv©eKey
.
	`Mes§geEnd
();

690 
	}
}

692 
	gNAMESPACE_END


	@eccrypto.h

1 #iâdeà
CRYPTOPP_ECCRYPTO_H


2 
	#CRYPTOPP_ECCRYPTO_H


	)

7 
	~"pubkey.h
"

8 
	~"š‹g”.h
"

9 
	~"a¢.h
"

10 
	~"hmac.h
"

11 
	~"sha.h
"

12 
	~"gåüy±.h
"

13 
	~"dh.h
"

14 
	~"mqv.h
"

15 
	~"eı.h
"

16 
	~"ec2n.h
"

18 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

24 
‹m¶©e
 <
şass
 
EC
>

25 
şass
 
DL_GroupP¬am‘”s_EC
 : 
public
 
DL_GroupP¬am‘”sIm¶
<
EcP»computiÚ
<
EC
> >

27 
DL_GroupP¬am‘”s_EC
<
	tEC
> 
	tThisCÏss
;

29 
public
:

30 
EC
 
	tEÎticCurve
;

31 
ty³Çme
 
	tEÎticCurve
::
	tPošt
 Point;

32 
Pošt
 
	tEËm’t
;

33 
Incom·tibËCoçùÜMuÉliÿtiÚ
 
	tDeçuÉCoçùÜO±iÚ
;

35 
	`DL_GroupP¬am‘”s_EC
(è: 
	`m_com´ess
(
çl£
), 
	`m_’codeAsOID
(false) {}

36 
	`DL_GroupP¬am‘”s_EC
(cÚ¡ 
OID
 &
oid
)

37 : 
	`m_com´ess
(
çl£
), 
	`m_’codeAsOID
(çl£è{
	`In™Ÿlize
(
oid
);}

38 
	`DL_GroupP¬am‘”s_EC
(cÚ¡ 
EÎticCurve
 &
ec
, cÚ¡ 
Pošt
 &
G
, cÚ¡ 
IÁeg”
 &
n
, cÚ¡ IÁeg” &
k
 = IÁeg”::
	`Z”o
())

39 : 
	`m_com´ess
(
çl£
), 
	`m_’codeAsOID
(çl£è{
	`In™Ÿlize
(
ec
, 
G
, 
n
, 
k
);}

40 
	`DL_GroupP¬am‘”s_EC
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
)

41 : 
	`m_com´ess
(
çl£
), 
	`m_’codeAsOID
(çl£è{
	`BERDecode
(
bt
);}

43 
	`In™Ÿlize
(cÚ¡ 
EÎticCurve
 &
ec
, cÚ¡ 
Pošt
 &
G
, cÚ¡ 
IÁeg”
 &
n
, cÚ¡ IÁeg” &
k
 = IÁeg”::
	`Z”o
())

45 
this
->
m_groupP»computiÚ
.
	`S‘Curve
(
ec
);

46 
this
->
	`S‘SubgroupG’”©Ü
(
G
);

47 
m_n
 = 
n
;

48 
m_k
 = 
k
;

50 
	`In™Ÿlize
(cÚ¡ 
OID
 &
oid
);

53 
boŞ
 
	`G‘VoidV®ue
(cÚ¡ *
Çme
, cÚ¡ 
¡d
::
ty³_šfo
 &
v®ueTy³
, *
pV®ue
) const;

54 
	`AssignFrom
(cÚ¡ 
NameV®uePaœs
 &
sourû
);

59 
	`G’”©eRªdom
(
RªdomNumb”G’”©Ü
 &
ºg
, cÚ¡ 
NameV®uePaœs
 &
®g
);

62 cÚ¡ 
DL_FixedBa£P»computiÚ
<
EËm’t
> & 
	`G‘Ba£P»computiÚ
(ècÚ¡ { 
this
->
m_gpc
;}

63 
DL_FixedBa£P»computiÚ
<
EËm’t
> & 
	`AcûssBa£P»computiÚ
(è{ 
this
->
m_gpc
;}

64 cÚ¡ 
IÁeg”
 & 
	`G‘SubgroupOrd”
(ècÚ¡ { 
m_n
;}

65 
IÁeg”
 
	`G‘CoçùÜ
() const;

66 
boŞ
 
	`V®id©eGroup
(
RªdomNumb”G’”©Ü
 &
ºg
, 
Ëv–
) const;

67 
boŞ
 
	`V®id©eEËm’t
(
Ëv–
, cÚ¡ 
EËm’t
 &
–em’t
, cÚ¡ 
DL_FixedBa£P»computiÚ
<EËm’t> *
´ecomp
) const;

68 
boŞ
 
	`Fa¡SubgroupCheckAvaabË
(ècÚ¡ { 
çl£
;}

69 
	`EncodeEËm’t
(
boŞ
 
»v”sibË
, cÚ¡ 
EËm’t
 &
–em’t
, 
by‹
 *
’coded
) const

71 ià(
»v”sibË
)

72 
	`G‘Curve
().
	`EncodePošt
(
’coded
, 
–em’t
, 
m_com´ess
);

74 
–em’t
.
x
.
	`Encode
(
’coded
, 
	`G‘EncodedEËm’tSize
(
çl£
));

76 
	`G‘EncodedEËm’tSize
(
boŞ
 
»v”sibË
) const

78 ià(
»v”sibË
)

79  
	`G‘Curve
().
	`EncodedPoštSize
(
m_com´ess
);

81  
	`G‘Curve
().
	`G‘F›ld
().
	`MaxEËm’tBy‹L’gth
();

83 
EËm’t
 
	`DecodeEËm’t
(cÚ¡ 
by‹
 *
’coded
, 
boŞ
 
checkFÜGroupMemb”sh
) const

85 
Pošt
 
»suÉ
;

86 ià(!
	`G‘Curve
().
	`DecodePošt
(
»suÉ
, 
’coded
, 
	`G‘EncodedEËm’tSize
(
Œue
)))

87 
throw
 
	`DL_BadEËm’t
();

88 ià(
checkFÜGroupMemb”sh
 && !
	`V®id©eEËm’t
(1, 
»suÉ
, 
NULL
))

89 
throw
 
	`DL_BadEËm’t
();

90  
»suÉ
;

92 
IÁeg”
 
	`CÚv”tEËm’tToIÁeg”
(cÚ¡ 
EËm’t
 &
–em’t
) const;

93 
IÁeg”
 
	`G‘MaxExpÚ’t
(ècÚ¡ { 
	`G‘SubgroupOrd”
()-1;}

94 
boŞ
 
	`IsId’t™y
(cÚ¡ 
EËm’t
 &
–em’t
ècÚ¡ {ƒËm’t.
id’t™y
;}

95 
	`SimuÉªeousExpÚ’tŸ‹
(
EËm’t
 *
»suÉs
, cÚ¡ EËm’ˆ&
ba£
, cÚ¡ 
IÁeg”
 *
expÚ’ts
, 
expÚ’tsCouÁ
) const;

96 
¡d
::
¡ršg
 
CRYPTOPP_API
 
	`SticAlgÜ™hmNameP»fix
() { "EC";}

99 
OID
 
	`G‘AlgÜ™hmID
() const;

102 
EËm’t
 
	`MuÉlyEËm’ts
(cÚ¡ EËm’ˆ&
a
, cÚ¡ EËm’ˆ&
b
) const;

103 
EËm’t
 
	`CasÿdeExpÚ’tŸ‹
(cÚ¡ EËm’ˆ&
–em’t1
, cÚ¡ 
IÁeg”
 &
expÚ’t1
, cÚ¡ EËm’ˆ&
–em’t2
, cÚ¡ IÁeg” &
expÚ’t2
) const;

108 
OID
 
CRYPTOPP_API
 
	`G‘NextRecomm’dedP¬am‘”sOID
(cÚ¡ OID &
oid
);

110 
	`BERDecode
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
);

111 
	`DEREncode
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
) const;

113 
	`S‘PoštCom´essiÚ
(
boŞ
 
com´ess
è{
m_com´ess
 = compress;}

114 
boŞ
 
	`G‘PoštCom´essiÚ
(ècÚ¡ { 
m_com´ess
;}

116 
	`S‘EncodeAsOID
(
boŞ
 
’codeAsOID
è{
m_’codeAsOID
 =ƒncodeAsOID;}

117 
boŞ
 
	`G‘EncodeAsOID
(ècÚ¡ { 
m_’codeAsOID
;}

119 cÚ¡ 
EÎticCurve
& 
	`G‘Curve
(ècÚ¡ { 
this
->
m_groupP»computiÚ
.GetCurve();}

121 
boŞ
 
İ”©Ü
==(cÚ¡ 
ThisCÏss
 &
rhs
) const

122 { 
this
->
m_groupP»computiÚ
.
	`G‘Curve
(è=ğ
rhs
.m_groupP»computiÚ.G‘Curve(è&&his->
m_gpc
.
	`G‘Ba£
(this->m_groupPrecomputation) ==„hs.m_gpc.GetBase(rhs.m_groupPrecomputation);}

124 #ifdeà
CRYPTOPP_MAINTAIN_BACKWARDS_COMPATIBILITY


125 cÚ¡ 
Pošt
& 
	`G‘Ba£Pošt
(ècÚ¡ { 
	`G‘SubgroupG’”©Ü
();}

126 cÚ¡ 
IÁeg”
& 
	`G‘Ba£PoštOrd”
(ècÚ¡ { 
	`G‘SubgroupOrd”
();}

127 
	`LßdRecomm’dedP¬am‘”s
(cÚ¡ 
OID
 &
oid
è{
	`In™Ÿlize
(oid);}

130 
´Ùeùed
:

131 
	`F›ldEËm’tL’gth
(ècÚ¡ { 
	`G‘Curve
().
	`G‘F›ld
().
	`MaxEËm’tBy‹L’gth
();}

132 
	`ExpÚ’tL’gth
(ècÚ¡ { 
m_n
.
	`By‹CouÁ
();}

134 
OID
 
m_oid
;

135 
IÁeg”
 
m_n
;

136 
boŞ
 
m_com´ess
, 
m_’codeAsOID
;

137 
mubË
 
IÁeg”
 
m_k
;

138 
	}
};

141 
	g‹m¶©e
 <
şass
 
	gEC
>

142 
şass
 
	gDL_PublicKey_EC
 : 
public
 
DL_PublicKeyIm¶
<
DL_GroupP¬am‘”s_EC
<
EC
> >

144 
public
:

145 
ty³Çme
 
	tEC
::
	tPošt
 
	tEËm’t
;

147 
In™Ÿlize
(cÚ¡ 
DL_GroupP¬am‘”s_EC
<
EC
> &
·¿ms
, cÚ¡ 
EËm’t
 &
Q
)

148 {
	gthis
->
AcûssGroupP¬am‘”s
(èğ
·¿ms
;his->
S‘PublicEËm’t
(
Q
);}

149 
In™Ÿlize
(cÚ¡ 
EC
 &
ec
, cÚ¡ 
EËm’t
 &
G
, cÚ¡ 
IÁeg”
 &
n
, cÚ¡ EËm’ˆ&
Q
)

150 {
	gthis
->
AcûssGroupP¬am‘”s
().
In™Ÿlize
(
ec
, 
G
, 
n
);his->
S‘PublicEËm’t
(
Q
);}

153 
BERDecodePublicKey
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
, 
boŞ
 
·¿m‘”sP»£Á
, 
size_t
 
size
);

154 
DEREncodePublicKey
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
) const;

158 
	g‹m¶©e
 <
şass
 
	gEC
>

159 
şass
 
	gDL_Priv©eKey_EC
 : 
public
 
DL_Priv©eKeyIm¶
<
DL_GroupP¬am‘”s_EC
<
EC
> >

161 
public
:

162 
ty³Çme
 
	tEC
::
	tPošt
 
	tEËm’t
;

164 
In™Ÿlize
(cÚ¡ 
DL_GroupP¬am‘”s_EC
<
EC
> &
·¿ms
, cÚ¡ 
IÁeg”
 &
x
)

165 {
	gthis
->
AcûssGroupP¬am‘”s
(èğ
·¿ms
;his->
S‘Priv©eExpÚ’t
(
x
);}

166 
In™Ÿlize
(cÚ¡ 
EC
 &
ec
, cÚ¡ 
EËm’t
 &
G
, cÚ¡ 
IÁeg”
 &
n
, cÚ¡ IÁeg” &
x
)

167 {
	gthis
->
AcûssGroupP¬am‘”s
().
In™Ÿlize
(
ec
, 
G
, 
n
);his->
S‘Priv©eExpÚ’t
(
x
);}

168 
In™Ÿlize
(
RªdomNumb”G’”©Ü
 &
ºg
, cÚ¡ 
DL_GroupP¬am‘”s_EC
<
EC
> &
·¿ms
)

169 {
	gthis
->
G’”©eRªdom
(
ºg
, 
·¿ms
);}

170 
In™Ÿlize
(
RªdomNumb”G’”©Ü
 &
ºg
, cÚ¡ 
EC
 &
ec
, cÚ¡ 
EËm’t
 &
G
, cÚ¡ 
IÁeg”
 &
n
)

171 {
	gthis
->
G’”©eRªdom
(
ºg
, 
DL_GroupP¬am‘”s_EC
<
EC
>(
ec
, 
G
, 
n
));}

174 
BERDecodePriv©eKey
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
, 
boŞ
 
·¿m‘”sP»£Á
, 
size_t
 
size
);

175 
DEREncodePriv©eKey
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
) const;

179 
	g‹m¶©e
 <
şass
 
	gEC
, cÏs 
	gCOFACTOR_OPTION
 = 
CPP_TYPENAME
 
DL_GroupP¬am‘”s_EC
<
EC
>::
DeçuÉCoçùÜO±iÚ
>

180 
	sECDH


182 
DH_Domaš
<
	tDL_GroupP¬am‘”s_EC
<
	tEC
>, 
	tCOFACTOR_OPTION
> 
	tDomaš
;

186 
	g‹m¶©e
 <
şass
 
	gEC
, cÏs 
	gCOFACTOR_OPTION
 = 
CPP_TYPENAME
 
DL_GroupP¬am‘”s_EC
<
EC
>::
DeçuÉCoçùÜO±iÚ
>

187 
	sECMQV


189 
MQV_Domaš
<
	tDL_GroupP¬am‘”s_EC
<
	tEC
>, 
	tCOFACTOR_OPTION
> 
	tDomaš
;

193 
	g‹m¶©e
 <
şass
 
	gEC
>

194 
	sDL_Keys_EC


196 
	mDL_PublicKey_EC
<
	tEC
> 
	tPublicKey
;

197 
	mDL_Priv©eKey_EC
<
	tEC
> 
	tPriv©eKey
;

200 
	g‹m¶©e
 <
şass
 
	gEC
, cÏs 
	gH
>

201 
	gECDSA
;

204 
	g‹m¶©e
 <
şass
 
	gEC
>

205 
	sDL_Keys_ECDSA


207 
	mDL_PublicKey_EC
<
	tEC
> 
	tPublicKey
;

208 
	mDL_Priv©eKey_W™hSigÇtu»Paœwi£CÚsi¡’cyTe¡
<
	tDL_Priv©eKey_EC
<
	tEC
>, 
	tECDSA
<EC, 
	tSHA256
> > 
	tPriv©eKey
;

212 
	g‹m¶©e
 <
şass
 
	gEC
>

213 
şass
 
	gDL_AlgÜ™hm_ECDSA
 : 
public
 
DL_AlgÜ™hm_GDSA
<
ty³Çme
 
EC
::
Pošt
>

215 
public
:

216 cÚ¡ * 
CRYPTOPP_API
 
SticAlgÜ™hmName
() { "ECDSA";}

220 
	g‹m¶©e
 <
şass
 
	gEC
>

221 
şass
 
	gDL_AlgÜ™hm_ECNR
 : 
public
 
DL_AlgÜ™hm_NR
<
ty³Çme
 
EC
::
Pošt
>

223 
public
:

224 cÚ¡ * 
CRYPTOPP_API
 
SticAlgÜ™hmName
() { "ECNR";}

228 
	g‹m¶©e
 <
şass
 
	gEC
, cÏs 
	gH
>

229 
	gECDSA
 : 
public
 
DL_SS
<
DL_Keys_ECDSA
<
EC
>, 
	gDL_AlgÜ™hm_ECDSA
<
	gEC
>, 
	gDL_SigÇtu»Mes§geEncodšgM‘hod_DSA
, 
	gH
>

234 
	g‹m¶©e
 <
şass
 
	gEC
, cÏs 
	gH
 = 
SHA
>

235 
ECNR
 : 
public
 
DL_SS
<
DL_Keys_EC
<
EC
>, 
	gDL_AlgÜ™hm_ECNR
<
	gEC
>, 
	gDL_SigÇtu»Mes§geEncodšgM‘hod_NR
, 
	gH
>

243 
	g‹m¶©e
 <
şass
 
	gEC
, cÏs 
	gCOFACTOR_OPTION
 = 
NoCoçùÜMuÉliÿtiÚ
, 
boŞ
 
	gDHAES_MODE
 = 
çl£
>

244 
ECIES


245 : 
public
 
DL_ES
<

246 
DL_Keys_EC
<
EC
>,

247 
	gDL_KeyAg»em’tAlgÜ™hm_DH
<
ty³Çme
 
	gEC
::
Pošt
, 
	gCOFACTOR_OPTION
>,

248 
	gDL_KeyD”iv©iÚAlgÜ™hm_P1363
<
ty³Çme
 
	gEC
::
Pošt
, 
	gDHAES_MODE
, 
	gP1363_KDF2
<
	gSHA1
> >,

249 
	gDL_Enüy±iÚAlgÜ™hm_XÜ
<
	gHMAC
<
	gSHA1
>, 
	gDHAES_MODE
>,

250 
	gECIES
<
	gEC
> >

252 
	g¡d
::
¡ršg
 
CRYPTOPP_API
 
SticAlgÜ™hmName
() { "ECIES";}

255 
	gNAMESPACE_END


257 #ifdeà
CRYPTOPP_MANUALLY_INSTANTIATE_TEMPLATES


258 
	~"ecüy±o.ıp
"

261 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

263 
CRYPTOPP_DLL_TEMPLATE_CLASS
 
DL_GroupP¬am‘”s_EC
<
ECP
>;

264 
CRYPTOPP_DLL_TEMPLATE_CLASS
 
DL_GroupP¬am‘”s_EC
<
EC2N
>;

265 
CRYPTOPP_DLL_TEMPLATE_CLASS
 
DL_PublicKeyIm¶
<
DL_GroupP¬am‘”s_EC
<
ECP
> >;

266 
CRYPTOPP_DLL_TEMPLATE_CLASS
 
DL_PublicKeyIm¶
<
DL_GroupP¬am‘”s_EC
<
EC2N
> >;

267 
CRYPTOPP_DLL_TEMPLATE_CLASS
 
DL_PublicKey_EC
<
ECP
>;

268 
CRYPTOPP_DLL_TEMPLATE_CLASS
 
DL_PublicKey_EC
<
EC2N
>;

269 
CRYPTOPP_DLL_TEMPLATE_CLASS
 
DL_Priv©eKeyIm¶
<
DL_GroupP¬am‘”s_EC
<
ECP
> >;

270 
CRYPTOPP_DLL_TEMPLATE_CLASS
 
DL_Priv©eKeyIm¶
<
DL_GroupP¬am‘”s_EC
<
EC2N
> >;

271 
CRYPTOPP_DLL_TEMPLATE_CLASS
 
DL_Priv©eKey_EC
<
ECP
>;

272 
CRYPTOPP_DLL_TEMPLATE_CLASS
 
DL_Priv©eKey_EC
<
EC2N
>;

273 
CRYPTOPP_DLL_TEMPLATE_CLASS
 
DL_AlgÜ™hm_GDSA
<
ECP
::
Pošt
>;

274 
CRYPTOPP_DLL_TEMPLATE_CLASS
 
DL_AlgÜ™hm_GDSA
<
EC2N
::
Pošt
>;

275 
CRYPTOPP_DLL_TEMPLATE_CLASS
 
DL_Priv©eKey_W™hSigÇtu»Paœwi£CÚsi¡’cyTe¡
<
DL_Priv©eKey_EC
<
ECP
>, 
ECDSA
<ECP, 
SHA256
> >;

276 
CRYPTOPP_DLL_TEMPLATE_CLASS
 
DL_Priv©eKey_W™hSigÇtu»Paœwi£CÚsi¡’cyTe¡
<
DL_Priv©eKey_EC
<
EC2N
>, 
ECDSA
<EC2N, 
SHA256
> >;

278 
NAMESPACE_END


	@ecp.cpp

3 
	~"pch.h
"

5 #iâdeà
CRYPTOPP_IMPORTS


7 
	~"eı.h
"

8 
	~"a¢.h
"

9 
	~"nbtheÜy.h
"

11 
	~"®geb¿.ıp
"

13 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

15 
ANONYMOUS_NAMESPACE_BEGIN


16 
šlše
 
ECP
::
Pošt
 
	$ToMÚtgom”y
(cÚ¡ 
ModuÏrAr™hm‘ic
 &
mr
, cÚ¡ 
ECP
::
Pošt
 &
P
)

18  
P
.
id’t™y
 ? P : 
ECP
::
	`Pošt
(
mr
.
	`CÚv”tIn
(P.
x
), mr.CÚv”tIn(P.
y
));

19 
	}
}

21 
šlše
 
	gECP
::
Pošt
 
	$FromMÚtgom”y
(cÚ¡ 
ModuÏrAr™hm‘ic
 &
mr
, cÚ¡ 
ECP
::
Pošt
 &
P
)

23  
P
.
id’t™y
 ? P : 
ECP
::
	`Pošt
(
mr
.
	`CÚv”tOut
(P.
x
), mr.CÚv”tOut(P.
y
));

24 
	}
}

25 
NAMESPACE_END


27 
	gECP
::
	$ECP
(cÚ¡ 
ECP
 &
eı
, 
boŞ
 
cÚv”tToMÚtgom”yR•»£Á©iÚ
)

29 ià(
cÚv”tToMÚtgom”yR•»£Á©iÚ
 && !
eı
.
	`G‘F›ld
().
	`IsMÚtgom”yR•»£Á©iÚ
())

31 
m_f›ldPŒ
.
	`»£t
(
Ãw
 
	`MÚtgom”yR•»£Á©iÚ
(
eı
.
	`G‘F›ld
().
	`G‘Modulus
()));

32 
m_a
 = 
	`G‘F›ld
().
	`CÚv”tIn
(
eı
.m_a);

33 
m_b
 = 
	`G‘F›ld
().
	`CÚv”tIn
(
eı
.m_b);

36 
İ”©Ü
=(
eı
);

37 
	}
}

39 
	gECP
::
	$ECP
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
)

40 : 
	`m_f›ldPŒ
(
Ãw
 
	$F›ld
(
bt
))

42 
BERSequ’ûDecod”
 
	`£q
(
bt
);

43 
	`G‘F›ld
().
	`BERDecodeEËm’t
(
£q
, 
m_a
);

44 
	`G‘F›ld
().
	`BERDecodeEËm’t
(
£q
, 
m_b
);

46 ià(!
£q
.
	`EndR—ched
())

48 
SecBy‹Block
 
£ed
;

49 
unu£d
;

50 
	`BERDecodeB™SŒšg
(
£q
, 
£ed
, 
unu£d
);

52 
£q
.
	`Mes§geEnd
();

53 
	}
}

55 
	gECP
::
	$DEREncode
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
) const

57 
	`G‘F›ld
().
	`DEREncode
(
bt
);

58 
DERSequ’ûEncod”
 
	`£q
(
bt
);

59 
	`G‘F›ld
().
	`DEREncodeEËm’t
(
£q
, 
m_a
);

60 
	`G‘F›ld
().
	`DEREncodeEËm’t
(
£q
, 
m_b
);

61 
£q
.
	`Mes§geEnd
();

62 
	}
}

64 
boŞ
 
	gECP
::
	$DecodePošt
(
ECP
::
Pošt
 &
P
, cÚ¡ 
by‹
 *
’codedPošt
, 
size_t
 
’codedPoštL’
) const

66 
SŒšgStÜe
 
	`¡Üe
(
’codedPošt
, 
’codedPoštL’
);

67  
	`DecodePošt
(
P
, 
¡Üe
, 
’codedPoštL’
);

68 
	}
}

70 
boŞ
 
	gECP
::
	$DecodePošt
(
ECP
::
Pošt
 &
P
, 
Bufã»dT¿nsfÜm©iÚ
 &
bt
, 
size_t
 
’codedPoštL’
) const

72 
by‹
 
ty³
;

73 ià(
’codedPoštL’
 < 1 || !
bt
.
	`G‘
(
ty³
))

74  
çl£
;

76 
ty³
)

79 
P
.
id’t™y
 = 
Œue
;

80  
Œue
;

84 ià(
’codedPoštL’
 !ğ
	`EncodedPoštSize
(
Œue
))

85  
çl£
;

87 
IÁeg”
 
p
 = 
	`F›ldSize
();

89 
P
.
id’t™y
 = 
çl£
;

90 
P
.
x
.
	`Decode
(
bt
, 
	`G‘F›ld
().
	`MaxEËm’tBy‹L’gth
());

91 
P
.
y
 = ((P.
x
*P.x+
m_a
)*P.x+
m_b
è% 
p
;

93 ià(
	`Jacobi
(
P
.
y
, 
p
) !=1)

94  
çl£
;

96 
P
.
y
 = 
	`ModuÏrSqu¬eRoÙ
(P.y, 
p
);

98 ià((
ty³
 & 1è!ğ
P
.
y
.
	`G‘B™
(0))

99 
P
.
y
 = 
p
-P.y;

101  
Œue
;

105 ià(
’codedPoštL’
 !ğ
	`EncodedPoštSize
(
çl£
))

106  
çl£
;

108 
Ën
 = 
	`G‘F›ld
().
	`MaxEËm’tBy‹L’gth
();

109 
P
.
id’t™y
 = 
çl£
;

110 
P
.
x
.
	`Decode
(
bt
, 
Ën
);

111 
P
.
y
.
	`Decode
(
bt
, 
Ën
);

112  
Œue
;

115  
çl£
;

117 
	}
}

119 
	gECP
::
	$EncodePošt
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
, cÚ¡ 
Pošt
 &
P
, 
boŞ
 
com´es£d
) const

121 ià(
P
.
id’t™y
)

122 
	`NuÎStÜe
().
	`T¿nsãrTo
(
bt
, 
	`EncodedPoštSize
(
com´es£d
));

123 ià(
com´es£d
)

125 
bt
.
	`Put
(2 + 
P
.
y
.
	`G‘B™
(0));

126 
P
.
x
.
	`Encode
(
bt
, 
	`G‘F›ld
().
	`MaxEËm’tBy‹L’gth
());

130 
Ën
 = 
	`G‘F›ld
().
	`MaxEËm’tBy‹L’gth
();

131 
bt
.
	`Put
(4);

132 
P
.
x
.
	`Encode
(
bt
, 
Ën
);

133 
P
.
y
.
	`Encode
(
bt
, 
Ën
);

135 
	}
}

137 
	gECP
::
	$EncodePošt
(
by‹
 *
’codedPošt
, cÚ¡ 
Pošt
 &
P
, 
boŞ
 
com´es£d
) const

139 
A¼aySšk
 
	`sšk
(
’codedPošt
, 
	`EncodedPoštSize
(
com´es£d
));

140 
	`EncodePošt
(
sšk
, 
P
, 
com´es£d
);

141 
	`as£¹
(
sšk
.
	`TÙ®PutL’gth
(è=ğ
	`EncodedPoštSize
(
com´es£d
));

142 
	}
}

144 
	gECP
::
Pošt
 
ECP
::
	$BERDecodePošt
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
) const

146 
SecBy‹Block
 
¡r
;

147 
	`BERDecodeOù‘SŒšg
(
bt
, 
¡r
);

148 
Pošt
 
P
;

149 ià(!
	`DecodePošt
(
P
, 
¡r
, sŒ.
	`size
()))

150 
	`BERDecodeE¼Ü
();

151  
P
;

152 
	}
}

154 
	gECP
::
	$DEREncodePošt
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
, cÚ¡ 
Pošt
 &
P
, 
boŞ
 
com´es£d
) const

156 
SecBy‹Block
 
	`¡r
(
	`EncodedPoštSize
(
com´es£d
));

157 
	`EncodePošt
(
¡r
, 
P
, 
com´es£d
);

158 
	`DEREncodeOù‘SŒšg
(
bt
, 
¡r
);

159 
	}
}

161 
boŞ
 
	gECP
::
	$V®id©eP¬am‘”s
(
RªdomNumb”G’”©Ü
 &
ºg
, 
Ëv–
) const

163 
IÁeg”
 
p
 = 
	`F›ldSize
();

165 
boŞ
 
·ss
 = 
p
.
	`IsOdd
();

166 
·ss
 =…as && !
m_a
.
	`IsNeg©ive
(è&& m_a<
p
 && !
m_b
.IsNegative() && m_b<p;

168 ià(
Ëv–
 >= 1)

169 
·ss
 =…as && ((4*
m_a
*m_a*m_a+27*
m_b
*m_b)%
p
).
	`IsPos™ive
();

171 ià(
Ëv–
 >= 2)

172 
·ss
 =…as && 
	`V”ifyPrime
(
ºg
, 
p
);

174  
·ss
;

175 
	}
}

177 
boŞ
 
	gECP
::
	$V”ifyPošt
(cÚ¡ 
Pošt
 &
P
) const

179 cÚ¡ 
F›ldEËm’t
 &
x
 = 
P
.x, &
y
 = P.y;

180 
IÁeg”
 
p
 = 
	`F›ldSize
();

181  
P
.
id’t™y
 ||

182 (!
x
.
	`IsNeg©ive
(è&& x<
p
 && !
y
.IsNegative() && y<p

183 && !(((
x
*x+
m_a
)*x+
m_b
-
y
*y)%
p
));

184 
	}
}

186 
boŞ
 
	gECP
::
	$Equ®
(cÚ¡ 
Pošt
 &
P
, cÚ¡ Pošˆ&
Q
) const

188 ià(
P
.
id’t™y
 && 
Q
.identity)

189  
Œue
;

191 ià(
P
.
id’t™y
 && !
Q
.identity)

192  
çl£
;

194 ià(!
P
.
id’t™y
 && 
Q
.identity)

195  
çl£
;

197  (
	`G‘F›ld
().
	`Equ®
(
P
.
x
,
Q
.xè&& G‘F›ld().Equ®(P.
y
,Q.y));

198 
	}
}

200 cÚ¡ 
	gECP
::
Pošt
& 
ECP
::
	$Id’t™y
() const

202  
SšgËtÚ
<
Pošt
>().
	`Ref
();

203 
	}
}

205 cÚ¡ 
	gECP
::
Pošt
& 
ECP
::
	$Inv”£
(cÚ¡ 
Pošt
 &
P
) const

207 ià(
P
.
id’t™y
)

208  
P
;

211 
m_R
.
id’t™y
 = 
çl£
;

212 
m_R
.
x
 = 
P
.x;

213 
m_R
.
y
 = 
	`G‘F›ld
().
	`Inv”£
(
P
.y);

214  
m_R
;

216 
	}
}

218 cÚ¡ 
	gECP
::
Pošt
& 
ECP
::
	$Add
(cÚ¡ 
Pošt
 &
P
, cÚ¡ Pošˆ&
Q
) const

220 ià(
P
.
id’t™y
è 
Q
;

221 ià(
Q
.
id’t™y
è 
P
;

222 ià(
	`G‘F›ld
().
	`Equ®
(
P
.
x
, 
Q
.x))

223  
	`G‘F›ld
().
	`Equ®
(
P
.
y
, 
Q
.yè? 
	`DoubË
(Pè: 
	`Id’t™y
();

225 
F›ldEËm’t
 
t
 = 
	`G‘F›ld
().
	`SubŒaù
(
Q
.
y
, 
P
.y);

226 
t
 = 
	`G‘F›ld
().
	`Divide
Ñ, G‘F›ld().
	`SubŒaù
(
Q
.
x
, 
P
.x));

227 
F›ldEËm’t
 
x
 = 
	`G‘F›ld
().
	`SubŒaù
(G‘F›ld().SubŒaù(G‘F›ld().
	`Squ¬e
(
t
), 
P
.x), 
Q
.x);

228 
m_R
.
y
 = 
	`G‘F›ld
().
	`SubŒaù
(G‘F›ld().
	`MuÉly
(
t
, G‘F›ld().SubŒaù(
P
.
x
, x)), P.y);

230 
m_R
.
x
.
	`sw­
(x);

231 
m_R
.
id’t™y
 = 
çl£
;

232  
m_R
;

233 
	}
}

235 cÚ¡ 
	gECP
::
Pošt
& 
ECP
::
	$DoubË
(cÚ¡ 
Pošt
 &
P
) const

237 ià(
P
.
id’t™y
 || P.
y
==
	`G‘F›ld
().
	`Id’t™y
())  Identity();

239 
F›ldEËm’t
 
t
 = 
	`G‘F›ld
().
	`Squ¬e
(
P
.
x
);

240 
t
 = 
	`G‘F›ld
().
	`Add
(G‘F›ld().Add(G‘F›ld().
	`DoubË
Ñ),), 
m_a
);

241 
t
 = 
	`G‘F›ld
().
	`Divide
Ñ, G‘F›ld().
	`DoubË
(
P
.
y
));

242 
F›ldEËm’t
 
x
 = 
	`G‘F›ld
().
	`SubŒaù
(G‘F›ld().SubŒaù(G‘F›ld().
	`Squ¬e
(
t
), 
P
.x), P.x);

243 
m_R
.
y
 = 
	`G‘F›ld
().
	`SubŒaù
(G‘F›ld().
	`MuÉly
(
t
, G‘F›ld().SubŒaù(
P
.
x
, x)), P.y);

245 
m_R
.
x
.
	`sw­
(x);

246 
m_R
.
id’t™y
 = 
çl£
;

247  
m_R
;

248 
	}
}

250 
	g‹m¶©e
 <
şass
 
	gT
, cÏs 
	gI‹¿tÜ
> 
P¬®ËlInv”t
(cÚ¡ 
Ab¡¿ùRšg
<
T
> &
ršg
, 
I‹¿tÜ
 
begš
, I‹¿tÜ 
’d
)

252 
size_t
 
	gn
 = 
’d
-
begš
;

253 ià(
	gn
 == 1)

254 *
begš
 = 
ršg
.
MuÉliÿtiveInv”£
(*begin);

255 ià(
	gn
 > 1)

257 
	g¡d
::
veùÜ
<
T
> 
vec
((
n
+1)/2);

258 
	gi
;

259 
I‹¿tÜ
 
	g™
;

261 
	gi
=0, 
	g™
=
begš
; i<
	gn
/2; i++, it+=2)

262 
vec
[
i
] = 
ršg
.
MuÉly
(*
™
, *(it+1));

263 ià(
	gn
%2 == 1)

264 
vec
[
n
/2] = *
™
;

266 
P¬®ËlInv”t
(
ršg
, 
vec
.
begš
(), vec.
’d
());

268 
	gi
=0, 
	g™
=
begš
; i<
	gn
/2; i++, it+=2)

270 ià(!
vec
[
i
])

272 *
™
 = 
ršg
.
MuÉliÿtiveInv”£
(*it);

273 *(
	g™
+1èğ
ršg
.
MuÉliÿtiveInv”£
(*(
™
+1));

277 
	g¡d
::
sw­
(*
™
, *(it+1));

278 *
	g™
 = 
ršg
.
MuÉly
(*
™
, 
vec
[
i
]);

279 *(
	g™
+1èğ
ršg
.
MuÉly
(*(
™
+1), 
vec
[
i
]);

282 ià(
	gn
%2 == 1)

283 *
™
 = 
vec
[
n
/2];

287 
	sProjeùivePošt


289 
ProjeùivePošt
() {}

290 
ProjeùivePošt
(cÚ¡ 
IÁeg”
 &
x
, cÚ¡ IÁeg” &
y
, cÚ¡ IÁeg” &
z
)

291 : 
x
(x), 
y
(y), 
z
(z) {}

293 
IÁeg”
 
	mx
,
	my
,
	mz
;

296 şas 
	cProjeùiveDoublšg


298 
	mpublic
:

299 
	$ProjeùiveDoublšg
(cÚ¡ 
ModuÏrAr™hm‘ic
 &
mr
, cÚ¡ 
IÁeg”
 &
m_a
, cÚ¡ IÁeg” &
m_b
, cÚ¡ 
ECPPošt
 &
Q
)

300 : 
	`mr
(
mr
), 
	`fœ¡Doublšg
(
Œue
), 
	$Ãg©ed
(
çl£
)

302 ià(
Q
.
id’t™y
)

304 
six‹’Y4
 = 
P
.
x
 = P.
y
 = 
mr
.
	`MuÉliÿtiveId’t™y
();

305 
aZ4
 = 
P
.
z
 = 
mr
.
	`Id’t™y
();

309 
P
.
x
 = 
Q
.x;

310 
P
.
y
 = 
Q
.y;

311 
six‹’Y4
 = 
P
.
z
 = 
mr
.
	`MuÉliÿtiveId’t™y
();

312 
aZ4
 = 
m_a
;

316 
	$DoubË
()

318 
twoY
 = 
mr
.
	`DoubË
(
P
.
y
);

319 
P
.
z
 = 
mr
.
	`MuÉly
(P.z, 
twoY
);

320 
fourY2
 = 
mr
.
	`Squ¬e
(
twoY
);

321 
S
 = 
mr
.
	`MuÉly
(
fourY2
, 
P
.
x
);

322 
aZ4
 = 
mr
.
	`MuÉly
×Z4, 
six‹’Y4
);

323 
M
 = 
mr
.
	`Squ¬e
(
P
.
x
);

324 
M
 = 
mr
.
	`Add
(mr.Add(mr.
	`DoubË
(M), M), 
aZ4
);

325 
P
.
x
 = 
mr
.
	`Squ¬e
(
M
);

326 
mr
.
	`Reduû
(
P
.
x
, 
S
);

327 
mr
.
	`Reduû
(
P
.
x
, 
S
);

328 
mr
.
	`Reduû
(
S
, 
P
.
x
);

329 
P
.
y
 = 
mr
.
	`MuÉly
(
M
, 
S
);

330 
six‹’Y4
 = 
mr
.
	`Squ¬e
(
fourY2
);

331 
mr
.
	`Reduû
(
P
.
y
, mr.
	`H®f
(
six‹’Y4
));

332 
	}
}

334 cÚ¡ 
	gModuÏrAr™hm‘ic
 &
	gmr
;

335 
ProjeùivePošt
 
	gP
;

336 
boŞ
 
	gfœ¡Doublšg
, 
	gÃg©ed
;

337 
IÁeg”
 
	gsix‹’Y4
, 
	gaZ4
, 
	gtwoY
, 
	gfourY2
, 
	gS
, 
	gM
;

340 
	sZI‹¿tÜ


342 
ZI‹¿tÜ
() {}

343 
ZI‹¿tÜ
(
¡d
::
veùÜ
<
ProjeùivePošt
>::
™”©Ü
 
™
) : it(it) {}

344 
IÁeg”
& 
İ”©Ü
*(è{ 
™
->
z
;}

345 
	mİ”©Ü
-(
ZI‹¿tÜ
 
	m™2
è{ (
	m™
-it2.it);}

346 
ZI‹¿tÜ
 
	mİ”©Ü
+(
	mi
è{ ZI‹¿tÜ(
™
+
i
);}

347 
	mZI‹¿tÜ
& 
	mİ”©Ü
+=(
i
è{
™
+=i;  *
	mthis
;}

348 
	m¡d
::
veùÜ
<
ProjeùivePošt
>::
™”©Ü
 
™
;

351 
	gECP
::
Pošt
 
ECP
::
	$SÿÏrMuÉly
(cÚ¡ 
Pošt
 &
P
, cÚ¡ 
IÁeg”
 &
k
) const

353 
EËm’t
 
»suÉ
;

354 ià(
k
.
	`B™CouÁ
() <= 5)

355 
Ab¡¿ùGroup
<
ECPPošt
>::
	`SimuÉªeousMuÉly
(&
»suÉ
, 
P
, &
k
, 1);

357 
ECP
::
	`SimuÉªeousMuÉly
(&
»suÉ
, 
P
, &
k
, 1);

358  
»suÉ
;

359 
	}
}

361 
	gECP
::
	$SimuÉªeousMuÉly
(
ECP
::
Pošt
 *
»suÉs
, cÚ¡ ECP::Pošˆ&
P
, cÚ¡ 
IÁeg”
 *
expBegš
, 
expCouÁ
) const

363 ià(!
	`G‘F›ld
().
	`IsMÚtgom”yR•»£Á©iÚ
())

365 
ECP
 
	`eımr
(*
this
, 
Œue
);

366 cÚ¡ 
ModuÏrAr™hm‘ic
 &
mr
 = 
eımr
.
	`G‘F›ld
();

367 
eımr
.
	`SimuÉªeousMuÉly
(
»suÉs
, 
	`ToMÚtgom”y
(
mr
, 
P
), 
expBegš
, 
expCouÁ
);

368 
i
=0; i<
expCouÁ
; i++)

369 
»suÉs
[
i
] = 
	`FromMÚtgom”y
(
mr
,„esults[i]);

373 
ProjeùiveDoublšg
 
	`rd
(
	`G‘F›ld
(), 
m_a
, 
m_b
, 
P
);

374 
¡d
::
veùÜ
<
ProjeùivePošt
> 
ba£s
;

375 
¡d
::
veùÜ
<
WšdowSlid”
> 
expÚ’ts
;

376 
expÚ’ts
.
	`»£rve
(
expCouÁ
);

377 
¡d
::
veùÜ
<¡d::veùÜ<
wÜd32
> > 
	`ba£Indiûs
(
expCouÁ
);

378 
¡d
::
veùÜ
<¡d::veùÜ<
boŞ
> > 
	`Ãg©eBa£
(
expCouÁ
);

379 
¡d
::
veùÜ
<¡d::veùÜ<
wÜd32
> > 
	`expÚ’tWšdows
(
expCouÁ
);

380 
i
;

382 
i
=0; i<
expCouÁ
; i++)

384 
	`as£¹
(
expBegš
->
	`NÙNeg©ive
());

385 
expÚ’ts
.
	`push_back
(
	`WšdowSlid”
(*
expBegš
++, 
	`Inv”siÚIsFa¡
(), 5));

386 
expÚ’ts
[
i
].
	`FšdNextWšdow
();

389 
expB™Pos™iÚ
 = 0;

390 
boŞ
 
nÙDÚe
 = 
Œue
;

392 
nÙDÚe
)

394 
nÙDÚe
 = 
çl£
;

395 
boŞ
 
ba£Added
 = 
çl£
;

396 
i
=0; i<
expCouÁ
; i++)

398 ià(!
expÚ’ts
[
i
].
fšished
 && 
expB™Pos™iÚ
 =ğexpÚ’ts[i].
wšdowBegš
)

400 ià(!
ba£Added
)

402 
ba£s
.
	`push_back
(
rd
.
P
);

403 
ba£Added
 =
Œue
;

406 
expÚ’tWšdows
[
i
].
	`push_back
(
expÚ’ts
[i].
expWšdow
);

407 
ba£Indiûs
[
i
].
	`push_back
((
wÜd32
)
ba£s
.
	`size
()-1);

408 
Ãg©eBa£
[
i
].
	`push_back
(
expÚ’ts
[i].
Ãg©eNext
);

410 
expÚ’ts
[
i
].
	`FšdNextWšdow
();

412 
nÙDÚe
 =‚ÙDÚ|| !
expÚ’ts
[
i
].
fšished
;

415 ià(
nÙDÚe
)

417 
rd
.
	`DoubË
();

418 
expB™Pos™iÚ
++;

423 
	`P¬®ËlInv”t
(
	`G‘F›ld
(), 
	`ZI‹¿tÜ
(
ba£s
.
	`begš
()), ZI‹¿tÜ(ba£s.
	`’d
()));

424 
i
=0; i<
ba£s
.
	`size
(); i++)

426 ià(
ba£s
[
i
].
z
.
	`NÙZ”o
())

428 
ba£s
[
i
].
y
 = 
	`G‘F›ld
().
	`MuÉly
(ba£s[i].y, ba£s[i].
z
);

429 
ba£s
[
i
].
z
 = 
	`G‘F›ld
().
	`Squ¬e
(bases[i].z);

430 
ba£s
[
i
].
x
 = 
	`G‘F›ld
().
	`MuÉly
(ba£s[i].x, ba£s[i].
z
);

431 
ba£s
[
i
].
y
 = 
	`G‘F›ld
().
	`MuÉly
(ba£s[i].y, ba£s[i].
z
);

435 
¡d
::
veùÜ
<
Ba£AndExpÚ’t
<
Pošt
, 
IÁeg”
> > 
fš®Casÿde
;

436 
i
=0; i<
expCouÁ
; i++)

438 
fš®Casÿde
.
	`»size
(
ba£Indiûs
[
i
].
	`size
());

439 
j
=0; j<
ba£Indiûs
[
i
].
	`size
(); j++)

441 
ProjeùivePošt
 &
ba£
 = 
ba£s
[
ba£Indiûs
[
i
][
j
]];

442 ià(
ba£
.
z
.
	`IsZ”o
())

443 
fš®Casÿde
[
j
].
ba£
.
id’t™y
 = 
Œue
;

446 
fš®Casÿde
[
j
].
ba£
.
id’t™y
 = 
çl£
;

447 
fš®Casÿde
[
j
].
ba£
.
x
 = base.x;

448 ià(
Ãg©eBa£
[
i
][
j
])

449 
fš®Casÿde
[
j
].
ba£
.
y
 = 
	`G‘F›ld
().
	`Inv”£
(base.y);

451 
fš®Casÿde
[
j
].
ba£
.
y
 = base.y;

453 
fš®Casÿde
[
j
].
expÚ’t
 = 
	`IÁeg”
(
IÁeg”
::
POSITIVE
, 0, 
expÚ’tWšdows
[
i
][j]);

455 
»suÉs
[
i
] = 
	`G’”®CasÿdeMuÉliÿtiÚ
(*
this
, 
fš®Casÿde
.
	`begš
(), fš®Casÿde.
	`’d
());

457 
	}
}

459 
	gECP
::
Pošt
 
ECP
::
	$CasÿdeSÿÏrMuÉly
(cÚ¡ 
Pošt
 &
P
, cÚ¡ 
IÁeg”
 &
k1
, cÚ¡ Pošˆ&
Q
, cÚ¡ IÁeg” &
k2
) const

461 ià(!
	`G‘F›ld
().
	`IsMÚtgom”yR•»£Á©iÚ
())

463 
ECP
 
	`eımr
(*
this
, 
Œue
);

464 cÚ¡ 
ModuÏrAr™hm‘ic
 &
mr
 = 
eımr
.
	`G‘F›ld
();

465  
	`FromMÚtgom”y
(
mr
, 
eımr
.
	`CasÿdeSÿÏrMuÉly
(
	`ToMÚtgom”y
(mr, 
P
), 
k1
, ToMÚtgom”y(mr, 
Q
), 
k2
));

468  
Ab¡¿ùGroup
<
Pošt
>::
	`CasÿdeSÿÏrMuÉly
(
P
, 
k1
, 
Q
, 
k2
);

469 
	}
}

471 
	gNAMESPACE_END


	@ecp.h

1 #iâdeà
CRYPTOPP_ECP_H


2 
	#CRYPTOPP_ECP_H


	)

4 
	~"mod¬™h.h
"

5 
	~"•»comp.h
"

6 
	~"sm¬Œ.h
"

7 
	~"pubkey.h
"

9 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

12 
CRYPTOPP_DLL
 
ECPPošt


14 
	`ECPPošt
(è: 
	`id’t™y
(
Œue
) {}

15 
	`ECPPošt
(cÚ¡ 
IÁeg”
 &
x
, cÚ¡ IÁeg” &
y
)

16 : 
	`id’t™y
(
çl£
), 
	`x
(
x
), 
	`y
(
y
) {}

18 
boŞ
 
İ”©Ü
==(cÚ¡ 
ECPPošt
 &
t
) const

19 { (
id’t™y
 && 
t
.id’t™yè|| (!id’t™y && !t.id’t™y && 
x
=ñ.x && 
y
==t.y);}

20 
boŞ
 
İ”©Ü
< (cÚ¡ 
ECPPošt
 &
t
) const

21 { 
id’t™y
 ? !
t
.id’t™y : (!t.id’t™y && (
x
<t.x || (x=ñ.x && 
y
<t.y)));}

23 
boŞ
 
id’t™y
;

24 
IÁeg”
 
x
, 
y
;

25 
	}
};

27 
CRYPTOPP_DLL_TEMPLATE_CLASS
 
	gAb¡¿ùGroup
<
	gECPPošt
>;

30 
şass
 
CRYPTOPP_DLL
 
	gECP
 : 
public
 
Ab¡¿ùGroup
<
ECPPošt
>

32 
public
:

33 
ModuÏrAr™hm‘ic
 
	tF›ld
;

34 
IÁeg”
 
	tF›ldEËm’t
;

35 
ECPPošt
 
	tPošt
;

37 
ECP
() {}

38 
ECP
(cÚ¡ ECP &
eı
, 
boŞ
 
cÚv”tToMÚtgom”yR•»£Á©iÚ
 = 
çl£
);

39 
ECP
(cÚ¡ 
IÁeg”
 &
modulus
, cÚ¡ 
F›ldEËm’t
 &
a
, cÚ¡ F›ldEËm’ˆ&
b
)

40 : 
m_f›ldPŒ
(
Ãw
 
F›ld
(
modulus
)), 
m_a
(
a
.
IsNeg©ive
(è? modulus+¨:‡), 
m_b
(
b
) {}

43 
ECP
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
);

46 
DEREncode
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
) const;

48 
boŞ
 
Equ®
(cÚ¡ 
Pošt
 &
P
, cÚ¡ Pošˆ&
Q
) const;

49 cÚ¡ 
	gPošt
& 
Id’t™y
() const;

50 cÚ¡ 
	gPošt
& 
Inv”£
(cÚ¡ 
Pošt
 &
P
) const;

51 
boŞ
 
Inv”siÚIsFa¡
(ècÚ¡ { 
	gŒue
;}

52 cÚ¡ 
	gPošt
& 
Add
(cÚ¡ 
Pošt
 &
P
, cÚ¡ Pošˆ&
Q
) const;

53 cÚ¡ 
	gPošt
& 
DoubË
(cÚ¡ 
Pošt
 &
P
) const;

54 
Pošt
 
SÿÏrMuÉly
(cÚ¡ Pošˆ&
P
, cÚ¡ 
IÁeg”
 &
k
) const;

55 
Pošt
 
CasÿdeSÿÏrMuÉly
(cÚ¡ Pošˆ&
P
, cÚ¡ 
IÁeg”
 &
k1
, cÚ¡ Pošˆ&
Q
, cÚ¡ IÁeg” &
k2
) const;

56 
SimuÉªeousMuÉly
(
Pošt
 *
»suÉs
, cÚ¡ Pošˆ&
ba£
, cÚ¡ 
IÁeg”
 *
expÚ’ts
, 
expÚ’tsCouÁ
) const;

58 
Pošt
 
MuÉly
(cÚ¡ 
IÁeg”
 &
k
, cÚ¡ Pošˆ&
P
) const

59 { 
SÿÏrMuÉly
(
P
, 
k
);}

60 
Pošt
 
CasÿdeMuÉly
(cÚ¡ 
IÁeg”
 &
k1
, cÚ¡ Pošˆ&
P
, cÚ¡ IÁeg” &
k2
, cÚ¡ Pošˆ&
Q
) const

61 { 
CasÿdeSÿÏrMuÉly
(
P
, 
k1
, 
Q
, 
k2
);}

63 
boŞ
 
V®id©eP¬am‘”s
(
RªdomNumb”G’”©Ü
 &
ºg
, 
Ëv–
=3) const;

64 
boŞ
 
V”ifyPošt
(cÚ¡ 
Pošt
 &
P
) const;

66 
EncodedPoštSize
(
boŞ
 
com´es£d
 = 
çl£
) const

67 { 1 + (
com´es£d
?1:2)*
G‘F›ld
().
MaxEËm’tBy‹L’gth
();}

69 
boŞ
 
DecodePošt
(
Pošt
 &
P
, 
Bufã»dT¿nsfÜm©iÚ
 &
bt
, 
size_t
 
Ën
) const;

70 
boŞ
 
DecodePošt
(
Pošt
 &
P
, cÚ¡ 
by‹
 *
’codedPošt
, 
size_t
 
Ën
) const;

71 
EncodePošt
(
by‹
 *
’codedPošt
, cÚ¡ 
Pošt
 &
P
, 
boŞ
 
com´es£d
) const;

72 
EncodePošt
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
, cÚ¡ 
Pošt
 &
P
, 
boŞ
 
com´es£d
) const;

74 
Pošt
 
BERDecodePošt
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
) const;

75 
DEREncodePošt
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
, cÚ¡ 
Pošt
 &
P
, 
boŞ
 
com´es£d
) const;

77 
IÁeg”
 
F›ldSize
(ècÚ¡ { 
G‘F›ld
().
G‘Modulus
();}

78 cÚ¡ 
	gF›ld
 & 
G‘F›ld
(ècÚ¡ { *
	gm_f›ldPŒ
;}

79 cÚ¡ 
	gF›ldEËm’t
 & 
G‘A
(ècÚ¡ { 
	gm_a
;}

80 cÚ¡ 
	gF›ldEËm’t
 & 
G‘B
(ècÚ¡ { 
	gm_b
;}

82 
boŞ
 
	gİ”©Ü
==(cÚ¡ 
ECP
 &
rhs
) const

83 { 
G‘F›ld
(è=ğ
rhs
.G‘F›ld(è&& 
m_a
 =ğrhs.m_¨&& 
m_b
 ==„hs.m_b;}

85 
	g´iv©e
:

86 
şÚabË_±r
<
F›ld
> 
m_f›ldPŒ
;

87 
F›ldEËm’t
 
	gm_a
, 
	gm_b
;

88 
mubË
 
Pošt
 
	gm_R
;

91 
CRYPTOPP_DLL_TEMPLATE_CLASS
 
	gDL_FixedBa£P»computiÚIm¶
<
	gECP
::
Pošt
>;

92 
CRYPTOPP_DLL_TEMPLATE_CLASS
 
	gDL_GroupP»computiÚ
<
	gECP
::
Pošt
>;

94 
	g‹m¶©e
 <
şass
 
	gT
> cÏs 
	gEcP»computiÚ
;

97 
	g‹m¶©e
<> 
şass
 
	gEcP»computiÚ
<
	gECP
> : 
public
 
DL_GroupP»computiÚ
<
ECP
::
Pošt
>

99 
public
:

100 
ECP
 
	tEÎticCurve
;

103 
boŞ
 
N“dCÚv”siÚs
(ècÚ¡ { 
	gŒue
;}

104 
EËm’t
 
CÚv”tIn
(cÚ¡ EËm’ˆ&
P
) const

105 { 
	gP
.
	gid’t™y
 ? P : 
ECP
::
Pošt
(
m_ec
->
G‘F›ld
().
CÚv”tIn
(
P
.
x
), m_ec->G‘F›ld().CÚv”tIn(P.
y
));};

106 
EËm’t
 
CÚv”tOut
(cÚ¡ EËm’ˆ&
P
) const

107 { 
	gP
.
	gid’t™y
 ? P : 
ECP
::
Pošt
(
m_ec
->
G‘F›ld
().
CÚv”tOut
(
P
.
x
), m_ec->G‘F›ld().CÚv”tOut(P.
y
));}

108 cÚ¡ 
	gAb¡¿ùGroup
<
	gEËm’t
> & 
G‘Group
(ècÚ¡ { *
	gm_ec
;}

109 
EËm’t
 
BERDecodeEËm’t
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
ècÚ¡ { 
	gm_ec
->
BERDecodePošt
(bt);}

110 
DEREncodeEËm’t
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
, cÚ¡ 
EËm’t
 &
v
ècÚ¡ {
	gm_ec
->
DEREncodePošt
(bt, v, 
çl£
);}

113 
S‘Curve
(cÚ¡ 
ECP
 &
ec
)

115 
	gm_ec
.
»£t
(
Ãw
 
ECP
(
ec
, 
Œue
));

116 
	gm_ecOrigš®
 = 
ec
;

118 cÚ¡ 
	gECP
 & 
G‘Curve
(ècÚ¡ { *
	gm_ecOrigš®
;}

120 
	g´iv©e
:

121 
v®ue_±r
<
ECP
> 
m_ec
, 
	gm_ecOrigš®
;

124 
	gNAMESPACE_END


	@elgamal.cpp

3 
	~"pch.h
"

4 
	~"–gam®.h
"

5 
	~"a¢.h
"

6 
	~"nbtheÜy.h
"

8 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

10 
	$ElGam®_Te¡In¡ªtŸtiÚs
()

12 
ElGam®Enüy±Ü
 
	`‹¡1
(1, 1, 1);

13 
ElGam®Deüy±Ü
 
	`‹¡2
(
	`NuÎRNG
(), 123);

14 
ElGam®Enüy±Ü
 
	`‹¡3
(
‹¡2
);

15 
	}
}

17 
	gNAMESPACE_END


	@elgamal.h

1 #iâdeà
CRYPTOPP_ELGAMAL_H


2 
	#CRYPTOPP_ELGAMAL_H


	)

4 
	~"modexµc.h
"

5 
	~"d§.h
"

7 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

9 
şass
 
CRYPTOPP_NO_VTABLE
 
ElGam®Ba£
 : 
public
 
DL_KeyAg»em’tAlgÜ™hm_DH
<
IÁeg”
, 
NoCoçùÜMuÉliÿtiÚ
>,

10 
public
 
DL_KeyD”iv©iÚAlgÜ™hm
<
IÁeg”
>,

11 
public
 
DL_Symm‘ricEnüy±iÚAlgÜ™hm


13 
public
:

14 
	`D”ive
(cÚ¡ 
DL_GroupP¬am‘”s
<
IÁeg”
> &
groupP¬ams
, 
by‹
 *
d”ivedKey
, 
size_t
 
d”ivedL’gth
, cÚ¡ IÁeg” &
ag»edEËm’t
, cÚ¡ IÁeg” &
•hem”®PublicKey
, cÚ¡ 
NameV®uePaœs
 &
d”iv©iÚP¬ams
) const

16 
ag»edEËm’t
.
	`Encode
(
d”ivedKey
, 
d”ivedL’gth
);

19 
size_t
 
	`G‘Symm‘ricKeyL’gth
(size_ˆ
¶ašTextL’gth
) const

21  
	`G‘GroupP¬am‘”s
().
	`G‘Modulus
().
	`By‹CouÁ
();

24 
size_t
 
	`G‘Symm‘ricCh”‹xtL’gth
(size_ˆ
¶ašTextL’gth
) const

26 
Ën
 = 
	`G‘GroupP¬am‘”s
().
	`G‘Modulus
().
	`By‹CouÁ
();

27 ià(
¶ašTextL’gth
 <ğ
	`G‘MaxSymm‘ricPÏš‹xtL’gth
(
Ën
))

28  
Ën
;

33 
size_t
 
	`G‘MaxSymm‘ricPÏš‹xtL’gth
(size_ˆ
ch”TextL’gth
) const

35 
Ën
 = 
	`G‘GroupP¬am‘”s
().
	`G‘Modulus
().
	`By‹CouÁ
();

36 ià(
ch”TextL’gth
 =ğ
Ën
)

37  
	`STDMIN
(255U, 
Ën
-3);

42 
	`Symm‘ricEnüy±
(
RªdomNumb”G’”©Ü
 &
ºg
, cÚ¡ 
by‹
 *
key
, cÚ¡ by‹ *
¶ašText
, 
size_t
 
¶ašTextL’gth
, by‹ *
ch”Text
, cÚ¡ 
NameV®uePaœs
 &
·¿m‘”s
) const

44 cÚ¡ 
IÁeg”
 &
p
 = 
	`G‘GroupP¬am‘”s
().
	`G‘Modulus
();

45 
modulusL’
 = 
p
.
	`By‹CouÁ
();

47 
SecBy‹Block
 
	`block
(
modulusL’
-1);

48 
ºg
.
	`G’”©eBlock
(
block
, 
modulusL’
-2-
¶ašTextL’gth
);

49 
	`memıy
(
block
+
modulusL’
-2-
¶ašTextL’gth
, 
¶ašText
,…lainTextLength);

50 
block
[
modulusL’
-2] = (
by‹
)
¶ašTextL’gth
;

52 
	`a_times_b_mod_c
(
	`IÁeg”
(
key
, 
modulusL’
), IÁeg”(
block
, modulusL’-1), 
p
).
	`Encode
(
ch”Text
, modulusLen);

55 
DecodšgResuÉ
 
	`Symm‘ricDeüy±
(cÚ¡ 
by‹
 *
key
, cÚ¡ by‹ *
ch”Text
, 
size_t
 
ch”TextL’gth
, by‹ *
¶ašText
, cÚ¡ 
NameV®uePaœs
 &
·¿m‘”s
) const

57 cÚ¡ 
IÁeg”
 &
p
 = 
	`G‘GroupP¬am‘”s
().
	`G‘Modulus
();

58 
modulusL’
 = 
p
.
	`By‹CouÁ
();

60 ià(
ch”TextL’gth
 !ğ
modulusL’
)

61  
	`DecodšgResuÉ
();

63 
IÁeg”
 
m
 = 
	`a_times_b_mod_c
(
	`IÁeg”
(
ch”Text
, 
modulusL’
), IÁeg”(
key
, modulusL’).
	`Inv”£Mod
(
p
),…);

65 
m
.
	`Encode
(
¶ašText
, 1);

66 
¶ašTextL’gth
 = 
¶ašText
[0];

67 ià(
¶ašTextL’gth
 > 
	`G‘MaxSymm‘ricPÏš‹xtL’gth
(
modulusL’
))

68  
	`DecodšgResuÉ
();

69 
m
 >>= 8;

70 
m
.
	`Encode
(
¶ašText
, 
¶ašTextL’gth
);

71  
	`DecodšgResuÉ
(
¶ašTextL’gth
);

74 
vœtu®
 cÚ¡ 
DL_GroupP¬am‘”s_GFP
 & 
	`G‘GroupP¬am‘”s
() const =0;

75 
	}
};

77 
	g‹m¶©e
 <
şass
 
	gBASE
, cÏs 
	gSCHEME_OPTIONS
, cÏs 
	gKEY
>

78 
şass
 
	gElGam®ObjeùIm¶
 : 
public
 
DL_ObjeùIm¶Ba£
<
BASE
, 
	gSCHEME_OPTIONS
, 
	gKEY
>,…ubliø
	gElGam®Ba£


80 
	gpublic
:

81 
size_t
 
FixedMaxPÏš‹xtL’gth
(ècÚ¡ { 
this
->
MaxPÏš‹xtL’gth
(
FixedCh”‹xtL’gth
());}

82 
size_t
 
FixedCh”‹xtL’gth
(ècÚ¡ { 
	gthis
->
Ch”‹xtL’gth
(0);}

84 cÚ¡ 
	gDL_GroupP¬am‘”s_GFP
 & 
G‘GroupP¬am‘”s
(ècÚ¡ { 
	gthis
->
G‘Key
().GetGroupParameters();}

86 
DecodšgResuÉ
 
FixedL’gthDeüy±
(
RªdomNumb”G’”©Ü
 &
ºg
, cÚ¡ 
by‹
 *
ch”Text
, by‹ *
¶ašText
) const

87 { 
Deüy±
(
ºg
, 
ch”Text
, 
FixedCh”‹xtL’gth
(), 
¶ašText
);}

89 
	g´Ùeùed
:

90 cÚ¡ 
DL_KeyAg»em’tAlgÜ™hm
<
IÁeg”
> & 
G‘KeyAg»em’tAlgÜ™hm
(ècÚ¡ { *
this
;}

91 cÚ¡ 
	gDL_KeyD”iv©iÚAlgÜ™hm
<
	gIÁeg”
> & 
G‘KeyD”iv©iÚAlgÜ™hm
(ècÚ¡ { *
	gthis
;}

92 cÚ¡ 
	gDL_Symm‘ricEnüy±iÚAlgÜ™hm
 & 
G‘Symm‘ricEnüy±iÚAlgÜ™hm
(ècÚ¡ { *
	gthis
;}

95 
	sElGam®Keys


97 
	mDL_Cry±oKeys_GFP
::
	tGroupP¬am‘”s
 GroupParameters;

98 
	mDL_Priv©eKey_GFP_OldFÜm©
<
	tDL_Cry±oKeys_GFP
::
	tPriv©eKey
> PrivateKey;

99 
	mDL_PublicKey_GFP_OldFÜm©
<
	tDL_Cry±oKeys_GFP
::
	tPublicKey
> PublicKey;

103 
	sElGam®


105 
	mDL_Cry±oSchemeO±iÚs
<
	tElGam®
, 
	tElGam®Keys
, , , > 
	tSchemeO±iÚs
;

107 cÚ¡ * 
SticAlgÜ™hmName
() { "ElgamalEnc/Crypto++Padding";}

109 
	mSchemeO±iÚs
::
	tGroupP¬am‘”s
 GroupParameters;

111 
	mPK_Fš®Tem¶©e
<
	tElGam®ObjeùIm¶
<
	tDL_Enüy±ÜBa£
<
	tIÁeg”
>, 
	tSchemeO±iÚs
, SchemeO±iÚs::
	tPublicKey
> > 
	tEnüy±Ü
;

113 
	mPK_Fš®Tem¶©e
<
	tElGam®ObjeùIm¶
<
	tDL_Deüy±ÜBa£
<
	tIÁeg”
>, 
	tSchemeO±iÚs
, SchemeO±iÚs::
	tPriv©eKey
> > 
	tDeüy±Ü
;

116 
	gElGam®
::
	tEnüy±Ü
 
	tElGam®Enüy±Ü
;

117 
	gElGam®
::
	tDeüy±Ü
 
	tElGam®Deüy±Ü
;

119 
	gNAMESPACE_END


	@emsa2.cpp

3 
	~"pch.h
"

4 
	~"em§2.h
"

6 #iâdeà
CRYPTOPP_IMPORTS


8 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

10 
EMSA2Pad
::
	$Compu‹Mes§geR•»£Á©ive
(
RªdomNumb”G’”©Ü
 &
ºg
,

11 cÚ¡ 
by‹
 *
»cov”abËMes§ge
, 
size_t
 
»cov”abËMes§geL’gth
,

12 
HashT¿nsfÜm©iÚ
 &
hash
, 
HashId’tif›r
 
hashId’tif›r
, 
boŞ
 
mes§geEm±y
,

13 
by‹
 *
»´e£Á©ive
, 
size_t
 
»´e£Á©iveB™L’gth
) const

15 
	`as£¹
(
»´e£Á©iveB™L’gth
 >ğ
	`MšR•»£Á©iveB™L’gth
(
hashId’tif›r
.
£cÚd
, 
hash
.
	`Dige¡Size
()));

17 ià(
»´e£Á©iveB™L’gth
 % 8 != 7)

18 
throw
 
PK_SigÇtu»Scheme
::
	`Inv®idKeyL’gth
("EMSA2: EMSA2„equires‡ key†engthhat is‡ multiple of 8");

20 
size_t
 
dige¡Size
 = 
hash
.
	`Dige¡Size
();

21 
size_t
 
»´e£Á©iveBy‹L’gth
 = 
	`B™sToBy‹s
(
»´e£Á©iveB™L’gth
);

23 
»´e£Á©ive
[0] = 
mes§geEm±y
 ? 0x4b : 0x6b;

24 
	`mem£t
(
»´e£Á©ive
+1, 0xbb, 
»´e£Á©iveBy‹L’gth
-
dige¡Size
-4);

25 
by‹
 *
aá”P2
 = 
»´e£Á©ive
+
»´e£Á©iveBy‹L’gth
-
dige¡Size
-3;

26 
aá”P2
[0] = 0xba;

27 
hash
.
	`Fš®
(
aá”P2
+1);

28 
»´e£Á©ive
[
»´e£Á©iveBy‹L’gth
-2] = *
hashId’tif›r
.
fœ¡
;

29 
»´e£Á©ive
[
»´e£Á©iveBy‹L’gth
-1] = 0xcc;

30 
	}
}

32 
	gNAMESPACE_END


	@emsa2.h

1 #iâdeà
CRYPTOPP_EMSA2_H


2 
	#CRYPTOPP_EMSA2_H


	)

8 
	~"üy±lib.h
"

9 
	~"pubkey.h
"

11 #ifdeà
CRYPTOPP_IS_DLL


12 
	~"sha.h
"

15 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

17 
‹m¶©e
 <
şass
 
H
> cÏs 
	cEMSA2HashId


19 
public
:

20 cÚ¡ 
by‹
 
id
;

23 
‹m¶©e
 <
şass
 
BASE
>

24 şas 
	cEMSA2HashIdLookup
 : 
public
 
BASE


26 
public
:

27 
	sHashId’tif›rLookup


29 
‹m¶©e
 <
şass
 
H
> 
	sHashId’tif›rLookup2


31 
HashId’tif›r
 
	`Lookup
()

33  
	`HashId’tif›r
(&
EMSA2HashId
<
H
>::
id
, 1);

37 
	}
};

40 
şass
 
	gSHA1
;

41 
şass
 
	gRIPEMD160
;

42 
şass
 
	gRIPEMD128
;

43 
şass
 
	gSHA256
;

44 
şass
 
	gSHA384
;

45 
şass
 
	gSHA512
;

46 
şass
 
	gWhœÍoŞ
;

47 
şass
 
	gSHA224
;

50 #ifdeà
CRYPTOPP_IS_DLL


51 
CRYPTOPP_DLL_TEMPLATE_CLASS
 
	gEMSA2HashId
<
	gSHA1
>;

52 
CRYPTOPP_DLL_TEMPLATE_CLASS
 
	gEMSA2HashId
<
	gSHA224
>;

53 
CRYPTOPP_DLL_TEMPLATE_CLASS
 
	gEMSA2HashId
<
	gSHA256
>;

54 
CRYPTOPP_DLL_TEMPLATE_CLASS
 
	gEMSA2HashId
<
	gSHA384
>;

55 
CRYPTOPP_DLL_TEMPLATE_CLASS
 
	gEMSA2HashId
<
	gSHA512
>;

59 
şass
 
CRYPTOPP_DLL
 
	gEMSA2Pad
 : 
public
 
EMSA2HashIdLookup
<
PK_D‘”mši¡icSigÇtu»Mes§geEncodšgM‘hod
>

61 
public
:

62 cÚ¡ * 
CRYPTOPP_API
 
SticAlgÜ™hmName
() { "EMSA2";}

64 
size_t
 
MšR•»£Á©iveB™L’gth
(size_ˆ
hashId’tif›rL’gth
, size_ˆ
dige¡L’gth
) const

65 { 8*
	gdige¡L’gth
 + 31;}

67 
Compu‹Mes§geR•»£Á©ive
(
RªdomNumb”G’”©Ü
 &
ºg
,

68 cÚ¡ 
by‹
 *
»cov”abËMes§ge
, 
size_t
 
»cov”abËMes§geL’gth
,

69 
HashT¿nsfÜm©iÚ
 &
hash
, 
HashId’tif›r
 
hashId’tif›r
, 
boŞ
 
mes§geEm±y
,

70 
by‹
 *
»´e£Á©ive
, 
size_t
 
»´e£Á©iveB™L’gth
) const;

79 
	gP1363_EMSA2
 : 
public
 
SigÇtu»Snd¬d


81 
EMSA2Pad
 
	tSigÇtu»Mes§geEncodšgM‘hod
;

84 
	gNAMESPACE_END


	@eprecomp.cpp

3 
	~"pch.h
"

5 #iâdeà
CRYPTOPP_IMPORTS


7 
	~"•»comp.h
"

8 
	~"a¢.h
"

10 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

12 
‹m¶©e
 <
şass
 
T
> 
DL_FixedBa£P»computiÚIm¶
<T>::
	`S‘Ba£
(cÚ¡ 
DL_GroupP»computiÚ
<
EËm’t
> &
group
, cÚ¡ EËm’ˆ&
i_ba£
)

14 
m_ba£
 = 
group
.
	`N“dCÚv”siÚs
(è? group.
	`CÚv”tIn
(
i_ba£
) : i_base;

16 ià(
m_ba£s
.
	`em±y
(è|| !(
m_ba£
 == m_bases[0]))

18 
m_ba£s
.
	`»size
(1);

19 
m_ba£s
[0] = 
m_ba£
;

22 ià(
group
.
	`N“dCÚv”siÚs
())

23 
m_ba£
 = 
i_ba£
;

24 
	}
}

26 
	g‹m¶©e
 <
şass
 
	gT
> 
	gDL_FixedBa£P»computiÚIm¶
<T>::
P»compu‹
(cÚ¡ 
DL_GroupP»computiÚ
<
EËm’t
> &
group
, 
maxExpB™s
, 
¡Üage
)

28 
as£¹
(
m_ba£s
.
size
() > 0);

29 
as£¹
(
¡Üage
 <ğ
maxExpB™s
);

31 ià(
	g¡Üage
 > 1)

33 
	gm_wšdowSize
 = (
maxExpB™s
+
¡Üage
-1)/storage;

34 
	gm_expÚ’tBa£
 = 
IÁeg”
::
Pow”2
(
m_wšdowSize
);

37 
	gm_ba£s
.
»size
(
¡Üage
);

38 
	gi
=1; i<
	g¡Üage
; i++)

39 
	gm_ba£s
[
i
] = 
group
.
G‘Group
().
SÿÏrMuÉly
(
m_ba£s
[i-1], 
m_expÚ’tBa£
);

42 
	g‹m¶©e
 <
şass
 
	gT
> 
	gDL_FixedBa£P»computiÚIm¶
<T>::
Lßd
(cÚ¡ 
DL_GroupP»computiÚ
<
EËm’t
> &
group
, 
Bufã»dT¿nsfÜm©iÚ
 &
bt
)

44 
BERSequ’ûDecod”
 
£q
(
bt
);

45 
wÜd32
 
	gv”siÚ
;

46 
	gBERDecodeUnsigÃd
<
	gwÜd32
>(
	g£q
, 
	gv”siÚ
, 
	gINTEGER
, 1, 1);

47 
	gm_expÚ’tBa£
.
BERDecode
(
£q
);

48 
	gm_wšdowSize
 = 
m_expÚ’tBa£
.
B™CouÁ
() - 1;

49 
	gm_ba£s
.
ş—r
();

50 !
	g£q
.
EndR—ched
())

51 
	gm_ba£s
.
push_back
(
group
.
BERDecodeEËm’t
(
£q
));

52 ià(!
	gm_ba£s
.
em±y
(è&& 
	ggroup
.
N“dCÚv”siÚs
())

53 
	gm_ba£
 = 
group
.
CÚv”tOut
(
m_ba£s
[0]);

54 
	g£q
.
Mes§geEnd
();

57 
	g‹m¶©e
 <
şass
 
	gT
> 
	gDL_FixedBa£P»computiÚIm¶
<T>::
Save
(cÚ¡ 
DL_GroupP»computiÚ
<
EËm’t
> &
group
, 
Bufã»dT¿nsfÜm©iÚ
 &
bt
) const

59 
DERSequ’ûEncod”
 
£q
(
bt
);

60 
	gDEREncodeUnsigÃd
<
	gwÜd32
>(
	g£q
, 1);

61 
	gm_expÚ’tBa£
.
DEREncode
(
£q
);

62 
	gi
=0; i<
	gm_ba£s
.
size
(); i++)

63 
	ggroup
.
DEREncodeEËm’t
(
£q
, 
m_ba£s
[
i
]);

64 
	g£q
.
Mes§geEnd
();

67 
	g‹m¶©e
 <
şass
 
	gT
> 
	gDL_FixedBa£P»computiÚIm¶
<T>::
P»·»Casÿde
(cÚ¡ 
DL_GroupP»computiÚ
<
EËm’t
> &
i_group
, 
¡d
::
veùÜ
<
Ba£AndExpÚ’t
<EËm’t> > &
eb
, cÚ¡ 
IÁeg”
 &
expÚ’t
) const

69 cÚ¡ 
	gAb¡¿ùGroup
<
	gT
> &
	ggroup
 = 
i_group
.
G‘Group
();

71 
IÁeg”
 
	gr
, 
	gq
, 
	ge
 = 
expÚ’t
;

72 
boŞ
 
	gç¡Neg©e
 = 
group
.
Inv”siÚIsFa¡
(è&& 
m_wšdowSize
 > 1;

73 
	gi
;

75 
	gi
=0; i+1<
	gm_ba£s
.
size
(); i++)

77 
	gIÁeg”
::
DivideByPow”Of2
(
r
, 
q
, 
e
, 
m_wšdowSize
);

78 
	g¡d
::
sw­
(
q
, 
e
);

79 ià(
	gç¡Neg©e
 && 
	gr
.
G‘B™
(
m_wšdowSize
-1))

81 ++
	ge
;

82 
	geb
.
push_back
(
Ba£AndExpÚ’t
<
EËm’t
>(
group
.
Inv”£
(
m_ba£s
[
i
]), 
m_expÚ’tBa£
 - 
r
));

85 
	geb
.
push_back
(
Ba£AndExpÚ’t
<
EËm’t
>(
m_ba£s
[
i
], 
r
));

87 
	geb
.
push_back
(
Ba£AndExpÚ’t
<
EËm’t
>(
m_ba£s
[
i
], 
e
));

90 
	g‹m¶©e
 <
şass
 
	gT
> 
T
 
	gDL_FixedBa£P»computiÚIm¶
<T>::
ExpÚ’tŸ‹
(cÚ¡ 
DL_GroupP»computiÚ
<
EËm’t
> &
group
, cÚ¡ 
IÁeg”
 &
expÚ’t
) const

92 
	g¡d
::
veùÜ
<
Ba£AndExpÚ’t
<
EËm’t
> > 
eb
;

93 
	geb
.
»£rve
(
m_ba£s
.
size
());

94 
P»·»Casÿde
(
group
, 
eb
, 
expÚ’t
);

95  
	ggroup
.
CÚv”tOut
(
G’”®CasÿdeMuÉliÿtiÚ
<
EËm’t
>(
group
.
G‘Group
(), 
eb
.
begš
(),ƒb.
’d
()));

98 
	g‹m¶©e
 <
şass
 
	gT
> 
T


99 
	gDL_FixedBa£P»computiÚIm¶
<
	gT
>::
CasÿdeExpÚ’tŸ‹
(cÚ¡ 
DL_GroupP»computiÚ
<
EËm’t
> &
group
, cÚ¡ 
IÁeg”
 &
expÚ’t
,

100 cÚ¡ 
DL_FixedBa£P»computiÚ
<
T
> &
i_pc2
, cÚ¡ 
IÁeg”
 &
expÚ’t2
) const

102 
	g¡d
::
veùÜ
<
Ba£AndExpÚ’t
<
EËm’t
> > 
eb
;

103 cÚ¡ 
	gDL_FixedBa£P»computiÚIm¶
<
	gT
> &
	gpc2
 = 
¡©ic_ÿ¡
<cÚ¡ 
DL_FixedBa£P»computiÚIm¶
<
T
> &>(
i_pc2
);

104 
	geb
.
»£rve
(
m_ba£s
.
size
(è+ 
pc2
.m_bases.size());

105 
P»·»Casÿde
(
group
, 
eb
, 
expÚ’t
);

106 
	gpc2
.
P»·»Casÿde
(
group
, 
eb
, 
expÚ’t2
);

107  
	ggroup
.
CÚv”tOut
(
G’”®CasÿdeMuÉliÿtiÚ
<
EËm’t
>(
group
.
G‘Group
(), 
eb
.
begš
(),ƒb.
’d
()));

110 
	gNAMESPACE_END


	@eprecomp.h

1 #iâdeà
CRYPTOPP_EPRECOMP_H


2 
	#CRYPTOPP_EPRECOMP_H


	)

4 
	~"š‹g”.h
"

5 
	~"®geb¿.h
"

6 
	~<veùÜ
>

8 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

10 
‹m¶©e
 <
şass
 
T
>

11 şas 
	cDL_GroupP»computiÚ


13 
public
:

14 
T
 
	tEËm’t
;

16 
vœtu®
 
boŞ
 
	$N“dCÚv”siÚs
(ècÚ¡ { 
çl£
;}

17 
vœtu®
 
EËm’t
 
	$CÚv”tIn
(cÚ¡ 
EËm’t
 &
v
ècÚ¡ { v;
	}
}

18 
vœtu®
 
EËm’t
 
	$CÚv”tOut
(cÚ¡ 
EËm’t
 &
v
ècÚ¡ { v;
	}
}

19 
vœtu®
 cÚ¡ 
	gAb¡¿ùGroup
<
	gEËm’t
> & 
	$G‘Group
() const =0;

20 
vœtu®
 
EËm’t
 
	$BERDecodeEËm’t
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
) const =0;

21 
vœtu®
 
	$DEREncodeEËm’t
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
, cÚ¡ 
EËm’t
 &
P
) const =0;

22 
	}
};

24 
	g‹m¶©e
 <
şass
 
	gT
>

25 şas 
	cDL_FixedBa£P»computiÚ


27 
	mpublic
:

28 
T
 
	tEËm’t
;

30 
vœtu®
 
boŞ
 
	$IsIn™Ÿlized
() const =0;

31 
vœtu®
 
	`S‘Ba£
(cÚ¡ 
DL_GroupP»computiÚ
<
EËm’t
> &
group
, cÚ¡ EËm’ˆ&
ba£
) =0;

32 
vœtu®
 cÚ¡ 
EËm’t
 & 
	`G‘Ba£
(cÚ¡ 
DL_GroupP»computiÚ
<EËm’t> &
group
) const =0;

33 
vœtu®
 
	`P»compu‹
(cÚ¡ 
DL_GroupP»computiÚ
<
EËm’t
> &
group
, 
maxExpB™s
, 
¡Üage
) =0;

34 
vœtu®
 
	`Lßd
(cÚ¡ 
DL_GroupP»computiÚ
<
EËm’t
> &
group
, 
Bufã»dT¿nsfÜm©iÚ
 &
¡ÜedP»computiÚ
) =0;

35 
vœtu®
 
	`Save
(cÚ¡ 
DL_GroupP»computiÚ
<
EËm’t
> &
group
, 
Bufã»dT¿nsfÜm©iÚ
 &
¡ÜedP»computiÚ
) const =0;

36 
vœtu®
 
EËm’t
 
	`ExpÚ’tŸ‹
(cÚ¡ 
DL_GroupP»computiÚ
<EËm’t> &
group
, cÚ¡ 
IÁeg”
 &
expÚ’t
) const =0;

37 
vœtu®
 
EËm’t
 
	`CasÿdeExpÚ’tŸ‹
(cÚ¡ 
DL_GroupP»computiÚ
<EËm’t> &
group
, cÚ¡ 
IÁeg”
 &
expÚ’t
, cÚ¡ 
DL_FixedBa£P»computiÚ
<EËm’t> &
pc2
, cÚ¡ IÁeg” &
expÚ’t2
) const =0;

40 
‹m¶©e
 <
şass
 
T
>

41 
şass
 
DL_FixedBa£P»computiÚIm¶
 : 
public
 
DL_FixedBa£P»computiÚ
<
T
>

43 
public
:

44 
T
 
	tEËm’t
;

46 
	`DL_FixedBa£P»computiÚIm¶
(è: 
	`m_wšdowSize
(0) {}

49 
boŞ
 
	`IsIn™Ÿlized
() const

50 { !
m_ba£s
.
	`em±y
();}

51 
	`S‘Ba£
(cÚ¡ 
DL_GroupP»computiÚ
<
EËm’t
> &
group
, cÚ¡ EËm’ˆ&
ba£
);

52 cÚ¡ 
EËm’t
 & 
	`G‘Ba£
(cÚ¡ 
DL_GroupP»computiÚ
<EËm’t> &
group
) const

53 { 
group
.
	`N“dCÚv”siÚs
(è? 
m_ba£
 : 
m_ba£s
[0];}

54 
	`P»compu‹
(cÚ¡ 
DL_GroupP»computiÚ
<
EËm’t
> &
group
, 
maxExpB™s
, 
¡Üage
);

55 
	`Lßd
(cÚ¡ 
DL_GroupP»computiÚ
<
EËm’t
> &
group
, 
Bufã»dT¿nsfÜm©iÚ
 &
¡ÜedP»computiÚ
);

56 
	`Save
(cÚ¡ 
DL_GroupP»computiÚ
<
EËm’t
> &
group
, 
Bufã»dT¿nsfÜm©iÚ
 &
¡ÜedP»computiÚ
) const;

57 
EËm’t
 
	`ExpÚ’tŸ‹
(cÚ¡ 
DL_GroupP»computiÚ
<EËm’t> &
group
, cÚ¡ 
IÁeg”
 &
expÚ’t
) const;

58 
EËm’t
 
	`CasÿdeExpÚ’tŸ‹
(cÚ¡ 
DL_GroupP»computiÚ
<EËm’t> &
group
, cÚ¡ 
IÁeg”
 &
expÚ’t
, cÚ¡ 
DL_FixedBa£P»computiÚ
<EËm’t> &
pc2
, cÚ¡ IÁeg” &
expÚ’t2
) const;

60 
´iv©e
:

61 
	`P»·»Casÿde
(cÚ¡ 
DL_GroupP»computiÚ
<
EËm’t
> &
group
, 
¡d
::
veùÜ
<
Ba£AndExpÚ’t
<EËm’t> > &
eb
, cÚ¡ 
IÁeg”
 &
expÚ’t
) const;

63 
EËm’t
 
m_ba£
;

64 
m_wšdowSize
;

65 
IÁeg”
 
m_expÚ’tBa£
;

66 
¡d
::
veùÜ
<
EËm’t
> 
m_ba£s
;

67 
	}
};

69 
	gNAMESPACE_END


71 #ifdeà
CRYPTOPP_MANUALLY_INSTANTIATE_TEMPLATES


72 
	~"•»comp.ıp
"

	@esign.cpp

3 
	~"pch.h
"

4 
	~"esign.h
"

5 
	~"a¢.h
"

6 
	~"mod¬™h.h
"

7 
	~"nbtheÜy.h
"

8 
	~"sha.h
"

9 
	~"®g·¿m.h
"

11 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

13 
	$ESIGN_Te¡In¡ªtŸtiÚs
()

15 
ESIGN
<
SHA
>::
V”if›r
 
	`x1
(1, 1);

16 
ESIGN
<
SHA
>::
SigÃr
 
	`x2
(
	`NuÎRNG
(), 1);

17 
ESIGN
<
SHA
>::
V”if›r
 
	`x3
(
x2
);

18 
ESIGN
<
SHA
>::
V”if›r
 
	`x4
(
x2
.
	`G‘Key
());

19 
ESIGN
<
SHA
>::
V”if›r
 
	`x5
(
x3
);

20 
ESIGN
<
SHA
>::
SigÃr
 
x6
 = 
x2
;

22 
x6
 = 
x2
;

23 
x3
 = 
ESIGN
<
SHA
>::
	`V”if›r
(
x2
);

24 
x4
 = 
x2
.
	`G‘Key
();

25 
	}
}

27 
	gESIGNFunùiÚ
::
	$BERDecode
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
)

29 
BERSequ’ûDecod”
 
	`£q
(
bt
);

30 
m_n
.
	`BERDecode
(
£q
);

31 
m_e
.
	`BERDecode
(
£q
);

32 
£q
.
	`Mes§geEnd
();

33 
	}
}

35 
	gESIGNFunùiÚ
::
	$DEREncode
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
) const

37 
DERSequ’ûEncod”
 
	`£q
(
bt
);

38 
m_n
.
	`DEREncode
(
£q
);

39 
m_e
.
	`DEREncode
(
£q
);

40 
£q
.
	`Mes§geEnd
();

41 
	}
}

43 
IÁeg”
 
	gESIGNFunùiÚ
::
	$AµlyFunùiÚ
(cÚ¡ 
IÁeg”
 &
x
) const

45 
	`DoQuickSª™yCheck
();

46  
	`STDMIN
(
	`a_exp_b_mod_c
(
x
, 
m_e
, 
m_n
è>> (2*
	`G‘K
()+2), 
	`MaxImage
());

47 
	}
}

49 
boŞ
 
	gESIGNFunùiÚ
::
	$V®id©e
(
RªdomNumb”G’”©Ü
 &
ºg
, 
Ëv–
) const

51 
boŞ
 
·ss
 = 
Œue
;

52 
·ss
 =…as && 
m_n
 > 
IÁeg”
::
	`OÃ
(è&& m_n.
	`IsOdd
();

53 
·ss
 =…as && 
m_e
 >ğ8 && m_< 
m_n
;

54  
·ss
;

55 
	}
}

57 
boŞ
 
	gESIGNFunùiÚ
::
	$G‘VoidV®ue
(cÚ¡ *
Çme
, cÚ¡ 
¡d
::
ty³_šfo
 &
v®ueTy³
, *
pV®ue
) const

59  
	`G‘V®ueH–³r
(
this
, 
Çme
, 
v®ueTy³
, 
pV®ue
).
	`AssigÇbË
()

60 
	`CRYPTOPP_GET_FUNCTION_ENTRY
(
Modulus
)

61 
	`CRYPTOPP_GET_FUNCTION_ENTRY
(
PublicExpÚ’t
)

63 
	}
}

65 
	gESIGNFunùiÚ
::
	$AssignFrom
(cÚ¡ 
NameV®uePaœs
 &
sourû
)

67 
	`AssignFromH–³r
(
this
, 
sourû
)

68 
	`CRYPTOPP_SET_FUNCTION_ENTRY
(
Modulus
)

69 
	`CRYPTOPP_SET_FUNCTION_ENTRY
(
PublicExpÚ’t
)

71 
	}
}

75 
	gInv”tibËESIGNFunùiÚ
::
	$G’”©eRªdom
(
RªdomNumb”G’”©Ü
 &
ºg
, cÚ¡ 
NameV®uePaœs
 &
·¿m
)

77 
modulusSize
 = 1023*2;

78 
·¿m
.
	`G‘IÁV®ue
("ModulusSize", 
modulusSize
) ||…aram.GetIntValue("KeySize", modulusSize);

80 ià(
modulusSize
 < 24)

81 
throw
 
	`Inv®idArgum’t
("InvertibleESIGNFunction: specified modulus size isoo small");

83 ià(
modulusSize
 % 3 != 0)

84 
throw
 
	`Inv®idArgum’t
("InvertibleESIGNFunction: modulus size must be divisible by 3");

86 
m_e
 = 
·¿m
.
	`G‘V®ueW™hDeçuÉ
("PublicExpÚ’t", 
	`IÁeg”
(32));

88 ià(
m_e
 < 8)

89 
throw
 
	`Inv®idArgum’t
("InvertibleESIGNFunction:…ublicƒxponents†esshan 8 may‚ot be secure");

92 
CÚ¡By‹A¼ayP¬am‘”
 
£edP¬am
;

93 
SecBy‹Block
 
£ed
;

95 cÚ¡ 
IÁeg”
 
mšP
 = 
	`IÁeg”
(204è<< (
modulusSize
/3-8);

96 cÚ¡ 
IÁeg”
 
maxP
 = IÁeg”::
	`Pow”2
(
modulusSize
/3)-1;

97 
AlgÜ™hmP¬am‘”s
 
´imeP¬am
 = 
	`MakeP¬am‘”s
("Mš", 
mšP
)("Max", 
maxP
)("RªdomNumb”Ty³", 
IÁeg”
::
PRIME
);

99 ià(
·¿m
.
	`G‘V®ue
("S“d", 
£edP¬am
))

101 
£ed
.
	`»size
(
£edP¬am
.
	`size
() + 4);

102 
	`memıy
(
£ed
 + 4, 
£edP¬am
.
	`begš
(), s“dP¬am.
	`size
());

104 
	`PutWÜd
(
çl£
, 
BIG_ENDIAN_ORDER
, 
£ed
, (
wÜd32
)0);

105 
m_p
.
	`G’”©eRªdom
(
ºg
, 
	`CombšedNameV®uePaœs
(
´imeP¬am
, 
	`MakeP¬am‘”s
("S“d", 
	`CÚ¡By‹A¼ayP¬am‘”
(
£ed
))));

106 
	`PutWÜd
(
çl£
, 
BIG_ENDIAN_ORDER
, 
£ed
, (
wÜd32
)1);

107 
m_q
.
	`G’”©eRªdom
(
ºg
, 
	`CombšedNameV®uePaœs
(
´imeP¬am
, 
	`MakeP¬am‘”s
("S“d", 
	`CÚ¡By‹A¼ayP¬am‘”
(
£ed
))));

111 
m_p
.
	`G’”©eRªdom
(
ºg
, 
´imeP¬am
);

112 
m_q
.
	`G’”©eRªdom
(
ºg
, 
´imeP¬am
);

115 
m_n
 = 
m_p
 * m_°* 
m_q
;

117 
	`as£¹
(
m_n
.
	`B™CouÁ
(è=ğ
modulusSize
);

118 
	}
}

120 
	gInv”tibËESIGNFunùiÚ
::
	$BERDecode
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
)

122 
BERSequ’ûDecod”
 
	`´iv©eKey
(
bt
);

123 
m_n
.
	`BERDecode
(
´iv©eKey
);

124 
m_e
.
	`BERDecode
(
´iv©eKey
);

125 
m_p
.
	`BERDecode
(
´iv©eKey
);

126 
m_q
.
	`BERDecode
(
´iv©eKey
);

127 
´iv©eKey
.
	`Mes§geEnd
();

128 
	}
}

130 
	gInv”tibËESIGNFunùiÚ
::
	$DEREncode
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
) const

132 
DERSequ’ûEncod”
 
	`´iv©eKey
(
bt
);

133 
m_n
.
	`DEREncode
(
´iv©eKey
);

134 
m_e
.
	`DEREncode
(
´iv©eKey
);

135 
m_p
.
	`DEREncode
(
´iv©eKey
);

136 
m_q
.
	`DEREncode
(
´iv©eKey
);

137 
´iv©eKey
.
	`Mes§geEnd
();

138 
	}
}

140 
IÁeg”
 
	gInv”tibËESIGNFunùiÚ
::
	$C®cuÏ‹RªdomizedInv”£
(
RªdomNumb”G’”©Ü
 &
ºg
, cÚ¡ 
IÁeg”
 &
x
) const

142 
	`DoQuickSª™yCheck
();

144 
IÁeg”
 
pq
 = 
m_p
 * 
m_q
;

145 
IÁeg”
 
p2
 = 
m_p
 * m_p;

146 
IÁeg”
 
r
, 
z
, 
»
, 
a
, 
w0
, 
w1
;

150 
r
.
	`Rªdomize
(
ºg
, 
IÁeg”
::
	`Z”o
(), 
pq
);

151 
z
 = 
x
 << (2*
	`G‘K
()+2);

152 
»
 = 
	`a_exp_b_mod_c
(
r
, 
m_e
, 
m_n
);

153 
a
 = (
z
 - 
»
è% 
m_n
;

154 
IÁeg”
::
	`Divide
(
w1
, 
w0
, 
a
, 
pq
);

155 ià(
w1
.
	`NÙZ”o
())

157 ++
w0
;

158 
w1
 = 
pq
 - w1;

161 (
w1
 >> 2*
	`G‘K
()+1).
	`IsPos™ive
());

163 
ModuÏrAr™hm‘ic
 
	`modp
(
m_p
);

164 
IÁeg”
 
t
 = 
modp
.
	`Divide
(
w0
 * 
r
 % 
m_p
, 
m_e
 * 
»
 % m_p);

165 
IÁeg”
 
s
 = 
r
 + 
t
*
pq
;

166 
	`as£¹
(
s
 < 
m_n
);

178  
s
;

179 
	}
}

181 
boŞ
 
	gInv”tibËESIGNFunùiÚ
::
	$V®id©e
(
RªdomNumb”G’”©Ü
 &
ºg
, 
Ëv–
) const

183 
boŞ
 
·ss
 = 
ESIGNFunùiÚ
::
	`V®id©e
(
ºg
, 
Ëv–
);

184 
·ss
 =…as && 
m_p
 > 
IÁeg”
::
	`OÃ
(è&& m_p.
	`IsOdd
(è&& m_°< 
m_n
;

185 
·ss
 =…as && 
m_q
 > 
IÁeg”
::
	`OÃ
(è&& m_q.
	`IsOdd
(è&& m_q < 
m_n
;

186 
·ss
 =…as && 
m_p
.
	`B™CouÁ
(è=ğ
m_q
.BitCount();

187 ià(
Ëv–
 >= 1)

188 
·ss
 =…as && 
m_p
 * m_°* 
m_q
 =ğ
m_n
;

189 ià(
Ëv–
 >= 2)

190 
·ss
 =…as && 
	`V”ifyPrime
(
ºg
, 
m_p
, 
Ëv–
-2è&& V”ifyPrimeÔng, 
m_q
,†evel-2);

191  
·ss
;

192 
	}
}

194 
boŞ
 
	gInv”tibËESIGNFunùiÚ
::
	$G‘VoidV®ue
(cÚ¡ *
Çme
, cÚ¡ 
¡d
::
ty³_šfo
 &
v®ueTy³
, *
pV®ue
) const

196  
G‘V®ueH–³r
<
ESIGNFunùiÚ
>(
this
, 
Çme
, 
v®ueTy³
, 
pV®ue
).
	`AssigÇbË
()

197 
	`CRYPTOPP_GET_FUNCTION_ENTRY
(
Prime1
)

198 
	`CRYPTOPP_GET_FUNCTION_ENTRY
(
Prime2
)

200 
	}
}

202 
	gInv”tibËESIGNFunùiÚ
::
	$AssignFrom
(cÚ¡ 
NameV®uePaœs
 &
sourû
)

204 
AssignFromH–³r
<
ESIGNFunùiÚ
>(
this
, 
sourû
)

205 
	`CRYPTOPP_SET_FUNCTION_ENTRY
(
Prime1
)

206 
	`CRYPTOPP_SET_FUNCTION_ENTRY
(
Prime2
)

208 
	}
}

210 
	gNAMESPACE_END


	@esign.h

1 #iâdeà
CRYPTOPP_ESIGN_H


2 
	#CRYPTOPP_ESIGN_H


	)

9 
	~"pubkey.h
"

10 
	~"š‹g”.h
"

11 
	~"a¢.h
"

13 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

16 
şass
 
ESIGNFunùiÚ
 : 
public
 
T¿pdoÜFunùiÚ
,…ubliø
ASN1Cry±oM©”Ÿl
<
PublicKey
>

18 
ESIGNFunùiÚ
 
	tThisCÏss
;

20 
public
:

21 
	`In™Ÿlize
(cÚ¡ 
IÁeg”
 &
n
, cÚ¡ IÁeg” &
e
)

22 {
m_n
 = 
n
; 
m_e
 = 
e
;}

25 
	`BERDecode
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
);

26 
	`DEREncode
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
) const;

29 
boŞ
 
	`V®id©e
(
RªdomNumb”G’”©Ü
 &
ºg
, 
Ëv–
) const;

30 
boŞ
 
	`G‘VoidV®ue
(cÚ¡ *
Çme
, cÚ¡ 
¡d
::
ty³_šfo
 &
v®ueTy³
, *
pV®ue
) const;

31 
	`AssignFrom
(cÚ¡ 
NameV®uePaœs
 &
sourû
);

34 
IÁeg”
 
	`AµlyFunùiÚ
(cÚ¡ IÁeg” &
x
) const;

35 
IÁeg”
 
	`P»imageBound
(ècÚ¡ { 
m_n
;}

36 
IÁeg”
 
	`ImageBound
(ècÚ¡ { IÁeg”::
	`Pow”2
(
	`G‘K
());}

39 cÚ¡ 
IÁeg”
 & 
	`G‘Modulus
(ècÚ¡ { 
m_n
;}

40 cÚ¡ 
IÁeg”
 & 
	`G‘PublicExpÚ’t
(ècÚ¡ { 
m_e
;}

42 
	`S‘Modulus
(cÚ¡ 
IÁeg”
 &
n
è{
m_n
 =‚;}

43 
	`S‘PublicExpÚ’t
(cÚ¡ 
IÁeg”
 &
e
è{
m_e
 =ƒ;}

45 
´Ùeùed
:

46 
	`G‘K
(ècÚ¡ { 
m_n
.
	`B™CouÁ
()/3-1;}

48 
IÁeg”
 
m_n
, 
m_e
;

49 
	}
};

52 
şass
 
	gInv”tibËESIGNFunùiÚ
 : 
public
 
ESIGNFunùiÚ
,…ubliø
	gRªdomizedT¿pdoÜFunùiÚInv”£
,…ubliø
	gPriv©eKey


54 
Inv”tibËESIGNFunùiÚ
 
	tThisCÏss
;

56 
	gpublic
:

57 
In™Ÿlize
(cÚ¡ 
IÁeg”
 &
n
, cÚ¡ IÁeg” &
e
, cÚ¡ IÁeg” &
p
, cÚ¡ IÁeg” &
q
)

58 {
	gm_n
 = 
n
; 
	gm_e
 = 
e
; 
	gm_p
 = 
p
; 
	gm_q
 = 
q
;}

60 
In™Ÿlize
(
RªdomNumb”G’”©Ü
 &
ºg
, 
modulusB™s
)

61 {
G’”©eRªdomW™hKeySize
(
ºg
, 
modulusB™s
);}

63 
BERDecode
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
);

64 
DEREncode
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
) const;

66 
IÁeg”
 
C®cuÏ‹RªdomizedInv”£
(
RªdomNumb”G’”©Ü
 &
ºg
, cÚ¡ IÁeg” &
x
) const;

69 
boŞ
 
V®id©e
(
RªdomNumb”G’”©Ü
 &
ºg
, 
Ëv–
) const;

70 
boŞ
 
G‘VoidV®ue
(cÚ¡ *
Çme
, cÚ¡ 
¡d
::
ty³_šfo
 &
v®ueTy³
, *
pV®ue
) const;

71 
AssignFrom
(cÚ¡ 
NameV®uePaœs
 &
sourû
);

73 
G’”©eRªdom
(
RªdomNumb”G’”©Ü
 &
ºg
, cÚ¡ 
NameV®uePaœs
 &
®g
);

75 cÚ¡ 
	gIÁeg”
& 
G‘Prime1
(ècÚ¡ { 
	gm_p
;}

76 cÚ¡ 
	gIÁeg”
& 
G‘Prime2
(ècÚ¡ { 
	gm_q
;}

78 
S‘Prime1
(cÚ¡ 
IÁeg”
 &
p
è{
	gm_p
 =…;}

79 
S‘Prime2
(cÚ¡ 
IÁeg”
 &
q
è{
	gm_q
 = q;}

81 
	g´Ùeùed
:

82 
IÁeg”
 
m_p
, 
	gm_q
;

86 
	g‹m¶©e
 <
şass
 
	gT
>

87 şas 
	cEMSA5Pad
 : 
public
 
PK_D‘”mši¡icSigÇtu»Mes§geEncodšgM‘hod


89 
public
:

90 cÚ¡ *
	$SticAlgÜ™hmName
() { "EMSA5";}

92 
	$Compu‹Mes§geR•»£Á©ive
(
RªdomNumb”G’”©Ü
 &
ºg
,

93 cÚ¡ 
by‹
 *
»cov”abËMes§ge
, 
size_t
 
»cov”abËMes§geL’gth
,

94 
HashT¿nsfÜm©iÚ
 &
hash
, 
HashId’tif›r
 
hashId’tif›r
, 
boŞ
 
mes§geEm±y
,

95 
by‹
 *
»´e£Á©ive
, 
size_t
 
»´e£Á©iveB™L’gth
) const

97 
SecBy‹Block
 
	`dige¡
(
hash
.
	`Dige¡Size
());

98 
hash
.
	`Fš®
(
dige¡
);

99 
size_t
 
»´e£Á©iveBy‹L’gth
 = 
	`B™sToBy‹s
(
»´e£Á©iveB™L’gth
);

100 
T
 
mgf
;

101 
mgf
.
	`G’”©eAndMask
(
hash
, 
»´e£Á©ive
, 
»´e£Á©iveBy‹L’gth
, 
dige¡
, dige¡.
	`size
(), 
çl£
);

102 ià(
»´e£Á©iveB™L’gth
 % 8 != 0)

103 
»´e£Á©ive
[0] = (
by‹
)
	`Crİ
Ô•»£Á©ive[0], 
»´e£Á©iveB™L’gth
 % 8);

104 
	}
}

108 
	gP1363_EMSA5
 : 
public
 
SigÇtu»Snd¬d


110 
EMSA5Pad
<
	tP1363_MGF1
> 
	tSigÇtu»Mes§geEncodšgM‘hod
;

113 
	sESIGN_Keys


115 
	m¡d
::
¡ršg
 
SticAlgÜ™hmName
() { "ESIGN";}

116 
ESIGNFunùiÚ
 
	tPublicKey
;

117 
Inv”tibËESIGNFunùiÚ
 
	tPriv©eKey
;

121 
	g‹m¶©e
 <
şass
 
	gH
, cÏs 
	gSTANDARD
 = 
P1363_EMSA5
>

122 
ESIGN
 : 
public
 
TF_SS
<
STANDARD
, 
	gH
, 
	gESIGN_Keys
>

126 
	gNAMESPACE_END


	@factory.h

1 #iâdeà
CRYPTOPP_OBJFACT_H


2 
	#CRYPTOPP_OBJFACT_H


	)

4 
	~"üy±lib.h
"

5 
	~<m­
>

6 
	~<veùÜ
>

8 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

11 
‹m¶©e
 <
şass
 
Ab¡¿ùCÏss
>

12 şas 
	cObjeùFaùÜy


14 
public
:

15 
vœtu®
 ~
	$ObjeùFaùÜy
 () {}

16 
vœtu®
 
Ab¡¿ùCÏss
 * 
	$C»©eObjeù
() const =0;

17 
	}
};

20 
	g‹m¶©e
 <
şass
 
	gAb¡¿ùCÏss
, cÏs 
	gCÚü‘eCÏss
>

21 
şass
 
	gDeçuÉObjeùFaùÜy
 : 
public
 
ObjeùFaùÜy
<
Ab¡¿ùCÏss
>

23 
public
:

24 
Ab¡¿ùCÏss
 * 
C»©eObjeù
() const

26  
Ãw
 
CÚü‘eCÏss
;

32 
	g‹m¶©e
 <
şass
 
	gAb¡¿ùCÏss
, 
	gš¡ªû
=0>

33 şas 
	cObjeùFaùÜyRegi¡ry


35 
public
:

36 şas 
	cFaùÜyNÙFound
 : 
public
 
Exû±iÚ


38 
public
:

39 
FaùÜyNÙFound
(cÚ¡ *
Çme
è: 
Exû±iÚ
(
OTHER_ERROR
, 
¡d
::
¡ršg
("ObjectFactoryRegistry: could‚ot find factory for‡lgorithm ") +‚ame) {}

42 ~
	$ObjeùFaùÜyRegi¡ry
()

44 
CPP_TYPENAME
 
M­
::
™”©Ü
 
i
 = 
m_m­
.
	`begš
(); i !ğm_m­.
	`’d
(); ++i)

46 
	`d–‘e
 (
ObjeùFaùÜy
<
Ab¡¿ùCÏss
> *)
i
->
£cÚd
;

47 
i
->
£cÚd
 = 
NULL
;

49 
	}
}

51 
Regi¡”FaùÜy
(cÚ¡ 
¡d
::
¡ršg
 &
Çme
, 
ObjeùFaùÜy
<
Ab¡¿ùCÏss
> *
çùÜy
)

53 
	gm_m­
[
Çme
] = 
çùÜy
;

56 cÚ¡ 
	gObjeùFaùÜy
<
	gAb¡¿ùCÏss
> * 
	$G‘FaùÜy
(cÚ¡ *
Çme
) const

58 
CPP_TYPENAME
 
M­
::
cÚ¡_™”©Ü
 
i
 = 
m_m­
.
	`fšd
(
Çme
);

59  
i
 =ğ
m_m­
.
	`’d
(è? 
NULL
 : (
ObjeùFaùÜy
<
Ab¡¿ùCÏss
> *)i->
£cÚd
;

60 
	}
}

62 
Ab¡¿ùCÏss
 *
	$C»©eObjeù
(cÚ¡ *
Çme
) const

64 cÚ¡ 
ObjeùFaùÜy
<
Ab¡¿ùCÏss
> *
çùÜy
 = 
	`G‘FaùÜy
(
Çme
);

65 ià(!
çùÜy
)

66 
throw
 
	`FaùÜyNÙFound
(
Çme
);

67  
çùÜy
->
	`C»©eObjeù
();

68 
	}
}

72 
	g¡d
::
veùÜ
<
¡d
::
¡ršg
> 
	$G‘FaùÜyNames
() const

74 
¡d
::
veùÜ
<¡d::
¡ršg
> 
Çmes
;

75 
CPP_TYPENAME
 
M­
::
cÚ¡_™”©Ü
 
™”
;

76 
™”
 = 
m_m­
.
	`begš
(); i‹¸!ğm_m­.
	`’d
(); ++iter)

77 
Çmes
.
	`push_back
(
™”
->
fœ¡
);

78  
Çmes
;

79 
	}
}

81 
CRYPTOPP_NOINLINE
 
	gObjeùFaùÜyRegi¡ry
<
	gAb¡¿ùCÏss
, 
	gš¡ªû
> & 
Regi¡ry
(
CRYPTOPP_NOINLINE_DOTDOTDOT
);

83 
	g´iv©e
:

85 
¡d
::
	tm­
<
	t¡d
::
	t¡ršg
, *> 
	tM­
;

86 
M­
 
	gm_m­
;

89 
	g‹m¶©e
 <
şass
 
	gAb¡¿ùCÏss
, 
	gš¡ªû
>

90 
	gObjeùFaùÜyRegi¡ry
<
	gAb¡¿ùCÏss
, 
	gš¡ªû
> & ObjeùFaùÜyRegi¡ry<Ab¡¿ùCÏss, in¡ªû>::
	$Regi¡ry
(
CRYPTOPP_NOINLINE_DOTDOTDOT
)

92 
ObjeùFaùÜyRegi¡ry
<
Ab¡¿ùCÏss
, 
š¡ªû
> 
s_»gi¡ry
;

93  
s_»gi¡ry
;

94 
	}
}

96 
	g‹m¶©e
 <
şass
 
	gAb¡¿ùCÏss
, cÏs 
	gCÚü‘eCÏss
, 
	gš¡ªû
 = 0>

97 
	sRegi¡”DeçuÉFaùÜyFÜ
 {

98 
Regi¡”DeçuÉFaùÜyFÜ
(cÚ¡ *
Çme
=
NULL
)

101 
¡d
::
¡ršg
 
n
 = 
Çme
 ? std::¡ršgÒameè: std::¡ršg(
CÚü‘eCÏss
::
SticAlgÜ™hmName
());

102 
	mObjeùFaùÜyRegi¡ry
<
	mAb¡¿ùCÏss
, 
	mš¡ªû
>::
Regi¡ry
().

103 
Regi¡”FaùÜy
(
n
, 
Ãw
 
DeçuÉObjeùFaùÜy
<
Ab¡¿ùCÏss
, 
CÚü‘eCÏss
>);

106 
	g‹m¶©e
 <
şass
 
	gSchemeCÏss
>

107 
	$Regi¡”Asymm‘ricCh”DeçuÉFaùÜ›s
(cÚ¡ *
Çme
=
NULL
, 
SchemeCÏss
 *
dummy
=NULL)

109 
Regi¡”DeçuÉFaùÜyFÜ
<
PK_Enüy±Ü
, 
CPP_TYPENAME
 
SchemeCÏss
::
Enüy±Ü
>((cÚ¡ *)
Çme
);

110 
Regi¡”DeçuÉFaùÜyFÜ
<
PK_Deüy±Ü
, 
CPP_TYPENAME
 
SchemeCÏss
::
Deüy±Ü
>((cÚ¡ *)
Çme
);

111 
	}
}

113 
	g‹m¶©e
 <
şass
 
	gSchemeCÏss
>

114 
	$Regi¡”SigÇtu»SchemeDeçuÉFaùÜ›s
(cÚ¡ *
Çme
=
NULL
, 
SchemeCÏss
 *
dummy
=NULL)

116 
Regi¡”DeçuÉFaùÜyFÜ
<
PK_SigÃr
, 
CPP_TYPENAME
 
SchemeCÏss
::
SigÃr
>((cÚ¡ *)
Çme
);

117 
Regi¡”DeçuÉFaùÜyFÜ
<
PK_V”if›r
, 
CPP_TYPENAME
 
SchemeCÏss
::
V”if›r
>((cÚ¡ *)
Çme
);

118 
	}
}

120 
	g‹m¶©e
 <
şass
 
	gSchemeCÏss
>

121 
	$Regi¡”Symm‘ricCh”DeçuÉFaùÜ›s
(cÚ¡ *
Çme
=
NULL
, 
SchemeCÏss
 *
dummy
=NULL)

123 
Regi¡”DeçuÉFaùÜyFÜ
<
Symm‘ricCh”
, 
CPP_TYPENAME
 
SchemeCÏss
::
Enüy±iÚ
, 
ENCRYPTION
>((cÚ¡ *)
Çme
);

124 
Regi¡”DeçuÉFaùÜyFÜ
<
Symm‘ricCh”
, 
CPP_TYPENAME
 
SchemeCÏss
::
Deüy±iÚ
, 
DECRYPTION
>((cÚ¡ *)
Çme
);

125 
	}
}

127 
	g‹m¶©e
 <
şass
 
	gSchemeCÏss
>

128 
	$Regi¡”Auth’tiÿ‹dSymm‘ricCh”DeçuÉFaùÜ›s
(cÚ¡ *
Çme
=
NULL
, 
SchemeCÏss
 *
dummy
=NULL)

130 
Regi¡”DeçuÉFaùÜyFÜ
<
Auth’tiÿ‹dSymm‘ricCh”
, 
CPP_TYPENAME
 
SchemeCÏss
::
Enüy±iÚ
, 
ENCRYPTION
>((cÚ¡ *)
Çme
);

131 
Regi¡”DeçuÉFaùÜyFÜ
<
Auth’tiÿ‹dSymm‘ricCh”
, 
CPP_TYPENAME
 
SchemeCÏss
::
Deüy±iÚ
, 
DECRYPTION
>((cÚ¡ *)
Çme
);

132 
	}
}

134 
	gNAMESPACE_END


	@files.cpp

3 
	~"pch.h
"

5 #iâdeà
CRYPTOPP_IMPORTS


7 
	~"fes.h
"

9 
	~<lim™s
>

11 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

13 
usšg
 
Çme¥aû
 
¡d
;

15 #iâdeà
NDEBUG


16 
	$Fes_Te¡In¡ªtŸtiÚs
()

18 
FeStÜe
 
f0
;

19 
FeSourû
 
f1
;

20 
FeSšk
 
f2
;

21 
	}
}

24 
	gFeStÜe
::
	$StÜeIn™Ÿlize
(cÚ¡ 
NameV®uePaœs
 &
·¿m‘”s
)

26 
m_wa™šg
 = 
çl£
;

27 
m_¡»am
 = 
NULL
;

28 
m_fe
.
	`»Ëa£
();

30 cÚ¡ *
feName
 = 
NULL
;

31 #ià
	`defšed
(
CRYPTOPP_UNIX_AVAILABLE
è|| 
_MSC_VER
 >= 1400

32 cÚ¡ 
wch¬_t
 *
feNameWide
 = 
NULL
;

33 ià(!
·¿m‘”s
.
	`G‘V®ue
(
Name
::
	`IÅutFeNameWide
(), 
feNameWide
))

35 ià(!
·¿m‘”s
.
	`G‘V®ue
(
Name
::
	`IÅutFeName
(), 
feName
))

37 
·¿m‘”s
.
	`G‘V®ue
(
Name
::
	`IÅutSŒ—mPoš‹r
(), 
m_¡»am
);

41 
ios
::
İ’mode
 
bš¬y
 = 
·¿m‘”s
.
	`G‘V®ueW™hDeçuÉ
(
Name
::
	`IÅutBš¬yMode
(), 
Œue
è? ios::bš¬y : ios::
	`İ’mode
(0);

42 
m_fe
.
	`»£t
(
Ãw
 
¡d
::
if¡»am
);

43 #ifdeà
CRYPTOPP_UNIX_AVAILABLE


44 
¡d
::
¡ršg
 
Ç¼owed
;

45 ià(
feNameWide
)

46 
feName
 = (
Ç¼owed
 = 
	`SŒšgN¬row
(
feNameWide
)).
	`c_¡r
();

48 #ià
_MSC_VER
 >= 1400

49 ià(
feNameWide
)

51 
m_fe
->
	`İ’
(
feNameWide
, 
ios
::
š
 | 
bš¬y
);

52 ià(!*
m_fe
)

53 
throw
 
	`O³nE¼
(
	`SŒšgN¬row
(
feNameWide
, 
çl£
));

56 ià(
feName
)

58 
m_fe
->
	`İ’
(
feName
, 
ios
::
š
 | 
bš¬y
);

59 ià(!*
m_fe
)

60 
throw
 
	`O³nE¼
(
feName
);

62 
m_¡»am
 = 
m_fe
.
	`g‘
();

63 
	}
}

65 
lwÜd
 
	gFeStÜe
::
	$MaxR‘r›vabË
() const

67 ià(!
m_¡»am
)

70 
¡»ampos
 
cu¼’t
 = 
m_¡»am
->
	`‹Îg
();

71 
¡»ampos
 
’d
 = 
m_¡»am
->
	`£ekg
(0, 
ios
::’d).
	`‹Îg
();

72 
m_¡»am
->
	`£ekg
(
cu¼’t
);

73  
’d
-
cu¼’t
;

74 
	}
}

76 
size_t
 
	gFeStÜe
::
	$T¿nsãrTo2
(
Bufã»dT¿nsfÜm©iÚ
 &
rg‘
, 
lwÜd
 &
ŒªsãrBy‹s
, cÚ¡ 
¡d
::
¡ršg
 &
chªÃl
, 
boŞ
 
blockšg
)

78 ià(!
m_¡»am
)

80 
ŒªsãrBy‹s
 = 0;

84 
lwÜd
 
size
=
ŒªsãrBy‹s
;

85 
ŒªsãrBy‹s
 = 0;

87 ià(
m_wa™šg
)

88 
ouut
;

90 
size
 && 
m_¡»am
->
	`good
())

93 
size_t
 
¥aûSize
 = 1024;

94 
m_¥aû
 = 
	`H–pC»©ePutS·û
(
rg‘
, 
chªÃl
, 1, 
	`UnsigÃdMš
(
	`size_t
(0)-1, 
size
), 
¥aûSize
);

96 
m_¡»am
->
	`»ad
((*)
m_¥aû
, ()
	`STDMIN
(
size
, (
lwÜd
)
¥aûSize
));

98 
m_Ën
 = (
size_t
)
m_¡»am
->
	`gcouÁ
();

99 
size_t
 
blockedBy‹s
;

100 
ouut
:

101 
blockedBy‹s
 = 
rg‘
.
	`ChªÃlPutModifŸbË2
(
chªÃl
, 
m_¥aû
, 
m_Ën
, 0, 
blockšg
);

102 
m_wa™šg
 = 
blockedBy‹s
 > 0;

103 ià(
m_wa™šg
)

104  
blockedBy‹s
;

105 
size
 -ğ
m_Ën
;

106 
ŒªsãrBy‹s
 +ğ
m_Ën
;

109 ià(!
m_¡»am
->
	`good
(è&& !m_¡»am->
	`eof
())

110 
throw
 
	`R—dE¼
();

113 
	}
}

115 
size_t
 
	gFeStÜe
::
	$CİyRªgeTo2
(
Bufã»dT¿nsfÜm©iÚ
 &
rg‘
, 
lwÜd
 &
begš
,†wÜd 
’d
, cÚ¡ 
¡d
::
¡ršg
 &
chªÃl
, 
boŞ
 
blockšg
) const

117 ià(!
m_¡»am
)

120 ià(
begš
 =ğ0 && 
’d
 == 1)

122 
»suÉ
 = 
m_¡»am
->
	`³ek
();

123 ià(
»suÉ
 =ğ
ch¬_Œa™s
<>::
	`eof
())

127 
size_t
 
blockedBy‹s
 = 
rg‘
.
	`ChªÃlPut
(
chªÃl
, 
	`by‹
(
»suÉ
), 
blockšg
);

128 
begš
 +ğ1-
blockedBy‹s
;

129  
blockedBy‹s
;

134 
¡»ampos
 
cu¼’t
 = 
m_¡»am
->
	`‹Îg
();

135 
¡»ampos
 
’dPos™iÚ
 = 
m_¡»am
->
	`£ekg
(0, 
ios
::
’d
).
	`‹Îg
();

136 
¡»ampos
 
ÃwPos™iÚ
 = 
cu¼’t
 + (
¡»amoff
)
begš
;

138 ià(
ÃwPos™iÚ
 >ğ
’dPos™iÚ
)

140 
m_¡»am
->
	`£ekg
(
cu¼’t
);

143 
m_¡»am
->
	`£ekg
(
ÃwPos™iÚ
);

144 
Œy


146 
	`as£¹
(!
m_wa™šg
);

147 
lwÜd
 
cİyMax
 = 
’d
-
begš
;

148 
size_t
 
blockedBy‹s
 = 
cÚ¡_ÿ¡
<
FeStÜe
 *>(
this
)->
	`T¿nsãrTo2
(
rg‘
, 
cİyMax
, 
chªÃl
, 
blockšg
);

149 
begš
 +ğ
cİyMax
;

150 ià(
blockedBy‹s
)

152 
cÚ¡_ÿ¡
<
FeStÜe
 *>(
this
)->
m_wa™šg
 = 
çl£
;

153  
blockedBy‹s
;

156 
	`ÿtch
(...)

158 
m_¡»am
->
	`ş—r
();

159 
m_¡»am
->
	`£ekg
(
cu¼’t
);

160 
throw
;

162 
m_¡»am
->
	`ş—r
();

163 
m_¡»am
->
	`£ekg
(
cu¼’t
);

166 
	}
}

168 
lwÜd
 
	gFeStÜe
::
	$Sk
(
lwÜd
 
skMax
)

170 ià(!
m_¡»am
)

173 
lwÜd
 
ŞdPos
 = 
m_¡»am
->
	`‹Îg
();

174 
¡d
::
i¡»am
::
off_ty³
 
off£t
;

175 ià(!
	`SaãCÚv”t
(
skMax
, 
off£t
))

176 
throw
 
	`Inv®idArgum’t
("FileStore: maximum seek offsetƒxceeded");

177 
m_¡»am
->
	`£ekg
(
off£t
, 
ios
::
cur
);

178  (
lwÜd
)
m_¡»am
->
	`‹Îg
(è- 
ŞdPos
;

179 
	}
}

181 
	gFeSšk
::
	$IsŞ©edIn™Ÿlize
(cÚ¡ 
NameV®uePaœs
 &
·¿m‘”s
)

183 
m_¡»am
 = 
NULL
;

184 
m_fe
.
	`»Ëa£
();

186 cÚ¡ *
feName
 = 
NULL
;

187 #ià
	`defšed
(
CRYPTOPP_UNIX_AVAILABLE
è|| 
_MSC_VER
 >= 1400

188 cÚ¡ 
wch¬_t
 *
feNameWide
 = 
NULL
;

189 ià(!
·¿m‘”s
.
	`G‘V®ue
(
Name
::
	`OuutFeNameWide
(), 
feNameWide
))

191 ià(!
·¿m‘”s
.
	`G‘V®ue
(
Name
::
	`OuutFeName
(), 
feName
))

193 
·¿m‘”s
.
	`G‘V®ue
(
Name
::
	`OuutSŒ—mPoš‹r
(), 
m_¡»am
);

197 
ios
::
İ’mode
 
bš¬y
 = 
·¿m‘”s
.
	`G‘V®ueW™hDeçuÉ
(
Name
::
	`OuutBš¬yMode
(), 
Œue
è? ios::bš¬y : ios::
	`İ’mode
(0);

198 
m_fe
.
	`»£t
(
Ãw
 
¡d
::
of¡»am
);

199 #ifdeà
CRYPTOPP_UNIX_AVAILABLE


200 
¡d
::
¡ršg
 
Ç¼owed
;

201 ià(
feNameWide
)

202 
feName
 = (
Ç¼owed
 = 
	`SŒšgN¬row
(
feNameWide
)).
	`c_¡r
();

204 #ià
_MSC_VER
 >= 1400

205 ià(
feNameWide
)

207 
m_fe
->
	`İ’
(
feNameWide
, 
ios
::
out
 | ios::
Œunc
 | 
bš¬y
);

208 ià(!*
m_fe
)

209 
throw
 
	`O³nE¼
(
	`SŒšgN¬row
(
feNameWide
, 
çl£
));

212 ià(
feName
)

214 
m_fe
->
	`İ’
(
feName
, 
ios
::
out
 | ios::
Œunc
 | 
bš¬y
);

215 ià(!*
m_fe
)

216 
throw
 
	`O³nE¼
(
feName
);

218 
m_¡»am
 = 
m_fe
.
	`g‘
();

219 
	}
}

221 
boŞ
 
	gFeSšk
::
	$IsŞ©edFlush
(
boŞ
 
h¬dFlush
, boŞ 
blockšg
)

223 ià(!
m_¡»am
)

224 
throw
 
	`E¼
("FileSink: output stream‚ot opened");

226 
m_¡»am
->
	`æush
();

227 ià(!
m_¡»am
->
	`good
())

228 
throw
 
	`Wr™eE¼
();

230  
çl£
;

231 
	}
}

233 
size_t
 
	gFeSšk
::
	$Put2
(cÚ¡ 
by‹
 *
šSŒšg
, 
size_t
 
Ëngth
, 
mes§geEnd
, 
boŞ
 
blockšg
)

235 ià(!
m_¡»am
)

236 
throw
 
	`E¼
("FileSink: output stream‚ot opened");

238 
Ëngth
 > 0)

240 
¡d
::
¡»amsize
 
size
;

241 ià(!
	`SaãCÚv”t
(
Ëngth
, 
size
))

242 
size
 = 
num”ic_lim™s
<
¡d
::
¡»amsize
>::
	`max
();

243 
m_¡»am
->
	`wr™e
((cÚ¡ *)
šSŒšg
, 
size
);

244 
šSŒšg
 +ğ
size
;

245 
Ëngth
 -ğ(
size_t
)
size
;

248 ià(
mes§geEnd
)

249 
m_¡»am
->
	`æush
();

251 ià(!
m_¡»am
->
	`good
())

252 
throw
 
	`Wr™eE¼
();

255 
	}
}

257 
	gNAMESPACE_END


	@files.h

1 #iâdeà
CRYPTOPP_FILES_H


2 
	#CRYPTOPP_FILES_H


	)

4 
	~"üy±lib.h
"

5 
	~"f‹rs.h
"

6 
	~"¬gÇmes.h
"

8 
	~<io¡»am
>

9 
	~<f¡»am
>

11 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

14 
şass
 
CRYPTOPP_DLL
 
FeStÜe
 : 
public
 
StÜe
, 
´iv©e
 
F‹rPutS·ûH–³r
,…ubliø
NÙCİyabË


16 
public
:

17 şas 
	cE¼
 : 
public
 
Exû±iÚ


19 
public
:

20 
	`E¼
(cÚ¡ 
¡d
::
¡ršg
 &
s
è: 
	`Exû±iÚ
(
IO_ERROR
, s) {}

21 
	}
};

22 şas 
	cO³nE¼
 : 
public
 
E¼
 {public: 
O³nE¼
(cÚ¡ 
¡d
::
¡ršg
 &
f’ame
) : Err("FileStore:ƒrror opening file for„eading: " + filename) {}};

23 şas 
	cR—dE¼
 : 
public
 
E¼
 {public: 
R—dE¼
() : Err("FileStore:ƒrror„eading file") {}};

25 
	$FeStÜe
(è: 
	$m_¡»am
(
NULL
è{
	}
}

26 
	$FeStÜe
(
¡d
::
i¡»am
 &
š
)

27 {
	`StÜeIn™Ÿlize
(
	`MakeP¬am‘”s
(
Name
::
	`IÅutSŒ—mPoš‹r
(), &
š
));
	}
}

28 
	$FeStÜe
(cÚ¡ *
f’ame
)

29 {
	`StÜeIn™Ÿlize
(
	`MakeP¬am‘”s
(
Name
::
	`IÅutFeName
(), 
f’ame
));
	}
}

30 #ià
defšed
(
CRYPTOPP_UNIX_AVAILABLE
è|| 
_MSC_VER
 >= 1400

32 
	$FeStÜe
(cÚ¡ 
wch¬_t
 *
f’ame
)

33 {
	`StÜeIn™Ÿlize
(
	`MakeP¬am‘”s
(
Name
::
	`IÅutFeNameWide
(), 
f’ame
));
	}
}

36 
	g¡d
::
i¡»am
* 
	$G‘SŒ—m
(è{ 
m_¡»am
;
	}
}

38 
lwÜd
 
	$MaxR‘r›vabË
() const;

39 
size_t
 
	`T¿nsãrTo2
(
Bufã»dT¿nsfÜm©iÚ
 &
rg‘
, 
lwÜd
 &
ŒªsãrBy‹s
, cÚ¡ 
¡d
::
¡ršg
 &
chªÃl
=
DEFAULT_CHANNEL
, 
boŞ
 
blockšg
=
Œue
);

40 
size_t
 
	$CİyRªgeTo2
(
Bufã»dT¿nsfÜm©iÚ
 &
rg‘
, 
lwÜd
 &
begš
,†wÜd 
’d
=
LWORD_MAX
, cÚ¡ 
¡d
::
¡ršg
 &
chªÃl
=
DEFAULT_CHANNEL
, 
boŞ
 
blockšg
=
Œue
) const;

41 
lwÜd
 
	`Sk
ÖwÜd 
skMax
=
ULONG_MAX
);

43 
´iv©e
:

44 
	`StÜeIn™Ÿlize
(cÚ¡ 
NameV®uePaœs
 &
·¿m‘”s
);

46 
memb”_±r
<
¡d
::
if¡»am
> 
m_fe
;

47 
¡d
::
i¡»am
 *
m_¡»am
;

48 
by‹
 *
m_¥aû
;

49 
size_t
 
m_Ën
;

50 
boŞ
 
m_wa™šg
;

51 
	}
};

54 
şass
 
CRYPTOPP_DLL
 
	gFeSourû
 : 
public
 
SourûTem¶©e
<
FeStÜe
>

56 
public
:

57 
FeStÜe
::
	tE¼
 Err;

58 
	gFeStÜe
::
	tO³nE¼
 OpenErr;

59 
	gFeStÜe
::
	tR—dE¼
 ReadErr;

61 
FeSourû
(
Bufã»dT¿nsfÜm©iÚ
 *
©chm’t
 = 
NULL
)

62 : 
SourûTem¶©e
<
FeStÜe
>(
©chm’t
) {}

63 
FeSourû
(
¡d
::
i¡»am
 &
š
, 
boŞ
 
pumpAÎ
, 
Bufã»dT¿nsfÜm©iÚ
 *
©chm’t
 = 
NULL
)

64 : 
SourûTem¶©e
<
FeStÜe
>(
©chm’t
è{
SourûIn™Ÿlize
(
pumpAÎ
, 
MakeP¬am‘”s
(
Name
::
IÅutSŒ—mPoš‹r
(), &
š
));}

65 
FeSourû
(cÚ¡ *
f’ame
, 
boŞ
 
pumpAÎ
, 
Bufã»dT¿nsfÜm©iÚ
 *
©chm’t
 = 
NULL
, boŞ 
bš¬y
=
Œue
)

66 : 
SourûTem¶©e
<
FeStÜe
>(
©chm’t
è{
SourûIn™Ÿlize
(
pumpAÎ
, 
MakeP¬am‘”s
(
Name
::
IÅutFeName
(), 
f’ame
)(Name::
IÅutBš¬yMode
(), 
bš¬y
));}

67 #ià
defšed
(
CRYPTOPP_UNIX_AVAILABLE
è|| 
_MSC_VER
 >= 1400

69 
FeSourû
(cÚ¡ 
wch¬_t
 *
f’ame
, 
boŞ
 
pumpAÎ
, 
Bufã»dT¿nsfÜm©iÚ
 *
©chm’t
 = 
NULL
, boŞ 
bš¬y
=
Œue
)

70 : 
SourûTem¶©e
<
FeStÜe
>(
©chm’t
è{
SourûIn™Ÿlize
(
pumpAÎ
, 
MakeP¬am‘”s
(
Name
::
IÅutFeNameWide
(), 
f’ame
)(Name::
IÅutBš¬yMode
(), 
bš¬y
));}

73 
	g¡d
::
i¡»am
* 
G‘SŒ—m
(è{ 
m_¡Üe
.GetStream();}

77 
şass
 
CRYPTOPP_DLL
 
	gFeSšk
 : 
public
 
Sšk
,…ubliø
	gNÙCİyabË


79 
	gpublic
:

80 şas 
	cE¼
 : 
public
 
Exû±iÚ


82 
public
:

83 
E¼
(cÚ¡ 
¡d
::
¡ršg
 &
s
è: 
Exû±iÚ
(
IO_ERROR
, s) {}

85 şas 
	cO³nE¼
 : 
public
 
E¼
 {public: 
O³nE¼
(cÚ¡ 
¡d
::
¡ršg
 &
f’ame
) : Err("FileSink:ƒrror opening file for writing: " + filename) {}};

86 şas 
	cWr™eE¼
 : 
public
 
E¼
 {public: 
Wr™eE¼
() : Err("FileSink:ƒrror writing file") {}};

88 
	$FeSšk
(è: 
	$m_¡»am
(
NULL
è{
	}
}

89 
	$FeSšk
(
¡d
::
o¡»am
 &
out
)

90 {
	`IsŞ©edIn™Ÿlize
(
	`MakeP¬am‘”s
(
Name
::
	`OuutSŒ—mPoš‹r
(), &
out
));
	}
}

91 
	$FeSšk
(cÚ¡ *
f’ame
, 
boŞ
 
bš¬y
=
Œue
)

92 {
	`IsŞ©edIn™Ÿlize
(
	`MakeP¬am‘”s
(
Name
::
	`OuutFeName
(), 
f’ame
)(Name::
	`OuutBš¬yMode
(), 
bš¬y
));
	}
}

93 #ià
defšed
(
CRYPTOPP_UNIX_AVAILABLE
è|| 
_MSC_VER
 >= 1400

95 
	$FeSšk
(cÚ¡ 
wch¬_t
 *
f’ame
, 
boŞ
 
bš¬y
=
Œue
)

96 {
	`IsŞ©edIn™Ÿlize
(
	`MakeP¬am‘”s
(
Name
::
	`OuutFeNameWide
(), 
f’ame
)(Name::
	`OuutBš¬yMode
(), 
bš¬y
));
	}
}

99 
	g¡d
::
o¡»am
* 
	$G‘SŒ—m
(è{ 
m_¡»am
;
	}
}

101 
IsŞ©edIn™Ÿlize
(cÚ¡ 
NameV®uePaœs
 &
·¿m‘”s
);

102 
size_t
 
Put2
(cÚ¡ 
by‹
 *
šSŒšg
, size_ˆ
Ëngth
, 
mes§geEnd
, 
boŞ
 
blockšg
);

103 
boŞ
 
IsŞ©edFlush
(boŞ 
h¬dFlush
, boŞ 
blockšg
);

105 
	g´iv©e
:

106 
memb”_±r
<
¡d
::
of¡»am
> 
m_fe
;

107 
	g¡d
::
o¡»am
 *
m_¡»am
;

110 
	gNAMESPACE_END


	@filters.cpp

3 
	~"pch.h
"

5 #iâdeà
CRYPTOPP_IMPORTS


7 
	~"f‹rs.h
"

8 
	~"mqueue.h
"

9 
	~"æŒim¶.h
"

10 
	~"¬gÇmes.h
"

11 
	~<memÜy
>

12 
	~<funùiÚ®
>

14 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

16 
F‹r
::
	$F‹r
(
Bufã»dT¿nsfÜm©iÚ
 *
©chm’t
)

17 : 
	`m_©chm’t
(
©chm’t
), 
	$m_cÚtšueAt
(0)

19 
	}
}

21 
Bufã»dT¿nsfÜm©iÚ
 * 
	gF‹r
::
	$NewDeçuÉA‰achm’t
() const

23  
Ãw
 
Mes§geQueue
;

24 
	}
}

26 
Bufã»dT¿nsfÜm©iÚ
 * 
	gF‹r
::
	$A‰achedT¿nsfÜm©iÚ
()

28 ià(
m_©chm’t
.
	`g‘
(è=ğ
NULL
)

29 
m_©chm’t
.
	`»£t
(
	`NewDeçuÉA‰achm’t
());

30  
m_©chm’t
.
	`g‘
();

31 
	}
}

33 cÚ¡ 
Bufã»dT¿nsfÜm©iÚ
 *
	gF‹r
::
	$A‰achedT¿nsfÜm©iÚ
() const

35 ià(
m_©chm’t
.
	`g‘
(è=ğ
NULL
)

36 
cÚ¡_ÿ¡
<
F‹r
 *>(
this
)->
m_©chm’t
.
	`»£t
(
	`NewDeçuÉA‰achm’t
());

37  
m_©chm’t
.
	`g‘
();

38 
	}
}

40 
	gF‹r
::
	$D‘ach
(
Bufã»dT¿nsfÜm©iÚ
 *
ÃwOut
)

42 
m_©chm’t
.
	`»£t
(
ÃwOut
);

43 
	}
}

45 
	gF‹r
::
	$In£¹
(
F‹r
 *
f‹r
)

47 
f‹r
->
m_©chm’t
.
	`»£t
(m_©chm’t.
	`»Ëa£
());

48 
m_©chm’t
.
	`»£t
(
f‹r
);

49 
	}
}

51 
size_t
 
	gF‹r
::
	$CİyRªgeTo2
(
Bufã»dT¿nsfÜm©iÚ
 &
rg‘
, 
lwÜd
 &
begš
,†wÜd 
’d
, cÚ¡ 
¡d
::
¡ršg
 &
chªÃl
, 
boŞ
 
blockšg
) const

53  
	`A‰achedT¿nsfÜm©iÚ
()->
	`CİyRªgeTo2
(
rg‘
, 
begš
, 
’d
, 
chªÃl
, 
blockšg
);

54 
	}
}

56 
size_t
 
	gF‹r
::
	$T¿nsãrTo2
(
Bufã»dT¿nsfÜm©iÚ
 &
rg‘
, 
lwÜd
 &
ŒªsãrBy‹s
, cÚ¡ 
¡d
::
¡ršg
 &
chªÃl
, 
boŞ
 
blockšg
)

58  
	`A‰achedT¿nsfÜm©iÚ
()->
	`T¿nsãrTo2
(
rg‘
, 
ŒªsãrBy‹s
, 
chªÃl
, 
blockšg
);

59 
	}
}

61 
	gF‹r
::
	$In™Ÿlize
(cÚ¡ 
NameV®uePaœs
 &
·¿m‘”s
, 
´İag©iÚ
)

63 
m_cÚtšueAt
 = 0;

64 
	`IsŞ©edIn™Ÿlize
(
·¿m‘”s
);

65 
	`Prİag©eIn™Ÿlize
(
·¿m‘”s
, 
´İag©iÚ
);

66 
	}
}

68 
boŞ
 
	gF‹r
::
	$Flush
(
boŞ
 
h¬dFlush
, 
´İag©iÚ
, boŞ 
blockšg
)

70 
m_cÚtšueAt
)

73 ià(
	`IsŞ©edFlush
(
h¬dFlush
, 
blockšg
))

74  
Œue
;

76 ià(
	`OuutFlush
(1, 
h¬dFlush
, 
´İag©iÚ
, 
blockšg
))

77  
Œue
;

79  
çl£
;

80 
	}
}

82 
boŞ
 
	gF‹r
::
	$Mes§geS”›sEnd
(
´İag©iÚ
, 
boŞ
 
blockšg
)

84 
m_cÚtšueAt
)

87 ià(
	`IsŞ©edMes§geS”›sEnd
(
blockšg
))

88  
Œue
;

90 ià(
	`ShouldPrİag©eMes§geS”›sEnd
(è&& 
	`OuutMes§geS”›sEnd
(1, 
´İag©iÚ
, 
blockšg
))

91  
Œue
;

93  
çl£
;

94 
	}
}

96 
	gF‹r
::
	$Prİag©eIn™Ÿlize
(cÚ¡ 
NameV®uePaœs
 &
·¿m‘”s
, 
´İag©iÚ
)

98 ià(
´İag©iÚ
)

99 
	`A‰achedT¿nsfÜm©iÚ
()->
	`In™Ÿlize
(
·¿m‘”s
, 
´İag©iÚ
-1);

100 
	}
}

102 
size_t
 
	gF‹r
::
	$OuutModifŸbË
(
ouutS™e
, 
by‹
 *
šSŒšg
, 
size_t
 
Ëngth
, 
mes§geEnd
, 
boŞ
 
blockšg
, cÚ¡ 
¡d
::
¡ršg
 &
chªÃl
)

104 ià(
mes§geEnd
)

105 
mes§geEnd
--;

106 
size_t
 
»suÉ
 = 
	`A‰achedT¿nsfÜm©iÚ
()->
	`ChªÃlPutModifŸbË2
(
chªÃl
, 
šSŒšg
, 
Ëngth
, 
mes§geEnd
, 
blockšg
);

107 
m_cÚtšueAt
 = 
»suÉ
 ? 
ouutS™e
 : 0;

108  
»suÉ
;

109 
	}
}

111 
size_t
 
	gF‹r
::
	$Ouut
(
ouutS™e
, cÚ¡ 
by‹
 *
šSŒšg
, 
size_t
 
Ëngth
, 
mes§geEnd
, 
boŞ
 
blockšg
, cÚ¡ 
¡d
::
¡ršg
 &
chªÃl
)

113 ià(
mes§geEnd
)

114 
mes§geEnd
--;

115 
size_t
 
»suÉ
 = 
	`A‰achedT¿nsfÜm©iÚ
()->
	`ChªÃlPut2
(
chªÃl
, 
šSŒšg
, 
Ëngth
, 
mes§geEnd
, 
blockšg
);

116 
m_cÚtšueAt
 = 
»suÉ
 ? 
ouutS™e
 : 0;

117  
»suÉ
;

118 
	}
}

120 
boŞ
 
	gF‹r
::
	$OuutFlush
(
ouutS™e
, 
boŞ
 
h¬dFlush
, 
´İag©iÚ
, boŞ 
blockšg
, cÚ¡ 
¡d
::
¡ršg
 &
chªÃl
)

122 ià(
´İag©iÚ
 && 
	`A‰achedT¿nsfÜm©iÚ
()->
	`ChªÃlFlush
(
chªÃl
, 
h¬dFlush
,…rİag©iÚ-1, 
blockšg
))

124 
m_cÚtšueAt
 = 
ouutS™e
;

125  
Œue
;

127 
m_cÚtšueAt
 = 0;

128  
çl£
;

129 
	}
}

131 
boŞ
 
	gF‹r
::
	$OuutMes§geS”›sEnd
(
ouutS™e
, 
´İag©iÚ
, 
boŞ
 
blockšg
, cÚ¡ 
¡d
::
¡ršg
 &
chªÃl
)

133 ià(
´İag©iÚ
 && 
	`A‰achedT¿nsfÜm©iÚ
()->
	`ChªÃlMes§geS”›sEnd
(
chªÃl
,…rİag©iÚ-1, 
blockšg
))

135 
m_cÚtšueAt
 = 
ouutS™e
;

136  
Œue
;

138 
m_cÚtšueAt
 = 0;

139  
çl£
;

140 
	}
}

144 
	gM‘”F‹r
::
	$Re£tM‘”
()

146 
m_cu¼’tMes§geBy‹s
 = 
m_tÙ®By‹s
 = 
m_cu¼’tS”›sMes§ges
 = 
m_tÙ®Mes§ges
 = 
m_tÙ®Mes§geS”›s
 = 0;

147 
m_¿ngesToSk
.
	`ş—r
();

148 
	}
}

150 
	gM‘”F‹r
::
	$AddRªgeToSk
(
mes§ge
, 
lwÜd
 
pos™iÚ
,†wÜd 
size
, 
boŞ
 
sÜtNow
)

152 
Mes§geRªge
 
r
 = {
mes§ge
, 
pos™iÚ
, 
size
};

153 
m_¿ngesToSk
.
	`push_back
(
r
);

154 ià(
sÜtNow
)

155 
¡d
::
	`sÜt
(
m_¿ngesToSk
.
	`begš
(), m_¿ngesToSk.
	`’d
());

156 
	}
}

158 
size_t
 
	gM‘”F‹r
::
	$PutMaybeModifŸbË
(
by‹
 *
begš
, 
size_t
 
Ëngth
, 
mes§geEnd
, 
boŞ
 
blockšg
, boŞ 
modifŸbË
)

160 ià(!
m_Œª¥¬’t
)

163 
size_t
 
t
;

164 
FILTER_BEGIN
;

166 
m_begš
 = 
begš
;

167 
m_Ëngth
 = 
Ëngth
;

169 
m_Ëngth
 > 0 || 
mes§geEnd
)

171 ià(
m_Ëngth
 > 0 && !
m_¿ngesToSk
.
	`em±y
(è&& m_¿ngesToSk.
	`äÚt
().
mes§ge
 =ğ
m_tÙ®Mes§ges
 && 
m_cu¼’tMes§geBy‹s
 + m_Ëngth > m_¿ngesToSk.äÚt().
pos™iÚ
)

173 
	`FILTER_OUTPUT_MAYBE_MODIFIABLE
(1, 
m_begš
, 
t
 = (
size_t
)
	`S©u¿tšgSubŒaù
(
m_¿ngesToSk
.
	`äÚt
().
pos™iÚ
, 
m_cu¼’tMes§geBy‹s
), 
çl£
, 
modifŸbË
);

175 
	`as£¹
(
t
 < 
m_Ëngth
);

176 
m_begš
 +ğ
t
;

177 
m_Ëngth
 -ğ
t
;

178 
m_cu¼’tMes§geBy‹s
 +ğ
t
;

179 
m_tÙ®By‹s
 +ğ
t
;

181 ià(
m_cu¼’tMes§geBy‹s
 + 
m_Ëngth
 < 
m_¿ngesToSk
.
	`äÚt
().
pos™iÚ
 + m_¿ngesToSk.äÚt().
size
)

182 
t
 = 
m_Ëngth
;

185 
t
 = (
size_t
)
	`S©u¿tšgSubŒaù
(
m_¿ngesToSk
.
	`äÚt
().
pos™iÚ
 + m_¿ngesToSk.äÚt().
size
, 
m_cu¼’tMes§geBy‹s
);

186 
	`as£¹
(
t
 <ğ
m_Ëngth
);

187 
m_¿ngesToSk
.
	`pİ_äÚt
();

190 
m_begš
 +ğ
t
;

191 
m_Ëngth
 -ğ
t
;

192 
m_cu¼’tMes§geBy‹s
 +ğ
t
;

193 
m_tÙ®By‹s
 +ğ
t
;

197 
	`FILTER_OUTPUT_MAYBE_MODIFIABLE
(2, 
m_begš
, 
m_Ëngth
, 
mes§geEnd
, 
modifŸbË
);

199 
m_cu¼’tMes§geBy‹s
 +ğ
m_Ëngth
;

200 
m_tÙ®By‹s
 +ğ
m_Ëngth
;

201 
m_Ëngth
 = 0;

203 ià(
mes§geEnd
)

205 
m_cu¼’tMes§geBy‹s
 = 0;

206 
m_cu¼’tS”›sMes§ges
++;

207 
m_tÙ®Mes§ges
++;

208 
mes§geEnd
 = 
çl£
;

213 
FILTER_END_NO_MESSAGE_END
;

214 
	}
}

216 
size_t
 
	gM‘”F‹r
::
	$Put2
(cÚ¡ 
by‹
 *
begš
, 
size_t
 
Ëngth
, 
mes§geEnd
, 
boŞ
 
blockšg
)

218  
	`PutMaybeModifŸbË
(
cÚ¡_ÿ¡
<
by‹
 *>(
begš
), 
Ëngth
, 
mes§geEnd
, 
blockšg
, 
çl£
);

219 
	}
}

221 
size_t
 
	gM‘”F‹r
::
	$PutModifŸbË2
(
by‹
 *
begš
, 
size_t
 
Ëngth
, 
mes§geEnd
, 
boŞ
 
blockšg
)

223  
	`PutMaybeModifŸbË
(
begš
, 
Ëngth
, 
mes§geEnd
, 
blockšg
, 
Œue
);

224 
	}
}

226 
boŞ
 
	gM‘”F‹r
::
	$IsŞ©edMes§geS”›sEnd
(
boŞ
 
blockšg
)

228 
m_cu¼’tMes§geBy‹s
 = 0;

229 
m_cu¼’tS”›sMes§ges
 = 0;

230 
m_tÙ®Mes§geS”›s
++;

231  
çl£
;

232 
	}
}

236 
	gF‹rW™hBufã»dIÅut
::
BlockQueue
::
	$Re£tQueue
(
size_t
 
blockSize
, size_ˆ
maxBlocks
)

238 
m_bufãr
.
	`New
(
blockSize
 * 
maxBlocks
);

239 
m_blockSize
 = 
blockSize
;

240 
m_maxBlocks
 = 
maxBlocks
;

241 
m_size
 = 0;

242 
m_begš
 = 
m_bufãr
;

243 
	}
}

245 
by‹
 *
	gF‹rW™hBufã»dIÅut
::
BlockQueue
::
	$G‘Block
()

247 ià(
m_size
 >ğ
m_blockSize
)

249 
by‹
 *
±r
 = 
m_begš
;

250 ià((
m_begš
+=
m_blockSize
è=ğ
m_bufãr
.
	`’d
())

251 
m_begš
 = 
m_bufãr
;

252 
m_size
 -ğ
m_blockSize
;

253  
±r
;

256  
NULL
;

257 
	}
}

259 
by‹
 *
	gF‹rW™hBufã»dIÅut
::
BlockQueue
::
	$G‘CÚtigousBlocks
(
size_t
 &
numb”OfBy‹s
)

261 
numb”OfBy‹s
 = 
	`STDMIN
Òumb”OfBy‹s, STDMIN(
	`size_t
(
m_bufãr
.
	`’d
()-
m_begš
), 
m_size
));

262 
by‹
 *
±r
 = 
m_begš
;

263 
m_begš
 +ğ
numb”OfBy‹s
;

264 
m_size
 -ğ
numb”OfBy‹s
;

265 ià(
m_size
 =ğ0 || 
m_begš
 =ğ
m_bufãr
.
	`’d
())

266 
m_begš
 = 
m_bufãr
;

267  
±r
;

268 
	}
}

270 
size_t
 
	gF‹rW™hBufã»dIÅut
::
BlockQueue
::
	$G‘AÎ
(
by‹
 *
outSŒšg
)

272 
size_t
 
size
 = 
m_size
;

273 
size_t
 
numb”OfBy‹s
 = 
m_maxBlocks
*
m_blockSize
;

274 cÚ¡ 
by‹
 *
±r
 = 
	`G‘CÚtigousBlocks
(
numb”OfBy‹s
);

275 
	`memıy
(
outSŒšg
, 
±r
, 
numb”OfBy‹s
);

276 
	`memıy
(
outSŒšg
+
numb”OfBy‹s
, 
m_begš
, 
m_size
);

277 
m_size
 = 0;

278  
size
;

279 
	}
}

281 
	gF‹rW™hBufã»dIÅut
::
BlockQueue
::
	$Put
(cÚ¡ 
by‹
 *
šSŒšg
, 
size_t
 
Ëngth
)

283 
	`as£¹
(
m_size
 + 
Ëngth
 <ğ
m_bufãr
.
	`size
());

284 
by‹
 *
’d
 = (
m_size
 < 
	`size_t
(
m_bufãr
.
	`’d
()-
m_begš
)è? m_begš + m_siz: m_begš + m_siz- m_bufãr.
	`size
();

285 
size_t
 
Ën
 = 
	`STDMIN
(
Ëngth
, 
	`size_t
(
m_bufãr
.
	`’d
()-
’d
));

286 
	`memıy
(
’d
, 
šSŒšg
, 
Ën
);

287 ià(
Ën
 < 
Ëngth
)

288 
	`memıy
(
m_bufãr
, 
šSŒšg
+
Ën
, 
Ëngth
-len);

289 
m_size
 +ğ
Ëngth
;

290 
	}
}

292 
	gF‹rW™hBufã»dIÅut
::
	$F‹rW™hBufã»dIÅut
(
Bufã»dT¿nsfÜm©iÚ
 *
©chm’t
)

293 : 
	$F‹r
(
©chm’t
)

295 
	}
}

297 
F‹rW™hBufã»dIÅut
::
	$F‹rW™hBufã»dIÅut
(
size_t
 
fœ¡Size
, size_ˆ
blockSize
, size_ˆ
Ï¡Size
, 
Bufã»dT¿nsfÜm©iÚ
 *
©chm’t
)

298 : 
	`F‹r
(
©chm’t
), 
	`m_fœ¡Size
(
fœ¡Size
), 
	`m_blockSize
(
blockSize
), 
	`m_Ï¡Size
(
Ï¡Size
)

299 , 
	$m_fœ¡IÅutDÚe
(
çl£
)

301 ià(
m_fœ¡Size
 < 0 || 
m_blockSize
 < 1 || 
m_Ï¡Size
 < 0)

302 
throw
 
	`Inv®idArgum’t
("FilterWithBufferedInput: invalid buffer size");

304 
m_queue
.
	`Re£tQueue
(1, 
m_fœ¡Size
);

305 
	}
}

307 
	gF‹rW™hBufã»dIÅut
::
	$IsŞ©edIn™Ÿlize
(cÚ¡ 
NameV®uePaœs
 &
·¿m‘”s
)

309 
	`In™ŸlizeD”ivedAndR‘uºNewSizes
(
·¿m‘”s
, 
m_fœ¡Size
, 
m_blockSize
, 
m_Ï¡Size
);

310 ià(
m_fœ¡Size
 < 0 || 
m_blockSize
 < 1 || 
m_Ï¡Size
 < 0)

311 
throw
 
	`Inv®idArgum’t
("FilterWithBufferedInput: invalid buffer size");

312 
m_queue
.
	`Re£tQueue
(1, 
m_fœ¡Size
);

313 
m_fœ¡IÅutDÚe
 = 
çl£
;

314 
	}
}

316 
boŞ
 
	gF‹rW™hBufã»dIÅut
::
	$IsŞ©edFlush
(
boŞ
 
h¬dFlush
, boŞ 
blockšg
)

318 ià(!
blockšg
)

319 
throw
 
	`BlockšgIÅutOÆy
("FilterWithBufferedInput");

321 ià(
h¬dFlush
)

322 
	`FÜûNextPut
();

323 
	`FlushD”ived
();

325  
çl£
;

326 
	}
}

328 
size_t
 
	gF‹rW™hBufã»dIÅut
::
	$PutMaybeModifŸbË
(
by‹
 *
šSŒšg
, 
size_t
 
Ëngth
, 
mes§geEnd
, 
boŞ
 
blockšg
, boŞ 
modifŸbË
)

330 ià(!
blockšg
)

331 
throw
 
	`BlockšgIÅutOÆy
("FilterWithBufferedInput");

333 ià(
Ëngth
 != 0)

335 
size_t
 
ÃwL’gth
 = 
m_queue
.
	`Cu¼’tSize
(è+ 
Ëngth
;

337 ià(!
m_fœ¡IÅutDÚe
 && 
ÃwL’gth
 >ğ
m_fœ¡Size
)

339 
size_t
 
Ën
 = 
m_fœ¡Size
 - 
m_queue
.
	`Cu¼’tSize
();

340 
m_queue
.
	`Put
(
šSŒšg
, 
Ën
);

341 
	`Fœ¡Put
(
m_queue
.
	`G‘CÚtigousBlocks
(
m_fœ¡Size
));

342 
	`as£¹
(
m_queue
.
	`Cu¼’tSize
() == 0);

343 
m_queue
.
	`Re£tQueue
(
m_blockSize
, (2*m_blockSize+
m_Ï¡Size
-2)/m_blockSize);

345 
šSŒšg
 +ğ
Ën
;

346 
ÃwL’gth
 -ğ
m_fœ¡Size
;

347 
m_fœ¡IÅutDÚe
 = 
Œue
;

350 ià(
m_fœ¡IÅutDÚe
)

352 ià(
m_blockSize
 == 1)

354 
ÃwL’gth
 > 
m_Ï¡Size
 && 
m_queue
.
	`Cu¼’tSize
() > 0)

356 
size_t
 
Ën
 = 
ÃwL’gth
 - 
m_Ï¡Size
;

357 
by‹
 *
±r
 = 
m_queue
.
	`G‘CÚtigousBlocks
(
Ën
);

358 
	`NextPutModifŸbË
(
±r
, 
Ën
);

359 
ÃwL’gth
 -ğ
Ën
;

362 ià(
ÃwL’gth
 > 
m_Ï¡Size
)

364 
size_t
 
Ën
 = 
ÃwL’gth
 - 
m_Ï¡Size
;

365 
	`NextPutMaybeModifŸbË
(
šSŒšg
, 
Ën
, 
modifŸbË
);

366 
šSŒšg
 +ğ
Ën
;

367 
ÃwL’gth
 -ğ
Ën
;

372 
ÃwL’gth
 >ğ
m_blockSize
 + 
m_Ï¡Size
 && 
m_queue
.
	`Cu¼’tSize
() >= m_blockSize)

374 
	`NextPutModifŸbË
(
m_queue
.
	`G‘Block
(), 
m_blockSize
);

375 
ÃwL’gth
 -ğ
m_blockSize
;

378 ià(
ÃwL’gth
 >ğ
m_blockSize
 + 
m_Ï¡Size
 && 
m_queue
.
	`Cu¼’tSize
() > 0)

380 
	`as£¹
(
m_queue
.
	`Cu¼’tSize
(è< 
m_blockSize
);

381 
size_t
 
Ën
 = 
m_blockSize
 - 
m_queue
.
	`Cu¼’tSize
();

382 
m_queue
.
	`Put
(
šSŒšg
, 
Ën
);

383 
šSŒšg
 +ğ
Ën
;

384 
	`NextPutModifŸbË
(
m_queue
.
	`G‘Block
(), 
m_blockSize
);

385 
ÃwL’gth
 -ğ
m_blockSize
;

388 ià(
ÃwL’gth
 >ğ
m_blockSize
 + 
m_Ï¡Size
)

390 
size_t
 
Ën
 = 
	`RoundDownToMuÉËOf
(
ÃwL’gth
 - 
m_Ï¡Size
, 
m_blockSize
);

391 
	`NextPutMaybeModifŸbË
(
šSŒšg
, 
Ën
, 
modifŸbË
);

392 
šSŒšg
 +ğ
Ën
;

393 
ÃwL’gth
 -ğ
Ën
;

398 
m_queue
.
	`Put
(
šSŒšg
, 
ÃwL’gth
 - m_queue.
	`Cu¼’tSize
());

401 ià(
mes§geEnd
)

403 ià(!
m_fœ¡IÅutDÚe
 && 
m_fœ¡Size
==0)

404 
	`Fœ¡Put
(
NULL
);

406 
SecBy‹Block
 
	`‹mp
(
m_queue
.
	`Cu¼’tSize
());

407 
m_queue
.
	`G‘AÎ
(
‹mp
);

408 
	`La¡Put
(
‹mp
,emp.
	`size
());

410 
m_fœ¡IÅutDÚe
 = 
çl£
;

411 
m_queue
.
	`Re£tQueue
(1, 
m_fœ¡Size
);

413 
	`Ouut
(1, 
NULL
, 0, 
mes§geEnd
, 
blockšg
);

416 
	}
}

418 
	gF‹rW™hBufã»dIÅut
::
	$FÜûNextPut
()

420 ià(!
m_fœ¡IÅutDÚe
)

423 ià(
m_blockSize
 > 1)

425 
m_queue
.
	`Cu¼’tSize
(è>ğ
m_blockSize
)

426 
	`NextPutModifŸbË
(
m_queue
.
	`G‘Block
(), 
m_blockSize
);

430 
size_t
 
Ën
;

431 (
Ën
 = 
m_queue
.
	`Cu¼’tSize
()) > 0)

432 
	`NextPutModifŸbË
(
m_queue
.
	`G‘CÚtigousBlocks
(
Ën
),†en);

434 
	}
}

436 
	gF‹rW™hBufã»dIÅut
::
	$NextPutMuÉË
(cÚ¡ 
by‹
 *
šSŒšg
, 
size_t
 
Ëngth
)

438 
	`as£¹
(
m_blockSize
 > 1);

439 
Ëngth
 > 0)

441 
	`as£¹
(
Ëngth
 >ğ
m_blockSize
);

442 
	`NextPutSšgË
(
šSŒšg
);

443 
šSŒšg
 +ğ
m_blockSize
;

444 
Ëngth
 -ğ
m_blockSize
;

446 
	}
}

450 
	gRedœeùÜ
::
	$In™Ÿlize
(cÚ¡ 
NameV®uePaœs
 &
·¿m‘”s
, 
´İag©iÚ
)

452 
m_rg‘
 = 
·¿m‘”s
.
	`G‘V®ueW™hDeçuÉ
("RedœeùiÚT¬g‘Poš‹r", (
Bufã»dT¿nsfÜm©iÚ
*)
NULL
);

453 
m_behaviÜ
 = 
·¿m‘”s
.
	`G‘IÁV®ueW™hDeçuÉ
("RedœeùiÚBehaviÜ", 
PASS_EVERYTHING
);

455 ià(
m_rg‘
 && 
	`G‘PassSigÇls
())

456 
m_rg‘
->
	`In™Ÿlize
(
·¿m‘”s
, 
´İag©iÚ
);

457 
	}
}

461 
	gProxyF‹r
::
	$ProxyF‹r
(
Bufã»dT¿nsfÜm©iÚ
 *
f‹r
, 
size_t
 
fœ¡Size
, size_ˆ
Ï¡Size
, Bufã»dT¿nsfÜm©iÚ *
©chm’t
)

462 : 
	`F‹rW™hBufã»dIÅut
(
fœ¡Size
, 1, 
Ï¡Size
, 
©chm’t
), 
	$m_f‹r
(
f‹r
)

464 ià(
m_f‹r
.
	`g‘
())

465 
m_f‹r
->
	`A‰ach
(
Ãw
 
	`OuutProxy
(*
this
, 
çl£
));

466 
	}
}

468 
boŞ
 
	gProxyF‹r
::
	$IsŞ©edFlush
(
boŞ
 
h¬dFlush
, boŞ 
blockšg
)

470  
m_f‹r
.
	`g‘
(è? m_f‹r->
	`Flush
(
h¬dFlush
, -1, 
blockšg
è: 
çl£
;

471 
	}
}

473 
	gProxyF‹r
::
	$S‘F‹r
(
F‹r
 *
f‹r
)

475 
m_f‹r
.
	`»£t
(
f‹r
);

476 ià(
f‹r
)

478 
OuutProxy
 *
´oxy
;

479 
¡d
::
auto_±r
<
OuutProxy
> 
	`‹mp
(
´oxy
 = 
Ãw
 
	`OuutProxy
(*
this
, 
çl£
));

480 
m_f‹r
->
	`T¿nsãrAÎTo
(*
´oxy
);

481 
m_f‹r
->
	`A‰ach
(
‹mp
.
	`»Ëa£
());

483 
	}
}

485 
	gProxyF‹r
::
	$NextPutMuÉË
(cÚ¡ 
by‹
 *
s
, 
size_t
 
Ën
)

487 ià(
m_f‹r
.
	`g‘
())

488 
m_f‹r
->
	`Put
(
s
, 
Ën
);

489 
	}
}

491 
	gProxyF‹r
::
	$NextPutModifŸbË
(
by‹
 *
s
, 
size_t
 
Ën
)

493 ià(
m_f‹r
.
	`g‘
())

494 
m_f‹r
->
	`PutModifŸbË
(
s
, 
Ën
);

495 
	}
}

499 
	gRªdomNumb”Sšk
::
	$IsŞ©edIn™Ÿlize
(cÚ¡ 
NameV®uePaœs
 &
·¿m‘”s
)

501 
·¿m‘”s
.
	`G‘RequœedP¬am‘”
("RªdomNumb”Sšk", "RªdomNumb”G’”©ÜPoš‹r", 
m_ºg
);

502 
	}
}

504 
size_t
 
	gRªdomNumb”Sšk
::
	$Put2
(cÚ¡ 
by‹
 *
begš
, 
size_t
 
Ëngth
, 
mes§geEnd
, 
boŞ
 
blockšg
)

506 
m_ºg
->
	`IncÜpÜ©eEÁrİy
(
begš
, 
Ëngth
);

508 
	}
}

510 
size_t
 
	gA¼aySšk
::
	$Put2
(cÚ¡ 
by‹
 *
begš
, 
size_t
 
Ëngth
, 
mes§geEnd
, 
boŞ
 
blockšg
)

512 ià(
m_buf
+
m_tÙ®
 !ğ
begš
)

513 
	`memıy
(
m_buf
+
m_tÙ®
, 
begš
, 
	`STDMIN
(
Ëngth
, 
	`S©u¿tšgSubŒaù
(
m_size
, m_total)));

514 
m_tÙ®
 +ğ
Ëngth
;

516 
	}
}

518 
by‹
 * 
	gA¼aySšk
::
	$C»©ePutS·û
(
size_t
 &
size
)

520 
size
 = 
	`S©u¿tšgSubŒaù
(
m_size
, 
m_tÙ®
);

521  
m_buf
 + 
m_tÙ®
;

522 
	}
}

524 
	gA¼aySšk
::
	$IsŞ©edIn™Ÿlize
(cÚ¡ 
NameV®uePaœs
 &
·¿m‘”s
)

526 
By‹A¼ayP¬am‘”
 
¬¿y
;

527 ià(!
·¿m‘”s
.
	`G‘V®ue
(
Name
::
	`OuutBufãr
(), 
¬¿y
))

528 
throw
 
	`Inv®idArgum’t
("ArraySink: missing OutputBuffer‡rgument");

529 
m_buf
 = 
¬¿y
.
	`begš
();

530 
m_size
 = 
¬¿y
.
	`size
();

531 
m_tÙ®
 = 0;

532 
	}
}

534 
size_t
 
	gA¼ayXÜSšk
::
	$Put2
(cÚ¡ 
by‹
 *
begš
, 
size_t
 
Ëngth
, 
mes§geEnd
, 
boŞ
 
blockšg
)

536 
	`xÜbuf
(
m_buf
+
m_tÙ®
, 
begš
, 
	`STDMIN
(
Ëngth
, 
	`S©u¿tšgSubŒaù
(
m_size
, m_total)));

537 
m_tÙ®
 +ğ
Ëngth
;

539 
	}
}

543 
	gSŒ—mT¿nsfÜm©iÚF‹r
::
	$SŒ—mT¿nsfÜm©iÚF‹r
(
SŒ—mT¿nsfÜm©iÚ
 &
c
, 
Bufã»dT¿nsfÜm©iÚ
 *
©chm’t
, 
BlockPaddšgScheme
 
·ddšg
, 
boŞ
 
®lowAuth’tiÿ‹dSymm‘ricCh”
)

544 : 
	`F‹rW™hBufã»dIÅut
(
©chm’t
)

545 , 
	$m_ch”
(
c
)

547 
	`as£¹
(
c
.
	`MšLa¡BlockSize
(è=ğ0 || c.MšLa¡BlockSize(è> c.
	`Mªd©ÜyBlockSize
());

549 ià(!
®lowAuth’tiÿ‹dSymm‘ricCh”
 && 
dyÇmic_ÿ¡
<
Auth’tiÿ‹dSymm‘ricCh”
 *>(&
c
) != 0)

550 
throw
 
	`Inv®idArgum’t
("StreamTransformationFilter:…lease use AuthenticatedEncryptionFilter‡nd AuthenticatedDecryptionFilter for AuthenticatedSymmetricCipher");

552 
	`IsŞ©edIn™Ÿlize
(
	`MakeP¬am‘”s
(
Name
::
	`BlockPaddšgScheme
(), 
·ddšg
));

553 
	}
}

555 
size_t
 
	gSŒ—mT¿nsfÜm©iÚF‹r
::
	$La¡BlockSize
(
SŒ—mT¿nsfÜm©iÚ
 &
c
, 
BlockPaddšgScheme
 
·ddšg
)

557 ià(
c
.
	`MšLa¡BlockSize
() > 0)

558  
c
.
	`MšLa¡BlockSize
();

559 ià(
c
.
	`Mªd©ÜyBlockSize
(è> 1 && !c.
	`IsFÜw¬dT¿nsfÜm©iÚ
(è&& 
·ddšg
 !ğ
NO_PADDING
 &&…addšg !ğ
ZEROS_PADDING
)

560  
c
.
	`Mªd©ÜyBlockSize
();

563 
	}
}

565 
	gSŒ—mT¿nsfÜm©iÚF‹r
::
	$In™ŸlizeD”ivedAndR‘uºNewSizes
(cÚ¡ 
NameV®uePaœs
 &
·¿m‘”s
, 
size_t
 &
fœ¡Size
, size_ˆ&
blockSize
, size_ˆ&
Ï¡Size
)

567 
BlockPaddšgScheme
 
·ddšg
 = 
·¿m‘”s
.
	`G‘V®ueW™hDeçuÉ
(
Name
::
	`BlockPaddšgScheme
(), 
DEFAULT_PADDING
);

568 
boŞ
 
isBlockCh”
 = (
m_ch”
.
	`Mªd©ÜyBlockSize
(è> 1 && m_ch”.
	`MšLa¡BlockSize
() == 0);

570 ià(
·ddšg
 =ğ
DEFAULT_PADDING
)

571 
m_·ddšg
 = 
isBlockCh”
 ? 
PKCS_PADDING
 : 
NO_PADDING
;

573 
m_·ddšg
 = 
·ddšg
;

575 ià(!
isBlockCh”
 && (
m_·ddšg
 =ğ
PKCS_PADDING
 || m_·ddšg =ğ
ONE_AND_ZEROS_PADDING
))

576 
throw
 
	`Inv®idArgum’t
("SŒ—mT¿nsfÜm©iÚF‹r: PKCS_PADDING‡nd ONE_AND_ZEROS_PADDING cªnÙ bu£d w™h " + 
m_ch”
.
	`AlgÜ™hmName
());

578 
fœ¡Size
 = 0;

579 
blockSize
 = 
m_ch”
.
	`Mªd©ÜyBlockSize
();

580 
Ï¡Size
 = 
	`La¡BlockSize
(
m_ch”
, 
m_·ddšg
);

581 
	}
}

583 
	gSŒ—mT¿nsfÜm©iÚF‹r
::
	$Fœ¡Put
(cÚ¡ 
by‹
 *
šSŒšg
)

585 
m_İtim®BufãrSize
 = 
m_ch”
.
	`O±im®BlockSize
();

586 
m_İtim®BufãrSize
 = ()
	`STDMAX
(m_İtim®BufãrSize, 
	`RoundDownToMuÉËOf
(4096U, m_optimalBufferSize));

587 
	}
}

589 
	gSŒ—mT¿nsfÜm©iÚF‹r
::
	$NextPutMuÉË
(cÚ¡ 
by‹
 *
šSŒšg
, 
size_t
 
Ëngth
)

591 ià(!
Ëngth
)

594 
size_t
 
s
 = 
m_ch”
.
	`Mªd©ÜyBlockSize
();

598 
size_t
 
Ën
 = 
m_İtim®BufãrSize
;

599 
by‹
 *
¥aû
 = 
	`H–pC»©ePutS·û
(*
	`A‰achedT¿nsfÜm©iÚ
(), 
DEFAULT_CHANNEL
, 
s
, 
Ëngth
, 
Ën
);

600 ià(
Ën
 < 
Ëngth
)

602 ià(
Ën
 =ğ
m_İtim®BufãrSize
)

603 
Ën
 -ğ
m_ch”
.
	`G‘O±im®BlockSizeU£d
();

604 
Ën
 = 
	`RoundDownToMuÉËOf
Ö’, 
s
);

607 
Ën
 = 
Ëngth
;

608 
m_ch”
.
	`ProûssSŒšg
(
¥aû
, 
šSŒšg
, 
Ën
);

609 
	`A‰achedT¿nsfÜm©iÚ
()->
	`PutModifŸbË
(
¥aû
, 
Ën
);

610 
šSŒšg
 +ğ
Ën
;

611 
Ëngth
 -ğ
Ën
;

613 
Ëngth
 > 0);

614 
	}
}

616 
	gSŒ—mT¿nsfÜm©iÚF‹r
::
	$NextPutModifŸbË
(
by‹
 *
šSŒšg
, 
size_t
 
Ëngth
)

618 
m_ch”
.
	`ProûssSŒšg
(
šSŒšg
, 
Ëngth
);

619 
	`A‰achedT¿nsfÜm©iÚ
()->
	`PutModifŸbË
(
šSŒšg
, 
Ëngth
);

620 
	}
}

622 
	gSŒ—mT¿nsfÜm©iÚF‹r
::
	$La¡Put
(cÚ¡ 
by‹
 *
šSŒšg
, 
size_t
 
Ëngth
)

624 
by‹
 *
¥aû
 = 
NULL
;

626 
m_·ddšg
)

628 
NO_PADDING
:

629 
ZEROS_PADDING
:

630 ià(
Ëngth
 > 0)

632 
size_t
 
mšLa¡BlockSize
 = 
m_ch”
.
	`MšLa¡BlockSize
();

633 
boŞ
 
isFÜw¬dT¿nsfÜm©iÚ
 = 
m_ch”
.
	`IsFÜw¬dT¿nsfÜm©iÚ
();

635 ià(
isFÜw¬dT¿nsfÜm©iÚ
 && 
m_·ddšg
 =ğ
ZEROS_PADDING
 && (
mšLa¡BlockSize
 =ğ0 || 
Ëngth
 < minLastBlockSize))

638 
size_t
 
blockSize
 = 
	`STDMAX
(
mšLa¡BlockSize
, (size_t)
m_ch”
.
	`Mªd©ÜyBlockSize
());

639 
¥aû
 = 
	`H–pC»©ePutS·û
(*
	`A‰achedT¿nsfÜm©iÚ
(), 
DEFAULT_CHANNEL
, 
blockSize
);

640 
	`memıy
(
¥aû
, 
šSŒšg
, 
Ëngth
);

641 
	`mem£t
(
¥aû
 + 
Ëngth
, 0, 
blockSize
 -†ength);

642 
m_ch”
.
	`ProûssLa¡Block
(
¥aû
, s·û, 
blockSize
);

643 
	`A‰achedT¿nsfÜm©iÚ
()->
	`Put
(
¥aû
, 
blockSize
);

647 ià(
mšLa¡BlockSize
 == 0)

649 ià(
isFÜw¬dT¿nsfÜm©iÚ
)

650 
throw
 
	`Inv®idD©aFÜm©
("StreamTransformationFilter:…laintext†ength is‚ot‡ multiple of block size‡nd NO_PADDING is specified");

652 
throw
 
	`Inv®idCh”‹xt
("StreamTransformationFilter: ciphertext†ength is‚ot‡ multiple of block size");

655 
¥aû
 = 
	`H–pC»©ePutS·û
(*
	`A‰achedT¿nsfÜm©iÚ
(), 
DEFAULT_CHANNEL
, 
Ëngth
, 
m_İtim®BufãrSize
);

656 
m_ch”
.
	`ProûssLa¡Block
(
¥aû
, 
šSŒšg
, 
Ëngth
);

657 
	`A‰achedT¿nsfÜm©iÚ
()->
	`Put
(
¥aû
, 
Ëngth
);

662 
PKCS_PADDING
:

663 
ONE_AND_ZEROS_PADDING
:

664 
s
;

665 
s
 = 
m_ch”
.
	`Mªd©ÜyBlockSize
();

666 
	`as£¹
(
s
 > 1);

667 
¥aû
 = 
	`H–pC»©ePutS·û
(*
	`A‰achedT¿nsfÜm©iÚ
(), 
DEFAULT_CHANNEL
, 
s
, 
m_İtim®BufãrSize
);

668 ià(
m_ch”
.
	`IsFÜw¬dT¿nsfÜm©iÚ
())

670 
	`as£¹
(
Ëngth
 < 
s
);

671 
	`memıy
(
¥aû
, 
šSŒšg
, 
Ëngth
);

672 ià(
m_·ddšg
 =ğ
PKCS_PADDING
)

674 
	`as£¹
(
s
 < 256);

675 
by‹
 
·d
 = 
	`by‹
(
s
-
Ëngth
);

676 
	`mem£t
(
¥aû
+
Ëngth
, 
·d
, 
s
-length);

680 
¥aû
[
Ëngth
] = 0x80;

681 
	`mem£t
(
¥aû
+
Ëngth
+1, 0, 
s
-length-1);

683 
m_ch”
.
	`ProûssD©a
(
¥aû
, s·û, 
s
);

684 
	`A‰achedT¿nsfÜm©iÚ
()->
	`Put
(
¥aû
, 
s
);

688 ià(
Ëngth
 !ğ
s
)

689 
throw
 
	`Inv®idCh”‹xt
("StreamTransformationFilter: ciphertext†ength is‚ot‡ multiple of block size");

690 
m_ch”
.
	`ProûssD©a
(
¥aû
, 
šSŒšg
, 
s
);

691 ià(
m_·ddšg
 =ğ
PKCS_PADDING
)

693 
by‹
 
·d
 = 
¥aû
[
s
-1];

694 ià(
·d
 < 1 ||…ad > 
s
 || 
¡d
::
	`fšd_if
(
¥aû
+s-·d, s·û+s, std::
	`bšd2nd
(¡d::
nÙ_equ®_to
<
by‹
>(),…ad)) != space+s)

695 
throw
 
	`Inv®idCh”‹xt
("StreamTransformationFilter: invalid PKCS #7 block…adding found");

696 
Ëngth
 = 
s
-
·d
;

700 
Ëngth
 > 1 && 
¥aû
[length-1] == 0)

701 --
Ëngth
;

702 ià(
¥aû
[--
Ëngth
] != 0x80)

703 
throw
 
	`Inv®idCh”‹xt
("StreamTransformationFilter: invalid ones-and-zeros…adding found");

705 
	`A‰achedT¿nsfÜm©iÚ
()->
	`Put
(
¥aû
, 
Ëngth
);

710 
	`as£¹
(
çl£
);

712 
	}
}

716 
	gHashF‹r
::
	$HashF‹r
(
HashT¿nsfÜm©iÚ
 &
hm
, 
Bufã»dT¿nsfÜm©iÚ
 *
©chm’t
, 
boŞ
 
putMes§ge
, 
Œunÿ‹dDige¡Size
, cÚ¡ 
¡d
::
¡ršg
 &
mes§gePutChªÃl
, cÚ¡ std::¡ršg &
hashPutChªÃl
)

717 : 
	`m_hashModuË
(
hm
), 
	`m_putMes§ge
(
putMes§ge
), 
	`m_mes§gePutChªÃl
(
mes§gePutChªÃl
), 
	$m_hashPutChªÃl
(
hashPutChªÃl
)

719 
m_dige¡Size
 = 
Œunÿ‹dDige¡Size
 < 0 ? 
m_hashModuË
.
	`Dige¡Size
() :runcatedDigestSize;

720 
	`D‘ach
(
©chm’t
);

721 
	}
}

723 
	gHashF‹r
::
	$IsŞ©edIn™Ÿlize
(cÚ¡ 
NameV®uePaœs
 &
·¿m‘”s
)

725 
m_putMes§ge
 = 
·¿m‘”s
.
	`G‘V®ueW™hDeçuÉ
(
Name
::
	`PutMes§ge
(), 
çl£
);

726 
s
 = 
·¿m‘”s
.
	`G‘IÁV®ueW™hDeçuÉ
(
Name
::
	`Trunÿ‹dDige¡Size
(), -1);

727 
m_dige¡Size
 = 
s
 < 0 ? 
m_hashModuË
.
	`Dige¡Size
() : s;

728 
	}
}

730 
size_t
 
	gHashF‹r
::
	$Put2
(cÚ¡ 
by‹
 *
šSŒšg
, 
size_t
 
Ëngth
, 
mes§geEnd
, 
boŞ
 
blockšg
)

732 
FILTER_BEGIN
;

733 ià(
m_putMes§ge
)

734 
	`FILTER_OUTPUT3
(1, 0, 
šSŒšg
, 
Ëngth
, 0, 
m_mes§gePutChªÃl
);

735 
m_hashModuË
.
	`Upd©e
(
šSŒšg
, 
Ëngth
);

736 ià(
mes§geEnd
)

739 
size_t
 
size
;

740 
m_¥aû
 = 
	`H–pC»©ePutS·û
(*
	`A‰achedT¿nsfÜm©iÚ
(), 
m_hashPutChªÃl
, 
m_dige¡Size
, m_dige¡Size, 
size
 = m_digestSize);

741 
m_hashModuË
.
	`Trunÿ‹dFš®
(
m_¥aû
, 
m_dige¡Size
);

743 
	`FILTER_OUTPUT3
(2, 0, 
m_¥aû
, 
m_dige¡Size
, 
mes§geEnd
, 
m_hashPutChªÃl
);

745 
FILTER_END_NO_MESSAGE_END
;

746 
	}
}

750 
	gHashV”ifiÿtiÚF‹r
::
	$HashV”ifiÿtiÚF‹r
(
HashT¿nsfÜm©iÚ
 &
hm
, 
Bufã»dT¿nsfÜm©iÚ
 *
©chm’t
, 
wÜd32
 
æags
, 
Œunÿ‹dDige¡Size
)

751 : 
	`F‹rW™hBufã»dIÅut
(
©chm’t
)

752 , 
	$m_hashModuË
(
hm
)

754 
	`IsŞ©edIn™Ÿlize
(
	`MakeP¬am‘”s
(
Name
::
	`HashV”ifiÿtiÚF‹rFÏgs
(), 
æags
)(Name::
	`Trunÿ‹dDige¡Size
(), 
Œunÿ‹dDige¡Size
));

755 
	}
}

757 
	gHashV”ifiÿtiÚF‹r
::
	$In™ŸlizeD”ivedAndR‘uºNewSizes
(cÚ¡ 
NameV®uePaœs
 &
·¿m‘”s
, 
size_t
 &
fœ¡Size
, size_ˆ&
blockSize
, size_ˆ&
Ï¡Size
)

759 
m_æags
 = 
·¿m‘”s
.
	`G‘V®ueW™hDeçuÉ
(
Name
::
	`HashV”ifiÿtiÚF‹rFÏgs
(), (
wÜd32
)
DEFAULT_FLAGS
);

760 
s
 = 
·¿m‘”s
.
	`G‘IÁV®ueW™hDeçuÉ
(
Name
::
	`Trunÿ‹dDige¡Size
(), -1);

761 
m_dige¡Size
 = 
s
 < 0 ? 
m_hashModuË
.
	`Dige¡Size
() : s;

762 
m_v”if›d
 = 
çl£
;

763 
fœ¡Size
 = 
m_æags
 & 
HASH_AT_BEGIN
 ? 
m_dige¡Size
 : 0;

764 
blockSize
 = 1;

765 
Ï¡Size
 = 
m_æags
 & 
HASH_AT_BEGIN
 ? 0 : 
m_dige¡Size
;

766 
	}
}

768 
	gHashV”ifiÿtiÚF‹r
::
	$Fœ¡Put
(cÚ¡ 
by‹
 *
šSŒšg
)

770 ià(
m_æags
 & 
HASH_AT_BEGIN
)

772 
m_ex³ùedHash
.
	`New
(
m_dige¡Size
);

773 
	`memıy
(
m_ex³ùedHash
, 
šSŒšg
, m_ex³ùedHash.
	`size
());

774 ià(
m_æags
 & 
PUT_HASH
)

775 
	`A‰achedT¿nsfÜm©iÚ
()->
	`Put
(
šSŒšg
, 
m_ex³ùedHash
.
	`size
());

777 
	}
}

779 
	gHashV”ifiÿtiÚF‹r
::
	$NextPutMuÉË
(cÚ¡ 
by‹
 *
šSŒšg
, 
size_t
 
Ëngth
)

781 
m_hashModuË
.
	`Upd©e
(
šSŒšg
, 
Ëngth
);

782 ià(
m_æags
 & 
PUT_MESSAGE
)

783 
	`A‰achedT¿nsfÜm©iÚ
()->
	`Put
(
šSŒšg
, 
Ëngth
);

784 
	}
}

786 
	gHashV”ifiÿtiÚF‹r
::
	$La¡Put
(cÚ¡ 
by‹
 *
šSŒšg
, 
size_t
 
Ëngth
)

788 ià(
m_æags
 & 
HASH_AT_BEGIN
)

790 
	`as£¹
(
Ëngth
 == 0);

791 
m_v”if›d
 = 
m_hashModuË
.
	`Trunÿ‹dV”ify
(
m_ex³ùedHash
, 
m_dige¡Size
);

795 
m_v”if›d
 = (
Ëngth
==
m_dige¡Size
 && 
m_hashModuË
.
	`Trunÿ‹dV”ify
(
šSŒšg
,†ength));

796 ià(
m_æags
 & 
PUT_HASH
)

797 
	`A‰achedT¿nsfÜm©iÚ
()->
	`Put
(
šSŒšg
, 
Ëngth
);

800 ià(
m_æags
 & 
PUT_RESULT
)

801 
	`A‰achedT¿nsfÜm©iÚ
()->
	`Put
(
m_v”if›d
);

803 ià((
m_æags
 & 
THROW_EXCEPTION
è&& !
m_v”if›d
)

804 
throw
 
	`HashV”ifiÿtiÚFaed
();

805 
	}
}

809 
	gAuth’tiÿ‹dEnüy±iÚF‹r
::
	$Auth’tiÿ‹dEnüy±iÚF‹r
(
Auth’tiÿ‹dSymm‘ricCh”
 &
c
, 
Bufã»dT¿nsfÜm©iÚ
 *
©chm’t
,

810 
boŞ
 
putAAD
, 
Œunÿ‹dDige¡Size
, cÚ¡ 
¡d
::
¡ršg
 &
macChªÃl
, 
BlockPaddšgScheme
 
·ddšg
)

811 : 
	`SŒ—mT¿nsfÜm©iÚF‹r
(
c
, 
©chm’t
, 
·ddšg
, 
Œue
)

812 , 
	`m_hf
(
c
, 
Ãw
 
	`OuutProxy
(*
this
, 
çl£
), 
putAAD
, 
Œunÿ‹dDige¡Size
, 
AAD_CHANNEL
, 
macChªÃl
)

814 
	`as£¹
(
c
.
	`IsFÜw¬dT¿nsfÜm©iÚ
());

815 
	}
}

817 
	gAuth’tiÿ‹dEnüy±iÚF‹r
::
	$IsŞ©edIn™Ÿlize
(cÚ¡ 
NameV®uePaœs
 &
·¿m‘”s
)

819 
m_hf
.
	`IsŞ©edIn™Ÿlize
(
·¿m‘”s
);

820 
SŒ—mT¿nsfÜm©iÚF‹r
::
	`IsŞ©edIn™Ÿlize
(
·¿m‘”s
);

821 
	}
}

823 
by‹
 * 
	gAuth’tiÿ‹dEnüy±iÚF‹r
::
	$ChªÃlC»©ePutS·û
(cÚ¡ 
¡d
::
¡ršg
 &
chªÃl
, 
size_t
 &
size
)

825 ià(
chªÃl
.
	`em±y
())

826  
SŒ—mT¿nsfÜm©iÚF‹r
::
	`C»©ePutS·û
(
size
);

828 ià(
chªÃl
 =ğ
AAD_CHANNEL
)

829  
m_hf
.
	`C»©ePutS·û
(
size
);

831 
throw
 
	`Inv®idChªÃlName
("Auth’tiÿ‹dEnüy±iÚF‹r", 
chªÃl
);

832 
	}
}

834 
size_t
 
	gAuth’tiÿ‹dEnüy±iÚF‹r
::
	$ChªÃlPut2
(cÚ¡ 
¡d
::
¡ršg
 &
chªÃl
, cÚ¡ 
by‹
 *
begš
, 
size_t
 
Ëngth
, 
mes§geEnd
, 
boŞ
 
blockšg
)

836 ià(
chªÃl
.
	`em±y
())

837  
SŒ—mT¿nsfÜm©iÚF‹r
::
	`Put2
(
begš
, 
Ëngth
, 
mes§geEnd
, 
blockšg
);

839 ià(
chªÃl
 =ğ
AAD_CHANNEL
)

840  
m_hf
.
	`Put2
(
begš
, 
Ëngth
, 0, 
blockšg
);

842 
throw
 
	`Inv®idChªÃlName
("Auth’tiÿ‹dEnüy±iÚF‹r", 
chªÃl
);

843 
	}
}

845 
	gAuth’tiÿ‹dEnüy±iÚF‹r
::
	$La¡Put
(cÚ¡ 
by‹
 *
šSŒšg
, 
size_t
 
Ëngth
)

847 
SŒ—mT¿nsfÜm©iÚF‹r
::
	`La¡Put
(
šSŒšg
, 
Ëngth
);

848 
m_hf
.
	`Mes§geEnd
();

849 
	}
}

853 
	gAuth’tiÿ‹dDeüy±iÚF‹r
::
	$Auth’tiÿ‹dDeüy±iÚF‹r
(
Auth’tiÿ‹dSymm‘ricCh”
 &
c
, 
Bufã»dT¿nsfÜm©iÚ
 *
©chm’t
, 
wÜd32
 
æags
, 
Œunÿ‹dDige¡Size
, 
BlockPaddšgScheme
 
·ddšg
)

854 : 
	`F‹rW™hBufã»dIÅut
(
©chm’t
)

855 , 
	`m_hashV”if›r
(
c
, 
Ãw
 
	`OuutProxy
(*
this
, 
çl£
))

856 , 
	`m_¡»amF‹r
(
c
, 
Ãw
 
	`OuutProxy
(*
this
, 
çl£
), 
·ddšg
, 
Œue
)

858 
	`as£¹
(!
c
.
	`IsFÜw¬dT¿nsfÜm©iÚ
(è|| c.
	`IsS–fInv”tšg
());

859 
	`IsŞ©edIn™Ÿlize
(
	`MakeP¬am‘”s
(
Name
::
	`BlockPaddšgScheme
(), 
·ddšg
)(Name::
	`Auth’tiÿ‹dDeüy±iÚF‹rFÏgs
(), 
æags
)(Name::
	`Trunÿ‹dDige¡Size
(), 
Œunÿ‹dDige¡Size
));

860 
	}
}

862 
	gAuth’tiÿ‹dDeüy±iÚF‹r
::
	$In™ŸlizeD”ivedAndR‘uºNewSizes
(cÚ¡ 
NameV®uePaœs
 &
·¿m‘”s
, 
size_t
 &
fœ¡Size
, size_ˆ&
blockSize
, size_ˆ&
Ï¡Size
)

864 
wÜd32
 
æags
 = 
·¿m‘”s
.
	`G‘V®ueW™hDeçuÉ
(
Name
::
	`Auth’tiÿ‹dDeüy±iÚF‹rFÏgs
(), (wÜd32)
DEFAULT_FLAGS
);

866 
m_hashV”if›r
.
	`In™Ÿlize
(
	`CombšedNameV®uePaœs
(
·¿m‘”s
, 
	`MakeP¬am‘”s
(
Name
::
	`HashV”ifiÿtiÚF‹rFÏgs
(), 
æags
)));

867 
m_¡»amF‹r
.
	`In™Ÿlize
(
·¿m‘”s
);

869 
fœ¡Size
 = 
m_hashV”if›r
.
m_fœ¡Size
;

870 
blockSize
 = 1;

871 
Ï¡Size
 = 
m_hashV”if›r
.
m_Ï¡Size
;

872 
	}
}

874 
by‹
 * 
	gAuth’tiÿ‹dDeüy±iÚF‹r
::
	$ChªÃlC»©ePutS·û
(cÚ¡ 
¡d
::
¡ršg
 &
chªÃl
, 
size_t
 &
size
)

876 ià(
chªÃl
.
	`em±y
())

877  
m_¡»amF‹r
.
	`C»©ePutS·û
(
size
);

879 ià(
chªÃl
 =ğ
AAD_CHANNEL
)

880  
m_hashV”if›r
.
	`C»©ePutS·û
(
size
);

882 
throw
 
	`Inv®idChªÃlName
("Auth’tiÿ‹dDeüy±iÚF‹r", 
chªÃl
);

883 
	}
}

885 
size_t
 
	gAuth’tiÿ‹dDeüy±iÚF‹r
::
	$ChªÃlPut2
(cÚ¡ 
¡d
::
¡ršg
 &
chªÃl
, cÚ¡ 
by‹
 *
begš
, 
size_t
 
Ëngth
, 
mes§geEnd
, 
boŞ
 
blockšg
)

887 ià(
chªÃl
.
	`em±y
())

889 ià(
m_Ï¡Size
 > 0)

890 
m_hashV”if›r
.
	`FÜûNextPut
();

891  
F‹rW™hBufã»dIÅut
::
	`Put2
(
begš
, 
Ëngth
, 
mes§geEnd
, 
blockšg
);

894 ià(
chªÃl
 =ğ
AAD_CHANNEL
)

895  
m_hashV”if›r
.
	`Put2
(
begš
, 
Ëngth
, 0, 
blockšg
);

897 
throw
 
	`Inv®idChªÃlName
("Auth’tiÿ‹dDeüy±iÚF‹r", 
chªÃl
);

898 
	}
}

900 
	gAuth’tiÿ‹dDeüy±iÚF‹r
::
	$Fœ¡Put
(cÚ¡ 
by‹
 *
šSŒšg
)

902 
m_hashV”if›r
.
	`Put
(
šSŒšg
, 
m_fœ¡Size
);

903 
	}
}

905 
	gAuth’tiÿ‹dDeüy±iÚF‹r
::
	$NextPutMuÉË
(cÚ¡ 
by‹
 *
šSŒšg
, 
size_t
 
Ëngth
)

907 
m_¡»amF‹r
.
	`Put
(
šSŒšg
, 
Ëngth
);

908 
	}
}

910 
	gAuth’tiÿ‹dDeüy±iÚF‹r
::
	$La¡Put
(cÚ¡ 
by‹
 *
šSŒšg
, 
size_t
 
Ëngth
)

912 
m_¡»amF‹r
.
	`Mes§geEnd
();

913 
m_hashV”if›r
.
	`PutMes§geEnd
(
šSŒšg
, 
Ëngth
);

914 
	}
}

918 
	gSigÃrF‹r
::
	$IsŞ©edIn™Ÿlize
(cÚ¡ 
NameV®uePaœs
 &
·¿m‘”s
)

920 
m_putMes§ge
 = 
·¿m‘”s
.
	`G‘V®ueW™hDeçuÉ
(
Name
::
	`PutMes§ge
(), 
çl£
);

921 
m_mes§geAccumuÏtÜ
.
	`»£t
(
m_sigÃr
.
	`NewSigÇtu»AccumuÏtÜ
(
m_ºg
));

922 
	}
}

924 
size_t
 
	gSigÃrF‹r
::
	$Put2
(cÚ¡ 
by‹
 *
šSŒšg
, 
size_t
 
Ëngth
, 
mes§geEnd
, 
boŞ
 
blockšg
)

926 
FILTER_BEGIN
;

927 
m_mes§geAccumuÏtÜ
->
	`Upd©e
(
šSŒšg
, 
Ëngth
);

928 ià(
m_putMes§ge
)

929 
	`FILTER_OUTPUT
(1, 
šSŒšg
, 
Ëngth
, 0);

930 ià(
mes§geEnd
)

932 
m_buf
.
	`New
(
m_sigÃr
.
	`SigÇtu»L’gth
());

933 
m_sigÃr
.
	`Sign
(
m_ºg
, 
m_mes§geAccumuÏtÜ
.
	`»Ëa£
(), 
m_buf
);

934 
	`FILTER_OUTPUT
(2, 
m_buf
, m_buf.
	`size
(), 
mes§geEnd
);

935 
m_mes§geAccumuÏtÜ
.
	`»£t
(
m_sigÃr
.
	`NewSigÇtu»AccumuÏtÜ
(
m_ºg
));

937 
FILTER_END_NO_MESSAGE_END
;

938 
	}
}

940 
	gSigÇtu»V”ifiÿtiÚF‹r
::
	$SigÇtu»V”ifiÿtiÚF‹r
(cÚ¡ 
PK_V”if›r
 &
v”if›r
, 
Bufã»dT¿nsfÜm©iÚ
 *
©chm’t
, 
wÜd32
 
æags
)

941 : 
	`F‹rW™hBufã»dIÅut
(
©chm’t
)

942 , 
	$m_v”if›r
(
v”if›r
)

944 
	`IsŞ©edIn™Ÿlize
(
	`MakeP¬am‘”s
(
Name
::
	`SigÇtu»V”ifiÿtiÚF‹rFÏgs
(), 
æags
));

945 
	}
}

947 
	gSigÇtu»V”ifiÿtiÚF‹r
::
	$In™ŸlizeD”ivedAndR‘uºNewSizes
(cÚ¡ 
NameV®uePaœs
 &
·¿m‘”s
, 
size_t
 &
fœ¡Size
, size_ˆ&
blockSize
, size_ˆ&
Ï¡Size
)

949 
m_æags
 = 
·¿m‘”s
.
	`G‘V®ueW™hDeçuÉ
(
Name
::
	`SigÇtu»V”ifiÿtiÚF‹rFÏgs
(), (
wÜd32
)
DEFAULT_FLAGS
);

950 
m_mes§geAccumuÏtÜ
.
	`»£t
(
m_v”if›r
.
	`NewV”ifiÿtiÚAccumuÏtÜ
());

951 
size_t
 
size
 = 
m_v”if›r
.
	`SigÇtu»L’gth
();

952 
	`as£¹
(
size
 != 0);

953 
m_v”if›d
 = 
çl£
;

954 
fœ¡Size
 = 
m_æags
 & 
SIGNATURE_AT_BEGIN
 ? 
size
 : 0;

955 
blockSize
 = 1;

956 
Ï¡Size
 = 
m_æags
 & 
SIGNATURE_AT_BEGIN
 ? 0 : 
size
;

957 
	}
}

959 
	gSigÇtu»V”ifiÿtiÚF‹r
::
	$Fœ¡Put
(cÚ¡ 
by‹
 *
šSŒšg
)

961 ià(
m_æags
 & 
SIGNATURE_AT_BEGIN
)

963 ià(
m_v”if›r
.
	`SigÇtu»UpäÚt
())

964 
m_v”if›r
.
	`IÅutSigÇtu»
(*
m_mes§geAccumuÏtÜ
, 
šSŒšg
, m_v”if›r.
	`SigÇtu»L’gth
());

967 
m_sigÇtu»
.
	`New
(
m_v”if›r
.
	`SigÇtu»L’gth
());

968 
	`memıy
(
m_sigÇtu»
, 
šSŒšg
, m_sigÇtu».
	`size
());

971 ià(
m_æags
 & 
PUT_SIGNATURE
)

972 
	`A‰achedT¿nsfÜm©iÚ
()->
	`Put
(
šSŒšg
, 
m_sigÇtu»
.
	`size
());

976 
	`as£¹
(!
m_v”if›r
.
	`SigÇtu»UpäÚt
());

978 
	}
}

980 
	gSigÇtu»V”ifiÿtiÚF‹r
::
	$NextPutMuÉË
(cÚ¡ 
by‹
 *
šSŒšg
, 
size_t
 
Ëngth
)

982 
m_mes§geAccumuÏtÜ
->
	`Upd©e
(
šSŒšg
, 
Ëngth
);

983 ià(
m_æags
 & 
PUT_MESSAGE
)

984 
	`A‰achedT¿nsfÜm©iÚ
()->
	`Put
(
šSŒšg
, 
Ëngth
);

985 
	}
}

987 
	gSigÇtu»V”ifiÿtiÚF‹r
::
	$La¡Put
(cÚ¡ 
by‹
 *
šSŒšg
, 
size_t
 
Ëngth
)

989 ià(
m_æags
 & 
SIGNATURE_AT_BEGIN
)

991 
	`as£¹
(
Ëngth
 == 0);

992 
m_v”if›r
.
	`IÅutSigÇtu»
(*
m_mes§geAccumuÏtÜ
, 
m_sigÇtu»
, m_sigÇtu».
	`size
());

993 
m_v”if›d
 = 
m_v”if›r
.
	`V”ifyAndRe¡¬t
(*
m_mes§geAccumuÏtÜ
);

997 
m_v”if›r
.
	`IÅutSigÇtu»
(*
m_mes§geAccumuÏtÜ
, 
šSŒšg
, 
Ëngth
);

998 
m_v”if›d
 = 
m_v”if›r
.
	`V”ifyAndRe¡¬t
(*
m_mes§geAccumuÏtÜ
);

999 ià(
m_æags
 & 
PUT_SIGNATURE
)

1000 
	`A‰achedT¿nsfÜm©iÚ
()->
	`Put
(
šSŒšg
, 
Ëngth
);

1003 ià(
m_æags
 & 
PUT_RESULT
)

1004 
	`A‰achedT¿nsfÜm©iÚ
()->
	`Put
(
m_v”if›d
);

1006 ià((
m_æags
 & 
THROW_EXCEPTION
è&& !
m_v”if›d
)

1007 
throw
 
	`SigÇtu»V”ifiÿtiÚFaed
();

1008 
	}
}

1012 
size_t
 
	gSourû
::
	$PumpAÎ2
(
boŞ
 
blockšg
)

1014 
mes§geCouÁ
 = 
UINT_MAX
;

1016 
	`RETURN_IF_NONZERO
(
	`PumpMes§ges2
(
mes§geCouÁ
, 
blockšg
));

1017 } 
mes§geCouÁ
 =ğ
UINT_MAX
);

1020 
	}
}

1022 
boŞ
 
	gStÜe
::
	$G‘NextMes§ge
()

1024 ià(!
m_mes§geEnd
 && !
	`AnyR‘r›vabË
())

1026 
m_mes§geEnd
=
Œue
;

1027  
Œue
;

1030  
çl£
;

1031 
	}
}

1033 
	gStÜe
::
	$CİyMes§gesTo
(
Bufã»dT¿nsfÜm©iÚ
 &
rg‘
, 
couÁ
, cÚ¡ 
¡d
::
¡ršg
 &
chªÃl
) const

1035 ià(
m_mes§geEnd
 || 
couÁ
 == 0)

1039 
	`CİyTo
(
rg‘
, 
ULONG_MAX
, 
chªÃl
);

1040 ià(
	`G‘AutoSigÇlPrİag©iÚ
())

1041 
rg‘
.
	`ChªÃlMes§geEnd
(
chªÃl
, 
	`G‘AutoSigÇlPrİag©iÚ
()-1);

1044 
	}
}

1046 
	gSŒšgStÜe
::
	$StÜeIn™Ÿlize
(cÚ¡ 
NameV®uePaœs
 &
·¿m‘”s
)

1048 
CÚ¡By‹A¼ayP¬am‘”
 
¬¿y
;

1049 ià(!
·¿m‘”s
.
	`G‘V®ue
(
Name
::
	`IÅutBufãr
(), 
¬¿y
))

1050 
throw
 
	`Inv®idArgum’t
("StringStore: missing InputBuffer‡rgument");

1051 
m_¡Üe
 = 
¬¿y
.
	`begš
();

1052 
m_Ëngth
 = 
¬¿y
.
	`size
();

1053 
m_couÁ
 = 0;

1054 
	}
}

1056 
size_t
 
	gSŒšgStÜe
::
	$T¿nsãrTo2
(
Bufã»dT¿nsfÜm©iÚ
 &
rg‘
, 
lwÜd
 &
ŒªsãrBy‹s
, cÚ¡ 
¡d
::
¡ršg
 &
chªÃl
, 
boŞ
 
blockšg
)

1058 
lwÜd
 
pos™iÚ
 = 0;

1059 
size_t
 
blockedBy‹s
 = 
	`CİyRªgeTo2
(
rg‘
, 
pos™iÚ
, 
ŒªsãrBy‹s
, 
chªÃl
, 
blockšg
);

1060 
m_couÁ
 +ğ(
size_t
)
pos™iÚ
;

1061 
ŒªsãrBy‹s
 = 
pos™iÚ
;

1062  
blockedBy‹s
;

1063 
	}
}

1065 
size_t
 
	gSŒšgStÜe
::
	$CİyRªgeTo2
(
Bufã»dT¿nsfÜm©iÚ
 &
rg‘
, 
lwÜd
 &
begš
,†wÜd 
’d
, cÚ¡ 
¡d
::
¡ršg
 &
chªÃl
, 
boŞ
 
blockšg
) const

1067 
size_t
 
i
 = 
	`UnsigÃdMš
(
m_Ëngth
, 
m_couÁ
+
begš
);

1068 
size_t
 
Ën
 = 
	`UnsigÃdMš
(
m_Ëngth
-
i
, 
’d
-
begš
);

1069 
size_t
 
blockedBy‹s
 = 
rg‘
.
	`ChªÃlPut2
(
chªÃl
, 
m_¡Üe
+
i
, 
Ën
, 0, 
blockšg
);

1070 ià(!
blockedBy‹s
)

1071 
begš
 +ğ
Ën
;

1072  
blockedBy‹s
;

1073 
	}
}

1075 
	gRªdomNumb”StÜe
::
	$StÜeIn™Ÿlize
(cÚ¡ 
NameV®uePaœs
 &
·¿m‘”s
)

1077 
·¿m‘”s
.
	`G‘RequœedP¬am‘”
("RªdomNumb”StÜe", "RªdomNumb”G’”©ÜPoš‹r", 
m_ºg
);

1078 
Ëngth
;

1079 
·¿m‘”s
.
	`G‘RequœedIÁP¬am‘”
("RªdomNumb”StÜe", "RªdomNumb”StÜeSize", 
Ëngth
);

1080 
m_Ëngth
 = 
Ëngth
;

1081 
	}
}

1083 
size_t
 
	gRªdomNumb”StÜe
::
	$T¿nsãrTo2
(
Bufã»dT¿nsfÜm©iÚ
 &
rg‘
, 
lwÜd
 &
ŒªsãrBy‹s
, cÚ¡ 
¡d
::
¡ršg
 &
chªÃl
, 
boŞ
 
blockšg
)

1085 ià(!
blockšg
)

1086 
throw
 
	`NÙIm¶em’‹d
("RandomNumberStore:‚onblockingransfer is‚ot implemented byhis object");

1088 
ŒªsãrBy‹s
 = 
	`UnsigÃdMš
Ñ¿nsãrBy‹s, 
m_Ëngth
 - 
m_couÁ
);

1089 
m_ºg
->
	`G’”©eIÁoBufã»dT¿nsfÜm©iÚ
(
rg‘
, 
chªÃl
, 
ŒªsãrBy‹s
);

1090 
m_couÁ
 +ğ
ŒªsãrBy‹s
;

1093 
	}
}

1095 
size_t
 
	gNuÎStÜe
::
	$CİyRªgeTo2
(
Bufã»dT¿nsfÜm©iÚ
 &
rg‘
, 
lwÜd
 &
begš
,†wÜd 
’d
, cÚ¡ 
¡d
::
¡ršg
 &
chªÃl
, 
boŞ
 
blockšg
) const

1097 cÚ¡ 
by‹
 
nuÎBy‹s
[128] = {0};

1098 
begš
 < 
’d
)

1100 
size_t
 
Ën
 = (size_t)
	`STDMIN
(
’d
-
begš
, 
	`lwÜd
(128));

1101 
size_t
 
blockedBy‹s
 = 
rg‘
.
	`ChªÃlPut2
(
chªÃl
, 
nuÎBy‹s
, 
Ën
, 0, 
blockšg
);

1102 ià(
blockedBy‹s
)

1103  
blockedBy‹s
;

1104 
begš
 +ğ
Ën
;

1107 
	}
}

1109 
size_t
 
	gNuÎStÜe
::
	$T¿nsãrTo2
(
Bufã»dT¿nsfÜm©iÚ
 &
rg‘
, 
lwÜd
 &
ŒªsãrBy‹s
, cÚ¡ 
¡d
::
¡ršg
 &
chªÃl
, 
boŞ
 
blockšg
)

1111 
lwÜd
 
begš
 = 0;

1112 
size_t
 
blockedBy‹s
 = 
NuÎStÜe
::
	`CİyRªgeTo2
(
rg‘
, 
begš
, 
ŒªsãrBy‹s
, 
chªÃl
, 
blockšg
);

1113 
ŒªsãrBy‹s
 = 
begš
;

1114 
m_size
 -ğ
begš
;

1115  
blockedBy‹s
;

1116 
	}
}

1118 
	gNAMESPACE_END


	@filters.h

1 #iâdeà
CRYPTOPP_FILTERS_H


2 
	#CRYPTOPP_FILTERS_H


	)

6 
	~"sim¶e.h
"

7 
	~"£cblock.h
"

8 
	~"misc.h
"

9 
	~"sm¬Œ.h
"

10 
	~"queue.h
"

11 
	~"®g·¿m.h
"

12 
	~<deque
>

14 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

17 
şass
 
CRYPTOPP_DLL
 
CRYPTOPP_NO_VTABLE
 
F‹r
 : 
public
 
Bufã»dT¿nsfÜm©iÚ
,…ubliø
NÙCİyabË


19 
public
:

20 
	`F‹r
(
Bufã»dT¿nsfÜm©iÚ
 *
©chm’t
 = 
NULL
);

22 
boŞ
 
	`A‰achabË
(è{ 
Œue
;}

23 
Bufã»dT¿nsfÜm©iÚ
 *
	`A‰achedT¿nsfÜm©iÚ
();

24 cÚ¡ 
Bufã»dT¿nsfÜm©iÚ
 *
	`A‰achedT¿nsfÜm©iÚ
() const;

25 
	`D‘ach
(
Bufã»dT¿nsfÜm©iÚ
 *
ÃwA‰achm’t
 = 
NULL
);

27 
size_t
 
	`T¿nsãrTo2
(
Bufã»dT¿nsfÜm©iÚ
 &
rg‘
, 
lwÜd
 &
ŒªsãrBy‹s
, cÚ¡ 
¡d
::
¡ršg
 &
chªÃl
=
DEFAULT_CHANNEL
, 
boŞ
 
blockšg
=
Œue
);

28 
size_t
 
	`CİyRªgeTo2
(
Bufã»dT¿nsfÜm©iÚ
 &
rg‘
, 
lwÜd
 &
begš
,†wÜd 
’d
=
LWORD_MAX
, cÚ¡ 
¡d
::
¡ršg
 &
chªÃl
=
DEFAULT_CHANNEL
, 
boŞ
 
blockšg
=
Œue
) const;

30 
	`In™Ÿlize
(cÚ¡ 
NameV®uePaœs
 &
·¿m‘”s
=
g_nuÎNameV®uePaœs
, 
´İag©iÚ
=-1);

31 
boŞ
 
	`Flush
(boŞ 
h¬dFlush
, 
´İag©iÚ
=-1, boŞ 
blockšg
=
Œue
);

32 
boŞ
 
	`Mes§geS”›sEnd
(
´İag©iÚ
=-1, boŞ 
blockšg
=
Œue
);

34 
´Ùeùed
:

35 
vœtu®
 
Bufã»dT¿nsfÜm©iÚ
 * 
	`NewDeçuÉA‰achm’t
() const;

36 
	`In£¹
(
F‹r
 *
ÃxtF‹r
);

38 
vœtu®
 
boŞ
 
	`ShouldPrİag©eMes§geEnd
(ècÚ¡ { 
Œue
;}

39 
vœtu®
 
boŞ
 
	`ShouldPrİag©eMes§geS”›sEnd
(ècÚ¡ { 
Œue
;}

41 
	`Prİag©eIn™Ÿlize
(cÚ¡ 
NameV®uePaœs
 &
·¿m‘”s
, 
´İag©iÚ
);

43 
size_t
 
	`Ouut
(
ouutS™e
, cÚ¡ 
by‹
 *
šSŒšg
, size_ˆ
Ëngth
, 
mes§geEnd
, 
boŞ
 
blockšg
, cÚ¡ 
¡d
::
¡ršg
 &
chªÃl
=
DEFAULT_CHANNEL
);

44 
size_t
 
	`OuutModifŸbË
(
ouutS™e
, 
by‹
 *
šSŒšg
, size_ˆ
Ëngth
, 
mes§geEnd
, 
boŞ
 
blockšg
, cÚ¡ 
¡d
::
¡ršg
 &
chªÃl
=
DEFAULT_CHANNEL
);

45 
boŞ
 
	`OuutMes§geEnd
(
ouutS™e
, 
´İag©iÚ
, boŞ 
blockšg
, cÚ¡ 
¡d
::
¡ršg
 &
chªÃl
=
DEFAULT_CHANNEL
);

46 
boŞ
 
	`OuutFlush
(
ouutS™e
, boŞ 
h¬dFlush
, 
´İag©iÚ
, boŞ 
blockšg
, cÚ¡ 
¡d
::
¡ršg
 &
chªÃl
=
DEFAULT_CHANNEL
);

47 
boŞ
 
	`OuutMes§geS”›sEnd
(
ouutS™e
, 
´İag©iÚ
, boŞ 
blockšg
, cÚ¡ 
¡d
::
¡ršg
 &
chªÃl
=
DEFAULT_CHANNEL
);

49 
´iv©e
:

50 
memb”_±r
<
Bufã»dT¿nsfÜm©iÚ
> 
m_©chm’t
;

52 
´Ùeùed
:

53 
size_t
 
m_šputPos™iÚ
;

54 
m_cÚtšueAt
;

55 
	}
};

57 
CRYPTOPP_DLL
 
	gF‹rPutS·ûH–³r


60 
by‹
 *
H–pC»©ePutS·û
(
Bufã»dT¿nsfÜm©iÚ
 &
rg‘
, cÚ¡ 
¡d
::
¡ršg
 &
chªÃl
, 
size_t
 
mšSize
, size_ˆ
desœedSize
, size_ˆ&
bufãrSize
)

62 
as£¹
(
desœedSize
 >ğ
mšSize
 && 
bufãrSize
 >= minSize);

63 ià(
	gm_‹mpS·û
.
size
(è< 
	gmšSize
)

65 
by‹
 *
	g»suÉ
 = 
rg‘
.
ChªÃlC»©ePutS·û
(
chªÃl
, 
desœedSize
);

66 ià(
	gdesœedSize
 >ğ
mšSize
)

68 
bufãrSize
 = 
desœedSize
;

69  
	g»suÉ
;

71 
	gm_‹mpS·û
.
New
(
bufãrSize
);

74 
	gbufãrSize
 = 
m_‹mpS·û
.
size
();

75  
	gm_‹mpS·û
.
begš
();

77 
by‹
 *
H–pC»©ePutS·û
(
Bufã»dT¿nsfÜm©iÚ
 &
rg‘
, cÚ¡ 
¡d
::
¡ršg
 &
chªÃl
, 
size_t
 
mšSize
)

78 { 
H–pC»©ePutS·û
(
rg‘
, 
chªÃl
, 
mšSize
, minSize, minSize);}

79 
by‹
 *
H–pC»©ePutS·û
(
Bufã»dT¿nsfÜm©iÚ
 &
rg‘
, cÚ¡ 
¡d
::
¡ršg
 &
chªÃl
, 
size_t
 
mšSize
, size_ˆ
bufãrSize
)

80 { 
H–pC»©ePutS·û
(
rg‘
, 
chªÃl
, 
mšSize
, mšSize, 
bufãrSize
);}

81 
SecBy‹Block
 
	gm_‹mpS·û
;

85 
şass
 
CRYPTOPP_DLL
 
	gM‘”F‹r
 : 
public
 
Bufã¾ess
<
F‹r
>

87 
public
:

88 
M‘”F‹r
(
Bufã»dT¿nsfÜm©iÚ
 *
©chm’t
=
NULL
, 
boŞ
 
Œª¥¬’t
=
Œue
)

89 : 
m_Œª¥¬’t
(
Œª¥¬’t
è{
D‘ach
(
©chm’t
); 
Re£tM‘”
();}

91 
S‘T¿n¥¬’t
(
boŞ
 
Œª¥¬’t
è{
	gm_Œª¥¬’t
 =ransparent;}

92 
AddRªgeToSk
(
mes§ge
, 
lwÜd
 
pos™iÚ
,†wÜd 
size
, 
boŞ
 
sÜtNow
 = 
Œue
);

93 
Re£tM‘”
();

94 
IsŞ©edIn™Ÿlize
(cÚ¡ 
NameV®uePaœs
 &
·¿m‘”s
è{
Re£tM‘”
();}

96 
lwÜd
 
G‘Cu¼’tMes§geBy‹s
(ècÚ¡ { 
	gm_cu¼’tMes§geBy‹s
;}

97 
lwÜd
 
G‘TÙ®By‹s
(è{ 
	gm_tÙ®By‹s
;}

98 
G‘Cu¼’tS”›sMes§ges
(è{ 
	gm_cu¼’tS”›sMes§ges
;}

99 
G‘TÙ®Mes§ges
(è{ 
	gm_tÙ®Mes§ges
;}

100 
G‘TÙ®Mes§geS”›s
(è{ 
	gm_tÙ®Mes§geS”›s
;}

102 
by‹
 * 
C»©ePutS·û
(
size_t
 &
size
)

103 { 
A‰achedT¿nsfÜm©iÚ
()->
C»©ePutS·û
(
size
);}

104 
size_t
 
Put2
(cÚ¡ 
by‹
 *
begš
, size_ˆ
Ëngth
, 
mes§geEnd
, 
boŞ
 
blockšg
);

105 
size_t
 
PutModifŸbË2
(
by‹
 *
šSŒšg
, size_ˆ
Ëngth
, 
mes§geEnd
, 
boŞ
 
blockšg
);

106 
boŞ
 
IsŞ©edMes§geS”›sEnd
(boŞ 
blockšg
);

108 
	g´iv©e
:

109 
size_t
 
PutMaybeModifŸbË
(
by‹
 *
šSŒšg
, size_ˆ
Ëngth
, 
mes§geEnd
, 
boŞ
 
blockšg
, boŞ 
modifŸbË
);

110 
boŞ
 
ShouldPrİag©eMes§geEnd
(ècÚ¡ { 
	gm_Œª¥¬’t
;}

111 
boŞ
 
ShouldPrİag©eMes§geS”›sEnd
(ècÚ¡ { 
	gm_Œª¥¬’t
;}

113 
	sMes§geRªge


115 
šlše
 
boŞ
 
	gİ”©Ü
<(cÚ¡ 
	gMes§geRªge
 &
	gb
) const

116 { 
	gmes§ge
 < 
	gb
.mes§g|| (mes§g=ğ
b
.
mes§ge
 && 
pos™iÚ
 < b.position);}

117 
	gmes§ge
; 
lwÜd
 
	gpos™iÚ
;†wÜd 
	gsize
;

120 
boŞ
 
	gm_Œª¥¬’t
;

121 
lwÜd
 
	gm_cu¼’tMes§geBy‹s
, 
	gm_tÙ®By‹s
;

122 
	gm_cu¼’tS”›sMes§ges
, 
	gm_tÙ®Mes§ges
, 
	gm_tÙ®Mes§geS”›s
;

123 
	g¡d
::
deque
<
Mes§geRªge
> 
m_¿ngesToSk
;

124 
by‹
 *
	gm_begš
;

125 
size_t
 
	gm_Ëngth
;

129 şas 
	cCRYPTOPP_DLL
 
	mT¿n¥¬’tF‹r
 : 
public
 
M‘”F‹r


131 
public
:

132 
	$T¿n¥¬’tF‹r
(
Bufã»dT¿nsfÜm©iÚ
 *
©chm’t
=
NULL
è: 
	$M‘”F‹r
(
©chm’t
, 
Œue
) {}

133 
	}
};

136 şas 
	cCRYPTOPP_DLL
 
	mO·queF‹r
 : 
public
 
M‘”F‹r


138 
public
:

139 
	$O·queF‹r
(
Bufã»dT¿nsfÜm©iÚ
 *
©chm’t
=
NULL
è: 
	$M‘”F‹r
(
©chm’t
, 
çl£
) {}

140 
	}
};

147 şas 
	cCRYPTOPP_DLL
 
	mF‹rW™hBufã»dIÅut
 : 
public
 
F‹r


149 
public
:

150 
F‹rW™hBufã»dIÅut
(
Bufã»dT¿nsfÜm©iÚ
 *
©chm’t
);

152 
F‹rW™hBufã»dIÅut
(
size_t
 
fœ¡Size
, size_ˆ
blockSize
, size_ˆ
Ï¡Size
, 
Bufã»dT¿nsfÜm©iÚ
 *
©chm’t
);

154 
IsŞ©edIn™Ÿlize
(cÚ¡ 
NameV®uePaœs
 &
·¿m‘”s
);

155 
size_t
 
	$Put2
(cÚ¡ 
by‹
 *
šSŒšg
, 
size_t
 
Ëngth
, 
mes§geEnd
, 
boŞ
 
blockšg
)

157  
	`PutMaybeModifŸbË
(
cÚ¡_ÿ¡
<
by‹
 *>(
šSŒšg
), 
Ëngth
, 
mes§geEnd
, 
blockšg
, 
çl£
);

159 
size_t
 
	$PutModifŸbË2
(
by‹
 *
šSŒšg
, 
size_t
 
Ëngth
, 
mes§geEnd
, 
boŞ
 
blockšg
)

161  
	`PutMaybeModifŸbË
(
šSŒšg
, 
Ëngth
, 
mes§geEnd
, 
blockšg
, 
Œue
);

162 
	}
}

164 
boŞ
 
IsŞ©edFlush
(boŞ 
h¬dFlush
, boŞ 
blockšg
);

169 
FÜûNextPut
();

171 
	g´Ùeùed
:

172 
boŞ
 
	$DidFœ¡Put
(è{ 
m_fœ¡IÅutDÚe
;
	}
}

174 
vœtu®
 
	$In™ŸlizeD”ivedAndR‘uºNewSizes
(cÚ¡ 
NameV®uePaœs
 &
·¿m‘”s
, 
size_t
 &
fœ¡Size
, size_ˆ&
blockSize
, size_ˆ&
Ï¡Size
)

175 {
	`In™ŸlizeD”ived
(
·¿m‘”s
);
	}
}

176 
vœtu®
 
	$In™ŸlizeD”ived
(cÚ¡ 
NameV®uePaœs
 &
·¿m‘”s
è{
	}
}

179 
vœtu®
 
Fœ¡Put
(cÚ¡ 
by‹
 *
šSŒšg
) =0;

181 
vœtu®
 
	$NextPutSšgË
(cÚ¡ 
by‹
 *
šSŒšg
è{
	`as£¹
(
çl£
);
	}
}

184 
vœtu®
 
NextPutMuÉË
(cÚ¡ 
by‹
 *
šSŒšg
, 
size_t
 
Ëngth
);

186 
vœtu®
 
	$NextPutModifŸbË
(
by‹
 *
šSŒšg
, 
size_t
 
Ëngth
)

187 {
	`NextPutMuÉË
(
šSŒšg
, 
Ëngth
);
	}
}

192 
vœtu®
 
La¡Put
(cÚ¡ 
by‹
 *
šSŒšg
, 
size_t
 
Ëngth
) =0;

193 
vœtu®
 
	$FlushD”ived
(è{
	}
}

195 
	g´Ùeùed
:

196 
size_t
 
PutMaybeModifŸbË
(
by‹
 *
begš
, size_ˆ
Ëngth
, 
mes§geEnd
, 
boŞ
 
blockšg
, boŞ 
modifŸbË
);

197 
	$NextPutMaybeModifŸbË
(
by‹
 *
šSŒšg
, 
size_t
 
Ëngth
, 
boŞ
 
modifŸbË
)

199 ià(
modifŸbË
è
	`NextPutModifŸbË
(
šSŒšg
, 
Ëngth
);

200 
	`NextPutMuÉË
(
šSŒšg
, 
Ëngth
);

201 
	}
}

205 
vœtu®
 
	$NextPut
(cÚ¡ 
by‹
 *
šSŒšg
, 
size_t
 
Ëngth
è{
	`as£¹
(
çl£
);  0;
	}
}

207 şas 
	cBlockQueue


209 
	gpublic
:

210 
Re£tQueue
(
size_t
 
blockSize
, size_ˆ
maxBlocks
);

211 
by‹
 *
G‘Block
();

212 
by‹
 *
G‘CÚtigousBlocks
(
size_t
 &
numb”OfBy‹s
);

213 
size_t
 
G‘AÎ
(
by‹
 *
outSŒšg
);

214 
Put
(cÚ¡ 
by‹
 *
šSŒšg
, 
size_t
 
Ëngth
);

215 
size_t
 
Cu¼’tSize
(ècÚ¡ { 
	gm_size
;}

216 
size_t
 
MaxSize
(ècÚ¡ { 
	gm_bufãr
.
size
();}

218 
	g´iv©e
:

219 
SecBy‹Block
 
m_bufãr
;

220 
size_t
 
	gm_blockSize
, 
	gm_maxBlocks
, 
	gm_size
;

221 
by‹
 *
	gm_begš
;

224 
size_t
 
	gm_fœ¡Size
, 
	gm_blockSize
, 
	gm_Ï¡Size
;

225 
boŞ
 
	gm_fœ¡IÅutDÚe
;

226 
BlockQueue
 
	gm_queue
;

230 şas 
	cCRYPTOPP_DLL
 
	mF‹rW™hIÅutQueue
 : 
public
 
F‹r


232 
public
:

233 
	$F‹rW™hIÅutQueue
(
Bufã»dT¿nsfÜm©iÚ
 *
©chm’t
=
NULL
è: 
	$F‹r
(
©chm’t
) {}

235 
size_t
 
	$Put2
(cÚ¡ 
by‹
 *
šSŒšg
, 
size_t
 
Ëngth
, 
mes§geEnd
, 
boŞ
 
blockšg
)

237 ià(!
blockšg
)

238 
throw
 
	`BlockšgIÅutOÆy
("FilterWithInputQueue");

240 
m_šQueue
.
	`Put
(
šSŒšg
, 
Ëngth
);

241 ià(
mes§geEnd
)

243 
	`IsŞ©edMes§geEnd
(
blockšg
);

244 
	`Ouut
(0, 
NULL
, 0, 
mes§geEnd
, 
blockšg
);

247 
	}
}

249 
	g´Ùeùed
:

250 
vœtu®
 
boŞ
 
IsŞ©edMes§geEnd
(boŞ 
blockšg
) =0;

251 
	$IsŞ©edIn™Ÿlize
(cÚ¡ 
NameV®uePaœs
 &
·¿m‘”s
è{
m_šQueue
.
	`CË¬
();
	}
}

253 
By‹Queue
 
	gm_šQueue
;

256 
	sBlockPaddšgSchemeDef


258 
	eBlockPaddšgScheme
 {
	mNO_PADDING
, 
	mZEROS_PADDING
, 
	mPKCS_PADDING
, 
	mONE_AND_ZEROS_PADDING
, 
	mDEFAULT_PADDING
};

262 
şass
 
CRYPTOPP_DLL
 
	gSŒ—mT¿nsfÜm©iÚF‹r
 : 
public
 
F‹rW™hBufã»dIÅut
,…ubliø
	gBlockPaddšgSchemeDef
, 
´iv©e
 
	gF‹rPutS·ûH–³r


264 
	gpublic
:

268 
SŒ—mT¿nsfÜm©iÚF‹r
(
SŒ—mT¿nsfÜm©iÚ
 &
c
, 
Bufã»dT¿nsfÜm©iÚ
 *
©chm’t
 = 
NULL
, 
BlockPaddšgScheme
 
·ddšg
 = 
DEFAULT_PADDING
, 
boŞ
 
®lowAuth’tiÿ‹dSymm‘ricCh”
 = 
çl£
);

270 
	g¡d
::
¡ršg
 
AlgÜ™hmName
(ècÚ¡ { 
m_ch”
.AlgorithmName();}

272 
	g´Ùeùed
:

273 
In™ŸlizeD”ivedAndR‘uºNewSizes
(cÚ¡ 
NameV®uePaœs
 &
·¿m‘”s
, 
size_t
 &
fœ¡Size
, size_ˆ&
blockSize
, size_ˆ&
Ï¡Size
);

274 
Fœ¡Put
(cÚ¡ 
by‹
 *
šSŒšg
);

275 
NextPutMuÉË
(cÚ¡ 
by‹
 *
šSŒšg
, 
size_t
 
Ëngth
);

276 
NextPutModifŸbË
(
by‹
 *
šSŒšg
, 
size_t
 
Ëngth
);

277 
La¡Put
(cÚ¡ 
by‹
 *
šSŒšg
, 
size_t
 
Ëngth
);

279 
size_t
 
La¡BlockSize
(
SŒ—mT¿nsfÜm©iÚ
 &
c
, 
BlockPaddšgScheme
 
·ddšg
);

281 
	gSŒ—mT¿nsfÜm©iÚ
 &
	gm_ch”
;

282 
BlockPaddšgScheme
 
	gm_·ddšg
;

283 
	gm_İtim®BufãrSize
;

286 #ifdeà
CRYPTOPP_MAINTAIN_BACKWARDS_COMPATIBILITY


287 
SŒ—mT¿nsfÜm©iÚF‹r
 
	tSŒ—mCh”F‹r
;

291 
şass
 
CRYPTOPP_DLL
 
	gHashF‹r
 : 
public
 
Bufã¾ess
<
F‹r
>, 
´iv©e
 
	gF‹rPutS·ûH–³r


293 
	gpublic
:

294 
HashF‹r
(
HashT¿nsfÜm©iÚ
 &
hm
, 
Bufã»dT¿nsfÜm©iÚ
 *
©chm’t
 = 
NULL
, 
boŞ
 
putMes§ge
=
çl£
, 
Œunÿ‹dDige¡Size
=-1, cÚ¡ 
¡d
::
¡ršg
 &
mes§gePutChªÃl
=
DEFAULT_CHANNEL
, cÚ¡ std::¡ršg &
hashPutChªÃl
=DEFAULT_CHANNEL);

296 
	g¡d
::
¡ršg
 
AlgÜ™hmName
(ècÚ¡ { 
m_hashModuË
.AlgorithmName();}

297 
IsŞ©edIn™Ÿlize
(cÚ¡ 
NameV®uePaœs
 &
·¿m‘”s
);

298 
size_t
 
Put2
(cÚ¡ 
by‹
 *
begš
, size_ˆ
Ëngth
, 
mes§geEnd
, 
boŞ
 
blockšg
);

299 
by‹
 * 
C»©ePutS·û
(
size_t
 &
size
è{ 
	gm_hashModuË
.
C»©eUpd©eS·û
(size);}

301 
	g´iv©e
:

302 
HashT¿nsfÜm©iÚ
 &
m_hashModuË
;

303 
boŞ
 
	gm_putMes§ge
;

304 
	gm_dige¡Size
;

305 
by‹
 *
	gm_¥aû
;

306 
	g¡d
::
¡ršg
 
m_mes§gePutChªÃl
, 
	gm_hashPutChªÃl
;

310 şas 
	cCRYPTOPP_DLL
 
	mHashV”ifiÿtiÚF‹r
 : 
public
 
F‹rW™hBufã»dIÅut


312 
public
:

313 şas 
	cHashV”ifiÿtiÚFaed
 : 
public
 
Exû±iÚ


315 
public
:

316 
HashV”ifiÿtiÚFaed
()

317 : 
Exû±iÚ
(
DATA_INTEGRITY_CHECK_FAILED
, "HashVerificationFilter: message hash or MAC‚ot valid") {}

320 
	eFÏgs
 {
	gHASH_AT_END
=0, 
	gHASH_AT_BEGIN
=1, 
	gPUT_MESSAGE
=2, 
	gPUT_HASH
=4, 
	gPUT_RESULT
=8, 
	gTHROW_EXCEPTION
=16, 
	gDEFAULT_FLAGS
 = 
HASH_AT_BEGIN
 | 
PUT_RESULT
};

321 
HashV”ifiÿtiÚF‹r
(
HashT¿nsfÜm©iÚ
 &
hm
, 
Bufã»dT¿nsfÜm©iÚ
 *
©chm’t
 = 
NULL
, 
wÜd32
 
æags
 = 
DEFAULT_FLAGS
, 
Œunÿ‹dDige¡Size
=-1);

323 
	g¡d
::
¡ršg
 
	$AlgÜ™hmName
(ècÚ¡ { 
m_hashModuË
.
	`AlgÜ™hmName
();
	}
}

324 
boŞ
 
	$G‘La¡ResuÉ
(ècÚ¡ { 
m_v”if›d
;
	}
}

326 
	g´Ùeùed
:

327 
In™ŸlizeD”ivedAndR‘uºNewSizes
(cÚ¡ 
NameV®uePaœs
 &
·¿m‘”s
, 
size_t
 &
fœ¡Size
, size_ˆ&
blockSize
, size_ˆ&
Ï¡Size
);

328 
Fœ¡Put
(cÚ¡ 
by‹
 *
šSŒšg
);

329 
NextPutMuÉË
(cÚ¡ 
by‹
 *
šSŒšg
, 
size_t
 
Ëngth
);

330 
La¡Put
(cÚ¡ 
by‹
 *
šSŒšg
, 
size_t
 
Ëngth
);

332 
	g´iv©e
:

333 
ä›nd
 
şass
 
Auth’tiÿ‹dDeüy±iÚF‹r
;

335 
	gHashT¿nsfÜm©iÚ
 &
	gm_hashModuË
;

336 
wÜd32
 
	gm_æags
;

337 
	gm_dige¡Size
;

338 
boŞ
 
	gm_v”if›d
;

339 
SecBy‹Block
 
	gm_ex³ùedHash
;

342 
HashV”ifiÿtiÚF‹r
 
	tHashV”if›r
;

346 şas 
	cCRYPTOPP_DLL
 
	mAuth’tiÿ‹dEnüy±iÚF‹r
 : 
public
 
SŒ—mT¿nsfÜm©iÚF‹r


348 
public
:

350 
Auth’tiÿ‹dEnüy±iÚF‹r
(
Auth’tiÿ‹dSymm‘ricCh”
 &
c
, 
Bufã»dT¿nsfÜm©iÚ
 *
©chm’t
 = 
NULL
, 
boŞ
 
putAAD
=
çl£
, 
Œunÿ‹dDige¡Size
=-1, cÚ¡ 
¡d
::
¡ršg
 &
macChªÃl
=
DEFAULT_CHANNEL
, 
BlockPaddšgScheme
 
·ddšg
 = 
DEFAULT_PADDING
);

352 
IsŞ©edIn™Ÿlize
(cÚ¡ 
NameV®uePaœs
 &
·¿m‘”s
);

353 
by‹
 * 
ChªÃlC»©ePutS·û
(cÚ¡ 
¡d
::
¡ršg
 &
chªÃl
, 
size_t
 &
size
);

354 
size_t
 
ChªÃlPut2
(cÚ¡ 
¡d
::
¡ršg
 &
chªÃl
, cÚ¡ 
by‹
 *
begš
, size_ˆ
Ëngth
, 
mes§geEnd
, 
boŞ
 
blockšg
);

355 
La¡Put
(cÚ¡ 
by‹
 *
šSŒšg
, 
size_t
 
Ëngth
);

357 
	m´Ùeùed
:

358 
HashF‹r
 
m_hf
;

363 
şass
 
CRYPTOPP_DLL
 
	gAuth’tiÿ‹dDeüy±iÚF‹r
 : 
public
 
F‹rW™hBufã»dIÅut
,…ubliø
	gBlockPaddšgSchemeDef


365 
	gpublic
:

366 
	eFÏgs
 {
MAC_AT_END
=0, 
	gMAC_AT_BEGIN
=1, 
	gTHROW_EXCEPTION
=16, 
	gDEFAULT_FLAGS
 = 
THROW_EXCEPTION
};

369 
Auth’tiÿ‹dDeüy±iÚF‹r
(
Auth’tiÿ‹dSymm‘ricCh”
 &
c
, 
Bufã»dT¿nsfÜm©iÚ
 *
©chm’t
 = 
NULL
, 
wÜd32
 
æags
 = 
DEFAULT_FLAGS
, 
Œunÿ‹dDige¡Size
=-1, 
BlockPaddšgScheme
 
·ddšg
 = 
DEFAULT_PADDING
);

371 
	g¡d
::
¡ršg
 
AlgÜ™hmName
(ècÚ¡ { 
m_hashV”if›r
.AlgorithmName();}

372 
by‹
 * 
ChªÃlC»©ePutS·û
(cÚ¡ 
¡d
::
¡ršg
 &
chªÃl
, 
size_t
 &
size
);

373 
size_t
 
ChªÃlPut2
(cÚ¡ 
¡d
::
¡ršg
 &
chªÃl
, cÚ¡ 
by‹
 *
begš
, size_ˆ
Ëngth
, 
mes§geEnd
, 
boŞ
 
blockšg
);

374 
boŞ
 
G‘La¡ResuÉ
(ècÚ¡ { 
	gm_hashV”if›r
.GetLastResult();}

376 
	g´Ùeùed
:

377 
In™ŸlizeD”ivedAndR‘uºNewSizes
(cÚ¡ 
NameV®uePaœs
 &
·¿m‘”s
, 
size_t
 &
fœ¡Size
, size_ˆ&
blockSize
, size_ˆ&
Ï¡Size
);

378 
Fœ¡Put
(cÚ¡ 
by‹
 *
šSŒšg
);

379 
NextPutMuÉË
(cÚ¡ 
by‹
 *
šSŒšg
, 
size_t
 
Ëngth
);

380 
La¡Put
(cÚ¡ 
by‹
 *
šSŒšg
, 
size_t
 
Ëngth
);

382 
HashV”ifiÿtiÚF‹r
 
	gm_hashV”if›r
;

383 
SŒ—mT¿nsfÜm©iÚF‹r
 
	gm_¡»amF‹r
;

387 
şass
 
CRYPTOPP_DLL
 
	gSigÃrF‹r
 : 
public
 
UnæushabË
<
F‹r
>

389 
public
:

390 
SigÃrF‹r
(
RªdomNumb”G’”©Ü
 &
ºg
, cÚ¡ 
PK_SigÃr
 &
sigÃr
, 
Bufã»dT¿nsfÜm©iÚ
 *
©chm’t
 = 
NULL
, 
boŞ
 
putMes§ge
=
çl£
)

391 : 
m_ºg
(
ºg
), 
m_sigÃr
(
sigÃr
), 
m_mes§geAccumuÏtÜ
(sigÃr.
NewSigÇtu»AccumuÏtÜ
Ông)), 
m_putMes§ge
(
putMes§ge
è{
D‘ach
(
©chm’t
);}

393 
	g¡d
::
¡ršg
 
AlgÜ™hmName
(ècÚ¡ { 
m_sigÃr
.AlgorithmName();}

395 
IsŞ©edIn™Ÿlize
(cÚ¡ 
NameV®uePaœs
 &
·¿m‘”s
);

396 
size_t
 
Put2
(cÚ¡ 
by‹
 *
begš
, size_ˆ
Ëngth
, 
mes§geEnd
, 
boŞ
 
blockšg
);

398 
	g´iv©e
:

399 
RªdomNumb”G’”©Ü
 &
m_ºg
;

400 cÚ¡ 
	gPK_SigÃr
 &
	gm_sigÃr
;

401 
	gmemb”_±r
<
	gPK_Mes§geAccumuÏtÜ
> 
	gm_mes§geAccumuÏtÜ
;

402 
boŞ
 
	gm_putMes§ge
;

403 
SecBy‹Block
 
	gm_buf
;

407 şas 
	cCRYPTOPP_DLL
 
	mSigÇtu»V”ifiÿtiÚF‹r
 : 
public
 
F‹rW™hBufã»dIÅut


409 
public
:

410 şas 
	cSigÇtu»V”ifiÿtiÚFaed
 : 
public
 
Exû±iÚ


412 
public
:

413 
SigÇtu»V”ifiÿtiÚFaed
()

414 : 
Exû±iÚ
(
DATA_INTEGRITY_CHECK_FAILED
, "VerifierFilter: digital signature‚ot valid") {}

417 
	eFÏgs
 {
	gSIGNATURE_AT_END
=0, 
	gSIGNATURE_AT_BEGIN
=1, 
	gPUT_MESSAGE
=2, 
	gPUT_SIGNATURE
=4, 
	gPUT_RESULT
=8, 
	gTHROW_EXCEPTION
=16, 
	gDEFAULT_FLAGS
 = 
SIGNATURE_AT_BEGIN
 | 
PUT_RESULT
};

418 
SigÇtu»V”ifiÿtiÚF‹r
(cÚ¡ 
PK_V”if›r
 &
v”if›r
, 
Bufã»dT¿nsfÜm©iÚ
 *
©chm’t
 = 
NULL
, 
wÜd32
 
æags
 = 
DEFAULT_FLAGS
);

420 
	g¡d
::
¡ršg
 
	$AlgÜ™hmName
(ècÚ¡ { 
m_v”if›r
.
	`AlgÜ™hmName
();
	}
}

422 
boŞ
 
	$G‘La¡ResuÉ
(ècÚ¡ { 
m_v”if›d
;
	}
}

424 
	g´Ùeùed
:

425 
In™ŸlizeD”ivedAndR‘uºNewSizes
(cÚ¡ 
NameV®uePaœs
 &
·¿m‘”s
, 
size_t
 &
fœ¡Size
, size_ˆ&
blockSize
, size_ˆ&
Ï¡Size
);

426 
Fœ¡Put
(cÚ¡ 
by‹
 *
šSŒšg
);

427 
NextPutMuÉË
(cÚ¡ 
by‹
 *
šSŒšg
, 
size_t
 
Ëngth
);

428 
La¡Put
(cÚ¡ 
by‹
 *
šSŒšg
, 
size_t
 
Ëngth
);

430 
	g´iv©e
:

431 cÚ¡ 
PK_V”if›r
 &
m_v”if›r
;

432 
	gmemb”_±r
<
	gPK_Mes§geAccumuÏtÜ
> 
	gm_mes§geAccumuÏtÜ
;

433 
wÜd32
 
	gm_æags
;

434 
SecBy‹Block
 
	gm_sigÇtu»
;

435 
boŞ
 
	gm_v”if›d
;

438 
SigÇtu»V”ifiÿtiÚF‹r
 
	tV”if›rF‹r
;

441 
şass
 
CRYPTOPP_DLL
 
	gRedœeùÜ
 : 
public
 
Cu¡omSigÇlPrİag©iÚ
<
Sšk
>

443 
public
:

444 
	eBehaviÜ


446 
DATA_ONLY
 = 0x00,

447 
	gPASS_SIGNALS
 = 0x01,

448 
	gPASS_WAIT_OBJECTS
 = 0x02,

449 
	gPASS_EVERYTHING
 = 
PASS_SIGNALS
 | 
PASS_WAIT_OBJECTS


452 
RedœeùÜ
(è: 
m_rg‘
(
NULL
), 
m_behaviÜ
(
PASS_EVERYTHING
) {}

453 
RedœeùÜ
(
Bufã»dT¿nsfÜm©iÚ
 &
rg‘
, 
BehaviÜ
 
behaviÜ
=
PASS_EVERYTHING
)

454 : 
m_rg‘
(&
rg‘
), 
m_behaviÜ
(
behaviÜ
) {}

456 
Redœeù
(
Bufã»dT¿nsfÜm©iÚ
 &
rg‘
è{
	gm_rg‘
 = &target;}

457 
StİRedœeùiÚ
(è{
	gm_rg‘
 = 
NULL
;}

459 
BehaviÜ
 
G‘BehaviÜ
(è{ (
	gBehaviÜ
è
	gm_behaviÜ
;}

460 
S‘BehaviÜ
(
BehaviÜ
 
behaviÜ
è{
	gm_behaviÜ
=behavior;}

461 
boŞ
 
G‘PassSigÇls
(ècÚ¡ { (
	gm_behaviÜ
 & 
	gPASS_SIGNALS
) != 0;}

462 
S‘PassSigÇls
(
boŞ
 
·ss
è{ ià(
	g·ss
è
	gm_behaviÜ
 |ğ
PASS_SIGNALS
; m_behaviÜ &ğ~(
wÜd32
) PASS_SIGNALS; }

463 
boŞ
 
G‘PassWa™Objeùs
(ècÚ¡ { (
	gm_behaviÜ
 & 
	gPASS_WAIT_OBJECTS
) != 0;}

464 
S‘PassWa™Objeùs
(
boŞ
 
·ss
è{ ià(
	g·ss
è
	gm_behaviÜ
 |ğ
PASS_WAIT_OBJECTS
; m_behaviÜ &ğ~(
wÜd32
) PASS_WAIT_OBJECTS; }

466 
boŞ
 
CªModifyIÅut
() const

467 { 
	gm_rg‘
 ? m_rg‘->
CªModifyIÅut
(è: 
çl£
;}

469 
In™Ÿlize
(cÚ¡ 
NameV®uePaœs
 &
·¿m‘”s
, 
´İag©iÚ
);

470 
by‹
 * 
C»©ePutS·û
(
size_t
 &
size
)

471 { 
	gm_rg‘
 ? m_rg‘->
C»©ePutS·û
(
size
è: (
by‹
 *)(size=0, 
	gNULL
);}

472 
size_t
 
Put2
(cÚ¡ 
by‹
 *
begš
, size_ˆ
Ëngth
, 
mes§geEnd
, 
boŞ
 
blockšg
)

473 { 
	gm_rg‘
 ? m_rg‘->
Put2
(
begš
, 
Ëngth
, 
G‘PassSigÇls
(è? 
mes§geEnd
 : 0, 
blockšg
) : 0;}

474 
boŞ
 
Flush
(boŞ 
h¬dFlush
, 
´İag©iÚ
=-1, boŞ 
blockšg
=
Œue
)

475 { 
m_rg‘
 && 
G‘PassSigÇls
(è? m_rg‘->
Flush
(
h¬dFlush
, 
´İag©iÚ
, 
blockšg
è: 
çl£
;}

476 
boŞ
 
Mes§geS”›sEnd
(
´İag©iÚ
=-1, boŞ 
blockšg
=
Œue
)

477 { 
m_rg‘
 && 
G‘PassSigÇls
(è? m_rg‘->
Mes§geS”›sEnd
(
´İag©iÚ
, 
blockšg
è: 
çl£
;}

479 
by‹
 * 
ChªÃlC»©ePutS·û
(cÚ¡ 
¡d
::
¡ršg
 &
chªÃl
, 
size_t
 &
size
)

480 { 
	gm_rg‘
 ? m_rg‘->
ChªÃlC»©ePutS·û
(
chªÃl
, 
size
è: (
by‹
 *)(size=0, 
	gNULL
);}

481 
size_t
 
ChªÃlPut2
(cÚ¡ 
¡d
::
¡ršg
 &
chªÃl
, cÚ¡ 
by‹
 *
begš
, size_ˆ
Ëngth
, 
mes§geEnd
, 
boŞ
 
blockšg
)

482 { 
	gm_rg‘
 ? m_rg‘->
ChªÃlPut2
(
chªÃl
, 
begš
, 
Ëngth
, 
G‘PassSigÇls
(è? 
mes§geEnd
 : 0, 
blockšg
) : 0;}

483 
size_t
 
ChªÃlPutModifŸbË2
(cÚ¡ 
¡d
::
¡ršg
 &
chªÃl
, 
by‹
 *
begš
, size_ˆ
Ëngth
, 
mes§geEnd
, 
boŞ
 
blockšg
)

484 { 
	gm_rg‘
 ? m_rg‘->
ChªÃlPutModifŸbË2
(
chªÃl
, 
begš
, 
Ëngth
, 
G‘PassSigÇls
(è? 
mes§geEnd
 : 0, 
blockšg
) : 0;}

485 
boŞ
 
ChªÃlFlush
(cÚ¡ 
¡d
::
¡ršg
 &
chªÃl
, boŞ 
com¶‘eFlush
, 
´İag©iÚ
=-1, boŞ 
blockšg
=
Œue
)

486 { 
m_rg‘
 && 
G‘PassSigÇls
(è? m_rg‘->
ChªÃlFlush
(
chªÃl
, 
com¶‘eFlush
, 
´İag©iÚ
, 
blockšg
è: 
çl£
;}

487 
boŞ
 
ChªÃlMes§geS”›sEnd
(cÚ¡ 
¡d
::
¡ršg
 &
chªÃl
, 
´İag©iÚ
=-1, boŞ 
blockšg
=
Œue
)

488 { 
m_rg‘
 && 
G‘PassSigÇls
(è? m_rg‘->
ChªÃlMes§geS”›sEnd
(
chªÃl
, 
´İag©iÚ
, 
blockšg
è: 
çl£
;}

490 
G‘MaxWa™ObjeùCouÁ
() const

491 {  
	gm_rg‘
 && 
G‘PassWa™Objeùs
(è? m_rg‘->
G‘MaxWa™ObjeùCouÁ
() : 0; }

492 
G‘Wa™Objeùs
(
Wa™ObjeùCÚš”
 &
cÚš”
, 
C®lSck
 cÚ¡& 
ÿÎSck
)

493 { ià(
	gm_rg‘
 && 
G‘PassWa™Objeùs
()èm_rg‘->
G‘Wa™Objeùs
(
cÚš”
, 
ÿÎSck
); }

495 
	g´iv©e
:

496 
Bufã»dT¿nsfÜm©iÚ
 *
m_rg‘
;

497 
wÜd32
 
	gm_behaviÜ
;

501 
şass
 
CRYPTOPP_DLL
 
	gOuutProxy
 : 
public
 
Cu¡omSigÇlPrİag©iÚ
<
Sšk
>

503 
public
:

504 
OuutProxy
(
Bufã»dT¿nsfÜm©iÚ
 &
owÃr
, 
boŞ
 
·ssSigÇl
è: 
m_owÃr
(owÃr), 
m_·ssSigÇl
(passSignal) {}

506 
boŞ
 
G‘PassSigÇl
(ècÚ¡ { 
	gm_·ssSigÇl
;}

507 
S‘PassSigÇl
(
boŞ
 
·ssSigÇl
è{
	gm_·ssSigÇl
 =…assSignal;}

509 
by‹
 * 
C»©ePutS·û
(
size_t
 &
size
)

510 { 
	gm_owÃr
.
A‰achedT¿nsfÜm©iÚ
()->
C»©ePutS·û
(
size
);}

511 
size_t
 
Put2
(cÚ¡ 
by‹
 *
begš
, size_ˆ
Ëngth
, 
mes§geEnd
, 
boŞ
 
blockšg
)

512 { 
	gm_owÃr
.
A‰achedT¿nsfÜm©iÚ
()->
Put2
(
begš
, 
Ëngth
, 
m_·ssSigÇl
 ? 
mes§geEnd
 : 0, 
blockšg
);}

513 
size_t
 
PutModifŸbË2
(
by‹
 *
begš
, size_ˆ
Ëngth
, 
mes§geEnd
, 
boŞ
 
blockšg
)

514 { 
	gm_owÃr
.
A‰achedT¿nsfÜm©iÚ
()->
PutModifŸbË2
(
begš
, 
Ëngth
, 
m_·ssSigÇl
 ? 
mes§geEnd
 : 0, 
blockšg
);}

515 
In™Ÿlize
(cÚ¡ 
NameV®uePaœs
 &
·¿m‘”s
=
g_nuÎNameV®uePaœs
, 
´İag©iÚ
=-1)

516 {ià(
m_·ssSigÇl
è
m_owÃr
.
A‰achedT¿nsfÜm©iÚ
()->
In™Ÿlize
(
·¿m‘”s
, 
´İag©iÚ
);}

517 
boŞ
 
Flush
(boŞ 
h¬dFlush
, 
´İag©iÚ
=-1, boŞ 
blockšg
=
Œue
)

518 { 
m_·ssSigÇl
 ? 
m_owÃr
.
A‰achedT¿nsfÜm©iÚ
()->
Flush
(
h¬dFlush
, 
´İag©iÚ
, 
blockšg
è: 
çl£
;}

519 
boŞ
 
Mes§geS”›sEnd
(
´İag©iÚ
=-1, boŞ 
blockšg
=
Œue
)

520 { 
m_·ssSigÇl
 ? 
m_owÃr
.
A‰achedT¿nsfÜm©iÚ
()->
Mes§geS”›sEnd
(
´İag©iÚ
, 
blockšg
è: 
çl£
;}

522 
by‹
 * 
ChªÃlC»©ePutS·û
(cÚ¡ 
¡d
::
¡ršg
 &
chªÃl
, 
size_t
 &
size
)

523 { 
	gm_owÃr
.
A‰achedT¿nsfÜm©iÚ
()->
ChªÃlC»©ePutS·û
(
chªÃl
, 
size
);}

524 
size_t
 
ChªÃlPut2
(cÚ¡ 
¡d
::
¡ršg
 &
chªÃl
, cÚ¡ 
by‹
 *
begš
, size_ˆ
Ëngth
, 
mes§geEnd
, 
boŞ
 
blockšg
)

525 { 
	gm_owÃr
.
A‰achedT¿nsfÜm©iÚ
()->
ChªÃlPut2
(
chªÃl
, 
begš
, 
Ëngth
, 
m_·ssSigÇl
 ? 
mes§geEnd
 : 0, 
blockšg
);}

526 
size_t
 
ChªÃlPutModifŸbË2
(cÚ¡ 
¡d
::
¡ršg
 &
chªÃl
, 
by‹
 *
begš
, size_ˆ
Ëngth
, 
mes§geEnd
, 
boŞ
 
blockšg
)

527 { 
	gm_owÃr
.
A‰achedT¿nsfÜm©iÚ
()->
ChªÃlPutModifŸbË2
(
chªÃl
, 
begš
, 
Ëngth
, 
m_·ssSigÇl
 ? 
mes§geEnd
 : 0, 
blockšg
);}

528 
boŞ
 
ChªÃlFlush
(cÚ¡ 
¡d
::
¡ršg
 &
chªÃl
, boŞ 
com¶‘eFlush
, 
´İag©iÚ
=-1, boŞ 
blockšg
=
Œue
)

529 { 
m_·ssSigÇl
 ? 
m_owÃr
.
A‰achedT¿nsfÜm©iÚ
()->
ChªÃlFlush
(
chªÃl
, 
com¶‘eFlush
, 
´İag©iÚ
, 
blockšg
è: 
çl£
;}

530 
boŞ
 
ChªÃlMes§geS”›sEnd
(cÚ¡ 
¡d
::
¡ršg
 &
chªÃl
, 
´İag©iÚ
=-1, boŞ 
blockšg
=
Œue
)

531 { 
m_·ssSigÇl
 ? 
m_owÃr
.
A‰achedT¿nsfÜm©iÚ
()->
ChªÃlMes§geS”›sEnd
(
chªÃl
, 
´İag©iÚ
, 
blockšg
è: 
çl£
;}

533 
	g´iv©e
:

534 
Bufã»dT¿nsfÜm©iÚ
 &
m_owÃr
;

535 
boŞ
 
	gm_·ssSigÇl
;

539 şas 
	cCRYPTOPP_DLL
 
	mProxyF‹r
 : 
public
 
F‹rW™hBufã»dIÅut


541 
public
:

542 
ProxyF‹r
(
Bufã»dT¿nsfÜm©iÚ
 *
f‹r
, 
size_t
 
fœ¡Size
, size_ˆ
Ï¡Size
, Bufã»dT¿nsfÜm©iÚ *
©chm’t
);

544 
boŞ
 
IsŞ©edFlush
(boŞ 
h¬dFlush
, boŞ 
blockšg
);

546 
S‘F‹r
(
F‹r
 *
f‹r
);

547 
NextPutMuÉË
(cÚ¡ 
by‹
 *
s
, 
size_t
 
Ën
);

548 
NextPutModifŸbË
(
by‹
 *
šSŒšg
, 
size_t
 
Ëngth
);

550 
	m´Ùeùed
:

551 
memb”_±r
<
Bufã»dT¿nsfÜm©iÚ
> 
m_f‹r
;

555 şas 
	cCRYPTOPP_DLL
 
	mSim¶eProxyF‹r
 : 
public
 
ProxyF‹r


557 
public
:

558 
	$Sim¶eProxyF‹r
(
Bufã»dT¿nsfÜm©iÚ
 *
f‹r
, Bufã»dT¿nsfÜm©iÚ *
©chm’t
)

559 : 
	$ProxyF‹r
(
f‹r
, 0, 0, 
©chm’t
) {}

561 
	$Fœ¡Put
(cÚ¡ 
by‹
 *è{
	}
}

562 
	$La¡Put
(cÚ¡ 
by‹
 *, 
size_t
è{
m_f‹r
->
	`Mes§geEnd
();
	}
}

567 şas 
	cCRYPTOPP_DLL
 
	mPK_Enüy±ÜF‹r
 : 
public
 
Sim¶eProxyF‹r


569 
public
:

570 
	$PK_Enüy±ÜF‹r
(
RªdomNumb”G’”©Ü
 &
ºg
, cÚ¡ 
PK_Enüy±Ü
 &
’üy±Ü
, 
Bufã»dT¿nsfÜm©iÚ
 *
©chm’t
 = 
NULL
)

571 : 
	`Sim¶eProxyF‹r
(
’üy±Ü
.
	`C»©eEnüy±iÚF‹r
(
ºg
), 
©chm’t
) {}

572 
	}
};

576 şas 
	cCRYPTOPP_DLL
 
	mPK_Deüy±ÜF‹r
 : 
public
 
Sim¶eProxyF‹r


578 
public
:

579 
	$PK_Deüy±ÜF‹r
(
RªdomNumb”G’”©Ü
 &
ºg
, cÚ¡ 
PK_Deüy±Ü
 &
deüy±Ü
, 
Bufã»dT¿nsfÜm©iÚ
 *
©chm’t
 = 
NULL
)

580 : 
	`Sim¶eProxyF‹r
(
deüy±Ü
.
	`C»©eDeüy±iÚF‹r
(
ºg
), 
©chm’t
) {}

581 
	}
};

584 
	g‹m¶©e
 <
şass
 
	gT
>

585 
şass
 
	gSŒšgSškTem¶©e
 : 
public
 
Bufã¾ess
<
Sšk
>

587 
public
:

589 
ty³Çme
 
	tT
::
	tŒa™s_ty³
::
	tch¬_ty³
 char_type;

591 
SŒšgSškTem¶©e
(
T
 &
ouut
)

592 : 
m_ouut
(&
ouut
è{
as£¹
((output[0])==1);}

594 
IsŞ©edIn™Ÿlize
(cÚ¡ 
NameV®uePaœs
 &
·¿m‘”s
)

595 {ià(!
	g·¿m‘”s
.
G‘V®ue
("OuutSŒšgPoš‹r", 
m_ouut
)è
throw
 
Inv®idArgum’t
("StringSink: OutputStringPointer‚ot specified");}

597 
size_t
 
Put2
(cÚ¡ 
by‹
 *
begš
, size_ˆ
Ëngth
, 
mes§geEnd
, 
boŞ
 
blockšg
)

599 ià(
	gËngth
 > 0)

601 
ty³Çme
 
	gT
::
size_ty³
 
size
 = 
m_ouut
->size();

602 ià(
	gËngth
 < 
	gsize
 && siz+†’gth > 
	gm_ouut
->
ÿ·c™y
())

603 
	gm_ouut
->
»£rve
(2*
size
);

604 
	gm_ouut
->
­³nd
((cÚ¡ 
ch¬_ty³
 *)
begš
, (cÚ¡ ch¬_ty³ *)begš+
Ëngth
);

609 
	g´iv©e
:

610 
T
 *
m_ouut
;

614 
CRYPTOPP_DLL_TEMPLATE_CLASS
 
	gSŒšgSškTem¶©e
<
	g¡d
::
¡ršg
>;

615 
	gSŒšgSškTem¶©e
<
	t¡d
::
	t¡ršg
> 
	tSŒšgSšk
;

618 
şass
 
	gRªdomNumb”Sšk
 : 
public
 
Bufã¾ess
<
Sšk
>

620 
public
:

621 
RªdomNumb”Sšk
()

622 : 
m_ºg
(
NULL
) {}

624 
RªdomNumb”Sšk
(
RªdomNumb”G’”©Ü
 &
ºg
)

625 : 
m_ºg
(&
ºg
) {}

627 
IsŞ©edIn™Ÿlize
(cÚ¡ 
NameV®uePaœs
 &
·¿m‘”s
);

628 
size_t
 
Put2
(cÚ¡ 
by‹
 *
begš
, size_ˆ
Ëngth
, 
mes§geEnd
, 
boŞ
 
blockšg
);

630 
	g´iv©e
:

631 
RªdomNumb”G’”©Ü
 *
m_ºg
;

635 
şass
 
CRYPTOPP_DLL
 
	gA¼aySšk
 : 
public
 
Bufã¾ess
<
Sšk
>

637 
public
:

638 
A¼aySšk
(cÚ¡ 
NameV®uePaœs
 &
·¿m‘”s
 = 
g_nuÎNameV®uePaœs
è{
IsŞ©edIn™Ÿlize
(parameters);}

639 
A¼aySšk
(
by‹
 *
buf
, 
size_t
 
size
è: 
m_buf
(buf), 
m_size
(size), 
m_tÙ®
(0) {}

641 
size_t
 
AvaabËSize
(è{ 
S©u¿tšgSubŒaù
(
m_size
, 
m_tÙ®
);}

642 
lwÜd
 
TÙ®PutL’gth
(è{ 
	gm_tÙ®
;}

644 
IsŞ©edIn™Ÿlize
(cÚ¡ 
NameV®uePaœs
 &
·¿m‘”s
);

645 
by‹
 * 
C»©ePutS·û
(
size_t
 &
size
);

646 
size_t
 
Put2
(cÚ¡ 
by‹
 *
begš
, size_ˆ
Ëngth
, 
mes§geEnd
, 
boŞ
 
blockšg
);

648 
	g´Ùeùed
:

649 
by‹
 *
m_buf
;

650 
size_t
 
	gm_size
;

651 
lwÜd
 
	gm_tÙ®
;

655 şas 
	cCRYPTOPP_DLL
 
	mA¼ayXÜSšk
 : 
public
 
A¼aySšk


657 
public
:

658 
	$A¼ayXÜSšk
(
by‹
 *
buf
, 
size_t
 
size
)

659 : 
	$A¼aySšk
(
buf
, 
size
) {}

661 
size_t
 
	`Put2
(cÚ¡ 
by‹
 *
begš
, size_ˆ
Ëngth
, 
mes§geEnd
, 
boŞ
 
blockšg
);

662 
by‹
 * 
	$C»©ePutS·û
(
size_t
 &
size
è{ 
Bufã»dT¿nsfÜm©iÚ
::
	`C»©ePutS·û
(size);
	}
}

666 şas 
	cSŒšgStÜe
 : 
public
 
StÜe


668 
public
:

669 
	$SŒšgStÜe
(cÚ¡ *
¡ršg
 = 
NULL
)

670 {
	`StÜeIn™Ÿlize
(
	`MakeP¬am‘”s
("IÅutBufãr", 
	`CÚ¡By‹A¼ayP¬am‘”
(
¡ršg
)));}

671 
	$SŒšgStÜe
(cÚ¡ 
by‹
 *
¡ršg
, 
size_t
 
Ëngth
)

672 {
	`StÜeIn™Ÿlize
(
	`MakeP¬am‘”s
("IÅutBufãr", 
	`CÚ¡By‹A¼ayP¬am‘”
(
¡ršg
, 
Ëngth
)));
	}
}

673 
	g‹m¶©e
 <
şass
 
	gT
> 
	$SŒšgStÜe
(cÚ¡ 
T
 &
¡ršg
)

674 {
	`StÜeIn™Ÿlize
(
	`MakeP¬am‘”s
("IÅutBufãr", 
	`CÚ¡By‹A¼ayP¬am‘”
(
¡ršg
)));
	}
}

676 
CRYPTOPP_DLL
 
size_t
 
T¿nsãrTo2
(
Bufã»dT¿nsfÜm©iÚ
 &
rg‘
, 
lwÜd
 &
ŒªsãrBy‹s
, cÚ¡ 
¡d
::
¡ršg
 &
chªÃl
=
DEFAULT_CHANNEL
, 
boŞ
 
blockšg
=
Œue
);

677 
CRYPTOPP_DLL
 
size_t
 
	$CİyRªgeTo2
(
Bufã»dT¿nsfÜm©iÚ
 &
rg‘
, 
lwÜd
 &
begš
,†wÜd 
’d
=
LWORD_MAX
, cÚ¡ 
¡d
::
¡ršg
 &
chªÃl
=
DEFAULT_CHANNEL
, 
boŞ
 
blockšg
=
Œue
) const;

679 
´iv©e
:

680 
CRYPTOPP_DLL
 
	`StÜeIn™Ÿlize
(cÚ¡ 
NameV®uePaœs
 &
·¿m‘”s
);

682 cÚ¡ 
by‹
 *
m_¡Üe
;

683 
size_t
 
m_Ëngth
, 
m_couÁ
;

684 
	}
};

687 şas 
	cCRYPTOPP_DLL
 
	mRªdomNumb”StÜe
 : 
public
 
StÜe


689 
public
:

690 
	$RªdomNumb”StÜe
()

691 : 
	`m_ºg
(
NULL
), 
	`m_Ëngth
(0), 
	$m_couÁ
(0) {}

693 
	$RªdomNumb”StÜe
(
RªdomNumb”G’”©Ü
 &
ºg
, 
lwÜd
 
Ëngth
)

694 : 
	`m_ºg
(&
ºg
), 
	`m_Ëngth
(
Ëngth
), 
	$m_couÁ
(0è{
	}
}

696 
boŞ
 
	$AnyR‘r›vabË
(ècÚ¡ { 
	`MaxR‘r›vabË
(è!ğ0;
	}
}

697 
lwÜd
 
	$MaxR‘r›vabË
(ècÚ¡ { 
m_Ëngth
-
m_couÁ
;
	}
}

699 
size_t
 
T¿nsãrTo2
(
Bufã»dT¿nsfÜm©iÚ
 &
rg‘
, 
lwÜd
 &
ŒªsãrBy‹s
, cÚ¡ 
¡d
::
¡ršg
 &
chªÃl
=
DEFAULT_CHANNEL
, 
boŞ
 
blockšg
=
Œue
);

700 
size_t
 
	$CİyRªgeTo2
(
Bufã»dT¿nsfÜm©iÚ
 &
rg‘
, 
lwÜd
 &
begš
,†wÜd 
’d
=
LWORD_MAX
, cÚ¡ 
¡d
::
¡ršg
 &
chªÃl
=
DEFAULT_CHANNEL
, 
boŞ
 
blockšg
=
Œue
) const

702 
throw
 
	`NÙIm¶em’‹d
("RandomNumberStore: CopyRangeTo2() is‚ot supported byhis store");

703 
	}
}

705 
	g´iv©e
:

706 
StÜeIn™Ÿlize
(cÚ¡ 
NameV®uePaœs
 &
·¿m‘”s
);

708 
RªdomNumb”G’”©Ü
 *
	gm_ºg
;

709 
lwÜd
 
	gm_Ëngth
, 
	gm_couÁ
;

713 şas 
	cCRYPTOPP_DLL
 
	mNuÎStÜe
 : 
public
 
StÜe


715 
public
:

716 
	$NuÎStÜe
(
lwÜd
 
size
 = 
ULONG_MAX
è: 
	$m_size
(
size
) {}

717 
	$StÜeIn™Ÿlize
(cÚ¡ 
NameV®uePaœs
 &
·¿m‘”s
è{
	}
}

718 
lwÜd
 
	$MaxR‘r›vabË
(ècÚ¡ { 
m_size
;
	}
}

719 
size_t
 
T¿nsãrTo2
(
Bufã»dT¿nsfÜm©iÚ
 &
rg‘
, 
lwÜd
 &
ŒªsãrBy‹s
, cÚ¡ 
¡d
::
¡ršg
 &
chªÃl
=
DEFAULT_CHANNEL
, 
boŞ
 
blockšg
=
Œue
);

720 
size_t
 
	$CİyRªgeTo2
(
Bufã»dT¿nsfÜm©iÚ
 &
rg‘
, 
lwÜd
 &
begš
,†wÜd 
’d
=
LWORD_MAX
, cÚ¡ 
¡d
::
¡ršg
 &
chªÃl
=
DEFAULT_CHANNEL
, 
boŞ
 
blockšg
=
Œue
) const;

722 
´iv©e
:

723 
lwÜd
 
m_size
;

724 
	}
};

727 
şass
 
CRYPTOPP_DLL
 
CRYPTOPP_NO_VTABLE
 
	gSourû
 : 
public
 
IÅutRejeùšg
<
F‹r
>

729 
public
:

730 
Sourû
(
Bufã»dT¿nsfÜm©iÚ
 *
©chm’t
 = 
NULL
)

731 {
Sourû
::
D‘ach
(
©chm’t
);}

733 
lwÜd
 
Pump
ÖwÜd 
pumpMax
=
size_t
(0)-1)

734 {
Pump2
(
pumpMax
);  
	gpumpMax
;}

735 
PumpMes§ges
(
couÁ
=
UINT_MAX
)

736 {
PumpMes§ges2
(
couÁ
);  
	gcouÁ
;}

737 
PumpAÎ
()

738 {
PumpAÎ2
();}

739 
vœtu®
 
size_t
 
Pump2
(
lwÜd
 &
by‹CouÁ
, 
boŞ
 
blockšg
=
Œue
) =0;

740 
vœtu®
 
size_t
 
PumpMes§ges2
(&
mes§geCouÁ
, 
boŞ
 
blockšg
=
Œue
) =0;

741 
vœtu®
 
size_t
 
PumpAÎ2
(
boŞ
 
blockšg
=
Œue
);

742 
vœtu®
 
boŞ
 
SourûExhau¡ed
() const =0;

744 
	g´Ùeùed
:

745 
SourûIn™Ÿlize
(
boŞ
 
pumpAÎ
, cÚ¡ 
NameV®uePaœs
 &
·¿m‘”s
)

747 
IsŞ©edIn™Ÿlize
(
·¿m‘”s
);

748 ià(
	gpumpAÎ
)

749 
PumpAÎ
();

754 
	g‹m¶©e
 <
şass
 
	gT
>

755 şas 
	cSourûTem¶©e
 : 
public
 
Sourû


757 
public
:

758 
SourûTem¶©e
<
T
>(
Bufã»dT¿nsfÜm©iÚ
 *
©chm’t
)

759 : 
	$Sourû
(
©chm’t
) {}

760 
	$IsŞ©edIn™Ÿlize
(cÚ¡ 
NameV®uePaœs
 &
·¿m‘”s
)

761 {
m_¡Üe
.
	`IsŞ©edIn™Ÿlize
(
·¿m‘”s
);
	}
}

762 
size_t
 
	$Pump2
(
lwÜd
 &
by‹CouÁ
, 
boŞ
 
blockšg
=
Œue
)

763 { 
m_¡Üe
.
	`T¿nsãrTo2
(*
	`A‰achedT¿nsfÜm©iÚ
(), 
by‹CouÁ
, 
DEFAULT_CHANNEL
, 
blockšg
);
	}
}

764 
size_t
 
	$PumpMes§ges2
(&
mes§geCouÁ
, 
boŞ
 
blockšg
=
Œue
)

765 { 
m_¡Üe
.
	`T¿nsãrMes§gesTo2
(*
	`A‰achedT¿nsfÜm©iÚ
(), 
mes§geCouÁ
, 
DEFAULT_CHANNEL
, 
blockšg
);
	}
}

766 
size_t
 
	$PumpAÎ2
(
boŞ
 
blockšg
=
Œue
)

767 { 
m_¡Üe
.
	`T¿nsãrAÎTo2
(*
	`A‰achedT¿nsfÜm©iÚ
(), 
DEFAULT_CHANNEL
, 
blockšg
);
	}
}

768 
boŞ
 
	$SourûExhau¡ed
() const

769 { !
m_¡Üe
.
	`AnyR‘r›vabË
(è&& !m_¡Üe.
	`AnyMes§ges
();
	}
}

770 
	$S‘AutoSigÇlPrİag©iÚ
(
´İag©iÚ
)

771 {
m_¡Üe
.
	`S‘AutoSigÇlPrİag©iÚ
(
´İag©iÚ
);
	}
}

772 
	$G‘AutoSigÇlPrİag©iÚ
() const

773 { 
m_¡Üe
.
	`G‘AutoSigÇlPrİag©iÚ
();
	}
}

775 
	g´Ùeùed
:

776 
T
 
m_¡Üe
;

780 
şass
 
CRYPTOPP_DLL
 
	gSŒšgSourû
 : 
public
 
SourûTem¶©e
<
SŒšgStÜe
>

782 
public
:

783 
SŒšgSourû
(
Bufã»dT¿nsfÜm©iÚ
 *
©chm’t
 = 
NULL
)

784 : 
SourûTem¶©e
<
SŒšgStÜe
>(
©chm’t
) {}

786 
SŒšgSourû
(cÚ¡ *
¡ršg
, 
boŞ
 
pumpAÎ
, 
Bufã»dT¿nsfÜm©iÚ
 *
©chm’t
 = 
NULL
)

787 : 
SourûTem¶©e
<
SŒšgStÜe
>(
©chm’t
è{
SourûIn™Ÿlize
(
pumpAÎ
, 
MakeP¬am‘”s
("IÅutBufãr", 
CÚ¡By‹A¼ayP¬am‘”
(
¡ršg
)));}

789 
SŒšgSourû
(cÚ¡ 
by‹
 *
¡ršg
, 
size_t
 
Ëngth
, 
boŞ
 
pumpAÎ
, 
Bufã»dT¿nsfÜm©iÚ
 *
©chm’t
 = 
NULL
)

790 : 
SourûTem¶©e
<
SŒšgStÜe
>(
©chm’t
è{
SourûIn™Ÿlize
(
pumpAÎ
, 
MakeP¬am‘”s
("IÅutBufãr", 
CÚ¡By‹A¼ayP¬am‘”
(
¡ršg
, 
Ëngth
)));}

792 
SŒšgSourû
(cÚ¡ 
¡d
::
¡ršg
 &¡ršg, 
boŞ
 
pumpAÎ
, 
Bufã»dT¿nsfÜm©iÚ
 *
©chm’t
 = 
NULL
)

793 : 
SourûTem¶©e
<
SŒšgStÜe
>(
©chm’t
è{
SourûIn™Ÿlize
(
pumpAÎ
, 
MakeP¬am‘”s
("IÅutBufãr", 
CÚ¡By‹A¼ayP¬am‘”
(
¡ršg
)));}

797 
SŒšgSourû
 
	tA¼aySourû
;

800 
şass
 
CRYPTOPP_DLL
 
	gRªdomNumb”Sourû
 : 
public
 
SourûTem¶©e
<
RªdomNumb”StÜe
>

802 
public
:

803 
RªdomNumb”Sourû
(
RªdomNumb”G’”©Ü
 &
ºg
, 
Ëngth
, 
boŞ
 
pumpAÎ
, 
Bufã»dT¿nsfÜm©iÚ
 *
©chm’t
 = 
NULL
)

804 : 
SourûTem¶©e
<
RªdomNumb”StÜe
>(
©chm’t
)

805 {
SourûIn™Ÿlize
(
pumpAÎ
, 
MakeP¬am‘”s
("RªdomNumb”G’”©ÜPoš‹r", &
ºg
)("RªdomNumb”StÜeSize", 
Ëngth
));}

808 
	gNAMESPACE_END


	@fips140.cpp

3 
	~"pch.h
"

5 #iâdeà
CRYPTOPP_IMPORTS


7 
	~"fs140.h
"

8 
	~"Œdloÿl.h
"

10 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

14 #iâdeà
CRYPTOPP_ENABLE_COMPLIANCE_WITH_FIPS_140_2


15 
	#CRYPTOPP_ENABLE_COMPLIANCE_WITH_FIPS_140_2
 0

	)

18 #ià(
CRYPTOPP_ENABLE_COMPLIANCE_WITH_FIPS_140_2
 && !
	`defšed
(
THREADS_AVAILABLE
))

19 #”rÜ 
FIPS
 140-2 
com¶Ÿnû
 
»quœes
 
the
 
avaab™y
 
of
 
th»ad
 
loÿl
 
¡Üage
.

22 #ià(
CRYPTOPP_ENABLE_COMPLIANCE_WITH_FIPS_140_2
 && !
	`defšed
(
OS_RNG_AVAILABLE
))

23 #”rÜ 
FIPS
 140-2 
com¶Ÿnû
 
»quœes
 
the
 
avaab™y
 
of
 
OS
 
´ovided
 
RNG
.

26 
Pow”UpS–fTe¡Stus
 
g_pow”UpS–fTe¡Stus
 = 
POWER_UP_SELF_TEST_NOT_DONE
;

28 
boŞ
 
	$FIPS_140_2_Com¶ŸnûEÇbËd
()

30  
CRYPTOPP_ENABLE_COMPLIANCE_WITH_FIPS_140_2
;

31 
	}
}

33 
	$SimuÏ‹Pow”UpS–fTe¡Fau»
()

35 
g_pow”UpS–fTe¡Stus
 = 
POWER_UP_SELF_TEST_FAILED
;

36 
	}
}

38 
Pow”UpS–fTe¡Stus
 
CRYPTOPP_API
 
	$G‘Pow”UpS–fTe¡Stus
()

40  
g_pow”UpS–fTe¡Stus
;

41 
	}
}

43 #ià
CRYPTOPP_ENABLE_COMPLIANCE_WITH_FIPS_140_2


44 
	gTh»adLoÿlStÜage
 & 
	$AcûssPow”UpS–fTe¡InProg»ss
()

46 
Th»adLoÿlStÜage
 
£lfTe¡InProg»ss
;

47  
£lfTe¡InProg»ss
;

48 
	}
}

51 
boŞ
 
	$Pow”UpS–fTe¡InProg»ssOnThisTh»ad
()

53 #ià
CRYPTOPP_ENABLE_COMPLIANCE_WITH_FIPS_140_2


54  
	`AcûssPow”UpS–fTe¡InProg»ss
().
	`G‘V®ue
(è!ğ
NULL
;

56 
	`as£¹
(
çl£
);

57  
çl£
;

59 
	}
}

61 
	$S‘Pow”UpS–fTe¡InProg»ssOnThisTh»ad
(
boŞ
 
šProg»ss
)

63 #ià
CRYPTOPP_ENABLE_COMPLIANCE_WITH_FIPS_140_2


64 
	`AcûssPow”UpS–fTe¡InProg»ss
().
	`S‘V®ue
((*)
šProg»ss
);

66 
	}
}

68 
	$Enüy±iÚPaœwi£CÚsi¡’cyTe¡_FIPS_140_OÆy
(cÚ¡ 
PK_Enüy±Ü
 &
’üy±Ü
, cÚ¡ 
PK_Deüy±Ü
 &
deüy±Ü
)

70 #ià
CRYPTOPP_ENABLE_COMPLIANCE_WITH_FIPS_140_2


71 
	`Enüy±iÚPaœwi£CÚsi¡’cyTe¡
(
’üy±Ü
, 
deüy±Ü
);

73 
	}
}

75 
	$SigÇtu»Paœwi£CÚsi¡’cyTe¡_FIPS_140_OÆy
(cÚ¡ 
PK_SigÃr
 &
sigÃr
, cÚ¡ 
PK_V”if›r
 &
v”if›r
)

77 #ià
CRYPTOPP_ENABLE_COMPLIANCE_WITH_FIPS_140_2


78 
	`SigÇtu»Paœwi£CÚsi¡’cyTe¡
(
sigÃr
, 
v”if›r
);

80 
	}
}

82 
	gNAMESPACE_END


	@fips140.h

1 #iâdeà
CRYPTOPP_FIPS140_H


2 
	#CRYPTOPP_FIPS140_H


	)

8 
	~"üy±lib.h
"

9 
	~"£cblock.h
"

11 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

14 şas 
	cCRYPTOPP_DLL
 
S–fTe¡Fau»
 : 
public
 
Exû±iÚ


16 
public
:

17 
ex¶ic™
 
	$S–fTe¡Fau»
(cÚ¡ 
¡d
::
¡ršg
 &
s
è: 
	$Exû±iÚ
(
OTHER_ERROR
, 
s
) {}

18 
	}
};

21 
CRYPTOPP_DLL
 
boŞ
 
CRYPTOPP_API
 
FIPS_140_2_Com¶ŸnûEÇbËd
();

24 
	ePow”UpS–fTe¡Stus
 {
	mPOWER_UP_SELF_TEST_NOT_DONE
, 
	mPOWER_UP_SELF_TEST_FAILED
, 
	mPOWER_UP_SELF_TEST_PASSED
};

27 
CRYPTOPP_DLL
 
CRYPTOPP_API
 
DoPow”UpS–fTe¡
(cÚ¡ *
moduËF’ame
, cÚ¡ 
by‹
 *
ex³ùedModuËMac
);

30 
CRYPTOPP_DLL
 
CRYPTOPP_API
 
DoDÎPow”UpS–fTe¡
();

33 
CRYPTOPP_DLL
 
CRYPTOPP_API
 
SimuÏ‹Pow”UpS–fTe¡Fau»
();

36 
CRYPTOPP_DLL
 
Pow”UpS–fTe¡Stus
 
CRYPTOPP_API
 
G‘Pow”UpS–fTe¡Stus
();

38 
Pow”UpS–fTe¡Stus
 (
	tCRYPTOPP_API
 * 
	tPG‘Pow”UpS–fTe¡Stus
)();

40 
CRYPTOPP_DLL
 
Mes§geAuth’tiÿtiÚCode
 * 
CRYPTOPP_API
 
NewIÁegr™yCheckšgMAC
();

42 
CRYPTOPP_DLL
 
boŞ
 
CRYPTOPP_API
 
IÁegr™yCheckModuË
(cÚ¡ *
moduËF’ame
, cÚ¡ 
by‹
 *
ex³ùedModuËMac
, 
SecBy‹Block
 *
pAùu®Mac
 = 
NULL
, *
pMacFeLoÿtiÚ
 = NULL);

45 
boŞ
 
Pow”UpS–fTe¡InProg»ssOnThisTh»ad
();

47 
S‘Pow”UpS–fTe¡InProg»ssOnThisTh»ad
(
boŞ
 
šProg»ss
);

49 
SigÇtu»Paœwi£CÚsi¡’cyTe¡
(cÚ¡ 
PK_SigÃr
 &
sigÃr
, cÚ¡ 
PK_V”if›r
 &
v”if›r
);

50 
Enüy±iÚPaœwi£CÚsi¡’cyTe¡
(cÚ¡ 
PK_Enüy±Ü
 &
’üy±Ü
, cÚ¡ 
PK_Deüy±Ü
 &
deüy±Ü
);

52 
SigÇtu»Paœwi£CÚsi¡’cyTe¡_FIPS_140_OÆy
(cÚ¡ 
PK_SigÃr
 &
sigÃr
, cÚ¡ 
PK_V”if›r
 &
v”if›r
);

53 
Enüy±iÚPaœwi£CÚsi¡’cyTe¡_FIPS_140_OÆy
(cÚ¡ 
PK_Enüy±Ü
 &
’üy±Ü
, cÚ¡ 
PK_Deüy±Ü
 &
deüy±Ü
);

55 
	#CRYPTOPP_DUMMY_DLL_MAC
 "MAC_51f34b8db820«8"

	)

57 
	gNAMESPACE_END


	@fipsalgt.cpp

7 #iâdeà
CRYPTOPP_IMPORTS


8 
	#CRYPTOPP_DEFAULT_NO_DLL


	)

10 
	~"dÎ.h
"

11 
	~"oids.h
"

13 
	$USING_NAMESPACE
(
Cry±oPP
)

14 
	$USING_NAMESPACE
(
¡d
)

16 
şass
 
LšeB»akP¬£r
 : 
public
 
AutoSigÇlšg
<
Bufã¾ess
<
F‹r
> >

18 
public
:

19 
	`LšeB»akP¬£r
(
Bufã»dT¿nsfÜm©iÚ
 *
©chm’t
=
NULL
, 
by‹
 
lšeEnd
='\n')

20 : 
	`m_lšeEnd
(
lšeEnd
è{
	`D‘ach
(
©chm’t
);}

22 
size_t
 
	`Put2
(cÚ¡ 
by‹
 *
begš
, size_ˆ
Ëngth
, 
mes§geEnd
, 
boŞ
 
blockšg
)

24 ià(!
blockšg
)

25 
throw
 
	`BlockšgIÅutOÆy
("LineBreakParser");

27 
i
, 
Ï¡
 = 0;

28 
i
=0; i<
Ëngth
; i++)

30 ià(
begš
[
i
] =ğ
m_lšeEnd
)

32 
	`A‰achedT¿nsfÜm©iÚ
()->
	`Put2
(
begš
+
Ï¡
, 
i
-Ï¡, 
	`G‘AutoSigÇlPrİag©iÚ
(), 
blockšg
);

33 
Ï¡
 = 
i
+1;

36 ià(
Ï¡
 !ğ
i
)

37 
	`A‰achedT¿nsfÜm©iÚ
()->
	`Put2
(
begš
+
Ï¡
, 
i
-Ï¡, 0, 
blockšg
);

39 ià(
mes§geEnd
 && 
	`G‘AutoSigÇlPrİag©iÚ
())

41 
	`A‰achedT¿nsfÜm©iÚ
()->
	`Mes§geEnd
(
	`G‘AutoSigÇlPrİag©iÚ
()-1, 
blockšg
);

42 
	`A‰achedT¿nsfÜm©iÚ
()->
	`Mes§geS”›sEnd
(
	`G‘AutoSigÇlPrİag©iÚ
()-1, 
blockšg
);

48 
´iv©e
:

49 
by‹
 
m_lšeEnd
;

50 
	}
};

52 
şass
 
	gTe¡D©aP¬£r
 : 
public
 
UnæushabË
<
F‹rW™hIÅutQueue
>

54 
public
:

55 
	eD©aTy³
 {
OTHER
, 
	gCOUNT
, 
	gKEY_T
, 
	gIV
, 
	gINPUT
, 
	gOUTPUT
};

57 
Te¡D©aP¬£r
(
¡d
::
¡ršg
 
®gÜ™hm
, std::¡ršg 
‹¡
, std::¡ršg 
mode
, 
ãedbackSize
, 
boŞ
 
’üy±
, 
Bufã»dT¿nsfÜm©iÚ
 *
©chm’t
)

58 : 
m_®gÜ™hm
(
®gÜ™hm
), 
m_‹¡
(
‹¡
), 
m_mode
(
mode
), 
m_ãedbackSize
(
ãedbackSize
)

59 , 
m_fœ¡Lše
(
Œue
), 
m_bÏnkLšeT¿ns™iÚ
(0)

61 
D‘ach
(
©chm’t
);

63 
	gm_ty³ToName
[
COUNT
] = "COUNT";

65 
	gm_ÇmeToTy³
["COUNT"] = 
COUNT
;

66 
	gm_ÇmeToTy³
["KEY"] = 
KEY_T
;

67 
	gm_ÇmeToTy³
["KEYs"] = 
KEY_T
;

68 
	gm_ÇmeToTy³
["key"] = 
KEY_T
;

69 
	gm_ÇmeToTy³
["Key"] = 
KEY_T
;

70 
	gm_ÇmeToTy³
["IV"] = 
IV
;

71 
	gm_ÇmeToTy³
["IV1"] = 
IV
;

72 
	gm_ÇmeToTy³
["CV"] = 
IV
;

73 
	gm_ÇmeToTy³
["CV1"] = 
IV
;

74 
	gm_ÇmeToTy³
["IB"] = 
IV
;

75 
	gm_ÇmeToTy³
["TEXT"] = 
INPUT
;

76 
	gm_ÇmeToTy³
["RESULT"] = 
OUTPUT
;

77 
	gm_ÇmeToTy³
["Msg"] = 
INPUT
;

78 
	gm_ÇmeToTy³
["S“d"] = 
INPUT
;

79 
	gm_ÇmeToTy³
["V"] = 
INPUT
;

80 
	gm_ÇmeToTy³
["DT"] = 
IV
;

81 
S‘Enüy±
(
’üy±
);

83 ià(
	gm_®gÜ™hm
 =ğ"DSA" || 
m_®gÜ™hm
 == "ECDSA")

85 ià(
m_‹¡
 == "PKV")

86 
m_Œigg”
 = "Qy";

87 ià(
	gm_‹¡
 == "KeyPair")

88 
m_Œigg”
 = "N";

89 ià(
	gm_‹¡
 == "SigGen")

90 
m_Œigg”
 = "Msg";

91 ià(
	gm_‹¡
 == "SigVer")

92 
m_Œigg”
 = "S";

93 ià(
	gm_‹¡
 == "PQGGen")

94 
m_Œigg”
 = "N";

95 ià(
	gm_‹¡
 == "PQGVer")

96 
m_Œigg”
 = "H";

98 ià(
	gm_®gÜ™hm
 == "HMAC")

99 
m_Œigg”
 = "Msg";

100 ià(
	gm_®gÜ™hm
 == "SHA")

101 
m_Œigg”
 = (
m_‹¡
 == "MONTE") ? "Seed" : "Msg";

102 ià(
	gm_®gÜ™hm
 == "RNG")

103 
m_Œigg”
 = "V";

104 ià(
	gm_®gÜ™hm
 == "RSA")

105 
m_Œigg”
 = (
m_‹¡
 == "Ver") ? "S" : "Msg";

108 
S‘Enüy±
(
boŞ
 
’üy±
)

110 
	gm_’üy±
 = 
’üy±
;

111 ià(
	g’üy±
)

113 
	gm_ÇmeToTy³
["PLAINTEXT"] = 
INPUT
;

114 
	gm_ÇmeToTy³
["CIPHERTEXT"] = 
OUTPUT
;

115 
	gm_ÇmeToTy³
["PT"] = 
INPUT
;

116 
	gm_ÇmeToTy³
["CT"] = 
OUTPUT
;

120 
	gm_ÇmeToTy³
["PLAINTEXT"] = 
OUTPUT
;

121 
	gm_ÇmeToTy³
["CIPHERTEXT"] = 
INPUT
;

122 
	gm_ÇmeToTy³
["PT"] = 
OUTPUT
;

123 
	gm_ÇmeToTy³
["CT"] = 
INPUT
;

126 ià(
	gm_®gÜ™hm
 =ğ"AES" || 
m_®gÜ™hm
 == "TDES")

128 ià(
’üy±
)

130 
m_Œigg”
 = "PLAINTEXT";

131 
	gm_ty³ToName
[
OUTPUT
] = "CIPHERTEXT";

135 
	gm_Œigg”
 = "CIPHERTEXT";

136 
	gm_ty³ToName
[
OUTPUT
] = "PLAINTEXT";

138 
	gm_couÁ
 = 0;

142 
	g´Ùeùed
:

143 
OuutD©a
(
¡d
::
¡ršg
 &
ouut
, cÚ¡ std::¡ršg &
key
, cÚ¡ std::¡ršg &
d©a
)

145 
ouut
 +ğ
key
;

146 
	gouut
 += "= ";

147 
	gouut
 +ğ
d©a
;

148 
	gouut
 += "\n";

151 
OuutD©a
(
¡d
::
¡ršg
 &
ouut
, cÚ¡ std::¡ršg &
key
, 
d©a
)

153 
OuutD©a
(
ouut
, 
key
, 
IÁToSŒšg
(
d©a
));

156 
OuutD©a
(
¡d
::
¡ršg
 &
ouut
, cÚ¡ std::¡ršg &
key
, cÚ¡ 
SecBy‹Block
 &
d©a
)

158 
	gouut
 +ğ
key
;

159 
	gouut
 += "= ";

160 
HexEncod”
(
Ãw
 
SŒšgSšk
(
ouut
), 
çl£
).
Put
(
d©a
, d©a.
size
());

161 
	gouut
 += "\n";

164 
OuutD©a
(
¡d
::
¡ršg
 &
ouut
, cÚ¡ std::¡ršg &
key
, cÚ¡ 
IÁeg”
 &
d©a
, 
size
=-1)

166 
SecBy‹Block
 
s
(
size
 < 0 ? 
d©a
.
MšEncodedSize
() : size);

167 
	gd©a
.
Encode
(
s
, s.
size
());

168 
OuutD©a
(
ouut
, 
key
, 
s
);

171 
OuutD©a
(
¡d
::
¡ršg
 &
ouut
, cÚ¡ std::¡ršg &
key
, cÚ¡ 
PŞynomŸlMod2
 &
d©a
, 
size
=-1)

173 
SecBy‹Block
 
s
(
size
 < 0 ? 
d©a
.
MšEncodedSize
() : size);

174 
	gd©a
.
Encode
(
s
, s.
size
());

175 
OuutD©a
(
ouut
, 
key
, 
s
);

178 
OuutD©a
(
¡d
::
¡ršg
 &
ouut
, 
D©aTy³
 
t
, cÚ¡ std::¡ršg &
d©a
)

180 ià(
m_®gÜ™hm
 == "SKIPJACK")

182 ià(
m_‹¡
 == "KAT")

184 ià(
t
 =ğ
OUTPUT
)

185 
ouut
 = 
m_lše
 + 
d©a
 + "\n";

189 ià(
	gt
 !ğ
COUNT
)

191 
ouut
 +ğ
m_ty³ToName
[
t
];

192 
	gouut
 += "=";

194 
	gouut
 +ğ
d©a
;

195 
	gouut
 +ğ
t
 =ğ
OUTPUT
 ? "\n" : " ";

198 ià(
	gm_®gÜ™hm
 =ğ"TDES" && 
t
 =ğ
KEY_T
 && 
m_ty³ToName
[KEY_T].
em±y
())

200 
ouut
 += "KEY1 = ";

201 
	gouut
 +ğ
d©a
.
sub¡r
(0, 16);

202 
	gouut
 += "\nKEY2 = ";

203 
	gouut
 +ğ
d©a
.
size
(è> 16 ? d©a.
sub¡r
(16, 16) : data.substr(0, 16);

204 
	gouut
 += "\nKEY3 = ";

205 
	gouut
 +ğ
d©a
.
size
(è> 32 ? d©a.
sub¡r
(32, 16) : data.substr(0, 16);

206 
	gouut
 += "\n";

210 
	gouut
 +ğ
m_ty³ToName
[
t
];

211 
	gouut
 += " = ";

212 
	gouut
 +ğ
d©a
;

213 
	gouut
 += "\n";

217 
OuutD©a
(
¡d
::
¡ršg
 &
ouut
, 
D©aTy³
 
t
, 
i
)

219 
OuutD©a
(
ouut
, 
t
, 
IÁToSŒšg
(
i
));

222 
OuutD©a
(
¡d
::
¡ršg
 &
ouut
, 
D©aTy³
 
t
, cÚ¡ 
SecBy‹Block
 &
d©a
)

224 
	g¡d
::
¡ršg
 
hexD©a
;

225 
SŒšgSourû
(
d©a
.
begš
(), d©a.
size
(), 
Œue
, 
Ãw
 
HexEncod”
Òew 
SŒšgSšk
(
hexD©a
), 
çl£
));

226 
OuutD©a
(
ouut
, 
t
, 
hexD©a
);

229 
OuutGiv’D©a
(
¡d
::
¡ršg
 &
ouut
, 
D©aTy³
 
t
, 
boŞ
 
İtiÚ®
 = 
çl£
)

231 ià(
m_d©a
.
fšd
(
m_ty³ToName
[
t
]è=ğm_d©a.
’d
())

233 ià(
İtiÚ®
)

235 
throw
 
Exû±iÚ
(Exû±iÚ::
OTHER_ERROR
, "Te¡D©aP¬£r: key‚Ù found: " + 
m_ty³ToName
[
t
]);

238 
OuutD©a
(
ouut
, 
t
, 
m_d©a
[
m_ty³ToName
[t]]);

241 
	g‹m¶©e
 <
şass
 
	gT
>

242 
BlockCh”
 * 
NewBT
(
T
 *)

244 ià(!
	gm_’üy±
 && (
	gm_mode
 =ğ"ECB" || 
m_mode
 == "CBC"))

245  
Ãw
 
ty³Çme
 
T
::
Deüy±iÚ
;

247  
Ãw
 
ty³Çme
 
	gT
::
Enüy±iÚ
;

250 
	g‹m¶©e
 <
şass
 
	gT
>

251 
Symm‘ricCh”
 * 
NewMode
(
T
 *, 
BlockCh”
 &
bt
, cÚ¡ 
by‹
 *
iv
)

253 ià(!
	gm_’üy±
)

254  
Ãw
 
ty³Çme
 
	gT
::
Deüy±iÚ
(
bt
, 
iv
, 
m_ãedbackSize
/8);

256  
Ãw
 
ty³Çme
 
	gT
::
Enüy±iÚ
(
bt
, 
iv
, 
m_ãedbackSize
/8);

259 
šlše
 
XÜ
(
SecBy‹Block
 &
z
, cÚ¡ SecBy‹Block &
x
, cÚ¡ SecBy‹Block &
y
)

261 
as£¹
(
x
.
size
(è=ğ
y
.size());

262 
	gz
.
»size
(
x
.
size
());

263 
xÜbuf
(
z
, 
x
, 
y
, x.
size
());

266 
SecBy‹Block
 
Upd©eKey
(SecBy‹Block 
key
, cÚ¡ SecBy‹Block *
‹xt
)

268 
	gšÃrCouÁ
 = (
m_®gÜ™hm
 == "AES") ? 1000 : 10000;

269 
	gkeySize
 = 
key
.
size
(), 
	gblockSize
 = 
‹xt
[0].size();

270 
SecBy‹Block
 
x
(
keySize
);

271 
	gk
=0; k<
	gkeySize
;)

273 
	gpos
 = 
šÃrCouÁ
 * 
blockSize
 - 
keySize
 + 
k
;

274 
memıy
(
x
 + 
k
, 
‹xt
[
pos
 / 
blockSize
] +…os % blockSize, blockSize -…os % blockSize);

275 
	gk
 +ğ
blockSize
 - 
pos
 % blockSize;

278 ià(
	gm_®gÜ™hm
 =ğ"TDES" || 
m_®gÜ™hm
 == "DES")

280 
i
=0; 
	gi
<
	gkeySize
; i+=8)

282 
xÜbuf
(
key
+
i
, 
x
+
keySize
-8-i, 8);

283 
	gDES
::
CÜ»ùKeyP¬™yB™s
(
key
+
i
);

287 
xÜbuf
(
key
, 
x
, 
keySize
);

289  
	gkey
;

292 
šlše
 
AssignLeáMo¡B™s
(
SecBy‹Block
 &
z
, cÚ¡ SecBy‹Block &
x
, 
K
)

294 
	gz
.
Assign
(
x
, 
K
/8);

297 
	g‹m¶©e
 <
şass
 
	gEC
>

298 
EC_KeyPaœ
(
¡ršg
 &
ouut
, 
n
, cÚ¡ 
OID
 &
oid
)

300 
	gDL_GroupP¬am‘”s_EC
<
	gEC
> 
·¿ms
(
oid
);

301 
	gi
=0; i<
	gn
; i++)

303 
	gDL_Priv©eKey_EC
<
	gEC
> 
	g´iv
;

304 
	gDL_PublicKey_EC
<
	gEC
> 
	gpub
;

305 
	g´iv
.
In™Ÿlize
(
m_ºg
, 
·¿ms
);

306 
	g´iv
.
MakePublicKey
(
pub
);

308 
OuutD©a
(
ouut
, "d ", 
´iv
.
G‘Priv©eExpÚ’t
());

309 
OuutD©a
(
ouut
, "Qx ", 
pub
.
G‘PublicEËm’t
().
x
, 
·¿ms
.
G‘Curve
().
G‘F›ld
().
MaxEËm’tBy‹L’gth
());

310 
OuutD©a
(
ouut
, "Qy ", 
pub
.
G‘PublicEËm’t
().
y
, 
·¿ms
.
G‘Curve
().
G‘F›ld
().
MaxEËm’tBy‹L’gth
());

314 
	g‹m¶©e
 <
şass
 
	gEC
>

315 
EC_SigG’
(
¡ršg
 &
ouut
, cÚ¡ 
OID
 &
oid
)

317 
	gDL_GroupP¬am‘”s_EC
<
	gEC
> 
·¿ms
(
oid
);

318 
ty³Çme
 
	gECDSA
<
	gEC
, 
	gSHA1
>::
Priv©eKey
 
´iv
;

319 
ty³Çme
 
	gECDSA
<
	gEC
, 
	gSHA1
>::
PublicKey
 
pub
;

320 
	g´iv
.
In™Ÿlize
(
m_ºg
, 
·¿ms
);

321 
	g´iv
.
MakePublicKey
(
pub
);

323 
ty³Çme
 
	gECDSA
<
	gEC
, 
	gSHA1
>::
SigÃr
 
sigÃr
(
´iv
);

324 
SecBy‹Block
 
sig
(
sigÃr
.
SigÇtu»L’gth
());

325 
SŒšgSourû
(
m_d©a
["Msg"], 
Œue
, 
Ãw
 
HexDecod”
Òew 
SigÃrF‹r
(
m_ºg
, 
sigÃr
,‚ew 
A¼aySšk
(
sig
, sig.
size
()))));

326 
SecBy‹Block
 
R
(
sig
, sig.
size
()/2), 
S
(sig+sig.size()/2, sig.size()/2);

328 
OuutD©a
(
ouut
, "Qx ", 
pub
.
G‘PublicEËm’t
().
x
, 
·¿ms
.
G‘Curve
().
G‘F›ld
().
MaxEËm’tBy‹L’gth
());

329 
OuutD©a
(
ouut
, "Qy ", 
pub
.
G‘PublicEËm’t
().
y
, 
·¿ms
.
G‘Curve
().
G‘F›ld
().
MaxEËm’tBy‹L’gth
());

330 
OuutD©a
(
ouut
, "R ", 
R
);

331 
OuutD©a
(
ouut
, "S ", 
S
);

334 
	g‹m¶©e
 <
şass
 
	gEC
>

335 
EC_SigV”
(
¡ršg
 &
ouut
, cÚ¡ 
OID
 &
oid
)

337 
SecBy‹Block
 
x
(
DecodeHex
(
m_d©a
["Qx"]));

338 
SecBy‹Block
 
y
(
DecodeHex
(
m_d©a
["Qy"]));

339 
IÁeg”
 
r
((
m_d©a
["R"]+"h").
c_¡r
());

340 
IÁeg”
 
s
((
m_d©a
["S"]+"h").
c_¡r
());

342 
ty³Çme
 
	gEC
::
F›ldEËm’t
 
Qx
(
x
, x.
size
());

343 
ty³Çme
 
	gEC
::
F›ldEËm’t
 
Qy
(
y
, y.
size
());

344 
ty³Çme
 
	gEC
::
EËm’t
 
Q
(
Qx
, 
Qy
);

346 
	gDL_GroupP¬am‘”s_EC
<
	gEC
> 
·¿ms
(
oid
);

347 
ty³Çme
 
	gECDSA
<
	gEC
, 
	gSHA1
>::
PublicKey
 
pub
;

348 
	gpub
.
In™Ÿlize
(
·¿ms
, 
Q
);

349 
ty³Çme
 
	gECDSA
<
	gEC
, 
	gSHA1
>::
V”if›r
 
v”if›r
(
pub
);

351 
SecBy‹Block
 
sig
(
v”if›r
.
SigÇtu»L’gth
());

352 
	gr
.
Encode
(
sig
, sig.
size
()/2);

353 
	gs
.
Encode
(
sig
+sig.
size
()/2, sig.size()/2);

355 
SigÇtu»V”ifiÿtiÚF‹r
 
f‹r
(
v”if›r
);

356 
	gf‹r
.
Put
(
sig
, sig.
size
());

357 
SŒšgSourû
(
m_d©a
["Msg"], 
Œue
, 
Ãw
 
HexDecod”
Òew 
RedœeùÜ
(
f‹r
, RedœeùÜ::
DATA_ONLY
)));

358 
	gf‹r
.
Mes§geEnd
();

359 
by‹
 
	gb
;

360 
	gf‹r
.
G‘
(
b
);

361 
OuutD©a
(
ouut
, "ResuÉ ", 
b
 ? "P" : "F");

364 
	g‹m¶©e
 <
şass
 
	gEC
>

365 
boŞ
 
EC_PKV
(
RªdomNumb”G’”©Ü
 &
ºg
, cÚ¡ 
SecBy‹Block
 &
x
, cÚ¡ SecBy‹Block &
y
, cÚ¡ 
OID
 &
oid
)

367 
ty³Çme
 
	gEC
::
F›ldEËm’t
 
Qx
(
x
, x.
size
());

368 
ty³Çme
 
	gEC
::
F›ldEËm’t
 
Qy
(
y
, y.
size
());

369 
ty³Çme
 
	gEC
::
EËm’t
 
Q
(
Qx
, 
Qy
);

371 
	gDL_GroupP¬am‘”s_EC
<
	gEC
> 
·¿ms
(
oid
);

372 
ty³Çme
 
	gECDSA
<
	gEC
, 
	gSHA1
>::
PublicKey
 
pub
;

373 
	gpub
.
In™Ÿlize
(
·¿ms
, 
Q
);

374  
	gpub
.
V®id©e
(
ºg
, 3);

377 
	g‹m¶©e
 <
şass
 
	gH
, cÏs 
	gResuÉ
>

378 
ResuÉ
 * 
C»©eRSA2
(cÚ¡ 
¡d
::
¡ršg
 &
¡ªd¬d
)

380 ià(
ty³id
(
ResuÉ
è=ğty³id(
PK_V”if›r
))

382 ià(
¡ªd¬d
 == "R")

383  (
ResuÉ
 *è
Ãw
 
ty³Çme
 
RSASS_ISO
<
H
>::
V”if›r
;

384 ià(
	g¡ªd¬d
 == "P")

385  (
ResuÉ
 *è
Ãw
 
ty³Çme
 
RSASS
<
PSS
, 
	gH
>::
V”if›r
;

386 ià(
	g¡ªd¬d
 == "1")

387  (
ResuÉ
 *è
Ãw
 
ty³Çme
 
RSASS
<
PKCS1v15
, 
	gH
>::
V”if›r
;

389 ià(
ty³id
(
ResuÉ
è=ğty³id(
PK_SigÃr
))

391 ià(
¡ªd¬d
 == "R")

392  (
ResuÉ
 *è
Ãw
 
ty³Çme
 
RSASS_ISO
<
H
>::
SigÃr
;

393 ià(
	g¡ªd¬d
 == "P")

394  (
ResuÉ
 *è
Ãw
 
ty³Çme
 
RSASS
<
PSS
, 
	gH
>::
SigÃr
;

395 ià(
	g¡ªd¬d
 == "1")

396  (
ResuÉ
 *è
Ãw
 
ty³Çme
 
RSASS
<
PKCS1v15
, 
	gH
>::
SigÃr
;

399  
	gNULL
;

402 
	g‹m¶©e
 <
şass
 
	gResuÉ
>

403 
ResuÉ
 * 
C»©eRSA
(cÚ¡ 
¡d
::
¡ršg
 &
¡ªd¬d
, cÚ¡ std::¡ršg &
hash
)

405 ià(
hash
 == "1")

406  
C»©eRSA2
<
SHA1
, 
	gResuÉ
>(
	g¡ªd¬d
);

407 ià(
	ghash
 == "224")

408  
C»©eRSA2
<
SHA224
, 
	gResuÉ
>(
	g¡ªd¬d
);

409 ià(
	ghash
 == "256")

410  
C»©eRSA2
<
SHA256
, 
	gResuÉ
>(
	g¡ªd¬d
);

411 ià(
	ghash
 == "384")

412  
C»©eRSA2
<
SHA384
, 
	gResuÉ
>(
	g¡ªd¬d
);

413 ià(
	ghash
 == "512")

414  
C»©eRSA2
<
SHA512
, 
	gResuÉ
>(
	g¡ªd¬d
);

416  
	gNULL
;

419 
vœtu®
 
DoTe¡
()

421 
	g¡d
::
¡ršg
 
ouut
;

423 ià(
	gm_®gÜ™hm
 == "DSA")

425 ià(
m_‹¡
 == "KeyPair")

427 
DL_GroupP¬am‘”s_DSA
 
pqg
;

428 
	gmodL’
 = 
©Ş
(
m_b¿ck‘SŒšg
.
sub¡r
(6).
c_¡r
());

429 
	gpqg
.
G’”©eRªdomW™hKeySize
(
m_ºg
, 
modL’
);

431 
OuutD©a
(
ouut
, "P ", 
pqg
.
G‘Modulus
());

432 
OuutD©a
(
ouut
, "Q ", 
pqg
.
G‘SubgroupOrd”
());

433 
OuutD©a
(
ouut
, "G ", 
pqg
.
G‘SubgroupG’”©Ü
());

435 
	gn
 = 
©Ş
(
m_d©a
["N"].
c_¡r
());

436 
	gi
=0; i<
	gn
; i++)

438 
	gDSA
::
SigÃr
 
´iv
;

439 
	g´iv
.
AcûssKey
().
G’”©eRªdom
(
m_ºg
, 
pqg
);

440 
	gDSA
::
V”if›r
 
pub
(
´iv
);

442 
OuutD©a
(
ouut
, "X ", 
´iv
.
G‘Key
().
G‘Priv©eExpÚ’t
());

443 
OuutD©a
(
ouut
, "Y ", 
pub
.
G‘Key
().
G‘PublicEËm’t
());

444 
A‰achedT¿nsfÜm©iÚ
()->
Put
((
by‹
 *)
ouut
.
d©a
(), ouut.
size
());

445 
	gouut
.
»size
(0);

448 ià(
	gm_‹¡
 == "PQGGen")

450 
n
 = 
©Ş
(
m_d©a
["N"].
c_¡r
());

451 
	gi
=0; i<
	gn
; i++)

453 
IÁeg”
 
	gp
, 
	gq
, 
	gh
, 
	gg
;

454 
	gcouÁ”
;

456 
SecBy‹Block
 
£ed
(
SHA
::
DIGESTSIZE
);

459 
	gm_ºg
.
G’”©eBlock
(
£ed
, s“d.
size
());

461 !
	gDSA
::
G’”©ePrimes
(
£ed
, s“d.
size
()*8, 
couÁ”
, 
p
, 1024, 
q
));

462 
	gh
.
Rªdomize
(
m_ºg
, 2, 
p
-2);

463 
	gg
 = 
a_exp_b_mod_c
(
h
, (
p
-1)/
q
,…);

465 
OuutD©a
(
ouut
, "P ", 
p
);

466 
OuutD©a
(
ouut
, "Q ", 
q
);

467 
OuutD©a
(
ouut
, "G ", 
g
);

468 
OuutD©a
(
ouut
, "S“d ", 
£ed
);

469 
OuutD©a
(
ouut
, "ø", 
couÁ”
);

470 
OuutD©a
(
ouut
, "H ", 
h
, 
p
.
By‹CouÁ
());

471 
A‰achedT¿nsfÜm©iÚ
()->
Put
((
by‹
 *)
ouut
.
d©a
(), ouut.
size
());

472 
	gouut
.
»size
(0);

475 ià(
	gm_‹¡
 == "SigGen")

477 
¡d
::
¡ršg
 &
’codedKey
 = 
m_d©a
["PrivKey"];

478 
	gmodL’
 = 
©Ş
(
m_b¿ck‘SŒšg
.
sub¡r
(6).
c_¡r
());

479 
	gDSA
::
Priv©eKey
 
´iv
;

481 ià(!
	g’codedKey
.
em±y
())

483 
SŒšgStÜe
 
s
(
’codedKey
);

484 
	g´iv
.
BERDecode
(
s
);

485 ià(
	g´iv
.
G‘GroupP¬am‘”s
().
G‘Modulus
().
B™CouÁ
(è!ğ
modL’
)

486 
’codedKey
.
ş—r
();

489 ià(
	g’codedKey
.
em±y
())

491 
	g´iv
.
In™Ÿlize
(
m_ºg
, 
modL’
);

492 
SŒšgSšk
 
s
(
’codedKey
);

493 
	g´iv
.
DEREncode
(
s
);

494 
OuutD©a
(
ouut
, "P ", 
´iv
.
G‘GroupP¬am‘”s
().
G‘Modulus
());

495 
OuutD©a
(
ouut
, "Q ", 
´iv
.
G‘GroupP¬am‘”s
().
G‘SubgroupOrd”
());

496 
OuutD©a
(
ouut
, "G ", 
´iv
.
G‘GroupP¬am‘”s
().
G‘SubgroupG’”©Ü
());

499 
	gDSA
::
SigÃr
 
sigÃr
(
´iv
);

500 
	gDSA
::
V”if›r
 
pub
(
sigÃr
);

501 
OuutD©a
(
ouut
, "Msg ", 
m_d©a
["Msg"]);

502 
OuutD©a
(
ouut
, "Y ", 
pub
.
G‘Key
().
G‘PublicEËm’t
());

504 
SecBy‹Block
 
sig
(
sigÃr
.
SigÇtu»L’gth
());

505 
SŒšgSourû
(
m_d©a
["Msg"], 
Œue
, 
Ãw
 
HexDecod”
Òew 
SigÃrF‹r
(
m_ºg
, 
sigÃr
,‚ew 
A¼aySšk
(
sig
, sig.
size
()))));

506 
SecBy‹Block
 
R
(
sig
, sig.
size
()/2), 
S
(sig+sig.size()/2, sig.size()/2);

507 
OuutD©a
(
ouut
, "R ", 
R
);

508 
OuutD©a
(
ouut
, "S ", 
S
);

509 
A‰achedT¿nsfÜm©iÚ
()->
Put
((
by‹
 *)
ouut
.
d©a
(), ouut.
size
());

510 
	gouut
.
»size
(0);

512 ià(
	gm_‹¡
 == "SigVer")

514 
IÁeg”
 
p
((
m_d©a
["P"] + "h").
c_¡r
());

515 
IÁeg”
 
q
((
m_d©a
["Q"] + "h").
c_¡r
());

516 
IÁeg”
 
g
((
m_d©a
["G"] + "h").
c_¡r
());

517 
IÁeg”
 
y
((
m_d©a
["Y"] + "h").
c_¡r
());

518 
	gDSA
::
V”if›r
 
v”if›r
(
p
, 
q
, 
g
, 
y
);

520 
HexDecod”
 
f‹r
(
Ãw
 
SigÇtu»V”ifiÿtiÚF‹r
(
v”if›r
));

521 
SŒšgSourû
(
m_d©a
["R"], 
Œue
, 
Ãw
 
RedœeùÜ
(
f‹r
, RedœeùÜ::
DATA_ONLY
));

522 
SŒšgSourû
(
m_d©a
["S"], 
Œue
, 
Ãw
 
RedœeùÜ
(
f‹r
, RedœeùÜ::
DATA_ONLY
));

523 
SŒšgSourû
(
m_d©a
["Msg"], 
Œue
, 
Ãw
 
RedœeùÜ
(
f‹r
, RedœeùÜ::
DATA_ONLY
));

524 
	gf‹r
.
Mes§geEnd
();

525 
by‹
 
	gb
;

526 
	gf‹r
.
G‘
(
b
);

527 
OuutD©a
(
ouut
, "ResuÉ ", 
b
 ? "P" : "F");

528 
A‰achedT¿nsfÜm©iÚ
()->
Put
((
by‹
 *)
ouut
.
d©a
(), ouut.
size
());

529 
	gouut
.
»size
(0);

531 ià(
	gm_‹¡
 == "PQGVer")

533 
IÁeg”
 
p
((
m_d©a
["P"] + "h").
c_¡r
());

534 
IÁeg”
 
q
((
m_d©a
["Q"] + "h").
c_¡r
());

535 
IÁeg”
 
g
((
m_d©a
["G"] + "h").
c_¡r
());

536 
IÁeg”
 
h
((
m_d©a
["H"] + "h").
c_¡r
());

537 
	gc
 = 
©Ş
(
m_d©a
["c"].
c_¡r
());

538 
SecBy‹Block
 
£ed
(
m_d©a
["S“d"].
size
()/2);

539 
SŒšgSourû
(
m_d©a
["S“d"], 
Œue
, 
Ãw
 
HexDecod”
Òew 
A¼aySšk
(
£ed
, s“d.
size
())));

541 
IÁeg”
 
	gp1
, 
	gq1
;

542 
boŞ
 
	g»suÉ
 = 
DSA
::
G’”©ePrimes
(
£ed
, s“d.
size
()*8, 
c
, 
p1
, 1024, 
q1
, 
Œue
);

543 
	g»suÉ
 = 
»suÉ
 && (
p1
 =ğ
p
 && 
q1
 =ğ
q
);

544 
	g»suÉ
 = 
»suÉ
 && 
g
 =ğ
a_exp_b_mod_c
(
h
, (
p
-1)/
q
,…);

546 
OuutD©a
(
ouut
, "ResuÉ ", 
»suÉ
 ? "P" : "F");

547 
A‰achedT¿nsfÜm©iÚ
()->
Put
((
by‹
 *)
ouut
.
d©a
(), ouut.
size
());

548 
	gouut
.
»size
(0);

554 ià(
	gm_®gÜ™hm
 == "ECDSA")

556 
¡d
::
m­
<¡d::
¡ršg
, 
OID
> 
Çme2oid
;

557 
	gÇme2oid
["P-192"] = 
ASN1
::
£ı192r1
();

558 
	gÇme2oid
["P-224"] = 
ASN1
::
£ı224r1
();

559 
	gÇme2oid
["P-256"] = 
ASN1
::
£ı256r1
();

560 
	gÇme2oid
["P-384"] = 
ASN1
::
£ı384r1
();

561 
	gÇme2oid
["P-521"] = 
ASN1
::
£ı521r1
();

562 
	gÇme2oid
["K-163"] = 
ASN1
::
£ù163k1
();

563 
	gÇme2oid
["K-233"] = 
ASN1
::
£ù233k1
();

564 
	gÇme2oid
["K-283"] = 
ASN1
::
£ù283k1
();

565 
	gÇme2oid
["K-409"] = 
ASN1
::
£ù409k1
();

566 
	gÇme2oid
["K-571"] = 
ASN1
::
£ù571k1
();

567 
	gÇme2oid
["B-163"] = 
ASN1
::
£ù163r2
();

568 
	gÇme2oid
["B-233"] = 
ASN1
::
£ù233r1
();

569 
	gÇme2oid
["B-283"] = 
ASN1
::
£ù283r1
();

570 
	gÇme2oid
["B-409"] = 
ASN1
::
£ù409r1
();

571 
	gÇme2oid
["B-571"] = 
ASN1
::
£ù571r1
();

573 ià(
	gm_‹¡
 == "PKV")

575 
boŞ
 
·ss
;

576 ià(
	gm_b¿ck‘SŒšg
[0] == 'P')

577 
·ss
 = 
EC_PKV
<
ECP
>(
m_ºg
, 
DecodeHex
(
m_d©a
["Qx"]), DecodeHex(m_d©a["Qy"]), 
	gÇme2oid
[
m_b¿ck‘SŒšg
]);

579 
	g·ss
 = 
EC_PKV
<
EC2N
>(
m_ºg
, 
DecodeHex
(
m_d©a
["Qx"]), DecodeHex(m_d©a["Qy"]), 
	gÇme2oid
[
m_b¿ck‘SŒšg
]);

581 
OuutD©a
(
ouut
, "ResuÉ ", 
·ss
 ? "P" : "F");

583 ià(
	gm_‹¡
 == "KeyPair")

585 ià(
m_b¿ck‘SŒšg
[0] == 'P')

586 
EC_KeyPaœ
<
ECP
>(
ouut
, 
©Ş
(
m_d©a
["N"].
c_¡r
()), 
	gÇme2oid
[
m_b¿ck‘SŒšg
]);

588 
	gEC_KeyPaœ
<
	gEC2N
>(
	gouut
, 
©Ş
(
m_d©a
["N"].
c_¡r
()), 
	gÇme2oid
[
m_b¿ck‘SŒšg
]);

590 ià(
	gm_‹¡
 == "SigGen")

592 ià(
m_b¿ck‘SŒšg
[0] == 'P')

593 
EC_SigG’
<
ECP
>(
ouut
, 
	gÇme2oid
[
m_b¿ck‘SŒšg
]);

595 
	gEC_SigG’
<
	gEC2N
>(
	gouut
, 
	gÇme2oid
[
m_b¿ck‘SŒšg
]);

597 ià(
	gm_‹¡
 == "SigVer")

599 ià(
m_b¿ck‘SŒšg
[0] == 'P')

600 
EC_SigV”
<
ECP
>(
ouut
, 
	gÇme2oid
[
m_b¿ck‘SŒšg
]);

602 
	gEC_SigV”
<
	gEC2N
>(
	gouut
, 
	gÇme2oid
[
m_b¿ck‘SŒšg
]);

605 
A‰achedT¿nsfÜm©iÚ
()->
Put
((
by‹
 *)
ouut
.
d©a
(), ouut.
size
());

606 
	gouut
.
»size
(0);

610 ià(
	gm_®gÜ™hm
 == "RSA")

612 
¡d
::
¡ršg
 
shaAlg
 = 
m_d©a
["SHAAlg"].
sub¡r
(3);

614 ià(
	gm_‹¡
 == "Ver")

616 
IÁeg”
 
n
((
m_d©a
["n"] + "h").
c_¡r
());

617 
IÁeg”
 
e
((
m_d©a
["e"] + "h").
c_¡r
());

618 
	gRSA
::
PublicKey
 
pub
;

619 
	gpub
.
In™Ÿlize
(
n
, 
e
);

621 
	gmemb”_±r
<
	gPK_V”if›r
> 
pV
(
C»©eRSA
<
PK_V”if›r
>(
m_mode
, 
shaAlg
));

622 
	gpV
->
AcûssM©”Ÿl
().
AssignFrom
(
pub
);

624 
HexDecod”
 
f‹r
(
Ãw
 
SigÇtu»V”ifiÿtiÚF‹r
(*
pV
));

625 
	gi
=
m_d©a
["S"].
size
(); i<
	gpV
->
SigÇtu»L’gth
()*2; i++)

626 
	gf‹r
.
Put
('0');

627 
SŒšgSourû
(
m_d©a
["S"], 
Œue
, 
Ãw
 
RedœeùÜ
(
f‹r
, RedœeùÜ::
DATA_ONLY
));

628 
SŒšgSourû
(
m_d©a
["Msg"], 
Œue
, 
Ãw
 
RedœeùÜ
(
f‹r
, RedœeùÜ::
DATA_ONLY
));

629 
	gf‹r
.
Mes§geEnd
();

630 
by‹
 
	gb
;

631 
	gf‹r
.
G‘
(
b
);

632 
OuutD©a
(
ouut
, "ResuÉ ", 
b
 ? "P" : "F");

636 
as£¹
(
m_‹¡
 == "Gen");

637 
	gmodL’
 = 
©Ş
(
m_b¿ck‘SŒšg
.
sub¡r
(6).
c_¡r
());

638 
	g¡d
::
¡ršg
 &
’codedKey
 = 
m_d©a
["PrivKey"];

639 
	gRSA
::
Priv©eKey
 
´iv
;

641 ià(!
	g’codedKey
.
em±y
())

643 
SŒšgStÜe
 
s
(
’codedKey
);

644 
	g´iv
.
BERDecode
(
s
);

645 ià(
	g´iv
.
G‘Modulus
().
B™CouÁ
(è!ğ
modL’
)

646 
’codedKey
.
ş—r
();

649 ià(
	g’codedKey
.
em±y
())

651 
	g´iv
.
In™Ÿlize
(
m_ºg
, 
modL’
);

652 
SŒšgSšk
 
s
(
’codedKey
);

653 
	g´iv
.
DEREncode
(
s
);

654 
OuutD©a
(
ouut
, "À", 
´iv
.
G‘Modulus
());

655 
OuutD©a
(
ouut
, "", 
´iv
.
G‘PublicExpÚ’t
(), 
modL’
/8);

658 
	gmemb”_±r
<
	gPK_SigÃr
> 
pS
(
C»©eRSA
<
PK_SigÃr
>(
m_mode
, 
shaAlg
));

659 
	gpS
->
AcûssM©”Ÿl
().
AssignFrom
(
´iv
);

661 
SecBy‹Block
 
sig
(
pS
->
SigÇtu»L’gth
());

662 
SŒšgSourû
(
m_d©a
["Msg"], 
Œue
, 
Ãw
 
HexDecod”
Òew 
SigÃrF‹r
(
m_ºg
, *
pS
,‚ew 
A¼aySšk
(
sig
, sig.
size
()))));

663 
OuutD©a
(
ouut
, "SHAAlg ", 
m_d©a
["SHAAlg"]);

664 
OuutD©a
(
ouut
, "Msg ", 
m_d©a
["Msg"]);

665 
OuutD©a
(
ouut
, "S ", 
sig
);

668 
A‰achedT¿nsfÜm©iÚ
()->
Put
((
by‹
 *)
ouut
.
d©a
(), ouut.
size
());

669 
	gouut
.
»size
(0);

673 ià(
	gm_®gÜ™hm
 == "SHA")

675 
memb”_±r
<
HashFunùiÚ
> 
pHF
;

677 ià(
	gm_mode
 == "1")

678 
pHF
.
»£t
(
Ãw
 
SHA1
);

679 ià(
	gm_mode
 == "224")

680 
pHF
.
»£t
(
Ãw
 
SHA224
);

681 ià(
	gm_mode
 == "256")

682 
pHF
.
»£t
(
Ãw
 
SHA256
);

683 ià(
	gm_mode
 == "384")

684 
pHF
.
»£t
(
Ãw
 
SHA384
);

685 ià(
	gm_mode
 == "512")

686 
pHF
.
»£t
(
Ãw
 
SHA512
);

688 ià(
	gm_‹¡
 == "MONTE")

690 
SecBy‹Block
 
£ed
 = 
m_d©a2
[
INPUT
];

691 
SecBy‹Block
 
	gMD
[1003];

692 
	gi
,
	gj
;

694 
	gj
=0; j<100; j++)

696 
	gMD
[0] = 
MD
[1] = MD[2] = 
£ed
;

697 
	gi
=3; i<1003; i++)

699 
SecBy‹Block
 
	gMi
 = 
MD
[
i
-3] + MD[i-2] + MD[i-1];

700 
	gMD
[
i
].
»size
(
pHF
->
Dige¡Size
());

701 
	gpHF
->
C®cuÏ‹Dige¡
(
MD
[
i
], 
Mi
, Mi.
size
());

703 
	g£ed
 = 
MD
[1002];

704 
OuutD©a
(
ouut
, "COUNT ", 
j
);

705 
OuutD©a
(
ouut
, "MD ", 
£ed
);

706 
A‰achedT¿nsfÜm©iÚ
()->
Put
((
by‹
 *)
ouut
.
d©a
(), ouut.
size
());

707 
	gouut
.
»size
(0);

712 
SecBy‹Block
 
g
(
pHF
->
Dige¡Size
());

713 
	gSecBy‹Block
 &
msg
(
m_d©a2
[
INPUT
]);

714 
	gËn
 = 
©Ş
(
m_d©a
["L’"].
c_¡r
());

715 
SŒšgSourû
(
msg
.
begš
(), 
Ën
/8, 
Œue
, 
Ãw
 
HashF‹r
(*
pHF
,‚ew 
A¼aySšk
(
g
,ag.
size
())));

716 
OuutD©a
(
ouut
, "MD ", 
g
);

717 
A‰achedT¿nsfÜm©iÚ
()->
Put
((
by‹
 *)
ouut
.
d©a
(), ouut.
size
());

718 
	gouut
.
»size
(0);

723 
	gSecBy‹Block
 &
	gkey
 = 
m_d©a2
[
KEY_T
];

725 ià(
	gm_®gÜ™hm
 == "TDES")

727 ià(!
m_d©a
["KEY1"].
em±y
())

729 cÚ¡ 
¡d
::
¡ršg
 
keys
[3] = {
m_d©a
["KEY1"], m_data["KEY2"], m_data["KEY3"]};

730 
	gkey
.
»size
(24);

731 
HexDecod”
 
hexDec
(
Ãw
 
A¼aySšk
(
key
, key.
size
()));

732 
	gi
=0; i<3; i++)

733 
	ghexDec
.
Put
((
by‹
 *)
keys
[
i
].
d©a
(), keys[i].
size
());

735 ià(
	gkeys
[0] =ğ
keys
[2])

737 ià(
keys
[0] == keys[1])

738 
key
.
»size
(8);

740 
	gkey
.
»size
(16);

743 
	gkey
.
»size
(24);

747 ià(
	gm_®gÜ™hm
 == "RNG")

749 
key
.
»size
(24);

750 
SŒšgSourû
(
m_d©a
["Key1"] + m_d©a["Key2"] + m_d©a["Key3"], 
Œue
, 
Ãw
 
HexDecod”
Òew 
A¼aySšk
(
key
, key.
size
())));

752 
SecBy‹Block
 
£ed
(
m_d©a2
[
INPUT
]), 
dt
(m_d©a2[
IV
]), 
r
(8);

753 
X917RNG
 
ºg
(
Ãw
 
DES_EDE3
::
Enüy±iÚ
(
key
, key.
size
()), 
£ed
, 
dt
);

755 ià(
	gm_‹¡
 == "MCT")

757 
i
=0; 
	gi
<10000; i++)

758 
	gºg
.
G’”©eBlock
(
r
,„.
size
());

762 
	gºg
.
G’”©eBlock
(
r
,„.
size
());

765 
OuutD©a
(
ouut
, "R ", 
r
);

766 
A‰achedT¿nsfÜm©iÚ
()->
Put
((
by‹
 *)
ouut
.
d©a
(), ouut.
size
());

767 
	gouut
.
»size
(0);

771 ià(
	gm_®gÜ™hm
 == "HMAC")

773 
memb”_±r
<
Mes§geAuth’tiÿtiÚCode
> 
pMAC
;

775 ià(
	gm_b¿ck‘SŒšg
 == "L=20")

776 
pMAC
.
»£t
(
Ãw
 
HMAC
<
SHA1
>);

777 ià(
	gm_b¿ck‘SŒšg
 == "L=28")

778 
pMAC
.
»£t
(
Ãw
 
HMAC
<
SHA224
>);

779 ià(
	gm_b¿ck‘SŒšg
 == "L=32")

780 
pMAC
.
»£t
(
Ãw
 
HMAC
<
SHA256
>);

781 ià(
	gm_b¿ck‘SŒšg
 == "L=48")

782 
pMAC
.
»£t
(
Ãw
 
HMAC
<
SHA384
>);

783 ià(
	gm_b¿ck‘SŒšg
 == "L=64")

784 
pMAC
.
»£t
(
Ãw
 
HMAC
<
SHA512
>);

786 
throw
 
Exû±iÚ
(Exû±iÚ::
OTHER_ERROR
, "Te¡D©aP¬£r: uÃx³ùed HMAC b¿ck‘ sŒšg: " + 
m_b¿ck‘SŒšg
);

788 
	gpMAC
->
S‘Key
(
key
, key.
size
());

789 
	gTËn
 = 
©Ş
(
m_d©a
["TËn"].
c_¡r
());

790 
SecBy‹Block
 
g
(
TËn
);

791 
SŒšgSourû
(
m_d©a
["Msg"], 
Œue
, 
Ãw
 
HexDecod”
Òew 
HashF‹r
(*
pMAC
,‚ew 
A¼aySšk
(
g
, 
TËn
), 
çl£
, Tlen)));

792 
OuutD©a
(
ouut
, "Maø", 
g
);

793 
A‰achedT¿nsfÜm©iÚ
()->
Put
((
by‹
 *)
ouut
.
d©a
(), ouut.
size
());

794 
	gouut
.
»size
(0);

798 
	gmemb”_±r
<
	gBlockCh”
> 
	gpBT
;

799 ià(
	gm_®gÜ™hm
 == "DES")

800 
pBT
.
»£t
(
NewBT
((
DES
*)0));

801 ià(
	gm_®gÜ™hm
 == "TDES")

803 ià(
key
.
size
() == 8)

804 
pBT
.
»£t
(
NewBT
((
DES
*)0));

805 ià(
	gkey
.
size
() == 16)

806 
pBT
.
»£t
(
NewBT
((
DES_EDE2
*)0));

808 
	gpBT
.
»£t
(
NewBT
((
DES_EDE3
*)0));

810 ià(
	gm_®gÜ™hm
 == "SKIPJACK")

811 
pBT
.
»£t
(
NewBT
((
SKIPJACK
*)0));

812 ià(
	gm_®gÜ™hm
 == "AES")

813 
pBT
.
»£t
(
NewBT
((
AES
*)0));

815 
throw
 
Exû±iÚ
(Exû±iÚ::
OTHER_ERROR
, "Te¡D©aP¬£r: uÃx³ùed‡lgÜ™hm: " + 
m_®gÜ™hm
);

817 ià(!
	gpBT
->
IsV®idKeyL’gth
(
key
.
size
()))

818 
	gkey
.
CËªNew
(
pBT
->
DeçuÉKeyL’gth
());

819 
	gpBT
->
S‘Key
(
key
.
d©a
(), key.
size
());

821 
	gSecBy‹Block
 &
	giv
 = 
m_d©a2
[
IV
];

822 ià(
	giv
.
em±y
())

823 
	giv
.
CËªNew
(
pBT
->
BlockSize
());

825 
	gmemb”_±r
<
	gSymm‘ricCh”
> 
	gpCh”
;

826 
	gK
 = 
m_ãedbackSize
;

828 ià(
	gm_mode
 == "ECB")

829 
pCh”
.
»£t
(
NewMode
((
ECB_Mode_Ex‹º®Ch”
*)0, *
pBT
, 
iv
));

830 ià(
	gm_mode
 == "CBC")

831 
pCh”
.
»£t
(
NewMode
((
CBC_Mode_Ex‹º®Ch”
*)0, *
pBT
, 
iv
));

832 ià(
	gm_mode
 == "CFB")

833 
pCh”
.
»£t
(
NewMode
((
CFB_Mode_Ex‹º®Ch”
*)0, *
pBT
, 
iv
));

834 ià(
	gm_mode
 == "OFB")

835 
pCh”
.
»£t
(
NewMode
((
OFB_Mode_Ex‹º®Ch”
*)0, *
pBT
, 
iv
));

837 
throw
 
Exû±iÚ
(Exû±iÚ::
OTHER_ERROR
, "Te¡D©aP¬£r: uÃx³ùed mode: " + 
m_mode
);

839 
boŞ
 
	g’üy±
 = 
m_’üy±
;

841 ià(
	gm_‹¡
 == "MONTE")

843 
SecBy‹Block
 
KEY
[401];

844 
	gKEY
[0] = 
key
;

845 
	gkeySize
 = 
key
.
size
();

846 
	gblockSize
 = 
pBT
->
BlockSize
();

848 
	g¡d
::
veùÜ
<
SecBy‹Block
> 
IB
(10001), 
OB
(10001), 
PT
(10001), 
CT
(10001), 
RESULT
(10001), 
TXT
(10001), 
CV
(10001);

849 
	gPT
[0] = 
G‘D©a
("PLAINTEXT");

850 
	gCT
[0] = 
G‘D©a
("CIPHERTEXT");

851 
	gCV
[0] = 
IB
[0] = 
iv
;

852 
	gTXT
[0] = 
G‘D©a
("TEXT");

854 
	gou‹rCouÁ
 = (
m_®gÜ™hm
 == "AES") ? 100 : 400;

855 
	gšÃrCouÁ
 = (
m_®gÜ™hm
 == "AES") ? 1000 : 10000;

857 
	gi
=0; i<
	gou‹rCouÁ
; i++)

859 
	gpBT
->
S‘Key
(
KEY
[
i
], 
keySize
);

861 
	gj
=0; j<
	gšÃrCouÁ
; j++)

863 ià(
	gm_mode
 == "ECB")

865 ià(
’üy±
)

867 
IB
[
j
] = 
PT
[j];

868 
	gCT
[
j
].
»size
(
blockSize
);

869 
	gpBT
->
ProûssBlock
(
IB
[
j
], 
CT
[j]);

870 
	gPT
[
j
+1] = 
CT
[j];

874 
	gIB
[
j
] = 
CT
[j];

875 
	gPT
[
j
].
»size
(
blockSize
);

876 
	gpBT
->
ProûssBlock
(
IB
[
j
], 
PT
[j]);

877 
	gCT
[
j
+1] = 
PT
[j];

880 ià(
	gm_mode
 == "OFB")

882 
OB
[
j
].
»size
(
blockSize
);

883 
	gpBT
->
ProûssBlock
(
IB
[
j
], 
OB
[j]);

884 
XÜ
(
RESULT
[
j
], 
OB
[j], 
TXT
[j]);

885 
	gTXT
[
j
+1] = 
IB
[j];

886 
	gIB
[
j
+1] = 
OB
[j];

888 ià(
	gm_mode
 == "CBC")

890 ià(
’üy±
)

892 
XÜ
(
IB
[
j
], 
PT
[j], 
CV
[j]);

893 
	gCT
[
j
].
»size
(
blockSize
);

894 
	gpBT
->
ProûssBlock
(
IB
[
j
], 
CT
[j]);

895 
	gPT
[
j
+1] = 
CV
[j];

896 
	gCV
[
j
+1] = 
CT
[j];

900 
	gIB
[
j
] = 
CT
[j];

901 
	gOB
[
j
].
»size
(
blockSize
);

902 
	gpBT
->
ProûssBlock
(
IB
[
j
], 
OB
[j]);

903 
XÜ
(
PT
[
j
], 
OB
[j], 
CV
[j]);

904 
	gCV
[
j
+1] = 
CT
[j];

905 
	gCT
[
j
+1] = 
PT
[j];

908 ià(
	gm_mode
 == "CFB")

910 ià(
’üy±
)

912 
OB
[
j
].
»size
(
blockSize
);

913 
	gpBT
->
ProûssBlock
(
IB
[
j
], 
OB
[j]);

914 
AssignLeáMo¡B™s
(
CT
[
j
], 
OB
[j], 
K
);

915 
XÜ
(
CT
[
j
], CT[j], 
PT
[j]);

916 
AssignLeáMo¡B™s
(
PT
[
j
+1], 
IB
[j], 
K
);

917 
	gIB
[
j
+1].
»size
(
blockSize
);

918 
memıy
(
IB
[
j
+1], IB[j]+
K
/8, 
blockSize
-K/8);

919 
memıy
(
IB
[
j
+1]+
blockSize
-
K
/8, 
CT
[j], K/8);

923 
	gOB
[
j
].
»size
(
blockSize
);

924 
	gpBT
->
ProûssBlock
(
IB
[
j
], 
OB
[j]);

925 
AssignLeáMo¡B™s
(
PT
[
j
], 
OB
[j], 
K
);

926 
XÜ
(
PT
[
j
], PT[j], 
CT
[j]);

927 
	gIB
[
j
+1].
»size
(
blockSize
);

928 
memıy
(
IB
[
j
+1], IB[j]+
K
/8, 
blockSize
-K/8);

929 
memıy
(
IB
[
j
+1]+
blockSize
-
K
/8, 
CT
[j], K/8);

930 
AssignLeáMo¡B™s
(
CT
[
j
+1], 
OB
[j], 
K
);

934 
throw
 
Exû±iÚ
(Exû±iÚ::
OTHER_ERROR
, "Te¡D©aP¬£r: uÃx³ùed mode: " + 
m_mode
);

937 
OuutD©a
(
ouut
, 
COUNT
, 
IÁToSŒšg
(
i
));

938 
OuutD©a
(
ouut
, 
KEY_T
, 
KEY
[
i
]);

939 ià(
	gm_mode
 == "CBC")

940 
OuutD©a
(
ouut
, 
IV
, 
CV
[0]);

941 ià(
	gm_mode
 =ğ"OFB" || 
m_mode
 == "CFB")

942 
OuutD©a
(
ouut
, 
IV
, 
IB
[0]);

943 ià(
	gm_mode
 =ğ"ECB" || 
m_mode
 == "CBC" || m_mode == "CFB")

945 ià(
’üy±
)

947 
OuutD©a
(
ouut
, 
INPUT
, 
PT
[0]);

948 
OuutD©a
(
ouut
, 
OUTPUT
, 
CT
[
šÃrCouÁ
-1]);

949 
	gKEY
[
i
+1] = 
Upd©eKey
(
KEY
[i], &
CT
[0]);

953 
OuutD©a
(
ouut
, 
INPUT
, 
CT
[0]);

954 
OuutD©a
(
ouut
, 
OUTPUT
, 
PT
[
šÃrCouÁ
-1]);

955 
	gKEY
[
i
+1] = 
Upd©eKey
(
KEY
[i], &
PT
[0]);

957 
	gPT
[0] = 
PT
[
šÃrCouÁ
];

958 
	gIB
[0] = 
IB
[
šÃrCouÁ
];

959 
	gCV
[0] = 
CV
[
šÃrCouÁ
];

960 
	gCT
[0] = 
CT
[
šÃrCouÁ
];

962 ià(
	gm_mode
 == "OFB")

964 
OuutD©a
(
ouut
, 
INPUT
, 
TXT
[0]);

965 
OuutD©a
(
ouut
, 
OUTPUT
, 
RESULT
[
šÃrCouÁ
-1]);

966 
	gKEY
[
i
+1] = 
Upd©eKey
(
KEY
[i], &
RESULT
[0]);

967 
XÜ
(
TXT
[0], TXT[0], 
IB
[
šÃrCouÁ
-1]);

968 
	gIB
[0] = 
OB
[
šÃrCouÁ
-1];

970 
	gouut
 += "\n";

971 
A‰achedT¿nsfÜm©iÚ
()->
Put
((
by‹
 *)
ouut
.
d©a
(), ouut.
size
());

972 
	gouut
.
»size
(0);

975 ià(
	gm_‹¡
 == "MCT")

977 
SecBy‹Block
 
KEY
[101];

978 
	gKEY
[0] = 
key
;

979 
	gkeySize
 = 
key
.
size
();

980 
	gblockSize
 = 
pBT
->
BlockSize
();

982 
SecBy‹Block
 
	givs
[101], 
	gšputs
[1001], 
	gouuts
[1001];

983 
	givs
[0] = 
iv
;

984 
	gšputs
[0] = 
m_d©a2
[
INPUT
];

986 
	gi
=0; i<100; i++)

988 
	gpCh”
->
S‘Key
(
KEY
[
i
], 
keySize
, 
MakeP¬am‘”s
(
Name
::
IV
(), (cÚ¡ 
by‹
 *)
ivs
[i])(Name::
F“dbackSize
(), ()
K
/8, 
çl£
));

990 
	gj
=0; j<1000; j++)

992 
	gouuts
[
j
] = 
šputs
[j];

993 
	gpCh”
->
ProûssSŒšg
(
ouuts
[
j
], ouuts[j].
size
());

994 ià(
	gK
==8 && 
m_mode
 == "CFB")

996 ià(
j
<16)

997 
šputs
[
j
+1].
Assign
(
ivs
[
i
]+j, 1);

999 
	gšputs
[
j
+1] = 
ouuts
[j-16];

1001 ià(
	gm_mode
 == "ECB")

1002 
šputs
[
j
+1] = 
ouuts
[j];

1003 ià(
	gj
 == 0)

1004 
šputs
[
j
+1] = 
ivs
[
i
];

1006 
	gšputs
[
j
+1] = 
ouuts
[j-1];

1009 ià(
	gm_®gÜ™hm
 == "AES")

1010 
OuutD©a
(
ouut
, 
COUNT
, 
m_couÁ
++);

1011 
OuutD©a
(
ouut
, 
KEY_T
, 
KEY
[
i
]);

1012 ià(
	gm_mode
 != "ECB")

1013 
OuutD©a
(
ouut
, 
IV
, 
ivs
[
i
]);

1014 
OuutD©a
(
ouut
, 
INPUT
, 
šputs
[0]);

1015 
OuutD©a
(
ouut
, 
OUTPUT
, 
ouuts
[999]);

1016 
	gouut
 += "\n";

1017 
A‰achedT¿nsfÜm©iÚ
()->
Put
((
by‹
 *)
ouut
.
d©a
(), ouut.
size
());

1018 
	gouut
.
»size
(0);

1020 
	gKEY
[
i
+1] = 
Upd©eKey
(
KEY
[i], 
ouuts
);

1021 
	givs
[
i
+1].
CËªNew
(
pCh”
->
IVSize
());

1022 
	givs
[
i
+1] = 
Upd©eKey
(
ivs
[i+1], 
ouuts
);

1023 ià(
	gK
==8 && 
m_mode
 == "CFB")

1024 
šputs
[0] = 
ouuts
[999-16];

1025 ià(
	gm_mode
 == "ECB")

1026 
šputs
[0] = 
ouuts
[999];

1028 
	gšputs
[0] = 
ouuts
[998];

1033 
as£¹
(
m_‹¡
 == "KAT");

1035 
	gSecBy‹Block
 &
	gšput
 = 
m_d©a2
[
INPUT
];

1036 
SecBy‹Block
 
»suÉ
(
šput
.
size
());

1037 
	gmemb”_±r
<
	gF‹r
> 
pF‹r
(
Ãw
 
SŒ—mT¿nsfÜm©iÚF‹r
(*
pCh”
,‚ew 
A¼aySšk
(
»suÉ
,„esuÉ.
size
()), SŒ—mT¿nsfÜm©iÚF‹r::
NO_PADDING
));

1038 
SŒšgSourû
(
šput
.
d©a
(), iÅut.
size
(), 
Œue
, 
pF‹r
.
»Ëa£
());

1040 
OuutGiv’D©a
(
ouut
, 
COUNT
, 
Œue
);

1041 
OuutD©a
(
ouut
, 
KEY_T
, 
key
);

1042 
OuutGiv’D©a
(
ouut
, 
IV
, 
Œue
);

1043 
OuutGiv’D©a
(
ouut
, 
INPUT
);

1044 
OuutD©a
(
ouut
, 
OUTPUT
, 
»suÉ
);

1045 
	gouut
 += "\n";

1046 
A‰achedT¿nsfÜm©iÚ
()->
Put
((
by‹
 *)
ouut
.
d©a
(), ouut.
size
());

1050 
	g¡d
::
veùÜ
<
¡d
::
¡ršg
> 
Tok’ize
(cÚ¡ std::¡ršg &
lše
)

1052 
¡d
::
veùÜ
<¡d::
¡ršg
> 
»suÉ
;

1053 
	g¡d
::
¡ršg
 
s
;

1054 
	gi
=0; i<
	glše
.
size
(); i++)

1056 ià(
i§Êum
(
lše
[
i
]è|| 
	glše
[i] == '^')

1057 
s
 +ğ
lše
[
i
];

1058 ià(!
	gs
.
em±y
())

1060 
	g»suÉ
.
push_back
(
s
);

1061 
	gs
 = "";

1063 ià(
	glše
[
i
] == '=')

1064 
»suÉ
.
push_back
("=");

1066 ià(!
	gs
.
em±y
())

1067 
	g»suÉ
.
push_back
(
s
);

1068  
	g»suÉ
;

1071 
boŞ
 
IsŞ©edMes§geEnd
(boŞ 
blockšg
)

1073 ià(!
	gblockšg
)

1074 
throw
 
BlockšgIÅutOÆy
("TestDataParser");

1076 
	gm_lše
.
»size
(0);

1077 
	gm_šQueue
.
T¿nsãrTo
(
SŒšgSšk
(
m_lše
).
Ref
());

1079 ià(
	gm_lše
[0] == '#')

1080  
çl£
;

1082 
boŞ
 
	gcİyLše
 = 
çl£
;

1084 ià(
	gm_lše
[0] == '[')

1086 
m_b¿ck‘SŒšg
 = 
m_lše
.
sub¡r
(1, m_lše.
size
()-2);

1087 ià(
	gm_b¿ck‘SŒšg
 == "ENCRYPT")

1088 
S‘Enüy±
(
Œue
);

1089 ià(
	gm_b¿ck‘SŒšg
 == "DECRYPT")

1090 
S‘Enüy±
(
çl£
);

1091 
	gcİyLše
 = 
Œue
;

1094 ià(
	gm_lše
.
sub¡r
(0, 2) == "H>")

1096 
as£¹
(
m_‹¡
 == "sha");

1097 
	gm_b¿ck‘SŒšg
 = 
m_lše
.
sub¡r
(2, m_lše.
size
()-4);

1098 
	gm_lše
 = 
m_lše
.
sub¡r
(0, 13) + "Hashes<H";

1099 
	gcİyLše
 = 
Œue
;

1102 ià(
	gm_lše
 == "D>")

1103 
cİyLše
 = 
Œue
;

1105 ià(
	gm_lše
 == "<D")

1107 
m_lše
 += "\n";

1108 
	gcİyLše
 = 
Œue
;

1111 ià(
	gcİyLše
)

1113 
	gm_lše
 += '\n';

1114 
A‰achedT¿nsfÜm©iÚ
()->
Put
((
by‹
 *)
m_lše
.
d©a
(), m_lše.
size
(), 
blockšg
);

1115  
	gçl£
;

1118 
	g¡d
::
veùÜ
<
¡d
::
¡ršg
> 
tok’s
 = 
Tok’ize
(
m_lše
);

1120 ià(
	gm_®gÜ™hm
 =ğ"DSA" && 
m_‹¡
 == "sha")

1122 
i
 = 0; 
	gi
 < 
	gtok’s
.
size
(); i++)

1124 ià(
	gtok’s
[
i
] == "^")

1125 
DoTe¡
();

1126 ià(
	gtok’s
[
i
] != "")

1127 
m_com·ùSŒšg
.
push_back
(
©Ş
(
tok’s
[
i
].
c_¡r
()));

1132 ià(!
	gm_lše
.
em±y
(è&& ((
	gm_®gÜ™hm
 =ğ"RSA" && 
m_‹¡
 !ğ"G’"è|| 
m_®gÜ™hm
 == "RNG" || m_algorithm == "HMAC" || m_algorithm == "SHA" || (m_algorithm == "ECDSA" && m_test != "KeyPair") || (m_algorithm == "DSA" && (m_test == "PQGVer" || m_test == "SigVer"))))

1135 
¡d
::
¡ršg
 
ouut
 = 
m_lše
 + '\n';

1136 
A‰achedT¿nsfÜm©iÚ
()->
Put
((
by‹
 *)
ouut
.
d©a
(), ouut.
size
());

1139 
	gi
 = 0; i < 
	gtok’s
.
size
(); i++)

1141 ià(
	gm_fœ¡Lše
 && 
	gm_®gÜ™hm
 != "DSA")

1143 ià(
tok’s
[
i
] == "Encrypt" ||okens[i] == "OFB")

1144 
S‘Enüy±
(
Œue
);

1145 ià(
	gtok’s
[
i
] == "Decrypt")

1146 
S‘Enüy±
(
çl£
);

1147 ià(
	gtok’s
[
i
] == "Modes")

1148 
m_‹¡
 = "MONTE";

1152 ià(
	gtok’s
[
i
] != "=")

1155 ià(
	gi
 == 0)

1156 
throw
 
Exû±iÚ
(Exû±iÚ::
OTHER_ERROR
, "Te¡D©aP¬£r: uÃx³ùed d©a: " + 
m_lše
);

1158 cÚ¡ 
	g¡d
::
¡ršg
 &
key
 = 
tok’s
[
i
-1];

1159 
	g¡d
::
¡ršg
 &
d©a
 = 
m_d©a
[
key
];

1160 
	gd©a
 = (
tok’s
.
size
(è> 
i
+1) ?okens[i+1] : "";

1161 
D©aTy³
 
	gt
 = 
m_ÇmeToTy³
[
key
];

1162 
	gm_ty³ToName
[
t
] = 
key
;

1163 
	gm_d©a2
[
t
] = 
DecodeHex
(
d©a
);

1165 ià(
	gkey
 =ğ
m_Œigg”
 || (
t
 =ğ
OUTPUT
 && !
m_d©a2
[
INPUT
].
em±y
(è&& !
is¥aû
(
m_lše
[0])))

1166 
DoTe¡
();

1171 
	gm_fœ¡Lše
 = 
çl£
;

1173  
	gçl£
;

1176 
šlše
 cÚ¡ 
	gSecBy‹Block
 & 
G‘D©a
(cÚ¡ 
¡d
::
¡ršg
 &
key
)

1178  
m_d©a2
[
m_ÇmeToTy³
[
key
]];

1181 
SecBy‹Block
 
DecodeHex
(cÚ¡ 
¡d
::
¡ršg
 &
d©a
)

1183 
SecBy‹Block
 
d©a2
(
d©a
.
size
() / 2);

1184 
SŒšgSourû
(
d©a
, 
Œue
, 
Ãw
 
HexDecod”
Òew 
A¼aySšk
(
d©a2
, d©a2.
size
())));

1185  
	gd©a2
;

1188 
	g¡d
::
¡ršg
 
m_®gÜ™hm
, 
	gm_‹¡
, 
	gm_mode
, 
	gm_lše
, 
	gm_b¿ck‘SŒšg
, 
	gm_Œigg”
;

1189 
	gm_ãedbackSize
, 
	gm_bÏnkLšeT¿ns™iÚ
;

1190 
boŞ
 
	gm_’üy±
, 
	gm_fœ¡Lše
;

1192 
	g¡d
::
	tm­
<
	t¡d
::
	t¡ršg
, 
	tD©aTy³
> 
	tNameToTy³M­
;

1193 
NameToTy³M­
 
	gm_ÇmeToTy³
;

1194 
	g¡d
::
	tm­
<
	tD©aTy³
, 
	t¡d
::
	t¡ršg
> 
	tTy³ToNameM­
;

1195 
Ty³ToNameM­
 
	gm_ty³ToName
;

1197 
	g¡d
::
	tm­
<
	t¡d
::
	t¡ršg
, std::¡ršg> 
	tM­
;

1198 
M­
 
	gm_d©a
;

1199 
	g¡d
::
	tm­
<
	tD©aTy³
, 
	tSecBy‹Block
> 
	tM­2
;

1200 
M­2
 
	gm_d©a2
;

1201 
	gm_couÁ
;

1203 
	gAutoS“dedX917RNG
<
	gAES
> 
	gm_ºg
;

1204 
	g¡d
::
veùÜ
<> 
m_com·ùSŒšg
;

1207 
	$FIPS_140_AlgÜ™hmTe¡
(
¬gc
, **
¬gv
)

1209 
¬gc
--;

1210 
¬gv
++;

1212 
¡d
::
¡ršg
 
®gÜ™hm
 = 
¬gv
[1];

1213 
¡d
::
¡ršg
 
·thÇme
 = 
¬gv
[2];

1214 
i
 = 
·thÇme
.
	`fšd_Ï¡_of
("\\/");

1215 
¡d
::
¡ršg
 
f’ame
 = 
·thÇme
.
	`sub¡r
(
i
 =ğ¡d::¡ršg::
Åos
 ? 0 : i+1);

1216 
¡d
::
¡ršg
 
dœÇme
 = 
·thÇme
.
	`sub¡r
(0, 
i
);

1218 ià(
®gÜ™hm
 == "auto")

1220 
¡ršg
 
®gTabË
[] = {"AES", "ECDSA", "DSA", "HMAC", "RNG", "RSA", "TDES", "SKIPJACK", "SHA"};

1221 
i
=0; i<(
®gTabË
)/(algTable[0]); i++)

1223 ià(
dœÇme
.
	`fšd
(
®gTabË
[
i
]è!ğ
¡d
::
¡ršg
::
Åos
)

1225 
®gÜ™hm
 = 
®gTabË
[
i
];

1231 
Œy


1233 
¡d
::
¡ršg
 
mode
;

1234 ià(
®gÜ™hm
 == "SHA")

1235 
mode
 = 
	`IÁToSŒšg
(
	`©Ş
(
f’ame
.
	`sub¡r
(3, 3).
	`c_¡r
()));

1236 ià(
®gÜ™hm
 == "RSA")

1237 
mode
 = 
f’ame
.
	`sub¡r
(6, 1);

1238 ià(
f’ame
[0] == 'S' || filename[0] == 'T')

1239 
mode
 = 
f’ame
.
	`sub¡r
(1, 3);

1241 
mode
 = 
f’ame
.
	`sub¡r
(0, 3);

1242 
i
 = 0; i<
mode
.
	`size
(); i++)

1243 
mode
[
i
] = 
	`touµ”
(mode[i]);

1244 
ãedbackSize
 = 
mode
 =ğ"CFB" ? 
	`©oi
(
f’ame
.
	`sub¡r
(f’ame.
	`fšd_fœ¡_of
("0123456789")).
	`c_¡r
()) : 0;

1245 
¡d
::
¡ršg
 
‹¡
;

1246 ià(
®gÜ™hm
 == "DSA" ||‡lgorithm == "ECDSA")

1247 
‹¡
 = 
f’ame
.
	`sub¡r
(0, f’ame.
	`size
() - 4);

1248 ià(
®gÜ™hm
 == "RSA")

1249 
‹¡
 = 
f’ame
.
	`sub¡r
(3, 3);

1250 ià(
f’ame
.
	`fšd
("MÚ‹"è!ğ
¡d
::
¡ršg
::
Åos
)

1251 
‹¡
 = "MONTE";

1252 ià(
f’ame
.
	`fšd
("MCT"è!ğ
¡d
::
¡ršg
::
Åos
)

1253 
‹¡
 = "MCT";

1255 
‹¡
 = "KAT";

1256 
boŞ
 
’üy±
 = (
f’ame
.
	`fšd
("vrù"è=ğ
¡d
::
¡ršg
::
Åos
);

1258 
Bufã»dT¿nsfÜm©iÚ
 *
pSšk
 = 
NULL
;

1260 ià(
¬gc
 > 3)

1262 
¡d
::
¡ršg
 
outDœ
 = 
¬gv
[3];

1264 ià(
outDœ
 == "auto")

1266 ià(
dœÇme
.
	`sub¡r
(dœÇme.
	`size
()-3) == "req")

1267 
outDœ
 = 
dœÇme
.
	`sub¡r
(0, dœÇme.
	`size
()-3) + "resp";

1270 ià(*
outDœ
.
	`rbegš
() != '\\' && *outDir.rbegin() != '/')

1271 
outDœ
 += '/';

1272 
¡d
::
¡ršg
 
outP©hÇme
 = 
outDœ
 + 
f’ame
.
	`sub¡r
(0, f’ame.
	`size
() - 3) + "rsp";

1273 
pSšk
 = 
Ãw
 
	`FeSšk
(
outP©hÇme
.
	`c_¡r
(), 
çl£
);

1276 
pSšk
 = 
Ãw
 
	`FeSšk
(
cout
);

1278 
	`FeSourû
(
·thÇme
.
	`c_¡r
(), 
Œue
, 
Ãw
 
	`LšeB»akP¬£r
Òew 
	`Te¡D©aP¬£r
(
®gÜ™hm
, 
‹¡
, 
mode
, 
ãedbackSize
, 
’üy±
, 
pSšk
)), 
çl£
);

1280 
	`ÿtch
 (...)

1282 
cout
 << "fe: " << 
f’ame
 << 
’dl
;

1283 
throw
;

1286 
	}
}

1288 (*
AdhocTe¡
)(
¬gc
, *
¬gv
[]);

1289 
s_i
 = (
AdhocTe¡
 = &
FIPS_140_AlgÜ™hmTe¡
, 0);

	@fipstest.cpp

3 
	~"pch.h
"

5 #iâdeà
CRYPTOPP_IMPORTS


7 
	#CRYPTOPP_DEFAULT_NO_DLL


	)

8 
	~"dÎ.h
"

10 #ifdeà
CRYPTOPP_WIN32_AVAILABLE


11 
	#_WIN32_WINNT
 0x0400

	)

12 
	~<wšdows.h
>

14 #ià
defšed
(
_MSC_VER
) && _MSC_VER >= 1400

15 #ifdeà
_M_IX86


16 
	#_CRT_DEBUGGER_HOOK
 
_üt_debugg”_hook


	)

18 
	#_CRT_DEBUGGER_HOOK
 
__üt_debugg”_hook


	)

20 "C" {
_CRTIMP
 
__cdeş
 
_CRT_DEBUGGER_HOOK
();}

24 
	~<io¡»am
>

26 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

28 
Pow”UpS–fTe¡Stus
 
g_pow”UpS–fTe¡Stus
;

29 
SecBy‹Block
 
g_aùu®Mac
;

30 
g_macFeLoÿtiÚ
 = 0;

33 cÚ¡ 
by‹
 
s_moduËMac
[
Cry±oPP
::
HMAC
<Cry±oPP::
SHA1
>::
DIGESTSIZE
] = 
CRYPTOPP_DUMMY_DLL_MAC
;

34 
	`CRYPTOPP_COMPILE_ASSERT
((
s_moduËMac
è=ğ
Cry±oPP
::
SHA1
::
DIGESTSIZE
);

36 #ifdeà
CRYPTOPP_WIN32_AVAILABLE


37 
HMODULE
 
s_hModuË
 = 
NULL
;

40 cÚ¡ 
by‹
 * 
CRYPTOPP_API
 
	$G‘Aùu®MacAndLoÿtiÚ
(&
macSize
, &
feLoÿtiÚ
)

42 
macSize
 = ()
g_aùu®Mac
.
	`size
();

43 
feLoÿtiÚ
 = 
g_macFeLoÿtiÚ
;

44  
g_aùu®Mac
;

45 
	}
}

47 
	$KnownAnsw”Te¡
(
RªdomNumb”G’”©Ü
 &
ºg
, cÚ¡ *
ouut
)

49 
Equ®™yCom·risÚF‹r
 
com·risÚ
;

51 
	`RªdomNumb”StÜe
(
ºg
, 
	`¡¾’
(
ouut
)/2).
	`T¿nsãrAÎTo
(
com·risÚ
, "0");

52 
	`SŒšgSourû
(
ouut
, 
Œue
, 
Ãw
 
	`HexDecod”
Òew 
	`ChªÃlSw™ch
(
com·risÚ
, "1")));

54 
com·risÚ
.
	`ChªÃlMes§geS”›sEnd
("0");

55 
com·risÚ
.
	`ChªÃlMes§geS”›sEnd
("1");

56 
	}
}

58 
	g‹m¶©e
 <
şass
 
	gCIPHER
>

59 
	$X917RNG_KnownAnsw”Te¡
(

60 cÚ¡ *
key
,

61 cÚ¡ *
£ed
,

62 cÚ¡ *
d‘”mši¡icTimeVeùÜ
,

63 cÚ¡ *
ouut
,

64 
CIPHER
 *
dummy
 = 
NULL
)

66 #ifdeà
OS_RNG_AVAILABLE


67 
¡d
::
¡ršg
 
decodedKey
, 
decodedS“d
, 
decodedD‘”mši¡icTimeVeùÜ
;

68 
	`SŒšgSourû
(
key
, 
Œue
, 
Ãw
 
	`HexDecod”
Òew 
	`SŒšgSšk
(
decodedKey
)));

69 
	`SŒšgSourû
(
£ed
, 
Œue
, 
Ãw
 
	`HexDecod”
Òew 
	`SŒšgSšk
(
decodedS“d
)));

70 
	`SŒšgSourû
(
d‘”mši¡icTimeVeùÜ
, 
Œue
, 
Ãw
 
	`HexDecod”
Òew 
	`SŒšgSšk
(
decodedD‘”mši¡icTimeVeùÜ
)));

72 
AutoS“dedX917RNG
<
CIPHER
> 
	`ºg
(
çl£
, false);

73 
ºg
.
	`Re£ed
((cÚ¡ 
by‹
 *)
decodedKey
.
	`d©a
(), decodedKey.
	`size
(), (cÚ¡ by‹ *)
decodedS“d
.d©a(), (cÚ¡ by‹ *)
decodedD‘”mši¡icTimeVeùÜ
.data());

74 
	`KnownAnsw”Te¡
(
ºg
, 
ouut
);

76 
throw
 0;

78 
	}
}

80 
	$KnownAnsw”Te¡
(
SŒ—mT¿nsfÜm©iÚ
 &
’üy±iÚ
, SŒ—mT¿nsfÜm©iÚ &
deüy±iÚ
, cÚ¡ *
¶aš‹xt
, cÚ¡ *
ch”‹xt
)

82 
Equ®™yCom·risÚF‹r
 
com·risÚ
;

84 
	`SŒšgSourû
(
¶aš‹xt
, 
Œue
, 
Ãw
 
	`HexDecod”
Òew 
	`SŒ—mT¿nsfÜm©iÚF‹r
(
’üy±iÚ
,‚ew 
	`ChªÃlSw™ch
(
com·risÚ
, "0"), 
SŒ—mT¿nsfÜm©iÚF‹r
::
NO_PADDING
)));

85 
	`SŒšgSourû
(
ch”‹xt
, 
Œue
, 
Ãw
 
	`HexDecod”
Òew 
	`ChªÃlSw™ch
(
com·risÚ
, "1")));

87 
	`SŒšgSourû
(
ch”‹xt
, 
Œue
, 
Ãw
 
	`HexDecod”
Òew 
	`SŒ—mT¿nsfÜm©iÚF‹r
(
deüy±iÚ
,‚ew 
	`ChªÃlSw™ch
(
com·risÚ
, "0"), 
SŒ—mT¿nsfÜm©iÚF‹r
::
NO_PADDING
)));

88 
	`SŒšgSourû
(
¶aš‹xt
, 
Œue
, 
Ãw
 
	`HexDecod”
Òew 
	`ChªÃlSw™ch
(
com·risÚ
, "1")));

90 
com·risÚ
.
	`ChªÃlMes§geS”›sEnd
("0");

91 
com·risÚ
.
	`ChªÃlMes§geS”›sEnd
("1");

92 
	}
}

94 
	g‹m¶©e
 <
şass
 
	gCIPHER
>

95 
	$Symm‘ricEnüy±iÚKnownAnsw”Te¡
(

96 cÚ¡ *
key
,

97 cÚ¡ *
hexIV
,

98 cÚ¡ *
¶aš‹xt
,

99 cÚ¡ *
ecb
,

100 cÚ¡ *
cbc
,

101 cÚ¡ *
cfb
,

102 cÚ¡ *
ofb
,

103 cÚ¡ *
ùr
,

104 
CIPHER
 *
dummy
 = 
NULL
)

106 
¡d
::
¡ršg
 
decodedKey
;

107 
	`SŒšgSourû
(
key
, 
Œue
, 
Ãw
 
	`HexDecod”
Òew 
	`SŒšgSšk
(
decodedKey
)));

109 
ty³Çme
 
CIPHER
::
Enüy±iÚ
 
	`’üy±iÚ
((cÚ¡ 
by‹
 *)
decodedKey
.
	`d©a
(), decodedKey.
	`size
());

110 
ty³Çme
 
CIPHER
::
Deüy±iÚ
 
	`deüy±iÚ
((cÚ¡ 
by‹
 *)
decodedKey
.
	`d©a
(), decodedKey.
	`size
());

112 
SecBy‹Block
 
	`iv
(
’üy±iÚ
.
	`BlockSize
());

113 
	`SŒšgSourû
(
hexIV
, 
Œue
, 
Ãw
 
	`HexDecod”
Òew 
	`A¼aySšk
(
iv
, iv.
	`size
())));

115 ià(
ecb
)

116 
	`KnownAnsw”Te¡
(
ECB_Mode_Ex‹º®Ch”
::
	`Enüy±iÚ
(
’üy±iÚ
).
	`Ref
(), ECB_Mode_Ex‹º®Ch”::
	`Deüy±iÚ
(
deüy±iÚ
).Ref(), 
¶aš‹xt
, 
ecb
);

117 ià(
cbc
)

118 
	`KnownAnsw”Te¡
(
CBC_Mode_Ex‹º®Ch”
::
	`Enüy±iÚ
(
’üy±iÚ
, 
iv
).
	`Ref
(), CBC_Mode_Ex‹º®Ch”::
	`Deüy±iÚ
(
deüy±iÚ
, iv).Ref(), 
¶aš‹xt
, 
cbc
);

119 ià(
cfb
)

120 
	`KnownAnsw”Te¡
(
CFB_Mode_Ex‹º®Ch”
::
	`Enüy±iÚ
(
’üy±iÚ
, 
iv
).
	`Ref
(), CFB_Mode_Ex‹º®Ch”::
	`Deüy±iÚ
Ónüy±iÚ, iv).Ref(), 
¶aš‹xt
, 
cfb
);

121 ià(
ofb
)

122 
	`KnownAnsw”Te¡
(
OFB_Mode_Ex‹º®Ch”
::
	`Enüy±iÚ
(
’üy±iÚ
, 
iv
).
	`Ref
(), OFB_Mode_Ex‹º®Ch”::
	`Deüy±iÚ
Ónüy±iÚ, iv).Ref(), 
¶aš‹xt
, 
ofb
);

123 ià(
ùr
)

124 
	`KnownAnsw”Te¡
(
CTR_Mode_Ex‹º®Ch”
::
	`Enüy±iÚ
(
’üy±iÚ
, 
iv
).
	`Ref
(), CTR_Mode_Ex‹º®Ch”::
	`Deüy±iÚ
Ónüy±iÚ, iv).Ref(), 
¶aš‹xt
, 
ùr
);

125 
	}
}

127 
	$KnownAnsw”Te¡
(
HashT¿nsfÜm©iÚ
 &
hash
, cÚ¡ *
mes§ge
, cÚ¡ *
dige¡
)

129 
Equ®™yCom·risÚF‹r
 
com·risÚ
;

130 
	`SŒšgSourû
(
dige¡
, 
Œue
, 
Ãw
 
	`HexDecod”
Òew 
	`ChªÃlSw™ch
(
com·risÚ
, "1")));

131 
	`SŒšgSourû
(
mes§ge
, 
Œue
, 
Ãw
 
	`HashF‹r
(
hash
,‚ew 
	`ChªÃlSw™ch
(
com·risÚ
, "0")));

133 
com·risÚ
.
	`ChªÃlMes§geS”›sEnd
("0");

134 
com·risÚ
.
	`ChªÃlMes§geS”›sEnd
("1");

135 
	}
}

137 
	g‹m¶©e
 <
şass
 
	gHASH
>

138 
	$Secu»HashKnownAnsw”Te¡
(cÚ¡ *
mes§ge
, cÚ¡ *
dige¡
, 
HASH
 *
dummy
 = 
NULL
)

140 
HASH
 
hash
;

141 
	`KnownAnsw”Te¡
(
hash
, 
mes§ge
, 
dige¡
);

142 
	}
}

144 
	g‹m¶©e
 <
şass
 
	gMAC
>

145 
	$MAC_KnownAnsw”Te¡
(cÚ¡ *
key
, cÚ¡ *
mes§ge
, cÚ¡ *
dige¡
, 
MAC
 *
dummy
 = 
NULL
)

147 
¡d
::
¡ršg
 
decodedKey
;

148 
	`SŒšgSourû
(
key
, 
Œue
, 
Ãw
 
	`HexDecod”
Òew 
	`SŒšgSšk
(
decodedKey
)));

150 
MAC
 
	`mac
((cÚ¡ 
by‹
 *)
decodedKey
.
	`d©a
(), decodedKey.
	`size
());

151 
	`KnownAnsw”Te¡
(
mac
, 
mes§ge
, 
dige¡
);

152 
	}
}

154 
	g‹m¶©e
 <
şass
 
	gSCHEME
>

155 
	$SigÇtu»KnownAnsw”Te¡
(cÚ¡ *
key
, cÚ¡ *
mes§ge
, cÚ¡ *
sigÇtu»
, 
SCHEME
 *
dummy
 = 
NULL
)

157 
ty³Çme
 
SCHEME
::
SigÃr
 
	`sigÃr
(
	`SŒšgSourû
(
key
, 
Œue
, 
Ãw
 
HexDecod”
).
	`Ref
());

158 
ty³Çme
 
SCHEME
::
V”if›r
 
	`v”if›r
(
sigÃr
);

160 
RªdomPoŞ
 
ºg
;

161 
Equ®™yCom·risÚF‹r
 
com·risÚ
;

163 
	`SŒšgSourû
(
mes§ge
, 
Œue
, 
Ãw
 
	`SigÃrF‹r
(
ºg
, 
sigÃr
,‚ew 
	`ChªÃlSw™ch
(
com·risÚ
, "0")));

164 
	`SŒšgSourû
(
sigÇtu»
, 
Œue
, 
Ãw
 
	`HexDecod”
Òew 
	`ChªÃlSw™ch
(
com·risÚ
, "1")));

166 
com·risÚ
.
	`ChªÃlMes§geS”›sEnd
("0");

167 
com·risÚ
.
	`ChªÃlMes§geS”›sEnd
("1");

169 
V”if›rF‹r
 
	`v”if›rF‹r
(
v”if›r
, 
NULL
, V”if›rF‹r::
SIGNATURE_AT_BEGIN
 | V”if›rF‹r::
THROW_EXCEPTION
);

170 
	`SŒšgSourû
(
sigÇtu»
, 
Œue
, 
Ãw
 
	`HexDecod”
Òew 
	`RedœeùÜ
(
v”if›rF‹r
, 
RedœeùÜ
::
DATA_ONLY
)));

171 
	`SŒšgSourû
(
mes§ge
, 
Œue
, 
Ãw
 
	`RedœeùÜ
(
v”if›rF‹r
));

172 
	}
}

174 
	$Enüy±iÚPaœwi£CÚsi¡’cyTe¡
(cÚ¡ 
PK_Enüy±Ü
 &
’üy±Ü
, cÚ¡ 
PK_Deüy±Ü
 &
deüy±Ü
)

176 
Œy


178 
RªdomPoŞ
 
ºg
;

179 cÚ¡ *
‹¡Mes§ge
 ="test message";

180 
¡d
::
¡ršg
 
ch”‹xt
, 
deüy±ed
;

182 
	`SŒšgSourû
(

183 
‹¡Mes§ge
,

184 
Œue
,

185 
Ãw
 
	`PK_Enüy±ÜF‹r
(

186 
ºg
,

187 
’üy±Ü
,

188 
Ãw
 
	`SŒšgSšk
(
ch”‹xt
)));

190 ià(
ch”‹xt
 =ğ
‹¡Mes§ge
)

191 
throw
 0;

193 
	`SŒšgSourû
(

194 
ch”‹xt
,

195 
Œue
,

196 
Ãw
 
	`PK_Deüy±ÜF‹r
(

197 
ºg
,

198 
deüy±Ü
,

199 
Ãw
 
	`SŒšgSšk
(
deüy±ed
)));

201 ià(
deüy±ed
 !ğ
‹¡Mes§ge
)

202 
throw
 0;

204 
	`ÿtch
 (...)

206 
throw
 
	`S–fTe¡Fau»
(
’üy±Ü
.
	`AlgÜ™hmName
() + ":…airwise consistencyest failed");

208 
	}
}

210 
	$SigÇtu»Paœwi£CÚsi¡’cyTe¡
(cÚ¡ 
PK_SigÃr
 &
sigÃr
, cÚ¡ 
PK_V”if›r
 &
v”if›r
)

212 
Œy


214 
RªdomPoŞ
 
ºg
;

216 
	`SŒšgSourû
(

218 
Œue
,

219 
Ãw
 
	`SigÃrF‹r
(

220 
ºg
,

221 
sigÃr
,

222 
Ãw
 
	`V”if›rF‹r
(
v”if›r
, 
NULL
, 
V”if›rF‹r
::
THROW_EXCEPTION
),

223 
Œue
));

225 
	`ÿtch
 (...)

227 
throw
 
	`S–fTe¡Fau»
(
sigÃr
.
	`AlgÜ™hmName
() + ":…airwise consistencyest failed");

229 
	}
}

231 
	g‹m¶©e
 <
şass
 
	gSCHEME
>

232 
	$SigÇtu»Paœwi£CÚsi¡’cyTe¡
(cÚ¡ *
key
, 
SCHEME
 *
dummy
 = 
NULL
)

234 
ty³Çme
 
SCHEME
::
SigÃr
 
	`sigÃr
(
	`SŒšgSourû
(
key
, 
Œue
, 
Ãw
 
HexDecod”
).
	`Ref
());

235 
ty³Çme
 
SCHEME
::
V”if›r
 
	`v”if›r
(
sigÃr
);

237 
	`SigÇtu»Paœwi£CÚsi¡’cyTe¡
(
sigÃr
, 
v”if›r
);

238 
	}
}

240 
Mes§geAuth’tiÿtiÚCode
 * 
	$NewIÁegr™yCheckšgMAC
()

242 
by‹
 
key
[] = {0x47, 0x1E, 0x33, 0x96, 0x65, 0xB1, 0x6A, 0xED, 0x0B, 0xF8, 0x6B, 0xFD, 0x01, 0x65, 0x05, 0xCC};

243  
Ãw
 
HMAC
<
SHA1
>(
key
, (key));

244 
	}
}

246 
boŞ
 
	$IÁegr™yCheckModuË
(cÚ¡ *
moduËF’ame
, cÚ¡ 
by‹
 *
ex³ùedModuËMac
, 
SecBy‹Block
 *
pAùu®Mac
, *
pMacFeLoÿtiÚ
)

248 
¡d
::
auto_±r
<
Mes§geAuth’tiÿtiÚCode
> 
	`mac
(
	`NewIÁegr™yCheckšgMAC
());

249 
macSize
 = 
mac
->
	`Dige¡Size
();

251 
SecBy‹Block
 
‹mpMac
;

252 
SecBy‹Block
 &
aùu®Mac
 = 
pAùu®Mac
 ? *pAùu®Maø: 
‹mpMac
;

253 
aùu®Mac
.
	`»size
(
macSize
);

255 
‹mpLoÿtiÚ
;

256 &
macFeLoÿtiÚ
 = 
pMacFeLoÿtiÚ
 ? *pMacFeLoÿtiÚ : 
‹mpLoÿtiÚ
;

257 
macFeLoÿtiÚ
 = 0;

259 
M‘”F‹r
 
	`v”if›r
(
Ãw
 
	`HashF‹r
(*
mac
,‚ew 
	`A¼aySšk
(
aùu®Mac
,‡ùu®Mac.
	`size
())));

261 
¡d
::
if¡»am
 
moduËSŒ—m
;

263 #ifdeà
CRYPTOPP_WIN32_AVAILABLE


264 
HMODULE
 
h
;

266 
moduËF’ameBuf
[
MAX_PATH
] = "";

267 ià(
moduËF’ame
 =ğ
NULL
)

269 #ià(
_MSC_VER
 >ğ1400 && !
	`defšed
(
_STLPORT_VERSION
))

270 
wch¬_t
 
wideModuËF’ame
[
MAX_PATH
];

271 ià(
	`G‘ModuËFeNameW
(
s_hModuË
, 
wideModuËF’ame
, 
MAX_PATH
) > 0)

273 
moduËSŒ—m
.
	`İ’
(
wideModuËF’ame
, 
¡d
::
ios
::
š
 | std::ios::
bš¬y
);

274 
h
 = 
	`G‘ModuËHªdËW
(
wideModuËF’ame
);

279 
	`G‘ModuËFeNameA
(
s_hModuË
, 
moduËF’ameBuf
, 
MAX_PATH
);

280 
moduËF’ame
 = 
moduËF’ameBuf
;

284 ià(
moduËF’ame
 !ğ
NULL
)

286 
moduËSŒ—m
.
	`İ’
(
moduËF’ame
, 
¡d
::
ios
::
š
 | std::ios::
bš¬y
);

287 #ifdeà
CRYPTOPP_WIN32_AVAILABLE


288 
h
 = 
	`G‘ModuËHªdËA
(
moduËF’ame
);

289 
moduËF’ame
 = 
NULL
;

294 ià(!
moduËSŒ—m
)

296 #ifdeà
CRYPTOPP_WIN32_AVAILABLE


297 
	`OuutDebugSŒšg
("Crypto++ DLL integrity check failed. Cannot open file for„eading.");

299  
çl£
;

301 
FeStÜe
 
	`fe
(
moduËSŒ—m
);

303 #ifdeà
CRYPTOPP_WIN32_AVAILABLE


305 cÚ¡ 
by‹
 *
memBa£
 = (cÚ¡ by‹ *)
h
;

306 cÚ¡ 
IMAGE_DOS_HEADER
 *
ph
 = (IMAGE_DOS_HEADER *)
memBa£
;

307 cÚ¡ 
IMAGE_NT_HEADERS
 *
phÁ
 = (IMAGE_NT_HEADERS *)(
memBa£
 + 
ph
->
e_lçÃw
);

308 cÚ¡ 
IMAGE_SECTION_HEADER
 *
phs
 = 
	`IMAGE_FIRST_SECTION
(
phÁ
);

309 
DWORD
 
nSeùiÚs
 = 
phÁ
->
FeH—d”
.
Numb”OfSeùiÚs
;

310 
size_t
 
cu¼’tFePos
 = 0;

312 
size_t
 
checksumPos
 = (
by‹
 *)&
phÁ
->
O±iÚ®H—d”
.
CheckSum
 - 
memBa£
;

313 
size_t
 
checksumSize
 = (
phÁ
->
O±iÚ®H—d”
.
CheckSum
);

314 
size_t
 
û¹ifiÿ‹TabËDœeùÜyPos
 = (
by‹
 *)&
phÁ
->
O±iÚ®H—d”
.
D©aDœeùÜy
[
IMAGE_DIRECTORY_ENTRY_SECURITY
] - 
memBa£
;

315 
size_t
 
û¹ifiÿ‹TabËDœeùÜySize
 = (
phÁ
->
O±iÚ®H—d”
.
D©aDœeùÜy
[
IMAGE_DIRECTORY_ENTRY_SECURITY
]);

316 
size_t
 
û¹ifiÿ‹TabËPos
 = 
phÁ
->
O±iÚ®H—d”
.
D©aDœeùÜy
[
IMAGE_DIRECTORY_ENTRY_SECURITY
].
Vœtu®Add»ss
;

317 
size_t
 
û¹ifiÿ‹TabËSize
 = 
phÁ
->
O±iÚ®H—d”
.
D©aDœeùÜy
[
IMAGE_DIRECTORY_ENTRY_SECURITY
].
Size
;

319 
v”if›r
.
	`AddRªgeToSk
(0, 
checksumPos
, 
checksumSize
);

320 
v”if›r
.
	`AddRªgeToSk
(0, 
û¹ifiÿ‹TabËDœeùÜyPos
, 
û¹ifiÿ‹TabËDœeùÜySize
);

321 
v”if›r
.
	`AddRªgeToSk
(0, 
û¹ifiÿ‹TabËPos
, 
û¹ifiÿ‹TabËSize
);

323 
nSeùiÚs
--)

325 
phs
->
Ch¬aù”i¡ics
)

329 
IMAGE_SCN_CNT_CODE
 | 
IMAGE_SCN_MEM_EXECUTE
 | 
IMAGE_SCN_MEM_READ
:

330 
IMAGE_SCN_CNT_INITIALIZED_DATA
 | 
IMAGE_SCN_MEM_READ
:

331 
£ùiÚSize
 = 
	`STDMIN
(
phs
->
SizeOfRawD©a
,…hs->
Misc
.
Vœtu®Size
);

332 cÚ¡ 
by‹
 *
£ùiÚMemS¹
 = 
memBa£
 + 
phs
->
Vœtu®Add»ss
;

333 
£ùiÚFeS¹
 = 
phs
->
Poš‹rToRawD©a
;

334 
size_t
 
subSeùiÚS¹
 = 0, 
ÃxtSubSeùiÚS¹
;

338 cÚ¡ 
by‹
 *
subSeùiÚMemS¹
 = 
£ùiÚMemS¹
 + 
subSeùiÚS¹
;

339 
size_t
 
subSeùiÚFeS¹
 = 
£ùiÚFeS¹
 + 
subSeùiÚS¹
;

340 
size_t
 
subSeùiÚSize
 = 
£ùiÚSize
 - 
subSeùiÚS¹
;

341 
ÃxtSubSeùiÚS¹
 = 0;

343 
’Œ›sToR—dFromDisk
[] = {
IMAGE_DIRECTORY_ENTRY_IMPORT
, 
IMAGE_DIRECTORY_ENTRY_IAT
};

344 
i
=0; i<(
’Œ›sToR—dFromDisk
)/(entriesToReadFromDisk[0]); i++)

346 cÚ¡ 
IMAGE_DATA_DIRECTORY
 &
’Œy
 = 
phÁ
->
O±iÚ®H—d”
.
D©aDœeùÜy
[
’Œ›sToR—dFromDisk
[
i
]];

347 cÚ¡ 
by‹
 *
’ŒyMemS¹
 = 
memBa£
 + 
’Œy
.
Vœtu®Add»ss
;

348 ià(
subSeùiÚMemS¹
 <ğ
’ŒyMemS¹
 &&ƒÁryMemS¹ < subSeùiÚMemS¹ + 
subSeùiÚSize
)

350 
subSeùiÚSize
 = 
’ŒyMemS¹
 - 
subSeùiÚMemS¹
;

351 
ÃxtSubSeùiÚS¹
 = 
’ŒyMemS¹
 - 
£ùiÚMemS¹
 + 
’Œy
.
Size
;

355 #ià
	`defšed
(
_MSC_VER
) && _MSC_VER >= 1400

357 ià(
	`IsDebugg”P»£Á
())

359 ià(
subSeùiÚMemS¹
 <ğ(
by‹
 *)&
_CRT_DEBUGGER_HOOK
 && (by‹ *)&_CRT_DEBUGGER_HOOK < subSeùiÚMemS¹ + 
subSeùiÚSize
)

361 
subSeùiÚSize
 = (
by‹
 *)&
_CRT_DEBUGGER_HOOK
 - 
subSeùiÚMemS¹
;

362 
ÃxtSubSeùiÚS¹
 = (
by‹
 *)&
_CRT_DEBUGGER_HOOK
 - 
£ùiÚMemS¹
 + 1;

367 ià(
subSeùiÚMemS¹
 <ğ
ex³ùedModuËMac
 &&ƒx³ùedModuËMaø< subSeùiÚMemS¹ + 
subSeùiÚSize
)

370 
macFeLoÿtiÚ
 = ()(
subSeùiÚFeS¹
 + (
ex³ùedModuËMac
 - 
subSeùiÚMemS¹
));

371 
v”if›r
.
	`AddRªgeToSk
(0, 
macFeLoÿtiÚ
, 
macSize
);

374 
fe
.
	`T¿nsãrTo
(
v”if›r
, 
subSeùiÚFeS¹
 - 
cu¼’tFePos
);

375 
v”if›r
.
	`Put
(
subSeùiÚMemS¹
, 
subSeùiÚSize
);

376 
fe
.
	`Sk
(
subSeùiÚSize
);

377 
cu¼’tFePos
 = 
subSeùiÚFeS¹
 + 
subSeùiÚSize
;

378 
subSeùiÚS¹
 = 
ÃxtSubSeùiÚS¹
;

379 } 
ÃxtSubSeùiÚS¹
 != 0);

381 
phs
++;

384 
fe
.
	`T¿nsãrAÎTo
(
v”if›r
);

386 #ifdeà
CRYPTOPP_WIN32_AVAILABLE


389 ià(!
	`V”ifyBufsEqu®
(
ex³ùedModuËMac
, 
aùu®Mac
, 
macSize
))

391 
	`OuutDebugSŒšg
("In memory integrity check failed. This may be caused by debug breakpoints or DLL„elocation.\n");

392 
moduËSŒ—m
.
	`ş—r
();

393 
moduËSŒ—m
.
	`£ekg
(0);

394 
v”if›r
.
	`In™Ÿlize
(
	`MakeP¬am‘”s
(
Name
::
	`OuutBufãr
(), 
	`By‹A¼ayP¬am‘”
(
aùu®Mac
, (ïùu®Mac.
	`size
())));

396 
v”if›r
.
	`AddRªgeToSk
(0, 
checksumPos
, 
checksumSize
);

397 
v”if›r
.
	`AddRªgeToSk
(0, 
û¹ifiÿ‹TabËDœeùÜyPos
, 
û¹ifiÿ‹TabËDœeùÜySize
);

398 
v”if›r
.
	`AddRªgeToSk
(0, 
û¹ifiÿ‹TabËPos
, 
û¹ifiÿ‹TabËSize
);

399 
v”if›r
.
	`AddRªgeToSk
(0, 
macFeLoÿtiÚ
, 
macSize
);

400 
	`FeStÜe
(
moduËSŒ—m
).
	`T¿nsãrAÎTo
(
v”if›r
);

404 ià(
	`V”ifyBufsEqu®
(
ex³ùedModuËMac
, 
aùu®Mac
, 
macSize
))

405  
Œue
;

407 #ifdeà
CRYPTOPP_WIN32_AVAILABLE


408 
¡d
::
¡ršg
 
hexMac
;

409 
	`HexEncod”
(
Ãw
 
	`SŒšgSšk
(
hexMac
)).
	`PutMes§geEnd
(
aùu®Mac
,‡ùu®Mac.
	`size
());

410 
	`OuutDebugSŒšg
((("Cry±o++ DLL iÁegr™y check faed. Aùu® MAC is: " + 
hexMac
è+ "\n").
	`c_¡r
());

412  
çl£
;

413 
	}
}

415 
	$DoPow”UpS–fTe¡
(cÚ¡ *
moduËF’ame
, cÚ¡ 
by‹
 *
ex³ùedModuËMac
)

417 
g_pow”UpS–fTe¡Stus
 = 
POWER_UP_SELF_TEST_NOT_DONE
;

418 
	`S‘Pow”UpS–fTe¡InProg»ssOnThisTh»ad
(
Œue
);

420 
Œy


422 ià(
	`FIPS_140_2_Com¶ŸnûEÇbËd
(è|| 
ex³ùedModuËMac
 !ğ
NULL
)

424 ià(!
	`IÁegr™yCheckModuË
(
moduËF’ame
, 
ex³ùedModuËMac
, &
g_aùu®Mac
, &
g_macFeLoÿtiÚ
))

425 
throw
 0;

430 
X917RNG_KnownAnsw”Te¡
<
AES
>(

436 
Symm‘ricEnüy±iÚKnownAnsw”Te¡
<
DES_EDE3
>(

446 
Symm‘ricEnüy±iÚKnownAnsw”Te¡
<
SKIPJACK
>(

456 
Symm‘ricEnüy±iÚKnownAnsw”Te¡
<
AES
>(

464 
NULL
);

466 
Symm‘ricEnüy±iÚKnownAnsw”Te¡
<
AES
>(

470 
NULL
,

471 
NULL
,

472 
NULL
,

473 
NULL
,

477 
Secu»HashKnownAnsw”Te¡
<
SHA1
>(

481 
Secu»HashKnownAnsw”Te¡
<
SHA224
>(

485 
Secu»HashKnownAnsw”Te¡
<
SHA256
>(

489 
Secu»HashKnownAnsw”Te¡
<
SHA384
>(

493 
Secu»HashKnownAnsw”Te¡
<
SHA512
>(

497 
MAC_KnownAnsw”Te¡
<
HMAC
<
SHA1
> >(

502 cÚ¡ *
keyRSA1
 =

511 cÚ¡ *
keyRSA2
 =

529 
SigÇtu»KnownAnsw”Te¡
<
RSASS
<
PKCS1v15
, 
SHA1
> >(

530 
keyRSA1
,

534 
SigÇtu»KnownAnsw”Te¡
<
RSASS_ISO
<
SHA1
> >(

535 
keyRSA2
,

542 
SigÇtu»Paœwi£CÚsi¡’cyTe¡
<
DSA
>(

545 
SigÇtu»Paœwi£CÚsi¡’cyTe¡
<
ECDSA
<
EC2N
, 
SHA1
> >(

548 
SigÇtu»Paœwi£CÚsi¡’cyTe¡
<
ECDSA
<
ECP
, 
SHA1
> >(

551 
SigÇtu»Paœwi£CÚsi¡’cyTe¡
<
RSASS
<
PSS
, 
SHA1
> >(
keyRSA1
);

553 
	`ÿtch
 (...)

555 
g_pow”UpS–fTe¡Stus
 = 
POWER_UP_SELF_TEST_FAILED
;

556 
dÚe
;

559 
g_pow”UpS–fTe¡Stus
 = 
POWER_UP_SELF_TEST_PASSED
;

561 
dÚe
:

562 
	`S‘Pow”UpS–fTe¡InProg»ssOnThisTh»ad
(
çl£
);

564 
	}
}

566 #ifdeà
CRYPTOPP_WIN32_AVAILABLE


568 
	$DoDÎPow”UpS–fTe¡
()

570 
Cry±oPP
::
	`DoPow”UpS–fTe¡
(
NULL
, 
s_moduËMac
);

571 
	}
}

575 
	$DoDÎPow”UpS–fTe¡
()

577 
throw
 
	`NÙIm¶em’‹d
("DoDllPowerUpSelfTest() only‡vailable on Windows");

578 
	}
}

582 
	gNAMESPACE_END


584 #ifdeà
CRYPTOPP_WIN32_AVAILABLE


587 
BOOL
 
APIENTRY
 
	$DÎMaš
(
HANDLE
 
hModuË
,

588 
DWORD
 
ul_»asÚ_fÜ_ÿÎ
,

589 
LPVOID
 
ÍRe£rved
)

591 ià(
ul_»asÚ_fÜ_ÿÎ
 =ğ
DLL_PROCESS_ATTACH
)

593 
Cry±oPP
::
s_hModuË
 = (
HMODULE
)
hModuË
;

594 
Cry±oPP
::
	`DoDÎPow”UpS–fTe¡
();

596  
TRUE
;

597 
	}
}

	@fltrimpl.h

1 #iâdeà
CRYPTOPP_FLTRIMPL_H


2 
	#CRYPTOPP_FLTRIMPL_H


	)

4 
	#FILTER_BEGIN
 \

5 
m_cÚtšueAt
) \

8 
m_šputPos™iÚ
 = 0;

	)

10 
	#FILTER_END_NO_MESSAGE_END_NO_RETURN
 \

13 
	`as£¹
(
çl£
); \

14 }

	)

16 
	#FILTER_END_NO_MESSAGE_END
 \

17 
FILTER_END_NO_MESSAGE_END_NO_RETURN
 \

18  0;

	)

28 
	#FILTER_OUTPUT3
(
s™e
, 
¡©em’t
, 
ouut
, 
Ëngth
, 
mes§geEnd
, 
chªÃl
) \

30 
s™e
: \

31 
¡©em’t
; \

32 ià(
	`Ouut
(
s™e
, 
ouut
, 
Ëngth
, 
mes§geEnd
, 
blockšg
, 
chªÃl
)) \

33  
	`STDMAX
(
	`size_t
(1), 
Ëngth
-
m_šputPos™iÚ
);\

34 }

	)

36 
	#FILTER_OUTPUT2
(
s™e
, 
¡©em’t
, 
ouut
, 
Ëngth
, 
mes§geEnd
) \

37 
	`FILTER_OUTPUT3
(
s™e
, 
¡©em’t
, 
ouut
, 
Ëngth
, 
mes§geEnd
, 
DEFAULT_CHANNEL
)

	)

39 
	#FILTER_OUTPUT
(
s™e
, 
ouut
, 
Ëngth
, 
mes§geEnd
) \

40 
	`FILTER_OUTPUT2
(
s™e
, 0, 
ouut
, 
Ëngth
, 
mes§geEnd
)

	)

42 
	#FILTER_OUTPUT_BYTE
(
s™e
, 
ouut
) \

43 
	`FILTER_OUTPUT
(
s™e
, &(cÚ¡ 
by‹
 &)(by‹)
ouut
, 1, 0)

	)

45 
	#FILTER_OUTPUT2_MODIFIABLE
(
s™e
, 
¡©em’t
, 
ouut
, 
Ëngth
, 
mes§geEnd
) \

47 
s™e
: \

48 
¡©em’t
; \

49 ià(
	`OuutModifŸbË
(
s™e
, 
ouut
, 
Ëngth
, 
mes§geEnd
, 
blockšg
)) \

50  
	`STDMAX
(
	`size_t
(1), 
Ëngth
-
m_šputPos™iÚ
);\

51 }

	)

53 
	#FILTER_OUTPUT_MODIFIABLE
(
s™e
, 
ouut
, 
Ëngth
, 
mes§geEnd
) \

54 
	`FILTER_OUTPUT2_MODIFIABLE
(
s™e
, 0, 
ouut
, 
Ëngth
, 
mes§geEnd
)

	)

56 
	#FILTER_OUTPUT2_MAYBE_MODIFIABLE
(
s™e
, 
¡©em’t
, 
ouut
, 
Ëngth
, 
mes§geEnd
, 
modifŸbË
) \

58 
s™e
: \

59 
¡©em’t
; \

60 ià(
modifŸbË
 ? 
	`OuutModifŸbË
(
s™e
, 
ouut
, 
Ëngth
, 
mes§geEnd
, 
blockšg
è: 
	`Ouut
(site, output,†ength, messageEnd, blocking)) \

61  
	`STDMAX
(
	`size_t
(1), 
Ëngth
-
m_šputPos™iÚ
);\

62 }

	)

64 
	#FILTER_OUTPUT_MAYBE_MODIFIABLE
(
s™e
, 
ouut
, 
Ëngth
, 
mes§geEnd
, 
modifŸbË
) \

65 
	`FILTER_OUTPUT2_MAYBE_MODIFIABLE
(
s™e
, 0, 
ouut
, 
Ëngth
, 
mes§geEnd
, 
modifŸbË
)

	)

	@gcm.cpp

5 
	~"pch.h
"

7 #iâdeà
CRYPTOPP_IMPORTS


8 #iâdeà
CRYPTOPP_GENERATE_X64_MASM


10 
	~"gcm.h
"

11 
	~"ıu.h
"

13 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

15 
wÜd16
 
GCM_Ba£
::
s_»duùiÚTabË
[256];

16 vŞ©
boŞ
 
GCM_Ba£
::
s_»duùiÚTabËIn™Ÿlized
 = 
çl£
;

18 
GCM_Ba£
::
GCTR
::
	$Inüem’tCouÁ”By256
()

20 
	`Inüem’tCouÁ”ByOÃ
(
m_couÁ”A¼ay
+
	`BlockSize
()-4, 3);

21 
	}
}

25 
	$gcm_gf_muÉ
(cÚ¡ *
a
, cÚ¡ *
b
, *
c
)

27 
wÜd64
 
Z0
=0, 
Z1
=0, 
V0
, 
V1
;

29 
BlockG‘AndPut
<
	twÜd64
, 
	tBigEndŸn
> 
	tBlock
;

30 
Block
::
	`G‘
(
a
)(
V0
)(
V1
);

32 
i
=0; i<16; i++)

34 
j
=0x80; j!=0; j>>=1)

36 
x
 = 
b
[
i
] & 
j
;

37 
Z0
 ^ğ
x
 ? 
V0
 : 0;

38 
Z1
 ^ğ
x
 ? 
V1
 : 0;

39 
x
 = ()
V1
 & 1;

40 
V1
 = (V1>>1è| (
V0
<<63);

41 
V0
 = (V0>>1è^ (
x
 ? 
	`W64LIT
(0xe1) << 56 : 0);

44 
Block
::
	`Put
(
NULL
, 
c
)(
Z0
)(
Z1
);

45 
	}
}

47 
__m128i
 
	$_mm_şmuËpi64_si128
(cÚ¡ 
__m128i
 &
a
, cÚ¡ __m128˜&
b
, 
i
)

49 
wÜd64
 
A
[1] = {
	`By‹Rev”£
(((wÜd64*)&
a
)[
i
&1])};

50 
wÜd64
 
B
[1] = {
	`By‹Rev”£
(((wÜd64*)&
b
)[
i
>>4])};

52 
PŞynomŸlMod2
 
	`·
((
by‹
 *)
A
, 8);

53 
PŞynomŸlMod2
 
	`pb
((
by‹
 *)
B
, 8);

54 
PŞynomŸlMod2
 
c
 = 
·
*
pb
;

56 
__m128i
 
ouut
;

57 
i
=0; i<16; i++)

58 ((
by‹
 *)&
ouut
)[
i
] = 
c
.
	`G‘By‹
(i);

59  
ouut
;

60 
	}
}

63 #ià
CRYPTOPP_BOOL_SSE2_INTRINSICS_AVAILABLE
 || 
CRYPTOPP_BOOL_SSE2_ASM_AVAILABLE


64 
šlše
 
	$SSE2_XÜ16
(
by‹
 *
a
, cÚ¡ by‹ *
b
, cÚ¡ by‹ *
c
)

66 #ià
CRYPTOPP_BOOL_SSE2_INTRINSICS_AVAILABLE


67 *(
__m128i
 *)
a
 = 
	`_mm_xÜ_si128
(*(__m128˜*)
b
, *(__m128˜*)
c
);

69 
	`asm
 ("movdq¨%1, %%xmm0;…xÜ %2, %%xmm0; movdq¨%%xmm0, %0;" : "=m" (
a
[0]è: "m"(
b
[0]), "m"(
c
[0]));

71 
	}
}

74 
šlše
 
	$XÜ16
(
by‹
 *
a
, cÚ¡ by‹ *
b
, cÚ¡ by‹ *
c
)

76 ((
wÜd64
 *)
a
)[0] = ((wÜd64 *)
b
)[0] ^ ((wÜd64 *)
c
)[0];

77 ((
wÜd64
 *)
a
)[1] = ((wÜd64 *)
b
)[1] ^ ((wÜd64 *)
c
)[1];

78 
	}
}

80 #ià
CRYPTOPP_BOOL_AESNI_INTRINSICS_AVAILABLE


81 
	$CRYPTOPP_ALIGN_DATA
(16ècÚ¡ 
wÜd64
 
s_şmulCÚ¡ªts64
[] = {

82 
	`W64LIT
(0xe100000000000000), W64LIT(0xc200000000000000),

83 
	`W64LIT
(0x08090a0b0c0d0e0f), W64LIT(0x0001020304050607),

84 
	`W64LIT
(0x0001020304050607), W64LIT(0x08090a0b0c0d0e0f)
	}
};

85 cÚ¡ 
__m128i
 *
	gs_şmulCÚ¡ªts
 = (cÚ¡ __m128˜*)
s_şmulCÚ¡ªts64
;

86 cÚ¡ 
	gs_şmulTabËSizeInBlocks
 = 8;

88 
šlše
 
__m128i
 
	$CLMUL_Reduû
(
__m128i
 
c0
, __m128˜
c1
, __m128˜
c2
, cÚ¡ __m128˜&
r
)

103 
c2
 = 
	`_mm_xÜ_si128
(c2, 
	`_mm_move_•i64
(
c0
));

105 
c1
 = 
	`_mm_xÜ_si128
(c1, 
	`_mm_¦li_si128
(
c0
, 8));

107 
c1
 = 
	`_mm_xÜ_si128
(c1, 
	`_mm_şmuËpi64_si128
(
c0
, 
r
, 0x10));

108 
c0
 = 
	`_mm_¤li_si128
(c0, 8);

109 
c0
 = 
	`_mm_xÜ_si128
(c0, 
c1
);

110 
c0
 = 
	`_mm_¦li_•i64
(c0, 1);

111 
c0
 = 
	`_mm_şmuËpi64_si128
(c0, 
r
, 0);

112 
c2
 = 
	`_mm_xÜ_si128
(c2, 
c0
);

113 
c2
 = 
	`_mm_xÜ_si128
(c2, 
	`_mm_¤li_si128
(
c1
, 8));

114 
c1
 = 
	`_mm_uÅacklo_•i64
(c1, 
c2
);

115 
c1
 = 
	`_mm_¤li_•i64
(c1, 63);

116 
c2
 = 
	`_mm_¦li_•i64
(c2, 1);

117  
	`_mm_xÜ_si128
(
c2
, 
c1
);

118 
	}
}

120 
šlše
 
__m128i
 
	$CLMUL_GF_Mul
(cÚ¡ 
__m128i
 &
x
, cÚ¡ __m128˜&
h
, cÚ¡ __m128˜&
r
)

122 
__m128i
 
c0
 = 
	`_mm_şmuËpi64_si128
(
x
,
h
,0);

123 
__m128i
 
c1
 = 
	`_mm_xÜ_si128
(
	`_mm_şmuËpi64_si128
(
x
,
h
,1), _mm_clmulepi64_si128(x,h,0x10));

124 
__m128i
 
c2
 = 
	`_mm_şmuËpi64_si128
(
x
,
h
,0x11);

126  
	`CLMUL_Reduû
(
c0
, 
c1
, 
c2
, 
r
);

127 
	}
}

130 
	gGCM_Ba£
::
	$S‘KeyW™houtResync
(cÚ¡ 
by‹
 *
u£rKey
, 
size_t
 
keyËngth
, cÚ¡ 
NameV®uePaœs
 &
·¿ms
)

132 
BlockCh”
 &
blockCh”
 = 
	`AcûssBlockCh”
();

133 
blockCh”
.
	`S‘Key
(
u£rKey
, 
keyËngth
, 
·¿ms
);

135 ià(
blockCh”
.
	`BlockSize
(è!ğ
REQUIRED_BLOCKSIZE
)

136 
throw
 
	`Inv®idArgum’t
(
	`AlgÜ™hmName
() + ": block size of underlying block cipher is‚ot 16");

138 
bËSize
, 
i
, 
j
, 
k
;

140 #ià
CRYPTOPP_BOOL_AESNI_INTRINSICS_AVAILABLE


141 ià(
	`HasCLMUL
())

143 
·¿ms
.
	`G‘IÁV®ue
(
Name
::
	`TabËSize
(), 
bËSize
);

144 
bËSize
 = 
s_şmulTabËSizeInBlocks
 * 
REQUIRED_BLOCKSIZE
;

149 ià(
·¿ms
.
	`G‘IÁV®ue
(
Name
::
	`TabËSize
(), 
bËSize
))

150 
bËSize
 = (tableSize >= 64*1024) ? 64*1024 : 2*1024;

152 
bËSize
 = (
	`G‘TabËsO±iÚ
(è=ğ
GCM_64K_TabËs
) ? 64*1024 : 2*1024;

154 #ià
	`defšed
(
_MSC_VER
) && (_MSC_VER >= 1300 && _MSC_VER < 1400)

156 
bËSize
 = 2*1024;

160 
m_bufãr
.
	`»size
(3*
REQUIRED_BLOCKSIZE
 + 
bËSize
);

161 
by‹
 *
bË
 = 
	`MulTabË
();

162 
by‹
 *
hashKey
 = 
	`HashKey
();

163 
	`mem£t
(
hashKey
, 0, 
REQUIRED_BLOCKSIZE
);

164 
blockCh”
.
	`ProûssBlock
(
hashKey
);

166 #ià
CRYPTOPP_BOOL_AESNI_INTRINSICS_AVAILABLE


167 ià(
	`HasCLMUL
())

169 cÚ¡ 
__m128i
 
r
 = 
s_şmulCÚ¡ªts
[0];

170 
__m128i
 
h0
 = 
	`_mm_shufæe_•i8
(
	`_mm_lßd_si128
((__m128˜*)
hashKey
), 
s_şmulCÚ¡ªts
[1]);

171 
__m128i
 
h
 = 
h0
;

173 
i
=0; i<
bËSize
; i+=32)

175 
__m128i
 
h1
 = 
	`CLMUL_GF_Mul
(
h
, 
h0
, 
r
);

176 
	`_mm_¡Ü–_•i64
((
__m128i
 *)(
bË
+
i
), 
h
);

177 
	`_mm_¡Üeu_si128
((
__m128i
 *)(
bË
+
i
+16), 
h1
);

178 
	`_mm_¡Üeu_si128
((
__m128i
 *)(
bË
+
i
+8), 
h
);

179 
	`_mm_¡Ü–_•i64
((
__m128i
 *)(
bË
+
i
+8), 
h1
);

180 
h
 = 
	`CLMUL_GF_Mul
(
h1
, 
h0
, 
r
);

187 
wÜd64
 
V0
, 
V1
;

188 
BlockG‘AndPut
<
	twÜd64
, 
	tBigEndŸn
> 
	tBlock
;

189 
Block
::
	`G‘
(
hashKey
)(
V0
)(
V1
);

191 ià(
bËSize
 == 64*1024)

193 
i
=0; i<128; i++)

195 
k
 = 
i
%8;

196 
Block
::
	`Put
(
NULL
, 
bË
+(
i
/8)*256*16+(
	`size_t
(1)<<(11-
k
)))(
V0
)(
V1
);

198 
x
 = ()
V1
 & 1;

199 
V1
 = (V1>>1è| (
V0
<<63);

200 
V0
 = (V0>>1è^ (
x
 ? 
	`W64LIT
(0xe1) << 56 : 0);

203 
i
=0; i<16; i++)

205 
	`mem£t
(
bË
+
i
*256*16, 0, 16);

206 #ià
CRYPTOPP_BOOL_SSE2_INTRINSICS_AVAILABLE
 || 
CRYPTOPP_BOOL_SSE2_ASM_AVAILABLE


207 ià(
	`HasSSE2
())

208 
j
=2; j<=0x80; j*=2)

209 
k
=1; k<
j
; k++)

210 
	`SSE2_XÜ16
(
bË
+
i
*256*16+(
j
+
k
)*16,able+i*256*16+j*16,able+i*256*16+k*16);

213 
j
=2; j<=0x80; j*=2)

214 
k
=1; k<
j
; k++)

215 
	`XÜ16
(
bË
+
i
*256*16+(
j
+
k
)*16,able+i*256*16+j*16,able+i*256*16+k*16);

220 ià(!
s_»duùiÚTabËIn™Ÿlized
)

222 
s_»duùiÚTabË
[0] = 0;

223 
wÜd16
 
x
 = 0x01c2;

224 
s_»duùiÚTabË
[1] = 
	`By‹Rev”£
(
x
);

225 
i
=2; i<=0x80; i*=2)

227 
x
 <<= 1;

228 
s_»duùiÚTabË
[
i
] = 
	`By‹Rev”£
(
x
);

229 
j
=1; j<
i
; j++)

230 
s_»duùiÚTabË
[
i
+
j
] = s_reductionTable[i] ^ s_reductionTable[j];

232 
s_»duùiÚTabËIn™Ÿlized
 = 
Œue
;

235 
i
=0; i<128-24; i++)

237 
k
 = 
i
%32;

238 ià(
k
 < 4)

239 
Block
::
	`Put
(
NULL
, 
bË
+1024+(
i
/32)*256+(
	`size_t
(1)<<(7-
k
)))(
V0
)(
V1
);

240 ià(
k
 < 8)

241 
Block
::
	`Put
(
NULL
, 
bË
+(
i
/32)*256+(
	`size_t
(1)<<(11-
k
)))(
V0
)(
V1
);

243 
x
 = ()
V1
 & 1;

244 
V1
 = (V1>>1è| (
V0
<<63);

245 
V0
 = (V0>>1è^ (
x
 ? 
	`W64LIT
(0xe1) << 56 : 0);

248 
i
=0; i<4; i++)

250 
	`mem£t
(
bË
+
i
*256, 0, 16);

251 
	`mem£t
(
bË
+1024+
i
*256, 0, 16);

252 #ià
CRYPTOPP_BOOL_SSE2_INTRINSICS_AVAILABLE
 || 
CRYPTOPP_BOOL_SSE2_ASM_AVAILABLE


253 ià(
	`HasSSE2
())

254 
j
=2; j<=8; j*=2)

255 
k
=1; k<
j
; k++)

257 
	`SSE2_XÜ16
(
bË
+
i
*256+(
j
+
k
)*16,able+i*256+j*16,able+i*256+k*16);

258 
	`SSE2_XÜ16
(
bË
+1024+
i
*256+(
j
+
k
)*16,able+1024+i*256+j*16,able+1024+i*256+k*16);

262 
j
=2; j<=8; j*=2)

263 
k
=1; k<
j
; k++)

265 
	`XÜ16
(
bË
+
i
*256+(
j
+
k
)*16,able+i*256+j*16,able+i*256+k*16);

266 
	`XÜ16
(
bË
+1024+
i
*256+(
j
+
k
)*16,able+1024+i*256+j*16,able+1024+i*256+k*16);

270 
	}
}

272 
šlše
 
	gGCM_Ba£
::
	$Rev”£HashBufãrIfN“ded
()

274 #ià
CRYPTOPP_BOOL_AESNI_INTRINSICS_AVAILABLE


275 ià(
	`HasCLMUL
())

277 
__m128i
 &
x
 = *(__m128˜*)
	`HashBufãr
();

278 
x
 = 
	`_mm_shufæe_•i8
(x, 
s_şmulCÚ¡ªts
[1]);

281 
	}
}

283 
	gGCM_Ba£
::
	$Resync
(cÚ¡ 
by‹
 *
iv
, 
size_t
 
Ën
)

285 
BlockCh”
 &
ch”
 = 
	`AcûssBlockCh”
();

286 
by‹
 *
hashBufãr
 = 
	`HashBufãr
();

288 ià(
Ën
 == 12)

290 
	`memıy
(
hashBufãr
, 
iv
, 
Ën
);

291 
	`mem£t
(
hashBufãr
+
Ën
, 0, 3);

292 
hashBufãr
[
Ën
+3] = 1;

296 
size_t
 
ÜigL’
 = 
Ën
;

297 
	`mem£t
(
hashBufãr
, 0, 
HASH_BLOCKSIZE
);

299 ià(
Ën
 >ğ
HASH_BLOCKSIZE
)

301 
Ën
 = 
GCM_Ba£
::
	`Auth’tiÿ‹Blocks
(
iv
,†en);

302 
iv
 +ğ(
ÜigL’
 - 
Ën
);

305 ià(
Ën
 > 0)

307 
	`memıy
(
m_bufãr
, 
iv
, 
Ën
);

308 
	`mem£t
(
m_bufãr
+
Ën
, 0, 
HASH_BLOCKSIZE
-len);

309 
GCM_Ba£
::
	`Auth’tiÿ‹Blocks
(
m_bufãr
, 
HASH_BLOCKSIZE
);

312 
PutBlock
<
wÜd64
, 
BigEndŸn
, 
Œue
>(
NULL
, 
m_bufãr
)(0)(
ÜigL’
*8);

313 
GCM_Ba£
::
	`Auth’tiÿ‹Blocks
(
m_bufãr
, 
HASH_BLOCKSIZE
);

315 
	`Rev”£HashBufãrIfN“ded
();

318 ià(
m_¡©e
 >ğ
S‹_IVS‘
)

319 
m_ùr
.
	`ResynchrÚize
(
hashBufãr
, 
REQUIRED_BLOCKSIZE
);

321 
m_ùr
.
	`S‘Ch”W™hIV
(
ch”
, 
hashBufãr
);

323 
m_ùr
.
	`S“k
(
HASH_BLOCKSIZE
);

325 
	`mem£t
(
hashBufãr
, 0, 
HASH_BLOCKSIZE
);

326 
	}
}

328 
	gGCM_Ba£
::
	$O±im®D©aAlignm’t
() const

331 #ià
CRYPTOPP_BOOL_SSE2_ASM_AVAILABLE
 || 
	`defšed
(
CRYPTOPP_X64_MASM_AVAILABLE
)

332 
	`HasSSE2
() ? 16 :

334 
	`G‘BlockCh”
().
	`O±im®D©aAlignm’t
();

335 
	}
}

337 #´agm¨
w¬nšg
(
di§bË
: 4731)

341 #ifdeà
CRYPTOPP_X64_MASM_AVAILABLE


343 
GCM_Auth’tiÿ‹Blocks_2K
(cÚ¡ 
by‹
 *
d©a
, 
size_t
 
blocks
, 
wÜd64
 *
hashBufãr
, cÚ¡ 
wÜd16
 *
»duùiÚTabË
);

344 
GCM_Auth’tiÿ‹Blocks_64K
(cÚ¡ 
by‹
 *
d©a
, 
size_t
 
blocks
, 
wÜd64
 *
hashBufãr
);

348 #iâdeà
CRYPTOPP_GENERATE_X64_MASM


350 
size_t
 
GCM_Ba£
::
	$Auth’tiÿ‹Blocks
(cÚ¡ 
by‹
 *
d©a
, 
size_t
 
Ën
)

352 #ià
CRYPTOPP_BOOL_AESNI_INTRINSICS_AVAILABLE


353 ià(
	`HasCLMUL
())

355 cÚ¡ 
__m128i
 *
bË
 = (cÚ¡ __m128˜*)
	`MulTabË
();

356 
__m128i
 
x
 = 
	`_mm_lßd_si128
((__m128˜*)
	`HashBufãr
());

357 cÚ¡ 
__m128i
 
r
 = 
s_şmulCÚ¡ªts
[0], 
bsw­Mask
 = s_şmulCÚ¡ªts[1], 
bsw­Mask2
 = s_clmulConstants[2];

359 
Ën
 >= 16)

361 
size_t
 
s
 = 
	`UnsigÃdMš
(
Ën
/16, 
s_şmulTabËSizeInBlocks
), 
i
=0;

362 
__m128i
 
d
, 
d2
 = 
	`_mm_shufæe_•i8
(
	`_mm_lßdu_si128
((cÚ¡ __m128˜*)(
d©a
+(
s
-1)*16)), 
bsw­Mask2
);;

363 
__m128i
 
c0
 = 
	`_mm_£tz”o_si128
();

364 
__m128i
 
c1
 = 
	`_mm_£tz”o_si128
();

365 
__m128i
 
c2
 = 
	`_mm_£tz”o_si128
();

367 
Œue
)

369 
__m128i
 
h0
 = 
	`_mm_lßd_si128
(
bË
+
i
);

370 
__m128i
 
h1
 = 
	`_mm_lßd_si128
(
bË
+
i
+1);

371 
__m128i
 
h01
 = 
	`_mm_xÜ_si128
(
h0
, 
h1
);

373 ià(++
i
 =ğ
s
)

375 
d
 = 
	`_mm_shufæe_•i8
(
	`_mm_lßdu_si128
((cÚ¡ 
__m128i
 *)
d©a
), 
bsw­Mask
);

376 
d
 = 
	`_mm_xÜ_si128
(d, 
x
);

377 
c0
 = 
	`_mm_xÜ_si128
(c0, 
	`_mm_şmuËpi64_si128
(
d
, 
h0
, 0));

378 
c2
 = 
	`_mm_xÜ_si128
(c2, 
	`_mm_şmuËpi64_si128
(
d
, 
h1
, 1));

379 
d
 = 
	`_mm_xÜ_si128
(d, 
	`_mm_shufæe_•i32
(d, 
	`_MM_SHUFFLE
(1, 0, 3, 2)));

380 
c1
 = 
	`_mm_xÜ_si128
(c1, 
	`_mm_şmuËpi64_si128
(
d
, 
h01
, 0));

384 
d
 = 
	`_mm_shufæe_•i8
(
	`_mm_lßdu_si128
((cÚ¡ 
__m128i
 *)(
d©a
+(
s
-
i
)*16-8)), 
bsw­Mask2
);

385 
c0
 = 
	`_mm_xÜ_si128
(c0, 
	`_mm_şmuËpi64_si128
(
d2
, 
h0
, 1));

386 
c2
 = 
	`_mm_xÜ_si128
(c2, 
	`_mm_şmuËpi64_si128
(
d
, 
h1
, 1));

387 
d2
 = 
	`_mm_xÜ_si128
(d2, 
d
);

388 
c1
 = 
	`_mm_xÜ_si128
(c1, 
	`_mm_şmuËpi64_si128
(
d2
, 
h01
, 1));

390 ià(++
i
 =ğ
s
)

392 
d
 = 
	`_mm_shufæe_•i8
(
	`_mm_lßdu_si128
((cÚ¡ 
__m128i
 *)
d©a
), 
bsw­Mask
);

393 
d
 = 
	`_mm_xÜ_si128
(d, 
x
);

394 
c0
 = 
	`_mm_xÜ_si128
(c0, 
	`_mm_şmuËpi64_si128
(
d
, 
h0
, 0x10));

395 
c2
 = 
	`_mm_xÜ_si128
(c2, 
	`_mm_şmuËpi64_si128
(
d
, 
h1
, 0x11));

396 
d
 = 
	`_mm_xÜ_si128
(d, 
	`_mm_shufæe_•i32
(d, 
	`_MM_SHUFFLE
(1, 0, 3, 2)));

397 
c1
 = 
	`_mm_xÜ_si128
(c1, 
	`_mm_şmuËpi64_si128
(
d
, 
h01
, 0x10));

401 
d2
 = 
	`_mm_shufæe_•i8
(
	`_mm_lßdu_si128
((cÚ¡ 
__m128i
 *)(
d©a
+(
s
-
i
)*16-8)), 
bsw­Mask
);

402 
c0
 = 
	`_mm_xÜ_si128
(c0, 
	`_mm_şmuËpi64_si128
(
d
, 
h0
, 0x10));

403 
c2
 = 
	`_mm_xÜ_si128
(c2, 
	`_mm_şmuËpi64_si128
(
d2
, 
h1
, 0x10));

404 
d
 = 
	`_mm_xÜ_si128
(d, 
d2
);

405 
c1
 = 
	`_mm_xÜ_si128
(c1, 
	`_mm_şmuËpi64_si128
(
d
, 
h01
, 0x10));

407 
d©a
 +ğ
s
*16;

408 
Ën
 -ğ
s
*16;

410 
c1
 = 
	`_mm_xÜ_si128
(_mm_xÜ_si128(c1, 
c0
), 
c2
);

411 
x
 = 
	`CLMUL_Reduû
(
c0
, 
c1
, 
c2
, 
r
);

414 
	`_mm_¡Üe_si128
((
__m128i
 *)
	`HashBufãr
(), 
x
);

415  
Ën
;

419 
BlockG‘AndPut
<
	twÜd64
, 
	tN©iveBy‹Ord”
> 
	tBlock
;

420 
wÜd64
 *
hashBufãr
 = (wÜd64 *)
	`HashBufãr
();

422 2*(
m_bufãr
.
	`size
()>=64*1024)

423 #ià
CRYPTOPP_BOOL_SSE2_ASM_AVAILABLE
 || 
	`defšed
(
CRYPTOPP_X64_MASM_AVAILABLE
)

424 + 
	`HasSSE2
()

430 
by‹
 *
bË
 = 
	`MulTabË
();

431 
wÜd64
 
x0
 = 
hashBufãr
[0], 
x1
 = hashBuffer[1];

435 
wÜd64
 
y0
, 
y1
, 
a0
, 
a1
, 
b0
, 
b1
, 
c0
, 
c1
, 
d0
, 
d1
;

436 
Block
::
	`G‘
(
d©a
)(
y0
)(
y1
);

437 
x0
 ^ğ
y0
;

438 
x1
 ^ğ
y1
;

440 
d©a
 +ğ
HASH_BLOCKSIZE
;

441 
Ën
 -ğ
HASH_BLOCKSIZE
;

443 
	#READ_TABLE_WORD64_COMMON
(
a
, 
b
, 
c
, 
d
è*(
wÜd64
 *)(
bË
+×*1024)+(b*256)+c+d*8)

	)

445 #ifdeà
IS_LITTLE_ENDIAN


446 #ià
CRYPTOPP_BOOL_SLOW_WORD64


447 
wÜd32
 
z0
 = (wÜd32)
x0
;

448 
wÜd32
 
z1
 = (wÜd32)(
x0
>>32);

449 
wÜd32
 
z2
 = (wÜd32)
x1
;

450 
wÜd32
 
z3
 = (wÜd32)(
x1
>>32);

451 
	#READ_TABLE_WORD64
(
a
, 
b
, 
c
, 
d
, 
e
è
	`READ_TABLE_WORD64_COMMON
((d%2), c, (d?(
z
##c>>((d?d-1:0)*4))&0xf0:(z##c&0xf)<<4),ƒ)

	)

453 
	#READ_TABLE_WORD64
(
a
, 
b
, 
c
, 
d
, 
e
è
	`READ_TABLE_WORD64_COMMON
((d%2), c, ((d+8*b)?(
x
##a>>(((d+8*b)?(d+8*b)-1:1)*4))&0xf0:(x##a&0xf)<<4),ƒ)

	)

455 
	#GF_MOST_SIG_8BITS
(
a
è×##1 >> 7*8)

	)

456 
	#GF_SHIFT_8
(
a
èa##1 = (a##1 << 8è^ (a##0 >> 7*8);‡##0 <<ğ8;

	)

458 
	#READ_TABLE_WORD64
(
a
, 
b
, 
c
, 
d
, 
e
è
	`READ_TABLE_WORD64_COMMON
((1-d%2), c, ((15-d-8*b)?(
x
##a>>(((15-d-8*b)?(15-d-8*b)-1:0)*4))&0xf0:(x##a&0xf)<<4),ƒ)

	)

459 
	#GF_MOST_SIG_8BITS
(
a
è×##1 & 0xff)

	)

460 
	#GF_SHIFT_8
(
a
èa##1 = (a##1 >> 8è^ (a##0 << 7*8);‡##0 >>ğ8;

	)

463 
	#GF_MUL_32BY128
(
İ
, 
a
, 
b
, 
c
è\

	)

464 
a0
 
İ
 
	`READ_TABLE_WORD64
(
a
, 
b
, 
c
, 0, 0) ^ READ_TABLE_WORD64(a, b, c, 1, 0);\

465 
a1
 
İ
 
	`READ_TABLE_WORD64
(
a
, 
b
, 
c
, 0, 1) ^ READ_TABLE_WORD64(a, b, c, 1, 1);\

466 
b0
 
İ
 
	`READ_TABLE_WORD64
(
a
, 
b
, 
c
, 2, 0) ^ READ_TABLE_WORD64(a, b, c, 3, 0);\

467 
b1
 
İ
 
	`READ_TABLE_WORD64
(
a
, 
b
, 
c
, 2, 1) ^ READ_TABLE_WORD64(a, b, c, 3, 1);\

468 
c0
 
İ
 
	`READ_TABLE_WORD64
(
a
, 
b
, 
c
, 4, 0) ^ READ_TABLE_WORD64(a, b, c, 5, 0);\

469 
c1
 
İ
 
	`READ_TABLE_WORD64
(
a
, 
b
, 
c
, 4, 1) ^ READ_TABLE_WORD64(a, b, c, 5, 1);\

470 
d0
 
İ
 
	`READ_TABLE_WORD64
(
a
, 
b
, 
c
, 6, 0) ^ READ_TABLE_WORD64(a, b, c, 7, 0);\

471 
d1
 
İ
 
	`READ_TABLE_WORD64
(
a
, 
b
, 
c
, 6, 1) ^ READ_TABLE_WORD64(a, b, c, 7, 1);\

473 
	`GF_MUL_32BY128
(=, 0, 0, 0)

474 
	`GF_MUL_32BY128
(^=, 0, 1, 1)

475 
	`GF_MUL_32BY128
(^=, 1, 0, 2)

476 
	`GF_MUL_32BY128
(^=, 1, 1, 3)

478 
wÜd32
 
r
 = (wÜd32)
s_»duùiÚTabË
[
	`GF_MOST_SIG_8BITS
(
d
)] << 16;

479 
	`GF_SHIFT_8
(
d
)

480 
c0
 ^ğ
d0
; 
c1
 ^ğ
d1
;

481 
r
 ^ğ(
wÜd32
)
s_»duùiÚTabË
[
	`GF_MOST_SIG_8BITS
(
c
)] << 8;

482 
	`GF_SHIFT_8
(
c
)

483 
b0
 ^ğ
c0
; 
b1
 ^ğ
c1
;

484 
r
 ^ğ
s_»duùiÚTabË
[
	`GF_MOST_SIG_8BITS
(
b
)];

485 
	`GF_SHIFT_8
(
b
)

486 
a0
 ^ğ
b0
; 
a1
 ^ğ
b1
;

487 
a0
 ^ğ
CÚd™iÚ®By‹Rev”£
<
wÜd64
>(
LITTLE_ENDIAN_ORDER
, 
r
);

488 
x0
 = 
a0
; 
x1
 = 
a1
;

490 
Ën
 >ğ
HASH_BLOCKSIZE
);

492 
hashBufãr
[0] = 
x0
; hashBufãr[1] = 
x1
;

493  
Ën
;

498 
by‹
 *
bË
 = 
	`MulTabË
();

499 
wÜd64
 
x0
 = 
hashBufãr
[0], 
x1
 = hashBuffer[1];

503 
wÜd64
 
y0
, 
y1
, 
a0
, 
a1
;

504 
Block
::
	`G‘
(
d©a
)(
y0
)(
y1
);

505 
x0
 ^ğ
y0
;

506 
x1
 ^ğ
y1
;

508 
d©a
 +ğ
HASH_BLOCKSIZE
;

509 
Ën
 -ğ
HASH_BLOCKSIZE
;

511 #undeà
READ_TABLE_WORD64_COMMON


512 #undeà
READ_TABLE_WORD64


514 
	#READ_TABLE_WORD64_COMMON
(
a
, 
c
, 
d
è*(
wÜd64
 *)(
bË
+×)*256*16+(c)+(d)*8)

	)

516 #ifdeà
IS_LITTLE_ENDIAN


517 #ià
CRYPTOPP_BOOL_SLOW_WORD64


518 
wÜd32
 
z0
 = (wÜd32)
x0
;

519 
wÜd32
 
z1
 = (wÜd32)(
x0
>>32);

520 
wÜd32
 
z2
 = (wÜd32)
x1
;

521 
wÜd32
 
z3
 = (wÜd32)(
x1
>>32);

522 
	#READ_TABLE_WORD64
(
b
, 
c
, 
d
, 
e
è
	`READ_TABLE_WORD64_COMMON
(c*4+d, (d?(
z
##c>>((d?d:1)*8-4))&0xff0:(z##c&0xff)<<4),ƒ)

	)

524 
	#READ_TABLE_WORD64
(
b
, 
c
, 
d
, 
e
è
	`READ_TABLE_WORD64_COMMON
(c*4+d, ((d+4*(c%2))?(
x
##b>>(((d+4*(c%2))?(d+4*(c%2)):1)*8-4))&0xff0:(x##b&0xff)<<4),ƒ)

	)

527 
	#READ_TABLE_WORD64
(
b
, 
c
, 
d
, 
e
è
	`READ_TABLE_WORD64_COMMON
(c*4+d, ((7-d-4*(c%2))?(
x
##b>>(((7-d-4*(c%2))?(7-d-4*(c%2)):1)*8-4))&0xff0:(x##b&0xff)<<4),ƒ)

	)

530 
	#GF_MUL_8BY128
(
İ
, 
b
, 
c
, 
d
è\

	)

531 
a0
 
İ
 
	`READ_TABLE_WORD64
(
b
, 
c
, 
d
, 0);\

532 
a1
 
İ
 
	`READ_TABLE_WORD64
(
b
, 
c
, 
d
, 1);\

534 
	`GF_MUL_8BY128
(=, 0, 0, 0)

535 
	`GF_MUL_8BY128
(^=, 0, 0, 1)

536 
	`GF_MUL_8BY128
(^=, 0, 0, 2)

537 
	`GF_MUL_8BY128
(^=, 0, 0, 3)

538 
	`GF_MUL_8BY128
(^=, 0, 1, 0)

539 
	`GF_MUL_8BY128
(^=, 0, 1, 1)

540 
	`GF_MUL_8BY128
(^=, 0, 1, 2)

541 
	`GF_MUL_8BY128
(^=, 0, 1, 3)

542 
	`GF_MUL_8BY128
(^=, 1, 2, 0)

543 
	`GF_MUL_8BY128
(^=, 1, 2, 1)

544 
	`GF_MUL_8BY128
(^=, 1, 2, 2)

545 
	`GF_MUL_8BY128
(^=, 1, 2, 3)

546 
	`GF_MUL_8BY128
(^=, 1, 3, 0)

547 
	`GF_MUL_8BY128
(^=, 1, 3, 1)

548 
	`GF_MUL_8BY128
(^=, 1, 3, 2)

549 
	`GF_MUL_8BY128
(^=, 1, 3, 3)

551 
x0
 = 
a0
; 
x1
 = 
a1
;

553 
Ën
 >ğ
HASH_BLOCKSIZE
);

555 
hashBufãr
[0] = 
x0
; hashBufãr[1] = 
x1
;

556  
Ën
;

560 #ifdeà
CRYPTOPP_X64_MASM_AVAILABLE


562 
	`GCM_Auth’tiÿ‹Blocks_2K
(
d©a
, 
Ën
/16, 
hashBufãr
, 
s_»duùiÚTabË
);

563  
Ën
 % 16;

565 
	`GCM_Auth’tiÿ‹Blocks_64K
(
d©a
, 
Ën
/16, 
hashBufãr
);

566  
Ën
 % 16;

569 #ià
CRYPTOPP_BOOL_SSE2_ASM_AVAILABLE


572 #ifdeà
__GNUC__


573 
__asm__
 
__vŞ©e__


576 #–ià
	`defšed
(
CRYPTOPP_GENERATE_X64_MASM
)

577 
ALIGN
 8

578 
GCM_Auth’tiÿ‹Blocks_2K
 
PROC
 
FRAME


579 
»x_push_»g
 
rsi


580 
push_»g
 
rdi


581 
push_»g
 
rbx


582 .
’d´Şog


583 
mov
 
rsi
, 
r8


584 
mov
 
r11
, 
r9


586 
	`AS2
Ğ
mov
 
	`WORD_REG
(
cx
), 
d©a
 )

587 
	`AS2
Ğ
mov
 
	`WORD_REG
(
dx
), 
Ën
 )

588 
	`AS2
Ğ
mov
 
	`WORD_REG
(
si
), 
hashBufãr
 )

589 
	`AS2
Ğ
shr
 
	`WORD_REG
(
dx
), 4 )

592 
	`AS_PUSH_IF86
Ğ
bx
)

593 
	`AS_PUSH_IF86
Ğ
bp
)

595 #ifdeà
__GNUC__


596 
	`AS2
Ğ
mov
 
AS_REG_7
, 
	`WORD_REG
(
di
))

597 #–ià
CRYPTOPP_BOOL_X86


598 
	`AS2
Ğ
Ëa
 
AS_REG_7
, 
s_»duùiÚTabË
)

601 
	`AS2
Ğ
movdqa
 
xmm0
, [
	`WORD_REG
(
si
)] )

603 
	#MUL_TABLE_0
 
	`WORD_REG
(
si
è+ 32

	)

604 
	#MUL_TABLE_1
 
	`WORD_REG
(
si
è+ 32 + 1024

	)

605 
	#RED_TABLE
 
AS_REG_7


	)

607 
	`ASL
(0)

608 
	`AS2
Ğ
movdqu
 
xmm4
, [
	`WORD_REG
(
cx
)] )

609 
	`AS2
Ğ
pxÜ
 
xmm0
, 
xmm4
 )

611 
	`AS2
Ğ
movd
 
ebx
, 
xmm0
 )

612 
	`AS2
Ğ
mov
 
—x
, 
	`AS_HEX
(
f0f0f0f0
) )

613 
	`AS2
Ğ
ªd
 
—x
, 
ebx
 )

614 
	`AS2
Ğ
shl
 
ebx
, 4 )

615 
	`AS2
Ğ
ªd
 
ebx
, 
	`AS_HEX
(
f0f0f0f0
) )

616 
	`AS2
Ğ
movzx
 
edi
, 
ah
 )

617 
	`AS2
Ğ
movdqa
 
xmm5
, 
XMMWORD_PTR
 [
MUL_TABLE_1
 + 
	`WORD_REG
(
di
)] )

618 
	`AS2
Ğ
movzx
 
edi
, 
®
 )

619 
	`AS2
Ğ
movdqa
 
xmm4
, 
XMMWORD_PTR
 [
MUL_TABLE_1
 + 
	`WORD_REG
(
di
)] )

620 
	`AS2
Ğ
shr
 
—x
, 16 )

621 
	`AS2
Ğ
movzx
 
edi
, 
ah
 )

622 
	`AS2
Ğ
movdqa
 
xmm3
, 
XMMWORD_PTR
 [
MUL_TABLE_1
 + 
	`WORD_REG
(
di
)] )

623 
	`AS2
Ğ
movzx
 
edi
, 
®
 )

624 
	`AS2
Ğ
movdqa
 
xmm2
, 
XMMWORD_PTR
 [
MUL_TABLE_1
 + 
	`WORD_REG
(
di
)] )

626 
	#SSE2_MUL_32BITS
(
i
è\

	)

627 
	`AS2
Ğ
p¤ldq
 
xmm0
, 4 )\

628 
	`AS2
Ğ
movd
 
—x
, 
xmm0
 )\

629 
	`AS2
Ğ
ªd
 
—x
, 
	`AS_HEX
(
f0f0f0f0
) )\

630 
	`AS2
Ğ
movzx
 
edi
, 
bh
 )\

631 
	`AS2
Ğ
pxÜ
 
xmm5
, 
XMMWORD_PTR
 [
MUL_TABLE_0
 + (
i
-1)*256 + 
	`WORD_REG
(
di
)] )\

632 
	`AS2
Ğ
movzx
 
edi
, 
bl
 )\

633 
	`AS2
Ğ
pxÜ
 
xmm4
, 
XMMWORD_PTR
 [
MUL_TABLE_0
 + (
i
-1)*256 + 
	`WORD_REG
(
di
)] )\

634 
	`AS2
Ğ
shr
 
ebx
, 16 )\

635 
	`AS2
Ğ
movzx
 
edi
, 
bh
 )\

636 
	`AS2
Ğ
pxÜ
 
xmm3
, 
XMMWORD_PTR
 [
MUL_TABLE_0
 + (
i
-1)*256 + 
	`WORD_REG
(
di
)] )\

637 
	`AS2
Ğ
movzx
 
edi
, 
bl
 )\

638 
	`AS2
Ğ
pxÜ
 
xmm2
, 
XMMWORD_PTR
 [
MUL_TABLE_0
 + (
i
-1)*256 + 
	`WORD_REG
(
di
)] )\

639 
	`AS2
Ğ
movd
 
ebx
, 
xmm0
 )\

640 
	`AS2
Ğ
shl
 
ebx
, 4 )\

641 
	`AS2
Ğ
ªd
 
ebx
, 
	`AS_HEX
(
f0f0f0f0
) )\

642 
	`AS2
Ğ
movzx
 
edi
, 
ah
 )\

643 
	`AS2
Ğ
pxÜ
 
xmm5
, 
XMMWORD_PTR
 [
MUL_TABLE_1
 + 
i
*256 + 
	`WORD_REG
(
di
)] )\

644 
	`AS2
Ğ
movzx
 
edi
, 
®
 )\

645 
	`AS2
Ğ
pxÜ
 
xmm4
, 
XMMWORD_PTR
 [
MUL_TABLE_1
 + 
i
*256 + 
	`WORD_REG
(
di
)] )\

646 
	`AS2
Ğ
shr
 
—x
, 16 )\

647 
	`AS2
Ğ
movzx
 
edi
, 
ah
 )\

648 
	`AS2
Ğ
pxÜ
 
xmm3
, 
XMMWORD_PTR
 [
MUL_TABLE_1
 + 
i
*256 + 
	`WORD_REG
(
di
)] )\

649 
	`AS2
Ğ
movzx
 
edi
, 
®
 )\

650 
	`AS2
Ğ
pxÜ
 
xmm2
, 
XMMWORD_PTR
 [
MUL_TABLE_1
 + 
i
*256 + 
	`WORD_REG
(
di
)] )\

652 
	`SSE2_MUL_32BITS
(1)

653 
	`SSE2_MUL_32BITS
(2)

654 
	`SSE2_MUL_32BITS
(3)

656 
	`AS2
Ğ
movzx
 
edi
, 
bh
 )

657 
	`AS2
Ğ
pxÜ
 
xmm5
, 
XMMWORD_PTR
 [
MUL_TABLE_0
 + 3*256 + 
	`WORD_REG
(
di
)] )

658 
	`AS2
Ğ
movzx
 
edi
, 
bl
 )

659 
	`AS2
Ğ
pxÜ
 
xmm4
, 
XMMWORD_PTR
 [
MUL_TABLE_0
 + 3*256 + 
	`WORD_REG
(
di
)] )

660 
	`AS2
Ğ
shr
 
ebx
, 16 )

661 
	`AS2
Ğ
movzx
 
edi
, 
bh
 )

662 
	`AS2
Ğ
pxÜ
 
xmm3
, 
XMMWORD_PTR
 [
MUL_TABLE_0
 + 3*256 + 
	`WORD_REG
(
di
)] )

663 
	`AS2
Ğ
movzx
 
edi
, 
bl
 )

664 
	`AS2
Ğ
pxÜ
 
xmm2
, 
XMMWORD_PTR
 [
MUL_TABLE_0
 + 3*256 + 
	`WORD_REG
(
di
)] )

666 
	`AS2
Ğ
movdqa
 
xmm0
, 
xmm3
 )

667 
	`AS2
Ğ
p¦ldq
 
xmm3
, 1 )

668 
	`AS2
Ğ
pxÜ
 
xmm2
, 
xmm3
 )

669 
	`AS2
Ğ
movdqa
 
xmm1
, 
xmm2
 )

670 
	`AS2
Ğ
p¦ldq
 
xmm2
, 1 )

671 
	`AS2
Ğ
pxÜ
 
xmm5
, 
xmm2
 )

673 
	`AS2
Ğ
p¤ldq
 
xmm0
, 15 )

674 
	`AS2
Ğ
movd
 
	`WORD_REG
(
di
), 
xmm0
 )

675 
	`AS2
Ğ
movzx
 
—x
, 
WORD
 
PTR
 [
RED_TABLE
 + 
	`WORD_REG
(
di
)*2] )

676 
	`AS2
Ğ
shl
 
—x
, 8 )

678 
	`AS2
Ğ
movdqa
 
xmm0
, 
xmm5
 )

679 
	`AS2
Ğ
p¦ldq
 
xmm5
, 1 )

680 
	`AS2
Ğ
pxÜ
 
xmm4
, 
xmm5
 )

682 
	`AS2
Ğ
p¤ldq
 
xmm1
, 15 )

683 
	`AS2
Ğ
movd
 
	`WORD_REG
(
di
), 
xmm1
 )

684 
	`AS2
Ğ
xÜ
 
ax
, 
WORD
 
PTR
 [
RED_TABLE
 + 
	`WORD_REG
(
di
)*2] )

685 
	`AS2
Ğ
shl
 
—x
, 8 )

687 
	`AS2
Ğ
p¤ldq
 
xmm0
, 15 )

688 
	`AS2
Ğ
movd
 
	`WORD_REG
(
di
), 
xmm0
 )

689 
	`AS2
Ğ
xÜ
 
ax
, 
WORD
 
PTR
 [
RED_TABLE
 + 
	`WORD_REG
(
di
)*2] )

691 
	`AS2
Ğ
movd
 
xmm0
, 
—x
 )

692 
	`AS2
Ğ
pxÜ
 
xmm0
, 
xmm4
 )

694 
	`AS2
Ğ
add
 
	`WORD_REG
(
cx
), 16 )

695 
	`AS2
Ğ
sub
 
	`WORD_REG
(
dx
), 1 )

696 
	`ASJ
Ğ
jnz
, 0, 
b
 )

697 
	`AS2
Ğ
movdqa
 [
	`WORD_REG
(
si
)], 
xmm0
 )

699 
	`AS_POP_IF86
Ğ
bp
)

700 
	`AS_POP_IF86
Ğ
bx
)

702 #ifdeà
__GNUC__


705 : "c" (
d©a
), "d" (
Ën
/16), "S" (
hashBufãr
), "D" (
s_»duùiÚTabË
)

707 #ià
CRYPTOPP_BOOL_X64


711 #–ià
	`defšed
(
CRYPTOPP_GENERATE_X64_MASM
)

712 
pİ
 
rbx


713 
pİ
 
rdi


714 
pİ
 
rsi


715 
»t


716 
GCM_Auth’tiÿ‹Blocks_2K
 
ENDP


719  
Ën
%16;

723 #ifdeà
__GNUC__


724 
__asm__
 
__vŞ©e__


727 #–ià
	`defšed
(
CRYPTOPP_GENERATE_X64_MASM
)

728 
ALIGN
 8

729 
GCM_Auth’tiÿ‹Blocks_64K
 
PROC
 
FRAME


730 
»x_push_»g
 
rsi


731 
push_»g
 
rdi


732 .
’d´Şog


733 
mov
 
rsi
, 
r8


735 
	`AS2
Ğ
mov
 
	`WORD_REG
(
cx
), 
d©a
 )

736 
	`AS2
Ğ
mov
 
	`WORD_REG
(
dx
), 
Ën
 )

737 
	`AS2
Ğ
mov
 
	`WORD_REG
(
si
), 
hashBufãr
 )

738 
	`AS2
Ğ
shr
 
	`WORD_REG
(
dx
), 4 )

741 
	`AS2
Ğ
movdqa
 
xmm0
, [
	`WORD_REG
(
si
)] )

743 #undeà
MUL_TABLE


744 
	#MUL_TABLE
(
i
,
j
è
	`WORD_REG
(
si
è+ 32 + (i*4+j)*256*16

	)

746 
	`ASL
(1)

747 
	`AS2
Ğ
movdqu
 
xmm1
, [
	`WORD_REG
(
cx
)] )

748 
	`AS2
Ğ
pxÜ
 
xmm1
, 
xmm0
 )

749 
	`AS2
Ğ
pxÜ
 
xmm0
, xmm0 )

751 #undeà
SSE2_MUL_32BITS


752 
	#SSE2_MUL_32BITS
(
i
è\

	)

753 
	`AS2
Ğ
movd
 
—x
, 
xmm1
 )\

754 
	`AS2
Ğ
p¤ldq
 
xmm1
, 4 )\

755 
	`AS2
Ğ
movzx
 
edi
, 
®
 )\

756 
	`AS2
Ğ
add
 
	`WORD_REG
(
di
), WORD_REG(di) )\

757 
	`AS2
Ğ
pxÜ
 
xmm0
, [
	`MUL_TABLE
(
i
,0è+ 
	`WORD_REG
(
di
)*8] )\

758 
	`AS2
Ğ
movzx
 
edi
, 
ah
 )\

759 
	`AS2
Ğ
add
 
	`WORD_REG
(
di
), WORD_REG(di) )\

760 
	`AS2
Ğ
pxÜ
 
xmm0
, [
	`MUL_TABLE
(
i
,1è+ 
	`WORD_REG
(
di
)*8] )\

761 
	`AS2
Ğ
shr
 
—x
, 16 )\

762 
	`AS2
Ğ
movzx
 
edi
, 
®
 )\

763 
	`AS2
Ğ
add
 
	`WORD_REG
(
di
), WORD_REG(di) )\

764 
	`AS2
Ğ
pxÜ
 
xmm0
, [
	`MUL_TABLE
(
i
,2è+ 
	`WORD_REG
(
di
)*8] )\

765 
	`AS2
Ğ
movzx
 
edi
, 
ah
 )\

766 
	`AS2
Ğ
add
 
	`WORD_REG
(
di
), WORD_REG(di) )\

767 
	`AS2
Ğ
pxÜ
 
xmm0
, [
	`MUL_TABLE
(
i
,3è+ 
	`WORD_REG
(
di
)*8] )\

769 
	`SSE2_MUL_32BITS
(0)

770 
	`SSE2_MUL_32BITS
(1)

771 
	`SSE2_MUL_32BITS
(2)

772 
	`SSE2_MUL_32BITS
(3)

774 
	`AS2
Ğ
add
 
	`WORD_REG
(
cx
), 16 )

775 
	`AS2
Ğ
sub
 
	`WORD_REG
(
dx
), 1 )

776 
	`ASJ
Ğ
jnz
, 1, 
b
 )

777 
	`AS2
Ğ
movdqa
 [
	`WORD_REG
(
si
)], 
xmm0
 )

779 #ifdeà
__GNUC__


782 : "c" (
d©a
), "d" (
Ën
/16), "S" (
hashBufãr
)

785 #–ià
	`defšed
(
CRYPTOPP_GENERATE_X64_MASM
)

786 
pİ
 
rdi


787 
pİ
 
rsi


788 
»t


789 
GCM_Auth’tiÿ‹Blocks_64K
 
ENDP


792  
Ën
%16;

795 #iâdeà
CRYPTOPP_GENERATE_X64_MASM


798  
Ën
%16;

799 
	}
}

801 
GCM_Ba£
::
	$Auth’tiÿ‹La¡H—d”Block
()

803 ià(
m_bufã»dD©aL’gth
 > 0)

805 
	`mem£t
(
m_bufãr
+
m_bufã»dD©aL’gth
, 0, 
HASH_BLOCKSIZE
-m_bufferedDataLength);

806 
m_bufã»dD©aL’gth
 = 0;

807 
GCM_Ba£
::
	`Auth’tiÿ‹Blocks
(
m_bufãr
, 
HASH_BLOCKSIZE
);

809 
	}
}

811 
GCM_Ba£
::
	$Auth’tiÿ‹La¡CÚfid’tŸlBlock
()

813 
GCM_Ba£
::
	`Auth’tiÿ‹La¡H—d”Block
();

814 
PutBlock
<
wÜd64
, 
BigEndŸn
, 
Œue
>(
NULL
, 
m_bufãr
)(
m_tÙ®H—d”L’gth
*8)(
m_tÙ®Mes§geL’gth
*8);

815 
GCM_Ba£
::
	`Auth’tiÿ‹Blocks
(
m_bufãr
, 
HASH_BLOCKSIZE
);

816 
	}
}

818 
GCM_Ba£
::
	$Auth’tiÿ‹La¡FoÙ”Block
(
by‹
 *
mac
, 
size_t
 
macSize
)

820 
m_ùr
.
	`S“k
(0);

821 
	`Rev”£HashBufãrIfN“ded
();

822 
m_ùr
.
	`ProûssD©a
(
mac
, 
	`HashBufãr
(), 
macSize
);

823 
	}
}

825 
NAMESPACE_END


	@gcm.h

1 #iâdeà
CRYPTOPP_GCM_H


2 
	#CRYPTOPP_GCM_H


	)

4 
	~"auth’c.h
"

5 
	~"modes.h
"

7 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

10 
	eGCM_TabËsO±iÚ
 {
GCM_2K_TabËs
, 
GCM_64K_TabËs
};

13 şas 
	cCRYPTOPP_DLL
 
CRYPTOPP_NO_VTABLE
 
GCM_Ba£
 : 
public
 
Auth’tiÿ‹dSymm‘ricCh”Ba£


15 
public
:

17 
¡d
::
¡ršg
 
	$AlgÜ™hmName
() const

18 { 
	`G‘BlockCh”
().
	`AlgÜ™hmName
(è+ 
¡d
::
	`¡ršg
("/GCM");}

19 
size_t
 
	$MšKeyL’gth
() const

20 { 
	`G‘BlockCh”
().
	`MšKeyL’gth
();
	}
}

21 
size_t
 
	$MaxKeyL’gth
() const

22 { 
	`G‘BlockCh”
().
	`MaxKeyL’gth
();
	}
}

23 
size_t
 
	$DeçuÉKeyL’gth
() const

24 { 
	`G‘BlockCh”
().
	`DeçuÉKeyL’gth
();
	}
}

25 
size_t
 
	$G‘V®idKeyL’gth
(
size_t
 
n
) const

26 { 
	`G‘BlockCh”
().
	`G‘V®idKeyL’gth
(
n
);
	}
}

27 
boŞ
 
	$IsV®idKeyL’gth
(
size_t
 
n
) const

28 { 
	`G‘BlockCh”
().
	`IsV®idKeyL’gth
(
n
);
	}
}

29 
	$O±im®D©aAlignm’t
() const;

30 
IV_Requœem’t
 
	$IVRequœem’t
() const

31 { 
UNIQUE_IV
;
	}
}

32 
	$IVSize
() const

33 { 12;
	}
}

34 
	$MšIVL’gth
() const

35 { 1;
	}
}

36 
	$MaxIVL’gth
() const

37 { 
UINT_MAX
;
	}
}

38 
	$Dige¡Size
() const

39 { 16;
	}
}

40 
lwÜd
 
	$MaxH—d”L’gth
() const

41 { (
	`W64LIT
(1)<<61)-1;
	}
}

42 
lwÜd
 
	$MaxMes§geL’gth
() const

43 { ((
	`W64LIT
(1)<<39)-256)/8;
	}
}

45 
	g´Ùeùed
:

47 
boŞ
 
	$Auth’tiÿtiÚIsOnPÏš‹xt
() const

48 { 
çl£
;
	}
}

49 
	$Auth’tiÿtiÚBlockSize
() const

50 { 
HASH_BLOCKSIZE
;
	}
}

51 
S‘KeyW™houtResync
(cÚ¡ 
by‹
 *
u£rKey
, 
size_t
 
keyËngth
, cÚ¡ 
NameV®uePaœs
 &
·¿ms
);

52 
Resync
(cÚ¡ 
by‹
 *
iv
, 
size_t
 
Ën
);

53 
size_t
 
Auth’tiÿ‹Blocks
(cÚ¡ 
by‹
 *
d©a
, size_ˆ
Ën
);

54 
Auth’tiÿ‹La¡H—d”Block
();

55 
Auth’tiÿ‹La¡CÚfid’tŸlBlock
();

56 
Auth’tiÿ‹La¡FoÙ”Block
(
by‹
 *
mac
, 
size_t
 
macSize
);

57 
	gSymm‘ricCh”
 & 
	$AcûssSymm‘ricCh”
(è{ 
m_ùr
;
	}
}

59 
vœtu®
 
	gBlockCh”
 & 
AcûssBlockCh”
() =0;

60 
vœtu®
 
GCM_TabËsO±iÚ
 
	$G‘TabËsO±iÚ
() const =0;

62 cÚ¡ 
BlockCh”
 & 
	$G‘BlockCh”
(ècÚ¡ { 
cÚ¡_ÿ¡
<
GCM_Ba£
 *>(
this
)->
	`AcûssBlockCh”
();
	}
};

63 
by‹
 *
	$HashBufãr
(è{ 
m_bufãr
+
REQUIRED_BLOCKSIZE
;
	}
}

64 
by‹
 *
	$HashKey
(è{ 
m_bufãr
+2*
REQUIRED_BLOCKSIZE
;
	}
}

65 
by‹
 *
	$MulTabË
(è{ 
m_bufãr
+3*
REQUIRED_BLOCKSIZE
;
	}
}

66 
šlše
 
Rev”£HashBufãrIfN“ded
();

68 şas 
	cCRYPTOPP_DLL
 
	gGCTR
 : 
public
 
CTR_Mode_Ex‹º®Ch”
::
Enüy±iÚ


70 
´Ùeùed
:

71 
Inüem’tCouÁ”By256
();

74 
GCTR
 
	gm_ùr
;

75 
wÜd16
 
	gs_»duùiÚTabË
[256];

76 vŞ©
boŞ
 
	gs_»duùiÚTabËIn™Ÿlized
;

77 ’um {
	gREQUIRED_BLOCKSIZE
 = 16, 
	gHASH_BLOCKSIZE
 = 16};

81 
	g‹m¶©e
 <
şass
 
	gT_BlockCh”
, 
GCM_TabËsO±iÚ
 
	gT_TabËsO±iÚ
, 
boŞ
 
	gT_IsEnüy±iÚ
>

82 şas 
	cGCM_Fš®
 : 
public
 
GCM_Ba£


84 
public
:

85 
¡d
::
¡ršg
 
	$SticAlgÜ™hmName
()

86 { 
T_BlockCh”
::
	`SticAlgÜ™hmName
(è+ 
¡d
::
	`¡ršg
("/GCM");}

87 
boŞ
 
	$IsFÜw¬dT¿nsfÜm©iÚ
() const

88 { 
T_IsEnüy±iÚ
;
	}
}

90 
	g´iv©e
:

91 
GCM_TabËsO±iÚ
 
	$G‘TabËsO±iÚ
(ècÚ¡ { 
T_TabËsO±iÚ
;
	}
}

92 
	gBlockCh”
 & 
	$AcûssBlockCh”
(è{ 
m_ch”
;
	}
}

93 
ty³Çme
 
	gT_BlockCh”
::
Enüy±iÚ
 
m_ch”
;

97 
	g‹m¶©e
 <
şass
 
	gT_BlockCh”
, 
GCM_TabËsO±iÚ
 
	gT_TabËsO±iÚ
=
GCM_2K_TabËs
>

98 
GCM
 : 
public
 
Auth’tiÿ‹dSymm‘ricCh”Docum’tiÚ


100 
GCM_Fš®
<
	tT_BlockCh”
, 
	tT_TabËsO±iÚ
, 
	tŒue
> 
	tEnüy±iÚ
;

101 
	gGCM_Fš®
<
	tT_BlockCh”
, 
	tT_TabËsO±iÚ
, 
	tçl£
> 
	tDeüy±iÚ
;

104 
	gNAMESPACE_END


	@gf256.cpp

3 
	~"pch.h
"

4 
	~"gf256.h
"

6 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

8 
GF256
::
EËm’t
 GF256::
	$MuÉly
(
EËm’t
 
a
, EËm’ˆ
b
) const

10 
wÜd
 
»suÉ
 = 0, 
t
 = 
b
;

12 
i
=0; i<8; i++)

14 
»suÉ
 <<= 1;

15 ià(
»suÉ
 & 0x100)

16 
»suÉ
 ^ğ
m_modulus
;

18 
t
 <<= 1;

19 ià(
t
 & 0x100)

20 
»suÉ
 ^ğ
a
;

23  (
GF256
::
EËm’t
è
»suÉ
;

24 
	}
}

26 
	gGF256
::
EËm’t
 
GF256
::
	$MuÉliÿtiveInv”£
(
EËm’t
 
a
) const

28 
EËm’t
 
»suÉ
 = 
a
;

29 
i
=1; i<7; i++)

30 
»suÉ
 = 
	`MuÉly
(
	`Squ¬e
ÔesuÉ), 
a
);

31  
	`Squ¬e
(
»suÉ
);

32 
	}
}

34 
	gNAMESPACE_END


	@gf256.h

1 #iâdeà
CRYPTOPP_GF256_H


2 
	#CRYPTOPP_GF256_H


	)

4 
	~"üy±lib.h
"

6 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

9 şas 
	cGF256


11 
public
:

12 
by‹
 
	tEËm’t
;

13 
	tRªdomiz©iÚP¬am‘”
;

15 
	$GF256
(
by‹
 
modulus
è: 
	$m_modulus
(
modulus
) {}

17 
EËm’t
 
	$RªdomEËm’t
(
RªdomNumb”G’”©Ü
 &
ºg
, 
ignÜed
 = 0) const

18 { 
ºg
.
	`G’”©eBy‹
();
	}
}

20 
boŞ
 
	$Equ®
(
EËm’t
 
a
, EËm’ˆ
b
) const

21 { 
a
==
b
;
	}
}

23 
EËm’t
 
	$Z”o
() const

24 { 0;
	}
}

26 
EËm’t
 
	$Add
(
EËm’t
 
a
, EËm’ˆ
b
) const

27 { 
a
^
b
;
	}
}

29 
	gEËm’t
& 
	$AccumuÏ‹
(
EËm’t
 &
a
, EËm’ˆ
b
) const

30 { 
a
^=
b
;
	}
}

32 
EËm’t
 
	$Inv”£
(
EËm’t
 
a
) const

33 { 
a
;
	}
}

35 
EËm’t
 
	$SubŒaù
(
EËm’t
 
a
, EËm’ˆ
b
) const

36 { 
a
^
b
;
	}
}

38 
	gEËm’t
& 
	$Reduû
(
EËm’t
 &
a
, EËm’ˆ
b
) const

39 { 
a
^=
b
;
	}
}

41 
EËm’t
 
	$DoubË
(
EËm’t
 
a
) const

42 { 0;
	}
}

44 
EËm’t
 
	$OÃ
() const

45 { 1;
	}
}

47 
EËm’t
 
	$MuÉly
(
EËm’t
 
a
, EËm’ˆ
b
) const;

49 
EËm’t
 
	$Squ¬e
(
EËm’t
 
a
) const

50 { 
	`MuÉly
(
a
,‡);
	}
}

52 
boŞ
 
	$IsUn™
(
EËm’t
 
a
) const

53 { 
a
 !ğ0;
	}
}

55 
EËm’t
 
	$MuÉliÿtiveInv”£
(
EËm’t
 
a
) const;

57 
EËm’t
 
	$Divide
(
EËm’t
 
a
, EËm’ˆ
b
) const

58 { 
	`MuÉly
(
a
, 
	`MuÉliÿtiveInv”£
(
b
));
	}
}

60 
	g´iv©e
:

61 
wÜd
 
m_modulus
;

64 
	gNAMESPACE_END


	@gf2_32.cpp

3 
	~"pch.h
"

4 
	~"misc.h
"

5 
	~"gf2_32.h
"

7 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

9 
GF2_32
::
EËm’t
 GF2_32::
	$MuÉly
(
EËm’t
 
a
, EËm’ˆ
b
) const

11 
wÜd32
 
bË
[4];

12 
bË
[0] = 0;

13 
bË
[1] = 
m_modulus
;

14 ià(
a
 & 0x80000000)

16 
bË
[2] = 
m_modulus
 ^ (
a
<<1);

17 
bË
[3] = 
a
<<1;

21 
bË
[2] = 
a
<<1;

22 
bË
[3] = 
m_modulus
 ^ (
a
<<1);

25 #ià
	`CRYPTOPP_FAST_ROTATE
(32)

26 
b
 = 
	`rÙrFixed
(b, 30U);

27 
wÜd32
 
»suÉ
 = 
bË
[
b
&2];

29 
i
=29; i>=0; --i)

31 
b
 = 
	`rÙlFixed
(b, 1U);

32 
»suÉ
 = (»suÉ<<1è^ 
bË
[(
b
&2) + (result>>31)];

35  (
b
&1è? 
»suÉ
 ^ 
a
 :„esult;

37 
wÜd32
 
»suÉ
 = 
bË
[(
b
>>30) & 2];

39 
i
=29; i>=0; --i)

40 
»suÉ
 = (»suÉ<<1è^ 
bË
[((
b
>>
i
)&2) + (result>>31)];

42  (
b
&1è? 
»suÉ
 ^ 
a
 :„esult;

44 
	}
}

46 
	gGF2_32
::
EËm’t
 
GF2_32
::
	$MuÉliÿtiveInv”£
(
EËm’t
 
a
) const

48 ià(
a
 <= 1)

49  
a
;

52 
wÜd32
 
g0
=
m_modulus
, 
g1
=
a
, 
g2
=a;

53 
wÜd32
 
v0
=0, 
v1
=1, 
v2
=1;

55 
	`as£¹
(
g1
);

57 !(
g2
 & 0x80000000))

59 
g2
 <<= 1;

60 
v2
 <<= 1;

63 
g2
 <<= 1;

64 
v2
 <<= 1;

66 
g0
 ^ğ
g2
;

67 
v0
 ^ğ
v2
;

69 
g0
 != 1)

71 ià(
g1
 < 
g0
 || ((g0^g1) < g0 && (g0^g1) < g1))

73 
	`as£¹
(
	`B™P»cisiÚ
(
g1
è<ğB™P»cisiÚ(
g0
));

74 
g2
 = 
g1
;

75 
v2
 = 
v1
;

79 
	`as£¹
(
	`B™P»cisiÚ
(
g1
è> B™P»cisiÚ(
g0
));

80 
g2
 = 
g0
; g0 = 
g1
; g1 = g2;

81 
v2
 = 
v0
; v0 = 
v1
; v1 = v2;

84 (
g0
^
g2
) >= g2)

86 
	`as£¹
(
	`B™P»cisiÚ
(
g0
è> B™P»cisiÚ(
g2
));

87 
g2
 <<= 1;

88 
v2
 <<= 1;

91 
	`as£¹
(
	`B™P»cisiÚ
(
g0
è=ğB™P»cisiÚ(
g2
));

92 
g0
 ^ğ
g2
;

93 
v0
 ^ğ
v2
;

96  
v0
;

97 
	}
}

99 
	gNAMESPACE_END


	@gf2_32.h

1 #iâdeà
CRYPTOPP_GF2_32_H


2 
	#CRYPTOPP_GF2_32_H


	)

4 
	~"üy±lib.h
"

6 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

9 şas 
	cGF2_32


11 
public
:

12 
wÜd32
 
	tEËm’t
;

13 
	tRªdomiz©iÚP¬am‘”
;

15 
	$GF2_32
(
wÜd32
 
modulus
=0x0000008Dè: 
	$m_modulus
(
modulus
) {}

17 
EËm’t
 
	$RªdomEËm’t
(
RªdomNumb”G’”©Ü
 &
ºg
, 
ignÜed
 = 0) const

18 { 
ºg
.
	`G’”©eWÜd32
();
	}
}

20 
boŞ
 
	$Equ®
(
EËm’t
 
a
, EËm’ˆ
b
) const

21 { 
a
==
b
;
	}
}

23 
EËm’t
 
	$Id’t™y
() const

24 { 0;
	}
}

26 
EËm’t
 
	$Add
(
EËm’t
 
a
, EËm’ˆ
b
) const

27 { 
a
^
b
;
	}
}

29 
	gEËm’t
& 
	$AccumuÏ‹
(
EËm’t
 &
a
, EËm’ˆ
b
) const

30 { 
a
^=
b
;
	}
}

32 
EËm’t
 
	$Inv”£
(
EËm’t
 
a
) const

33 { 
a
;
	}
}

35 
EËm’t
 
	$SubŒaù
(
EËm’t
 
a
, EËm’ˆ
b
) const

36 { 
a
^
b
;
	}
}

38 
	gEËm’t
& 
	$Reduû
(
EËm’t
 &
a
, EËm’ˆ
b
) const

39 { 
a
^=
b
;
	}
}

41 
EËm’t
 
	$DoubË
(
EËm’t
 
a
) const

42 { 0;
	}
}

44 
EËm’t
 
	$MuÉliÿtiveId’t™y
() const

45 { 1;
	}
}

47 
EËm’t
 
	$MuÉly
(
EËm’t
 
a
, EËm’ˆ
b
) const;

49 
EËm’t
 
	$Squ¬e
(
EËm’t
 
a
) const

50 { 
	`MuÉly
(
a
,‡);
	}
}

52 
boŞ
 
	$IsUn™
(
EËm’t
 
a
) const

53 { 
a
 !ğ0;
	}
}

55 
EËm’t
 
	$MuÉliÿtiveInv”£
(
EËm’t
 
a
) const;

57 
EËm’t
 
	$Divide
(
EËm’t
 
a
, EËm’ˆ
b
) const

58 { 
	`MuÉly
(
a
, 
	`MuÉliÿtiveInv”£
(
b
));
	}
}

60 
	g´iv©e
:

61 
wÜd32
 
m_modulus
;

64 
	gNAMESPACE_END


	@gf2n.cpp

3 
	~"pch.h
"

5 #iâdeà
CRYPTOPP_IMPORTS


7 
	~"gf2n.h
"

8 
	~"®geb¿.h
"

9 
	~"wÜds.h
"

10 
	~"¿ndpoŞ.h
"

11 
	~"a¢.h
"

12 
	~"oids.h
"

14 
	~<io¡»am
>

16 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

18 
PŞynomŸlMod2
::
	$PŞynomŸlMod2
()

20 
	}
}

22 
PŞynomŸlMod2
::
	$PŞynomŸlMod2
(
wÜd
 
v®ue
, 
size_t
 
b™L’gth
)

23 : 
	`»g
(
	$B™sToWÜds
(
b™L’gth
))

25 
	`as£¹
(
v®ue
==0 || 
»g
.
	`size
()>0);

27 ià(
»g
.
	`size
() > 0)

29 
»g
[0] = 
v®ue
;

30 
	`S‘WÜds
(
»g
+1, 0,„eg.
	`size
()-1);

32 
	}
}

34 
	gPŞynomŸlMod2
::
	$PŞynomŸlMod2
(cÚ¡ 
PŞynomŸlMod2
& 
t
)

35 : 
	`»g
(
t
.
»g
.
	$size
())

37 
	`CİyWÜds
(
»g
, 
t
.»g,„eg.
	`size
());

38 
	}
}

40 
	gPŞynomŸlMod2
::
	$Rªdomize
(
RªdomNumb”G’”©Ü
 &
ºg
, 
size_t
 
nb™s
)

42 cÚ¡ 
size_t
 
nby‹s
 = 
nb™s
/8 + 1;

43 
SecBy‹Block
 
	`buf
(
nby‹s
);

44 
ºg
.
	`G’”©eBlock
(
buf
, 
nby‹s
);

45 
buf
[0] = (
by‹
)
	`Crİ
(buf[0], 
nb™s
 % 8);

46 
	`Decode
(
buf
, 
nby‹s
);

47 
	}
}

49 
PŞynomŸlMod2
 
	gPŞynomŸlMod2
::
	$AÎOÃs
(
size_t
 
b™L’gth
)

51 
PŞynomŸlMod2
 
	`»suÉ
((
wÜd
)0, 
b™L’gth
);

52 
	`S‘WÜds
(
»suÉ
.
»g
, ~(
wÜd
)0,„esuÉ.»g.
	`size
());

53 ià(
b™L’gth
%
WORD_BITS
)

54 
»suÉ
.
»g
[»suÉ.»g.
	`size
()-1] = (
wÜd
)
	`Crİ
ÔesuÉ.»g[»suÉ.»g.size()-1], 
b™L’gth
%
WORD_BITS
);

55  
»suÉ
;

56 
	}
}

58 
	gPŞynomŸlMod2
::
	$S‘B™
(
size_t
 
n
, 
v®ue
)

60 ià(
v®ue
)

62 
»g
.
	`CËªGrow
(
n
/
WORD_BITS
 + 1);

63 
»g
[
n
/
WORD_BITS
] |ğ(
	`wÜd
(1) << (n%WORD_BITS));

67 ià(
n
/
WORD_BITS
 < 
»g
.
	`size
())

68 
»g
[
n
/
WORD_BITS
] &ğ~(
	`wÜd
(1) << (n%WORD_BITS));

70 
	}
}

72 
by‹
 
	gPŞynomŸlMod2
::
	$G‘By‹
(
size_t
 
n
) const

74 ià(
n
/
WORD_SIZE
 >ğ
»g
.
	`size
())

77  
	`by‹
(
»g
[
n
/
WORD_SIZE
] >> ((n%WORD_SIZE)*8));

78 
	}
}

80 
	gPŞynomŸlMod2
::
	$S‘By‹
(
size_t
 
n
, 
by‹
 
v®ue
)

82 
»g
.
	`CËªGrow
(
	`By‹sToWÜds
(
n
+1));

83 
»g
[
n
/
WORD_SIZE
] &ğ~(
	`wÜd
(0xff) << 8*(n%WORD_SIZE));

84 
»g
[
n
/
WORD_SIZE
] |ğ(
	`wÜd
(
v®ue
) << 8*(n%WORD_SIZE));

85 
	}
}

87 
PŞynomŸlMod2
 
	gPŞynomŸlMod2
::
	$MÚomŸl
(
size_t
 
i
)

89 
PŞynomŸlMod2
 
	`r
((
wÜd
)0, 
i
+1);

90 
r
.
	`S‘B™
(
i
);

91  
r
;

92 
	}
}

94 
PŞynomŸlMod2
 
	gPŞynomŸlMod2
::
	$TršomŸl
(
size_t
 
t0
, size_ˆ
t1
, size_ˆ
t2
)

96 
PŞynomŸlMod2
 
	`r
((
wÜd
)0, 
t0
+1);

97 
r
.
	`S‘B™
(
t0
);

98 
r
.
	`S‘B™
(
t1
);

99 
r
.
	`S‘B™
(
t2
);

100  
r
;

101 
	}
}

103 
PŞynomŸlMod2
 
	gPŞynomŸlMod2
::
	$P’nomŸl
(
size_t
 
t0
, size_ˆ
t1
, size_ˆ
t2
, size_ˆ
t3
, size_ˆ
t4
)

105 
PŞynomŸlMod2
 
	`r
((
wÜd
)0, 
t0
+1);

106 
r
.
	`S‘B™
(
t0
);

107 
r
.
	`S‘B™
(
t1
);

108 
r
.
	`S‘B™
(
t2
);

109 
r
.
	`S‘B™
(
t3
);

110 
r
.
	`S‘B™
(
t4
);

111  
r
;

112 
	}
}

114 
	g‹m¶©e
 <
wÜd
 
	gi
>

115 
	sNewPŞynomŸlMod2


117 
PŞynomŸlMod2
 * 
İ”©Ü
()() const

119  
Ãw
 
PŞynomŸlMod2
(
i
);

123 cÚ¡ 
	gPŞynomŸlMod2
 &PŞynomŸlMod2::
	$Z”o
()

125  
SšgËtÚ
<
PŞynomŸlMod2
>().
	`Ref
();

126 
	}
}

128 cÚ¡ 
	gPŞynomŸlMod2
 &PŞynomŸlMod2::
	$OÃ
()

130  
SšgËtÚ
<
PŞynomŸlMod2
, 
NewPŞynomŸlMod2
<1> >().
	`Ref
();

131 
	}
}

133 
	gPŞynomŸlMod2
::
	$Decode
(cÚ¡ 
by‹
 *
šput
, 
size_t
 
šputL’
)

135 
SŒšgStÜe
 
	`¡Üe
(
šput
, 
šputL’
);

136 
	`Decode
(
¡Üe
, 
šputL’
);

137 
	}
}

139 
	gPŞynomŸlMod2
::
	$Encode
(
by‹
 *
ouut
, 
size_t
 
ouutL’
) const

141 
A¼aySšk
 
	`sšk
(
ouut
, 
ouutL’
);

142 
	`Encode
(
sšk
, 
ouutL’
);

143 
	}
}

145 
	gPŞynomŸlMod2
::
	$Decode
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
, 
size_t
 
šputL’
)

147 
»g
.
	`CËªNew
(
	`By‹sToWÜds
(
šputL’
));

149 
size_t
 
i
=
šputL’
; i > 0; i--)

151 
by‹
 
b
;

152 
bt
.
	`G‘
(
b
);

153 
»g
[(
i
-1)/
WORD_SIZE
] |ğ
	`wÜd
(
b
) << ((i-1)%WORD_SIZE)*8;

155 
	}
}

157 
	gPŞynomŸlMod2
::
	$Encode
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
, 
size_t
 
ouutL’
) const

159 
size_t
 
i
=
ouutL’
; i > 0; i--)

160 
bt
.
	`Put
(
	`G‘By‹
(
i
-1));

161 
	}
}

163 
	gPŞynomŸlMod2
::
	$DEREncodeAsOù‘SŒšg
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
, 
size_t
 
Ëngth
) const

165 
DERG’”®Encod”
 
	`’c
(
bt
, 
OCTET_STRING
);

166 
	`Encode
(
’c
, 
Ëngth
);

167 
’c
.
	`Mes§geEnd
();

168 
	}
}

170 
	gPŞynomŸlMod2
::
	$BERDecodeAsOù‘SŒšg
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
, 
size_t
 
Ëngth
)

172 
BERG’”®Decod”
 
	`dec
(
bt
, 
OCTET_STRING
);

173 ià(!
dec
.
	`IsDefš™eL’gth
(è|| dec.
	`RemaššgL’gth
(è!ğ
Ëngth
)

174 
	`BERDecodeE¼Ü
();

175 
	`Decode
(
dec
, 
Ëngth
);

176 
dec
.
	`Mes§geEnd
();

177 
	}
}

179 
	gPŞynomŸlMod2
::
	$WÜdCouÁ
() const

181  ()
	`CouÁWÜds
(
»g
,„eg.
	`size
());

182 
	}
}

184 
	gPŞynomŸlMod2
::
	$By‹CouÁ
() const

186 
wÜdCouÁ
 = 
	`WÜdCouÁ
();

187 ià(
wÜdCouÁ
)

188  (
wÜdCouÁ
-1)*
WORD_SIZE
 + 
	`By‹P»cisiÚ
(
»g
[wordCount-1]);

191 
	}
}

193 
	gPŞynomŸlMod2
::
	$B™CouÁ
() const

195 
wÜdCouÁ
 = 
	`WÜdCouÁ
();

196 ià(
wÜdCouÁ
)

197  (
wÜdCouÁ
-1)*
WORD_BITS
 + 
	`B™P»cisiÚ
(
»g
[wordCount-1]);

200 
	}
}

202 
	gPŞynomŸlMod2
::
	$P¬™y
() const

204 
i
;

205 
wÜd
 
‹mp
=0;

206 
i
=0; i<
»g
.
	`size
(); i++)

207 
‹mp
 ^ğ
»g
[
i
];

208  
Cry±oPP
::
	`P¬™y
(
‹mp
);

209 
	}
}

211 
	gPŞynomŸlMod2
& PŞynomŸlMod2::
İ”©Ü
=(cÚ¡ 
PŞynomŸlMod2
& 
t
)

213 
»g
.
Assign
(
t
.reg);

214  *
	gthis
;

217 
	gPŞynomŸlMod2
& PŞynomŸlMod2::
İ”©Ü
^=(cÚ¡ 
PŞynomŸlMod2
& 
t
)

219 
»g
.
CËªGrow
(
t
.»g.
size
());

220 
XÜWÜds
(
»g
, 
t
.»g,.»g.
size
());

221  *
	gthis
;

224 
PŞynomŸlMod2
 
	gPŞynomŸlMod2
::
	$XÜ
(cÚ¡ 
PŞynomŸlMod2
 &
b
) const

226 ià(
b
.
»g
.
	`size
() >=„eg.size())

228 
PŞynomŸlMod2
 
	`»suÉ
((
wÜd
)0, 
b
.
»g
.
	`size
()*
WORD_BITS
);

229 
	`XÜWÜds
(
»suÉ
.
»g
,„eg, 
b
.»g,„eg.
	`size
());

230 
	`CİyWÜds
(
»suÉ
.
»g
+»g.
	`size
(), 
b
.reg+reg.size(), b.reg.size()-reg.size());

231  
»suÉ
;

235 
PŞynomŸlMod2
 
	`»suÉ
((
wÜd
)0, 
»g
.
	`size
()*
WORD_BITS
);

236 
	`XÜWÜds
(
»suÉ
.
»g
,„eg, 
b
.»g, b.»g.
	`size
());

237 
	`CİyWÜds
(
»suÉ
.
»g
+
b
.»g.
	`size
(),„eg+b.reg.size(),„eg.size()-b.reg.size());

238  
»suÉ
;

240 
	}
}

242 
PŞynomŸlMod2
 
	gPŞynomŸlMod2
::
	$And
(cÚ¡ 
PŞynomŸlMod2
 &
b
) const

244 
PŞynomŸlMod2
 
	`»suÉ
((
wÜd
)0, 
WORD_BITS
*
	`STDMIN
(
»g
.
	`size
(), 
b
.reg.size()));

245 
	`AndWÜds
(
»suÉ
.
»g
,„eg, 
b
.»g,„esuÉ.»g.
	`size
());

246  
»suÉ
;

247 
	}
}

249 
PŞynomŸlMod2
 
	gPŞynomŸlMod2
::
	$Times
(cÚ¡ 
PŞynomŸlMod2
 &
b
) const

251 
PŞynomŸlMod2
 
	`»suÉ
((
wÜd
)0, 
	`B™CouÁ
(è+ 
b
.BitCount());

253 
i
=
b
.
	`Deg»e
(); i>=0; i--)

255 
»suÉ
 <<= 1;

256 ià(
b
[
i
])

257 
	`XÜWÜds
(
»suÉ
.
»g
,„eg,„eg.
	`size
());

259  
»suÉ
;

260 
	}
}

262 
PŞynomŸlMod2
 
	gPŞynomŸlMod2
::
	$Squ¬ed
() const

264 cÚ¡ 
wÜd
 
m­
[16] = {0, 1, 4, 5, 16, 17, 20, 21, 64, 65, 68, 69, 80, 81, 84, 85};

266 
PŞynomŸlMod2
 
	`»suÉ
((
wÜd
)0, 2*
»g
.
	`size
()*
WORD_BITS
);

268 
i
=0; i<
»g
.
	`size
(); i++)

270 
j
;

272 
j
=0; j<
WORD_BITS
; j+=8)

273 
»suÉ
.
»g
[2*
i
] |ğ
m­
[Ôeg[i] >> (
j
/2)) % 16] << j;

275 
j
=0; j<
WORD_BITS
; j+=8)

276 
»suÉ
.
»g
[2*
i
+1] |ğ
m­
[Ôeg[i] >> (
j
/2 + 
WORD_BITS
/2)) % 16] << j;

279  
»suÉ
;

280 
	}
}

282 
	gPŞynomŸlMod2
::
	$Divide
(
PŞynomŸlMod2
 &
»mašd”
, PŞynomŸlMod2 &
quÙ›Á
,

283 cÚ¡ 
PŞynomŸlMod2
 &
divid’d
, cÚ¡ PŞynomŸlMod2 &
divisÜ
)

285 ià(!
divisÜ
)

286 
throw
 
PŞynomŸlMod2
::
	`DivideByZ”o
();

288 
deg»e
 = 
divisÜ
.
	`Deg»e
();

289 
»mašd”
.
»g
.
	`CËªNew
(
	`B™sToWÜds
(
deg»e
+1));

290 ià(
divid’d
.
	`B™CouÁ
(è>ğ
divisÜ
.BitCount())

291 
quÙ›Á
.
»g
.
	`CËªNew
(
	`B™sToWÜds
(
divid’d
.
	`B™CouÁ
(è- 
divisÜ
.BitCount() + 1));

293 
quÙ›Á
.
»g
.
	`CËªNew
(0);

295 
i
=
divid’d
.
	`Deg»e
(); i>=0; i--)

297 
»mašd”
 <<= 1;

298 
»mašd”
.
»g
[0] |ğ
divid’d
[
i
];

299 ià(
»mašd”
[
deg»e
])

301 
»mašd”
 -ğ
divisÜ
;

302 
quÙ›Á
.
	`S‘B™
(
i
);

305 
	}
}

307 
PŞynomŸlMod2
 
	gPŞynomŸlMod2
::
	$DividedBy
(cÚ¡ 
PŞynomŸlMod2
 &
b
) const

309 
PŞynomŸlMod2
 
»mašd”
, 
quÙ›Á
;

310 
PŞynomŸlMod2
::
	`Divide
(
»mašd”
, 
quÙ›Á
, *
this
, 
b
);

311  
quÙ›Á
;

312 
	}
}

314 
PŞynomŸlMod2
 
	gPŞynomŸlMod2
::
	$Modulo
(cÚ¡ 
PŞynomŸlMod2
 &
b
) const

316 
PŞynomŸlMod2
 
»mašd”
, 
quÙ›Á
;

317 
PŞynomŸlMod2
::
	`Divide
(
»mašd”
, 
quÙ›Á
, *
this
, 
b
);

318  
»mašd”
;

319 
	}
}

321 
	gPŞynomŸlMod2
& PŞynomŸlMod2::
İ”©Ü
<<=(
n
)

323 ià(!
»g
.
size
())

324  *
this
;

326 
	gi
;

327 
wÜd
 
	gu
;

328 
wÜd
 
	gÿ¼y
=0;

329 
wÜd
 *
	gr
=
»g
;

331 ià(
	gn
==1)

333 
i
 = ()
»g
.
size
();

334 
	gi
--)

336 
	gu
 = *
r
;

337 *
	gr
 = (
u
 << 1è| 
ÿ¼y
;

338 
	gÿ¼y
 = 
u
 >> (
WORD_BITS
-1);

339 
	gr
++;

342 ià(
	gÿ¼y
)

344 
	g»g
.
Grow
(
»g
.
size
()+1);

345 
	g»g
[
»g
.
size
()-1] = 
ÿ¼y
;

348  *
	gthis
;

351 
	gshiáWÜds
 = 
n
 / 
WORD_BITS
;

352 
	gshiáB™s
 = 
n
 % 
WORD_BITS
;

354 ià(
	gshiáB™s
)

356 
	gi
 = ()
»g
.
size
();

357 
	gi
--)

359 
	gu
 = *
r
;

360 *
	gr
 = (
u
 << 
shiáB™s
è| 
ÿ¼y
;

361 
	gÿ¼y
 = 
u
 >> (
WORD_BITS
-
shiáB™s
);

362 
	gr
++;

366 ià(
	gÿ¼y
)

368 
	g»g
.
Grow
(
»g
.
size
()+
shiáWÜds
+1);

369 
	g»g
[
»g
.
size
()-1] = 
ÿ¼y
;

372 
	g»g
.
Grow
(
»g
.
size
()+
shiáWÜds
);

374 ià(
	gshiáWÜds
)

376 
	gi
 = ()
»g
.
size
()-1; i>=
shiáWÜds
; i--)

377 
	g»g
[
i
] = 
»g
[i-
shiáWÜds
];

378 ; 
	gi
>=0; i--)

379 
	g»g
[
i
] = 0;

382  *
	gthis
;

385 
	gPŞynomŸlMod2
& PŞynomŸlMod2::
İ”©Ü
>>=(
n
)

387 ià(!
»g
.
size
())

388  *
this
;

390 
	gshiáWÜds
 = 
n
 / 
WORD_BITS
;

391 
	gshiáB™s
 = 
n
 % 
WORD_BITS
;

393 
size_t
 
	gi
;

394 
wÜd
 
	gu
;

395 
wÜd
 
	gÿ¼y
=0;

396 
wÜd
 *
	gr
=
»g
+»g.
size
()-1;

398 ià(
	gshiáB™s
)

400 
	gi
 = 
»g
.
size
();

401 
	gi
--)

403 
	gu
 = *
r
;

404 *
	gr
 = (
u
 >> 
shiáB™s
è| 
ÿ¼y
;

405 
	gÿ¼y
 = 
u
 << (
WORD_BITS
-
shiáB™s
);

406 
	gr
--;

410 ià(
	gshiáWÜds
)

412 
	gi
=0; i<
	g»g
.
size
()-
	gshiáWÜds
; i++)

413 
	g»g
[
i
] = 
»g
[i+
shiáWÜds
];

414 ; 
	gi
<
	g»g
.
size
(); i++)

415 
	g»g
[
i
] = 0;

418  *
	gthis
;

421 
PŞynomŸlMod2
 
	gPŞynomŸlMod2
::
İ”©Ü
<<(
n
) const

423 
PŞynomŸlMod2
 
»suÉ
(*
this
);

424  
	g»suÉ
<<=
n
;

427 
PŞynomŸlMod2
 
	gPŞynomŸlMod2
::
İ”©Ü
>>(
n
) const

429 
PŞynomŸlMod2
 
»suÉ
(*
this
);

430  
	g»suÉ
>>=
n
;

433 
boŞ
 
	gPŞynomŸlMod2
::
İ”©Ü
!() const

435 
i
=0; 
	gi
<
	g»g
.
size
(); i++)

436 ià(
	g»g
[
i
]è 
	gçl£
;

437  
	gŒue
;

440 
boŞ
 
	gPŞynomŸlMod2
::
	$Equ®s
(cÚ¡ 
PŞynomŸlMod2
 &
rhs
) const

442 
size_t
 
i
, 
sm®ËrSize
 = 
	`STDMIN
(
»g
.
	`size
(), 
rhs
.reg.size());

444 
i
=0; i<
sm®ËrSize
; i++)

445 ià(
»g
[
i
] !ğ
rhs
.»g[i]è 
çl£
;

447 
i
=
sm®ËrSize
; i<
»g
.
	`size
(); i++)

448 ià(
»g
[
i
] !ğ0è 
çl£
;

450 
i
=
sm®ËrSize
; i<
rhs
.
»g
.
	`size
(); i++)

451 ià(
rhs
.
»g
[
i
] !ğ0è 
çl£
;

453  
Œue
;

454 
	}
}

456 
	g¡d
::
o¡»am
& 
İ”©Ü
<<(
¡d
::o¡»am& 
out
, cÚ¡ 
	gPŞynomŸlMod2
 &
	ga
)

459 
	gf
 = 
out
.
æags
(è& 
¡d
::
ios
::
ba£f›ld
;

460 
	gb™s
, 
	gblock
;

461 
	gsuffix
;

462 
	gf
)

464 
	g¡d
::
ios
::
où
 :

465 
b™s
 = 3;

466 
	gblock
 = 4;

467 
	gsuffix
 = 'o';

469 
	g¡d
::
ios
::
hex
 :

470 
b™s
 = 4;

471 
	gblock
 = 2;

472 
	gsuffix
 = 'h';

475 
b™s
 = 1;

476 
	gblock
 = 8;

477 
	gsuffix
 = 'b';

480 ià(!
	ga
)

481  
	gout
 << '0' << 
	gsuffix
;

483 
	gSecBlock
<> 
s
(
a
.
B™CouÁ
()/
b™s
+1);

484 
	gi
;

486 cÚ¡ 
	guµ”
[]="0123456789ABCDEF";

487 cÚ¡ 
	glow”
[]="0123456789abcdef";

488 cÚ¡ * 
	gvec
 = (
out
.
æags
(è& 
¡d
::
ios
::
uµ”ÿ£
è? 
uµ”
 : 
low”
;

490 
	gi
=0; 
i
*
	gb™s
 < 
	ga
.
B™CouÁ
(); i++)

492 
	gdig™
=0;

493 
	gj
=0; j<
	gb™s
; j++)

494 
	gdig™
 |ğ
a
[
i
*
b™s
+
j
] << j;

495 
	gs
[
i
]=
vec
[
dig™
];

498 
	gi
--)

500 
	gout
 << 
	gs
[
i
];

501 ià(
	gi
 && (i%
	gblock
)==0)

502 
out
 << ',';

505  
	gout
 << 
	gsuffix
;

508 
PŞynomŸlMod2
 
	gPŞynomŸlMod2
::
	$Gcd
(cÚ¡ 
PŞynomŸlMod2
 &
a
, cÚ¡ PŞynomŸlMod2 &
b
)

510  
Euşid—nDomašOf
<
PŞynomŸlMod2
>().
	`Gcd
(
a
, 
b
);

511 
	}
}

513 
PŞynomŸlMod2
 
	gPŞynomŸlMod2
::
	$Inv”£Mod
(cÚ¡ 
PŞynomŸlMod2
 &
modulus
) const

515 
Euşid—nDomašOf
<
	tPŞynomŸlMod2
> 
	tDomaš
;

516  
QuÙ›ÁRšg
<
Domaš
>(
	`Domaš
(), 
modulus
).
	`MuÉliÿtiveInv”£
(*
this
);

517 
	}
}

519 
boŞ
 
	gPŞynomŸlMod2
::
	$IsI¼educibË
() const

521 sigÃd 
d
 = 
	`Deg»e
();

522 ià(
d
 <= 0)

523  
çl£
;

525 
PŞynomŸlMod2
 
	`t
(2), 
	`u
(
t
);

526 
i
=1; i<=
d
/2; i++)

528 
u
 = u.
	`Squ¬ed
()%(*
this
);

529 ià(!
	`Gcd
(
u
+
t
, *
this
).
	`IsUn™
())

530  
çl£
;

532  
Œue
;

533 
	}
}

537 
	gGF2NP
::
	$GF2NP
(cÚ¡ 
PŞynomŸlMod2
 &
modulus
)

538 : 
QuÙ›ÁRšg
<
Euşid—nDomašOf
<
PŞynomŸlMod2
> >(Euşid—nDomašOf<PŞynomŸlMod2>(), 
modulus
), 
	`m
(modulus.
	$Deg»e
())

540 
	}
}

542 
	gGF2NP
::
EËm’t
 
GF2NP
::
	$Squ¬eRoÙ
(cÚ¡ 
EËm’t
 &
a
) const

544 
EËm’t
 
r
 = 
a
;

545 
i
=1; i<
m
; i++)

546 
r
 = 
	`Squ¬e
(r);

547  
r
;

548 
	}
}

550 
	gGF2NP
::
EËm’t
 
GF2NP
::
	$H®fT¿û
(cÚ¡ 
EËm’t
 &
a
) const

552 
	`as£¹
(
m
%2 == 1);

553 
EËm’t
 
h
 = 
a
;

554 
i
=1; i<=(
m
-1)/2; i++)

555 
h
 = 
	`Add
(
	`Squ¬e
(Squ¬e(h)), 
a
);

556  
h
;

557 
	}
}

559 
	gGF2NP
::
EËm’t
 
GF2NP
::
	$SŞveQuad¿ticEqu©iÚ
(cÚ¡ 
EËm’t
 &
a
) const

561 ià(
m
%2 == 0)

563 
EËm’t
 
z
, 
w
;

564 
RªdomPoŞ
 
ºg
;

567 
EËm’t
 
	`p
((
RªdomNumb”G’”©Ü
 &)
ºg
, 
m
);

568 
z
 = 
PŞynomŸlMod2
::
	`Z”o
();

569 
w
 = 
p
;

570 
i
=1; i<=
m
-1; i++)

572 
w
 = 
	`Squ¬e
(w);

573 
z
 = 
	`Squ¬e
(z);

574 
	`AccumuÏ‹
(
z
, 
	`MuÉly
(
w
, 
a
));

575 
	`AccumuÏ‹
(
w
, 
p
);

577 } 
w
.
	`IsZ”o
());

578  
z
;

581  
	`H®fT¿û
(
a
);

582 
	}
}

586 
	gGF2NT
::
	$GF2NT
(
t0
, 
t1
, 
t2
)

587 : 
	`GF2NP
(
PŞynomŸlMod2
::
	`TršomŸl
(
t0
, 
t1
, 
t2
))

588 , 
	`t0
(
t0
), 
	`t1
(
t1
)

589 , 
	`»suÉ
((
wÜd
)0, 
m
)

591 
	`as£¹
(
t0
 > 
t1
 &&1 > 
t2
 &&2==0);

592 
	}
}

594 cÚ¡ 
	gGF2NT
::
EËm’t
& 
GF2NT
::
	$MuÉliÿtiveInv”£
(cÚ¡ 
EËm’t
 &
a
) const

596 ià(
t0
-
t1
 < 
WORD_BITS
)

597  
GF2NP
::
	`MuÉliÿtiveInv”£
(
a
);

599 
SecWÜdBlock
 
	`T
(
m_modulus
.
»g
.
	`size
() * 4);

600 
wÜd
 *
b
 = 
T
;

601 
wÜd
 *
c
 = 
T
+
m_modulus
.
»g
.
	`size
();

602 
wÜd
 *
f
 = 
T
+2*
m_modulus
.
»g
.
	`size
();

603 
wÜd
 *
g
 = 
T
+3*
m_modulus
.
»g
.
	`size
();

604 
size_t
 
bcL’
=1, 
fgL’
=
m_modulus
.
»g
.
	`size
();

605 
k
=0;

607 
	`S‘WÜds
(
T
, 0, 3*
m_modulus
.
»g
.
	`size
());

608 
b
[0]=1;

609 
	`as£¹
(
a
.
»g
.
	`size
(è<ğ
m_modulus
.reg.size());

610 
	`CİyWÜds
(
f
, 
a
.
»g
,‡.»g.
	`size
());

611 
	`CİyWÜds
(
g
, 
m_modulus
.
»g
, m_modulus.»g.
	`size
());

615 
wÜd
 
t
=
f
[0];

616 !
t
)

618 
	`ShiáWÜdsRightByWÜds
(
f
, 
fgL’
, 1);

619 ià(
c
[
bcL’
-1])

620 
bcL’
++;

621 
	`as£¹
(
bcL’
 <ğ
m_modulus
.
»g
.
	`size
());

622 
	`ShiáWÜdsLeáByWÜds
(
c
, 
bcL’
, 1);

623 
k
+=
WORD_BITS
;

624 
t
=
f
[0];

627 
i
=0;

628 
t
%2 == 0)

630 
t
>>=1;

631 
i
++;

633 
k
+=
i
;

635 ià(
t
==1 && 
	`CouÁWÜds
(
f
, 
fgL’
)==1)

638 ià(
i
==1)

640 
	`ShiáWÜdsRightByB™s
(
f
, 
fgL’
, 1);

641 
t
=
	`ShiáWÜdsLeáByB™s
(
c
, 
bcL’
, 1);

645 
	`ShiáWÜdsRightByB™s
(
f
, 
fgL’
, 
i
);

646 
t
=
	`ShiáWÜdsLeáByB™s
(
c
, 
bcL’
, 
i
);

648 ià(
t
)

650 
c
[
bcL’
] = 
t
;

651 
bcL’
++;

652 
	`as£¹
(
bcL’
 <ğ
m_modulus
.
»g
.
	`size
());

655 ià(
f
[
fgL’
-1]==0 && 
g
[fgLen-1]==0)

656 
fgL’
--;

658 ià(
f
[
fgL’
-1] < 
g
[fgLen-1])

660 
¡d
::
	`sw­
(
f
, 
g
);

661 
¡d
::
	`sw­
(
b
, 
c
);

664 
	`XÜWÜds
(
f
, 
g
, 
fgL’
);

665 
	`XÜWÜds
(
b
, 
c
, 
bcL’
);

668 
k
 >ğ
WORD_BITS
)

670 
wÜd
 
‹mp
 = 
b
[0];

672 
i
=0; i+1<
	`B™sToWÜds
(
m
); i++)

673 
b
[
i
] = b[i+1];

674 
b
[
	`B™sToWÜds
(
m
)-1] = 0;

676 ià(
t1
 < 
WORD_BITS
)

677 
j
=0; j<
WORD_BITS
-
t1
; j++)

678 
‹mp
 ^ğ(Ñem°>> 
j
è& 1è<< (
t1
 + j);

680 
b
[
t1
/
WORD_BITS
-1] ^ğ
‹mp
 <<1%WORD_BITS;

682 ià(
t1
 % 
WORD_BITS
)

683 
b
[
t1
/
WORD_BITS
] ^ğ
‹mp
 >> (WORD_BITS -1%WORD_BITS);

685 ià(
t0
%
WORD_BITS
)

687 
b
[
t0
/
WORD_BITS
-1] ^ğ
‹mp
 <<0%WORD_BITS;

688 
b
[
t0
/
WORD_BITS
] ^ğ
‹mp
 >> (WORD_BITS -0%WORD_BITS);

691 
b
[
t0
/
WORD_BITS
-1] ^ğ
‹mp
;

693 
k
 -ğ
WORD_BITS
;

696 ià(
k
)

698 
wÜd
 
‹mp
 = 
b
[0] << (
WORD_BITS
 - 
k
);

699 
	`ShiáWÜdsRightByB™s
(
b
, 
	`B™sToWÜds
(
m
), 
k
);

701 ià(
t1
 < 
WORD_BITS
)

702 
j
=0; j<
WORD_BITS
-
t1
; j++)

703 
‹mp
 ^ğ(Ñem°>> 
j
è& 1è<< (
t1
 + j);

705 
b
[
t1
/
WORD_BITS
-1] ^ğ
‹mp
 <<1%WORD_BITS;

707 ià(
t1
 % 
WORD_BITS
)

708 
b
[
t1
/
WORD_BITS
] ^ğ
‹mp
 >> (WORD_BITS -1%WORD_BITS);

710 ià(
t0
%
WORD_BITS
)

712 
b
[
t0
/
WORD_BITS
-1] ^ğ
‹mp
 <<0%WORD_BITS;

713 
b
[
t0
/
WORD_BITS
] ^ğ
‹mp
 >> (WORD_BITS -0%WORD_BITS);

716 
b
[
t0
/
WORD_BITS
-1] ^ğ
‹mp
;

719 
	`CİyWÜds
(
»suÉ
.
»g
.
	`begš
(), 
b
,„esuÉ.»g.
	`size
());

720  
»suÉ
;

721 
	}
}

723 cÚ¡ 
	gGF2NT
::
EËm’t
& 
GF2NT
::
	$MuÉly
(cÚ¡ 
EËm’t
 &
a
, cÚ¡ EËm’ˆ&
b
) const

725 
size_t
 
aSize
 = 
	`STDMIN
(
a
.
»g
.
	`size
(), 
»suÉ
.reg.size());

726 
EËm’t
 
	`r
((
wÜd
)0, 
m
);

728 
i
=
m
-1; i>=0; i--)

730 ià(
r
[
m
-1])

732 
	`ShiáWÜdsLeáByB™s
(
r
.
»g
.
	`begš
(),„.»g.
	`size
(), 1);

733 
	`XÜWÜds
(
r
.
»g
.
	`begš
(), 
m_modulus
.»g,„.»g.
	`size
());

736 
	`ShiáWÜdsLeáByB™s
(
r
.
»g
.
	`begš
(),„.»g.
	`size
(), 1);

738 ià(
b
[
i
])

739 
	`XÜWÜds
(
r
.
»g
.
	`begš
(), 
a
.»g, 
aSize
);

742 ià(
m
%
WORD_BITS
)

743 
r
.
»g
.
	`begš
()[r.»g.
	`size
()-1] = (
wÜd
)
	`Crİ
Ô.»g[r.»g.size()-1], 
m
%
WORD_BITS
);

745 
	`CİyWÜds
(
»suÉ
.
»g
.
	`begš
(), 
r
.»g.begš(),„esuÉ.»g.
	`size
());

746  
»suÉ
;

747 
	}
}

749 cÚ¡ 
	gGF2NT
::
EËm’t
& 
GF2NT
::
	$Reduûd
(cÚ¡ 
EËm’t
 &
a
) const

751 ià(
t0
-
t1
 < 
WORD_BITS
)

752  
m_domaš
.
	`Mod
(
a
, 
m_modulus
);

754 
SecWÜdBlock
 
	`b
(
a
.
»g
);

756 
size_t
 
i
;

757 
i
=
b
.
	`size
()-1; i>=
	`B™sToWÜds
(
t0
); i--)

759 
wÜd
 
‹mp
 = 
b
[
i
];

761 ià(
t0
%
WORD_BITS
)

763 
b
[
i
-
t0
/
WORD_BITS
] ^ğ
‹mp
 >>0%WORD_BITS;

764 
b
[
i
-
t0
/
WORD_BITS
-1] ^ğ
‹mp
 << (WORD_BITS -0%WORD_BITS);

767 
b
[
i
-
t0
/
WORD_BITS
] ^ğ
‹mp
;

769 ià((
t0
-
t1
)%
WORD_BITS
)

771 
b
[
i
-(
t0
-
t1
)/
WORD_BITS
] ^ğ
‹mp
 >> (t0-t1)%WORD_BITS;

772 
b
[
i
-(
t0
-
t1
)/
WORD_BITS
-1] ^ğ
‹mp
 << (WORD_BITS - (t0-t1)%WORD_BITS);

775 
b
[
i
-(
t0
-
t1
)/
WORD_BITS
] ^ğ
‹mp
;

778 ià(
i
==
	`B™sToWÜds
(
t0
)-1 &&0%
WORD_BITS
)

780 
wÜd
 
mask
 = ((wÜd)1<<(
t0
%
WORD_BITS
))-1;

781 
wÜd
 
‹mp
 = 
b
[
i
] & ~
mask
;

782 
b
[
i
] &ğ
mask
;

784 
b
[
i
-
t0
/
WORD_BITS
] ^ğ
‹mp
 >>0%WORD_BITS;

786 ià((
t0
-
t1
)%
WORD_BITS
)

788 
b
[
i
-(
t0
-
t1
)/
WORD_BITS
] ^ğ
‹mp
 >> (t0-t1)%WORD_BITS;

789 ià((
t0
-
t1
)%
WORD_BITS
 >0%WORD_BITS)

790 
b
[
i
-(
t0
-
t1
)/
WORD_BITS
-1] ^ğ
‹mp
 << (WORD_BITS - (t0-t1)%WORD_BITS);

792 
	`as£¹
(
‹mp
 << (
WORD_BITS
 - (
t0
-
t1
)%WORD_BITS) == 0);

795 
b
[
i
-(
t0
-
t1
)/
WORD_BITS
] ^ğ
‹mp
;

798 
	`S‘WÜds
(
»suÉ
.
»g
.
	`begš
(), 0,„esuÉ.»g.
	`size
());

799 
	`CİyWÜds
(
»suÉ
.
»g
.
	`begš
(), 
b
, 
	`STDMIN
(b.
	`size
(),„esult.reg.size()));

800  
»suÉ
;

801 
	}
}

803 
	gGF2NP
::
	$DEREncodeEËm’t
(
Bufã»dT¿nsfÜm©iÚ
 &
out
, cÚ¡ 
EËm’t
 &
a
) const

805 
a
.
	`DEREncodeAsOù‘SŒšg
(
out
, 
	`MaxEËm’tBy‹L’gth
());

806 
	}
}

808 
	gGF2NP
::
	$BERDecodeEËm’t
(
Bufã»dT¿nsfÜm©iÚ
 &
š
, 
EËm’t
 &
a
) const

810 
a
.
	`BERDecodeAsOù‘SŒšg
(
š
, 
	`MaxEËm’tBy‹L’gth
());

811 
	}
}

813 
	gGF2NT
::
	$DEREncode
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
) const

815 
DERSequ’ûEncod”
 
	`£q
(
bt
);

816 
ASN1
::
	`ch¬aù”i¡ic_two_f›ld
().
	`DEREncode
(
£q
);

817 
DERSequ’ûEncod”
 
	`·¿m‘”s
(
£q
);

818 
	`DEREncodeUnsigÃd
(
·¿m‘”s
, 
m
);

819 
ASN1
::
	`Basis
().
	`DEREncode
(
·¿m‘”s
);

820 
	`DEREncodeUnsigÃd
(
·¿m‘”s
, 
t1
);

821 
·¿m‘”s
.
	`Mes§geEnd
();

822 
£q
.
	`Mes§geEnd
();

823 
	}
}

825 
	gGF2NPP
::
	$DEREncode
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
) const

827 
DERSequ’ûEncod”
 
	`£q
(
bt
);

828 
ASN1
::
	`ch¬aù”i¡ic_two_f›ld
().
	`DEREncode
(
£q
);

829 
DERSequ’ûEncod”
 
	`·¿m‘”s
(
£q
);

830 
	`DEREncodeUnsigÃd
(
·¿m‘”s
, 
m
);

831 
ASN1
::
	`µBasis
().
	`DEREncode
(
·¿m‘”s
);

832 
DERSequ’ûEncod”
 
	`³ÁªomŸl
(
·¿m‘”s
);

833 
	`DEREncodeUnsigÃd
(
³ÁªomŸl
, 
t3
);

834 
	`DEREncodeUnsigÃd
(
³ÁªomŸl
, 
t2
);

835 
	`DEREncodeUnsigÃd
(
³ÁªomŸl
, 
t1
);

836 
³ÁªomŸl
.
	`Mes§geEnd
();

837 
·¿m‘”s
.
	`Mes§geEnd
();

838 
£q
.
	`Mes§geEnd
();

839 
	}
}

841 
GF2NP
 * 
	$BERDecodeGF2NP
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
)

844 
memb”_±r
<
GF2NP
> 
»suÉ
;

846 
BERSequ’ûDecod”
 
	`£q
(
bt
);

847 ià(
	`OID
(
£q
è!ğ
ASN1
::
	`ch¬aù”i¡ic_two_f›ld
())

848 
	`BERDecodeE¼Ü
();

849 
BERSequ’ûDecod”
 
	`·¿m‘”s
(
£q
);

850 
m
;

851 
	`BERDecodeUnsigÃd
(
·¿m‘”s
, 
m
);

852 
OID
 
	`oid
(
·¿m‘”s
);

853 ià(
oid
 =ğ
ASN1
::
	`Basis
())

855 
t1
;

856 
	`BERDecodeUnsigÃd
(
·¿m‘”s
, 
t1
);

857 
»suÉ
.
	`»£t
(
Ãw
 
	`GF2NT
(
m
, 
t1
, 0));

859 ià(
oid
 =ğ
ASN1
::
	`µBasis
())

861 
t1
, 
t2
, 
t3
;

862 
BERSequ’ûDecod”
 
	`³ÁªomŸl
(
·¿m‘”s
);

863 
	`BERDecodeUnsigÃd
(
³ÁªomŸl
, 
t3
);

864 
	`BERDecodeUnsigÃd
(
³ÁªomŸl
, 
t2
);

865 
	`BERDecodeUnsigÃd
(
³ÁªomŸl
, 
t1
);

866 
³ÁªomŸl
.
	`Mes§geEnd
();

867 
»suÉ
.
	`»£t
(
Ãw
 
	`GF2NPP
(
m
, 
t3
, 
t2
, 
t1
, 0));

871 
	`BERDecodeE¼Ü
();

872  
NULL
;

874 
·¿m‘”s
.
	`Mes§geEnd
();

875 
£q
.
	`Mes§geEnd
();

877  
»suÉ
.
	`»Ëa£
();

878 
	}
}

880 
	gNAMESPACE_END


	@gf2n.h

1 #iâdeà
CRYPTOPP_GF2N_H


2 
	#CRYPTOPP_GF2N_H


	)

6 
	~"üy±lib.h
"

7 
	~"£cblock.h
"

8 
	~"misc.h
"

9 
	~"®geb¿.h
"

11 
	~<iosfwd
>

13 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

17 şas 
	cCRYPTOPP_DLL
 
PŞynomŸlMod2


19 
public
:

23 şas 
	cDivideByZ”o
 : 
public
 
Exû±iÚ


25 
public
:

26 
	`DivideByZ”o
(è: 
	`Exû±iÚ
(
OTHER_ERROR
, "PolynomialMod2: division by zero") {}

29 
	tRªdomiz©iÚP¬am‘”
;

35 
	`PŞynomŸlMod2
();

37 
	`PŞynomŸlMod2
(cÚ¡ 
PŞynomŸlMod2
& 
t
);

44 
	`PŞynomŸlMod2
(
wÜd
 
v®ue
, 
size_t
 
b™L’gth
=
WORD_BITS
);

47 
	$PŞynomŸlMod2
(cÚ¡ 
by‹
 *
’codedPŞy
, 
size_t
 
by‹CouÁ
)

48 {
	`Decode
(
’codedPŞy
, 
by‹CouÁ
);
	}
}

51 
	$PŞynomŸlMod2
(
Bufã»dT¿nsfÜm©iÚ
 &
’codedPŞy
, 
size_t
 
by‹CouÁ
)

52 {
	`Decode
(
’codedPŞy
, 
by‹CouÁ
);
	}
}

55 
	$PŞynomŸlMod2
(
RªdomNumb”G’”©Ü
 &
ºg
, 
size_t
 
b™couÁ
)

56 {
	`Rªdomize
(
ºg
, 
b™couÁ
);
	}
}

59 
PŞynomŸlMod2
 
CRYPTOPP_API
 
MÚomŸl
(
size_t
 
i
);

61 
PŞynomŸlMod2
 
CRYPTOPP_API
 
TršomŸl
(
size_t
 
t0
, size_ˆ
t1
, size_ˆ
t2
);

63 
PŞynomŸlMod2
 
CRYPTOPP_API
 
P’nomŸl
(
size_t
 
t0
, size_ˆ
t1
, size_ˆ
t2
, size_ˆ
t3
, size_ˆ
t4
);

65 
PŞynomŸlMod2
 
CRYPTOPP_API
 
AÎOÃs
(
size_t
 
n
);

68 cÚ¡ 
	gPŞynomŸlMod2
 & 
CRYPTOPP_API
 
Z”o
();

70 cÚ¡ 
	gPŞynomŸlMod2
 & 
CRYPTOPP_API
 
OÃ
();

77 
	$MšEncodedSize
(ècÚ¡ { 
	`STDMAX
(1U, 
	`By‹CouÁ
());
	}
}

83 
	$Encode
(
by‹
 *
ouut
, 
size_t
 
ouutL’
) const;

85 
	$Encode
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
, 
size_t
 
ouutL’
) const;

88 
	`Decode
(cÚ¡ 
by‹
 *
šput
, 
size_t
 
šputL’
);

91 
	`Decode
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
, 
size_t
 
šputL’
);

94 
	$DEREncodeAsOù‘SŒšg
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
, 
size_t
 
Ëngth
) const;

96 
	`BERDecodeAsOù‘SŒšg
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
, 
size_t
 
Ëngth
);

102 
	$B™CouÁ
() const;

104 
	$By‹CouÁ
() const;

106 
	$WÜdCouÁ
() const;

109 
boŞ
 
	$G‘B™
(
size_t
 
n
ècÚ¡ { 
	`G‘CÛffic›Á
Ò)!=0;
	}
}

111 
by‹
 
	$G‘By‹
(
size_t
 
n
) const;

114 sigÃd 
	$Deg»e
(ècÚ¡ { 
	`B™CouÁ
()-1;
	}
}

116 
	$CÛffic›ÁCouÁ
(ècÚ¡ { 
	`B™CouÁ
();
	}
}

118 
	$G‘CÛffic›Á
(
size_t
 
i
) const

119 { (
i
/
WORD_BITS
 < 
»g
.
	`size
()è? Ôeg[i/WORD_BITS] >> (˜% WORD_BITS)è& 1 : 0;
	}
}

121 
	gİ”©Ü
[](
	gi
ècÚ¡ { 
G‘CÛffic›Á
(
i
);}

124 
boŞ
 
	$IsZ”o
(ècÚ¡ { !*
this
;
	}
}

126 
boŞ
 
	$Equ®s
(cÚ¡ 
PŞynomŸlMod2
 &
rhs
) const;

132 
PŞynomŸlMod2
& 
İ”©Ü
=(cÚ¡ PŞynomŸlMod2& 
t
);

134 
PŞynomŸlMod2
& 
İ”©Ü
&=(cÚ¡ PŞynomŸlMod2& 
t
);

136 
PŞynomŸlMod2
& 
İ”©Ü
^=(cÚ¡ PŞynomŸlMod2& 
t
);

138 
PŞynomŸlMod2
& 
İ”©Ü
+=(cÚ¡ PŞynomŸlMod2& 
t
è{ *
this
 ^ğt;
	}
}

140 
	gPŞynomŸlMod2
& 
	gİ”©Ü
-=(cÚ¡ 
PŞynomŸlMod2
& 
t
è{ *
this
 ^=;}

142 
	gPŞynomŸlMod2
& 
	gİ”©Ü
*=(cÚ¡ 
PŞynomŸlMod2
& 
t
);

144 
	gPŞynomŸlMod2
& 
	gİ”©Ü
/=(cÚ¡ 
PŞynomŸlMod2
& 
t
);

146 
	gPŞynomŸlMod2
& 
	gİ”©Ü
%=(cÚ¡ 
PŞynomŸlMod2
& 
t
);

148 
	gPŞynomŸlMod2
& 
	gİ”©Ü
<<=();

150 
	gPŞynomŸlMod2
& 
	gİ”©Ü
>>=();

153 
Rªdomize
(
RªdomNumb”G’”©Ü
 &
ºg
, 
size_t
 
b™couÁ
);

156 
S‘B™
(
size_t
 
i
, 
v®ue
 = 1);

158 
S‘By‹
(
size_t
 
n
, 
by‹
 
v®ue
);

161 
	$S‘CÛffic›Á
(
size_t
 
i
, 
v®ue
è{
	`S‘B™
(i, v®ue);
	}
}

164 
	$sw­
(
PŞynomŸlMod2
 &
a
è{
»g
.
	`sw­
×.»g);
	}
}

170 
boŞ
 
	gİ”©Ü
!() const;

172 
PŞynomŸlMod2
 
	gİ”©Ü
+(ècÚ¡ { *
	gthis
;}

174 
PŞynomŸlMod2
 
	gİ”©Ü
-(ècÚ¡ { *
	gthis
;}

180 
PŞynomŸlMod2
 
	$And
(cÚ¡ 
PŞynomŸlMod2
 &
b
) const;

182 
PŞynomŸlMod2
 
	$XÜ
(cÚ¡ 
PŞynomŸlMod2
 &
b
) const;

184 
PŞynomŸlMod2
 
	$Plus
(cÚ¡ 
PŞynomŸlMod2
 &
b
ècÚ¡ { 
	`XÜ
(b);
	}
}

186 
PŞynomŸlMod2
 
	$Mšus
(cÚ¡ 
PŞynomŸlMod2
 &
b
ècÚ¡ { 
	`XÜ
(b);
	}
}

188 
PŞynomŸlMod2
 
	$Times
(cÚ¡ 
PŞynomŸlMod2
 &
b
) const;

190 
PŞynomŸlMod2
 
	$DividedBy
(cÚ¡ 
PŞynomŸlMod2
 &
b
) const;

192 
PŞynomŸlMod2
 
	$Modulo
(cÚ¡ 
PŞynomŸlMod2
 &
b
) const;

195 
PŞynomŸlMod2
 
İ”©Ü
>>(
n
) const;

197 
PŞynomŸlMod2
 
İ”©Ü
<<(
n
) const;

203 
	$P¬™y
() const;

206 
boŞ
 
	$IsI¼educibË
() const;

209 
PŞynomŸlMod2
 
	$DoubËd
(ècÚ¡ { 
	`Z”o
();
	}
}

211 
PŞynomŸlMod2
 
	$Squ¬ed
() const;

214 
boŞ
 
	$IsUn™
(ècÚ¡ { 
	`Equ®s
(
	`OÃ
());
	}
}

216 
PŞynomŸlMod2
 
	$MuÉliÿtiveInv”£
(ècÚ¡ { 
	`IsUn™
(è? 
	`OÃ
(è: 
	`Z”o
();
	}
}

219 
PŞynomŸlMod2
 
CRYPTOPP_API
 
Gcd
(cÚ¡ PŞynomŸlMod2 &
a
, cÚ¡ PŞynomŸlMod2 &
n
);

221 
PŞynomŸlMod2
 
	$Inv”£Mod
(cÚ¡ 
PŞynomŸlMod2
 &) const;

224 
CRYPTOPP_API
 
	`Divide
(
PŞynomŸlMod2
 &
r
, PŞynomŸlMod2 &
q
, cÚ¡ PŞynomŸlMod2 &
a
, cÚ¡ PŞynomŸlMod2 &
d
);

230 
ä›nd
 
¡d
::
o¡»am
& 
İ”©Ü
<<(¡d::o¡»am& 
out
, cÚ¡ 
PŞynomŸlMod2
 &
a
);

233 
´iv©e
:

234 
ä›nd
 
şass
 
GF2NT
;

236 
SecWÜdBlock
 
»g
;

237 
	}
};

240 
šlše
 
boŞ
 
	gİ”©Ü
==(cÚ¡ 
Cry±oPP
::
PŞynomŸlMod2
 &
a
, cÚ¡ 
	gCry±oPP
::PŞynomŸlMod2 &
b
)

241 { 
a
.
Equ®s
(
b
);}

243 
šlše
 
boŞ
 
	gİ”©Ü
!=(cÚ¡ 
Cry±oPP
::
PŞynomŸlMod2
 &
a
, cÚ¡ 
	gCry±oPP
::PŞynomŸlMod2 &
b
)

244 { !(
a
==
b
);}

246 
šlše
 
boŞ
 
	gİ”©Ü
> (cÚ¡ 
	gCry±oPP
::
PŞynomŸlMod2
 &
a
, cÚ¡ Cry±oPP::PŞynomŸlMod2 &
b
)

247 { 
a
.
Deg»e
(è> 
b
.Degree();}

249 
šlše
 
boŞ
 
	gİ”©Ü
>=(cÚ¡ 
Cry±oPP
::
PŞynomŸlMod2
 &
a
, cÚ¡ 
	gCry±oPP
::PŞynomŸlMod2 &
b
)

250 { 
a
.
Deg»e
(è>ğ
b
.Degree();}

252 
šlše
 
boŞ
 
	gİ”©Ü
< (cÚ¡ 
	gCry±oPP
::
PŞynomŸlMod2
 &
a
, cÚ¡ Cry±oPP::PŞynomŸlMod2 &
b
)

253 { 
a
.
Deg»e
(è< 
b
.Degree();}

255 
šlše
 
boŞ
 
	gİ”©Ü
<=(cÚ¡ 
Cry±oPP
::
PŞynomŸlMod2
 &
a
, cÚ¡ 
	gCry±oPP
::PŞynomŸlMod2 &
b
)

256 { 
a
.
Deg»e
(è<ğ
b
.Degree();}

258 
šlše
 
	gCry±oPP
::
PŞynomŸlMod2
 
İ”©Ü
&(cÚ¡ 
Cry±oPP
::PŞynomŸlMod2 &
a
, cÚ¡ Cry±oPP::PŞynomŸlMod2 &
b
è{‡.
And
(b);}

260 
šlše
 
	gCry±oPP
::
PŞynomŸlMod2
 
İ”©Ü
^(cÚ¡ 
Cry±oPP
::PŞynomŸlMod2 &
a
, cÚ¡ Cry±oPP::PŞynomŸlMod2 &
b
è{‡.
XÜ
(b);}

262 
šlše
 
	gCry±oPP
::
PŞynomŸlMod2
 
İ”©Ü
+(cÚ¡ 
Cry±oPP
::PŞynomŸlMod2 &
a
, cÚ¡ Cry±oPP::PŞynomŸlMod2 &
b
è{‡.
Plus
(b);}

264 
šlše
 
	gCry±oPP
::
PŞynomŸlMod2
 
İ”©Ü
-(cÚ¡ 
Cry±oPP
::PŞynomŸlMod2 &
a
, cÚ¡ Cry±oPP::PŞynomŸlMod2 &
b
è{‡.
Mšus
(b);}

266 
šlše
 
	gCry±oPP
::
PŞynomŸlMod2
 
İ”©Ü
*(cÚ¡ 
Cry±oPP
::PŞynomŸlMod2 &
a
, cÚ¡ Cry±oPP::PŞynomŸlMod2 &
b
è{‡.
Times
(b);}

268 
šlše
 
	gCry±oPP
::
PŞynomŸlMod2
 
İ”©Ü
/(cÚ¡ 
Cry±oPP
::PŞynomŸlMod2 &
a
, cÚ¡ Cry±oPP::PŞynomŸlMod2 &
b
è{‡.
DividedBy
(b);}

270 
šlše
 
	gCry±oPP
::
PŞynomŸlMod2
 
İ”©Ü
%(cÚ¡ 
Cry±oPP
::PŞynomŸlMod2 &
a
, cÚ¡ Cry±oPP::PŞynomŸlMod2 &
b
è{‡.
Modulo
(b);}

274 
CRYPTOPP_DLL_TEMPLATE_CLASS
 
	gAb¡¿ùGroup
<
	gPŞynomŸlMod2
>;

275 
CRYPTOPP_DLL_TEMPLATE_CLASS
 
	gAb¡¿ùRšg
<
	gPŞynomŸlMod2
>;

276 
CRYPTOPP_DLL_TEMPLATE_CLASS
 
	gAb¡¿ùEuşid—nDomaš
<
	gPŞynomŸlMod2
>;

277 
CRYPTOPP_DLL_TEMPLATE_CLASS
 
	gEuşid—nDomašOf
<
	gPŞynomŸlMod2
>;

278 
CRYPTOPP_DLL_TEMPLATE_CLASS
 
	gQuÙ›ÁRšg
<
	gEuşid—nDomašOf
<
	gPŞynomŸlMod2
> >;

281 
şass
 
CRYPTOPP_DLL
 
	gGF2NP
 : 
public
 
QuÙ›ÁRšg
<
Euşid—nDomašOf
<
PŞynomŸlMod2
> >

283 
public
:

284 
GF2NP
(cÚ¡ 
PŞynomŸlMod2
 &
modulus
);

286 
vœtu®
 
GF2NP
 * 
ClÚe
(ècÚ¡ { 
Ãw
 GF2NP(*
this
);}

287 
vœtu®
 
DEREncode
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
) const

288 {
as£¹
(
çl£
);}

290 
DEREncodeEËm’t
(
Bufã»dT¿nsfÜm©iÚ
 &
out
, cÚ¡ 
EËm’t
 &
a
) const;

291 
BERDecodeEËm’t
(
Bufã»dT¿nsfÜm©iÚ
 &
š
, 
EËm’t
 &
a
) const;

293 
boŞ
 
Equ®
(cÚ¡ 
EËm’t
 &
a
, cÚ¡ EËm’ˆ&
b
) const

294 {
as£¹
(
a
.
Deg»e
(è< 
m_modulus
.Deg»e(è&& 
b
.Deg»e(è< m_modulus.Deg»e());  
	ga
.
Equ®s
(b);}

296 
boŞ
 
IsUn™
(cÚ¡ 
EËm’t
 &
a
) const

297 {
as£¹
(
a
.
Deg»e
(è< 
m_modulus
.Deg»e());  !!
	ga
;}

299 
MaxEËm’tB™L’gth
() const

300 { 
	gm
;}

302 
MaxEËm’tBy‹L’gth
() const

303 { ()
B™sToBy‹s
(
MaxEËm’tB™L’gth
());}

305 
EËm’t
 
Squ¬eRoÙ
(cÚ¡ EËm’ˆ&
a
) const;

307 
EËm’t
 
H®fT¿û
(cÚ¡ EËm’ˆ&
a
) const;

310 
EËm’t
 
SŞveQuad¿ticEqu©iÚ
(cÚ¡ EËm’ˆ&
a
) const;

312 
	g´Ùeùed
:

313 
m
;

317 şas 
	cCRYPTOPP_DLL
 
	mGF2NT
 : 
public
 
GF2NP


319 
public
:

321 
GF2NT
(
t0
, 
t1
, 
t2
);

323 
GF2NP
 * 
	$ClÚe
(ècÚ¡ { 
Ãw
 
	`GF2NT
(*
this
);}

324 
	$DEREncode
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
) const;

326 cÚ¡ 
EËm’t
& 
	$MuÉly
(cÚ¡ 
EËm’t
 &
a
, cÚ¡ EËm’ˆ&
b
) const;

328 cÚ¡ 
EËm’t
& 
	$Squ¬e
(cÚ¡ 
EËm’t
 &
a
) const

329 { 
	`Reduûd
(
a
.
	`Squ¬ed
());
	}
}

331 cÚ¡ 
	gEËm’t
& 
	$MuÉliÿtiveInv”£
(cÚ¡ 
EËm’t
 &
a
) const;

333 
´iv©e
:

334 cÚ¡ 
EËm’t
& 
	$Reduûd
(cÚ¡ 
EËm’t
 &
a
) const;

336 
t0
, 
t1
;

337 
mubË
 
PŞynomŸlMod2
 
»suÉ
;

338 
	}
};

341 şas 
	cCRYPTOPP_DLL
 
	mGF2NPP
 : 
public
 
GF2NP


343 
public
:

345 
	$GF2NPP
(
t0
, 
t1
, 
t2
, 
t3
, 
t4
)

346 : 
	`GF2NP
(
PŞynomŸlMod2
::
	`P’nomŸl
(
t0
, 
t1
, 
t2
, 
t3
, 
t4
)), 
	`t0
Ñ0), 
	`t1
Ñ1), 
	`t2
Ñ2), 
	$t3
(
t3
) {}

348 
GF2NP
 * 
	$ClÚe
(ècÚ¡ { 
Ãw
 
	`GF2NPP
(*
this
);
	}
}

349 
	$DEREncode
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
) const;

351 
´iv©e
:

352 
t0
, 
t1
, 
t2
, 
t3
;

353 
	}
};

356 
CRYPTOPP_DLL
 
GF2NP
 * 
CRYPTOPP_API
 
BERDecodeGF2NP
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
);

358 
	gNAMESPACE_END


360 #iâdeà
__BORLANDC__


361 
	$NAMESPACE_BEGIN
(
¡d
)

362 
‹m¶©e
<> 
šlše
 
	$sw­
(
Cry±oPP
::
PŞynomŸlMod2
 &
a
, Cry±oPP::PŞynomŸlMod2 &
b
)

364 
a
.
	`sw­
(
b
);

365 
	}
}

366 
	gNAMESPACE_END


	@gfpcrypt.cpp

3 
	~"pch.h
"

5 #iâdeà
CRYPTOPP_IMPORTS


7 
	~"gåüy±.h
"

8 
	~"a¢.h
"

9 
	~"oids.h
"

10 
	~"nbtheÜy.h
"

12 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

14 
	$Te¡In¡ªtŸtiÚs_gåüy±
()

16 
GDSA
<
SHA
>::
SigÃr
 
‹¡
;

17 
GDSA
<
SHA
>::
V”if›r
 
‹¡1
;

18 
DSA
::
SigÃr
 
	`‹¡5
(
	`NuÎRNG
(), 100);

19 
DSA
::
SigÃr
 
	`‹¡2
(
‹¡5
);

20 
NR
<
SHA
>::
SigÃr
 
‹¡3
;

21 
NR
<
SHA
>::
V”if›r
 
‹¡4
;

22 
DLIES
<>::
Enüy±Ü
 
‹¡6
;

23 
DLIES
<>::
Deüy±Ü
 
‹¡7
;

24 
	}
}

26 
	gDL_GroupP¬am‘”s_DSA
::
	$G’”©eRªdom
(
RªdomNumb”G’”©Ü
 &
ºg
, cÚ¡ 
NameV®uePaœs
 &
®g
)

28 
IÁeg”
 
p
, 
q
, 
g
;

30 ià(
®g
.
	`G‘V®ue
("Modulus", 
p
è&&‡lg.G‘V®ue("SubgroupG’”©Ü", 
g
))

32 
q
 = 
®g
.
	`G‘V®ueW™hDeçuÉ
("SubgroupOrd”", 
	`Compu‹GroupOrd”
(
p
)/2);

33 
	`In™Ÿlize
(
p
, 
q
, 
g
);

37 
modulusSize
 = 1024, 
deçuÉSubgroupOrd”Size
;

38 
®g
.
	`G‘IÁV®ue
("ModulusSize", 
modulusSize
) ||‡lg.GetIntValue("KeySize", modulusSize);

40 
modulusSize
)

43 
deçuÉSubgroupOrd”Size
 = 160;

46 
deçuÉSubgroupOrd”Size
 = 224;

49 
deçuÉSubgroupOrd”Size
 = 256;

52 
throw
 
	`Inv®idArgum’t
("DSA:‚ot‡ valid…rime†ength");

55 
DL_GroupP¬am‘”s_GFP
::
	`G’”©eRªdom
(
ºg
, 
	`CombšedNameV®uePaœs
(
®g
, 
	`MakeP¬am‘”s
(
Name
::
	`SubgroupOrd”Size
(), 
deçuÉSubgroupOrd”Size
, 
çl£
)));

57 
	}
}

59 
boŞ
 
	gDL_GroupP¬am‘”s_DSA
::
	$V®id©eGroup
(
RªdomNumb”G’”©Ü
 &
ºg
, 
Ëv–
) const

61 
boŞ
 
·ss
 = 
DL_GroupP¬am‘”s_GFP
::
	`V®id©eGroup
(
ºg
, 
Ëv–
);

62 
pSize
 = 
	`G‘Modulus
().
	`B™CouÁ
(), 
qSize
 = 
	`G‘SubgroupOrd”
().BitCount();

63 
·ss
 =…as && ((
pSize
==1024 && 
qSize
==160) || (pSize==2048 && qSize==224) || (pSize==2048 && qSize==256) || (pSize==3072 && qSize==256));

64  
·ss
;

65 
	}
}

67 
	gDL_SigÇtu»Mes§geEncodšgM‘hod_DSA
::
	$Compu‹Mes§geR•»£Á©ive
(
RªdomNumb”G’”©Ü
 &
ºg
,

68 cÚ¡ 
by‹
 *
»cov”abËMes§ge
, 
size_t
 
»cov”abËMes§geL’gth
,

69 
HashT¿nsfÜm©iÚ
 &
hash
, 
HashId’tif›r
 
hashId’tif›r
, 
boŞ
 
mes§geEm±y
,

70 
by‹
 *
»´e£Á©ive
, 
size_t
 
»´e£Á©iveB™L’gth
) const

72 
	`as£¹
(
»cov”abËMes§geL’gth
 == 0);

73 
	`as£¹
(
hashId’tif›r
.
£cÚd
 == 0);

74 cÚ¡ 
size_t
 
»´e£Á©iveBy‹L’gth
 = 
	`B™sToBy‹s
(
»´e£Á©iveB™L’gth
);

75 cÚ¡ 
size_t
 
dige¡Size
 = 
hash
.
	`Dige¡Size
();

76 cÚ¡ 
size_t
 
·ddšgL’gth
 = 
	`S©u¿tšgSubŒaù
(
»´e£Á©iveBy‹L’gth
, 
dige¡Size
);

78 
	`mem£t
(
»´e£Á©ive
, 0, 
·ddšgL’gth
);

79 
hash
.
	`Trunÿ‹dFš®
(
»´e£Á©ive
+
·ddšgL’gth
, 
	`STDMIN
(
»´e£Á©iveBy‹L’gth
, 
dige¡Size
));

81 ià(
dige¡Size
*8 > 
»´e£Á©iveB™L’gth
)

83 
IÁeg”
 
	`h
(
»´e£Á©ive
, 
»´e£Á©iveBy‹L’gth
);

84 
h
 >>ğ
»´e£Á©iveBy‹L’gth
*8 - 
»´e£Á©iveB™L’gth
;

85 
h
.
	`Encode
(
»´e£Á©ive
, 
»´e£Á©iveBy‹L’gth
);

87 
	}
}

89 
	gDL_SigÇtu»Mes§geEncodšgM‘hod_NR
::
	$Compu‹Mes§geR•»£Á©ive
(
RªdomNumb”G’”©Ü
 &
ºg
,

90 cÚ¡ 
by‹
 *
»cov”abËMes§ge
, 
size_t
 
»cov”abËMes§geL’gth
,

91 
HashT¿nsfÜm©iÚ
 &
hash
, 
HashId’tif›r
 
hashId’tif›r
, 
boŞ
 
mes§geEm±y
,

92 
by‹
 *
»´e£Á©ive
, 
size_t
 
»´e£Á©iveB™L’gth
) const

94 
	`as£¹
(
»cov”abËMes§geL’gth
 == 0);

95 
	`as£¹
(
hashId’tif›r
.
£cÚd
 == 0);

96 cÚ¡ 
size_t
 
»´e£Á©iveBy‹L’gth
 = 
	`B™sToBy‹s
(
»´e£Á©iveB™L’gth
);

97 cÚ¡ 
size_t
 
dige¡Size
 = 
hash
.
	`Dige¡Size
();

98 cÚ¡ 
size_t
 
·ddšgL’gth
 = 
	`S©u¿tšgSubŒaù
(
»´e£Á©iveBy‹L’gth
, 
dige¡Size
);

100 
	`mem£t
(
»´e£Á©ive
, 0, 
·ddšgL’gth
);

101 
hash
.
	`Trunÿ‹dFš®
(
»´e£Á©ive
+
·ddšgL’gth
, 
	`STDMIN
(
»´e£Á©iveBy‹L’gth
, 
dige¡Size
));

103 ià(
dige¡Size
*8 >ğ
»´e£Á©iveB™L’gth
)

105 
IÁeg”
 
	`h
(
»´e£Á©ive
, 
»´e£Á©iveBy‹L’gth
);

106 
h
 >>ğ
»´e£Á©iveBy‹L’gth
*8 - 
»´e£Á©iveB™L’gth
 + 1;

107 
h
.
	`Encode
(
»´e£Á©ive
, 
»´e£Á©iveBy‹L’gth
);

109 
	}
}

111 
boŞ
 
	gDL_GroupP¬am‘”s_IÁeg”Ba£d
::
	$V®id©eGroup
(
RªdomNumb”G’”©Ü
 &
ºg
, 
Ëv–
) const

113 cÚ¡ 
IÁeg”
 &
p
 = 
	`G‘Modulus
(), &
q
 = 
	`G‘SubgroupOrd”
();

115 
boŞ
 
·ss
 = 
Œue
;

116 
·ss
 =…as && 
p
 > 
IÁeg”
::
	`OÃ
(è&&….
	`IsOdd
();

117 
·ss
 =…as && 
q
 > 
IÁeg”
::
	`OÃ
(è&& q.
	`IsOdd
();

119 ià(
Ëv–
 >= 1)

120 
·ss
 =…as && 
	`G‘CoçùÜ
(è> 
IÁeg”
::
	`OÃ
(è&& 
	`G‘GroupOrd”
(è% 
q
 =ğIÁeg”::
	`Z”o
();

121 ià(
Ëv–
 >= 2)

122 
·ss
 =…as && 
	`V”ifyPrime
(
ºg
, 
q
, 
Ëv–
-2è&& V”ifyPrimeÔng, 
p
,†evel-2);

124  
·ss
;

125 
	}
}

127 
boŞ
 
	gDL_GroupP¬am‘”s_IÁeg”Ba£d
::
V®id©eEËm’t
(
Ëv–
, cÚ¡ 
IÁeg”
 &
g
, cÚ¡ 
DL_FixedBa£P»computiÚ
<IÁeg”> *
gpc
) const

129 cÚ¡ 
	gIÁeg”
 &
	gp
 = 
G‘Modulus
(), &
	gq
 = 
G‘SubgroupOrd”
();

131 
boŞ
 
	g·ss
 = 
Œue
;

132 
	g·ss
 = 
·ss
 && 
G‘F›ldTy³
(è=ğ1 ? 
g
.
IsPos™ive
(è: g.
NÙNeg©ive
();

133 
	g·ss
 = 
·ss
 && 
g
 < 
p
 && !
IsId’t™y
(g);

135 ià(
	gËv–
 >= 1)

137 ià(
gpc
)

138 
·ss
 =…as && 
gpc
->
ExpÚ’tŸ‹
(
G‘GroupP»computiÚ
(), 
IÁeg”
::
OÃ
()è=ğ
g
;

140 ià(
	gËv–
 >= 2)

142 ià(
G‘F›ldTy³
() == 2)

143 
·ss
 =…as && 
Jacobi
(
g
*g-4, 
p
)==-1;

147 
boŞ
 
	gfuÎV®id©e
 = (
G‘F›ldTy³
(è=ğ2 && 
Ëv–
 >ğ3è|| !
Fa¡SubgroupCheckAvaabË
();

149 ià(
	gfuÎV®id©e
 && 
	g·ss
)

151 
IÁeg”
 
	ggp
 = 
gpc
 ? gpc->
ExpÚ’tŸ‹
(
G‘GroupP»computiÚ
(), 
q
è: 
ExpÚ’tŸ‹EËm’t
(
g
, q);

152 
	g·ss
 = 
·ss
 && 
IsId’t™y
(
gp
);

154 ià(
G‘F›ldTy³
() == 1)

155 
·ss
 =…as && 
Jacobi
(
g
, 
p
) == 1;

158  
	g·ss
;

161 
	gDL_GroupP¬am‘”s_IÁeg”Ba£d
::
	$G’”©eRªdom
(
RªdomNumb”G’”©Ü
 &
ºg
, cÚ¡ 
NameV®uePaœs
 &
®g
)

163 
IÁeg”
 
p
, 
q
, 
g
;

165 ià(
®g
.
	`G‘V®ue
("Modulus", 
p
è&&‡lg.G‘V®ue("SubgroupG’”©Ü", 
g
))

167 
q
 = 
®g
.
	`G‘V®ueW™hDeçuÉ
("SubgroupOrd”", 
	`Compu‹GroupOrd”
(
p
)/2);

171 
modulusSize
, 
subgroupOrd”Size
;

173 ià(!
®g
.
	`G‘IÁV®ue
("ModulusSize", 
modulusSize
))

174 
modulusSize
 = 
®g
.
	`G‘IÁV®ueW™hDeçuÉ
("KeySize", 2048);

176 ià(!
®g
.
	`G‘IÁV®ue
("SubgroupOrd”Size", 
subgroupOrd”Size
))

177 
subgroupOrd”Size
 = 
	`G‘DeçuÉSubgroupOrd”Size
(
modulusSize
);

179 
PrimeAndG’”©Ü
 
pg
;

180 
pg
.
	`G’”©e
(
	`G‘F›ldTy³
(è=ğ1 ? 1 : -1, 
ºg
, 
modulusSize
, 
subgroupOrd”Size
);

181 
p
 = 
pg
.
	`Prime
();

182 
q
 = 
pg
.
	`SubPrime
();

183 
g
 = 
pg
.
	`G’”©Ü
();

186 
	`In™Ÿlize
(
p
, 
q
, 
g
);

187 
	}
}

189 
IÁeg”
 
	gDL_GroupP¬am‘”s_IÁeg”Ba£d
::
	$DecodeEËm’t
(cÚ¡ 
by‹
 *
’coded
, 
boŞ
 
checkFÜGroupMemb”sh
) const

191 
IÁeg”
 
	`g
(
’coded
, 
	`G‘Modulus
().
	`By‹CouÁ
());

192 ià(!
	`V®id©eEËm’t
(1, 
g
, 
NULL
))

193 
throw
 
	`DL_BadEËm’t
();

194  
g
;

195 
	}
}

197 
	gDL_GroupP¬am‘”s_IÁeg”Ba£d
::
	$BERDecode
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
)

199 
BERSequ’ûDecod”
 
	`·¿m‘”s
(
bt
);

200 
IÁeg”
 
	`p
(
·¿m‘”s
);

201 
IÁeg”
 
	`q
(
·¿m‘”s
);

202 
IÁeg”
 
g
;

203 ià(
·¿m‘”s
.
	`EndR—ched
())

205 
g
 = 
q
;

206 
q
 = 
	`Compu‹GroupOrd”
(
p
) / 2;

209 
g
.
	`BERDecode
(
·¿m‘”s
);

210 
·¿m‘”s
.
	`Mes§geEnd
();

212 
	`S‘ModulusAndSubgroupG’”©Ü
(
p
, 
g
);

213 
	`S‘SubgroupOrd”
(
q
);

214 
	}
}

216 
	gDL_GroupP¬am‘”s_IÁeg”Ba£d
::
	$DEREncode
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
) const

218 
DERSequ’ûEncod”
 
	`·¿m‘”s
(
bt
);

219 
	`G‘Modulus
().
	`DEREncode
(
·¿m‘”s
);

220 
m_q
.
	`DEREncode
(
·¿m‘”s
);

221 
	`G‘SubgroupG’”©Ü
().
	`DEREncode
(
·¿m‘”s
);

222 
·¿m‘”s
.
	`Mes§geEnd
();

223 
	}
}

225 
boŞ
 
	gDL_GroupP¬am‘”s_IÁeg”Ba£d
::
	$G‘VoidV®ue
(cÚ¡ *
Çme
, cÚ¡ 
¡d
::
ty³_šfo
 &
v®ueTy³
, *
pV®ue
) const

227  
G‘V®ueH–³r
<
DL_GroupP¬am‘”s
<
EËm’t
> >(
this
, 
Çme
, 
v®ueTy³
, 
pV®ue
)

228 
	`CRYPTOPP_GET_FUNCTION_ENTRY
(
Modulus
);

229 
	}
}

231 
	gDL_GroupP¬am‘”s_IÁeg”Ba£d
::
	$AssignFrom
(cÚ¡ 
NameV®uePaœs
 &
sourû
)

233 
	`AssignFromH–³r
(
this
, 
sourû
)

234 
	`CRYPTOPP_SET_FUNCTION_ENTRY2
(
Modulus
, 
SubgroupG’”©Ü
)

235 
	`CRYPTOPP_SET_FUNCTION_ENTRY
(
SubgroupOrd”
)

237 
	}
}

239 
OID
 
	gDL_GroupP¬am‘”s_IÁeg”Ba£d
::
	$G‘AlgÜ™hmID
() const

241  
ASN1
::
	`id_d§
();

242 
	}
}

244 
	gDL_GroupP¬am‘”s_GFP
::
	$SimuÉªeousExpÚ’tŸ‹
(
EËm’t
 *
»suÉs
, cÚ¡ EËm’ˆ&
ba£
, cÚ¡ 
IÁeg”
 *
expÚ’ts
, 
expÚ’tsCouÁ
) const

246 
ModuÏrAr™hm‘ic
 
	`ma
(
	`G‘Modulus
());

247 
ma
.
	`SimuÉªeousExpÚ’tŸ‹
(
»suÉs
, 
ba£
, 
expÚ’ts
, 
expÚ’tsCouÁ
);

248 
	}
}

250 
	gDL_GroupP¬am‘”s_GFP
::
EËm’t
 
DL_GroupP¬am‘”s_GFP
::
	$MuÉlyEËm’ts
(cÚ¡ 
EËm’t
 &
a
, cÚ¡ EËm’ˆ&
b
) const

252  
	`a_times_b_mod_c
(
a
, 
b
, 
	`G‘Modulus
());

253 
	}
}

255 
	gDL_GroupP¬am‘”s_GFP
::
EËm’t
 
DL_GroupP¬am‘”s_GFP
::
	$CasÿdeExpÚ’tŸ‹
(cÚ¡ 
EËm’t
 &
–em’t1
, cÚ¡ 
IÁeg”
 &
expÚ’t1
, cÚ¡ EËm’ˆ&
–em’t2
, cÚ¡ IÁeg” &
expÚ’t2
) const

257 
ModuÏrAr™hm‘ic
 
	`ma
(
	`G‘Modulus
());

258  
ma
.
	`CasÿdeExpÚ’tŸ‹
(
–em’t1
, 
expÚ’t1
, 
–em’t2
, 
expÚ’t2
);

259 
	}
}

261 
IÁeg”
 
	gDL_GroupP¬am‘”s_IÁeg”Ba£d
::
	$G‘MaxExpÚ’t
() const

263  
	`STDMIN
(
	`G‘SubgroupOrd”
()-1, 
IÁeg”
::
	`Pow”2
(2*
	`Disü‘eLogWÜkFaùÜ
(
	`G‘F›ldTy³
()*
	`G‘Modulus
().
	`B™CouÁ
())));

264 
	}
}

266 
	gDL_GroupP¬am‘”s_IÁeg”Ba£d
::
	$G‘DeçuÉSubgroupOrd”Size
(
modulusSize
) const

268  2*
	`Disü‘eLogWÜkFaùÜ
(
	`G‘F›ldTy³
()*
modulusSize
);

269 
	}
}

271 
	gNAMESPACE_END


	@gfpcrypt.h

1 #iâdeà
CRYPTOPP_GFPCRYPT_H


2 
	#CRYPTOPP_GFPCRYPT_H


	)

8 
	~"pubkey.h
"

9 
	~"modexµc.h
"

10 
	~"sha.h
"

11 
	~"®g·¿m.h
"

12 
	~"a¢.h
"

13 
	~"sm¬Œ.h
"

14 
	~"hmac.h
"

16 
	~<lim™s.h
>

18 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

20 
CRYPTOPP_DLL_TEMPLATE_CLASS
 
DL_GroupP¬am‘”s
<
IÁeg”
>;

23 
şass
 
CRYPTOPP_DLL
 
CRYPTOPP_NO_VTABLE
 
DL_GroupP¬am‘”s_IÁeg”Ba£d
 : 
public
 
ASN1Cry±oM©”Ÿl
<
DL_GroupP¬am‘”s
<
IÁeg”
> >

25 
DL_GroupP¬am‘”s_IÁeg”Ba£d
 
	tThisCÏss
;

27 
public
:

28 
	`In™Ÿlize
(cÚ¡ 
DL_GroupP¬am‘”s_IÁeg”Ba£d
 &
·¿ms
)

29 {
	`In™Ÿlize
(
·¿ms
.
	`G‘Modulus
(),…¬ams.
	`G‘SubgroupOrd”
(),…¬ams.
	`G‘SubgroupG’”©Ü
());}

30 
	`In™Ÿlize
(
RªdomNumb”G’”©Ü
 &
ºg
, 
pb™s
)

31 {
	`G’”©eRªdom
(
ºg
, 
	`MakeP¬am‘”s
("ModulusSize", ()
pb™s
));}

32 
	`In™Ÿlize
(cÚ¡ 
IÁeg”
 &
p
, cÚ¡ IÁeg” &
g
)

33 {
	`S‘ModulusAndSubgroupG’”©Ü
(
p
, 
g
); 
	`S‘SubgroupOrd”
(
	`Compu‹GroupOrd”
(p)/2);}

34 
	`In™Ÿlize
(cÚ¡ 
IÁeg”
 &
p
, cÚ¡ IÁeg” &
q
, cÚ¡ IÁeg” &
g
)

35 {
	`S‘ModulusAndSubgroupG’”©Ü
(
p
, 
g
); 
	`S‘SubgroupOrd”
(
q
);}

38 
	`BERDecode
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
);

39 
	`DEREncode
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
) const;

43 
	`G’”©eRªdom
(
RªdomNumb”G’”©Ü
 &
ºg
, cÚ¡ 
NameV®uePaœs
 &
®g
);

44 
boŞ
 
	`G‘VoidV®ue
(cÚ¡ *
Çme
, cÚ¡ 
¡d
::
ty³_šfo
 &
v®ueTy³
, *
pV®ue
) const;

45 
	`AssignFrom
(cÚ¡ 
NameV®uePaœs
 &
sourû
);

48 cÚ¡ 
IÁeg”
 & 
	`G‘SubgroupOrd”
(ècÚ¡ { 
m_q
;}

49 
IÁeg”
 
	`G‘GroupOrd”
(ècÚ¡ { 
	`G‘F›ldTy³
(è=ğ1 ? 
	`G‘Modulus
()-IÁeg”::
	`OÃ
() : GetModulus()+Integer::One();}

50 
boŞ
 
	`V®id©eGroup
(
RªdomNumb”G’”©Ü
 &
ºg
, 
Ëv–
) const;

51 
boŞ
 
	`V®id©eEËm’t
(
Ëv–
, cÚ¡ 
IÁeg”
 &
–em’t
, cÚ¡ 
DL_FixedBa£P»computiÚ
<IÁeg”> *
´ecomp
) const;

52 
boŞ
 
	`Fa¡SubgroupCheckAvaabË
(ècÚ¡ { 
	`G‘CoçùÜ
() == 2;}

53 
	`EncodeEËm’t
(
boŞ
 
»v”sibË
, cÚ¡ 
EËm’t
 &
–em’t
, 
by‹
 *
’coded
) const

54 {
–em’t
.
	`Encode
(
’coded
, 
	`G‘Modulus
().
	`By‹CouÁ
());}

55 
	`G‘EncodedEËm’tSize
(
boŞ
 
»v”sibË
ècÚ¡ { 
	`G‘Modulus
().
	`By‹CouÁ
();}

56 
IÁeg”
 
	`DecodeEËm’t
(cÚ¡ 
by‹
 *
’coded
, 
boŞ
 
checkFÜGroupMemb”sh
) const;

57 
IÁeg”
 
	`CÚv”tEËm’tToIÁeg”
(cÚ¡ 
EËm’t
 &
–em’t
) const

58 { 
–em’t
;}

59 
IÁeg”
 
	`G‘MaxExpÚ’t
() const;

60 
¡d
::
¡ršg
 
CRYPTOPP_API
 
	`SticAlgÜ™hmNameP»fix
() { "";}

62 
OID
 
	`G‘AlgÜ™hmID
() const;

64 
vœtu®
 cÚ¡ 
IÁeg”
 & 
	`G‘Modulus
() const =0;

65 
vœtu®
 
	`S‘ModulusAndSubgroupG’”©Ü
(cÚ¡ 
IÁeg”
 &
p
, cÚ¡ IÁeg” &
g
) =0;

67 
	`S‘SubgroupOrd”
(cÚ¡ 
IÁeg”
 &
q
)

68 {
m_q
 = 
q
; 
	`P¬am‘”sChªged
();}

70 
´Ùeùed
:

71 
IÁeg”
 
	`Compu‹GroupOrd”
(cÚ¡ IÁeg” &
modulus
) const

72 { 
modulus
-(
	`G‘F›ldTy³
() == 1 ? 1 : -1);}

75 
vœtu®
 
	`G‘F›ldTy³
() const =0;

76 
vœtu®
 
	`G‘DeçuÉSubgroupOrd”Size
(
modulusSize
) const;

78 
´iv©e
:

79 
IÁeg”
 
m_q
;

80 
	}
};

83 
	g‹m¶©e
 <
şass
 
	gGROUP_PRECOMP
, cÏs 
	gBASE_PRECOMP
 = 
DL_FixedBa£P»computiÚIm¶
<
CPP_TYPENAME
 
GROUP_PRECOMP
::
EËm’t
> >

84 
şass
 
CRYPTOPP_NO_VTABLE
 
DL_GroupP¬am‘”s_IÁeg”Ba£dIm¶
 : 
public
 
DL_GroupP¬am‘”sIm¶
<
GROUP_PRECOMP
, 
	gBASE_PRECOMP
, 
	gDL_GroupP¬am‘”s_IÁeg”Ba£d
>

86 
	gDL_GroupP¬am‘”s_IÁeg”Ba£dIm¶
<
	tGROUP_PRECOMP
, 
	tBASE_PRECOMP
> 
	tThisCÏss
;

88 
	gpublic
:

89 
ty³Çme
 
	tGROUP_PRECOMP
::
	tEËm’t
 Element;

92 
boŞ
 
G‘VoidV®ue
(cÚ¡ *
Çme
, cÚ¡ 
¡d
::
ty³_šfo
 &
v®ueTy³
, *
pV®ue
) const

93 { 
	gG‘V®ueH–³r
<
	gDL_GroupP¬am‘”s_IÁeg”Ba£d
>(
	gthis
, 
	gÇme
, 
	gv®ueTy³
, 
	gpV®ue
).
AssigÇbË
();}

95 
AssignFrom
(cÚ¡ 
NameV®uePaœs
 &
sourû
)

96 {
	gAssignFromH–³r
<
	gDL_GroupP¬am‘”s_IÁeg”Ba£d
>(
	gthis
, 
	gsourû
);}

99 cÚ¡ 
	gDL_FixedBa£P»computiÚ
<
	gEËm’t
> & 
G‘Ba£P»computiÚ
(ècÚ¡ { 
	gthis
->
	gm_gpc
;}

100 
	gDL_FixedBa£P»computiÚ
<
	gEËm’t
> & 
AcûssBa£P»computiÚ
(è{ 
	gthis
->
	gm_gpc
;}

103 cÚ¡ 
	gIÁeg”
 & 
G‘Modulus
(ècÚ¡ { 
	gthis
->
	gm_groupP»computiÚ
.GetModulus();}

104 cÚ¡ 
	gIÁeg”
 & 
G‘G’”©Ü
(ècÚ¡ { 
	gthis
->
	gm_gpc
.
G‘Ba£
(
this
->
G‘GroupP»computiÚ
());}

106 
S‘ModulusAndSubgroupG’”©Ü
(cÚ¡ 
IÁeg”
 &
p
, cÚ¡ IÁeg” &
g
)

107 {
	gthis
->
	gm_groupP»computiÚ
.
S‘Modulus
(
p
);his->
	gm_gpc
.
S‘Ba£
(
this
->
G‘GroupP»computiÚ
(), 
g
);his->
P¬am‘”sChªged
();}

110 
boŞ
 
	gİ”©Ü
==(cÚ¡ 
DL_GroupP¬am‘”s_IÁeg”Ba£dIm¶
<
GROUP_PRECOMP
, 
	gBASE_PRECOMP
> &
	grhs
) const

111 { 
G‘Modulus
(è=ğ
rhs
.G‘Modulus(è&& 
G‘G’”©Ü
(è=ğrhs.G‘G’”©Ü(è&& 
this
->
G‘SubgroupOrd”
() ==„hs.GetSubgroupOrder();}

112 
boŞ
 
	gİ”©Ü
!=(cÚ¡ 
DL_GroupP¬am‘”s_IÁeg”Ba£dIm¶
<
GROUP_PRECOMP
, 
	gBASE_PRECOMP
> &
	grhs
) const

113 { !
	gİ”©Ü
==(
rhs
);}

116 
CRYPTOPP_DLL_TEMPLATE_CLASS
 
	gDL_GroupP¬am‘”s_IÁeg”Ba£dIm¶
<
	gModExpP»computiÚ
>;

119 
şass
 
CRYPTOPP_DLL
 
	gDL_GroupP¬am‘”s_GFP
 : 
public
 
DL_GroupP¬am‘”s_IÁeg”Ba£dIm¶
<
ModExpP»computiÚ
>

121 
public
:

123 
boŞ
 
IsId’t™y
(cÚ¡ 
IÁeg”
 &
–em’t
ècÚ¡ {ƒËm’ˆ=ğIÁeg”::
OÃ
();}

124 
SimuÉªeousExpÚ’tŸ‹
(
EËm’t
 *
»suÉs
, cÚ¡ EËm’ˆ&
ba£
, cÚ¡ 
IÁeg”
 *
expÚ’ts
, 
expÚ’tsCouÁ
) const;

127 
boŞ
 
G‘VoidV®ue
(cÚ¡ *
Çme
, cÚ¡ 
¡d
::
ty³_šfo
 &
v®ueTy³
, *
pV®ue
) const

129  
	gG‘V®ueH–³r
<
	gDL_GroupP¬am‘”s_IÁeg”Ba£d
>(
	gthis
, 
	gÇme
, 
	gv®ueTy³
, 
	gpV®ue
).
AssigÇbË
();

133 
EËm’t
 
MuÉlyEËm’ts
(cÚ¡ EËm’ˆ&
a
, cÚ¡ EËm’ˆ&
b
) const;

134 
EËm’t
 
CasÿdeExpÚ’tŸ‹
(cÚ¡ EËm’ˆ&
–em’t1
, cÚ¡ 
IÁeg”
 &
expÚ’t1
, cÚ¡ EËm’ˆ&
–em’t2
, cÚ¡ IÁeg” &
expÚ’t2
) const;

136 
	g´Ùeùed
:

137 
G‘F›ldTy³
() const { 1;}

141 şas 
	cCRYPTOPP_DLL
 
	mDL_GroupP¬am‘”s_GFP_DeçuÉSaãPrime
 : 
public
 
DL_GroupP¬am‘”s_GFP


143 
public
:

144 
NoCoçùÜMuÉliÿtiÚ
 
	tDeçuÉCoçùÜO±iÚ
;

146 
	m´Ùeùed
:

147 
	$G‘DeçuÉSubgroupOrd”Size
(
modulusSize
) const { modulusSize-1;}

148 
	}
};

151 
	g‹m¶©e
 <
şass
 
	gT
>

152 
şass
 
	gDL_AlgÜ™hm_GDSA
 : 
public
 
DL_Elgam®LikeSigÇtu»AlgÜ™hm
<
T
>

154 
public
:

155 cÚ¡ * 
CRYPTOPP_API
 
SticAlgÜ™hmName
() { "DSA-1363";}

157 
Sign
(cÚ¡ 
DL_GroupP¬am‘”s
<
T
> &
·¿ms
, cÚ¡ 
IÁeg”
 &
x
, cÚ¡ IÁeg” &
k
, cÚ¡ IÁeg” &
e
, IÁeg” &
r
, IÁeg” &
s
) const

159 cÚ¡ 
	gIÁeg”
 &
	gq
 = 
·¿ms
.
G‘SubgroupOrd”
();

160 
	gr
 %ğ
q
;

161 
IÁeg”
 
	gkInv
 = 
k
.
Inv”£Mod
(
q
);

162 
	gs
 = (
kInv
 * (
x
*
r
 + 
e
)è% 
q
;

163 
as£¹
(!!
r
 && !!
s
);

166 
boŞ
 
V”ify
(cÚ¡ 
DL_GroupP¬am‘”s
<
T
> &
·¿ms
, cÚ¡ 
DL_PublicKey
<T> &
publicKey
, cÚ¡ 
IÁeg”
 &
e
, cÚ¡ IÁeg” &
r
, cÚ¡ IÁeg” &
s
) const

168 cÚ¡ 
	gIÁeg”
 &
	gq
 = 
·¿ms
.
G‘SubgroupOrd”
();

169 ià(
	gr
>=
q
 || 
r
<1 || 
s
>=q || s<1)

170  
çl£
;

172 
IÁeg”
 
	gw
 = 
s
.
Inv”£Mod
(
q
);

173 
IÁeg”
 
	gu1
 = (
e
 * 
w
è% 
q
;

174 
IÁeg”
 
	gu2
 = (
r
 * 
w
è% 
q
;

176  
	gr
 =ğ
·¿ms
.
CÚv”tEËm’tToIÁeg”
(
publicKey
.
CasÿdeExpÚ’tŸ‹Ba£AndPublicEËm’t
(
u1
, 
u2
)è% 
	gq
;

180 
CRYPTOPP_DLL_TEMPLATE_CLASS
 
	gDL_AlgÜ™hm_GDSA
<
	gIÁeg”
>;

183 
	g‹m¶©e
 <
şass
 
	gT
>

184 
şass
 
	gDL_AlgÜ™hm_NR
 : 
public
 
DL_Elgam®LikeSigÇtu»AlgÜ™hm
<
T
>

186 
public
:

187 cÚ¡ * 
CRYPTOPP_API
 
SticAlgÜ™hmName
() { "NR";}

189 
Sign
(cÚ¡ 
DL_GroupP¬am‘”s
<
T
> &
·¿ms
, cÚ¡ 
IÁeg”
 &
x
, cÚ¡ IÁeg” &
k
, cÚ¡ IÁeg” &
e
, IÁeg” &
r
, IÁeg” &
s
) const

191 cÚ¡ 
	gIÁeg”
 &
	gq
 = 
·¿ms
.
G‘SubgroupOrd”
();

192 
	gr
 = (
r
 + 
e
è% 
q
;

193 
	gs
 = (
k
 - 
x
*
r
è% 
q
;

194 
as£¹
(!!
r
);

197 
boŞ
 
V”ify
(cÚ¡ 
DL_GroupP¬am‘”s
<
T
> &
·¿ms
, cÚ¡ 
DL_PublicKey
<T> &
publicKey
, cÚ¡ 
IÁeg”
 &
e
, cÚ¡ IÁeg” &
r
, cÚ¡ IÁeg” &
s
) const

199 cÚ¡ 
	gIÁeg”
 &
	gq
 = 
·¿ms
.
G‘SubgroupOrd”
();

200 ià(
	gr
>=
q
 || 
r
<1 || 
s
>=q)

201  
çl£
;

204  
	gr
 =ğ(
·¿ms
.
CÚv”tEËm’tToIÁeg”
(
publicKey
.
CasÿdeExpÚ’tŸ‹Ba£AndPublicEËm’t
(
s
, 
r
)è+ 
	ge
è% 
	gq
;

210 
	g‹m¶©e
 <
şass
 
	gGP
>

211 
şass
 
	gDL_PublicKey_GFP
 : 
public
 
DL_PublicKeyIm¶
<
GP
>

213 
public
:

214 
In™Ÿlize
(cÚ¡ 
DL_GroupP¬am‘”s_IÁeg”Ba£d
 &
·¿ms
, cÚ¡ 
IÁeg”
 &
y
)

215 {
	gthis
->
AcûssGroupP¬am‘”s
().
In™Ÿlize
(
·¿ms
);his->
S‘PublicEËm’t
(
y
);}

216 
In™Ÿlize
(cÚ¡ 
IÁeg”
 &
p
, cÚ¡ IÁeg” &
g
, cÚ¡ IÁeg” &
y
)

217 {
	gthis
->
AcûssGroupP¬am‘”s
().
In™Ÿlize
(
p
, 
g
);his->
S‘PublicEËm’t
(
y
);}

218 
In™Ÿlize
(cÚ¡ 
IÁeg”
 &
p
, cÚ¡ IÁeg” &
q
, cÚ¡ IÁeg” &
g
, cÚ¡ IÁeg” &
y
)

219 {
	gthis
->
AcûssGroupP¬am‘”s
().
In™Ÿlize
(
p
, 
q
, 
g
);his->
S‘PublicEËm’t
(
y
);}

222 
BERDecodePublicKey
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
, 
boŞ
, 
size_t
)

223 {
	gthis
->
S‘PublicEËm’t
(
IÁeg”
(
bt
));}

224 
DEREncodePublicKey
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
) const

225 {
	gthis
->
G‘PublicEËm’t
().
DEREncode
(
bt
);}

229 
	g‹m¶©e
 <
şass
 
	gGP
>

230 
şass
 
	gDL_Priv©eKey_GFP
 : 
public
 
DL_Priv©eKeyIm¶
<
GP
>

232 
public
:

233 
In™Ÿlize
(
RªdomNumb”G’”©Ü
 &
ºg
, 
modulusB™s
)

234 {
	gthis
->
G’”©eRªdomW™hKeySize
(
ºg
, 
modulusB™s
);}

235 
In™Ÿlize
(
RªdomNumb”G’”©Ü
 &
ºg
, cÚ¡ 
IÁeg”
 &
p
, cÚ¡ IÁeg” &
g
)

236 {
	gthis
->
G’”©eRªdom
(
ºg
, 
MakeP¬am‘”s
("Modulus", 
p
)("SubgroupG’”©Ü", 
g
));}

237 
In™Ÿlize
(
RªdomNumb”G’”©Ü
 &
ºg
, cÚ¡ 
IÁeg”
 &
p
, cÚ¡ IÁeg” &
q
, cÚ¡ IÁeg” &
g
)

238 {
	gthis
->
G’”©eRªdom
(
ºg
, 
MakeP¬am‘”s
("Modulus", 
p
)("SubgroupOrd”", 
q
)("SubgroupG’”©Ü", 
g
));}

239 
In™Ÿlize
(cÚ¡ 
DL_GroupP¬am‘”s_IÁeg”Ba£d
 &
·¿ms
, cÚ¡ 
IÁeg”
 &
x
)

240 {
	gthis
->
AcûssGroupP¬am‘”s
().
In™Ÿlize
(
·¿ms
);his->
S‘Priv©eExpÚ’t
(
x
);}

241 
In™Ÿlize
(cÚ¡ 
IÁeg”
 &
p
, cÚ¡ IÁeg” &
g
, cÚ¡ IÁeg” &
x
)

242 {
	gthis
->
AcûssGroupP¬am‘”s
().
In™Ÿlize
(
p
, 
g
);his->
S‘Priv©eExpÚ’t
(
x
);}

243 
In™Ÿlize
(cÚ¡ 
IÁeg”
 &
p
, cÚ¡ IÁeg” &
q
, cÚ¡ IÁeg” &
g
, cÚ¡ IÁeg” &
x
)

244 {
	gthis
->
AcûssGroupP¬am‘”s
().
In™Ÿlize
(
p
, 
q
, 
g
);his->
S‘Priv©eExpÚ’t
(
x
);}

248 
	sDL_SigÇtu»Keys_GFP


250 
DL_GroupP¬am‘”s_GFP
 
	tGroupP¬am‘”s
;

251 
	mDL_PublicKey_GFP
<
	tGroupP¬am‘”s
> 
	tPublicKey
;

252 
	mDL_Priv©eKey_GFP
<
	tGroupP¬am‘”s
> 
	tPriv©eKey
;

256 
	sDL_Cry±oKeys_GFP


258 
DL_GroupP¬am‘”s_GFP_DeçuÉSaãPrime
 
	tGroupP¬am‘”s
;

259 
	mDL_PublicKey_GFP
<
	tGroupP¬am‘”s
> 
	tPublicKey
;

260 
	mDL_Priv©eKey_GFP
<
	tGroupP¬am‘”s
> 
	tPriv©eKey
;

264 
	g‹m¶©e
 <
şass
 
	gBASE
>

265 şas 
	cDL_PublicKey_GFP_OldFÜm©
 : 
public
 
BASE


267 
public
:

268 
	$BERDecode
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
)

270 
BERSequ’ûDecod”
 
	`£q
(
bt
);

271 
IÁeg”
 
	`v1
(
£q
);

272 
IÁeg”
 
	`v2
(
£q
);

273 
IÁeg”
 
	`v3
(
£q
);

275 ià(
£q
.
	`EndR—ched
())

277 
this
->
	`AcûssGroupP¬am‘”s
().
	`In™Ÿlize
(
v1
, v1/2, 
v2
);

278 
this
->
	`S‘PublicEËm’t
(
v3
);

282 
IÁeg”
 
	`v4
(
£q
);

283 
this
->
	`AcûssGroupP¬am‘”s
().
	`In™Ÿlize
(
v1
, 
v2
, 
v3
);

284 
this
->
	`S‘PublicEËm’t
(
v4
);

287 
£q
.
	`Mes§geEnd
();

290 
	$DEREncode
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
) const

292 
DERSequ’ûEncod”
 
	`£q
(
bt
);

293 
this
->
	`G‘GroupP¬am‘”s
().
	`G‘Modulus
().
	`DEREncode
(
£q
);

294 ià(
this
->
	`G‘GroupP¬am‘”s
().
	`G‘CoçùÜ
() != 2)

295 
this
->
	`G‘GroupP¬am‘”s
().
	`G‘SubgroupOrd”
().
	`DEREncode
(
£q
);

296 
this
->
	`G‘GroupP¬am‘”s
().
	`G‘G’”©Ü
().
	`DEREncode
(
£q
);

297 
this
->
	`G‘PublicEËm’t
().
	`DEREncode
(
£q
);

298 
£q
.
	`Mes§geEnd
();

299 
	}
}

303 
	g‹m¶©e
 <
şass
 
	gBASE
>

304 şas 
	cDL_Priv©eKey_GFP_OldFÜm©
 : 
public
 
BASE


306 
public
:

307 
	$BERDecode
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
)

309 
BERSequ’ûDecod”
 
	`£q
(
bt
);

310 
IÁeg”
 
	`v1
(
£q
);

311 
IÁeg”
 
	`v2
(
£q
);

312 
IÁeg”
 
	`v3
(
£q
);

313 
IÁeg”
 
	`v4
(
£q
);

315 ià(
£q
.
	`EndR—ched
())

317 
this
->
	`AcûssGroupP¬am‘”s
().
	`In™Ÿlize
(
v1
, v1/2, 
v2
);

318 
this
->
	`S‘Priv©eExpÚ’t
(
v4
 % (
v1
/2));

322 
IÁeg”
 
	`v5
(
£q
);

323 
this
->
	`AcûssGroupP¬am‘”s
().
	`In™Ÿlize
(
v1
, 
v2
, 
v3
);

324 
this
->
	`S‘Priv©eExpÚ’t
(
v5
);

327 
£q
.
	`Mes§geEnd
();

330 
	$DEREncode
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
) const

332 
DERSequ’ûEncod”
 
	`£q
(
bt
);

333 
this
->
	`G‘GroupP¬am‘”s
().
	`G‘Modulus
().
	`DEREncode
(
£q
);

334 ià(
this
->
	`G‘GroupP¬am‘”s
().
	`G‘CoçùÜ
() != 2)

335 
this
->
	`G‘GroupP¬am‘”s
().
	`G‘SubgroupOrd”
().
	`DEREncode
(
£q
);

336 
this
->
	`G‘GroupP¬am‘”s
().
	`G‘G’”©Ü
().
	`DEREncode
(
£q
);

337 
this
->
	`G‘GroupP¬am‘”s
().
	`ExpÚ’tŸ‹Ba£
Ñhis->
	`G‘Priv©eExpÚ’t
()).
	`DEREncode
(
£q
);

338 
this
->
	`G‘Priv©eExpÚ’t
().
	`DEREncode
(
£q
);

339 
£q
.
	`Mes§geEnd
();

340 
	}
}

344 
	g‹m¶©e
 <
şass
 
	gH
>

345 
	gGDSA
 : 
public
 
DL_SS
<

346 
DL_SigÇtu»Keys_GFP
,

347 
	gDL_AlgÜ™hm_GDSA
<
	gIÁeg”
>,

348 
	gDL_SigÇtu»Mes§geEncodšgM‘hod_DSA
,

349 
	gH
>

354 
	g‹m¶©e
 <
şass
 
	gH
>

355 
	gNR
 : 
public
 
DL_SS
<

356 
DL_SigÇtu»Keys_GFP
,

357 
	gDL_AlgÜ™hm_NR
<
	gIÁeg”
>,

358 
	gDL_SigÇtu»Mes§geEncodšgM‘hod_NR
,

359 
	gH
>

364 şas 
	cCRYPTOPP_DLL
 
	mDL_GroupP¬am‘”s_DSA
 : 
public
 
DL_GroupP¬am‘”s_GFP


366 
public
:

368 
boŞ
 
	$V®id©eGroup
(
RªdomNumb”G’”©Ü
 &
ºg
, 
Ëv–
) const;

371 
	`G’”©eRªdom
(
RªdomNumb”G’”©Ü
 &
ºg
, cÚ¡ 
NameV®uePaœs
 &
®g
);

373 
boŞ
 
CRYPTOPP_API
 
	$IsV®idPrimeL’gth
(
pb™s
)

374 { 
pb™s
 >ğ
MIN_PRIME_LENGTH
 &&…b™ <ğ
MAX_PRIME_LENGTH
 &&…b™ % 
PRIME_LENGTH_MULTIPLE
 == 0;}

376 ’um {
MIN_PRIME_LENGTH
 = 1024, 
MAX_PRIME_LENGTH
 = 3072, 
PRIME_LENGTH_MULTIPLE
 = 1024
	}
};

379 
	g‹m¶©e
 <
şass
 
	gH
>

380 
şass
 
	gDSA2
;

383 
	sDL_Keys_DSA


385 
	mDL_PublicKey_GFP
<
	tDL_GroupP¬am‘”s_DSA
> 
	tPublicKey
;

386 
	mDL_Priv©eKey_W™hSigÇtu»Paœwi£CÚsi¡’cyTe¡
<
	tDL_Priv©eKey_GFP
<
	tDL_GroupP¬am‘”s_DSA
>, 
	tDSA2
<
	tSHA
> > 
	tPriv©eKey
;

391 
	g‹m¶©e
 <
şass
 
	gH
>

392 
şass
 
	gDSA2
 : 
public
 
DL_SS
<

393 
DL_Keys_DSA
,

394 
	gDL_AlgÜ™hm_GDSA
<
	gIÁeg”
>,

395 
	gDL_SigÇtu»Mes§geEncodšgM‘hod_DSA
,

396 
	gH
,

397 
	gDSA2
<
	gH
> >

399 
	gpublic
:

400 
¡d
::
¡ršg
 
CRYPTOPP_API
 
SticAlgÜ™hmName
(è{ "DSA/" + (¡d::¡ršg)
H
::StaticAlgorithmName();}

404 
	gDSA2
<
	tSHA
> 
	tDSA
;

406 
CRYPTOPP_DLL_TEMPLATE_CLASS
 
	gDL_PublicKey_GFP
<
	gDL_GroupP¬am‘”s_DSA
>;

407 
CRYPTOPP_DLL_TEMPLATE_CLASS
 
	gDL_Priv©eKey_GFP
<
	gDL_GroupP¬am‘”s_DSA
>;

408 
CRYPTOPP_DLL_TEMPLATE_CLASS
 
	gDL_Priv©eKey_W™hSigÇtu»Paœwi£CÚsi¡’cyTe¡
<
	gDL_Priv©eKey_GFP
<
	gDL_GroupP¬am‘”s_DSA
>, 
	gDSA2
<
	gSHA
> >;

411 
	g‹m¶©e
 <
şass
 
	gMAC
, 
boŞ
 
	gDHAES_MODE
>

412 şas 
	cDL_Enüy±iÚAlgÜ™hm_XÜ
 : 
public
 
DL_Symm‘ricEnüy±iÚAlgÜ™hm


414 
public
:

415 
boŞ
 
	$P¬am‘”SuµÜ‹d
(cÚ¡ *
Çme
ècÚ¡ { 
	`¡rcmp
Òame, 
Name
::
	`EncodšgP¬am‘”s
()) == 0;}

416 
size_t
 
	$G‘Symm‘ricKeyL’gth
(
size_t
 
¶aš‹xtL’gth
) const

417 { 
¶aš‹xtL’gth
 + 
MAC
::
DEFAULT_KEYLENGTH
;
	}
}

418 
size_t
 
	$G‘Symm‘ricCh”‹xtL’gth
(
size_t
 
¶aš‹xtL’gth
) const

419 { 
¶aš‹xtL’gth
 + 
MAC
::
DIGESTSIZE
;
	}
}

420 
size_t
 
	$G‘MaxSymm‘ricPÏš‹xtL’gth
(
size_t
 
ch”‹xtL’gth
) const

421 { ()
	`S©u¿tšgSubŒaù
(
ch”‹xtL’gth
, ()
MAC
::
DIGESTSIZE
);
	}
}

422 
	$Symm‘ricEnüy±
(
RªdomNumb”G’”©Ü
 &
ºg
, cÚ¡ 
by‹
 *
key
, cÚ¡ by‹ *
¶aš‹xt
, 
size_t
 
¶aš‹xtL’gth
, by‹ *
ch”‹xt
, cÚ¡ 
NameV®uePaœs
 &
·¿m‘”s
) const

424 cÚ¡ 
by‹
 *
ch”Key
, *
macKey
;

425 ià(
DHAES_MODE
)

427 
macKey
 = 
key
;

428 
ch”Key
 = 
key
 + 
MAC
::
DEFAULT_KEYLENGTH
;

432 
ch”Key
 = 
key
;

433 
macKey
 = 
key
 + 
¶aš‹xtL’gth
;

436 
CÚ¡By‹A¼ayP¬am‘”
 
’codšgP¬am‘”s
;

437 
·¿m‘”s
.
	`G‘V®ue
(
Name
::
	`EncodšgP¬am‘”s
(), 
’codšgP¬am‘”s
);

439 
	`xÜbuf
(
ch”‹xt
, 
¶aš‹xt
, 
ch”Key
, 
¶aš‹xtL’gth
);

440 
MAC
 
	`mac
(
macKey
);

441 
mac
.
	`Upd©e
(
ch”‹xt
, 
¶aš‹xtL’gth
);

442 
mac
.
	`Upd©e
(
’codšgP¬am‘”s
.
	`begš
(),ƒncodšgP¬am‘”s.
	`size
());

443 ià(
DHAES_MODE
)

445 
by‹
 
L
[8] = {0,0,0,0};

446 
	`PutWÜd
(
çl£
, 
BIG_ENDIAN_ORDER
, 
L
+4, 
	`wÜd32
(
’codšgP¬am‘”s
.
	`size
()));

447 
mac
.
	`Upd©e
(
L
, 8);

449 
mac
.
	`Fš®
(
ch”‹xt
 + 
¶aš‹xtL’gth
);

450 
	}
}

451 
DecodšgResuÉ
 
	$Symm‘ricDeüy±
(cÚ¡ 
by‹
 *
key
, cÚ¡ by‹ *
ch”‹xt
, 
size_t
 
ch”‹xtL’gth
, by‹ *
¶aš‹xt
, cÚ¡ 
NameV®uePaœs
 &
·¿m‘”s
) const

453 
size_t
 
¶aš‹xtL’gth
 = 
	`G‘MaxSymm‘ricPÏš‹xtL’gth
(
ch”‹xtL’gth
);

454 cÚ¡ 
by‹
 *
ch”Key
, *
macKey
;

455 ià(
DHAES_MODE
)

457 
macKey
 = 
key
;

458 
ch”Key
 = 
key
 + 
MAC
::
DEFAULT_KEYLENGTH
;

462 
ch”Key
 = 
key
;

463 
macKey
 = 
key
 + 
¶aš‹xtL’gth
;

466 
CÚ¡By‹A¼ayP¬am‘”
 
’codšgP¬am‘”s
;

467 
·¿m‘”s
.
	`G‘V®ue
(
Name
::
	`EncodšgP¬am‘”s
(), 
’codšgP¬am‘”s
);

469 
MAC
 
	`mac
(
macKey
);

470 
mac
.
	`Upd©e
(
ch”‹xt
, 
¶aš‹xtL’gth
);

471 
mac
.
	`Upd©e
(
’codšgP¬am‘”s
.
	`begš
(),ƒncodšgP¬am‘”s.
	`size
());

472 ià(
DHAES_MODE
)

474 
by‹
 
L
[8] = {0,0,0,0};

475 
	`PutWÜd
(
çl£
, 
BIG_ENDIAN_ORDER
, 
L
+4, 
	`wÜd32
(
’codšgP¬am‘”s
.
	`size
()));

476 
mac
.
	`Upd©e
(
L
, 8);

478 ià(!
mac
.
	`V”ify
(
ch”‹xt
 + 
¶aš‹xtL’gth
))

479  
	`DecodšgResuÉ
();

481 
	`xÜbuf
(
¶aš‹xt
, 
ch”‹xt
, 
ch”Key
, 
¶aš‹xtL’gth
);

482  
	`DecodšgResuÉ
(
¶aš‹xtL’gth
);

483 
	}
}

487 
	g‹m¶©e
 <
şass
 
	gT
, 
boŞ
 
	gDHAES_MODE
, cÏs 
	gKDF
>

488 
şass
 
	gDL_KeyD”iv©iÚAlgÜ™hm_P1363
 : 
public
 
DL_KeyD”iv©iÚAlgÜ™hm
<
T
>

490 
public
:

491 
boŞ
 
P¬am‘”SuµÜ‹d
(cÚ¡ *
Çme
ècÚ¡ { 
¡rcmp
Òame, 
Name
::
KeyD”iv©iÚP¬am‘”s
()) == 0;}

492 
D”ive
(cÚ¡ 
DL_GroupP¬am‘”s
<
T
> &
·¿ms
, 
by‹
 *
d”ivedKey
, 
size_t
 
d”ivedL’gth
, cÚ¡ T &
ag»edEËm’t
, cÚ¡ T &
•hem”®PublicKey
, cÚ¡ 
NameV®uePaœs
 &
·¿m‘”s
) const

494 
SecBy‹Block
 
	gag»edSeü‘
;

495 ià(
	gDHAES_MODE
)

497 
	gag»edSeü‘
.
New
(
·¿ms
.
G‘EncodedEËm’tSize
(
Œue
è+…¬ams.G‘EncodedEËm’tSize(
çl£
));

498 
	g·¿ms
.
EncodeEËm’t
(
Œue
, 
•hem”®PublicKey
, 
ag»edSeü‘
);

499 
	g·¿ms
.
EncodeEËm’t
(
çl£
, 
ag»edEËm’t
, 
ag»edSeü‘
 + 
·¿ms
.
G‘EncodedEËm’tSize
(
Œue
));

503 
	gag»edSeü‘
.
New
(
·¿ms
.
G‘EncodedEËm’tSize
(
çl£
));

504 
	g·¿ms
.
EncodeEËm’t
(
çl£
, 
ag»edEËm’t
, 
ag»edSeü‘
);

507 
CÚ¡By‹A¼ayP¬am‘”
 
	gd”iv©iÚP¬am‘”s
;

508 
	g·¿m‘”s
.
G‘V®ue
(
Name
::
KeyD”iv©iÚP¬am‘”s
(), 
d”iv©iÚP¬am‘”s
);

509 
	gKDF
::
D”iveKey
(
d”ivedKey
, 
d”ivedL’gth
, 
ag»edSeü‘
,‡g»edSeü‘.
size
(), 
d”iv©iÚP¬am‘”s
.
begš
(), derivationParameters.size());

514 
	g‹m¶©e
 <
şass
 
	gCOFACTOR_OPTION
 = 
NoCoçùÜMuÉliÿtiÚ
, 
boŞ
 
	gDHAES_MODE
 = 
Œue
>

515 
DLIES


516 : 
public
 
DL_ES
<

517 
DL_Cry±oKeys_GFP
,

518 
	gDL_KeyAg»em’tAlgÜ™hm_DH
<
	gIÁeg”
, 
	gCOFACTOR_OPTION
>,

519 
	gDL_KeyD”iv©iÚAlgÜ™hm_P1363
<
	gIÁeg”
, 
	gDHAES_MODE
, 
	gP1363_KDF2
<
	gSHA1
> >,

520 
	gDL_Enüy±iÚAlgÜ™hm_XÜ
<
	gHMAC
<
	gSHA1
>, 
	gDHAES_MODE
>,

521 
	gDLIES
<> >

523 
	g¡d
::
¡ršg
 
CRYPTOPP_API
 
SticAlgÜ™hmName
() { "DLIES";}

526 
	gNAMESPACE_END


	@gost.cpp

1 
	~"pch.h
"

2 
	~"go¡.h
"

3 
	~"misc.h
"

5 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

8 cÚ¡ 
by‹
 
GOST
::
Ba£
::
sBox
[8][16]={

16 {1, 15, 13, 0, 5, 7, 10, 4, 9, 2, 3, 14, 6, 11, 8, 12}
	}
};

30 vŞ©
boŞ
 
	gGOST
::
Ba£
::
sTabËC®cuÏ‹d
 = 
çl£
;

31 
wÜd32
 
	gGOST
::
Ba£
::
sTabË
[4][256];

33 
	gGOST
::
Ba£
::
	$UncheckedS‘Key
(cÚ¡ 
by‹
 *
u£rKey
, 
Ëngth
, cÚ¡ 
NameV®uePaœs
 &)

35 
	`As£¹V®idKeyL’gth
(
Ëngth
);

37 
	`P»ÿlcuÏ‹STabË
();

39 
	`G‘U£rKey
(
LITTLE_ENDIAN_ORDER
, 
key
.
	`begš
(), 8, 
u£rKey
, 
KEYLENGTH
);

40 
	}
}

42 
	gGOST
::
Ba£
::
	$P»ÿlcuÏ‹STabË
()

44 ià(!
sTabËC®cuÏ‹d
)

46 
i
 = 0; i < 4; i++)

47 
j
 = 0; j < 256; j++)

49 
wÜd32
 
‹mp
 = 
sBox
[2*
i
][
j
%16] | (sBox[2*i+1][j/16] << 4);

50 
sTabË
[
i
][
j
] = 
	`rÙlMod
(
‹mp
, 11+8*i);

53 
sTabËC®cuÏ‹d
=
Œue
;

55 
	}
}

57 
	#f
(
x
èĞ
t
=x, \

58 
sTabË
[3][
	`GETBYTE
(
t
, 3)] ^ sTable[2][GETBYTE(t, 2)] \

59 ^ 
sTabË
[1][
	`GETBYTE
(
t
, 1)] ^ sTabË[0][GETBYTEÑ, 0)] )

	)

61 
	gBlockG‘AndPut
<
	twÜd32
, 
	tL™eEndŸn
> 
	tBlock
;

63 
	gGOST
::
Enc
::
	$ProûssAndXÜBlock
(cÚ¡ 
by‹
 *
šBlock
, cÚ¡ by‹ *
xÜBlock
, by‹ *
outBlock
) const

65 
wÜd32
 
n1
, 
n2
, 
t
;

67 
Block
::
	`G‘
(
šBlock
)(
n1
)(
n2
);

69 
i
=0; i<3; i++)

71 
n2
 ^ğ
	`f
(
n1
+
key
[0]);

72 
n1
 ^ğ
	`f
(
n2
+
key
[1]);

73 
n2
 ^ğ
	`f
(
n1
+
key
[2]);

74 
n1
 ^ğ
	`f
(
n2
+
key
[3]);

75 
n2
 ^ğ
	`f
(
n1
+
key
[4]);

76 
n1
 ^ğ
	`f
(
n2
+
key
[5]);

77 
n2
 ^ğ
	`f
(
n1
+
key
[6]);

78 
n1
 ^ğ
	`f
(
n2
+
key
[7]);

81 
n2
 ^ğ
	`f
(
n1
+
key
[7]);

82 
n1
 ^ğ
	`f
(
n2
+
key
[6]);

83 
n2
 ^ğ
	`f
(
n1
+
key
[5]);

84 
n1
 ^ğ
	`f
(
n2
+
key
[4]);

85 
n2
 ^ğ
	`f
(
n1
+
key
[3]);

86 
n1
 ^ğ
	`f
(
n2
+
key
[2]);

87 
n2
 ^ğ
	`f
(
n1
+
key
[1]);

88 
n1
 ^ğ
	`f
(
n2
+
key
[0]);

90 
Block
::
	`Put
(
xÜBlock
, 
outBlock
)(
n2
)(
n1
);

91 
	}
}

93 
	gGOST
::
Dec
::
	$ProûssAndXÜBlock
(cÚ¡ 
by‹
 *
šBlock
, cÚ¡ by‹ *
xÜBlock
, by‹ *
outBlock
) const

95 
wÜd32
 
n1
, 
n2
, 
t
;

97 
Block
::
	`G‘
(
šBlock
)(
n1
)(
n2
);

99 
n2
 ^ğ
	`f
(
n1
+
key
[0]);

100 
n1
 ^ğ
	`f
(
n2
+
key
[1]);

101 
n2
 ^ğ
	`f
(
n1
+
key
[2]);

102 
n1
 ^ğ
	`f
(
n2
+
key
[3]);

103 
n2
 ^ğ
	`f
(
n1
+
key
[4]);

104 
n1
 ^ğ
	`f
(
n2
+
key
[5]);

105 
n2
 ^ğ
	`f
(
n1
+
key
[6]);

106 
n1
 ^ğ
	`f
(
n2
+
key
[7]);

108 
i
=0; i<3; i++)

110 
n2
 ^ğ
	`f
(
n1
+
key
[7]);

111 
n1
 ^ğ
	`f
(
n2
+
key
[6]);

112 
n2
 ^ğ
	`f
(
n1
+
key
[5]);

113 
n1
 ^ğ
	`f
(
n2
+
key
[4]);

114 
n2
 ^ğ
	`f
(
n1
+
key
[3]);

115 
n1
 ^ğ
	`f
(
n2
+
key
[2]);

116 
n2
 ^ğ
	`f
(
n1
+
key
[1]);

117 
n1
 ^ğ
	`f
(
n2
+
key
[0]);

120 
Block
::
	`Put
(
xÜBlock
, 
outBlock
)(
n2
)(
n1
);

121 
	}
}

123 
	gNAMESPACE_END


	@gost.h

1 #iâdeà
CRYPTOPP_GOST_H


2 
	#CRYPTOPP_GOST_H


	)

7 
	~"£ckey.h
"

8 
	~"£cblock.h
"

10 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

13 
GOST_Info
 : 
public
 
FixedBlockSize
<8>,…ubliø
FixedKeyL’gth
<32>

15 cÚ¡ *
	`SticAlgÜ™hmName
() { "GOST";}

16 
	}
};

19 
şass
 
	gGOST
 : 
public
 
GOST_Info
,…ubliø
	gBlockCh”Docum’tiÚ


21 
şass
 
CRYPTOPP_NO_VTABLE
 
	gBa£
 : 
public
 
BlockCh”Im¶
<
GOST_Info
>

23 
public
:

24 
UncheckedS‘Key
(cÚ¡ 
by‹
 *
u£rKey
, 
Ëngth
, cÚ¡ 
NameV®uePaœs
 &
·¿ms
);

26 
	g´Ùeùed
:

27 
P»ÿlcuÏ‹STabË
();

29 cÚ¡ 
by‹
 
	gsBox
[8][16];

30 vŞ©
boŞ
 
	gsTabËC®cuÏ‹d
;

31 
wÜd32
 
	gsTabË
[4][256];

33 
	gFixedSizeSecBlock
<
	gwÜd32
, 8> 
	gkey
;

36 şas 
	cCRYPTOPP_NO_VTABLE
 
	gEnc
 : 
public
 
Ba£


38 
public
:

39 
ProûssAndXÜBlock
(cÚ¡ 
by‹
 *
šBlock
, cÚ¡ by‹ *
xÜBlock
, by‹ *
outBlock
) const;

42 şas 
	cCRYPTOPP_NO_VTABLE
 
	gDec
 : 
public
 
Ba£


44 
public
:

45 
ProûssAndXÜBlock
(cÚ¡ 
by‹
 *
šBlock
, cÚ¡ by‹ *
xÜBlock
, by‹ *
outBlock
) const;

48 
	gpublic
:

49 
BlockCh”Fš®
<
	tENCRYPTION
, 
	tEnc
> 
	tEnüy±iÚ
;

50 
	gBlockCh”Fš®
<
	tDECRYPTION
, 
	tDec
> 
	tDeüy±iÚ
;

53 
	gGOST
::
	tEnüy±iÚ
 
	tGOSTEnüy±iÚ
;

54 
	gGOST
::
	tDeüy±iÚ
 
	tGOSTDeüy±iÚ
;

56 
	gNAMESPACE_END


	@gzip.cpp

3 
	~"pch.h
"

4 
	~"gz.h
"

6 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

8 
Gz
::
	$Wr™eP»¡»amH—d”
()

10 
m_tÙ®L’
 = 0;

11 
m_üc
.
	`Re¡¬t
();

13 
	`A‰achedT¿nsfÜm©iÚ
()->
	`Put
(
MAGIC1
);

14 
	`A‰achedT¿nsfÜm©iÚ
()->
	`Put
(
MAGIC2
);

15 
	`A‰achedT¿nsfÜm©iÚ
()->
	`Put
(
DEFLATED
);

16 
	`A‰achedT¿nsfÜm©iÚ
()->
	`Put
(0);

17 
	`A‰achedT¿nsfÜm©iÚ
()->
	`PutWÜd32
(0);

18 
by‹
 
exŒa
 = (
	`G‘Deæ©eLev–
(è=ğ1è? 
FAST
 : ((G‘Deæ©eLev–(è=ğ9è? 
SLOW
 : 0);

19 
	`A‰achedT¿nsfÜm©iÚ
()->
	`Put
(
exŒa
);

20 
	`A‰achedT¿nsfÜm©iÚ
()->
	`Put
(
GZIP_OS_CODE
);

21 
	}
}

23 
	gGz
::
	$ProûssUncom´es£dD©a
(cÚ¡ 
by‹
 *
šSŒšg
, 
size_t
 
Ëngth
)

25 
m_üc
.
	`Upd©e
(
šSŒšg
, 
Ëngth
);

26 
m_tÙ®L’
 +ğ(
wÜd32
)
Ëngth
;

27 
	}
}

29 
	gGz
::
	$Wr™ePo¡¡»amTa
()

31 
SecBy‹Block
 
	`üc
(4);

32 
m_üc
.
	`Fš®
(
üc
);

33 
	`A‰achedT¿nsfÜm©iÚ
()->
	`Put
(
üc
, 4);

34 
	`A‰achedT¿nsfÜm©iÚ
()->
	`PutWÜd32
(
m_tÙ®L’
, 
LITTLE_ENDIAN_ORDER
);

35 
	}
}

39 
	gGunz
::
	$Gunz
(
Bufã»dT¿nsfÜm©iÚ
 *
©chm’t
, 
boŞ
 
»³©
, 
´İag©iÚ
)

40 : 
	$Inæ©Ü
(
©chm’t
, 
»³©
, 
´İag©iÚ
)

42 
	}
}

44 
	gGunz
::
	$ProûssP»¡»amH—d”
()

46 
m_Ëngth
 = 0;

47 
m_üc
.
	`Re¡¬t
();

49 
by‹
 
buf
[6];

50 
by‹
 
b
, 
æags
;

52 ià(
m_šQueue
.
	`G‘
(
buf
, 2)!=2è
throw
 
	`H—d”E¼
();

53 ià(
buf
[0] !ğ
MAGIC1
 || buf[1] !ğ
MAGIC2
è
throw
 
	`H—d”E¼
();

54 ià(!
m_šQueue
.
	`Sk
(1)è
throw
 
	`H—d”E¼
();

55 ià(!
m_šQueue
.
	`G‘
(
æags
)è
throw
 
	`H—d”E¼
();

56 ià(
æags
 & (
ENCRYPTED
 | 
CONTINUED
)è
throw
 
	`H—d”E¼
();

57 ià(
m_šQueue
.
	`Sk
(6)!=6è
throw
 
	`H—d”E¼
();

59 ià(
æags
 & 
EXTRA_FIELDS
)

61 
wÜd16
 
Ëngth
;

62 ià(
m_šQueue
.
	`G‘WÜd16
(
Ëngth
, 
LITTLE_ENDIAN_ORDER
è!ğ2è
throw
 
	`H—d”E¼
();

63 ià(
m_šQueue
.
	`Sk
(
Ëngth
)!ö’gthè
throw
 
	`H—d”E¼
();

66 ià(
æags
 & 
FILENAME
)

68 if(!
m_šQueue
.
	`G‘
(
b
)è
throw
 
	`H—d”E¼
();

69 
b
);

71 ià(
æags
 & 
COMMENTS
)

73 if(!
m_šQueue
.
	`G‘
(
b
)è
throw
 
	`H—d”E¼
();

74 
b
);

75 
	}
}

77 
	gGunz
::
	$ProûssDecom´es£dD©a
(cÚ¡ 
by‹
 *
šSŒšg
, 
size_t
 
Ëngth
)

79 
	`A‰achedT¿nsfÜm©iÚ
()->
	`Put
(
šSŒšg
, 
Ëngth
);

80 
m_üc
.
	`Upd©e
(
šSŒšg
, 
Ëngth
);

81 
m_Ëngth
 +ğ(
wÜd32
)
Ëngth
;

82 
	}
}

84 
	gGunz
::
	$ProûssPo¡¡»amTa
()

86 
SecBy‹Block
 
	`üc
(4);

87 ià(
m_šQueue
.
	`G‘
(
üc
, 4) != 4)

88 
throw
 
	`TaE¼
();

89 ià(!
m_üc
.
	`V”ify
(
üc
))

90 
throw
 
	`CrcE¼
();

92 
wÜd32
 
ËngthCheck
;

93 ià(
m_šQueue
.
	`G‘WÜd32
(
ËngthCheck
, 
LITTLE_ENDIAN_ORDER
) != 4)

94 
throw
 
	`TaE¼
();

95 ià(
ËngthCheck
 !ğ
m_Ëngth
)

96 
throw
 
	`L’gthE¼
();

97 
	}
}

99 
	gNAMESPACE_END


	@gzip.h

1 #iâdeà
CRYPTOPP_GZIP_H


2 
	#CRYPTOPP_GZIP_H


	)

4 
	~"zdeæ©e.h
"

5 
	~"zšæ©e.h
"

6 
	~"üc.h
"

8 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

11 şas 
	cGz
 : 
public
 
Deæ©Ü


13 
public
:

14 
	$Gz
(
Bufã»dT¿nsfÜm©iÚ
 *
©chm’t
=
NULL
, 
deæ©eLev–
=
DEFAULT_DEFLATE_LEVEL
, 
log2WšdowSize
=
DEFAULT_LOG2_WINDOW_SIZE
, 
boŞ
 
d‘eùUncom´essibË
=
Œue
)

15 : 
	$Deæ©Ü
(
©chm’t
, 
deæ©eLev–
, 
log2WšdowSize
, 
d‘eùUncom´essibË
) {}

16 
	$Gz
(cÚ¡ 
NameV®uePaœs
 &
·¿m‘”s
, 
Bufã»dT¿nsfÜm©iÚ
 *
©chm’t
=
NULL
)

17 : 
	$Deæ©Ü
(
·¿m‘”s
, 
©chm’t
è{
	}
}

19 
	g´Ùeùed
:

20 ’um {
MAGIC1
=0x1f, 
	gMAGIC2
=0x8b,

21 
	gDEFLATED
=8, 
	gFAST
=4, 
	gSLOW
=2};

23 
Wr™eP»¡»amH—d”
();

24 
ProûssUncom´es£dD©a
(cÚ¡ 
by‹
 *
¡ršg
, 
size_t
 
Ëngth
);

25 
Wr™ePo¡¡»amTa
();

27 
wÜd32
 
	gm_tÙ®L’
;

28 
CRC32
 
	gm_üc
;

32 şas 
	cGunz
 : 
public
 
Inæ©Ü


34 
public
:

35 
Inæ©Ü
::
	tE¼
 Err;

36 şas 
	cH—d”E¼
 : 
public
 
E¼
 {public: 
H—d”E¼
(è: E¼(
INVALID_DATA_FORMAT
, "Gunzip: header decodingƒrror") {}};

37 şas 
	cTaE¼
 : 
public
 
E¼
 {public: 
TaE¼
(è: E¼(
INVALID_DATA_FORMAT
, "Gunzip:ailoo short") {}};

38 şas 
	cCrcE¼
 : 
public
 
E¼
 {public: 
CrcE¼
(è: E¼(
DATA_INTEGRITY_CHECK_FAILED
, "Gunzip: CRC checkƒrror") {}};

39 şas 
	cL’gthE¼
 : 
public
 
E¼
 {public: 
L’gthE¼
(è: E¼(
DATA_INTEGRITY_CHECK_FAILED
, "Gunzip:†ength checkƒrror") {}};

44 
Gunz
(
Bufã»dT¿nsfÜm©iÚ
 *
©chm’t
 = 
NULL
, 
boŞ
 
»³©
 = 
çl£
, 
autoSigÇlPrİag©iÚ
 = -1);

46 
	g´Ùeùed
:

47 ’um {
MAGIC1
=0x1f, 
	gMAGIC2
=0x8b,

48 
	gDEFLATED
=8};

50 
	eFLAG_MASKS
 {

51 
	gCONTINUED
=2, 
	gEXTRA_FIELDS
=4, 
	gFILENAME
=8, 
	gCOMMENTS
=16, 
	gENCRYPTED
=32};

53 
	$MaxP»¡»amH—d”Size
(ècÚ¡ { 1024;
	}
}

54 
ProûssP»¡»amH—d”
();

55 
ProûssDecom´es£dD©a
(cÚ¡ 
by‹
 *
¡ršg
, 
size_t
 
Ëngth
);

56 
	$MaxPo¡¡»amTaSize
(ècÚ¡ { 8;
	}
}

57 
ProûssPo¡¡»amTa
();

59 
wÜd32
 
	gm_Ëngth
;

60 
CRC32
 
	gm_üc
;

63 
	gNAMESPACE_END


	@hex.cpp

3 
	~"pch.h
"

5 #iâdeà
CRYPTOPP_IMPORTS


7 
	~"hex.h
"

9 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

11 cÚ¡ 
by‹
 
s_vecUµ”
[] = "0123456789ABCDEF";

12 cÚ¡ 
by‹
 
s_vecLow”
[] = "0123456789abcdef";

14 
HexEncod”
::
	$IsŞ©edIn™Ÿlize
(cÚ¡ 
NameV®uePaœs
 &
·¿m‘”s
)

16 
boŞ
 
uµ”ÿ£
 = 
·¿m‘”s
.
	`G‘V®ueW™hDeçuÉ
(
Name
::
	`Uµ”ÿ£
(), 
Œue
);

17 
m_f‹r
->
	`In™Ÿlize
(
	`CombšedNameV®uePaœs
(

18 
·¿m‘”s
,

19 
	`MakeP¬am‘”s
(
Name
::
	`EncodšgLookupA¼ay
(), 
uµ”ÿ£
 ? &
s_vecUµ”
[0] : &
s_vecLow”
[0], 
çl£
)(Name::
	`Log2Ba£
(), 4, 
Œue
)));

20 
	}
}

22 
	gHexDecod”
::
	$IsŞ©edIn™Ÿlize
(cÚ¡ 
NameV®uePaœs
 &
·¿m‘”s
)

24 
Ba£N_Decod”
::
	`IsŞ©edIn™Ÿlize
(
	`CombšedNameV®uePaœs
(

25 
·¿m‘”s
,

26 
	`MakeP¬am‘”s
(
Name
::
	`DecodšgLookupA¼ay
(), 
	`G‘DeçuÉDecodšgLookupA¼ay
(), 
çl£
)(Name::
	`Log2Ba£
(), 4, 
Œue
)));

27 
	}
}

29 cÚ¡ *
	gHexDecod”
::
	$G‘DeçuÉDecodšgLookupA¼ay
()

31 vŞ©
boŞ
 
s_š™Ÿlized
 = 
çl£
;

32 
s_¬¿y
[256];

34 ià(!
s_š™Ÿlized
)

36 
	`In™ŸlizeDecodšgLookupA¼ay
(
s_¬¿y
, 
s_vecUµ”
, 16, 
Œue
);

37 
s_š™Ÿlized
 = 
Œue
;

39  
s_¬¿y
;

40 
	}
}

42 
	gNAMESPACE_END


	@hex.h

1 #iâdeà
CRYPTOPP_HEX_H


2 
	#CRYPTOPP_HEX_H


	)

4 
	~"ba£code.h
"

6 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

9 şas 
	cCRYPTOPP_DLL
 
HexEncod”
 : 
public
 
Sim¶eProxyF‹r


11 
public
:

12 
	`HexEncod”
(
Bufã»dT¿nsfÜm©iÚ
 *
©chm’t
 = 
NULL
, 
boŞ
 
uµ”ÿ£
 = 
Œue
, 
ouutGroupSize
 = 0, cÚ¡ 
¡d
::
¡ršg
 &
£·¿tÜ
 = ":", cÚ¡ std::¡ršg &
‹rmš©Ü
 = "")

13 : 
	`Sim¶eProxyF‹r
(
Ãw
 
	`Ba£N_Encod”
Òew 
Grou³r
), 
©chm’t
)

15 
	`IsŞ©edIn™Ÿlize
(
	`MakeP¬am‘”s
(
Name
::
	`Uµ”ÿ£
(), 
uµ”ÿ£
)(Name::
	`GroupSize
(), 
ouutGroupSize
)(Name::
	`S•¬©Ü
(), 
	`CÚ¡By‹A¼ayP¬am‘”
(
£·¿tÜ
))(Name::
	`T”mš©Ü
(), CÚ¡By‹A¼ayP¬am‘”(
‹rmš©Ü
)));

18 
	`IsŞ©edIn™Ÿlize
(cÚ¡ 
NameV®uePaœs
 &
·¿m‘”s
);

19 
	}
};

22 şas 
	cCRYPTOPP_DLL
 
	mHexDecod”
 : 
public
 
Ba£N_Decod”


24 
public
:

25 
	$HexDecod”
(
Bufã»dT¿nsfÜm©iÚ
 *
©chm’t
 = 
NULL
)

26 : 
	`Ba£N_Decod”
(
	`G‘DeçuÉDecodšgLookupA¼ay
(), 4, 
©chm’t
) {}

28 
	`IsŞ©edIn™Ÿlize
(cÚ¡ 
NameV®uePaœs
 &
·¿m‘”s
);

30 
´iv©e
:

31 cÚ¡ * 
CRYPTOPP_API
 
	`G‘DeçuÉDecodšgLookupA¼ay
();

32 
	}
};

34 
	gNAMESPACE_END


	@hmac.cpp

3 
	~"pch.h
"

5 #iâdeà
CRYPTOPP_IMPORTS


7 
	~"hmac.h
"

9 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

11 
HMAC_Ba£
::
	$UncheckedS‘Key
(cÚ¡ 
by‹
 *
u£rKey
, 
keyËngth
, cÚ¡ 
NameV®uePaœs
 &)

13 
	`As£¹V®idKeyL’gth
(
keyËngth
);

15 
	`Re¡¬t
();

17 
HashT¿nsfÜm©iÚ
 &
hash
 = 
	`AcûssHash
();

18 
blockSize
 = 
hash
.
	`BlockSize
();

20 ià(!
blockSize
)

21 
throw
 
	`Inv®idArgum’t
("HMAC: can only be used with‡ block-based hash function");

23 
m_buf
.
	`»size
(2*
	`AcûssHash
().
	`BlockSize
(è+ AcûssHash().
	`Dige¡Size
());

25 ià(
keyËngth
 <ğ
blockSize
)

26 
	`memıy
(
	`AcûssI·d
(), 
u£rKey
, 
keyËngth
);

29 
	`AcûssHash
().
	`C®cuÏ‹Dige¡
(
	`AcûssI·d
(), 
u£rKey
, 
keyËngth
);

30 
keyËngth
 = 
hash
.
	`Dige¡Size
();

33 
	`as£¹
(
keyËngth
 <ğ
blockSize
);

34 
	`mem£t
(
	`AcûssI·d
()+
keyËngth
, 0, 
blockSize
-keylength);

36 
i
=0; i<
blockSize
; i++)

38 
	`AcûssO·d
()[
i
] = 
	`AcûssI·d
()[i] ^ 0x5c;

39 
	`AcûssI·d
()[
i
] ^= 0x36;

41 
	}
}

43 
	gHMAC_Ba£
::
	$KeyIÂ”Hash
()

45 
	`as£¹
(!
m_šÃrHashKeyed
);

46 
HashT¿nsfÜm©iÚ
 &
hash
 = 
	`AcûssHash
();

47 
hash
.
	`Upd©e
(
	`AcûssI·d
(), hash.
	`BlockSize
());

48 
m_šÃrHashKeyed
 = 
Œue
;

49 
	}
}

51 
	gHMAC_Ba£
::
	$Re¡¬t
()

53 ià(
m_šÃrHashKeyed
)

55 
	`AcûssHash
().
	`Re¡¬t
();

56 
m_šÃrHashKeyed
 = 
çl£
;

58 
	}
}

60 
	gHMAC_Ba£
::
	$Upd©e
(cÚ¡ 
by‹
 *
šput
, 
size_t
 
Ëngth
)

62 ià(!
m_šÃrHashKeyed
)

63 
	`KeyIÂ”Hash
();

64 
	`AcûssHash
().
	`Upd©e
(
šput
, 
Ëngth
);

65 
	}
}

67 
	gHMAC_Ba£
::
	$Trunÿ‹dFš®
(
by‹
 *
mac
, 
size_t
 
size
)

69 
	`ThrowIfInv®idTrunÿ‹dSize
(
size
);

71 
HashT¿nsfÜm©iÚ
 &
hash
 = 
	`AcûssHash
();

73 ià(!
m_šÃrHashKeyed
)

74 
	`KeyIÂ”Hash
();

75 
hash
.
	`Fš®
(
	`AcûssIÂ”Hash
());

77 
hash
.
	`Upd©e
(
	`AcûssO·d
(), hash.
	`BlockSize
());

78 
hash
.
	`Upd©e
(
	`AcûssIÂ”Hash
(), hash.
	`Dige¡Size
());

79 
hash
.
	`Trunÿ‹dFš®
(
mac
, 
size
);

81 
m_šÃrHashKeyed
 = 
çl£
;

82 
	}
}

84 
	gNAMESPACE_END


	@hmac.h

3 #iâdeà
CRYPTOPP_HMAC_H


4 
	#CRYPTOPP_HMAC_H


	)

6 
	~"£ckey.h
"

7 
	~"£cblock.h
"

9 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

12 
şass
 
CRYPTOPP_DLL
 
CRYPTOPP_NO_VTABLE
 
HMAC_Ba£
 : 
public
 
V¬ŸbËKeyL’gth
<16, 0, 
INT_MAX
>,…ubliø
Mes§geAuth’tiÿtiÚCode


14 
public
:

15 
	`HMAC_Ba£
(è: 
	`m_šÃrHashKeyed
(
çl£
) {}

16 
	`UncheckedS‘Key
(cÚ¡ 
by‹
 *
u£rKey
, 
keyËngth
, cÚ¡ 
NameV®uePaœs
 &
·¿ms
);

18 
	`Re¡¬t
();

19 
	`Upd©e
(cÚ¡ 
by‹
 *
šput
, 
size_t
 
Ëngth
);

20 
	`Trunÿ‹dFš®
(
by‹
 *
mac
, 
size_t
 
size
);

21 
	`O±im®BlockSize
(ècÚ¡ { 
cÚ¡_ÿ¡
<
HMAC_Ba£
*>(
this
)->
	`AcûssHash
().OptimalBlockSize();}

22 
	`Dige¡Size
(ècÚ¡ { 
cÚ¡_ÿ¡
<
HMAC_Ba£
*>(
this
)->
	`AcûssHash
().DigestSize();}

24 
´Ùeùed
:

25 
vœtu®
 
HashT¿nsfÜm©iÚ
 & 
	`AcûssHash
() =0;

26 
by‹
 * 
	`AcûssI·d
(è{ 
m_buf
;}

27 
by‹
 * 
	`AcûssO·d
(è{ 
m_buf
 + 
	`AcûssHash
().
	`BlockSize
();}

28 
by‹
 * 
	`AcûssIÂ”Hash
(è{ 
m_buf
 + 2*
	`AcûssHash
().
	`BlockSize
();}

30 
´iv©e
:

31 
	`KeyIÂ”Hash
();

33 
SecBy‹Block
 
m_buf
;

34 
boŞ
 
m_šÃrHashKeyed
;

35 
	}
};

39 
	g‹m¶©e
 <
şass
 
	gT
>

40 
şass
 
	gHMAC
 : 
public
 
Mes§geAuth’tiÿtiÚCodeIm¶
<
HMAC_Ba£
, HMAC<
	gT
> >

42 
	gpublic
:

43 
CRYPTOPP_CONSTANT
(
DIGESTSIZE
=
T
::DIGESTSIZE)

44 
CRYPTOPP_CONSTANT
(
BLOCKSIZE
=
T
::BLOCKSIZE)

46 
HMAC
() {}

47 
HMAC
(cÚ¡ 
by‹
 *
key
, 
size_t
 
Ëngth
=
HMAC_Ba£
::
DEFAULT_KEYLENGTH
)

48 {
this
->
S‘Key
(
key
, 
Ëngth
);}

50 
	g¡d
::
¡ršg
 
SticAlgÜ™hmName
(è{ 
¡d
::¡ršg("HMAC("è+ 
T
::StaticAlgorithmName() + ")";}

51 
	g¡d
::
¡ršg
 
AlgÜ™hmName
(ècÚ¡ { 
¡d
::¡ršg("HMAC("è+ 
m_hash
.AlgorithmName() + ")";}

53 
	g´iv©e
:

54 
HashT¿nsfÜm©iÚ
 & 
AcûssHash
(è{ 
m_hash
;}

56 
T
 
	gm_hash
;

59 
	gNAMESPACE_END


	@hrtimer.cpp

3 
	~"pch.h
"

4 
	~"h¹im”.h
"

5 
	~"misc.h
"

6 
	~<¡ddef.h
>

7 
	~<time.h
>

9 #ià
defšed
(
CRYPTOPP_WIN32_AVAILABLE
)

10 
	~<wšdows.h
>

11 #–ià
defšed
(
CRYPTOPP_UNIX_AVAILABLE
)

12 
	~<sys/time.h
>

13 
	~<sys/times.h
>

14 
	~<uni¡d.h
>

17 
	~<as£¹.h
>

19 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

21 #iâdeà
CRYPTOPP_IMPORTS


23 
Tim”Ba£
::
	$CÚv”tTo
(
Tim”WÜd
 
t
, 
Un™
 
un™
)

25 
un™sP”SecÚdTabË
[] = {1, 1000, 1000*1000, 1000*1000*1000};

27 
	`as£¹
(
un™
 < (
un™sP”SecÚdTabË
) / (unitsPerSecondTable[0]));

28  ()
CRYPTOPP_VC6_INT64
 
t
 * 
un™sP”SecÚdTabË
[
un™
] / CRYPTOPP_VC6_INT64 
	`TicksP”SecÚd
();

29 
	}
}

31 
	gTim”Ba£
::
	$S¹Tim”
()

33 
m_Ï¡
 = 
m_¡¬t
 = 
	`G‘Cu¼’tTim”V®ue
();

34 
m_¡¬‹d
 = 
Œue
;

35 
	}
}

37 
	gTim”Ba£
::
	$EÏp£dTimeAsDoubË
()

39 ià(
m_¡uckAtZ”o
)

42 ià(
m_¡¬‹d
)

44 
Tim”WÜd
 
now
 = 
	`G‘Cu¼’tTim”V®ue
();

45 ià(
m_Ï¡
 < 
now
)

46 
m_Ï¡
 = 
now
;

47  
	`CÚv”tTo
(
m_Ï¡
 - 
m_¡¬t
, 
m_tim”Un™
);

50 
	`S¹Tim”
();

52 
	}
}

54 
	gTim”Ba£
::
	$EÏp£dTime
()

56 
–­£d
 = 
	`EÏp£dTimeAsDoubË
();

57 
	`as£¹
(
–­£d
 <ğ
ULONG_MAX
);

58  ()
–­£d
;

59 
	}
}

61 
Tim”WÜd
 
	gTim”
::
	$G‘Cu¼’tTim”V®ue
()

63 #ià
	`defšed
(
CRYPTOPP_WIN32_AVAILABLE
)

64 
LARGE_INTEGER
 
now
;

65 ià(!
	`Qu”yP”fÜmªûCouÁ”
(&
now
))

66 
throw
 
	`Exû±iÚ
(
Exû±iÚ
::
OTHER_ERROR
, "Tim”: Qu”yP”fÜmªûCouÁ” faed w™hƒ¼Ü " + 
	`IÁToSŒšg
(
	`G‘La¡E¼Ü
()));

67  
now
.
QuadP¬t
;

68 #–ià
	`defšed
(
CRYPTOPP_UNIX_AVAILABLE
)

69 
timev®
 
now
;

70 
	`g‘timeofday
(&
now
, 
NULL
);

71  (
Tim”WÜd
)
now
.
tv_£c
 * 1000000 +‚ow.
tv_u£c
;

73 
şock_t
 
now
;

74  
	`şock
();

76 
	}
}

78 
Tim”WÜd
 
	gTim”
::
	$TicksP”SecÚd
()

80 #ià
	`defšed
(
CRYPTOPP_WIN32_AVAILABLE
)

81 
LARGE_INTEGER
 
äeq
 = {0};

82 ià(
äeq
.
QuadP¬t
 == 0)

84 ià(!
	`Qu”yP”fÜmªûF»qu’cy
(&
äeq
))

85 
throw
 
	`Exû±iÚ
(
Exû±iÚ
::
OTHER_ERROR
, "Tim”: Qu”yP”fÜmªûF»qu’cy faed w™hƒ¼Ü " + 
	`IÁToSŒšg
(
	`G‘La¡E¼Ü
()));

87  
äeq
.
QuadP¬t
;

88 #–ià
	`defšed
(
CRYPTOPP_UNIX_AVAILABLE
)

91  
CLOCKS_PER_SEC
;

93 
	}
}

97 
Tim”WÜd
 
	gTh»adU£rTim”
::
	$G‘Cu¼’tTim”V®ue
()

99 #ià
	`defšed
(
CRYPTOPP_WIN32_AVAILABLE
)

100 
boŞ
 
g‘Cu¼’tTh»adIm¶em’‹d
 = 
Œue
;

101 ià(
g‘Cu¼’tTh»adIm¶em’‹d
)

103 
FILETIME
 
now
, 
ignÜed
;

104 ià(!
	`G‘Th»adTimes
(
	`G‘Cu¼’tTh»ad
(), &
ignÜed
, &ignÜed, &ignÜed, &
now
))

106 
DWORD
 
Ï¡E¼Ü
 = 
	`G‘La¡E¼Ü
();

107 ià(
Ï¡E¼Ü
 =ğ
ERROR_CALL_NOT_IMPLEMENTED
)

109 
g‘Cu¼’tTh»adIm¶em’‹d
 = 
çl£
;

110 
G‘Cu¼’tTh»adNÙIm¶em’‹d
;

112 
throw
 
	`Exû±iÚ
(
Exû±iÚ
::
OTHER_ERROR
, "Th»adU£rTim”: G‘Th»adTime çed w™hƒ¼Ü " + 
	`IÁToSŒšg
(
Ï¡E¼Ü
));

114  
now
.
dwLowD©eTime
 + ((
Tim”WÜd
êow.
dwHighD©eTime
 << 32);

116 
G‘Cu¼’tTh»adNÙIm¶em’‹d
:

117  (
Tim”WÜd
)
	`şock
(è* (10*1000*1000 / 
CLOCKS_PER_SEC
);

118 #–ià
	`defšed
(
CRYPTOPP_UNIX_AVAILABLE
)

119 
tms
 
now
;

120 
	`times
(&
now
);

121  
now
.
tms_utime
;

123  
	`şock
();

125 
	}
}

127 
Tim”WÜd
 
	gTh»adU£rTim”
::
	$TicksP”SecÚd
()

129 #ià
	`defšed
(
CRYPTOPP_WIN32_AVAILABLE
)

131 #–ià
	`defšed
(
CRYPTOPP_UNIX_AVAILABLE
)

132 cÚ¡ 
ticksP”SecÚd
 = 
	`syscÚf
(
_SC_CLK_TCK
);

133  
ticksP”SecÚd
;

135  
CLOCKS_PER_SEC
;

137 
	}
}

139 
	gNAMESPACE_END


	@hrtimer.h

1 #iâdeà
CRYPTOPP_HRTIMER_H


2 
	#CRYPTOPP_HRTIMER_H


	)

4 
	~"cÚfig.h
"

5 #iâdeà
HIGHRES_TIMER_AVAILABLE


6 
	~<time.h
>

9 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

11 #ifdeà
HIGHRES_TIMER_AVAILABLE


12 
wÜd64
 
	tTim”WÜd
;

14 
şock_t
 
	tTim”WÜd
;

18 şas 
	cCRYPTOPP_DLL
 
CRYPTOPP_NO_VTABLE
 
Tim”Ba£


20 
public
:

21 
	eUn™
 {
SECONDS
 = 0, 
MILLISECONDS
, 
MICROSECONDS
, 
NANOSECONDS
};

22 
	$Tim”Ba£
(
Un™
 
un™
, 
boŞ
 
¡uckAtZ”o
è: 
	`m_tim”Un™
(un™), 
	`m_¡uckAtZ”o
(¡uckAtZ”o), 
	$m_¡¬‹d
(
çl£
è{
	}
}

24 
vœtu®
 
Tim”WÜd
 
G‘Cu¼’tTim”V®ue
() =0;

25 
vœtu®
 
Tim”WÜd
 
TicksP”SecÚd
() =0;

27 
S¹Tim”
();

28 
EÏp£dTimeAsDoubË
();

29 
EÏp£dTime
();

31 
	g´iv©e
:

32 
CÚv”tTo
(
Tim”WÜd
 
t
, 
Un™
 
un™
);

34 
Un™
 
	gm_tim”Un™
;

35 
boŞ
 
	gm_¡uckAtZ”o
, 
	gm_¡¬‹d
;

36 
Tim”WÜd
 
	gm_¡¬t
, 
	gm_Ï¡
;

42 şas 
	cTh»adU£rTim”
 : 
public
 
Tim”Ba£


44 
public
:

45 
	$Th»adU£rTim”
(
Un™
 
un™
 = 
Tim”Ba£
::
SECONDS
, 
boŞ
 
¡uckAtZ”o
 = 
çl£
è: 
	$Tim”Ba£
(
un™
, 
¡uckAtZ”o
) {}

46 
Tim”WÜd
 
	`G‘Cu¼’tTim”V®ue
();

47 
Tim”WÜd
 
	`TicksP”SecÚd
();

48 
	}
};

51 şas 
	cCRYPTOPP_DLL
 
	mTim”
 : 
public
 
Tim”Ba£


53 
public
:

54 
	$Tim”
(
Un™
 
un™
 = 
Tim”Ba£
::
SECONDS
, 
boŞ
 
¡uckAtZ”o
 = 
çl£
è: 
	$Tim”Ba£
(
un™
, 
¡uckAtZ”o
) {}

55 
Tim”WÜd
 
	`G‘Cu¼’tTim”V®ue
();

56 
Tim”WÜd
 
	`TicksP”SecÚd
();

57 
	}
};

59 
	gNAMESPACE_END


	@ida.cpp

3 
	~"pch.h
"

4 
	~"ida.h
"

6 
	~"®geb¿.h
"

7 
	~"gf2_32.h
"

8 
	~"pŞynomi.h
"

9 
	~<funùiÚ®
>

11 
	~"pŞynomi.ıp
"

13 
ANONYMOUS_NAMESPACE_BEGIN


14 cÚ¡ 
	gCry±oPP
::
GF2_32
 
f›ld
;

15 
NAMESPACE_END


17 
usšg
 
Çme¥aû
 
	g¡d
;

19 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

21 
RawIDA
::
	$IsŞ©edIn™Ÿlize
(cÚ¡ 
NameV®uePaœs
 &
·¿m‘”s
)

23 ià(!
·¿m‘”s
.
	`G‘IÁV®ue
("Recov”yTh»shŞd", 
m_th»shŞd
))

24 
throw
 
	`Inv®idArgum’t
("RawIDA: missing RecoveryThreshold‡rgument");

26 ià(
m_th»shŞd
 <= 0)

27 
throw
 
	`Inv®idArgum’t
("RawIDA: RecoveryThreshold must be greaterhan 0");

29 
m_Ï¡M­Pos™iÚ
 = 
m_šputChªÃlM­
.
	`’d
();

30 
m_chªÃlsR—dy
 = 0;

31 
m_chªÃlsFšished
 = 0;

32 
m_w
.
	`New
(
m_th»shŞd
);

33 
m_y
.
	`New
(
m_th»shŞd
);

34 
m_šputQueues
.
	`»£rve
(
m_th»shŞd
);

36 
m_ouutChªÃlIds
.
	`ş—r
();

37 
m_ouutChªÃlIdSŒšgs
.
	`ş—r
();

38 
m_ouutQueues
.
	`ş—r
();

40 
wÜd32
 
ouutChªÃlID
;

41 ià(
·¿m‘”s
.
	`G‘V®ue
("OuutChªÃlID", 
ouutChªÃlID
))

42 
	`AddOuutChªÃl
(
ouutChªÃlID
);

45 
nSh¬es
 = 
·¿m‘”s
.
	`G‘IÁV®ueW™hDeçuÉ
("Numb”OfSh¬es", 
m_th»shŞd
);

46 
i
=0; i<
nSh¬es
; i++)

47 
	`AddOuutChªÃl
(
i
);

49 
	}
}

51 
	gRawIDA
::
	$In£¹IÅutChªÃl
(
wÜd32
 
chªÃlId
)

53 ià(
m_Ï¡M­Pos™iÚ
 !ğ
m_šputChªÃlM­
.
	`’d
())

55 ià(
m_Ï¡M­Pos™iÚ
->
fœ¡
 =ğ
chªÃlId
)

56 
skFšd
;

57 ++
m_Ï¡M­Pos™iÚ
;

58 ià(
m_Ï¡M­Pos™iÚ
 !ğ
m_šputChªÃlM­
.
	`’d
(è&& m_Ï¡M­Pos™iÚ->
fœ¡
 =ğ
chªÃlId
)

59 
skFšd
;

61 
m_Ï¡M­Pos™iÚ
 = 
m_šputChªÃlM­
.
	`fšd
(
chªÃlId
);

63 
skFšd
:

64 ià(
m_Ï¡M­Pos™iÚ
 =ğ
m_šputChªÃlM­
.
	`’d
())

66 ià(
m_šputChªÃlIds
.
	`size
(è=ğ
m_th»shŞd
)

67  
m_th»shŞd
;

69 
m_Ï¡M­Pos™iÚ
 = 
m_šputChªÃlM­
.
	`š£¹
(
IÅutChªÃlM­
::
	`v®ue_ty³
(
chªÃlId
, ()
m_šputChªÃlIds
.
	`size
())).
fœ¡
;

70 
m_šputQueues
.
	`push_back
(
	`Mes§geQueue
());

71 
m_šputChªÃlIds
.
	`push_back
(
chªÃlId
);

73 ià(
m_šputChªÃlIds
.
	`size
(è=ğ
m_th»shŞd
)

74 
	`P»·»IÁ”pŞ©iÚ
();

76  
m_Ï¡M­Pos™iÚ
->
£cÚd
;

77 
	}
}

79 
	gRawIDA
::
	$LookupIÅutChªÃl
(
wÜd32
 
chªÃlId
) const

81 
m­
<
wÜd32
, >::
cÚ¡_™”©Ü
 
™
 = 
m_šputChªÃlM­
.
	`fšd
(
chªÃlId
);

82 ià(
™
 =ğ
m_šputChªÃlM­
.
	`’d
())

83  
m_th»shŞd
;

85  
™
->
£cÚd
;

86 
	}
}

88 
	gRawIDA
::
	$ChªÃlD©a
(
wÜd32
 
chªÃlId
, cÚ¡ 
by‹
 *
šSŒšg
, 
size_t
 
Ëngth
, 
boŞ
 
mes§geEnd
)

90 
i
 = 
	`In£¹IÅutChªÃl
(
chªÃlId
);

91 ià(
i
 < 
m_th»shŞd
)

93 
lwÜd
 
size
 = 
m_šputQueues
[
i
].
	`MaxR‘r›vabË
();

94 
m_šputQueues
[
i
].
	`Put
(
šSŒšg
, 
Ëngth
);

95 ià(
size
 < 4 && siz+ 
Ëngth
 >= 4)

97 
m_chªÃlsR—dy
++;

98 ià(
m_chªÃlsR—dy
 =ğ
m_th»shŞd
)

99 
	`ProûssIÅutQueues
();

102 ià(
mes§geEnd
)

104 
m_šputQueues
[
i
].
	`Mes§geEnd
();

105 ià(
m_šputQueues
[
i
].
	`Numb”OfMes§ges
() == 1)

107 
m_chªÃlsFšished
++;

108 ià(
m_chªÃlsFšished
 =ğ
m_th»shŞd
)

110 
m_chªÃlsR—dy
 = 0;

111 
i
=0; i<
m_th»shŞd
; i++)

112 
m_chªÃlsR—dy
 +ğ
m_šputQueues
[
i
].
	`AnyR‘r›vabË
();

113 
	`ProûssIÅutQueues
();

118 
	}
}

120 
lwÜd
 
	gRawIDA
::
	$IÅutBufã»d
(
wÜd32
 
chªÃlId
) const

122 
i
 = 
	`LookupIÅutChªÃl
(
chªÃlId
);

123  
i
 < 
m_th»shŞd
 ? 
m_šputQueues
[i].
	`MaxR‘r›vabË
() : 0;

124 
	}
}

126 
	gRawIDA
::
	$Compu‹V
(
i
)

128 ià(
i
 >ğ
m_v
.
	`size
())

130 
m_v
.
	`»size
(
i
+1);

131 
m_ouutToIÅut
.
	`»size
(
i
+1);

134 
m_ouutToIÅut
[
i
] = 
	`LookupIÅutChªÃl
(
m_ouutChªÃlIds
[i]);

135 ià(
m_ouutToIÅut
[
i
] =ğ
m_th»shŞd
 && i * m_threshold <= 1000*1000)

137 
m_v
[
i
].
	`»size
(
m_th»shŞd
);

138 
	`P»·»BulkPŞynomŸlIÁ”pŞ©iÚAt
(
f›ld
, 
m_v
[
i
].
	`begš
(), 
m_ouutChªÃlIds
[i], &(
m_šputChªÃlIds
[0]), 
m_w
.begš(), 
m_th»shŞd
);

140 
	}
}

142 
	gRawIDA
::
	$AddOuutChªÃl
(
wÜd32
 
chªÃlId
)

144 
m_ouutChªÃlIds
.
	`push_back
(
chªÃlId
);

145 
m_ouutChªÃlIdSŒšgs
.
	`push_back
(
	`WÜdToSŒšg
(
chªÃlId
));

146 
m_ouutQueues
.
	`push_back
(
	`By‹Queue
());

147 ià(
m_šputChªÃlIds
.
	`size
(è=ğ
m_th»shŞd
)

148 
	`Compu‹V
(()
m_ouutChªÃlIds
.
	`size
() - 1);

149 
	}
}

151 
	gRawIDA
::
	$P»·»IÁ”pŞ©iÚ
()

153 
	`as£¹
(
m_šputChªÃlIds
.
	`size
(è=ğ
m_th»shŞd
);

154 
	`P»·»BulkPŞynomŸlIÁ”pŞ©iÚ
(
f›ld
, 
m_w
.
	`begš
(), &(
m_šputChªÃlIds
[0]), 
m_th»shŞd
);

155 
i
=0; i<
m_ouutChªÃlIds
.
	`size
(); i++)

156 
	`Compu‹V
(
i
);

157 
	}
}

159 
	gRawIDA
::
	$ProûssIÅutQueues
()

161 
boŞ
 
fšished
 = (
m_chªÃlsFšished
 =ğ
m_th»shŞd
);

162 
i
;

164 
fšished
 ? 
m_chªÃlsR—dy
 > 0 : m_chªÃlsR—dy =ğ
m_th»shŞd
)

166 
m_chªÃlsR—dy
 = 0;

167 
i
=0; i<
m_th»shŞd
; i++)

169 
Mes§geQueue
 &
queue
 = 
m_šputQueues
[
i
];

170 
queue
.
	`G‘WÜd32
(
m_y
[
i
]);

172 ià(
fšished
)

173 
m_chªÃlsR—dy
 +ğ
queue
.
	`AnyR‘r›vabË
();

175 
m_chªÃlsR—dy
 +ğ
queue
.
	`Numb”OfMes§ges
(è> 0 || queue.
	`MaxR‘r›vabË
() >= 4;

178 
i
=0; ()i<
m_ouutChªÃlIds
.
	`size
(); i++)

180 ià(
m_ouutToIÅut
[
i
] !ğ
m_th»shŞd
)

181 
m_ouutQueues
[
i
].
	`PutWÜd32
(
m_y
[
m_ouutToIÅut
[i]]);

182 ià(
m_v
[
i
].
	`size
(è=ğ
m_th»shŞd
)

183 
m_ouutQueues
[
i
].
	`PutWÜd32
(
	`BulkPŞynomŸlIÁ”pŞ©eAt
(
f›ld
, 
m_y
.
	`begš
(), 
m_v
[i].begš(), 
m_th»shŞd
));

186 
m_u
.
	`»size
(
m_th»shŞd
);

187 
	`P»·»BulkPŞynomŸlIÁ”pŞ©iÚAt
(
f›ld
, 
m_u
.
	`begš
(), 
m_ouutChªÃlIds
[
i
], &(
m_šputChªÃlIds
[0]), 
m_w
.begš(), 
m_th»shŞd
);

188 
m_ouutQueues
[
i
].
	`PutWÜd32
(
	`BulkPŞynomŸlIÁ”pŞ©eAt
(
f›ld
, 
m_y
.
	`begš
(), 
m_u
.begš(), 
m_th»shŞd
));

193 ià(
m_ouutChªÃlIds
.
	`size
(è> 0 && 
m_ouutQueues
[0].
	`AnyR‘r›vabË
())

194 
	`FlushOuutQueues
();

196 ià(
fšished
)

198 
	`OuutMes§geEnds
();

200 
m_chªÃlsR—dy
 = 0;

201 
m_chªÃlsFšished
 = 0;

202 
m_v
.
	`ş—r
();

204 
veùÜ
<
Mes§geQueue
> 
šputQueues
;

205 
veùÜ
<
wÜd32
> 
šputChªÃlIds
;

207 
šputQueues
.
	`sw­
(
m_šputQueues
);

208 
šputChªÃlIds
.
	`sw­
(
m_šputChªÃlIds
);

209 
m_šputChªÃlM­
.
	`ş—r
();

210 
m_Ï¡M­Pos™iÚ
 = 
m_šputChªÃlM­
.
	`’d
();

212 
i
=0; i<
m_th»shŞd
; i++)

214 
šputQueues
[
i
].
	`G‘NextMes§ge
();

215 
šputQueues
[
i
].
	`T¿nsãrAÎTo
(*
	`A‰achedT¿nsfÜm©iÚ
(), 
	`WÜdToSŒšg
(
šputChªÃlIds
[i]));

218 
	}
}

220 
	gRawIDA
::
	$FlushOuutQueues
()

222 
i
=0; i<
m_ouutChªÃlIds
.
	`size
(); i++)

223 
m_ouutQueues
[
i
].
	`T¿nsãrAÎTo
(*
	`A‰achedT¿nsfÜm©iÚ
(), 
m_ouutChªÃlIdSŒšgs
[i]);

224 
	}
}

226 
	gRawIDA
::
	$OuutMes§geEnds
()

228 ià(
	`G‘AutoSigÇlPrİag©iÚ
() != 0)

230 
i
=0; i<
m_ouutChªÃlIds
.
	`size
(); i++)

231 
	`A‰achedT¿nsfÜm©iÚ
()->
	`ChªÃlMes§geEnd
(
m_ouutChªÃlIdSŒšgs
[
i
], 
	`G‘AutoSigÇlPrİag©iÚ
()-1);

233 
	}
}

237 
	gSeü‘Sh¬šg
::
	$IsŞ©edIn™Ÿlize
(cÚ¡ 
NameV®uePaœs
 &
·¿m‘”s
)

239 
m_·d
 = 
·¿m‘”s
.
	`G‘V®ueW™hDeçuÉ
("AddPaddšg", 
Œue
);

240 
m_ida
.
	`IsŞ©edIn™Ÿlize
(
·¿m‘”s
);

241 
	}
}

243 
size_t
 
	gSeü‘Sh¬šg
::
	$Put2
(cÚ¡ 
by‹
 *
begš
, 
size_t
 
Ëngth
, 
mes§geEnd
, 
boŞ
 
blockšg
)

245 ià(!
blockšg
)

246 
throw
 
	`BlockšgIÅutOÆy
("SecretSharing");

248 
SecBy‹Block
 
	`buf
(
	`UnsigÃdMš
(256, 
Ëngth
));

249 
th»shŞd
 = 
m_ida
.
	`G‘Th»shŞd
();

250 
Ëngth
 > 0)

252 
size_t
 
Ën
 = 
	`STDMIN
(
Ëngth
, 
buf
.
	`size
());

253 
m_ida
.
	`ChªÃlD©a
(0xffffffff, 
begš
, 
Ën
, 
çl£
);

254 
i
=0; i<
th»shŞd
-1; i++)

256 
m_ºg
.
	`G’”©eBlock
(
buf
, 
Ën
);

257 
m_ida
.
	`ChªÃlD©a
(
i
, 
buf
, 
Ën
, 
çl£
);

259 
Ëngth
 -ğ
Ën
;

260 
begš
 +ğ
Ën
;

263 ià(
mes§geEnd
)

265 
m_ida
.
	`S‘AutoSigÇlPrİag©iÚ
(
mes§geEnd
-1);

266 ià(
m_·d
)

268 
Seü‘Sh¬šg
::
	`Put
(1);

269 
m_ida
.
	`IÅutBufã»d
(0xffffffff) > 0)

270 
Seü‘Sh¬šg
::
	`Put
(0);

272 
m_ida
.
	`ChªÃlD©a
(0xffffffff, 
NULL
, 0, 
Œue
);

273 
i
=0; i<
m_ida
.
	`G‘Th»shŞd
()-1; i++)

274 
m_ida
.
	`ChªÃlD©a
(
i
, 
NULL
, 0, 
Œue
);

278 
	}
}

280 
	gSeü‘Recov”y
::
	$IsŞ©edIn™Ÿlize
(cÚ¡ 
NameV®uePaœs
 &
·¿m‘”s
)

282 
m_·d
 = 
·¿m‘”s
.
	`G‘V®ueW™hDeçuÉ
("RemovePaddšg", 
Œue
);

283 
RawIDA
::
	`IsŞ©edIn™Ÿlize
(
	`CombšedNameV®uePaœs
(
·¿m‘”s
, 
	`MakeP¬am‘”s
("OuutChªÃlID", (
wÜd32
)0xffffffff)));

284 
	}
}

286 
	gSeü‘Recov”y
::
	$FlushOuutQueues
()

288 ià(
m_·d
)

289 
m_ouutQueues
[0].
	`T¿nsãrTo
(*
	`A‰achedT¿nsfÜm©iÚ
(), m_ouutQueues[0].
	`MaxR‘r›vabË
()-4);

291 
m_ouutQueues
[0].
	`T¿nsãrTo
(*
	`A‰achedT¿nsfÜm©iÚ
());

292 
	}
}

294 
	gSeü‘Recov”y
::
	$OuutMes§geEnds
()

296 ià(
m_·d
)

298 
PaddšgRemov”
 
	`·ddšgRemov”
(
Ãw
 
	`RedœeùÜ
(*
	`A‰achedT¿nsfÜm©iÚ
()));

299 
m_ouutQueues
[0].
	`T¿nsãrAÎTo
(
·ddšgRemov”
);

302 ià(
	`G‘AutoSigÇlPrİag©iÚ
() != 0)

303 
	`A‰achedT¿nsfÜm©iÚ
()->
	`Mes§geEnd
(
	`G‘AutoSigÇlPrİag©iÚ
()-1);

304 
	}
}

308 
	gInfÜm©iÚDi¥”§l
::
	$IsŞ©edIn™Ÿlize
(cÚ¡ 
NameV®uePaœs
 &
·¿m‘”s
)

310 
m_ÃxtChªÃl
 = 0;

311 
m_·d
 = 
·¿m‘”s
.
	`G‘V®ueW™hDeçuÉ
("AddPaddšg", 
Œue
);

312 
m_ida
.
	`IsŞ©edIn™Ÿlize
(
·¿m‘”s
);

313 
	}
}

315 
size_t
 
	gInfÜm©iÚDi¥”§l
::
	$Put2
(cÚ¡ 
by‹
 *
begš
, 
size_t
 
Ëngth
, 
mes§geEnd
, 
boŞ
 
blockšg
)

317 ià(!
blockšg
)

318 
throw
 
	`BlockšgIÅutOÆy
("InformationDispersal");

320 
Ëngth
--)

322 
m_ida
.
	`ChªÃlD©a
(
m_ÃxtChªÃl
, 
begš
, 1, 
çl£
);

323 
begš
++;

324 
m_ÃxtChªÃl
++;

325 ià(
m_ÃxtChªÃl
 =ğ
m_ida
.
	`G‘Th»shŞd
())

326 
m_ÃxtChªÃl
 = 0;

329 ià(
mes§geEnd
)

331 
m_ida
.
	`S‘AutoSigÇlPrİag©iÚ
(
mes§geEnd
-1);

332 ià(
m_·d
)

333 
InfÜm©iÚDi¥”§l
::
	`Put
(1);

334 
wÜd32
 
i
=0; i<
m_ida
.
	`G‘Th»shŞd
(); i++)

335 
m_ida
.
	`ChªÃlD©a
(
i
, 
NULL
, 0, 
Œue
);

339 
	}
}

341 
	gInfÜm©iÚRecov”y
::
	$IsŞ©edIn™Ÿlize
(cÚ¡ 
NameV®uePaœs
 &
·¿m‘”s
)

343 
m_·d
 = 
·¿m‘”s
.
	`G‘V®ueW™hDeçuÉ
("RemovePaddšg", 
Œue
);

344 
RawIDA
::
	`IsŞ©edIn™Ÿlize
(
·¿m‘”s
);

345 
	}
}

347 
	gInfÜm©iÚRecov”y
::
	$FlushOuutQueues
()

349 
m_ouutQueues
[0].
	`AnyR‘r›vabË
())

351 
i
=0; i<
m_ouutChªÃlIds
.
	`size
(); i++)

352 
m_ouutQueues
[
i
].
	`T¿nsãrTo
(
m_queue
, 1);

355 ià(
m_·d
)

356 
m_queue
.
	`T¿nsãrTo
(*
	`A‰achedT¿nsfÜm©iÚ
(), m_queue.
	`MaxR‘r›vabË
()-4*
m_th»shŞd
);

358 
m_queue
.
	`T¿nsãrTo
(*
	`A‰achedT¿nsfÜm©iÚ
());

359 
	}
}

361 
	gInfÜm©iÚRecov”y
::
	$OuutMes§geEnds
()

363 ià(
m_·d
)

365 
PaddšgRemov”
 
	`·ddšgRemov”
(
Ãw
 
	`RedœeùÜ
(*
	`A‰achedT¿nsfÜm©iÚ
()));

366 
m_queue
.
	`T¿nsãrAÎTo
(
·ddšgRemov”
);

369 ià(
	`G‘AutoSigÇlPrİag©iÚ
() != 0)

370 
	`A‰achedT¿nsfÜm©iÚ
()->
	`Mes§geEnd
(
	`G‘AutoSigÇlPrİag©iÚ
()-1);

371 
	}
}

373 
size_t
 
	gPaddšgRemov”
::
	$Put2
(cÚ¡ 
by‹
 *
begš
, 
size_t
 
Ëngth
, 
mes§geEnd
, 
boŞ
 
blockšg
)

375 ià(!
blockšg
)

376 
throw
 
	`BlockšgIÅutOÆy
("PaddingRemover");

378 cÚ¡ 
by‹
 *cÚ¡ 
’d
 = 
begš
 + 
Ëngth
;

380 ià(
m_possibËPaddšg
)

382 
size_t
 
Ën
 = 
	`fšd_if
(
begš
, 
’d
, 
	`bšd2nd
(
nÙ_equ®_to
<
by‹
>(), 0)) - begin;

383 
m_z”oCouÁ
 +ğ
Ën
;

384 
begš
 +ğ
Ën
;

385 ià(
begš
 =ğ
’d
)

388 
	`A‰achedT¿nsfÜm©iÚ
()->
	`Put
(1);

389 
m_z”oCouÁ
--)

390 
	`A‰achedT¿nsfÜm©iÚ
()->
	`Put
(0);

391 
	`A‰achedT¿nsfÜm©iÚ
()->
	`Put
(*
begš
++);

392 
m_possibËPaddšg
 = 
çl£
;

395 #ià
	`defšed
(
_MSC_VER
è&& !defšed(
__MWERKS__
) && (_MSC_VER <= 1300)

397 
»v”£_bidœeùiÚ®_™”©Ü
<cÚ¡ 
	tby‹
 *, cÚ¡ by‹> 
	tRevIt
;

398 #–ià
	`defšed
(
_RWSTD_NO_CLASS_PARTIAL_SPEC
)

399 
»v”£_™”©Ü
<cÚ¡ 
	tby‹
 *, 
	t¿ndom_acûss_™”©Ü_g
, cÚ¡ by‹> 
	tRevIt
;

401 
»v”£_™”©Ü
<cÚ¡ 
	tby‹
 *> 
	tRevIt
;

403 cÚ¡ 
by‹
 *
x
 = 
	`fšd_if
(
	`RevIt
(
’d
), RevIt(
begš
), 
	`bšd2nd
(
nÙ_equ®_to
<by‹>(), 0)).
	`ba£
();

404 ià(
x
 !ğ
begš
 && *(x-1) == 1)

406 
	`A‰achedT¿nsfÜm©iÚ
()->
	`Put
(
begš
, 
x
-begin-1);

407 
m_possibËPaddšg
 = 
Œue
;

408 
m_z”oCouÁ
 = 
’d
 - 
x
;

411 
	`A‰achedT¿nsfÜm©iÚ
()->
	`Put
(
begš
, 
’d
-begin);

413 ià(
mes§geEnd
)

415 
m_possibËPaddšg
 = 
çl£
;

416 
	`Ouut
(0, 
begš
, 
Ëngth
, 
mes§geEnd
, 
blockšg
);

419 
	}
}

421 
	gNAMESPACE_END


	@ida.h

1 #iâdeà
CRYPTOPP_IDA_H


2 
	#CRYPTOPP_IDA_H


	)

4 
	~"mqueue.h
"

5 
	~"f‹rs.h
"

6 
	~"chªÃls.h
"

7 
	~<m­
>

8 
	~<veùÜ
>

10 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

13 
şass
 
RawIDA
 : 
public
 
AutoSigÇlšg
<
UnæushabË
<
MuÉichªÃl
<
F‹r
> > >

15 
public
:

16 
	`RawIDA
(
Bufã»dT¿nsfÜm©iÚ
 *
©chm’t
=
NULL
)

17 {
	`D‘ach
(
©chm’t
);}

19 
	`G‘Th»shŞd
(ècÚ¡ { 
m_th»shŞd
;}

20 
	`AddOuutChªÃl
(
wÜd32
 
chªÃlId
);

21 
	`ChªÃlD©a
(
wÜd32
 
chªÃlId
, cÚ¡ 
by‹
 *
šSŒšg
, 
size_t
 
Ëngth
, 
boŞ
 
mes§geEnd
);

22 
lwÜd
 
	`IÅutBufã»d
(
wÜd32
 
chªÃlId
) const;

24 
	`IsŞ©edIn™Ÿlize
(cÚ¡ 
NameV®uePaœs
 &
·¿m‘”s
=
g_nuÎNameV®uePaœs
);

25 
size_t
 
	`ChªÃlPut2
(cÚ¡ 
¡d
::
¡ršg
 &
chªÃl
, cÚ¡ 
by‹
 *
begš
, size_ˆ
Ëngth
, 
mes§geEnd
, 
boŞ
 
blockšg
)

27 ià(!
blockšg
)

28 
throw
 
	`BlockšgIÅutOÆy
("RawIDA");

29 
	`ChªÃlD©a
(
SŒšgToWÜd
<
wÜd32
>(
chªÃl
), 
begš
, 
Ëngth
, 
mes§geEnd
 != 0);

33 
´Ùeùed
:

34 
vœtu®
 
	`FlushOuutQueues
();

35 
vœtu®
 
	`OuutMes§geEnds
();

37 
	`In£¹IÅutChªÃl
(
wÜd32
 
chªÃlId
);

38 
	`LookupIÅutChªÃl
(
wÜd32
 
chªÃlId
) const;

39 
	`Compu‹V
();

40 
	`P»·»IÁ”pŞ©iÚ
();

41 
	`ProûssIÅutQueues
();

43 
¡d
::
	tm­
<
	twÜd32
, > 
	tIÅutChªÃlM­
;

44 
IÅutChªÃlM­
 
m_šputChªÃlM­
;

45 
IÅutChªÃlM­
::
™”©Ü
 
m_Ï¡M­Pos™iÚ
;

46 
¡d
::
veùÜ
<
Mes§geQueue
> 
m_šputQueues
;

47 
¡d
::
veùÜ
<
wÜd32
> 
m_šputChªÃlIds
, 
m_ouutChªÃlIds
, 
m_ouutToIÅut
;

48 
¡d
::
veùÜ
<¡d::
¡ršg
> 
m_ouutChªÃlIdSŒšgs
;

49 
¡d
::
veùÜ
<
By‹Queue
> 
m_ouutQueues
;

50 
m_th»shŞd
;

51 
m_chªÃlsR—dy
, 
m_chªÃlsFšished
;

52 
¡d
::
veùÜ
<
SecBlock
<
wÜd32
> > 
m_v
;

53 
SecBlock
<
wÜd32
> 
m_u
, 
m_w
, 
m_y
;

54 
	}
};

57 
şass
 
	gSeü‘Sh¬šg
 : 
public
 
Cu¡omFlushPrİag©iÚ
<
F‹r
>

59 
public
:

60 
Seü‘Sh¬šg
(
RªdomNumb”G’”©Ü
 &
ºg
, 
th»shŞd
, 
nSh¬es
, 
Bufã»dT¿nsfÜm©iÚ
 *
©chm’t
=
NULL
, 
boŞ
 
addPaddšg
=
Œue
)

61 : 
m_ºg
(
ºg
), 
m_ida
(
Ãw
 
OuutProxy
(*
this
, 
Œue
))

63 
D‘ach
(
©chm’t
);

64 
IsŞ©edIn™Ÿlize
(
MakeP¬am‘”s
("Recov”yTh»shŞd", 
th»shŞd
)("Numb”OfSh¬es", 
nSh¬es
)("AddPaddšg", 
addPaddšg
));

67 
IsŞ©edIn™Ÿlize
(cÚ¡ 
NameV®uePaœs
 &
·¿m‘”s
=
g_nuÎNameV®uePaœs
);

68 
size_t
 
Put2
(cÚ¡ 
by‹
 *
begš
, size_ˆ
Ëngth
, 
mes§geEnd
, 
boŞ
 
blockšg
);

69 
boŞ
 
Flush
(boŞ 
h¬dFlush
, 
´İag©iÚ
=-1, boŞ 
blockšg
=
Œue
è{ 
m_ida
.Flush(hardFlush,…ropagation, blocking);}

71 
	g´Ùeùed
:

72 
RªdomNumb”G’”©Ü
 &
m_ºg
;

73 
RawIDA
 
	gm_ida
;

74 
boŞ
 
	gm_·d
;

78 şas 
	cSeü‘Recov”y
 : 
public
 
RawIDA


80 
public
:

81 
	$Seü‘Recov”y
(
th»shŞd
, 
Bufã»dT¿nsfÜm©iÚ
 *
©chm’t
=
NULL
, 
boŞ
 
»movePaddšg
=
Œue
)

82 : 
	$RawIDA
(
©chm’t
)

83 {
	`IsŞ©edIn™Ÿlize
(
	`MakeP¬am‘”s
("Recov”yTh»shŞd", 
th»shŞd
)("RemovePaddšg", 
»movePaddšg
));}

85 
	`IsŞ©edIn™Ÿlize
(cÚ¡ 
NameV®uePaœs
 &
·¿m‘”s
=
g_nuÎNameV®uePaœs
);

87 
´Ùeùed
:

88 
	`FlushOuutQueues
();

89 
	`OuutMes§geEnds
();

91 
boŞ
 
m_·d
;

92 
	}
};

95 
şass
 
	gInfÜm©iÚDi¥”§l
 : 
public
 
Cu¡omFlushPrİag©iÚ
<
F‹r
>

97 
public
:

98 
InfÜm©iÚDi¥”§l
(
th»shŞd
, 
nSh¬es
, 
Bufã»dT¿nsfÜm©iÚ
 *
©chm’t
=
NULL
, 
boŞ
 
addPaddšg
=
Œue
)

99 : 
m_ida
(
Ãw
 
OuutProxy
(*
this
, 
Œue
))

101 
D‘ach
(
©chm’t
);

102 
IsŞ©edIn™Ÿlize
(
MakeP¬am‘”s
("Recov”yTh»shŞd", 
th»shŞd
)("Numb”OfSh¬es", 
nSh¬es
)("AddPaddšg", 
addPaddšg
));

105 
IsŞ©edIn™Ÿlize
(cÚ¡ 
NameV®uePaœs
 &
·¿m‘”s
=
g_nuÎNameV®uePaœs
);

106 
size_t
 
Put2
(cÚ¡ 
by‹
 *
begš
, size_ˆ
Ëngth
, 
mes§geEnd
, 
boŞ
 
blockšg
);

107 
boŞ
 
Flush
(boŞ 
h¬dFlush
, 
´İag©iÚ
=-1, boŞ 
blockšg
=
Œue
è{ 
m_ida
.Flush(hardFlush,…ropagation, blocking);}

109 
	g´Ùeùed
:

110 
RawIDA
 
m_ida
;

111 
boŞ
 
	gm_·d
;

112 
	gm_ÃxtChªÃl
;

116 şas 
	cInfÜm©iÚRecov”y
 : 
public
 
RawIDA


118 
public
:

119 
	$InfÜm©iÚRecov”y
(
th»shŞd
, 
Bufã»dT¿nsfÜm©iÚ
 *
©chm’t
=
NULL
, 
boŞ
 
»movePaddšg
=
Œue
)

120 : 
	$RawIDA
(
©chm’t
)

121 {
	`IsŞ©edIn™Ÿlize
(
	`MakeP¬am‘”s
("Recov”yTh»shŞd", 
th»shŞd
)("RemovePaddšg", 
»movePaddšg
));}

123 
	`IsŞ©edIn™Ÿlize
(cÚ¡ 
NameV®uePaœs
 &
·¿m‘”s
=
g_nuÎNameV®uePaœs
);

125 
´Ùeùed
:

126 
	`FlushOuutQueues
();

127 
	`OuutMes§geEnds
();

129 
boŞ
 
m_·d
;

130 
By‹Queue
 
m_queue
;

131 
	}
};

133 
şass
 
	gPaddšgRemov”
 : 
public
 
UnæushabË
<
F‹r
>

135 
public
:

136 
PaddšgRemov”
(
Bufã»dT¿nsfÜm©iÚ
 *
©chm’t
=
NULL
)

137 : 
m_possibËPaddšg
(
çl£
è{
D‘ach
(
©chm’t
);}

139 
IsŞ©edIn™Ÿlize
(cÚ¡ 
NameV®uePaœs
 &
·¿m‘”s
è{
	gm_possibËPaddšg
 = 
çl£
;}

140 
size_t
 
Put2
(cÚ¡ 
by‹
 *
begš
, size_ˆ
Ëngth
, 
mes§geEnd
, 
boŞ
 
blockšg
);

143 
boŞ
 
G‘PossibËPaddšg
(ècÚ¡ { 
	gm_possibËPaddšg
;}

145 
	g´iv©e
:

146 
boŞ
 
m_possibËPaddšg
;

147 
lwÜd
 
	gm_z”oCouÁ
;

150 
	gNAMESPACE_END


	@idea.cpp

3 
	~"pch.h
"

4 
	~"id—.h
"

5 
	~"misc.h
"

7 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

9 cÚ¡ 
IDEA_KEYLEN
=(6*
IDEA
::
ROUNDS
+4);

11 
	#low16
(
x
) ((x)&0xffff)

12 
	#high16
(
x
è((x)>>16)

	)

14 
	`CRYPTOPP_COMPILE_ASSERT
((
IDEA
::
WÜd
) >= 2);

17 
	#DœeùMUL
(
a
,
b
) \

19 
	`as£¹
(
b
 <= 0xffff); \

21 
wÜd32
 
p
=(wÜd32)
	`low16
(
a
)*
b
; \

23 ià(
p
) \

25 
p
 = 
	`low16
Õè- 
	`high16
(p); \

26 
a
 = (
IDEA
::
WÜd
)
p
 - (IDEA::WÜd)
	`high16
(p); \

29 
a
 = 1-a-
b
; \

30 
	}

	)
}

32 #ifdeà
IDEA_LARGECACHE


33 vŞ©
boŞ
 
	gIDEA
::
Ba£
::
bËsBut
 = 
çl£
;

34 
wÜd16
 
	gIDEA
::
Ba£
::
log
[0x10000];

35 
wÜd16
 
	gIDEA
::
Ba£
::
ªtog
[0x10000];

37 
	gIDEA
::
Ba£
::
	$BudLogTabËs
()

39 ià(
bËsBut
)

43 
bËsBut
 = 
Œue
;

45 
IDEA
::
WÜd
 
x
=1;

46 
wÜd32
 
i
;

48 
i
=0; i<0x10000; i++)

50 
ªtog
[
i
] = (
wÜd16
)
x
;

51 
	`DœeùMUL
(
x
, 3);

54 
i
=0; i<0x10000; i++)

55 
log
[
ªtog
[
i
]] = (
wÜd16
)i;

57 
	}
}

59 
	gIDEA
::
Ba£
::
	$LookupKeyLogs
()

61 
IDEA
::
WÜd
* 
Z
=
key
;

62 
r
=
ROUNDS
;

65 
Z
[0] = 
log
[Z[0]];

66 
Z
[3] = 
log
[Z[3]];

67 
Z
[4] = 
log
[Z[4]];

68 
Z
[5] = 
log
[Z[5]];

69 
Z
+=6;

70 } --
r
);

71 
Z
[0] = 
log
[Z[0]];

72 
Z
[3] = 
log
[Z[3]];

73 
	}
}

75 
šlše
 
	gIDEA
::
Ba£
::
	$LookupMUL
(
IDEA
::
WÜd
 &
a
, IDEA::WÜd 
b
)

77 
a
 = 
ªtog
[
	`low16
(
log
[low16×)]+
b
)];

78 
	}
}

81 
	gIDEA
::
Ba£
::
	$UncheckedS‘Key
(cÚ¡ 
by‹
 *
u£rKey
, 
Ëngth
, cÚ¡ 
NameV®uePaœs
 &)

83 
	`As£¹V®idKeyL’gth
(
Ëngth
);

85 #ifdeà
IDEA_LARGECACHE


86 
	`BudLogTabËs
();

89 
	`EnKey
(
u£rKey
);

91 ià(!
	`IsFÜw¬dT¿nsfÜm©iÚ
())

92 
	`DeKey
();

94 #ifdeà
IDEA_LARGECACHE


95 
	`LookupKeyLogs
();

97 
	}
}

99 
	gIDEA
::
Ba£
::
	$EnKey
 (cÚ¡ 
by‹
 *
u£rKey
)

101 
i
;

103 
i
=0; i<8; i++)

104 
m_key
[
i
] = ((
IDEA
::
WÜd
)
u£rKey
[2*i]<<8) | userKey[2*i+1];

106 ; 
i
<
IDEA_KEYLEN
; i++)

108 
j
 = 
	`RoundDownToMuÉËOf
(
i
,8U)-8;

109 
m_key
[
i
] = 
	`low16
((m_key[
j
+(i+1)%8] << 9) | (m_key[j+(i+2)%8] >> 7));

111 
	}
}

113 
	gIDEA
::
WÜd
 
	$MulInv
(
IDEA
::
WÜd
 
x
)

115 
IDEA
::
WÜd
 
y
=
x
;

116 
i
=0; i<15; i++)

118 
	`DœeùMUL
(
y
,
	`low16
(y));

119 
	`DœeùMUL
(
y
,
x
);

121  
	`low16
(
y
);

122 
	}
}

124 
šlše
 
	gIDEA
::
WÜd
 
	$AddInv
(
IDEA
::
WÜd
 
x
)

126  
	`low16
(0-
x
);

127 
	}
}

129 
	gIDEA
::
Ba£
::
	$DeKey
()

131 
FixedSizeSecBlock
<
IDEA
::
WÜd
, 6*
ROUNDS
+4> 
‹mpkey
;

132 
size_t
 
i
;

134 
i
=0; i<
ROUNDS
; i++)

136 
‹mpkey
[
i
*6+0] = 
	`MulInv
(
m_key
[(
ROUNDS
-i)*6+0]);

137 
‹mpkey
[
i
*6+1] = 
	`AddInv
(
m_key
[(
ROUNDS
-i)*6+1+(i>0)]);

138 
‹mpkey
[
i
*6+2] = 
	`AddInv
(
m_key
[(
ROUNDS
-i)*6+2-(i>0)]);

139 
‹mpkey
[
i
*6+3] = 
	`MulInv
(
m_key
[(
ROUNDS
-i)*6+3]);

140 
‹mpkey
[
i
*6+4] = 
m_key
[(
ROUNDS
-1-i)*6+4];

141 
‹mpkey
[
i
*6+5] = 
m_key
[(
ROUNDS
-1-i)*6+5];

144 
‹mpkey
[
i
*6+0] = 
	`MulInv
(
m_key
[(
ROUNDS
-i)*6+0]);

145 
‹mpkey
[
i
*6+1] = 
	`AddInv
(
m_key
[(
ROUNDS
-i)*6+1]);

146 
‹mpkey
[
i
*6+2] = 
	`AddInv
(
m_key
[(
ROUNDS
-i)*6+2]);

147 
‹mpkey
[
i
*6+3] = 
	`MulInv
(
m_key
[(
ROUNDS
-i)*6+3]);

149 
m_key
 = 
‹mpkey
;

150 
	}
}

152 #ifdeà
IDEA_LARGECACHE


153 
	#MUL
(
a
,
b
è
	`LookupMUL
×,b)

	)

155 
	#MUL
(
a
,
b
è
	`DœeùMUL
×,b)

	)

158 
	gIDEA
::
Ba£
::
	$ProûssAndXÜBlock
(cÚ¡ 
by‹
 *
šBlock
, cÚ¡ by‹ *
xÜBlock
, by‹ *
outBlock
) const

160 
BlockG‘AndPut
<
	twÜd16
, 
	tBigEndŸn
> 
	tBlock
;

162 cÚ¡ 
IDEA
::
WÜd
 *
key
 = 
m_key
;

163 
IDEA
::
WÜd
 
x0
,
x1
,
x2
,
x3
,
t0
,
t1
;

164 
Block
::
	`G‘
(
šBlock
)(
x0
)(
x1
)(
x2
)(
x3
);

166 
i
=0; i<
ROUNDS
; i++)

168 
	`MUL
(
x0
, 
key
[
i
*6+0]);

169 
x1
 +ğ
key
[
i
*6+1];

170 
x2
 +ğ
key
[
i
*6+2];

171 
	`MUL
(
x3
, 
key
[
i
*6+3]);

172 
t0
 = 
x0
^
x2
;

173 
	`MUL
(
t0
, 
key
[
i
*6+4]);

174 
t1
 = 
t0
 + (
x1
^
x3
);

175 
	`MUL
(
t1
, 
key
[
i
*6+5]);

176 
t0
 +ğ
t1
;

177 
x0
 ^ğ
t1
;

178 
x3
 ^ğ
t0
;

179 
t0
 ^ğ
x1
;

180 
x1
 = 
x2
^
t1
;

181 
x2
 = 
t0
;

184 
	`MUL
(
x0
, 
key
[
ROUNDS
*6+0]);

185 
x2
 +ğ
key
[
ROUNDS
*6+1];

186 
x1
 +ğ
key
[
ROUNDS
*6+2];

187 
	`MUL
(
x3
, 
key
[
ROUNDS
*6+3]);

189 
Block
::
	`Put
(
xÜBlock
, 
outBlock
)(
x0
)(
x2
)(
x1
)(
x3
);

190 
	}
}

192 
	gNAMESPACE_END


	@idea.h

1 #iâdeà
CRYPTOPP_IDEA_H


2 
	#CRYPTOPP_IDEA_H


	)

7 
	~"£ckey.h
"

8 
	~"£cblock.h
"

10 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

13 
IDEA_Info
 : 
public
 
FixedBlockSize
<8>,…ubliø
FixedKeyL’gth
<16>,…ubliø
FixedRounds
<8>

15 cÚ¡ *
	`SticAlgÜ™hmName
() { "IDEA";}

16 
	}
};

19 
şass
 
	gIDEA
 : 
public
 
IDEA_Info
,…ubliø
	gBlockCh”Docum’tiÚ


21 
	gpublic
:

22 #ifdeà
CRYPTOPP_NATIVE_DWORD_AVAILABLE


23 
wÜd
 
	tWÜd
;

25 
hwÜd
 
	tWÜd
;

28 
	g´iv©e
:

29 
şass
 
CRYPTOPP_NO_VTABLE
 
Ba£
 : 
public
 
BlockCh”Im¶
<
IDEA_Info
>

31 
public
:

32 
O±im®D©aAlignm’t
() const { 2;}

33 
ProûssAndXÜBlock
(cÚ¡ 
by‹
 *
šBlock
, cÚ¡ by‹ *
xÜBlock
, by‹ *
outBlock
) const;

35 
UncheckedS‘Key
(cÚ¡ 
by‹
 *
u£rKey
, 
Ëngth
, cÚ¡ 
NameV®uePaœs
 &
·¿ms
);

37 
	g´iv©e
:

38 
EnKey
(cÚ¡ 
by‹
 *);

39 
DeKey
();

40 
	gFixedSizeSecBlock
<
	gWÜd
, 6*
	gROUNDS
+4> 
	gm_key
;

42 #ifdeà
IDEA_LARGECACHE


43 
šlše
 
LookupMUL
(
wÜd
 &
a
, wÜd 
b
);

44 
LookupKeyLogs
();

45 
BudLogTabËs
();

46 vŞ©
boŞ
 
	gbËsBut
;

47 
wÜd16
 
	glog
[0x10000], 
	gªtog
[0x10000];

51 
	gpublic
:

52 
BlockCh”Fš®
<
	tENCRYPTION
, 
	tBa£
> 
	tEnüy±iÚ
;

53 
	gBlockCh”Fš®
<
	tDECRYPTION
, 
	tBa£
> 
	tDeüy±iÚ
;

56 
	gIDEA
::
	tEnüy±iÚ
 
	tIDEAEnüy±iÚ
;

57 
	gIDEA
::
	tDeüy±iÚ
 
	tIDEADeüy±iÚ
;

59 
	gNAMESPACE_END


	@integer.cpp

4 
	~"pch.h
"

6 #iâdeà
CRYPTOPP_IMPORTS


8 
	~"š‹g”.h
"

9 
	~"mod¬™h.h
"

10 
	~"nbtheÜy.h
"

11 
	~"a¢.h
"

12 
	~"oids.h
"

13 
	~"wÜds.h
"

14 
	~"®g·¿m.h
"

15 
	~"pubkey.h
"

16 
	~"sha.h
"

17 
	~"ıu.h
"

19 
	~<io¡»am
>

21 #ià
_MSC_VER
 >= 1400

22 
	~<šŒš.h
>

25 #ifdeà
__DECCXX


26 
	~<c_asm.h
>

29 #ifdeà
CRYPTOPP_MSVC6_NO_PP


30 #´agm¨
mes§ge
("You do‚ot seemo havehe Visual C++ Processor Pack installed, so use of SSE2 instructions will be disabled.")

33 
	#CRYPTOPP_INTEGER_SSE2
 (
CRYPTOPP_BOOL_SSE2_ASM_AVAILABLE
 && 
CRYPTOPP_BOOL_X86
)

	)

35 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

37 
boŞ
 
	$AssignIÁToIÁeg”
(cÚ¡ 
¡d
::
ty³_šfo
 &
v®ueTy³
, *
pIÁeg”
, cÚ¡ *
pIÁ
)

39 ià(
v®ueTy³
 !ğ
	`ty³id
(
IÁeg”
))

40  
çl£
;

41 *
»š‹½»t_ÿ¡
<
IÁeg”
 *>(
pIÁeg”
èğ*»š‹½»t_ÿ¡<cÚ¡ *>(
pIÁ
);

42  
Œue
;

43 
	}
}

45 
šlše
 
	$Com·»
(cÚ¡ 
wÜd
 *
A
, cÚ¡ wÜd *
B
, 
size_t
 
N
)

47 
N
--)

48 ià(
A
[
N
] > 
B
[N])

50 ià(
A
[
N
] < 
B
[N])

54 
	}
}

56 
šlše
 
	$Inüem’t
(
wÜd
 *
A
, 
size_t
 
N
, wÜd 
B
=1)

58 
	`as£¹
(
N
);

59 
wÜd
 
t
 = 
A
[0];

60 
A
[0] = 
t
+
B
;

61 ià(
A
[0] >ğ
t
)

63 
i
=1; i<
N
; i++)

64 ià(++
A
[
i
])

67 
	}
}

69 
šlše
 
	$Deüem’t
(
wÜd
 *
A
, 
size_t
 
N
, wÜd 
B
=1)

71 
	`as£¹
(
N
);

72 
wÜd
 
t
 = 
A
[0];

73 
A
[0] = 
t
-
B
;

74 ià(
A
[0] <ğ
t
)

76 
i
=1; i<
N
; i++)

77 ià(
A
[
i
]--)

80 
	}
}

82 
	$TwosCom¶em’t
(
wÜd
 *
A
, 
size_t
 
N
)

84 
	`Deüem’t
(
A
, 
N
);

85 
i
=0; i<
N
; i++)

86 
A
[
i
] = ~A[i];

87 
	}
}

89 
wÜd
 
	$AtomicInv”£ModPow”2
(
wÜd
 
A
)

91 
	`as£¹
(
A
%2==1);

93 
wÜd
 
R
=
A
%8;

95 
i
=3; i<
WORD_BITS
; i*=2)

96 
R
 = R*(2-R*
A
);

98 
	`as£¹
(
R
*
A
==1);

99  
R
;

100 
	}
}

104 #ià!
defšed
(
CRYPTOPP_NATIVE_DWORD_AVAILABLE
è|| (defšed(
__x86_64__
è&& defšed(
CRYPTOPP_WORD128_AVAILABLE
))

105 
	#Deş¬e2WÜds
(
x
è
wÜd
 x##0, x##1;

	)

106 
	#AssignWÜd
(
a
, 
b
èa##0 = b;‡##1 = 0;

	)

107 
	#Add2WÜdsBy1
(
a
, 
b
, 
c
èa##0 = b##0 + c;‡##1 = b##1 + (a##0 < c);

	)

108 
	#LowWÜd
(
a
èa##0

	)

109 
	#HighWÜd
(
a
èa##1

	)

110 #ifdeà
_MSC_VER


111 
	#MuÉlyWÜdsLoHi
(
p0
, 
p1
, 
a
, 
b
èp0 = 
	`_umul128
×, b, &p1);

	)

112 #iâdeà
__INTEL_COMPILER


113 
	#DoubË3WÜds
(
c
, 
d
èd##1 = 
	`__shiáËá128
(d##0, d##1, 1); d##0 = __shiáËá128(c, d##0, 1); c *ğ2;

	)

115 #–ià
defšed
(
__DECCXX
)

116 
	#MuÉlyWÜdsLoHi
(
p0
, 
p1
, 
a
, 
b
èp0 =‡*b;…1 = 
	`asm
("umulh %a0, %a1, %v0",‡, b);

	)

117 #–ià
defšed
(
__x86_64__
)

118 #ià
defšed
(
__SUNPRO_CC
) && __SUNPRO_CC < 0x5100

120 
	#MuÉlyWÜdsLoHi
(
p0
, 
p1
, 
a
, 
b
è
	`asm
 ("mulq %3" : "÷"Õ0), "=d"Õ1è: "a"×), "r"(bè: "cc");

	)

122 
	#MuÉlyWÜdsLoHi
(
p0
, 
p1
, 
a
, 
b
è
	`asm
 ("mulq %3" : "÷"Õ0), "=d"Õ1è: "a"×), "g"(bè: "cc");

	)

123 
	#MulAcc
(
c
, 
d
, 
a
, 
b
è
	`asm
 ("mulq %6;‡ddq %3, %0;‡dcq %4, %1;‡dcq $0, %2;" : "+r"(c), "+r"(d##0), "+r"(d##1), "÷"(
p0
), "=d"(
p1
è: "a"×), "g"(bè: "cc");

	)

124 
	#DoubË3WÜds
(
c
, 
d
è
	`asm
 ("addq %0, %0;‡dcq %1, %1;‡dcq %2, %2;" : "+r"(c), "+r"(d##0), "+r"(d##1è: : "cc");

	)

125 
	#Acc2WÜdsBy1
(
a
, 
b
è
	`asm
 ("addq %2, %0;‡dcq $0, %1;" : "+r"×##0), "+r"×##1è: "r"(bè: "cc");

	)

126 
	#Acc2WÜdsBy2
(
a
, 
b
è
	`asm
 ("addq %2, %0;‡dcq %3, %1;" : "+r"×##0), "+r"×##1è: "r"(b##0), "r"(b##1è: "cc");

	)

127 
	#Acc3WÜdsBy2
(
c
, 
d
, 
e
è
	`asm
 ("addq %5, %0;‡dcq %6, %1;‡dcq $0, %2;" : "+r"(c), "ô"Ó##0), "ô"Ó##1è: "1"(d##0), "2"(d##1), "r"Ó##0), "r"Ó##1è: "cc");

	)

130 
	#MuÉlyWÜds
(
p
, 
a
, 
b
è
	`MuÉlyWÜdsLoHi
Õ##0,…##1,‡, b)

	)

131 #iâdeà
DoubË3WÜds


132 
	#DoubË3WÜds
(
c
, 
d
èd##1 = 2*d##1 + (d##0>>(
WORD_BITS
-1)); d##0 = 2*d##0 + (c>>(WORD_BITS-1)); c *ğ2;

	)

134 #iâdeà
Acc2WÜdsBy2


135 
	#Acc2WÜdsBy2
(
a
, 
b
èa##0 +ğb##0;‡##1 +ğa##0 < b##0;‡##1 +ğb##1;

	)

137 
	#AddW™hC¬ry
(
u
, 
a
, 
b
è{
wÜd
 
t
 =‡+b; u##0 = + u##1; u##1 = (t<aè+ (u##0<t);}

	)

138 
	#SubŒaùW™hBÜrow
(
u
, 
a
, 
b
è{
wÜd
 
t
 =‡-b; u##0 = - u##1; u##1 = (t>aè+ (u##0>t);}

	)

139 
	#G‘C¬ry
(
u
èu##1

	)

140 
	#G‘BÜrow
(
u
èu##1

	)

142 
	#Deş¬e2WÜds
(
x
è
dwÜd
 x;

	)

143 #ià
_MSC_VER
 >ğ1400 && !
defšed
(
__INTEL_COMPILER
)

144 
	#MuÉlyWÜds
(
p
, 
a
, 
b
è°ğ
	`__emulu
×, b);

	)

146 
	#MuÉlyWÜds
(
p
, 
a
, 
b
è°ğ(
dwÜd
ï*b;

	)

148 
	#AssignWÜd
(
a
, 
b
è¨ğb;

	)

149 
	#Add2WÜdsBy1
(
a
, 
b
, 
c
è¨ğb + c;

	)

150 
	#Acc2WÜdsBy2
(
a
, 
b
è¨+ğb;

	)

151 
	#LowWÜd
(
a
è
	`wÜd
×)

	)

152 
	#HighWÜd
(
a
è
	`wÜd
×>>
WORD_BITS
)

	)

153 
	#DoubË3WÜds
(
c
, 
d
èd = 2*d + (c>>(
WORD_BITS
-1)); c *ğ2;

	)

154 
	#AddW™hC¬ry
(
u
, 
a
, 
b
èu = 
	`dwÜd
×è+ b + 
	`G‘C¬ry
(u);

	)

155 
	#SubŒaùW™hBÜrow
(
u
, 
a
, 
b
èu = 
	`dwÜd
×è- b - 
	`G‘BÜrow
(u);

	)

156 
	#G‘C¬ry
(
u
è
	`HighWÜd
(u)

	)

157 
	#G‘BÜrow
(
u
è
	`wÜd
(u>>(
WORD_BITS
*2-1))

	)

159 #iâdeà
MulAcc


160 
	#MulAcc
(
c
, 
d
, 
a
, 
b
è
	`MuÉlyWÜds
(
p
,‡, b); 
	`Acc2WÜdsBy1
Õ, c); c = 
	`LowWÜd
Õ); Acc2WÜdsBy1(d, 
	`HighWÜd
Õ));

	)

162 #iâdeà
Acc2WÜdsBy1


163 
	#Acc2WÜdsBy1
(
a
, 
b
è
	`Add2WÜdsBy1
×,‡, b)

	)

165 #iâdeà
Acc3WÜdsBy2


166 
	#Acc3WÜdsBy2
(
c
, 
d
, 
e
è
	`Acc2WÜdsBy1
Ó, c); c = 
	`LowWÜd
Ó); 
	`Add2WÜdsBy1
Ó, d, 
	`HighWÜd
Ó));

	)

169 şas 
	cDWÜd


171 
	mpublic
:

172 
	$DWÜd
() {}

174 #ifdeà
CRYPTOPP_NATIVE_DWORD_AVAILABLE


175 
ex¶ic™
 
	$DWÜd
(
wÜd
 
low
)

177 
m_whŞe
 = 
low
;

178 
	}
}

180 
ex¶ic™
 
	$DWÜd
(
wÜd
 
low
)

182 
m_h®fs
.
low
 =†ow;

183 
m_h®fs
.
high
 = 0;

184 
	}
}

187 
	$DWÜd
(
wÜd
 
low
, wÜd 
high
)

189 
m_h®fs
.
low
 =†ow;

190 
m_h®fs
.
high
 = high;

191 
	}
}

193 
DWÜd
 
	$MuÉly
(
wÜd
 
a
, wÜd 
b
)

195 
DWÜd
 
r
;

196 #ifdeà
CRYPTOPP_NATIVE_DWORD_AVAILABLE


197 
r
.
m_whŞe
 = (
dwÜd
)
a
 * 
b
;

198 #–ià
	`defšed
(
MuÉlyWÜdsLoHi
)

199 
	`MuÉlyWÜdsLoHi
(
r
.
m_h®fs
.
low
,„.m_h®fs.
high
, 
a
, 
b
);

201  
r
;

202 
	}
}

204 
DWÜd
 
	$MuÉlyAndAdd
(
wÜd
 
a
, wÜd 
b
, wÜd 
c
)

206 
DWÜd
 
r
 = 
	`MuÉly
(
a
, 
b
);

207  
r
 +ğ
c
;

208 
	}
}

210 
	gDWÜd
 & 
	gİ”©Ü
+=(
wÜd
 
a
)

212 #ifdeà
CRYPTOPP_NATIVE_DWORD_AVAILABLE


213 
m_whŞe
 = m_whŞ+ 
a
;

215 
	gm_h®fs
.
	glow
 +ğ
a
;

216 
	gm_h®fs
.
	ghigh
 +ğ(
m_h®fs
.
low
 < 
a
);

218  *
	gthis
;

221 
DWÜd
 
	gİ”©Ü
+(
wÜd
 
	ga
)

223 
DWÜd
 
	gr
;

224 #ifdeà
CRYPTOPP_NATIVE_DWORD_AVAILABLE


225 
	gr
.
	gm_whŞe
 = 
m_whŞe
 + 
a
;

227 
	gr
.
	gm_h®fs
.
	glow
 = 
m_h®fs
.
low
 + 
a
;

228 
	gr
.
	gm_h®fs
.
	ghigh
 = 
m_h®fs
.
high
 + (
r
.m_h®fs.
low
 < 
a
);

230  
	gr
;

233 
DWÜd
 
	gİ”©Ü
-(DWÜd 
	ga
)

235 
DWÜd
 
	gr
;

236 #ifdeà
CRYPTOPP_NATIVE_DWORD_AVAILABLE


237 
	gr
.
	gm_whŞe
 = 
m_whŞe
 - 
a
.m_whole;

239 
	gr
.
	gm_h®fs
.
	glow
 = 
m_h®fs
.
low
 - 
a
.m_halfs.low;

240 
	gr
.
	gm_h®fs
.
	ghigh
 = 
m_h®fs
.
high
 - 
a
.m_h®fs.high - (
r
.m_h®fs.
low
 > m_halfs.low);

242  
	gr
;

245 
DWÜd
 
	gİ”©Ü
-(
wÜd
 
	ga
)

247 
DWÜd
 
	gr
;

248 #ifdeà
CRYPTOPP_NATIVE_DWORD_AVAILABLE


249 
	gr
.
	gm_whŞe
 = 
m_whŞe
 - 
a
;

251 
	gr
.
	gm_h®fs
.
	glow
 = 
m_h®fs
.
low
 - 
a
;

252 
	gr
.
	gm_h®fs
.
	ghigh
 = 
m_h®fs
.
high
 - (
r
.m_h®fs.
low
 > m_halfs.low);

254  
	gr
;

258 
wÜd
 
	gİ”©Ü
/(wÜd 
	gdivisÜ
);

260 
wÜd
 
	gİ”©Ü
%(wÜd 
	ga
);

262 
boŞ
 
	gİ”©Ü
!() const

264 #ifdeà
CRYPTOPP_NATIVE_DWORD_AVAILABLE


265  !
	gm_whŞe
;

267  !
	gm_h®fs
.
	ghigh
 && !m_h®fs.
	glow
;

271 
wÜd
 
	$G‘LowH®f
(ècÚ¡ { 
m_h®fs
.
low
;
	}
}

272 
wÜd
 
	$G‘HighH®f
(ècÚ¡ { 
m_h®fs
.
high
;
	}
}

273 
wÜd
 
	$G‘HighH®fAsBÜrow
(ècÚ¡ { 0-
m_h®fs
.
high
;
	}
}

275 
	g´iv©e
:

278 #ifdeà
CRYPTOPP_NATIVE_DWORD_AVAILABLE


279 
dwÜd
 
m_whŞe
;

283 #ifdeà
IS_LITTLE_ENDIAN


284 
wÜd
 
	glow
;

285 
wÜd
 
	ghigh
;

287 
wÜd
 
	ghigh
;

288 
wÜd
 
	glow
;

290 } 
	gm_h®fs
;

294 şas 
	cWÜd


296 
	mpublic
:

297 
	$WÜd
() {}

299 
	$WÜd
(
wÜd
 
v®ue
)

301 
m_whŞe
 = 
v®ue
;

302 
	}
}

304 
	$WÜd
(
hwÜd
 
low
, hwÜd 
high
)

306 
m_whŞe
 = 
low
 | (
	`wÜd
(
high
è<< (
WORD_BITS
/2));

307 
	}
}

309 
WÜd
 
	$MuÉly
(
hwÜd
 
a
, hwÜd 
b
)

311 
WÜd
 
r
;

312 
r
.
m_whŞe
 = (
wÜd
)
a
 * 
b
;

313  
r
;

314 
	}
}

316 
WÜd
 
	gİ”©Ü
-(WÜd 
	ga
)

318 
WÜd
 
	gr
;

319 
	gr
.
	gm_whŞe
 = 
m_whŞe
 - 
a
.m_whole;

320  
	gr
;

323 
WÜd
 
	gİ”©Ü
-(
hwÜd
 
	ga
)

325 
WÜd
 
	gr
;

326 
	gr
.
	gm_whŞe
 = 
m_whŞe
 - 
a
;

327  
	gr
;

331 
hwÜd
 
	gİ”©Ü
/(hwÜd 
	gdivisÜ
)

333  
hwÜd
(
m_whŞe
 / 
divisÜ
);

336 
boŞ
 
	gİ”©Ü
!() const

338  !
	gm_whŞe
;

341 
wÜd
 
	$G‘WhŞe
(ècÚ¡ { 
m_whŞe
;
	}
}

342 
hwÜd
 
	$G‘LowH®f
(ècÚ¡ { 
	`hwÜd
(
m_whŞe
);
	}
}

343 
hwÜd
 
	$G‘HighH®f
(ècÚ¡ { 
	`hwÜd
(
m_whŞe
>>(
WORD_BITS
/2));
	}
}

344 
hwÜd
 
	$G‘HighH®fAsBÜrow
(ècÚ¡ { 0-
	`hwÜd
(
m_whŞe
>>(
WORD_BITS
/2));
	}
}

346 
	g´iv©e
:

347 
wÜd
 
m_whŞe
;

351 
	g‹m¶©e
 <
şass
 
	gS
, cÏs 
	gD
>

352 
S
 
	$DivideTh»eWÜdsByTwo
(
S
 *
A
, S 
B0
, S 
B1
, 
D
 *
dummy
=
NULL
)

355 
	`as£¹
(
A
[2] < 
B1
 || (A[2]==B1 && A[1] < 
B0
));

358 
S
 
Q
;

359 ià(
	`S
(
B1
+1) == 0)

360 
Q
 = 
A
[2];

361 ià(
B1
 > 0)

362 
Q
 = 
	`D
(
A
[1], A[2]è/ 
	`S
(
B1
+1);

364 
Q
 = 
	`D
(
A
[0], A[1]è/ 
B0
;

367 
D
 
p
 = D::
	`MuÉly
(
B0
, 
Q
);

368 
D
 
u
 = (Dè
A
[0] - 
p
.
	`G‘LowH®f
();

369 
A
[0] = 
u
.
	`G‘LowH®f
();

370 
u
 = (
D
è
A
[1] - 
p
.
	`G‘HighH®f
(è- u.
	`G‘HighH®fAsBÜrow
(è- D::
	`MuÉly
(
B1
, 
Q
);

371 
A
[1] = 
u
.
	`G‘LowH®f
();

372 
A
[2] +ğ
u
.
	`G‘HighH®f
();

375 
A
[2] || A[1] > 
B1
 || (A[1]==B1 && A[0]>=
B0
))

377 
u
 = (
D
è
A
[0] - 
B0
;

378 
A
[0] = 
u
.
	`G‘LowH®f
();

379 
u
 = (
D
è
A
[1] - 
B1
 - u.
	`G‘HighH®fAsBÜrow
();

380 
A
[1] = 
u
.
	`G‘LowH®f
();

381 
A
[2] +ğ
u
.
	`G‘HighH®f
();

382 
Q
++;

383 
	`as£¹
(
Q
);

386  
Q
;

387 
	}
}

390 
	g‹m¶©e
 <
şass
 
	gS
, cÏs 
	gD
>

391 
šlše
 
D
 
	$DivideFourWÜdsByTwo
(
S
 *
T
, cÚ¡ 
D
 &
Al
, cÚ¡ D &
Ah
, cÚ¡ D &
B
)

393 ià(!
B
)

394  
	`D
(
Ah
.
	`G‘LowH®f
(), Ah.
	`G‘HighH®f
());

397 
S
 
Q
[2];

398 
T
[0] = 
Al
.
	`G‘LowH®f
();

399 
T
[1] = 
Al
.
	`G‘HighH®f
();

400 
T
[2] = 
Ah
.
	`G‘LowH®f
();

401 
T
[3] = 
Ah
.
	`G‘HighH®f
();

402 
Q
[1] = 
DivideTh»eWÜdsByTwo
<
S
, 
D
>(
T
+1, 
B
.
	`G‘LowH®f
(), B.
	`G‘HighH®f
());

403 
Q
[0] = 
DivideTh»eWÜdsByTwo
<
S
, 
D
>(
T
, 
B
.
	`G‘LowH®f
(), B.
	`G‘HighH®f
());

404  
	`D
(
Q
[0], Q[1]);

406 
	}
}

409 
šlše
 
wÜd
 
	gDWÜd
::
İ”©Ü
/(wÜd 
a
)

411 #ifdeà
CRYPTOPP_NATIVE_DWORD_AVAILABLE


412  
wÜd
(
m_whŞe
 / 
a
);

414 
hwÜd
 
	gr
[4];

415  
	gDivideFourWÜdsByTwo
<
	ghwÜd
, 
	gWÜd
>(
	gr
, 
	gm_h®fs
.
	glow
, m_h®fs.
	ghigh
, 
	ga
).
G‘WhŞe
();

419 
šlše
 
wÜd
 
	gDWÜd
::
İ”©Ü
%(wÜd 
a
)

421 #ifdeà
CRYPTOPP_NATIVE_DWORD_AVAILABLE


422  
wÜd
(
m_whŞe
 % 
a
);

424 ià(
	ga
 < (
wÜd
(1è<< (
	gWORD_BITS
/2)))

426 
hwÜd
 
	gh
 = hwÜd(
a
);

427 
wÜd
 
	gr
 = 
m_h®fs
.
high
 % 
h
;

428 
	gr
 = ((
m_h®fs
.
low
 >> (
WORD_BITS
/2)è+ (
r
 << (WORD_BITS/2))è% 
h
;

429  
hwÜd
((hwÜd(
m_h®fs
.
low
è+ (
r
 << (
WORD_BITS
/2))è% 
h
);

433 
hwÜd
 
	gr
[4];

434 
	gDivideFourWÜdsByTwo
<
	ghwÜd
, 
	gWÜd
>(
	gr
, 
	gm_h®fs
.
	glow
, m_h®fs.
	ghigh
, 
	ga
);

435  
WÜd
(
r
[0],„[1]).
G‘WhŞe
();

443 #ià
defšed
(
__GNUC__
)

444 
	#AddPrŞogue
 \

445 
»suÉ
; \

446 
__asm__
 
__vŞ©e__
 \

448 ".š‹l_syÁax‚İ»fix;"

	)

449 
	#AddEpogue
 \

451 : "÷" (
»suÉ
)\

452 : "d" (
C
), "a" (
A
), "D" (
B
), "c" (
N
) \

455  
»suÉ
;

	)

456 
	#MulPrŞogue
 \

457 
__asm__
 
__vŞ©e__
 \

460 
	`AS1
Ğ
push
 
ebx
) \

461 
	`AS2
Ğ
mov
 
ebx
, 
edx
)

	)

462 
	#MulEpogue
 \

463 
	`AS1
Ğ
pİ
 
ebx
) \

466 : "d" (
s_maskLow16
), "c" (
C
), "a" (
A
), "D" (
B
) \

468 );

	)

469 
	#SquPrŞogue
 
MulPrŞogue


	)

470 
	#SquEpogue
 \

471 
	`AS1
Ğ
pİ
 
ebx
) \

474 : "d" (
s_maskLow16
), "c" (
C
), "a" (
A
) \

476 );

	)

477 
	#TİPrŞogue
 
MulPrŞogue


	)

478 
	#TİEpogue
 \

479 
	`AS1
Ğ
pİ
 
ebx
) \

482 : "d" (
s_maskLow16
), "c" (
C
), "a" (
A
), "D" (
B
), "S" (
L
) \

484 );

	)

486 
	#AddPrŞogue
 \

487 
__asm
 
push
 
edi
 \

488 
__asm
 
push
 
esi
 \

489 
__asm
 
mov
 
—x
, [
e¥
+12] \

490 
__asm
 
mov
 
edi
, [
e¥
+16]

	)

491 
	#AddEpogue
 \

492 
__asm
 
pİ
 
esi
 \

493 
__asm
 
pİ
 
edi
 \

494 
__asm
 
»t
 8

	)

495 #ià
_MSC_VER
 < 1300

496 
	#SaveEBX
 
__asm
 
push
 
ebx


	)

497 
	#Re¡ÜeEBX
 
__asm
 
pİ
 
ebx


	)

499 
	#SaveEBX


	)

500 
	#Re¡ÜeEBX


	)

502 
	#SquPrŞogue
 \

503 
	`AS2
Ğ
mov
 
—x
, 
A
) \

504 
	`AS2
Ğ
mov
 
ecx
, 
C
) \

505 
SaveEBX
 \

506 
	`AS2
Ğ
Ëa
 
ebx
, 
s_maskLow16
)

	)

507 
	#MulPrŞogue
 \

508 
	`AS2
Ğ
mov
 
—x
, 
A
) \

509 
	`AS2
Ğ
mov
 
edi
, 
B
) \

510 
	`AS2
Ğ
mov
 
ecx
, 
C
) \

511 
SaveEBX
 \

512 
	`AS2
Ğ
Ëa
 
ebx
, 
s_maskLow16
)

	)

513 
	#TİPrŞogue
 \

514 
	`AS2
Ğ
mov
 
—x
, 
A
) \

515 
	`AS2
Ğ
mov
 
edi
, 
B
) \

516 
	`AS2
Ğ
mov
 
ecx
, 
C
) \

517 
	`AS2
Ğ
mov
 
esi
, 
L
) \

518 
SaveEBX
 \

519 
	`AS2
Ğ
Ëa
 
ebx
, 
s_maskLow16
)

	)

520 
	#SquEpogue
 
Re¡ÜeEBX


	)

521 
	#MulEpogue
 
Re¡ÜeEBX


	)

522 
	#TİEpogue
 
Re¡ÜeEBX


	)

525 #ifdeà
CRYPTOPP_X64_MASM_AVAILABLE


527 
Ba£lše_Add
(
size_t
 
N
, 
wÜd
 *
C
, cÚ¡ wÜd *
A
, cÚ¡ wÜd *
B
);

528 
Ba£lše_Sub
(
size_t
 
N
, 
wÜd
 *
C
, cÚ¡ wÜd *
A
, cÚ¡ wÜd *
B
);

530 #–ià
defšed
(
CRYPTOPP_X64_ASM_AVAILABLE
è&& defšed(
__GNUC__
è&& defšed(
CRYPTOPP_WORD128_AVAILABLE
)

531 
	$Ba£lše_Add
(
size_t
 
N
, 
wÜd
 *
C
, cÚ¡ wÜd *
A
, cÚ¡ wÜd *
B
)

533 
wÜd
 
»suÉ
;

534 
__asm__
 
__vŞ©e__


537 
	`AS1
Ğ
Ãg
 %1)

538 
	`ASJ
Ğ
jz
, 1, 
f
)

539 
	`AS2
Ğ
mov
 %0,[%3+8*%1])

540 
	`AS2
Ğ
add
 %0,[%4+8*%1])

541 
	`AS2
Ğ
mov
 [%2+8*%1],%0)

542 
	`ASL
(0)

543 
	`AS2
Ğ
mov
 %0,[%3+8*%1+8])

544 
	`AS2
Ğ
adc
 %0,[%4+8*%1+8])

545 
	`AS2
Ğ
mov
 [%2+8*%1+8],%0)

546 
	`AS2
Ğ
Ëa
 %1,[%1+2])

547 
	`ASJ
Ğ
jrcxz
, 1, 
f
)

548 
	`AS2
Ğ
mov
 %0,[%3+8*%1])

549 
	`AS2
Ğ
adc
 %0,[%4+8*%1])

550 
	`AS2
Ğ
mov
 [%2+8*%1],%0)

551 
	`ASJ
Ğ
jmp
, 0, 
b
)

552 
	`ASL
(1)

553 
	`AS2
Ğ
mov
 %0, 0)

554 
	`AS2
Ğ
adc
 %0, %0)

556 : "=&r" (
»suÉ
), "+c" (
N
)

557 : "r" (
C
+
N
), "r" (
A
+N), "r" (
B
+N)

560  ()
»suÉ
;

561 
	}
}

563 
	$Ba£lše_Sub
(
size_t
 
N
, 
wÜd
 *
C
, cÚ¡ wÜd *
A
, cÚ¡ wÜd *
B
)

565 
wÜd
 
»suÉ
;

566 
__asm__
 
__vŞ©e__


569 
	`AS1
Ğ
Ãg
 %1)

570 
	`ASJ
Ğ
jz
, 1, 
f
)

571 
	`AS2
Ğ
mov
 %0,[%3+8*%1])

572 
	`AS2
Ğ
sub
 %0,[%4+8*%1])

573 
	`AS2
Ğ
mov
 [%2+8*%1],%0)

574 
	`ASL
(0)

575 
	`AS2
Ğ
mov
 %0,[%3+8*%1+8])

576 
	`AS2
Ğ
sbb
 %0,[%4+8*%1+8])

577 
	`AS2
Ğ
mov
 [%2+8*%1+8],%0)

578 
	`AS2
Ğ
Ëa
 %1,[%1+2])

579 
	`ASJ
Ğ
jrcxz
, 1, 
f
)

580 
	`AS2
Ğ
mov
 %0,[%3+8*%1])

581 
	`AS2
Ğ
sbb
 %0,[%4+8*%1])

582 
	`AS2
Ğ
mov
 [%2+8*%1],%0)

583 
	`ASJ
Ğ
jmp
, 0, 
b
)

584 
	`ASL
(1)

585 
	`AS2
Ğ
mov
 %0, 0)

586 
	`AS2
Ğ
adc
 %0, %0)

588 : "=&r" (
»suÉ
), "+c" (
N
)

589 : "r" (
C
+
N
), "r" (
A
+N), "r" (
B
+N)

592  ()
»suÉ
;

593 
	}
}

594 #–ià
defšed
(
CRYPTOPP_X86_ASM_AVAILABLE
è&& 
CRYPTOPP_BOOL_X86


595 
CRYPTOPP_NAKED
 
CRYPTOPP_FASTCALL
 
	$Ba£lše_Add
(
size_t
 
N
, 
wÜd
 *
C
, cÚ¡ wÜd *
A
, cÚ¡ wÜd *
B
)

597 
AddPrŞogue


600 
	`AS2
Ğ
Ëa
 
—x
, [—x+4*
ecx
])

601 
	`AS2
Ğ
Ëa
 
edi
, [edi+4*
ecx
])

602 
	`AS2
Ğ
Ëa
 
edx
, [edx+4*
ecx
])

604 
	`AS1
Ğ
Ãg
 
ecx
)

605 
	`AS2
Ğ
‹¡
 
ecx
, 2)

606 
	`ASJ
Ğ
jz
, 0, 
f
)

607 
	`AS2
Ğ
sub
 
ecx
, 2)

608 
	`ASJ
Ğ
jmp
, 1, 
f
)

610 
	`ASL
(0)

611 
	`ASJ
Ğ
jecxz
, 2, 
f
)

612 
	`AS2
Ğ
mov
 
esi
,[
—x
+4*
ecx
])

613 
	`AS2
Ğ
adc
 
esi
,[
edi
+4*
ecx
])

614 
	`AS2
Ğ
mov
 [
edx
+4*
ecx
],
esi
)

615 
	`AS2
Ğ
mov
 
esi
,[
—x
+4*
ecx
+4])

616 
	`AS2
Ğ
adc
 
esi
,[
edi
+4*
ecx
+4])

617 
	`AS2
Ğ
mov
 [
edx
+4*
ecx
+4],
esi
)

618 
	`ASL
(1)

619 
	`AS2
Ğ
mov
 
esi
,[
—x
+4*
ecx
+8])

620 
	`AS2
Ğ
adc
 
esi
,[
edi
+4*
ecx
+8])

621 
	`AS2
Ğ
mov
 [
edx
+4*
ecx
+8],
esi
)

622 
	`AS2
Ğ
mov
 
esi
,[
—x
+4*
ecx
+12])

623 
	`AS2
Ğ
adc
 
esi
,[
edi
+4*
ecx
+12])

624 
	`AS2
Ğ
mov
 [
edx
+4*
ecx
+12],
esi
)

626 
	`AS2
Ğ
Ëa
 
ecx
,[ecx+4])

627 
	`ASJ
Ğ
jmp
, 0, 
b
)

629 
	`ASL
(2)

630 
	`AS2
Ğ
mov
 
—x
, 0)

631 
	`AS1
Ğ
£tc
 
®
)

633 
AddEpogue


634 
	}
}

636 
CRYPTOPP_NAKED
 
CRYPTOPP_FASTCALL
 
	$Ba£lše_Sub
(
size_t
 
N
, 
wÜd
 *
C
, cÚ¡ wÜd *
A
, cÚ¡ wÜd *
B
)

638 
AddPrŞogue


641 
	`AS2
Ğ
Ëa
 
—x
, [—x+4*
ecx
])

642 
	`AS2
Ğ
Ëa
 
edi
, [edi+4*
ecx
])

643 
	`AS2
Ğ
Ëa
 
edx
, [edx+4*
ecx
])

645 
	`AS1
Ğ
Ãg
 
ecx
)

646 
	`AS2
Ğ
‹¡
 
ecx
, 2)

647 
	`ASJ
Ğ
jz
, 0, 
f
)

648 
	`AS2
Ğ
sub
 
ecx
, 2)

649 
	`ASJ
Ğ
jmp
, 1, 
f
)

651 
	`ASL
(0)

652 
	`ASJ
Ğ
jecxz
, 2, 
f
)

653 
	`AS2
Ğ
mov
 
esi
,[
—x
+4*
ecx
])

654 
	`AS2
Ğ
sbb
 
esi
,[
edi
+4*
ecx
])

655 
	`AS2
Ğ
mov
 [
edx
+4*
ecx
],
esi
)

656 
	`AS2
Ğ
mov
 
esi
,[
—x
+4*
ecx
+4])

657 
	`AS2
Ğ
sbb
 
esi
,[
edi
+4*
ecx
+4])

658 
	`AS2
Ğ
mov
 [
edx
+4*
ecx
+4],
esi
)

659 
	`ASL
(1)

660 
	`AS2
Ğ
mov
 
esi
,[
—x
+4*
ecx
+8])

661 
	`AS2
Ğ
sbb
 
esi
,[
edi
+4*
ecx
+8])

662 
	`AS2
Ğ
mov
 [
edx
+4*
ecx
+8],
esi
)

663 
	`AS2
Ğ
mov
 
esi
,[
—x
+4*
ecx
+12])

664 
	`AS2
Ğ
sbb
 
esi
,[
edi
+4*
ecx
+12])

665 
	`AS2
Ğ
mov
 [
edx
+4*
ecx
+12],
esi
)

667 
	`AS2
Ğ
Ëa
 
ecx
,[ecx+4])

668 
	`ASJ
Ğ
jmp
, 0, 
b
)

670 
	`ASL
(2)

671 
	`AS2
Ğ
mov
 
—x
, 0)

672 
	`AS1
Ğ
£tc
 
®
)

674 
AddEpogue


675 
	}
}

677 #ià
CRYPTOPP_INTEGER_SSE2


678 
CRYPTOPP_NAKED
 
CRYPTOPP_FASTCALL
 
	$SSE2_Add
(
size_t
 
N
, 
wÜd
 *
C
, cÚ¡ wÜd *
A
, cÚ¡ wÜd *
B
)

680 
AddPrŞogue


683 
	`AS2
Ğ
Ëa
 
—x
, [—x+4*
ecx
])

684 
	`AS2
Ğ
Ëa
 
edi
, [edi+4*
ecx
])

685 
	`AS2
Ğ
Ëa
 
edx
, [edx+4*
ecx
])

687 
	`AS1
Ğ
Ãg
 
ecx
)

688 
	`AS2
Ğ
pxÜ
 
mm2
, mm2)

689 
	`ASJ
Ğ
jz
, 2, 
f
)

690 
	`AS2
Ğ
‹¡
 
ecx
, 2)

691 
	`ASJ
Ğ
jz
, 0, 
f
)

692 
	`AS2
Ğ
sub
 
ecx
, 2)

693 
	`ASJ
Ğ
jmp
, 1, 
f
)

695 
	`ASL
(0)

696 
	`AS2
Ğ
movd
 
mm0
, 
DWORD
 
PTR
 [
—x
+4*
ecx
])

697 
	`AS2
Ğ
movd
 
mm1
, 
DWORD
 
PTR
 [
edi
+4*
ecx
])

698 
	`AS2
Ğ
·ddq
 
mm0
, 
mm1
)

699 
	`AS2
Ğ
·ddq
 
mm2
, 
mm0
)

700 
	`AS2
Ğ
movd
 
DWORD
 
PTR
 [
edx
+4*
ecx
], 
mm2
)

701 
	`AS2
Ğ
p¤lq
 
mm2
, 32)

703 
	`AS2
Ğ
movd
 
mm0
, 
DWORD
 
PTR
 [
—x
+4*
ecx
+4])

704 
	`AS2
Ğ
movd
 
mm1
, 
DWORD
 
PTR
 [
edi
+4*
ecx
+4])

705 
	`AS2
Ğ
·ddq
 
mm0
, 
mm1
)

706 
	`AS2
Ğ
·ddq
 
mm2
, 
mm0
)

707 
	`AS2
Ğ
movd
 
DWORD
 
PTR
 [
edx
+4*
ecx
+4], 
mm2
)

708 
	`AS2
Ğ
p¤lq
 
mm2
, 32)

710 
	`ASL
(1)

711 
	`AS2
Ğ
movd
 
mm0
, 
DWORD
 
PTR
 [
—x
+4*
ecx
+8])

712 
	`AS2
Ğ
movd
 
mm1
, 
DWORD
 
PTR
 [
edi
+4*
ecx
+8])

713 
	`AS2
Ğ
·ddq
 
mm0
, 
mm1
)

714 
	`AS2
Ğ
·ddq
 
mm2
, 
mm0
)

715 
	`AS2
Ğ
movd
 
DWORD
 
PTR
 [
edx
+4*
ecx
+8], 
mm2
)

716 
	`AS2
Ğ
p¤lq
 
mm2
, 32)

718 
	`AS2
Ğ
movd
 
mm0
, 
DWORD
 
PTR
 [
—x
+4*
ecx
+12])

719 
	`AS2
Ğ
movd
 
mm1
, 
DWORD
 
PTR
 [
edi
+4*
ecx
+12])

720 
	`AS2
Ğ
·ddq
 
mm0
, 
mm1
)

721 
	`AS2
Ğ
·ddq
 
mm2
, 
mm0
)

722 
	`AS2
Ğ
movd
 
DWORD
 
PTR
 [
edx
+4*
ecx
+12], 
mm2
)

723 
	`AS2
Ğ
p¤lq
 
mm2
, 32)

725 
	`AS2
Ğ
add
 
ecx
, 4)

726 
	`ASJ
Ğ
jnz
, 0, 
b
)

728 
	`ASL
(2)

729 
	`AS2
Ğ
movd
 
—x
, 
mm2
)

730 
	`AS1
Ğ
emms
)

732 
AddEpogue


733 
	}
}

734 
CRYPTOPP_NAKED
 
CRYPTOPP_FASTCALL
 
	$SSE2_Sub
(
size_t
 
N
, 
wÜd
 *
C
, cÚ¡ wÜd *
A
, cÚ¡ wÜd *
B
)

736 
AddPrŞogue


739 
	`AS2
Ğ
Ëa
 
—x
, [—x+4*
ecx
])

740 
	`AS2
Ğ
Ëa
 
edi
, [edi+4*
ecx
])

741 
	`AS2
Ğ
Ëa
 
edx
, [edx+4*
ecx
])

743 
	`AS1
Ğ
Ãg
 
ecx
)

744 
	`AS2
Ğ
pxÜ
 
mm2
, mm2)

745 
	`ASJ
Ğ
jz
, 2, 
f
)

746 
	`AS2
Ğ
‹¡
 
ecx
, 2)

747 
	`ASJ
Ğ
jz
, 0, 
f
)

748 
	`AS2
Ğ
sub
 
ecx
, 2)

749 
	`ASJ
Ğ
jmp
, 1, 
f
)

751 
	`ASL
(0)

752 
	`AS2
Ğ
movd
 
mm0
, 
DWORD
 
PTR
 [
—x
+4*
ecx
])

753 
	`AS2
Ğ
movd
 
mm1
, 
DWORD
 
PTR
 [
edi
+4*
ecx
])

754 
	`AS2
Ğ
psubq
 
mm0
, 
mm1
)

755 
	`AS2
Ğ
psubq
 
mm0
, 
mm2
)

756 
	`AS2
Ğ
movd
 
DWORD
 
PTR
 [
edx
+4*
ecx
], 
mm0
)

757 
	`AS2
Ğ
p¤lq
 
mm0
, 63)

759 
	`AS2
Ğ
movd
 
mm2
, 
DWORD
 
PTR
 [
—x
+4*
ecx
+4])

760 
	`AS2
Ğ
movd
 
mm1
, 
DWORD
 
PTR
 [
edi
+4*
ecx
+4])

761 
	`AS2
Ğ
psubq
 
mm2
, 
mm1
)

762 
	`AS2
Ğ
psubq
 
mm2
, 
mm0
)

763 
	`AS2
Ğ
movd
 
DWORD
 
PTR
 [
edx
+4*
ecx
+4], 
mm2
)

764 
	`AS2
Ğ
p¤lq
 
mm2
, 63)

766 
	`ASL
(1)

767 
	`AS2
Ğ
movd
 
mm0
, 
DWORD
 
PTR
 [
—x
+4*
ecx
+8])

768 
	`AS2
Ğ
movd
 
mm1
, 
DWORD
 
PTR
 [
edi
+4*
ecx
+8])

769 
	`AS2
Ğ
psubq
 
mm0
, 
mm1
)

770 
	`AS2
Ğ
psubq
 
mm0
, 
mm2
)

771 
	`AS2
Ğ
movd
 
DWORD
 
PTR
 [
edx
+4*
ecx
+8], 
mm0
)

772 
	`AS2
Ğ
p¤lq
 
mm0
, 63)

774 
	`AS2
Ğ
movd
 
mm2
, 
DWORD
 
PTR
 [
—x
+4*
ecx
+12])

775 
	`AS2
Ğ
movd
 
mm1
, 
DWORD
 
PTR
 [
edi
+4*
ecx
+12])

776 
	`AS2
Ğ
psubq
 
mm2
, 
mm1
)

777 
	`AS2
Ğ
psubq
 
mm2
, 
mm0
)

778 
	`AS2
Ğ
movd
 
DWORD
 
PTR
 [
edx
+4*
ecx
+12], 
mm2
)

779 
	`AS2
Ğ
p¤lq
 
mm2
, 63)

781 
	`AS2
Ğ
add
 
ecx
, 4)

782 
	`ASJ
Ğ
jnz
, 0, 
b
)

784 
	`ASL
(2)

785 
	`AS2
Ğ
movd
 
—x
, 
mm2
)

786 
	`AS1
Ğ
emms
)

788 
AddEpogue


789 
	}
}

792 
CRYPTOPP_FASTCALL
 
	$Ba£lše_Add
(
size_t
 
N
, 
wÜd
 *
C
, cÚ¡ wÜd *
A
, cÚ¡ wÜd *
B
)

794 
	`as£¹
 (
N
%2 == 0);

796 
	`Deş¬e2WÜds
(
u
);

797 
	`AssignWÜd
(
u
, 0);

798 
size_t
 
i
=0; i<
N
; i+=2)

800 
	`AddW™hC¬ry
(
u
, 
A
[
i
], 
B
[i]);

801 
C
[
i
] = 
	`LowWÜd
(
u
);

802 
	`AddW™hC¬ry
(
u
, 
A
[
i
+1], 
B
[i+1]);

803 
C
[
i
+1] = 
	`LowWÜd
(
u
);

805  (
	`G‘C¬ry
(
u
));

806 
	}
}

808 
CRYPTOPP_FASTCALL
 
	$Ba£lše_Sub
(
size_t
 
N
, 
wÜd
 *
C
, cÚ¡ wÜd *
A
, cÚ¡ wÜd *
B
)

810 
	`as£¹
 (
N
%2 == 0);

812 
	`Deş¬e2WÜds
(
u
);

813 
	`AssignWÜd
(
u
, 0);

814 
size_t
 
i
=0; i<
N
; i+=2)

816 
	`SubŒaùW™hBÜrow
(
u
, 
A
[
i
], 
B
[i]);

817 
C
[
i
] = 
	`LowWÜd
(
u
);

818 
	`SubŒaùW™hBÜrow
(
u
, 
A
[
i
+1], 
B
[i+1]);

819 
C
[
i
+1] = 
	`LowWÜd
(
u
);

821  (
	`G‘BÜrow
(
u
));

822 
	}
}

825 
wÜd
 
	$Lš—rMuÉly
(
wÜd
 *
C
, cÚ¡ wÜd *
A
, wÜd 
B
, 
size_t
 
N
)

827 
wÜd
 
ÿ¼y
=0;

828 
i
=0; i<
N
; i++)

830 
	`Deş¬e2WÜds
(
p
);

831 
	`MuÉlyWÜds
(
p
, 
A
[
i
], 
B
);

832 
	`Acc2WÜdsBy1
(
p
, 
ÿ¼y
);

833 
C
[
i
] = 
	`LowWÜd
(
p
);

834 
ÿ¼y
 = 
	`HighWÜd
(
p
);

836  
ÿ¼y
;

837 
	}
}

839 #iâdeà
CRYPTOPP_DOXYGEN_PROCESSING


841 
	#Mul_2
 \

842 
	`Mul_Begš
(2) \

843 
	`Mul_SaveAcc
(0, 0, 1è
	`Mul_Acc
(1, 0) \

844 
	`Mul_End
(1, 1)

	)

846 
	#Mul_4
 \

847 
	`Mul_Begš
(4) \

848 
	`Mul_SaveAcc
(0, 0, 1è
	`Mul_Acc
(1, 0) \

849 
	`Mul_SaveAcc
(1, 0, 2è
	`Mul_Acc
(1, 1) Mul_Acc(2, 0) \

850 
	`Mul_SaveAcc
(2, 0, 3è
	`Mul_Acc
(1, 2) Mul_Acc(2, 1) Mul_Acc(3, 0) \

851 
	`Mul_SaveAcc
(3, 1, 3è
	`Mul_Acc
(2, 2) Mul_Acc(3, 1) \

852 
	`Mul_SaveAcc
(4, 2, 3è
	`Mul_Acc
(3, 2) \

853 
	`Mul_End
(5, 3)

	)

855 
	#Mul_8
 \

856 
	`Mul_Begš
(8) \

857 
	`Mul_SaveAcc
(0, 0, 1è
	`Mul_Acc
(1, 0) \

858 
	`Mul_SaveAcc
(1, 0, 2è
	`Mul_Acc
(1, 1) Mul_Acc(2, 0) \

859 
	`Mul_SaveAcc
(2, 0, 3è
	`Mul_Acc
(1, 2) Mul_Acc(2, 1) Mul_Acc(3, 0) \

860 
	`Mul_SaveAcc
(3, 0, 4è
	`Mul_Acc
(1, 3) Mul_Acc(2, 2) Mul_Acc(3, 1) Mul_Acc(4, 0) \

861 
	`Mul_SaveAcc
(4, 0, 5è
	`Mul_Acc
(1, 4) Mul_Acc(2, 3) Mul_Acc(3, 2) Mul_Acc(4, 1) Mul_Acc(5, 0) \

862 
	`Mul_SaveAcc
(5, 0, 6è
	`Mul_Acc
(1, 5) Mul_Acc(2, 4) Mul_Acc(3, 3) Mul_Acc(4, 2) Mul_Acc(5, 1) Mul_Acc(6, 0) \

863 
	`Mul_SaveAcc
(6, 0, 7è
	`Mul_Acc
(1, 6) Mul_Acc(2, 5) Mul_Acc(3, 4) Mul_Acc(4, 3) Mul_Acc(5, 2) Mul_Acc(6, 1) Mul_Acc(7, 0) \

864 
	`Mul_SaveAcc
(7, 1, 7è
	`Mul_Acc
(2, 6) Mul_Acc(3, 5) Mul_Acc(4, 4) Mul_Acc(5, 3) Mul_Acc(6, 2) Mul_Acc(7, 1) \

865 
	`Mul_SaveAcc
(8, 2, 7è
	`Mul_Acc
(3, 6) Mul_Acc(4, 5) Mul_Acc(5, 4) Mul_Acc(6, 3) Mul_Acc(7, 2) \

866 
	`Mul_SaveAcc
(9, 3, 7è
	`Mul_Acc
(4, 6) Mul_Acc(5, 5) Mul_Acc(6, 4) Mul_Acc(7, 3) \

867 
	`Mul_SaveAcc
(10, 4, 7è
	`Mul_Acc
(5, 6) Mul_Acc(6, 5) Mul_Acc(7, 4) \

868 
	`Mul_SaveAcc
(11, 5, 7è
	`Mul_Acc
(6, 6) Mul_Acc(7, 5) \

869 
	`Mul_SaveAcc
(12, 6, 7è
	`Mul_Acc
(7, 6) \

870 
	`Mul_End
(13, 7)

	)

872 
	#Mul_16
 \

873 
	`Mul_Begš
(16) \

874 
	`Mul_SaveAcc
(0, 0, 1è
	`Mul_Acc
(1, 0) \

875 
	`Mul_SaveAcc
(1, 0, 2è
	`Mul_Acc
(1, 1) Mul_Acc(2, 0) \

876 
	`Mul_SaveAcc
(2, 0, 3è
	`Mul_Acc
(1, 2) Mul_Acc(2, 1) Mul_Acc(3, 0) \

877 
	`Mul_SaveAcc
(3, 0, 4è
	`Mul_Acc
(1, 3) Mul_Acc(2, 2) Mul_Acc(3, 1) Mul_Acc(4, 0) \

878 
	`Mul_SaveAcc
(4, 0, 5è
	`Mul_Acc
(1, 4) Mul_Acc(2, 3) Mul_Acc(3, 2) Mul_Acc(4, 1) Mul_Acc(5, 0) \

879 
	`Mul_SaveAcc
(5, 0, 6è
	`Mul_Acc
(1, 5) Mul_Acc(2, 4) Mul_Acc(3, 3) Mul_Acc(4, 2) Mul_Acc(5, 1) Mul_Acc(6, 0) \

880 
	`Mul_SaveAcc
(6, 0, 7è
	`Mul_Acc
(1, 6) Mul_Acc(2, 5) Mul_Acc(3, 4) Mul_Acc(4, 3) Mul_Acc(5, 2) Mul_Acc(6, 1) Mul_Acc(7, 0) \

881 
	`Mul_SaveAcc
(7, 0, 8è
	`Mul_Acc
(1, 7) Mul_Acc(2, 6) Mul_Acc(3, 5) Mul_Acc(4, 4) Mul_Acc(5, 3) Mul_Acc(6, 2) Mul_Acc(7, 1) Mul_Acc(8, 0) \

882 
	`Mul_SaveAcc
(8, 0, 9è
	`Mul_Acc
(1, 8) Mul_Acc(2, 7) Mul_Acc(3, 6) Mul_Acc(4, 5) Mul_Acc(5, 4) Mul_Acc(6, 3) Mul_Acc(7, 2) Mul_Acc(8, 1) Mul_Acc(9, 0) \

883 
	`Mul_SaveAcc
(9, 0, 10è
	`Mul_Acc
(1, 9) Mul_Acc(2, 8) Mul_Acc(3, 7) Mul_Acc(4, 6) Mul_Acc(5, 5) Mul_Acc(6, 4) Mul_Acc(7, 3) Mul_Acc(8, 2) Mul_Acc(9, 1) Mul_Acc(10, 0) \

884 
	`Mul_SaveAcc
(10, 0, 11è
	`Mul_Acc
(1, 10) Mul_Acc(2, 9) Mul_Acc(3, 8) Mul_Acc(4, 7) Mul_Acc(5, 6) Mul_Acc(6, 5) Mul_Acc(7, 4) Mul_Acc(8, 3) Mul_Acc(9, 2) Mul_Acc(10, 1) Mul_Acc(11, 0) \

885 
	`Mul_SaveAcc
(11, 0, 12è
	`Mul_Acc
(1, 11) Mul_Acc(2, 10) Mul_Acc(3, 9) Mul_Acc(4, 8) Mul_Acc(5, 7) Mul_Acc(6, 6) Mul_Acc(7, 5) Mul_Acc(8, 4) Mul_Acc(9, 3) Mul_Acc(10, 2) Mul_Acc(11, 1) Mul_Acc(12, 0) \

886 
	`Mul_SaveAcc
(12, 0, 13è
	`Mul_Acc
(1, 12) Mul_Acc(2, 11) Mul_Acc(3, 10) Mul_Acc(4, 9) Mul_Acc(5, 8) Mul_Acc(6, 7) Mul_Acc(7, 6) Mul_Acc(8, 5) Mul_Acc(9, 4) Mul_Acc(10, 3) Mul_Acc(11, 2) Mul_Acc(12, 1) Mul_Acc(13, 0) \

887 
	`Mul_SaveAcc
(13, 0, 14è
	`Mul_Acc
(1, 13) Mul_Acc(2, 12) Mul_Acc(3, 11) Mul_Acc(4, 10) Mul_Acc(5, 9) Mul_Acc(6, 8) Mul_Acc(7, 7) Mul_Acc(8, 6) Mul_Acc(9, 5) Mul_Acc(10, 4) Mul_Acc(11, 3) Mul_Acc(12, 2) Mul_Acc(13, 1) Mul_Acc(14, 0) \

888 
	`Mul_SaveAcc
(14, 0, 15è
	`Mul_Acc
(1, 14) Mul_Acc(2, 13) Mul_Acc(3, 12) Mul_Acc(4, 11) Mul_Acc(5, 10) Mul_Acc(6, 9) Mul_Acc(7, 8) Mul_Acc(8, 7) Mul_Acc(9, 6) Mul_Acc(10, 5) Mul_Acc(11, 4) Mul_Acc(12, 3) Mul_Acc(13, 2) Mul_Acc(14, 1) Mul_Acc(15, 0) \

889 
	`Mul_SaveAcc
(15, 1, 15è
	`Mul_Acc
(2, 14) Mul_Acc(3, 13) Mul_Acc(4, 12) Mul_Acc(5, 11) Mul_Acc(6, 10) Mul_Acc(7, 9) Mul_Acc(8, 8) Mul_Acc(9, 7) Mul_Acc(10, 6) Mul_Acc(11, 5) Mul_Acc(12, 4) Mul_Acc(13, 3) Mul_Acc(14, 2) Mul_Acc(15, 1) \

890 
	`Mul_SaveAcc
(16, 2, 15è
	`Mul_Acc
(3, 14) Mul_Acc(4, 13) Mul_Acc(5, 12) Mul_Acc(6, 11) Mul_Acc(7, 10) Mul_Acc(8, 9) Mul_Acc(9, 8) Mul_Acc(10, 7) Mul_Acc(11, 6) Mul_Acc(12, 5) Mul_Acc(13, 4) Mul_Acc(14, 3) Mul_Acc(15, 2) \

891 
	`Mul_SaveAcc
(17, 3, 15è
	`Mul_Acc
(4, 14) Mul_Acc(5, 13) Mul_Acc(6, 12) Mul_Acc(7, 11) Mul_Acc(8, 10) Mul_Acc(9, 9) Mul_Acc(10, 8) Mul_Acc(11, 7) Mul_Acc(12, 6) Mul_Acc(13, 5) Mul_Acc(14, 4) Mul_Acc(15, 3) \

892 
	`Mul_SaveAcc
(18, 4, 15è
	`Mul_Acc
(5, 14) Mul_Acc(6, 13) Mul_Acc(7, 12) Mul_Acc(8, 11) Mul_Acc(9, 10) Mul_Acc(10, 9) Mul_Acc(11, 8) Mul_Acc(12, 7) Mul_Acc(13, 6) Mul_Acc(14, 5) Mul_Acc(15, 4) \

893 
	`Mul_SaveAcc
(19, 5, 15è
	`Mul_Acc
(6, 14) Mul_Acc(7, 13) Mul_Acc(8, 12) Mul_Acc(9, 11) Mul_Acc(10, 10) Mul_Acc(11, 9) Mul_Acc(12, 8) Mul_Acc(13, 7) Mul_Acc(14, 6) Mul_Acc(15, 5) \

894 
	`Mul_SaveAcc
(20, 6, 15è
	`Mul_Acc
(7, 14) Mul_Acc(8, 13) Mul_Acc(9, 12) Mul_Acc(10, 11) Mul_Acc(11, 10) Mul_Acc(12, 9) Mul_Acc(13, 8) Mul_Acc(14, 7) Mul_Acc(15, 6) \

895 
	`Mul_SaveAcc
(21, 7, 15è
	`Mul_Acc
(8, 14) Mul_Acc(9, 13) Mul_Acc(10, 12) Mul_Acc(11, 11) Mul_Acc(12, 10) Mul_Acc(13, 9) Mul_Acc(14, 8) Mul_Acc(15, 7) \

896 
	`Mul_SaveAcc
(22, 8, 15è
	`Mul_Acc
(9, 14) Mul_Acc(10, 13) Mul_Acc(11, 12) Mul_Acc(12, 11) Mul_Acc(13, 10) Mul_Acc(14, 9) Mul_Acc(15, 8) \

897 
	`Mul_SaveAcc
(23, 9, 15è
	`Mul_Acc
(10, 14) Mul_Acc(11, 13) Mul_Acc(12, 12) Mul_Acc(13, 11) Mul_Acc(14, 10) Mul_Acc(15, 9) \

898 
	`Mul_SaveAcc
(24, 10, 15è
	`Mul_Acc
(11, 14) Mul_Acc(12, 13) Mul_Acc(13, 12) Mul_Acc(14, 11) Mul_Acc(15, 10) \

899 
	`Mul_SaveAcc
(25, 11, 15è
	`Mul_Acc
(12, 14) Mul_Acc(13, 13) Mul_Acc(14, 12) Mul_Acc(15, 11) \

900 
	`Mul_SaveAcc
(26, 12, 15è
	`Mul_Acc
(13, 14) Mul_Acc(14, 13) Mul_Acc(15, 12) \

901 
	`Mul_SaveAcc
(27, 13, 15è
	`Mul_Acc
(14, 14) Mul_Acc(15, 13) \

902 
	`Mul_SaveAcc
(28, 14, 15è
	`Mul_Acc
(15, 14) \

903 
	`Mul_End
(29, 15)

	)

905 
	#Squ_2
 \

906 
	`Squ_Begš
(2) \

907 
	`Squ_End
(2)

	)

909 
	#Squ_4
 \

910 
	`Squ_Begš
(4) \

911 
	`Squ_SaveAcc
(1, 0, 2è
	`Squ_DŸg
(1) \

912 
	`Squ_SaveAcc
(2, 0, 3è
	`Squ_Acc
(1, 2è
Squ_NÚDŸg
 \

913 
	`Squ_SaveAcc
(3, 1, 3è
	`Squ_DŸg
(2) \

914 
	`Squ_SaveAcc
(4, 2, 3è
Squ_NÚDŸg
 \

915 
	`Squ_End
(4)

	)

917 
	#Squ_8
 \

918 
	`Squ_Begš
(8) \

919 
	`Squ_SaveAcc
(1, 0, 2è
	`Squ_DŸg
(1) \

920 
	`Squ_SaveAcc
(2, 0, 3è
	`Squ_Acc
(1, 2è
Squ_NÚDŸg
 \

921 
	`Squ_SaveAcc
(3, 0, 4è
	`Squ_Acc
(1, 3è
	`Squ_DŸg
(2) \

922 
	`Squ_SaveAcc
(4, 0, 5è
	`Squ_Acc
(1, 4èSqu_Acc(2, 3è
Squ_NÚDŸg
 \

923 
	`Squ_SaveAcc
(5, 0, 6è
	`Squ_Acc
(1, 5èSqu_Acc(2, 4è
	`Squ_DŸg
(3) \

924 
	`Squ_SaveAcc
(6, 0, 7è
	`Squ_Acc
(1, 6èSqu_Acc(2, 5èSqu_Acc(3, 4è
Squ_NÚDŸg
 \

925 
	`Squ_SaveAcc
(7, 1, 7è
	`Squ_Acc
(2, 6èSqu_Acc(3, 5è
	`Squ_DŸg
(4) \

926 
	`Squ_SaveAcc
(8, 2, 7è
	`Squ_Acc
(3, 6èSqu_Acc(4, 5è
Squ_NÚDŸg
 \

927 
	`Squ_SaveAcc
(9, 3, 7è
	`Squ_Acc
(4, 6è
	`Squ_DŸg
(5) \

928 
	`Squ_SaveAcc
(10, 4, 7è
	`Squ_Acc
(5, 6è
Squ_NÚDŸg
 \

929 
	`Squ_SaveAcc
(11, 5, 7è
	`Squ_DŸg
(6) \

930 
	`Squ_SaveAcc
(12, 6, 7è
Squ_NÚDŸg
 \

931 
	`Squ_End
(8)

	)

933 
	#Squ_16
 \

934 
	`Squ_Begš
(16) \

935 
	`Squ_SaveAcc
(1, 0, 2è
	`Squ_DŸg
(1) \

936 
	`Squ_SaveAcc
(2, 0, 3è
	`Squ_Acc
(1, 2è
Squ_NÚDŸg
 \

937 
	`Squ_SaveAcc
(3, 0, 4è
	`Squ_Acc
(1, 3è
	`Squ_DŸg
(2) \

938 
	`Squ_SaveAcc
(4, 0, 5è
	`Squ_Acc
(1, 4èSqu_Acc(2, 3è
Squ_NÚDŸg
 \

939 
	`Squ_SaveAcc
(5, 0, 6è
	`Squ_Acc
(1, 5èSqu_Acc(2, 4è
	`Squ_DŸg
(3) \

940 
	`Squ_SaveAcc
(6, 0, 7è
	`Squ_Acc
(1, 6èSqu_Acc(2, 5èSqu_Acc(3, 4è
Squ_NÚDŸg
 \

941 
	`Squ_SaveAcc
(7, 0, 8è
	`Squ_Acc
(1, 7èSqu_Acc(2, 6èSqu_Acc(3, 5è
	`Squ_DŸg
(4) \

942 
	`Squ_SaveAcc
(8, 0, 9è
	`Squ_Acc
(1, 8èSqu_Acc(2, 7èSqu_Acc(3, 6èSqu_Acc(4, 5è
Squ_NÚDŸg
 \

943 
	`Squ_SaveAcc
(9, 0, 10è
	`Squ_Acc
(1, 9èSqu_Acc(2, 8èSqu_Acc(3, 7èSqu_Acc(4, 6è
	`Squ_DŸg
(5) \

944 
	`Squ_SaveAcc
(10, 0, 11è
	`Squ_Acc
(1, 10èSqu_Acc(2, 9èSqu_Acc(3, 8èSqu_Acc(4, 7èSqu_Acc(5, 6è
Squ_NÚDŸg
 \

945 
	`Squ_SaveAcc
(11, 0, 12è
	`Squ_Acc
(1, 11èSqu_Acc(2, 10èSqu_Acc(3, 9èSqu_Acc(4, 8èSqu_Acc(5, 7è
	`Squ_DŸg
(6) \

946 
	`Squ_SaveAcc
(12, 0, 13è
	`Squ_Acc
(1, 12èSqu_Acc(2, 11èSqu_Acc(3, 10èSqu_Acc(4, 9èSqu_Acc(5, 8èSqu_Acc(6, 7è
Squ_NÚDŸg
 \

947 
	`Squ_SaveAcc
(13, 0, 14è
	`Squ_Acc
(1, 13èSqu_Acc(2, 12èSqu_Acc(3, 11èSqu_Acc(4, 10èSqu_Acc(5, 9èSqu_Acc(6, 8è
	`Squ_DŸg
(7) \

948 
	`Squ_SaveAcc
(14, 0, 15è
	`Squ_Acc
(1, 14èSqu_Acc(2, 13èSqu_Acc(3, 12èSqu_Acc(4, 11èSqu_Acc(5, 10èSqu_Acc(6, 9èSqu_Acc(7, 8è
Squ_NÚDŸg
 \

949 
	`Squ_SaveAcc
(15, 1, 15è
	`Squ_Acc
(2, 14èSqu_Acc(3, 13èSqu_Acc(4, 12èSqu_Acc(5, 11èSqu_Acc(6, 10èSqu_Acc(7, 9è
	`Squ_DŸg
(8) \

950 
	`Squ_SaveAcc
(16, 2, 15è
	`Squ_Acc
(3, 14èSqu_Acc(4, 13èSqu_Acc(5, 12èSqu_Acc(6, 11èSqu_Acc(7, 10èSqu_Acc(8, 9è
Squ_NÚDŸg
 \

951 
	`Squ_SaveAcc
(17, 3, 15è
	`Squ_Acc
(4, 14èSqu_Acc(5, 13èSqu_Acc(6, 12èSqu_Acc(7, 11èSqu_Acc(8, 10è
	`Squ_DŸg
(9) \

952 
	`Squ_SaveAcc
(18, 4, 15è
	`Squ_Acc
(5, 14èSqu_Acc(6, 13èSqu_Acc(7, 12èSqu_Acc(8, 11èSqu_Acc(9, 10è
Squ_NÚDŸg
 \

953 
	`Squ_SaveAcc
(19, 5, 15è
	`Squ_Acc
(6, 14èSqu_Acc(7, 13èSqu_Acc(8, 12èSqu_Acc(9, 11è
	`Squ_DŸg
(10) \

954 
	`Squ_SaveAcc
(20, 6, 15è
	`Squ_Acc
(7, 14èSqu_Acc(8, 13èSqu_Acc(9, 12èSqu_Acc(10, 11è
Squ_NÚDŸg
 \

955 
	`Squ_SaveAcc
(21, 7, 15è
	`Squ_Acc
(8, 14èSqu_Acc(9, 13èSqu_Acc(10, 12è
	`Squ_DŸg
(11) \

956 
	`Squ_SaveAcc
(22, 8, 15è
	`Squ_Acc
(9, 14èSqu_Acc(10, 13èSqu_Acc(11, 12è
Squ_NÚDŸg
 \

957 
	`Squ_SaveAcc
(23, 9, 15è
	`Squ_Acc
(10, 14èSqu_Acc(11, 13è
	`Squ_DŸg
(12) \

958 
	`Squ_SaveAcc
(24, 10, 15è
	`Squ_Acc
(11, 14èSqu_Acc(12, 13è
Squ_NÚDŸg
 \

959 
	`Squ_SaveAcc
(25, 11, 15è
	`Squ_Acc
(12, 14è
	`Squ_DŸg
(13) \

960 
	`Squ_SaveAcc
(26, 12, 15è
	`Squ_Acc
(13, 14è
Squ_NÚDŸg
 \

961 
	`Squ_SaveAcc
(27, 13, 15è
	`Squ_DŸg
(14) \

962 
	`Squ_SaveAcc
(28, 14, 15è
Squ_NÚDŸg
 \

963 
	`Squ_End
(16)

	)

965 
	#BÙ_2
 \

966 
	`Mul_Begš
(2) \

967 
	`BÙ_SaveAcc
(0, 0, 1è
	`BÙ_Acc
(1, 0) \

968 
	`BÙ_End
(2)

	)

970 
	#BÙ_4
 \

971 
	`Mul_Begš
(4) \

972 
	`Mul_SaveAcc
(0, 0, 1è
	`Mul_Acc
(1, 0) \

973 
	`Mul_SaveAcc
(1, 2, 0è
	`Mul_Acc
(1, 1) Mul_Acc(0, 2) \

974 
	`BÙ_SaveAcc
(2, 0, 3è
	`BÙ_Acc
(1, 2) Bot_Acc(2, 1) Bot_Acc(3, 0) \

975 
	`BÙ_End
(4)

	)

977 
	#BÙ_8
 \

978 
	`Mul_Begš
(8) \

979 
	`Mul_SaveAcc
(0, 0, 1è
	`Mul_Acc
(1, 0) \

980 
	`Mul_SaveAcc
(1, 0, 2è
	`Mul_Acc
(1, 1) Mul_Acc(2, 0) \

981 
	`Mul_SaveAcc
(2, 0, 3è
	`Mul_Acc
(1, 2) Mul_Acc(2, 1) Mul_Acc(3, 0) \

982 
	`Mul_SaveAcc
(3, 0, 4è
	`Mul_Acc
(1, 3) Mul_Acc(2, 2) Mul_Acc(3, 1) Mul_Acc(4, 0) \

983 
	`Mul_SaveAcc
(4, 0, 5è
	`Mul_Acc
(1, 4) Mul_Acc(2, 3) Mul_Acc(3, 2) Mul_Acc(4, 1) Mul_Acc(5, 0) \

984 
	`Mul_SaveAcc
(5, 0, 6è
	`Mul_Acc
(1, 5) Mul_Acc(2, 4) Mul_Acc(3, 3) Mul_Acc(4, 2) Mul_Acc(5, 1) Mul_Acc(6, 0) \

985 
	`BÙ_SaveAcc
(6, 0, 7è
	`BÙ_Acc
(1, 6) Bot_Acc(2, 5) Bot_Acc(3, 4) Bot_Acc(4, 3) Bot_Acc(5, 2) Bot_Acc(6, 1) Bot_Acc(7, 0) \

986 
	`BÙ_End
(8)

	)

988 
	#BÙ_16
 \

989 
	`Mul_Begš
(16) \

990 
	`Mul_SaveAcc
(0, 0, 1è
	`Mul_Acc
(1, 0) \

991 
	`Mul_SaveAcc
(1, 0, 2è
	`Mul_Acc
(1, 1) Mul_Acc(2, 0) \

992 
	`Mul_SaveAcc
(2, 0, 3è
	`Mul_Acc
(1, 2) Mul_Acc(2, 1) Mul_Acc(3, 0) \

993 
	`Mul_SaveAcc
(3, 0, 4è
	`Mul_Acc
(1, 3) Mul_Acc(2, 2) Mul_Acc(3, 1) Mul_Acc(4, 0) \

994 
	`Mul_SaveAcc
(4, 0, 5è
	`Mul_Acc
(1, 4) Mul_Acc(2, 3) Mul_Acc(3, 2) Mul_Acc(4, 1) Mul_Acc(5, 0) \

995 
	`Mul_SaveAcc
(5, 0, 6è
	`Mul_Acc
(1, 5) Mul_Acc(2, 4) Mul_Acc(3, 3) Mul_Acc(4, 2) Mul_Acc(5, 1) Mul_Acc(6, 0) \

996 
	`Mul_SaveAcc
(6, 0, 7è
	`Mul_Acc
(1, 6) Mul_Acc(2, 5) Mul_Acc(3, 4) Mul_Acc(4, 3) Mul_Acc(5, 2) Mul_Acc(6, 1) Mul_Acc(7, 0) \

997 
	`Mul_SaveAcc
(7, 0, 8è
	`Mul_Acc
(1, 7) Mul_Acc(2, 6) Mul_Acc(3, 5) Mul_Acc(4, 4) Mul_Acc(5, 3) Mul_Acc(6, 2) Mul_Acc(7, 1) Mul_Acc(8, 0) \

998 
	`Mul_SaveAcc
(8, 0, 9è
	`Mul_Acc
(1, 8) Mul_Acc(2, 7) Mul_Acc(3, 6) Mul_Acc(4, 5) Mul_Acc(5, 4) Mul_Acc(6, 3) Mul_Acc(7, 2) Mul_Acc(8, 1) Mul_Acc(9, 0) \

999 
	`Mul_SaveAcc
(9, 0, 10è
	`Mul_Acc
(1, 9) Mul_Acc(2, 8) Mul_Acc(3, 7) Mul_Acc(4, 6) Mul_Acc(5, 5) Mul_Acc(6, 4) Mul_Acc(7, 3) Mul_Acc(8, 2) Mul_Acc(9, 1) Mul_Acc(10, 0) \

1000 
	`Mul_SaveAcc
(10, 0, 11è
	`Mul_Acc
(1, 10) Mul_Acc(2, 9) Mul_Acc(3, 8) Mul_Acc(4, 7) Mul_Acc(5, 6) Mul_Acc(6, 5) Mul_Acc(7, 4) Mul_Acc(8, 3) Mul_Acc(9, 2) Mul_Acc(10, 1) Mul_Acc(11, 0) \

1001 
	`Mul_SaveAcc
(11, 0, 12è
	`Mul_Acc
(1, 11) Mul_Acc(2, 10) Mul_Acc(3, 9) Mul_Acc(4, 8) Mul_Acc(5, 7) Mul_Acc(6, 6) Mul_Acc(7, 5) Mul_Acc(8, 4) Mul_Acc(9, 3) Mul_Acc(10, 2) Mul_Acc(11, 1) Mul_Acc(12, 0) \

1002 
	`Mul_SaveAcc
(12, 0, 13è
	`Mul_Acc
(1, 12) Mul_Acc(2, 11) Mul_Acc(3, 10) Mul_Acc(4, 9) Mul_Acc(5, 8) Mul_Acc(6, 7) Mul_Acc(7, 6) Mul_Acc(8, 5) Mul_Acc(9, 4) Mul_Acc(10, 3) Mul_Acc(11, 2) Mul_Acc(12, 1) Mul_Acc(13, 0) \

1003 
	`Mul_SaveAcc
(13, 0, 14è
	`Mul_Acc
(1, 13) Mul_Acc(2, 12) Mul_Acc(3, 11) Mul_Acc(4, 10) Mul_Acc(5, 9) Mul_Acc(6, 8) Mul_Acc(7, 7) Mul_Acc(8, 6) Mul_Acc(9, 5) Mul_Acc(10, 4) Mul_Acc(11, 3) Mul_Acc(12, 2) Mul_Acc(13, 1) Mul_Acc(14, 0) \

1004 
	`BÙ_SaveAcc
(14, 0, 15è
	`BÙ_Acc
(1, 14) Bot_Acc(2, 13) Bot_Acc(3, 12) Bot_Acc(4, 11) Bot_Acc(5, 10) Bot_Acc(6, 9) Bot_Acc(7, 8) Bot_Acc(8, 7) Bot_Acc(9, 6) Bot_Acc(10, 5) Bot_Acc(11, 4) Bot_Acc(12, 3) Bot_Acc(13, 2) Bot_Acc(14, 1) Bot_Acc(15, 0) \

1005 
	`BÙ_End
(16)

	)

1010 
	#Mul_Begš
(
n
) \

1011 
	`Deş¬e2WÜds
(
p
) \

1012 
	`Deş¬e2WÜds
(
c
) \

1013 
	`Deş¬e2WÜds
(
d
) \

1014 
	`MuÉlyWÜds
(
p
, 
A
[0], 
B
[0]) \

1015 
	`AssignWÜd
(
c
, 
	`LowWÜd
(
p
)) \

1016 
	`AssignWÜd
(
d
, 
	`HighWÜd
(
p
))

	)

1018 
	#Mul_Acc
(
i
, 
j
) \

1019 
	`MuÉlyWÜds
(
p
, 
A
[
i
], 
B
[
j
]) \

1020 
	`Acc2WÜdsBy1
(
c
, 
	`LowWÜd
(
p
)) \

1021 
	`Acc2WÜdsBy1
(
d
, 
	`HighWÜd
(
p
))

	)

1023 
	#Mul_SaveAcc
(
k
, 
i
, 
j
) \

1024 
R
[
k
] = 
	`LowWÜd
(
c
); \

1025 
	`Add2WÜdsBy1
(
c
, 
d
, 
	`HighWÜd
(c)) \

1026 
	`MuÉlyWÜds
(
p
, 
A
[
i
], 
B
[
j
]) \

1027 
	`AssignWÜd
(
d
, 
	`HighWÜd
(
p
)) \

1028 
	`Acc2WÜdsBy1
(
c
, 
	`LowWÜd
(
p
))

	)

1030 
	#Mul_End
(
n
) \

1031 
R
[2*
n
-3] = 
	`LowWÜd
(
c
); \

1032 
	`Acc2WÜdsBy1
(
d
, 
	`HighWÜd
(
c
)) \

1033 
	`MuÉlyWÜds
(
p
, 
A
[
n
-1], 
B
[n-1])\

1034 
	`Acc2WÜdsBy2
(
d
, 
p
) \

1035 
R
[2*
n
-2] = 
	`LowWÜd
(
d
); \

1036 
R
[2*
n
-1] = 
	`HighWÜd
(
d
);

	)

1038 
	#BÙ_SaveAcc
(
k
, 
i
, 
j
) \

1039 
R
[
k
] = 
	`LowWÜd
(
c
); \

1040 
wÜd
 
e
 = 
	`LowWÜd
(
d
è+ 
	`HighWÜd
(
c
); \

1041 
e
 +ğ
A
[
i
] * 
B
[
j
];

	)

1043 
	#BÙ_Acc
(
i
, 
j
) \

1044 
e
 +ğ
A
[
i
] * 
B
[
j
];

	)

1046 
	#BÙ_End
(
n
) \

1047 
R
[
n
-1] = 
e
;

	)

1049 
	#Mul_Begš
(
n
) \

1050 
	`Deş¬e2WÜds
(
p
) \

1051 
wÜd
 
c
; \

1052 
	`Deş¬e2WÜds
(
d
) \

1053 
	`MuÉlyWÜds
(
p
, 
A
[0], 
B
[0]) \

1054 
c
 = 
	`LowWÜd
(
p
); \

1055 
	`AssignWÜd
(
d
, 
	`HighWÜd
(
p
))

	)

1057 
	#Mul_Acc
(
i
, 
j
) \

1058 
	`MulAcc
(
c
, 
d
, 
A
[
i
], 
B
[
j
])

	)

1060 
	#Mul_SaveAcc
(
k
, 
i
, 
j
) \

1061 
R
[
k
] = 
c
; \

1062 
c
 = 
	`LowWÜd
(
d
); \

1063 
	`AssignWÜd
(
d
, 
	`HighWÜd
(d)) \

1064 
	`MulAcc
(
c
, 
d
, 
A
[
i
], 
B
[
j
])

	)

1066 
	#Mul_End
(
k
, 
i
) \

1067 
R
[
k
] = 
c
; \

1068 
	`MuÉlyWÜds
(
p
, 
A
[
i
], 
B
[i]) \

1069 
	`Acc2WÜdsBy2
(
p
, 
d
) \

1070 
R
[
k
+1] = 
	`LowWÜd
(
p
); \

1071 
R
[
k
+2] = 
	`HighWÜd
(
p
);

	)

1073 
	#BÙ_SaveAcc
(
k
, 
i
, 
j
) \

1074 
R
[
k
] = 
c
; \

1075 
c
 = 
	`LowWÜd
(
d
); \

1076 
c
 +ğ
A
[
i
] * 
B
[
j
];

	)

1078 
	#BÙ_Acc
(
i
, 
j
) \

1079 
c
 +ğ
A
[
i
] * 
B
[
j
];

	)

1081 
	#BÙ_End
(
n
) \

1082 
R
[
n
-1] = 
c
;

	)

1085 
	#Squ_Begš
(
n
) \

1086 
	`Deş¬e2WÜds
(
p
) \

1087 
wÜd
 
c
; \

1088 
	`Deş¬e2WÜds
(
d
) \

1089 
	`Deş¬e2WÜds
(
e
) \

1090 
	`MuÉlyWÜds
(
p
, 
A
[0], A[0]) \

1091 
R
[0] = 
	`LowWÜd
(
p
); \

1092 
	`AssignWÜd
(
e
, 
	`HighWÜd
(
p
)) \

1093 
	`MuÉlyWÜds
(
p
, 
A
[0], A[1]) \

1094 
c
 = 
	`LowWÜd
(
p
); \

1095 
	`AssignWÜd
(
d
, 
	`HighWÜd
(
p
)) \

1096 
Squ_NÚDŸg
 \

1097 

	)

1098 
	#Squ_NÚDŸg
 \

1099 
	`DoubË3WÜds
(
c
, 
d
)

	)

1101 
	#Squ_SaveAcc
(
k
, 
i
, 
j
) \

1102 
	`Acc3WÜdsBy2
(
c
, 
d
, 
e
) \

1103 
R
[
k
] = 
c
; \

1104 
	`MuÉlyWÜds
(
p
, 
A
[
i
], A[
j
]) \

1105 
c
 = 
	`LowWÜd
(
p
); \

1106 
	`AssignWÜd
(
d
, 
	`HighWÜd
(
p
)) \

1107 

	)

1108 
	#Squ_Acc
(
i
, 
j
) \

1109 
	`MulAcc
(
c
, 
d
, 
A
[
i
], A[
j
])

	)

1111 
	#Squ_DŸg
(
i
) \

1112 
Squ_NÚDŸg
 \

1113 
	`MulAcc
(
c
, 
d
, 
A
[
i
], A[i])

	)

1115 
	#Squ_End
(
n
) \

1116 
	`Acc3WÜdsBy2
(
c
, 
d
, 
e
) \

1117 
R
[2*
n
-3] = 
c
; \

1118 
	`MuÉlyWÜds
(
p
, 
A
[
n
-1], A[n-1])\

1119 
	`Acc2WÜdsBy2
(
p
, 
e
) \

1120 
R
[2*
n
-2] = 
	`LowWÜd
(
p
); \

1121 
R
[2*
n
-1] = 
	`HighWÜd
(
p
);

	)

1123 
	$Ba£lše_MuÉly2
(
wÜd
 *
R
, cÚ¡ wÜd *
A
, cÚ¡ wÜd *
B
)

1125 
Mul_2


1126 
	}
}

1128 
	$Ba£lše_MuÉly4
(
wÜd
 *
R
, cÚ¡ wÜd *
A
, cÚ¡ wÜd *
B
)

1130 
Mul_4


1131 
	}
}

1133 
	$Ba£lše_MuÉly8
(
wÜd
 *
R
, cÚ¡ wÜd *
A
, cÚ¡ wÜd *
B
)

1135 
Mul_8


1136 
	}
}

1138 
	$Ba£lše_Squ¬e2
(
wÜd
 *
R
, cÚ¡ wÜd *
A
)

1140 
Squ_2


1141 
	}
}

1143 
	$Ba£lše_Squ¬e4
(
wÜd
 *
R
, cÚ¡ wÜd *
A
)

1145 
Squ_4


1146 
	}
}

1148 
	$Ba£lše_Squ¬e8
(
wÜd
 *
R
, cÚ¡ wÜd *
A
)

1150 
Squ_8


1151 
	}
}

1153 
	$Ba£lše_MuÉlyBÙtom2
(
wÜd
 *
R
, cÚ¡ wÜd *
A
, cÚ¡ wÜd *
B
)

1155 
BÙ_2


1156 
	}
}

1158 
	$Ba£lše_MuÉlyBÙtom4
(
wÜd
 *
R
, cÚ¡ wÜd *
A
, cÚ¡ wÜd *
B
)

1160 
BÙ_4


1161 
	}
}

1163 
	$Ba£lše_MuÉlyBÙtom8
(
wÜd
 *
R
, cÚ¡ wÜd *
A
, cÚ¡ wÜd *
B
)

1165 
BÙ_8


1166 
	}
}

1168 
	#Tİ_Begš
(
n
) \

1169 
	`Deş¬e2WÜds
(
p
) \

1170 
wÜd
 
c
; \

1171 
	`Deş¬e2WÜds
(
d
) \

1172 
	`MuÉlyWÜds
(
p
, 
A
[0], 
B
[
n
-2]);\

1173 
	`AssignWÜd
(
d
, 
	`HighWÜd
(
p
));

	)

1175 
	#Tİ_Acc
(
i
, 
j
) \

1176 
	`MuÉlyWÜds
(
p
, 
A
[
i
], 
B
[
j
]);\

1177 
	`Acc2WÜdsBy1
(
d
, 
	`HighWÜd
(
p
));

	)

1179 
	#Tİ_SaveAcc0
(
i
, 
j
) \

1180 
c
 = 
	`LowWÜd
(
d
); \

1181 
	`AssignWÜd
(
d
, 
	`HighWÜd
(d)) \

1182 
	`MulAcc
(
c
, 
d
, 
A
[
i
], 
B
[
j
])

	)

1184 
	#Tİ_SaveAcc1
(
i
, 
j
) \

1185 
c
 = 
L
<c; \

1186 
	`Acc2WÜdsBy1
(
d
, 
c
); \

1187 
c
 = 
	`LowWÜd
(
d
); \

1188 
	`AssignWÜd
(
d
, 
	`HighWÜd
(d)) \

1189 
	`MulAcc
(
c
, 
d
, 
A
[
i
], 
B
[
j
])

	)

1191 
	$Ba£lše_MuÉlyTİ2
(
wÜd
 *
R
, cÚ¡ wÜd *
A
, cÚ¡ wÜd *
B
, wÜd 
L
)

1193 
wÜd
 
T
[4];

1194 
	`Ba£lše_MuÉly2
(
T
, 
A
, 
B
);

1195 
R
[0] = 
T
[2];

1196 
R
[1] = 
T
[3];

1197 
	}
}

1199 
	$Ba£lše_MuÉlyTİ4
(
wÜd
 *
R
, cÚ¡ wÜd *
A
, cÚ¡ wÜd *
B
, wÜd 
L
)

1201 
	`Tİ_Begš
(4)

1202 
	`Tİ_Acc
(1, 1) Top_Acc(2, 0) \

1203 
	`Tİ_SaveAcc0
(0, 3è
	`Mul_Acc
(1, 2) Mul_Acc(2, 1) Mul_Acc(3, 0) \

1204 
	`Tİ_SaveAcc1
(1, 3è
	`Mul_Acc
(2, 2) Mul_Acc(3, 1) \

1205 
	`Mul_SaveAcc
(0, 2, 3è
	`Mul_Acc
(3, 2) \

1206 
	`Mul_End
(1, 3)

1207 
	}
}

1209 
	$Ba£lše_MuÉlyTİ8
(
wÜd
 *
R
, cÚ¡ wÜd *
A
, cÚ¡ wÜd *
B
, wÜd 
L
)

1211 
	`Tİ_Begš
(8)

1212 
	`Tİ_Acc
(1, 5) Top_Acc(2, 4) Top_Acc(3, 3) Top_Acc(4, 2) Top_Acc(5, 1) Top_Acc(6, 0) \

1213 
	`Tİ_SaveAcc0
(0, 7è
	`Mul_Acc
(1, 6) Mul_Acc(2, 5) Mul_Acc(3, 4) Mul_Acc(4, 3) Mul_Acc(5, 2) Mul_Acc(6, 1) Mul_Acc(7, 0) \

1214 
	`Tİ_SaveAcc1
(1, 7è
	`Mul_Acc
(2, 6) Mul_Acc(3, 5) Mul_Acc(4, 4) Mul_Acc(5, 3) Mul_Acc(6, 2) Mul_Acc(7, 1) \

1215 
	`Mul_SaveAcc
(0, 2, 7è
	`Mul_Acc
(3, 6) Mul_Acc(4, 5) Mul_Acc(5, 4) Mul_Acc(6, 3) Mul_Acc(7, 2) \

1216 
	`Mul_SaveAcc
(1, 3, 7è
	`Mul_Acc
(4, 6) Mul_Acc(5, 5) Mul_Acc(6, 4) Mul_Acc(7, 3) \

1217 
	`Mul_SaveAcc
(2, 4, 7è
	`Mul_Acc
(5, 6) Mul_Acc(6, 5) Mul_Acc(7, 4) \

1218 
	`Mul_SaveAcc
(3, 5, 7è
	`Mul_Acc
(6, 6) Mul_Acc(7, 5) \

1219 
	`Mul_SaveAcc
(4, 6, 7è
	`Mul_Acc
(7, 6) \

1220 
	`Mul_End
(5, 7)

1221 
	}
}

1223 #ià!
CRYPTOPP_INTEGER_SSE2


1224 
	$Ba£lše_MuÉly16
(
wÜd
 *
R
, cÚ¡ wÜd *
A
, cÚ¡ wÜd *
B
)

1226 
Mul_16


1227 
	}
}

1229 
	$Ba£lše_Squ¬e16
(
wÜd
 *
R
, cÚ¡ wÜd *
A
)

1231 
Squ_16


1232 
	}
}

1234 
	$Ba£lše_MuÉlyBÙtom16
(
wÜd
 *
R
, cÚ¡ wÜd *
A
, cÚ¡ wÜd *
B
)

1236 
BÙ_16


1237 
	}
}

1239 
	$Ba£lše_MuÉlyTİ16
(
wÜd
 *
R
, cÚ¡ wÜd *
A
, cÚ¡ wÜd *
B
, wÜd 
L
)

1241 
	`Tİ_Begš
(16)

1242 
	`Tİ_Acc
(1, 13) Top_Acc(2, 12) Top_Acc(3, 11) Top_Acc(4, 10) Top_Acc(5, 9) Top_Acc(6, 8) Top_Acc(7, 7) Top_Acc(8, 6) Top_Acc(9, 5) Top_Acc(10, 4) Top_Acc(11, 3) Top_Acc(12, 2) Top_Acc(13, 1) Top_Acc(14, 0) \

1243 
	`Tİ_SaveAcc0
(0, 15è
	`Mul_Acc
(1, 14) Mul_Acc(2, 13) Mul_Acc(3, 12) Mul_Acc(4, 11) Mul_Acc(5, 10) Mul_Acc(6, 9) Mul_Acc(7, 8) Mul_Acc(8, 7) Mul_Acc(9, 6) Mul_Acc(10, 5) Mul_Acc(11, 4) Mul_Acc(12, 3) Mul_Acc(13, 2) Mul_Acc(14, 1) Mul_Acc(15, 0) \

1244 
	`Tİ_SaveAcc1
(1, 15è
	`Mul_Acc
(2, 14) Mul_Acc(3, 13) Mul_Acc(4, 12) Mul_Acc(5, 11) Mul_Acc(6, 10) Mul_Acc(7, 9) Mul_Acc(8, 8) Mul_Acc(9, 7) Mul_Acc(10, 6) Mul_Acc(11, 5) Mul_Acc(12, 4) Mul_Acc(13, 3) Mul_Acc(14, 2) Mul_Acc(15, 1) \

1245 
	`Mul_SaveAcc
(0, 2, 15è
	`Mul_Acc
(3, 14) Mul_Acc(4, 13) Mul_Acc(5, 12) Mul_Acc(6, 11) Mul_Acc(7, 10) Mul_Acc(8, 9) Mul_Acc(9, 8) Mul_Acc(10, 7) Mul_Acc(11, 6) Mul_Acc(12, 5) Mul_Acc(13, 4) Mul_Acc(14, 3) Mul_Acc(15, 2) \

1246 
	`Mul_SaveAcc
(1, 3, 15è
	`Mul_Acc
(4, 14) Mul_Acc(5, 13) Mul_Acc(6, 12) Mul_Acc(7, 11) Mul_Acc(8, 10) Mul_Acc(9, 9) Mul_Acc(10, 8) Mul_Acc(11, 7) Mul_Acc(12, 6) Mul_Acc(13, 5) Mul_Acc(14, 4) Mul_Acc(15, 3) \

1247 
	`Mul_SaveAcc
(2, 4, 15è
	`Mul_Acc
(5, 14) Mul_Acc(6, 13) Mul_Acc(7, 12) Mul_Acc(8, 11) Mul_Acc(9, 10) Mul_Acc(10, 9) Mul_Acc(11, 8) Mul_Acc(12, 7) Mul_Acc(13, 6) Mul_Acc(14, 5) Mul_Acc(15, 4) \

1248 
	`Mul_SaveAcc
(3, 5, 15è
	`Mul_Acc
(6, 14) Mul_Acc(7, 13) Mul_Acc(8, 12) Mul_Acc(9, 11) Mul_Acc(10, 10) Mul_Acc(11, 9) Mul_Acc(12, 8) Mul_Acc(13, 7) Mul_Acc(14, 6) Mul_Acc(15, 5) \

1249 
	`Mul_SaveAcc
(4, 6, 15è
	`Mul_Acc
(7, 14) Mul_Acc(8, 13) Mul_Acc(9, 12) Mul_Acc(10, 11) Mul_Acc(11, 10) Mul_Acc(12, 9) Mul_Acc(13, 8) Mul_Acc(14, 7) Mul_Acc(15, 6) \

1250 
	`Mul_SaveAcc
(5, 7, 15è
	`Mul_Acc
(8, 14) Mul_Acc(9, 13) Mul_Acc(10, 12) Mul_Acc(11, 11) Mul_Acc(12, 10) Mul_Acc(13, 9) Mul_Acc(14, 8) Mul_Acc(15, 7) \

1251 
	`Mul_SaveAcc
(6, 8, 15è
	`Mul_Acc
(9, 14) Mul_Acc(10, 13) Mul_Acc(11, 12) Mul_Acc(12, 11) Mul_Acc(13, 10) Mul_Acc(14, 9) Mul_Acc(15, 8) \

1252 
	`Mul_SaveAcc
(7, 9, 15è
	`Mul_Acc
(10, 14) Mul_Acc(11, 13) Mul_Acc(12, 12) Mul_Acc(13, 11) Mul_Acc(14, 10) Mul_Acc(15, 9) \

1253 
	`Mul_SaveAcc
(8, 10, 15è
	`Mul_Acc
(11, 14) Mul_Acc(12, 13) Mul_Acc(13, 12) Mul_Acc(14, 11) Mul_Acc(15, 10) \

1254 
	`Mul_SaveAcc
(9, 11, 15è
	`Mul_Acc
(12, 14) Mul_Acc(13, 13) Mul_Acc(14, 12) Mul_Acc(15, 11) \

1255 
	`Mul_SaveAcc
(10, 12, 15è
	`Mul_Acc
(13, 14) Mul_Acc(14, 13) Mul_Acc(15, 12) \

1256 
	`Mul_SaveAcc
(11, 13, 15è
	`Mul_Acc
(14, 14) Mul_Acc(15, 13) \

1257 
	`Mul_SaveAcc
(12, 14, 15è
	`Mul_Acc
(15, 14) \

1258 
	`Mul_End
(13, 15)

1259 
	}
}

1264 #ià
CRYPTOPP_INTEGER_SSE2


1266 
	$CRYPTOPP_ALIGN_DATA
(16ècÚ¡ 
wÜd32
 
s_maskLow16
[4] 
CRYPTOPP_SECTION_ALIGN16
 = {0xffff,0xffff,0xffff,0xffff
	}
};

1268 #undeà
Mul_Begš


1269 #undeà
Mul_Acc


1270 #undeà
Tİ_Begš


1271 #undeà
Tİ_Acc


1272 #undeà
Squ_Acc


1273 #undeà
Squ_NÚDŸg


1274 #undeà
Squ_DŸg


1275 #undeà
Squ_SaveAcc


1276 #undeà
Squ_Begš


1277 #undeà
Mul_SaveAcc


1278 #undeà
BÙ_Acc


1279 #undeà
BÙ_SaveAcc


1280 #undeà
BÙ_End


1281 #undeà
Squ_End


1282 #undeà
Mul_End


1284 
	#SSE2_Fš®Save
(
k
) \

1285 
	`AS2
Ğ
p¦lq
 
xmm5
, 16) \

1286 
	`AS2
Ğ
·ddq
 
xmm4
, 
xmm5
) \

1287 
	`AS2
Ğ
movq
 
QWORD
 
PTR
 [
ecx
+8*(
k
)], 
xmm4
)

	)

1289 
	#SSE2_SaveShiá
(
k
) \

1290 
	`AS2
Ğ
movq
 
xmm0
, 
xmm6
) \

1291 
	`AS2
Ğ
puÅckhqdq
 
xmm6
, 
xmm0
) \

1292 
	`AS2
Ğ
movq
 
xmm1
, 
xmm7
) \

1293 
	`AS2
Ğ
puÅckhqdq
 
xmm7
, 
xmm1
) \

1294 
	`AS2
Ğ
·ddd
 
xmm6
, 
xmm0
) \

1295 
	`AS2
Ğ
p¦ldq
 
xmm6
, 4) \

1296 
	`AS2
Ğ
·ddd
 
xmm7
, 
xmm1
) \

1297 
	`AS2
Ğ
·ddd
 
xmm4
, 
xmm6
) \

1298 
	`AS2
Ğ
p¦ldq
 
xmm7
, 4) \

1299 
	`AS2
Ğ
movq
 
xmm6
, 
xmm4
) \

1300 
	`AS2
Ğ
·ddd
 
xmm5
, 
xmm7
) \

1301 
	`AS2
Ğ
movq
 
xmm7
, 
xmm5
) \

1302 
	`AS2
Ğ
movd
 
DWORD
 
PTR
 [
ecx
+8*(
k
)], 
xmm4
) \

1303 
	`AS2
Ğ
p¤lq
 
xmm6
, 16) \

1304 
	`AS2
Ğ
·ddq
 
xmm6
, 
xmm7
) \

1305 
	`AS2
Ğ
puÅckhqdq
 
xmm4
, 
xmm0
) \

1306 
	`AS2
Ğ
puÅckhqdq
 
xmm5
, 
xmm0
) \

1307 
	`AS2
Ğ
movq
 
QWORD
 
PTR
 [
ecx
+8*(
k
)+2], 
xmm6
) \

1308 
	`AS2
Ğ
p¤lq
 
xmm6
, 3*16) \

1309 
	`AS2
Ğ
·ddd
 
xmm4
, 
xmm6
) \

1310 

	)

1311 
	#Squ_SSE2_SaveShiá
(
k
) \

1312 
	`AS2
Ğ
movq
 
xmm0
, 
xmm6
) \

1313 
	`AS2
Ğ
puÅckhqdq
 
xmm6
, 
xmm0
) \

1314 
	`AS2
Ğ
movq
 
xmm1
, 
xmm7
) \

1315 
	`AS2
Ğ
puÅckhqdq
 
xmm7
, 
xmm1
) \

1316 
	`AS2
Ğ
·ddd
 
xmm6
, 
xmm0
) \

1317 
	`AS2
Ğ
p¦ldq
 
xmm6
, 4) \

1318 
	`AS2
Ğ
·ddd
 
xmm7
, 
xmm1
) \

1319 
	`AS2
Ğ
·ddd
 
xmm4
, 
xmm6
) \

1320 
	`AS2
Ğ
p¦ldq
 
xmm7
, 4) \

1321 
	`AS2
Ğ
movhÍs
 
xmm6
, 
xmm4
) \

1322 
	`AS2
Ğ
movd
 
DWORD
 
PTR
 [
ecx
+8*(
k
)], 
xmm4
) \

1323 
	`AS2
Ğ
·ddd
 
xmm5
, 
xmm7
) \

1324 
	`AS2
Ğ
movhps
 
QWORD
 
PTR
 [
e¥
+12], 
xmm5
)\

1325 
	`AS2
Ğ
p¤lq
 
xmm4
, 16) \

1326 
	`AS2
Ğ
·ddq
 
xmm4
, 
xmm5
) \

1327 
	`AS2
Ğ
movq
 
QWORD
 
PTR
 [
ecx
+8*(
k
)+2], 
xmm4
) \

1328 
	`AS2
Ğ
p¤lq
 
xmm4
, 3*16) \

1329 
	`AS2
Ğ
·ddd
 
xmm4
, 
xmm6
) \

1330 
	`AS2
Ğ
movq
 
QWORD
 
PTR
 [
e¥
+4], 
xmm4
)\

1331 

	)

1332 
	#SSE2_Fœ¡MuÉly
(
i
) \

1333 
	`AS2
Ğ
movdqa
 
xmm7
, [
esi
+(
i
)*16])\

1334 
	`AS2
Ğ
movdqa
 
xmm5
, [
edi
-(
i
)*16])\

1335 
	`AS2
Ğ
pmuludq
 
xmm5
, 
xmm7
) \

1336 
	`AS2
Ğ
movdqa
 
xmm4
, [
ebx
])\

1337 
	`AS2
Ğ
movdqa
 
xmm6
, 
xmm4
) \

1338 
	`AS2
Ğ
·nd
 
xmm4
, 
xmm5
) \

1339 
	`AS2
Ğ
p¤ld
 
xmm5
, 16) \

1340 
	`AS2
Ğ
pmuludq
 
xmm7
, [
edx
-(
i
)*16])\

1341 
	`AS2
Ğ
·nd
 
xmm6
, 
xmm7
) \

1342 
	`AS2
Ğ
p¤ld
 
xmm7
, 16)

	)

1344 
	#Squ_Begš
(
n
) \

1345 
SquPrŞogue
 \

1346 
	`AS2
Ğ
mov
 
esi
, 
e¥
)\

1347 
	`AS2
Ğ
ªd
 
e¥
, 0xfffffff0)\

1348 
	`AS2
Ğ
Ëa
 
edi
, [
e¥
-32*
n
])\

1349 
	`AS2
Ğ
sub
 
e¥
, 32*
n
+16)\

1350 
	`AS1
Ğ
push
 
esi
)\

1351 
	`AS2
Ğ
mov
 
esi
, 
edi
) \

1352 
	`AS2
Ğ
xÜ
 
edx
,ƒdx) \

1353 
	`ASL
(1) \

1354 
	`ASS
Ğ
pshufd
 
xmm0
, [
—x
+
edx
], 3,1,2,0) \

1355 
	`ASS
Ğ
pshufd
 
xmm1
, [
—x
+
edx
], 2,0,3,1) \

1356 
	`AS2
Ğ
movdqa
 [
edi
+2*
edx
], 
xmm0
) \

1357 
	`AS2
Ğ
p¤lq
 
xmm0
, 32) \

1358 
	`AS2
Ğ
movdqa
 [
edi
+2*
edx
+16], 
xmm0
) \

1359 
	`AS2
Ğ
movdqa
 [
edi
+16*
n
+2*
edx
], 
xmm1
) \

1360 
	`AS2
Ğ
p¤lq
 
xmm1
, 32) \

1361 
	`AS2
Ğ
movdqa
 [
edi
+16*
n
+2*
edx
+16], 
xmm1
) \

1362 
	`AS2
Ğ
add
 
edx
, 16) \

1363 
	`AS2
Ğ
cmp
 
edx
, 8*(
n
)) \

1364 
	`ASJ
Ğ
jÃ
, 1, 
b
) \

1365 
	`AS2
Ğ
Ëa
 
edx
, [
edi
+16*
n
])\

1366 
	`SSE2_Fœ¡MuÉly
(0) \

1367 

	)

1368 
	#Squ_Acc
(
i
) \

1369 
	`ASL
(
LSqu
##
i
) \

1370 
	`AS2
Ğ
movdqa
 
xmm1
, [
esi
+(
i
)*16]) \

1371 
	`AS2
Ğ
movdqa
 
xmm0
, [
edi
-(
i
)*16]) \

1372 
	`AS2
Ğ
movdqa
 
xmm2
, [
ebx
]) \

1373 
	`AS2
Ğ
pmuludq
 
xmm0
, 
xmm1
) \

1374 
	`AS2
Ğ
pmuludq
 
xmm1
, [
edx
-(
i
)*16]) \

1375 
	`AS2
Ğ
movdqa
 
xmm3
, 
xmm2
) \

1376 
	`AS2
Ğ
·nd
 
xmm2
, 
xmm0
) \

1377 
	`AS2
Ğ
p¤ld
 
xmm0
, 16) \

1378 
	`AS2
Ğ
·ddd
 
xmm4
, 
xmm2
) \

1379 
	`AS2
Ğ
·ddd
 
xmm5
, 
xmm0
) \

1380 
	`AS2
Ğ
·nd
 
xmm3
, 
xmm1
) \

1381 
	`AS2
Ğ
p¤ld
 
xmm1
, 16) \

1382 
	`AS2
Ğ
·ddd
 
xmm6
, 
xmm3
) \

1383 
	`AS2
Ğ
·ddd
 
xmm7
, 
xmm1
) \

1384 

	)

1385 
	#Squ_Acc1
(
i
)

	)

1386 
	#Squ_Acc2
(
i
è
	`ASC
(
ÿÎ
, 
LSqu
##i)

	)

1387 
	#Squ_Acc3
(
i
è
	`Squ_Acc2
(i)

	)

1388 
	#Squ_Acc4
(
i
è
	`Squ_Acc2
(i)

	)

1389 
	#Squ_Acc5
(
i
è
	`Squ_Acc2
(i)

	)

1390 
	#Squ_Acc6
(
i
è
	`Squ_Acc2
(i)

	)

1391 
	#Squ_Acc7
(
i
è
	`Squ_Acc2
(i)

	)

1392 
	#Squ_Acc8
(
i
è
	`Squ_Acc2
(i)

	)

1394 
	#SSE2_End
(
E
, 
n
) \

1395 
	`SSE2_SaveShiá
(2*(
n
)-3) \

1396 
	`AS2
Ğ
movdqa
 
xmm7
, [
esi
+16]) \

1397 
	`AS2
Ğ
movdqa
 
xmm0
, [
edi
]) \

1398 
	`AS2
Ğ
pmuludq
 
xmm0
, 
xmm7
) \

1399 
	`AS2
Ğ
movdqa
 
xmm2
, [
ebx
]) \

1400 
	`AS2
Ğ
pmuludq
 
xmm7
, [
edx
]) \

1401 
	`AS2
Ğ
movdqa
 
xmm6
, 
xmm2
) \

1402 
	`AS2
Ğ
·nd
 
xmm2
, 
xmm0
) \

1403 
	`AS2
Ğ
p¤ld
 
xmm0
, 16) \

1404 
	`AS2
Ğ
·ddd
 
xmm4
, 
xmm2
) \

1405 
	`AS2
Ğ
·ddd
 
xmm5
, 
xmm0
) \

1406 
	`AS2
Ğ
·nd
 
xmm6
, 
xmm7
) \

1407 
	`AS2
Ğ
p¤ld
 
xmm7
, 16) \

1408 
	`SSE2_SaveShiá
(2*(
n
)-2) \

1409 
	`SSE2_Fš®Save
(2*(
n
)-1) \

1410 
	`AS1
Ğ
pİ
 
e¥
)\

1411 
E


	)

1413 
	#Squ_End
(
n
è
	`SSE2_End
(
SquEpogue
,‚)

	)

1414 
	#Mul_End
(
n
è
	`SSE2_End
(
MulEpogue
,‚)

	)

1415 
	#Tİ_End
(
n
è
	`SSE2_End
(
TİEpogue
,‚)

	)

1417 
	#Squ_CŞumn1
(
k
, 
i
) \

1418 
	`Squ_SSE2_SaveShiá
(
k
) \

1419 
	`AS2
Ğ
add
 
esi
, 16) \

1420 
	`SSE2_Fœ¡MuÉly
(1)\

1421 
Squ_Acc
##
	`i
(
i
) \

1422 
	`AS2
Ğ
·ddd
 
xmm4
, xmm4) \

1423 
	`AS2
Ğ
·ddd
 
xmm5
, xmm5) \

1424 
	`AS2
Ğ
movdqa
 
xmm3
, [
esi
]) \

1425 
	`AS2
Ğ
movq
 
xmm1
, 
QWORD
 
PTR
 [
esi
+8]) \

1426 
	`AS2
Ğ
pmuludq
 
xmm1
, 
xmm3
) \

1427 
	`AS2
Ğ
pmuludq
 
xmm3
, xmm3) \

1428 
	`AS2
Ğ
movdqa
 
xmm0
, [
ebx
])\

1429 
	`AS2
Ğ
movdqa
 
xmm2
, 
xmm0
) \

1430 
	`AS2
Ğ
·nd
 
xmm0
, 
xmm1
) \

1431 
	`AS2
Ğ
p¤ld
 
xmm1
, 16) \

1432 
	`AS2
Ğ
·ddd
 
xmm6
, 
xmm0
) \

1433 
	`AS2
Ğ
·ddd
 
xmm7
, 
xmm1
) \

1434 
	`AS2
Ğ
·nd
 
xmm2
, 
xmm3
) \

1435 
	`AS2
Ğ
p¤ld
 
xmm3
, 16) \

1436 
	`AS2
Ğ
·ddd
 
xmm6
, xmm6) \

1437 
	`AS2
Ğ
·ddd
 
xmm7
, xmm7) \

1438 
	`AS2
Ğ
·ddd
 
xmm4
, 
xmm2
) \

1439 
	`AS2
Ğ
·ddd
 
xmm5
, 
xmm3
) \

1440 
	`AS2
Ğ
movq
 
xmm0
, 
QWORD
 
PTR
 [
e¥
+4])\

1441 
	`AS2
Ğ
movq
 
xmm1
, 
QWORD
 
PTR
 [
e¥
+12])\

1442 
	`AS2
Ğ
·ddd
 
xmm4
, 
xmm0
)\

1443 
	`AS2
Ğ
·ddd
 
xmm5
, 
xmm1
)\

1444 

	)

1445 
	#Squ_CŞumn0
(
k
, 
i
) \

1446 
	`Squ_SSE2_SaveShiá
(
k
) \

1447 
	`AS2
Ğ
add
 
edi
, 16) \

1448 
	`AS2
Ğ
add
 
edx
, 16) \

1449 
	`SSE2_Fœ¡MuÉly
(1)\

1450 
Squ_Acc
##
	`i
(
i
) \

1451 
	`AS2
Ğ
·ddd
 
xmm6
, xmm6) \

1452 
	`AS2
Ğ
·ddd
 
xmm7
, xmm7) \

1453 
	`AS2
Ğ
·ddd
 
xmm4
, xmm4) \

1454 
	`AS2
Ğ
·ddd
 
xmm5
, xmm5) \

1455 
	`AS2
Ğ
movq
 
xmm0
, 
QWORD
 
PTR
 [
e¥
+4])\

1456 
	`AS2
Ğ
movq
 
xmm1
, 
QWORD
 
PTR
 [
e¥
+12])\

1457 
	`AS2
Ğ
·ddd
 
xmm4
, 
xmm0
)\

1458 
	`AS2
Ğ
·ddd
 
xmm5
, 
xmm1
)\

1459 

	)

1460 
	#SSE2_MulAdd45
 \

1461 
	`AS2
Ğ
movdqa
 
xmm7
, [
esi
]) \

1462 
	`AS2
Ğ
movdqa
 
xmm0
, [
edi
]) \

1463 
	`AS2
Ğ
pmuludq
 
xmm0
, 
xmm7
) \

1464 
	`AS2
Ğ
movdqa
 
xmm2
, [
ebx
]) \

1465 
	`AS2
Ğ
pmuludq
 
xmm7
, [
edx
]) \

1466 
	`AS2
Ğ
movdqa
 
xmm6
, 
xmm2
) \

1467 
	`AS2
Ğ
·nd
 
xmm2
, 
xmm0
) \

1468 
	`AS2
Ğ
p¤ld
 
xmm0
, 16) \

1469 
	`AS2
Ğ
·ddd
 
xmm4
, 
xmm2
) \

1470 
	`AS2
Ğ
·ddd
 
xmm5
, 
xmm0
) \

1471 
	`AS2
Ğ
·nd
 
xmm6
, 
xmm7
) \

1472 
	`AS2
Ğ
p¤ld
 
xmm7
, 16)

	)

1474 
	#Mul_Begš
(
n
) \

1475 
MulPrŞogue
 \

1476 
	`AS2
Ğ
mov
 
esi
, 
e¥
)\

1477 
	`AS2
Ğ
ªd
 
e¥
, 0xfffffff0)\

1478 
	`AS2
Ğ
sub
 
e¥
, 48*
n
+16)\

1479 
	`AS1
Ğ
push
 
esi
)\

1480 
	`AS2
Ğ
xÜ
 
edx
,ƒdx) \

1481 
	`ASL
(1) \

1482 
	`ASS
Ğ
pshufd
 
xmm0
, [
—x
+
edx
], 3,1,2,0) \

1483 
	`ASS
Ğ
pshufd
 
xmm1
, [
—x
+
edx
], 2,0,3,1) \

1484 
	`ASS
Ğ
pshufd
 
xmm2
, [
edi
+
edx
], 3,1,2,0) \

1485 
	`AS2
Ğ
movdqa
 [
e¥
+20+2*
edx
], 
xmm0
) \

1486 
	`AS2
Ğ
p¤lq
 
xmm0
, 32) \

1487 
	`AS2
Ğ
movdqa
 [
e¥
+20+2*
edx
+16], 
xmm0
) \

1488 
	`AS2
Ğ
movdqa
 [
e¥
+20+16*
n
+2*
edx
], 
xmm1
) \

1489 
	`AS2
Ğ
p¤lq
 
xmm1
, 32) \

1490 
	`AS2
Ğ
movdqa
 [
e¥
+20+16*
n
+2*
edx
+16], 
xmm1
) \

1491 
	`AS2
Ğ
movdqa
 [
e¥
+20+32*
n
+2*
edx
], 
xmm2
) \

1492 
	`AS2
Ğ
p¤lq
 
xmm2
, 32) \

1493 
	`AS2
Ğ
movdqa
 [
e¥
+20+32*
n
+2*
edx
+16], 
xmm2
) \

1494 
	`AS2
Ğ
add
 
edx
, 16) \

1495 
	`AS2
Ğ
cmp
 
edx
, 8*(
n
)) \

1496 
	`ASJ
Ğ
jÃ
, 1, 
b
) \

1497 
	`AS2
Ğ
Ëa
 
edi
, [
e¥
+20])\

1498 
	`AS2
Ğ
Ëa
 
edx
, [
e¥
+20+16*
n
])\

1499 
	`AS2
Ğ
Ëa
 
esi
, [
e¥
+20+32*
n
])\

1500 
	`SSE2_Fœ¡MuÉly
(0) \

1501 

	)

1502 
	#Mul_Acc
(
i
) \

1503 
	`ASL
(
LMul
##
i
) \

1504 
	`AS2
Ğ
movdqa
 
xmm1
, [
esi
+
i
/2*(1-(i-2*(i/2))*2)*16]) \

1505 
	`AS2
Ğ
movdqa
 
xmm0
, [
edi
-
i
/2*(1-(i-2*(i/2))*2)*16]) \

1506 
	`AS2
Ğ
movdqa
 
xmm2
, [
ebx
]) \

1507 
	`AS2
Ğ
pmuludq
 
xmm0
, 
xmm1
) \

1508 
	`AS2
Ğ
pmuludq
 
xmm1
, [
edx
-
i
/2*(1-(i-2*(i/2))*2)*16]) \

1509 
	`AS2
Ğ
movdqa
 
xmm3
, 
xmm2
) \

1510 
	`AS2
Ğ
·nd
 
xmm2
, 
xmm0
) \

1511 
	`AS2
Ğ
p¤ld
 
xmm0
, 16) \

1512 
	`AS2
Ğ
·ddd
 
xmm4
, 
xmm2
) \

1513 
	`AS2
Ğ
·ddd
 
xmm5
, 
xmm0
) \

1514 
	`AS2
Ğ
·nd
 
xmm3
, 
xmm1
) \

1515 
	`AS2
Ğ
p¤ld
 
xmm1
, 16) \

1516 
	`AS2
Ğ
·ddd
 
xmm6
, 
xmm3
) \

1517 
	`AS2
Ğ
·ddd
 
xmm7
, 
xmm1
) \

1518 

	)

1519 
	#Mul_Acc1
(
i
)

	)

1520 
	#Mul_Acc2
(
i
è
	`ASC
(
ÿÎ
, 
LMul
##i)

	)

1521 
	#Mul_Acc3
(
i
è
	`Mul_Acc2
(i)

	)

1522 
	#Mul_Acc4
(
i
è
	`Mul_Acc2
(i)

	)

1523 
	#Mul_Acc5
(
i
è
	`Mul_Acc2
(i)

	)

1524 
	#Mul_Acc6
(
i
è
	`Mul_Acc2
(i)

	)

1525 
	#Mul_Acc7
(
i
è
	`Mul_Acc2
(i)

	)

1526 
	#Mul_Acc8
(
i
è
	`Mul_Acc2
(i)

	)

1527 
	#Mul_Acc9
(
i
è
	`Mul_Acc2
(i)

	)

1528 
	#Mul_Acc10
(
i
è
	`Mul_Acc2
(i)

	)

1529 
	#Mul_Acc11
(
i
è
	`Mul_Acc2
(i)

	)

1530 
	#Mul_Acc12
(
i
è
	`Mul_Acc2
(i)

	)

1531 
	#Mul_Acc13
(
i
è
	`Mul_Acc2
(i)

	)

1532 
	#Mul_Acc14
(
i
è
	`Mul_Acc2
(i)

	)

1533 
	#Mul_Acc15
(
i
è
	`Mul_Acc2
(i)

	)

1534 
	#Mul_Acc16
(
i
è
	`Mul_Acc2
(i)

	)

1536 
	#Mul_CŞumn1
(
k
, 
i
) \

1537 
	`SSE2_SaveShiá
(
k
) \

1538 
	`AS2
Ğ
add
 
esi
, 16) \

1539 
SSE2_MulAdd45
\

1540 
Mul_Acc
##
	`i
(
i
) \

1541 

	)

1542 
	#Mul_CŞumn0
(
k
, 
i
) \

1543 
	`SSE2_SaveShiá
(
k
) \

1544 
	`AS2
Ğ
add
 
edi
, 16) \

1545 
	`AS2
Ğ
add
 
edx
, 16) \

1546 
SSE2_MulAdd45
\

1547 
Mul_Acc
##
	`i
(
i
) \

1548 

	)

1549 
	#BÙ_Acc
(
i
) \

1550 
	`AS2
Ğ
movdqa
 
xmm1
, [
esi
+
i
/2*(1-(i-2*(i/2))*2)*16]) \

1551 
	`AS2
Ğ
movdqa
 
xmm0
, [
edi
-
i
/2*(1-(i-2*(i/2))*2)*16]) \

1552 
	`AS2
Ğ
pmuludq
 
xmm0
, 
xmm1
) \

1553 
	`AS2
Ğ
pmuludq
 
xmm1
, [
edx
-
i
/2*(1-(i-2*(i/2))*2)*16]) \

1554 
	`AS2
Ğ
·ddq
 
xmm4
, 
xmm0
) \

1555 
	`AS2
Ğ
·ddd
 
xmm6
, 
xmm1
)

	)

1557 
	#BÙ_SaveAcc
(
k
) \

1558 
	`SSE2_SaveShiá
(
k
) \

1559 
	`AS2
Ğ
add
 
edi
, 16) \

1560 
	`AS2
Ğ
add
 
edx
, 16) \

1561 
	`AS2
Ğ
movdqa
 
xmm6
, [
esi
]) \

1562 
	`AS2
Ğ
movdqa
 
xmm0
, [
edi
]) \

1563 
	`AS2
Ğ
pmuludq
 
xmm0
, 
xmm6
) \

1564 
	`AS2
Ğ
·ddq
 
xmm4
, 
xmm0
) \

1565 
	`AS2
Ğ
p¦lq
 
xmm5
, 16) \

1566 
	`AS2
Ğ
·ddq
 
xmm4
, 
xmm5
) \

1567 
	`AS2
Ğ
pmuludq
 
xmm6
, [
edx
])

	)

1569 
	#BÙ_End
(
n
) \

1570 
	`AS2
Ğ
movhÍs
 
xmm7
, 
xmm6
) \

1571 
	`AS2
Ğ
·ddd
 
xmm6
, 
xmm7
) \

1572 
	`AS2
Ğ
p¦lq
 
xmm6
, 32) \

1573 
	`AS2
Ğ
·ddd
 
xmm4
, 
xmm6
) \

1574 
	`AS2
Ğ
movq
 
QWORD
 
PTR
 [
ecx
+8*((
n
)-1)], 
xmm4
) \

1575 
	`AS1
Ğ
pİ
 
e¥
)\

1576 
MulEpogue


	)

1578 
	#Tİ_Begš
(
n
) \

1579 
TİPrŞogue
 \

1580 
	`AS2
Ğ
mov
 
edx
, 
e¥
)\

1581 
	`AS2
Ğ
ªd
 
e¥
, 0xfffffff0)\

1582 
	`AS2
Ğ
sub
 
e¥
, 48*
n
+16)\

1583 
	`AS1
Ğ
push
 
edx
)\

1584 
	`AS2
Ğ
xÜ
 
edx
,ƒdx) \

1585 
	`ASL
(1) \

1586 
	`ASS
Ğ
pshufd
 
xmm0
, [
—x
+
edx
], 3,1,2,0) \

1587 
	`ASS
Ğ
pshufd
 
xmm1
, [
—x
+
edx
], 2,0,3,1) \

1588 
	`ASS
Ğ
pshufd
 
xmm2
, [
edi
+
edx
], 3,1,2,0) \

1589 
	`AS2
Ğ
movdqa
 [
e¥
+20+2*
edx
], 
xmm0
) \

1590 
	`AS2
Ğ
p¤lq
 
xmm0
, 32) \

1591 
	`AS2
Ğ
movdqa
 [
e¥
+20+2*
edx
+16], 
xmm0
) \

1592 
	`AS2
Ğ
movdqa
 [
e¥
+20+16*
n
+2*
edx
], 
xmm1
) \

1593 
	`AS2
Ğ
p¤lq
 
xmm1
, 32) \

1594 
	`AS2
Ğ
movdqa
 [
e¥
+20+16*
n
+2*
edx
+16], 
xmm1
) \

1595 
	`AS2
Ğ
movdqa
 [
e¥
+20+32*
n
+2*
edx
], 
xmm2
) \

1596 
	`AS2
Ğ
p¤lq
 
xmm2
, 32) \

1597 
	`AS2
Ğ
movdqa
 [
e¥
+20+32*
n
+2*
edx
+16], 
xmm2
) \

1598 
	`AS2
Ğ
add
 
edx
, 16) \

1599 
	`AS2
Ğ
cmp
 
edx
, 8*(
n
)) \

1600 
	`ASJ
Ğ
jÃ
, 1, 
b
) \

1601 
	`AS2
Ğ
mov
 
—x
, 
esi
) \

1602 
	`AS2
Ğ
Ëa
 
edi
, [
e¥
+20+00*
n
+16*(n/2-1)])\

1603 
	`AS2
Ğ
Ëa
 
edx
, [
e¥
+20+16*
n
+16*(n/2-1)])\

1604 
	`AS2
Ğ
Ëa
 
esi
, [
e¥
+20+32*
n
+16*(n/2-1)])\

1605 
	`AS2
Ğ
pxÜ
 
xmm4
, xmm4)\

1606 
	`AS2
Ğ
pxÜ
 
xmm5
, xmm5)

	)

1608 
	#Tİ_Acc
(
i
) \

1609 
	`AS2
Ğ
movq
 
xmm0
, 
QWORD
 
PTR
 [
esi
+
i
/2*(1-(i-2*(i/2))*2)*16+8]) \

1610 
	`AS2
Ğ
pmuludq
 
xmm0
, [
edx
-
i
/2*(1-(i-2*(i/2))*2)*16]) \

1611 
	`AS2
Ğ
p¤lq
 
xmm0
, 48) \

1612 
	`AS2
Ğ
·ddd
 
xmm5
, 
xmm0
)\

1613 

	)

1614 
	#Tİ_CŞumn0
(
i
) \

1615 
	`AS2
Ğ
p¦lq
 
xmm5
, 32) \

1616 
	`AS2
Ğ
add
 
edi
, 16) \

1617 
	`AS2
Ğ
add
 
edx
, 16) \

1618 
SSE2_MulAdd45
\

1619 
Mul_Acc
##
	`i
(
i
) \

1620 

	)

1621 
	#Tİ_CŞumn1
(
i
) \

1622 
	`SSE2_SaveShiá
(0) \

1623 
	`AS2
Ğ
add
 
esi
, 16) \

1624 
SSE2_MulAdd45
\

1625 
Mul_Acc
##
	`i
(
i
) \

1626 
	`AS2
Ğ
shr
 
—x
, 16) \

1627 
	`AS2
Ğ
movd
 
xmm0
, 
—x
)\

1628 
	`AS2
Ğ
movd
 
xmm1
, [
ecx
+4])\

1629 
	`AS2
Ğ
p¤ld
 
xmm1
, 16)\

1630 
	`AS2
Ğ
pcmpgtd
 
xmm1
, 
xmm0
)\

1631 
	`AS2
Ğ
p¤ld
 
xmm1
, 31)\

1632 
	`AS2
Ğ
·ddd
 
xmm4
, 
xmm1
)\

1633 

	)

1634 
	$SSE2_Squ¬e4
(
wÜd
 *
C
, cÚ¡ wÜd *
A
)

1636 
	`Squ_Begš
(2)

1637 
	`Squ_CŞumn0
(0, 1)

1638 
	`Squ_End
(2)

1639 
	}
}

1641 
	$SSE2_Squ¬e8
(
wÜd
 *
C
, cÚ¡ wÜd *
A
)

1643 
	`Squ_Begš
(4)

1644 #iâdeà
__GNUC__


1645 
	`ASJ
Ğ
jmp
, 0, 
f
)

1646 
	`Squ_Acc
(2)

1647 
	`AS1
Ğ
»t
è
	`ASL
(0)

1649 
	`Squ_CŞumn0
(0, 1)

1650 
	`Squ_CŞumn1
(1, 1)

1651 
	`Squ_CŞumn0
(2, 2)

1652 
	`Squ_CŞumn1
(3, 1)

1653 
	`Squ_CŞumn0
(4, 1)

1654 
	`Squ_End
(4)

1655 
	}
}

1657 
	$SSE2_Squ¬e16
(
wÜd
 *
C
, cÚ¡ wÜd *
A
)

1659 
	`Squ_Begš
(8)

1660 #iâdeà
__GNUC__


1661 
	`ASJ
Ğ
jmp
, 0, 
f
)

1662 
	`Squ_Acc
(4) Squ_Acc(3) Squ_Acc(2)

1663 
	`AS1
Ğ
»t
è
	`ASL
(0)

1665 
	`Squ_CŞumn0
(0, 1)

1666 
	`Squ_CŞumn1
(1, 1)

1667 
	`Squ_CŞumn0
(2, 2)

1668 
	`Squ_CŞumn1
(3, 2)

1669 
	`Squ_CŞumn0
(4, 3)

1670 
	`Squ_CŞumn1
(5, 3)

1671 
	`Squ_CŞumn0
(6, 4)

1672 
	`Squ_CŞumn1
(7, 3)

1673 
	`Squ_CŞumn0
(8, 3)

1674 
	`Squ_CŞumn1
(9, 2)

1675 
	`Squ_CŞumn0
(10, 2)

1676 
	`Squ_CŞumn1
(11, 1)

1677 
	`Squ_CŞumn0
(12, 1)

1678 
	`Squ_End
(8)

1679 
	}
}

1681 
	$SSE2_Squ¬e32
(
wÜd
 *
C
, cÚ¡ wÜd *
A
)

1683 
	`Squ_Begš
(16)

1684 
	`ASJ
Ğ
jmp
, 0, 
f
)

1685 
	`Squ_Acc
(8) Squ_Acc(7) Squ_Acc(6) Squ_Acc(5) Squ_Acc(4) Squ_Acc(3) Squ_Acc(2)

1686 
	`AS1
Ğ
»t
è
	`ASL
(0)

1687 
	`Squ_CŞumn0
(0, 1)

1688 
	`Squ_CŞumn1
(1, 1)

1689 
	`Squ_CŞumn0
(2, 2)

1690 
	`Squ_CŞumn1
(3, 2)

1691 
	`Squ_CŞumn0
(4, 3)

1692 
	`Squ_CŞumn1
(5, 3)

1693 
	`Squ_CŞumn0
(6, 4)

1694 
	`Squ_CŞumn1
(7, 4)

1695 
	`Squ_CŞumn0
(8, 5)

1696 
	`Squ_CŞumn1
(9, 5)

1697 
	`Squ_CŞumn0
(10, 6)

1698 
	`Squ_CŞumn1
(11, 6)

1699 
	`Squ_CŞumn0
(12, 7)

1700 
	`Squ_CŞumn1
(13, 7)

1701 
	`Squ_CŞumn0
(14, 8)

1702 
	`Squ_CŞumn1
(15, 7)

1703 
	`Squ_CŞumn0
(16, 7)

1704 
	`Squ_CŞumn1
(17, 6)

1705 
	`Squ_CŞumn0
(18, 6)

1706 
	`Squ_CŞumn1
(19, 5)

1707 
	`Squ_CŞumn0
(20, 5)

1708 
	`Squ_CŞumn1
(21, 4)

1709 
	`Squ_CŞumn0
(22, 4)

1710 
	`Squ_CŞumn1
(23, 3)

1711 
	`Squ_CŞumn0
(24, 3)

1712 
	`Squ_CŞumn1
(25, 2)

1713 
	`Squ_CŞumn0
(26, 2)

1714 
	`Squ_CŞumn1
(27, 1)

1715 
	`Squ_CŞumn0
(28, 1)

1716 
	`Squ_End
(16)

1717 
	}
}

1719 
	$SSE2_MuÉly4
(
wÜd
 *
C
, cÚ¡ wÜd *
A
, cÚ¡ wÜd *
B
)

1721 
	`Mul_Begš
(2)

1722 #iâdeà
__GNUC__


1723 
	`ASJ
Ğ
jmp
, 0, 
f
)

1724 
	`Mul_Acc
(2)

1725 
	`AS1
Ğ
»t
è
	`ASL
(0)

1727 
	`Mul_CŞumn0
(0, 2)

1728 
	`Mul_End
(2)

1729 
	}
}

1731 
	$SSE2_MuÉly8
(
wÜd
 *
C
, cÚ¡ wÜd *
A
, cÚ¡ wÜd *
B
)

1733 
	`Mul_Begš
(4)

1734 #iâdeà
__GNUC__


1735 
	`ASJ
Ğ
jmp
, 0, 
f
)

1736 
	`Mul_Acc
(4) Mul_Acc(3) Mul_Acc(2)

1737 
	`AS1
Ğ
»t
è
	`ASL
(0)

1739 
	`Mul_CŞumn0
(0, 2)

1740 
	`Mul_CŞumn1
(1, 3)

1741 
	`Mul_CŞumn0
(2, 4)

1742 
	`Mul_CŞumn1
(3, 3)

1743 
	`Mul_CŞumn0
(4, 2)

1744 
	`Mul_End
(4)

1745 
	}
}

1747 
	$SSE2_MuÉly16
(
wÜd
 *
C
, cÚ¡ wÜd *
A
, cÚ¡ wÜd *
B
)

1749 
	`Mul_Begš
(8)

1750 #iâdeà
__GNUC__


1751 
	`ASJ
Ğ
jmp
, 0, 
f
)

1752 
	`Mul_Acc
(8) Mul_Acc(7) Mul_Acc(6) Mul_Acc(5) Mul_Acc(4) Mul_Acc(3) Mul_Acc(2)

1753 
	`AS1
Ğ
»t
è
	`ASL
(0)

1755 
	`Mul_CŞumn0
(0, 2)

1756 
	`Mul_CŞumn1
(1, 3)

1757 
	`Mul_CŞumn0
(2, 4)

1758 
	`Mul_CŞumn1
(3, 5)

1759 
	`Mul_CŞumn0
(4, 6)

1760 
	`Mul_CŞumn1
(5, 7)

1761 
	`Mul_CŞumn0
(6, 8)

1762 
	`Mul_CŞumn1
(7, 7)

1763 
	`Mul_CŞumn0
(8, 6)

1764 
	`Mul_CŞumn1
(9, 5)

1765 
	`Mul_CŞumn0
(10, 4)

1766 
	`Mul_CŞumn1
(11, 3)

1767 
	`Mul_CŞumn0
(12, 2)

1768 
	`Mul_End
(8)

1769 
	}
}

1771 
	$SSE2_MuÉly32
(
wÜd
 *
C
, cÚ¡ wÜd *
A
, cÚ¡ wÜd *
B
)

1773 
	`Mul_Begš
(16)

1774 
	`ASJ
Ğ
jmp
, 0, 
f
)

1775 
	`Mul_Acc
(16) Mul_Acc(15) Mul_Acc(14) Mul_Acc(13) Mul_Acc(12) Mul_Acc(11) Mul_Acc(10) Mul_Acc(9) Mul_Acc(8) Mul_Acc(7) Mul_Acc(6) Mul_Acc(5) Mul_Acc(4) Mul_Acc(3) Mul_Acc(2)

1776 
	`AS1
Ğ
»t
è
	`ASL
(0)

1777 
	`Mul_CŞumn0
(0, 2)

1778 
	`Mul_CŞumn1
(1, 3)

1779 
	`Mul_CŞumn0
(2, 4)

1780 
	`Mul_CŞumn1
(3, 5)

1781 
	`Mul_CŞumn0
(4, 6)

1782 
	`Mul_CŞumn1
(5, 7)

1783 
	`Mul_CŞumn0
(6, 8)

1784 
	`Mul_CŞumn1
(7, 9)

1785 
	`Mul_CŞumn0
(8, 10)

1786 
	`Mul_CŞumn1
(9, 11)

1787 
	`Mul_CŞumn0
(10, 12)

1788 
	`Mul_CŞumn1
(11, 13)

1789 
	`Mul_CŞumn0
(12, 14)

1790 
	`Mul_CŞumn1
(13, 15)

1791 
	`Mul_CŞumn0
(14, 16)

1792 
	`Mul_CŞumn1
(15, 15)

1793 
	`Mul_CŞumn0
(16, 14)

1794 
	`Mul_CŞumn1
(17, 13)

1795 
	`Mul_CŞumn0
(18, 12)

1796 
	`Mul_CŞumn1
(19, 11)

1797 
	`Mul_CŞumn0
(20, 10)

1798 
	`Mul_CŞumn1
(21, 9)

1799 
	`Mul_CŞumn0
(22, 8)

1800 
	`Mul_CŞumn1
(23, 7)

1801 
	`Mul_CŞumn0
(24, 6)

1802 
	`Mul_CŞumn1
(25, 5)

1803 
	`Mul_CŞumn0
(26, 4)

1804 
	`Mul_CŞumn1
(27, 3)

1805 
	`Mul_CŞumn0
(28, 2)

1806 
	`Mul_End
(16)

1807 
	}
}

1809 
	$SSE2_MuÉlyBÙtom4
(
wÜd
 *
C
, cÚ¡ wÜd *
A
, cÚ¡ wÜd *
B
)

1811 
	`Mul_Begš
(2)

1812 
	`BÙ_SaveAcc
(0è
	`BÙ_Acc
(2)

1813 
	`BÙ_End
(2)

1814 
	}
}

1816 
	$SSE2_MuÉlyBÙtom8
(
wÜd
 *
C
, cÚ¡ wÜd *
A
, cÚ¡ wÜd *
B
)

1818 
	`Mul_Begš
(4)

1819 #iâdeà
__GNUC__


1820 
	`ASJ
Ğ
jmp
, 0, 
f
)

1821 
	`Mul_Acc
(3) Mul_Acc(2)

1822 
	`AS1
Ğ
»t
è
	`ASL
(0)

1824 
	`Mul_CŞumn0
(0, 2)

1825 
	`Mul_CŞumn1
(1, 3)

1826 
	`BÙ_SaveAcc
(2è
	`BÙ_Acc
(4) Bot_Acc(3) Bot_Acc(2)

1827 
	`BÙ_End
(4)

1828 
	}
}

1830 
	$SSE2_MuÉlyBÙtom16
(
wÜd
 *
C
, cÚ¡ wÜd *
A
, cÚ¡ wÜd *
B
)

1832 
	`Mul_Begš
(8)

1833 #iâdeà
__GNUC__


1834 
	`ASJ
Ğ
jmp
, 0, 
f
)

1835 
	`Mul_Acc
(7) Mul_Acc(6) Mul_Acc(5) Mul_Acc(4) Mul_Acc(3) Mul_Acc(2)

1836 
	`AS1
Ğ
»t
è
	`ASL
(0)

1838 
	`Mul_CŞumn0
(0, 2)

1839 
	`Mul_CŞumn1
(1, 3)

1840 
	`Mul_CŞumn0
(2, 4)

1841 
	`Mul_CŞumn1
(3, 5)

1842 
	`Mul_CŞumn0
(4, 6)

1843 
	`Mul_CŞumn1
(5, 7)

1844 
	`BÙ_SaveAcc
(6è
	`BÙ_Acc
(8) Bot_Acc(7) Bot_Acc(6) Bot_Acc(5) Bot_Acc(4) Bot_Acc(3) Bot_Acc(2)

1845 
	`BÙ_End
(8)

1846 
	}
}

1848 
	$SSE2_MuÉlyBÙtom32
(
wÜd
 *
C
, cÚ¡ wÜd *
A
, cÚ¡ wÜd *
B
)

1850 
	`Mul_Begš
(16)

1851 #iâdeà
__GNUC__


1852 
	`ASJ
Ğ
jmp
, 0, 
f
)

1853 
	`Mul_Acc
(15) Mul_Acc(14) Mul_Acc(13) Mul_Acc(12) Mul_Acc(11) Mul_Acc(10) Mul_Acc(9) Mul_Acc(8) Mul_Acc(7) Mul_Acc(6) Mul_Acc(5) Mul_Acc(4) Mul_Acc(3) Mul_Acc(2)

1854 
	`AS1
Ğ
»t
è
	`ASL
(0)

1856 
	`Mul_CŞumn0
(0, 2)

1857 
	`Mul_CŞumn1
(1, 3)

1858 
	`Mul_CŞumn0
(2, 4)

1859 
	`Mul_CŞumn1
(3, 5)

1860 
	`Mul_CŞumn0
(4, 6)

1861 
	`Mul_CŞumn1
(5, 7)

1862 
	`Mul_CŞumn0
(6, 8)

1863 
	`Mul_CŞumn1
(7, 9)

1864 
	`Mul_CŞumn0
(8, 10)

1865 
	`Mul_CŞumn1
(9, 11)

1866 
	`Mul_CŞumn0
(10, 12)

1867 
	`Mul_CŞumn1
(11, 13)

1868 
	`Mul_CŞumn0
(12, 14)

1869 
	`Mul_CŞumn1
(13, 15)

1870 
	`BÙ_SaveAcc
(14è
	`BÙ_Acc
(16) Bot_Acc(15) Bot_Acc(14) Bot_Acc(13) Bot_Acc(12) Bot_Acc(11) Bot_Acc(10) Bot_Acc(9) Bot_Acc(8) Bot_Acc(7) Bot_Acc(6) Bot_Acc(5) Bot_Acc(4) Bot_Acc(3) Bot_Acc(2)

1871 
	`BÙ_End
(16)

1872 
	}
}

1874 
	$SSE2_MuÉlyTİ8
(
wÜd
 *
C
, cÚ¡ wÜd *
A
, cÚ¡ wÜd *
B
, wÜd 
L
)

1876 
	`Tİ_Begš
(4)

1877 
	`Tİ_Acc
(3) Top_Acc(2) Top_Acc(1)

1878 #iâdeà
__GNUC__


1879 
	`ASJ
Ğ
jmp
, 0, 
f
)

1880 
	`Mul_Acc
(4) Mul_Acc(3) Mul_Acc(2)

1881 
	`AS1
Ğ
»t
è
	`ASL
(0)

1883 
	`Tİ_CŞumn0
(4)

1884 
	`Tİ_CŞumn1
(3)

1885 
	`Mul_CŞumn0
(0, 2)

1886 
	`Tİ_End
(2)

1887 
	}
}

1889 
	$SSE2_MuÉlyTİ16
(
wÜd
 *
C
, cÚ¡ wÜd *
A
, cÚ¡ wÜd *
B
, wÜd 
L
)

1891 
	`Tİ_Begš
(8)

1892 
	`Tİ_Acc
(7) Top_Acc(6) Top_Acc(5) Top_Acc(4) Top_Acc(3) Top_Acc(2) Top_Acc(1)

1893 #iâdeà
__GNUC__


1894 
	`ASJ
Ğ
jmp
, 0, 
f
)

1895 
	`Mul_Acc
(8) Mul_Acc(7) Mul_Acc(6) Mul_Acc(5) Mul_Acc(4) Mul_Acc(3) Mul_Acc(2)

1896 
	`AS1
Ğ
»t
è
	`ASL
(0)

1898 
	`Tİ_CŞumn0
(8)

1899 
	`Tİ_CŞumn1
(7)

1900 
	`Mul_CŞumn0
(0, 6)

1901 
	`Mul_CŞumn1
(1, 5)

1902 
	`Mul_CŞumn0
(2, 4)

1903 
	`Mul_CŞumn1
(3, 3)

1904 
	`Mul_CŞumn0
(4, 2)

1905 
	`Tİ_End
(4)

1906 
	}
}

1908 
	$SSE2_MuÉlyTİ32
(
wÜd
 *
C
, cÚ¡ wÜd *
A
, cÚ¡ wÜd *
B
, wÜd 
L
)

1910 
	`Tİ_Begš
(16)

1911 
	`Tİ_Acc
(15) Top_Acc(14) Top_Acc(13) Top_Acc(12) Top_Acc(11) Top_Acc(10) Top_Acc(9) Top_Acc(8) Top_Acc(7) Top_Acc(6) Top_Acc(5) Top_Acc(4) Top_Acc(3) Top_Acc(2) Top_Acc(1)

1912 #iâdeà
__GNUC__


1913 
	`ASJ
Ğ
jmp
, 0, 
f
)

1914 
	`Mul_Acc
(16) Mul_Acc(15) Mul_Acc(14) Mul_Acc(13) Mul_Acc(12) Mul_Acc(11) Mul_Acc(10) Mul_Acc(9) Mul_Acc(8) Mul_Acc(7) Mul_Acc(6) Mul_Acc(5) Mul_Acc(4) Mul_Acc(3) Mul_Acc(2)

1915 
	`AS1
Ğ
»t
è
	`ASL
(0)

1917 
	`Tİ_CŞumn0
(16)

1918 
	`Tİ_CŞumn1
(15)

1919 
	`Mul_CŞumn0
(0, 14)

1920 
	`Mul_CŞumn1
(1, 13)

1921 
	`Mul_CŞumn0
(2, 12)

1922 
	`Mul_CŞumn1
(3, 11)

1923 
	`Mul_CŞumn0
(4, 10)

1924 
	`Mul_CŞumn1
(5, 9)

1925 
	`Mul_CŞumn0
(6, 8)

1926 
	`Mul_CŞumn1
(7, 7)

1927 
	`Mul_CŞumn0
(8, 6)

1928 
	`Mul_CŞumn1
(9, 5)

1929 
	`Mul_CŞumn0
(10, 4)

1930 
	`Mul_CŞumn1
(11, 3)

1931 
	`Mul_CŞumn0
(12, 2)

1932 
	`Tİ_End
(8)

1933 
	}
}

1939 (
	tCRYPTOPP_FASTCALL
 * 
	tPAdd
)(
	tsize_t
 
	tN
, 
	twÜd
 *
	tC
, cÚ¡ wÜd *
	tA
, cÚ¡ wÜd *
	tB
);

1940 (* 
	tPMul
)(
	twÜd
 *
	tC
, cÚ¡ wÜd *
	tA
, cÚ¡ wÜd *
	tB
);

1941 (* 
	tPSqu
)(
	twÜd
 *
	tC
, cÚ¡ wÜd *
	tA
);

1942 (* 
	tPMulTİ
)(
	twÜd
 *
	tC
, cÚ¡ wÜd *
	tA
, cÚ¡ wÜd *
	tB
, wÜd 
	tL
);

1944 #ià
CRYPTOPP_INTEGER_SSE2


1945 
PAdd
 
s_pAdd
 = &
Ba£lše_Add
, 
s_pSub
 = &
Ba£lše_Sub
;

1946 
size_t
 
s_»cursiÚLim™
 = 8;

1948 cÚ¡ 
size_t
 
s_»cursiÚLim™
 = 16;

1951 
PMul
 
s_pMul
[9], 
s_pBÙ
[9];

1952 
PSqu
 
s_pSqu
[9];

1953 
PMulTİ
 
s_pTİ
[9];

1955 
	$S‘FunùiÚPoš‹rs
()

1957 
s_pMul
[0] = &
Ba£lše_MuÉly2
;

1958 
s_pBÙ
[0] = &
Ba£lše_MuÉlyBÙtom2
;

1959 
s_pSqu
[0] = &
Ba£lše_Squ¬e2
;

1960 
s_pTİ
[0] = &
Ba£lše_MuÉlyTİ2
;

1961 
s_pTİ
[1] = &
Ba£lše_MuÉlyTİ4
;

1963 #ià
CRYPTOPP_INTEGER_SSE2


1964 ià(
	`HasSSE2
())

1966 #ià
_MSC_VER
 !ğ1200 || 
	`defšed
(
NDEBUG
)

1967 ià(
	`IsP4
())

1969 
s_pAdd
 = &
SSE2_Add
;

1970 
s_pSub
 = &
SSE2_Sub
;

1974 
s_»cursiÚLim™
 = 32;

1976 
s_pMul
[1] = &
SSE2_MuÉly4
;

1977 
s_pMul
[2] = &
SSE2_MuÉly8
;

1978 
s_pMul
[4] = &
SSE2_MuÉly16
;

1979 
s_pMul
[8] = &
SSE2_MuÉly32
;

1981 
s_pBÙ
[1] = &
SSE2_MuÉlyBÙtom4
;

1982 
s_pBÙ
[2] = &
SSE2_MuÉlyBÙtom8
;

1983 
s_pBÙ
[4] = &
SSE2_MuÉlyBÙtom16
;

1984 
s_pBÙ
[8] = &
SSE2_MuÉlyBÙtom32
;

1986 
s_pSqu
[1] = &
SSE2_Squ¬e4
;

1987 
s_pSqu
[2] = &
SSE2_Squ¬e8
;

1988 
s_pSqu
[4] = &
SSE2_Squ¬e16
;

1989 
s_pSqu
[8] = &
SSE2_Squ¬e32
;

1991 
s_pTİ
[2] = &
SSE2_MuÉlyTİ8
;

1992 
s_pTİ
[4] = &
SSE2_MuÉlyTİ16
;

1993 
s_pTİ
[8] = &
SSE2_MuÉlyTİ32
;

1998 
s_pMul
[1] = &
Ba£lše_MuÉly4
;

1999 
s_pMul
[2] = &
Ba£lše_MuÉly8
;

2001 
s_pBÙ
[1] = &
Ba£lše_MuÉlyBÙtom4
;

2002 
s_pBÙ
[2] = &
Ba£lše_MuÉlyBÙtom8
;

2004 
s_pSqu
[1] = &
Ba£lše_Squ¬e4
;

2005 
s_pSqu
[2] = &
Ba£lše_Squ¬e8
;

2007 
s_pTİ
[2] = &
Ba£lše_MuÉlyTİ8
;

2009 #if !
CRYPTOPP_INTEGER_SSE2


2010 
s_pMul
[4] = &
Ba£lše_MuÉly16
;

2011 
s_pBÙ
[4] = &
Ba£lše_MuÉlyBÙtom16
;

2012 
s_pSqu
[4] = &
Ba£lše_Squ¬e16
;

2013 
s_pTİ
[4] = &
Ba£lše_MuÉlyTİ16
;

2016 
	}
}

2018 
šlše
 
	$Add
(
wÜd
 *
C
, cÚ¡ wÜd *
A
, cÚ¡ wÜd *
B
, 
size_t
 
N
)

2020 #ià
CRYPTOPP_INTEGER_SSE2


2021  
	`s_pAdd
(
N
, 
C
, 
A
, 
B
);

2023  
	`Ba£lše_Add
(
N
, 
C
, 
A
, 
B
);

2025 
	}
}

2027 
šlše
 
	$SubŒaù
(
wÜd
 *
C
, cÚ¡ wÜd *
A
, cÚ¡ wÜd *
B
, 
size_t
 
N
)

2029 #ià
CRYPTOPP_INTEGER_SSE2


2030  
	`s_pSub
(
N
, 
C
, 
A
, 
B
);

2032  
	`Ba£lše_Sub
(
N
, 
C
, 
A
, 
B
);

2034 
	}
}

2039 
	#A0
 
A


	)

2040 
	#A1
 (
A
+
N2
)

	)

2041 
	#B0
 
B


	)

2042 
	#B1
 (
B
+
N2
)

	)

2044 
	#T0
 
T


	)

2045 
	#T1
 (
T
+
N2
)

	)

2046 
	#T2
 (
T
+
N
)

	)

2047 
	#T3
 (
T
+
N
+
N2
)

	)

2049 
	#R0
 
R


	)

2050 
	#R1
 (
R
+
N2
)

	)

2051 
	#R2
 (
R
+
N
)

	)

2052 
	#R3
 (
R
+
N
+
N2
)

	)

2059 
	$RecursiveMuÉly
(
wÜd
 *
R
, wÜd *
T
, cÚ¡ wÜd *
A
, cÚ¡ wÜd *
B
, 
size_t
 
N
)

2061 
	`as£¹
(
N
>=2 && N%2==0);

2063 ià(
N
 <ğ
s_»cursiÚLim™
)

2064 
s_pMul
[
N
/4](
R
, 
A
, 
B
);

2067 cÚ¡ 
size_t
 
N2
 = 
N
/2;

2069 
size_t
 
AN2
 = 
	`Com·»
(
A0
, 
A1
, 
N2
) > 0 ? 0 : N2;

2070 
	`SubŒaù
(
R0
, 
A
 + 
AN2
, A + (
N2
 ^ AN2), N2);

2072 
size_t
 
BN2
 = 
	`Com·»
(
B0
, 
B1
, 
N2
) > 0 ? 0 : N2;

2073 
	`SubŒaù
(
R1
, 
B
 + 
BN2
, B + (
N2
 ^ BN2), N2);

2075 
	`RecursiveMuÉly
(
R2
, 
T2
, 
A1
, 
B1
, 
N2
);

2076 
	`RecursiveMuÉly
(
T0
, 
T2
, 
R0
, 
R1
, 
N2
);

2077 
	`RecursiveMuÉly
(
R0
, 
T2
, 
A0
, 
B0
, 
N2
);

2081 
c2
 = 
	`Add
(
R2
, R2, 
R1
, 
N2
);

2082 
c3
 = 
c2
;

2083 
c2
 +ğ
	`Add
(
R1
, 
R2
, 
R0
, 
N2
);

2084 
c3
 +ğ
	`Add
(
R2
, R2, 
R3
, 
N2
);

2086 ià(
AN2
 =ğ
BN2
)

2087 
c3
 -ğ
	`SubŒaù
(
R1
, R1, 
T0
, 
N
);

2089 
c3
 +ğ
	`Add
(
R1
, R1, 
T0
, 
N
);

2091 
c3
 +ğ
	`Inüem’t
(
R2
, 
N2
, 
c2
);

2092 
	`as£¹
 (
c3
 >= 0 && c3 <= 2);

2093 
	`Inüem’t
(
R3
, 
N2
, 
c3
);

2095 
	}
}

2101 
	$RecursiveSqu¬e
(
wÜd
 *
R
, wÜd *
T
, cÚ¡ wÜd *
A
, 
size_t
 
N
)

2103 
	`as£¹
(
N
 && N%2==0);

2105 ià(
N
 <ğ
s_»cursiÚLim™
)

2106 
s_pSqu
[
N
/4](
R
, 
A
);

2109 cÚ¡ 
size_t
 
N2
 = 
N
/2;

2111 
	`RecursiveSqu¬e
(
R0
, 
T2
, 
A0
, 
N2
);

2112 
	`RecursiveSqu¬e
(
R2
, 
T2
, 
A1
, 
N2
);

2113 
	`RecursiveMuÉly
(
T0
, 
T2
, 
A0
, 
A1
, 
N2
);

2115 
ÿ¼y
 = 
	`Add
(
R1
, R1, 
T0
, 
N
);

2116 
ÿ¼y
 +ğ
	`Add
(
R1
, R1, 
T0
, 
N
);

2117 
	`Inüem’t
(
R3
, 
N2
, 
ÿ¼y
);

2119 
	}
}

2126 
	$RecursiveMuÉlyBÙtom
(
wÜd
 *
R
, wÜd *
T
, cÚ¡ wÜd *
A
, cÚ¡ wÜd *
B
, 
size_t
 
N
)

2128 
	`as£¹
(
N
>=2 && N%2==0);

2130 ià(
N
 <ğ
s_»cursiÚLim™
)

2131 
s_pBÙ
[
N
/4](
R
, 
A
, 
B
);

2134 cÚ¡ 
size_t
 
N2
 = 
N
/2;

2136 
	`RecursiveMuÉly
(
R
, 
T
, 
A0
, 
B0
, 
N2
);

2137 
	`RecursiveMuÉlyBÙtom
(
T0
, 
T1
, 
A1
, 
B0
, 
N2
);

2138 
	`Add
(
R1
, R1, 
T0
, 
N2
);

2139 
	`RecursiveMuÉlyBÙtom
(
T0
, 
T1
, 
A0
, 
B1
, 
N2
);

2140 
	`Add
(
R1
, R1, 
T0
, 
N2
);

2142 
	}
}

2150 
	$MuÉlyTİ
(
wÜd
 *
R
, wÜd *
T
, cÚ¡ wÜd *
L
, cÚ¡ wÜd *
A
, cÚ¡ wÜd *
B
, 
size_t
 
N
)

2152 
	`as£¹
(
N
>=2 && N%2==0);

2154 ià(
N
 <ğ
s_»cursiÚLim™
)

2155 
s_pTİ
[
N
/4](
R
, 
A
, 
B
, 
L
[N-1]);

2158 cÚ¡ 
size_t
 
N2
 = 
N
/2;

2160 
size_t
 
AN2
 = 
	`Com·»
(
A0
, 
A1
, 
N2
) > 0 ? 0 : N2;

2161 
	`SubŒaù
(
R0
, 
A
 + 
AN2
, A + (
N2
 ^ AN2), N2);

2163 
size_t
 
BN2
 = 
	`Com·»
(
B0
, 
B1
, 
N2
) > 0 ? 0 : N2;

2164 
	`SubŒaù
(
R1
, 
B
 + 
BN2
, B + (
N2
 ^ BN2), N2);

2166 
	`RecursiveMuÉly
(
T0
, 
T2
, 
R0
, 
R1
, 
N2
);

2167 
	`RecursiveMuÉly
(
R0
, 
T2
, 
A1
, 
B1
, 
N2
);

2171 
t
, 
c3
;

2172 
c2
 = 
	`SubŒaù
(
T2
, 
L
+
N2
, L, N2);

2174 ià(
AN2
 =ğ
BN2
)

2176 
c2
 -ğ
	`Add
(
T2
, T2, 
T0
, 
N2
);

2177 
t
 = (
	`Com·»
(
T2
, 
R0
, 
N2
) == -1);

2178 
c3
 = 
t
 - 
	`SubŒaù
(
T2
, T2, 
T1
, 
N2
);

2182 
c2
 +ğ
	`SubŒaù
(
T2
, T2, 
T0
, 
N2
);

2183 
t
 = (
	`Com·»
(
T2
, 
R0
, 
N2
) == -1);

2184 
c3
 = 
t
 + 
	`Add
(
T2
, T2, 
T1
, 
N2
);

2187 
c2
 +ğ
t
;

2188 ià(
c2
 >= 0)

2189 
c3
 +ğ
	`Inüem’t
(
T2
, 
N2
, 
c2
);

2191 
c3
 -ğ
	`Deüem’t
(
T2
, 
N2
, -
c2
);

2192 
c3
 +ğ
	`Add
(
R0
, 
T2
, 
R1
, 
N2
);

2194 
	`as£¹
 (
c3
 >= 0 && c3 <= 2);

2195 
	`Inüem’t
(
R1
, 
N2
, 
c3
);

2197 
	}
}

2199 
šlše
 
	$MuÉly
(
wÜd
 *
R
, wÜd *
T
, cÚ¡ wÜd *
A
, cÚ¡ wÜd *
B
, 
size_t
 
N
)

2201 
	`RecursiveMuÉly
(
R
, 
T
, 
A
, 
B
, 
N
);

2202 
	}
}

2204 
šlše
 
	$Squ¬e
(
wÜd
 *
R
, wÜd *
T
, cÚ¡ wÜd *
A
, 
size_t
 
N
)

2206 
	`RecursiveSqu¬e
(
R
, 
T
, 
A
, 
N
);

2207 
	}
}

2209 
šlše
 
	$MuÉlyBÙtom
(
wÜd
 *
R
, wÜd *
T
, cÚ¡ wÜd *
A
, cÚ¡ wÜd *
B
, 
size_t
 
N
)

2211 
	`RecursiveMuÉlyBÙtom
(
R
, 
T
, 
A
, 
B
, 
N
);

2212 
	}
}

2219 
	$Asymm‘ricMuÉly
(
wÜd
 *
R
, wÜd *
T
, cÚ¡ wÜd *
A
, 
size_t
 
NA
, cÚ¡ wÜd *
B
, size_ˆ
NB
)

2221 ià(
NA
 =ğ
NB
)

2223 ià(
A
 =ğ
B
)

2224 
	`Squ¬e
(
R
, 
T
, 
A
, 
NA
);

2226 
	`MuÉly
(
R
, 
T
, 
A
, 
B
, 
NA
);

2231 ià(
NA
 > 
NB
)

2233 
¡d
::
	`sw­
(
A
, 
B
);

2234 
¡d
::
	`sw­
(
NA
, 
NB
);

2237 
	`as£¹
(
NB
 % 
NA
 == 0);

2239 ià(
NA
==2 && !
A
[1])

2241 
A
[0])

2244 
	`S‘WÜds
(
R
, 0, 
NB
+2);

2247 
	`CİyWÜds
(
R
, 
B
, 
NB
);

2248 
R
[
NB
] = R[NB+1] = 0;

2251 
R
[
NB
] = 
	`Lš—rMuÉly
(R, 
B
, 
A
[0], NB);

2252 
R
[
NB
+1] = 0;

2257 
size_t
 
i
;

2258 ià((
NB
/
NA
)%2 == 0)

2260 
	`MuÉly
(
R
, 
T
, 
A
, 
B
, 
NA
);

2261 
	`CİyWÜds
(
T
+2*
NA
, 
R
+NA, NA);

2263 
i
=2*
NA
; i<
NB
; i+=2*NA)

2264 
	`MuÉly
(
T
+
NA
+
i
, T, 
A
, 
B
+i, NA);

2265 
i
=
NA
; i<
NB
; i+=2*NA)

2266 
	`MuÉly
(
R
+
i
, 
T
, 
A
, 
B
+i, 
NA
);

2270 
i
=0; i<
NB
; i+=2*
NA
)

2271 
	`MuÉly
(
R
+
i
, 
T
, 
A
, 
B
+i, 
NA
);

2272 
i
=
NA
; i<
NB
; i+=2*NA)

2273 
	`MuÉly
(
T
+
NA
+
i
, T, 
A
, 
B
+i, NA);

2276 ià(
	`Add
(
R
+
NA
, R+NA, 
T
+2*NA, 
NB
-NA))

2277 
	`Inüem’t
(
R
+
NB
, 
NA
);

2278 
	}
}

2284 
	$RecursiveInv”£ModPow”2
(
wÜd
 *
R
, wÜd *
T
, cÚ¡ wÜd *
A
, 
size_t
 
N
)

2286 ià(
N
==2)

2288 
T
[0] = 
	`AtomicInv”£ModPow”2
(
A
[0]);

2289 
T
[1] = 0;

2290 
s_pBÙ
[0](
T
+2, T, 
A
);

2291 
	`TwosCom¶em’t
(
T
+2, 2);

2292 
	`Inüem’t
(
T
+2, 2, 2);

2293 
s_pBÙ
[0](
R
, 
T
, T+2);

2297 cÚ¡ 
size_t
 
N2
 = 
N
/2;

2298 
	`RecursiveInv”£ModPow”2
(
R0
, 
T0
, 
A0
, 
N2
);

2299 
T0
[0] = 1;

2300 
	`S‘WÜds
(
T0
+1, 0, 
N2
-1);

2301 
	`MuÉlyTİ
(
R1
, 
T1
, 
T0
, 
R0
, 
A0
, 
N2
);

2302 
	`MuÉlyBÙtom
(
T0
, 
T1
, 
R0
, 
A1
, 
N2
);

2303 
	`Add
(
T0
, 
R1
, T0, 
N2
);

2304 
	`TwosCom¶em’t
(
T0
, 
N2
);

2305 
	`MuÉlyBÙtom
(
R1
, 
T1
, 
R0
, 
T0
, 
N2
);

2307 
	}
}

2315 
	$MÚtgom”yReduû
(
wÜd
 *
R
, wÜd *
T
, wÜd *
X
, cÚ¡ wÜd *
M
, cÚ¡ wÜd *
U
, 
size_t
 
N
)

2318 
	`MuÉlyBÙtom
(
R
, 
T
, 
X
, 
U
, 
N
);

2319 
	`MuÉlyTİ
(
T
, T+
N
, 
X
, 
R
, 
M
, N);

2320 
wÜd
 
bÜrow
 = 
	`SubŒaù
(
T
, 
X
+
N
, T, N);

2322 
wÜd
 
ÿ¼y
 = 
	`Add
(
T
+
N
, T, 
M
, N);

2323 
	`as£¹
(
ÿ¼y
 | !
bÜrow
);

2324 
	`CİyWÜds
(
R
, 
T
 + ((0-
bÜrow
è& 
N
), N);

2326 cÚ¡ 
wÜd
 
u
 = 0-
U
[0];

2327 
	`Deş¬e2WÜds
(
p
)

2328 
size_t
 
i
=0; i<
N
; i++)

2330 cÚ¡ 
wÜd
 
t
 = 
u
 * 
X
[
i
];

2331 
wÜd
 
c
 = 0;

2332 
size_t
 
j
=0; j<
N
; j+=2)

2334 
	`MuÉlyWÜds
(
p
, 
t
, 
M
[
j
]);

2335 
	`Acc2WÜdsBy1
(
p
, 
X
[
i
+
j
]);

2336 
	`Acc2WÜdsBy1
(
p
, 
c
);

2337 
X
[
i
+
j
] = 
	`LowWÜd
(
p
);

2338 
c
 = 
	`HighWÜd
(
p
);

2339 
	`MuÉlyWÜds
(
p
, 
t
, 
M
[
j
+1]);

2340 
	`Acc2WÜdsBy1
(
p
, 
X
[
i
+
j
+1]);

2341 
	`Acc2WÜdsBy1
(
p
, 
c
);

2342 
X
[
i
+
j
+1] = 
	`LowWÜd
(
p
);

2343 
c
 = 
	`HighWÜd
(
p
);

2346 ià(
	`Inüem’t
(
X
+
N
+
i
, N-i, 
c
))

2347 !
	`SubŒaù
(
X
+
N
, X+N, 
M
, N)) {}

2350 
	`memıy
(
R
, 
X
+
N
, N*
WORD_SIZE
);

2352 
__m64
 
u
 = 
	`_mm_cvtsi32_si64
(0-
U
[0]), 
p
;

2353 
size_t
 
i
=0; i<
N
; i++)

2355 
__m64
 
t
 = 
	`_mm_cvtsi32_si64
(
X
[
i
]);

2356 
t
 = 
	`_mm_mul_su32
Ñ, 
u
);

2357 
__m64
 
c
 = 
	`_mm_£tz”o_si64
();

2358 
size_t
 
j
=0; j<
N
; j+=2)

2360 
p
 = 
	`_mm_mul_su32
(
t
, 
	`_mm_cvtsi32_si64
(
M
[
j
]));

2361 
p
 = 
	`_mm_add_si64
Õ, 
	`_mm_cvtsi32_si64
(
X
[
i
+
j
]));

2362 
c
 = 
	`_mm_add_si64
(c, 
p
);

2363 
X
[
i
+
j
] = 
	`_mm_cvtsi64_si32
(
c
);

2364 
c
 = 
	`_mm_¤li_si64
(c, 32);

2365 
p
 = 
	`_mm_mul_su32
(
t
, 
	`_mm_cvtsi32_si64
(
M
[
j
+1]));

2366 
p
 = 
	`_mm_add_si64
Õ, 
	`_mm_cvtsi32_si64
(
X
[
i
+
j
+1]));

2367 
c
 = 
	`_mm_add_si64
(c, 
p
);

2368 
X
[
i
+
j
+1] = 
	`_mm_cvtsi64_si32
(
c
);

2369 
c
 = 
	`_mm_¤li_si64
(c, 32);

2372 ià(
	`Inüem’t
(
X
+
N
+
i
, N-i, 
	`_mm_cvtsi64_si32
(
c
)))

2373 !
	`SubŒaù
(
X
+
N
, X+N, 
M
, N)) {}

2376 
	`memıy
(
R
, 
X
+
N
, N*
WORD_SIZE
);

2377 
	`_mm_em±y
();

2379 
	}
}

2388 
	$H®fMÚtgom”yReduû
(
wÜd
 *
R
, wÜd *
T
, cÚ¡ wÜd *
X
, cÚ¡ wÜd *
M
, cÚ¡ wÜd *
U
, cÚ¡ wÜd *
V
, 
size_t
 
N
)

2390 
	`as£¹
(
N
%2==0 && N>=4);

2392 
	#M0
 
M


	)

2393 
	#M1
 (
M
+
N2
)

	)

2394 
	#V0
 
V


	)

2395 
	#V1
 (
V
+
N2
)

	)

2397 
	#X0
 
X


	)

2398 
	#X1
 (
X
+
N2
)

	)

2399 
	#X2
 (
X
+
N
)

	)

2400 
	#X3
 (
X
+
N
+
N2
)

	)

2402 cÚ¡ 
size_t
 
N2
 = 
N
/2;

2403 
	`MuÉly
(
T0
, 
T2
, 
V0
, 
X3
, 
N2
);

2404 
c2
 = 
	`Add
(
T0
, T0, 
X0
, 
N
);

2405 
	`MuÉlyBÙtom
(
T3
, 
T2
, 
T0
, 
U
, 
N2
);

2406 
	`MuÉlyTİ
(
T2
, 
R
, 
T0
, 
T3
, 
M0
, 
N2
);

2407 
c2
 -ğ
	`SubŒaù
(
T2
, 
T1
, T2, 
N2
);

2408 
	`MuÉly
(
T0
, 
R
, 
T3
, 
M1
, 
N2
);

2409 
c2
 -ğ
	`SubŒaù
(
T0
, 
T2
, T0, 
N2
);

2410 
c3
 = -()
	`SubŒaù
(
T1
, 
X2
, T1, 
N2
);

2411 
	`MuÉly
(
R0
, 
T2
, 
V1
, 
X3
, 
N2
);

2412 
c3
 +ğ
	`Add
(
R
, R, 
T
, 
N
);

2414 ià(
c2
>0)

2415 
c3
 +ğ
	`Inüem’t
(
R1
, 
N2
);

2416 ià(
c2
<0)

2417 
c3
 -ğ
	`Deüem’t
(
R1
, 
N2
, -
c2
);

2419 
	`as£¹
(
c3
>=-1 && c3<=1);

2420 ià(
c3
>0)

2421 
	`SubŒaù
(
R
, R, 
M
, 
N
);

2422 ià(
c3
<0)

2423 
	`Add
(
R
, R, 
M
, 
N
);

2425 #undeà
M0


2426 #undeà
M1


2427 #undeà
V0


2428 #undeà
V1


2430 #undeà
X0


2431 #undeà
X1


2432 #undeà
X2


2433 #undeà
X3


2434 
	}
}

2436 #undeà
A0


2437 #undeà
A1


2438 #undeà
B0


2439 #undeà
B1


2441 #undeà
T0


2442 #undeà
T1


2443 #undeà
T2


2444 #undeà
T3


2446 #undeà
R0


2447 #undeà
R1


2448 #undeà
R2


2449 #undeà
R3


2515 
šlše
 
	$AtomicDivide
(
wÜd
 *
Q
, cÚ¡ wÜd *
A
, cÚ¡ wÜd *
B
)

2517 
wÜd
 
T
[4];

2518 
DWÜd
 
q
 = 
DivideFourWÜdsByTwo
<
wÜd
, DWÜd>(
T
, 
	`DWÜd
(
A
[0], A[1]), DWÜd(A[2], A[3]), DWÜd(
B
[0], B[1]));

2519 
Q
[0] = 
q
.
	`G‘LowH®f
();

2520 
Q
[1] = 
q
.
	`G‘HighH®f
();

2522 #iâdeà
NDEBUG


2523 ià(
B
[0] || B[1])

2526 
	`as£¹
(!
T
[2] && !T[3] && (T[1] < 
B
[1] || (T[1]==B[1] && T[0]<B[0])));

2527 
wÜd
 
P
[4];

2528 
s_pMul
[0](
P
, 
Q
, 
B
);

2529 
	`Add
(
P
, P, 
T
, 4);

2530 
	`as£¹
(
	`memcmp
(
P
, 
A
, 4*
WORD_SIZE
)==0);

2533 
	}
}

2536 
	$CÜ»ùQuÙ›ÁE¡im©e
(
wÜd
 *
R
, wÜd *
T
, wÜd *
Q
, cÚ¡ wÜd *
B
, 
size_t
 
N
)

2538 
	`as£¹
(
N
 && N%2==0);

2540 
	`Asymm‘ricMuÉly
(
T
, T+
N
+2, 
Q
, 2, 
B
, N);

2542 
wÜd
 
bÜrow
 = 
	`SubŒaù
(
R
, R, 
T
, 
N
+2);

2543 
	`as£¹
(!
bÜrow
 && !
R
[
N
+1]);

2545 
R
[
N
] || 
	`Com·»
(R, 
B
, N) >= 0)

2547 
R
[
N
] -ğ
	`SubŒaù
(R, R, 
B
, N);

2548 
Q
[1] += (++Q[0]==0);

2549 
	`as£¹
(
Q
[0] || Q[1]);

2551 
	}
}

2559 
	$Divide
(
wÜd
 *
R
, wÜd *
Q
, wÜd *
T
, cÚ¡ wÜd *
A
, 
size_t
 
NA
, cÚ¡ wÜd *
B
, size_ˆ
NB
)

2561 
	`as£¹
(
NA
 && 
NB
 && NA%2==0 && NB%2==0);

2562 
	`as£¹
(
B
[
NB
-1] || B[NB-2]);

2563 
	`as£¹
(
NB
 <ğ
NA
);

2566 
wÜd
 *cÚ¡ 
TA
=
T
;

2567 
wÜd
 *cÚ¡ 
TB
=
T
+
NA
+2;

2568 
wÜd
 *cÚ¡ 
TP
=
T
+
NA
+2+
NB
;

2571 
shiáWÜds
 = (
B
[
NB
-1]==0);

2572 
TB
[0] = TB[
NB
-1] = 0;

2573 
	`CİyWÜds
(
TB
+
shiáWÜds
, 
B
, 
NB
-shiftWords);

2574 
shiáB™s
 = 
WORD_BITS
 - 
	`B™P»cisiÚ
(
TB
[
NB
-1]);

2575 
	`as£¹
(
shiáB™s
 < 
WORD_BITS
);

2576 
	`ShiáWÜdsLeáByB™s
(
TB
, 
NB
, 
shiáB™s
);

2579 
TA
[0] = TA[
NA
] = TA[NA+1] = 0;

2580 
	`CİyWÜds
(
TA
+
shiáWÜds
, 
A
, 
NA
);

2581 
	`ShiáWÜdsLeáByB™s
(
TA
, 
NA
+2, 
shiáB™s
);

2583 ià(
TA
[
NA
+1]==0 && TA[NA] <= 1)

2585 
Q
[
NA
-
NB
+1] = Q[NA-NB] = 0;

2586 
TA
[
NA
] || 
	`Com·»
(TA+NA-
NB
, 
TB
, NB) >= 0)

2588 
TA
[
NA
] -ğ
	`SubŒaù
(TA+NA-
NB
, TA+NA-NB, 
TB
, NB);

2589 ++
Q
[
NA
-
NB
];

2594 
NA
+=2;

2595 
	`as£¹
(
	`Com·»
(
TA
+
NA
-
NB
, 
TB
, NB) < 0);

2598 
wÜd
 
BT
[2];

2599 
BT
[0] = 
TB
[
NB
-2] + 1;

2600 
BT
[1] = 
TB
[
NB
-1] + (BT[0]==0);

2603 
size_t
 
i
=
NA
-2; i>=
NB
; i-=2)

2605 
	`AtomicDivide
(
Q
+
i
-
NB
, 
TA
+i-2, 
BT
);

2606 
	`CÜ»ùQuÙ›ÁE¡im©e
(
TA
+
i
-
NB
, 
TP
, 
Q
+i-NB, 
TB
, NB);

2610 
	`CİyWÜds
(
R
, 
TA
+
shiáWÜds
, 
NB
);

2611 
	`ShiáWÜdsRightByB™s
(
R
, 
NB
, 
shiáB™s
);

2612 
	}
}

2614 
šlše
 
size_t
 
	$Ev’WÜdCouÁ
(cÚ¡ 
wÜd
 *
X
, 
size_t
 
N
)

2616 
N
 && 
X
[N-2]==0 && X[N-1]==0)

2617 
N
-=2;

2618  
N
;

2619 
	}
}

2627 
	$Almo¡Inv”£
(
wÜd
 *
R
, wÜd *
T
, cÚ¡ wÜd *
A
, 
size_t
 
NA
, cÚ¡ wÜd *
M
, size_ˆ
N
)

2629 
	`as£¹
(
NA
<=
N
 && N && N%2==0);

2631 
wÜd
 *
b
 = 
T
;

2632 
wÜd
 *
c
 = 
T
+
N
;

2633 
wÜd
 *
f
 = 
T
+2*
N
;

2634 
wÜd
 *
g
 = 
T
+3*
N
;

2635 
size_t
 
bcL’
=2, 
fgL’
=
	`Ev’WÜdCouÁ
(
M
, 
N
);

2636 
k
=0;

2637 
boŞ
 
s
=
çl£
;

2639 
	`S‘WÜds
(
T
, 0, 3*
N
);

2640 
b
[0]=1;

2641 
	`CİyWÜds
(
f
, 
A
, 
NA
);

2642 
	`CİyWÜds
(
g
, 
M
, 
N
);

2646 
wÜd
 
t
=
f
[0];

2647 !
t
)

2649 ià(
	`Ev’WÜdCouÁ
(
f
, 
fgL’
)==0)

2651 
	`S‘WÜds
(
R
, 0, 
N
);

2655 
	`ShiáWÜdsRightByWÜds
(
f
, 
fgL’
, 1);

2656 
bcL’
 +ğ2 * (
c
[bcLen-1] != 0);

2657 
	`as£¹
(
bcL’
 <ğ
N
);

2658 
	`ShiáWÜdsLeáByWÜds
(
c
, 
bcL’
, 1);

2659 
k
+=
WORD_BITS
;

2660 
t
=
f
[0];

2663 
i
 = 
	`T¿šgZ”os
(
t
);

2664 
t
 >>ğ
i
;

2665 
k
 +ğ
i
;

2667 ià(
t
==1 && 
f
[1]==0 && 
	`Ev’WÜdCouÁ
(f+2, 
fgL’
-2)==0)

2669 ià(
s
)

2670 
	`SubŒaù
(
R
, 
M
, 
b
, 
N
);

2672 
	`CİyWÜds
(
R
, 
b
, 
N
);

2673  
k
;

2676 
	`ShiáWÜdsRightByB™s
(
f
, 
fgL’
, 
i
);

2677 
t
 = 
	`ShiáWÜdsLeáByB™s
(
c
, 
bcL’
, 
i
);

2678 
c
[
bcL’
] +ğ
t
;

2679 
bcL’
 +ğ2 * (
t
!=0);

2680 
	`as£¹
(
bcL’
 <ğ
N
);

2682 
boŞ
 
sw­
 = 
	`Com·»
(
f
, 
g
, 
fgL’
)==-1;

2683 
	`CÚd™iÚ®Sw­Poš‹rs
(
sw­
, 
f
, 
g
);

2684 
	`CÚd™iÚ®Sw­Poš‹rs
(
sw­
, 
b
, 
c
);

2685 
s
 ^ğ
sw­
;

2687 
fgL’
 -ğ2 * !(
f
[fgLen-2] | f[fgLen-1]);

2689 
	`SubŒaù
(
f
, f, 
g
, 
fgL’
);

2690 
t
 = 
	`Add
(
b
, b, 
c
, 
bcL’
);

2691 
b
[
bcL’
] +ğ
t
;

2692 
bcL’
 +ğ2*
t
;

2693 
	`as£¹
(
bcL’
 <ğ
N
);

2695 
	}
}

2701 
	$DivideByPow”2Mod
(
wÜd
 *
R
, cÚ¡ wÜd *
A
, 
size_t
 
k
, cÚ¡ wÜd *
M
, size_ˆ
N
)

2703 
	`CİyWÜds
(
R
, 
A
, 
N
);

2705 
k
--)

2707 ià(
R
[0]%2==0)

2708 
	`ShiáWÜdsRightByB™s
(
R
, 
N
, 1);

2711 
wÜd
 
ÿ¼y
 = 
	`Add
(
R
, R, 
M
, 
N
);

2712 
	`ShiáWÜdsRightByB™s
(
R
, 
N
, 1);

2713 
R
[
N
-1] +ğ
ÿ¼y
<<(
WORD_BITS
-1);

2716 
	}
}

2722 
	$MuÉlyByPow”2Mod
(
wÜd
 *
R
, cÚ¡ wÜd *
A
, 
size_t
 
k
, cÚ¡ wÜd *
M
, size_ˆ
N
)

2724 
	`CİyWÜds
(
R
, 
A
, 
N
);

2726 
k
--)

2727 ià(
	`ShiáWÜdsLeáByB™s
(
R
, 
N
, 1è|| 
	`Com·»
(R, 
M
, N)>=0)

2728 
	`SubŒaù
(
R
, R, 
M
, 
N
);

2729 
	}
}

2733 
	gIn™ŸlizeIÁeg”
::
	$In™ŸlizeIÁeg”
()

2735 ià(!
g_pAssignIÁToIÁeg”
)

2737 
	`S‘FunùiÚPoš‹rs
();

2738 
g_pAssignIÁToIÁeg”
 = 
AssignIÁToIÁeg”
;

2740 
	}
}

2742 cÚ¡ 
	gRoundupSizeTabË
[] = {2, 2, 2, 4, 4, 8, 8, 8, 8};

2744 
šlše
 
size_t
 
	$RoundupSize
(
size_t
 
n
)

2746 ià(
n
<=8)

2747  
RoundupSizeTabË
[
n
];

2748 ià(
n
<=16)

2750 ià(
n
<=32)

2752 ià(
n
<=64)

2754  
	`size_t
(1è<< 
	`B™P»cisiÚ
(
n
-1);

2755 
	}
}

2757 
	gIÁeg”
::
	$IÁeg”
()

2758 : 
	`»g
(2), 
	$sign
(
POSITIVE
)

2760 
»g
[0] =„eg[1] = 0;

2761 
	}
}

2763 
	gIÁeg”
::
	$IÁeg”
(cÚ¡ 
IÁeg”
& 
t
)

2764 : 
	`»g
(
	`RoundupSize
(
t
.
	`WÜdCouÁ
())), 
	$sign
(
t
.
sign
)

2766 
	`CİyWÜds
(
»g
, 
t
.»g,„eg.
	`size
());

2767 
	}
}

2769 
	gIÁeg”
::
	$IÁeg”
(
Sign
 
s
, 
lwÜd
 
v®ue
)

2770 : 
	`»g
(2), 
	$sign
(
s
)

2772 
»g
[0] = 
	`wÜd
(
v®ue
);

2773 
»g
[1] = 
	`wÜd
(
SaãRightShiá
<
WORD_BITS
>(
v®ue
));

2774 
	}
}

2776 
	gIÁeg”
::
	$IÁeg”
(sigÃd 
v®ue
)

2777 : 
	$»g
(2)

2779 ià(
v®ue
 >= 0)

2780 
sign
 = 
POSITIVE
;

2783 
sign
 = 
NEGATIVE
;

2784 
v®ue
 = -value;

2786 
»g
[0] = 
	`wÜd
(
v®ue
);

2787 
»g
[1] = 
	`wÜd
(
SaãRightShiá
<
WORD_BITS
>(()
v®ue
));

2788 
	}
}

2790 
	gIÁeg”
::
	$IÁeg”
(
Sign
 
s
, 
wÜd
 
high
, wÜd 
low
)

2791 : 
	`»g
(2), 
	$sign
(
s
)

2793 
»g
[0] = 
low
;

2794 
»g
[1] = 
high
;

2795 
	}
}

2797 
boŞ
 
	gIÁeg”
::
	$IsCÚv”bËToLÚg
() const

2799 ià(
	`By‹CouÁ
() > ())

2800  
çl£
;

2802 
v®ue
 = ()
»g
[0];

2803 
v®ue
 +ğ
SaãLeáShiá
<
WORD_BITS
, >(()
»g
[1]);

2805 ià(
sign
==
POSITIVE
)

2806  (sigÃd )
v®ue
 >= 0;

2808  -(sigÃd )
v®ue
 < 0;

2809 
	}
}

2811 sigÃd 
	gIÁeg”
::
	$CÚv”tToLÚg
() const

2813 
	`as£¹
(
	`IsCÚv”bËToLÚg
());

2815 
v®ue
 = ()
»g
[0];

2816 
v®ue
 +ğ
SaãLeáShiá
<
WORD_BITS
, >(()
»g
[1]);

2817  
sign
==
POSITIVE
 ? 
v®ue
 : -(signed )value;

2818 
	}
}

2820 
	gIÁeg”
::
	$IÁeg”
(
Bufã»dT¿nsfÜm©iÚ
 &
’codedIÁeg”
, 
size_t
 
by‹CouÁ
, 
SigÃdÃss
 
s
)

2822 
	`Decode
(
’codedIÁeg”
, 
by‹CouÁ
, 
s
);

2823 
	}
}

2825 
	gIÁeg”
::
	$IÁeg”
(cÚ¡ 
by‹
 *
’codedIÁeg”
, 
size_t
 
by‹CouÁ
, 
SigÃdÃss
 
s
)

2827 
	`Decode
(
’codedIÁeg”
, 
by‹CouÁ
, 
s
);

2828 
	}
}

2830 
	gIÁeg”
::
	$IÁeg”
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
)

2832 
	`BERDecode
(
bt
);

2833 
	}
}

2835 
	gIÁeg”
::
	$IÁeg”
(
RªdomNumb”G’”©Ü
 &
ºg
, 
size_t
 
b™couÁ
)

2837 
	`Rªdomize
(
ºg
, 
b™couÁ
);

2838 
	}
}

2840 
	gIÁeg”
::
	$IÁeg”
(
RªdomNumb”G’”©Ü
 &
ºg
, cÚ¡ 
IÁeg”
 &
mš
, cÚ¡ IÁeg” &
max
, 
RªdomNumb”Ty³
 
ºTy³
, cÚ¡ IÁeg” &
equiv
, cÚ¡ IÁeg” &
mod
)

2842 ià(!
	`Rªdomize
(
ºg
, 
mš
, 
max
, 
ºTy³
, 
equiv
, 
mod
))

2843 
throw
 
IÁeg”
::
	`RªdomNumb”NÙFound
();

2844 
	}
}

2846 
IÁeg”
 
	gIÁeg”
::
	$Pow”2
(
size_t
 
e
)

2848 
IÁeg”
 
	`r
((
wÜd
)0, 
	`B™sToWÜds
(
e
+1));

2849 
r
.
	`S‘B™
(
e
);

2850  
r
;

2851 
	}
}

2853 
	g‹m¶©e
 <
	gi
>

2854 
	sNewIÁeg”


2856 
IÁeg”
 * 
İ”©Ü
()() const

2858  
Ãw
 
IÁeg”
(
i
);

2862 cÚ¡ 
	gIÁeg”
 &IÁeg”::
	$Z”o
()

2864  
SšgËtÚ
<
IÁeg”
>().
	`Ref
();

2865 
	}
}

2867 cÚ¡ 
	gIÁeg”
 &IÁeg”::
	$OÃ
()

2869  
SšgËtÚ
<
IÁeg”
, 
NewIÁeg”
<1> >().
	`Ref
();

2870 
	}
}

2872 cÚ¡ 
	gIÁeg”
 &IÁeg”::
	$Two
()

2874  
SšgËtÚ
<
IÁeg”
, 
NewIÁeg”
<2> >().
	`Ref
();

2875 
	}
}

2877 
boŞ
 
	gIÁeg”
::
İ”©Ü
!() const

2879  
IsNeg©ive
(è? 
çl£
 : (
»g
[0]==0 && 
WÜdCouÁ
()==0);

2882 
	gIÁeg”
& IÁeg”::
İ”©Ü
=(cÚ¡ 
IÁeg”
& 
t
)

2884 ià(
this
 !ğ&
t
)

2886 ià(
»g
.
size
(è!ğ
t
.reg.size() ||.reg[t.reg.size()/2] == 0)

2887 
»g
.
New
(
RoundupSize
(
t
.
WÜdCouÁ
()));

2888 
CİyWÜds
(
»g
, 
t
.»g,„eg.
size
());

2889 
	gsign
 = 
t
.
sign
;

2891  *
	gthis
;

2894 
boŞ
 
	gIÁeg”
::
	$G‘B™
(
size_t
 
n
) const

2896 ià(
n
/
WORD_BITS
 >ğ
»g
.
	`size
())

2899  
	`boŞ
((
»g
[
n
/
WORD_BITS
] >> (n % WORD_BITS)) & 1);

2900 
	}
}

2902 
	gIÁeg”
::
	$S‘B™
(
size_t
 
n
, 
boŞ
 
v®ue
)

2904 ià(
v®ue
)

2906 
»g
.
	`CËªGrow
(
	`RoundupSize
(
	`B™sToWÜds
(
n
+1)));

2907 
»g
[
n
/
WORD_BITS
] |ğ(
	`wÜd
(1) << (n%WORD_BITS));

2911 ià(
n
/
WORD_BITS
 < 
»g
.
	`size
())

2912 
»g
[
n
/
WORD_BITS
] &ğ~(
	`wÜd
(1) << (n%WORD_BITS));

2914 
	}
}

2916 
by‹
 
	gIÁeg”
::
	$G‘By‹
(
size_t
 
n
) const

2918 ià(
n
/
WORD_SIZE
 >ğ
»g
.
	`size
())

2921  
	`by‹
(
»g
[
n
/
WORD_SIZE
] >> ((n%WORD_SIZE)*8));

2922 
	}
}

2924 
	gIÁeg”
::
	$S‘By‹
(
size_t
 
n
, 
by‹
 
v®ue
)

2926 
»g
.
	`CËªGrow
(
	`RoundupSize
(
	`By‹sToWÜds
(
n
+1)));

2927 
»g
[
n
/
WORD_SIZE
] &ğ~(
	`wÜd
(0xff) << 8*(n%WORD_SIZE));

2928 
»g
[
n
/
WORD_SIZE
] |ğ(
	`wÜd
(
v®ue
) << 8*(n%WORD_SIZE));

2929 
	}
}

2931 
lwÜd
 
	gIÁeg”
::
	$G‘B™s
(
size_t
 
i
, size_ˆ
n
) const

2933 
lwÜd
 
v
 = 0;

2934 
	`as£¹
(
n
 <ğ(
v
)*8);

2935 
j
=0; j<
n
; j++)

2936 
v
 |ğ
	`lwÜd
(
	`G‘B™
(
i
+
j
)) << j;

2937  
v
;

2938 
	}
}

2940 
IÁeg”
 
	gIÁeg”
::
İ”©Ü
-() const

2942 
IÁeg”
 
»suÉ
(*
this
);

2943 
	g»suÉ
.
Neg©e
();

2944  
	g»suÉ
;

2947 
IÁeg”
 
	gIÁeg”
::
	$AbsŞu‹V®ue
() const

2949 
IÁeg”
 
	`»suÉ
(*
this
);

2950 
»suÉ
.
sign
 = 
POSITIVE
;

2951  
»suÉ
;

2952 
	}
}

2954 
	gIÁeg”
::
	$sw­
(
IÁeg”
 &
a
)

2956 
»g
.
	`sw­
(
a
.reg);

2957 
¡d
::
	`sw­
(
sign
, 
a
.sign);

2958 
	}
}

2960 
	gIÁeg”
::
	$IÁeg”
(
wÜd
 
v®ue
, 
size_t
 
Ëngth
)

2961 : 
	`»g
(
	`RoundupSize
(
Ëngth
)), 
	$sign
(
POSITIVE
)

2963 
»g
[0] = 
v®ue
;

2964 
	`S‘WÜds
(
»g
+1, 0,„eg.
	`size
()-1);

2965 
	}
}

2967 
	g‹m¶©e
 <
şass
 
	gT
>

2968 
IÁeg”
 
	$SŒšgToIÁeg”
(cÚ¡ 
T
 *
¡r
)

2970 
¿dix
;

2973 
Ëngth
;

2974 
Ëngth
 = 0; 
¡r
[length] != 0;†ength++) {}

2976 
IÁeg”
 
v
;

2978 ià(
Ëngth
 == 0)

2979  
v
;

2981 
¡r
[
Ëngth
-1])

2985 
¿dix
=16;

2989 
¿dix
=8;

2993 
¿dix
=2;

2996 
¿dix
=10;

2999 ià(
Ëngth
 > 2 && 
¡r
[0] == '0' && str[1] == 'x')

3000 
¿dix
 = 16;

3002 
i
=0; i<
Ëngth
; i++)

3004 
dig™
;

3006 ià(
¡r
[
i
] >= '0' && str[i] <= '9')

3007 
dig™
 = 
¡r
[
i
] - '0';

3008 ià(
¡r
[
i
] >= 'A' && str[i] <= 'F')

3009 
dig™
 = 
¡r
[
i
] - 'A' + 10;

3010 ià(
¡r
[
i
] >= 'a' && str[i] <= 'f')

3011 
dig™
 = 
¡r
[
i
] - 'a' + 10;

3013 
dig™
 = 
¿dix
;

3015 ià(
dig™
 < 
¿dix
)

3017 
v
 *ğ
¿dix
;

3018 
v
 +ğ
dig™
;

3022 ià(
¡r
[0] == '-')

3023 
v
.
	`Neg©e
();

3025  
v
;

3026 
	}
}

3028 
	gIÁeg”
::
	$IÁeg”
(cÚ¡ *
¡r
)

3029 : 
	`»g
(2), 
	$sign
(
POSITIVE
)

3031 *
this
 = 
	`SŒšgToIÁeg”
(
¡r
);

3032 
	}
}

3034 
	gIÁeg”
::
	$IÁeg”
(cÚ¡ 
wch¬_t
 *
¡r
)

3035 : 
	`»g
(2), 
	$sign
(
POSITIVE
)

3037 *
this
 = 
	`SŒšgToIÁeg”
(
¡r
);

3038 
	}
}

3040 
	gIÁeg”
::
	$WÜdCouÁ
() const

3042  ()
	`CouÁWÜds
(
»g
,„eg.
	`size
());

3043 
	}
}

3045 
	gIÁeg”
::
	$By‹CouÁ
() const

3047 
wÜdCouÁ
 = 
	`WÜdCouÁ
();

3048 ià(
wÜdCouÁ
)

3049  (
wÜdCouÁ
-1)*
WORD_SIZE
 + 
	`By‹P»cisiÚ
(
»g
[wordCount-1]);

3052 
	}
}

3054 
	gIÁeg”
::
	$B™CouÁ
() const

3056 
wÜdCouÁ
 = 
	`WÜdCouÁ
();

3057 ià(
wÜdCouÁ
)

3058  (
wÜdCouÁ
-1)*
WORD_BITS
 + 
	`B™P»cisiÚ
(
»g
[wordCount-1]);

3061 
	}
}

3063 
	gIÁeg”
::
	$Decode
(cÚ¡ 
by‹
 *
šput
, 
size_t
 
šputL’
, 
SigÃdÃss
 
s
)

3065 
SŒšgStÜe
 
	`¡Üe
(
šput
, 
šputL’
);

3066 
	`Decode
(
¡Üe
, 
šputL’
, 
s
);

3067 
	}
}

3069 
	gIÁeg”
::
	$Decode
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
, 
size_t
 
šputL’
, 
SigÃdÃss
 
s
)

3071 
	`as£¹
(
bt
.
	`MaxR‘r›vabË
(è>ğ
šputL’
);

3073 
by‹
 
b
;

3074 
bt
.
	`P“k
(
b
);

3075 
sign
 = ((
s
==
SIGNED
è&& (
b
 & 0x80)è? 
NEGATIVE
 : 
POSITIVE
;

3077 
šputL’
>0 && (
sign
==
POSITIVE
 ? 
b
==0 : b==0xff))

3079 
bt
.
	`Sk
(1);

3080 
šputL’
--;

3081 
bt
.
	`P“k
(
b
);

3084 
»g
.
	`CËªNew
(
	`RoundupSize
(
	`By‹sToWÜds
(
šputL’
)));

3086 
size_t
 
i
=
šputL’
; i > 0; i--)

3088 
bt
.
	`G‘
(
b
);

3089 
»g
[(
i
-1)/
WORD_SIZE
] |ğ
	`wÜd
(
b
) << ((i-1)%WORD_SIZE)*8;

3092 ià(
sign
 =ğ
NEGATIVE
)

3094 
size_t
 
i
=
šputL’
; i<
»g
.
	`size
()*
WORD_SIZE
; i++)

3095 
»g
[
i
/
WORD_SIZE
] |ğ
	`wÜd
(0xff) << (i%WORD_SIZE)*8;

3096 
	`TwosCom¶em’t
(
»g
,„eg.
	`size
());

3098 
	}
}

3100 
size_t
 
	gIÁeg”
::
	$MšEncodedSize
(
SigÃdÃss
 
sigÃdÃss
) const

3102 
ouutL’
 = 
	`STDMAX
(1U, 
	`By‹CouÁ
());

3103 ià(
sigÃdÃss
 =ğ
UNSIGNED
)

3104  
ouutL’
;

3105 ià(
	`NÙNeg©ive
(è&& (
	`G‘By‹
(
ouutL’
-1) & 0x80))

3106 
ouutL’
++;

3107 ià(
	`IsNeg©ive
(è&& *
this
 < -
	`Pow”2
(
ouutL’
*8-1))

3108 
ouutL’
++;

3109  
ouutL’
;

3110 
	}
}

3112 
	gIÁeg”
::
	$Encode
(
by‹
 *
ouut
, 
size_t
 
ouutL’
, 
SigÃdÃss
 
sigÃdÃss
) const

3114 
A¼aySšk
 
	`sšk
(
ouut
, 
ouutL’
);

3115 
	`Encode
(
sšk
, 
ouutL’
, 
sigÃdÃss
);

3116 
	}
}

3118 
	gIÁeg”
::
	$Encode
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
, 
size_t
 
ouutL’
, 
SigÃdÃss
 
sigÃdÃss
) const

3120 ià(
sigÃdÃss
 =ğ
UNSIGNED
 || 
	`NÙNeg©ive
())

3122 
size_t
 
i
=
ouutL’
; i > 0; i--)

3123 
bt
.
	`Put
(
	`G‘By‹
(
i
-1));

3128 
IÁeg”
 
‹mp
 = IÁeg”::
	`Pow”2
(8*
	`STDMAX
((
size_t
)
	`By‹CouÁ
(), 
ouutL’
)è+ *
this
;

3129 
‹mp
.
	`Encode
(
bt
, 
ouutL’
, 
UNSIGNED
);

3131 
	}
}

3133 
	gIÁeg”
::
	$DEREncode
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
) const

3135 
DERG’”®Encod”
 
	`’c
(
bt
, 
INTEGER
);

3136 
	`Encode
(
’c
, 
	`MšEncodedSize
(
SIGNED
), SIGNED);

3137 
’c
.
	`Mes§geEnd
();

3138 
	}
}

3140 
	gIÁeg”
::
	$BERDecode
(cÚ¡ 
by‹
 *
šput
, 
size_t
 
Ën
)

3142 
SŒšgStÜe
 
	`¡Üe
(
šput
, 
Ën
);

3143 
	`BERDecode
(
¡Üe
);

3144 
	}
}

3146 
	gIÁeg”
::
	$BERDecode
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
)

3148 
BERG’”®Decod”
 
	`dec
(
bt
, 
INTEGER
);

3149 ià(!
dec
.
	`IsDefš™eL’gth
(è|| dec.
	`MaxR‘r›vabË
(è< dec.
	`RemaššgL’gth
())

3150 
	`BERDecodeE¼Ü
();

3151 
	`Decode
(
dec
, (
size_t
)dec.
	`RemaššgL’gth
(), 
SIGNED
);

3152 
dec
.
	`Mes§geEnd
();

3153 
	}
}

3155 
	gIÁeg”
::
	$DEREncodeAsOù‘SŒšg
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
, 
size_t
 
Ëngth
) const

3157 
DERG’”®Encod”
 
	`’c
(
bt
, 
OCTET_STRING
);

3158 
	`Encode
(
’c
, 
Ëngth
);

3159 
’c
.
	`Mes§geEnd
();

3160 
	}
}

3162 
	gIÁeg”
::
	$BERDecodeAsOù‘SŒšg
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
, 
size_t
 
Ëngth
)

3164 
BERG’”®Decod”
 
	`dec
(
bt
, 
OCTET_STRING
);

3165 ià(!
dec
.
	`IsDefš™eL’gth
(è|| dec.
	`RemaššgL’gth
(è!ğ
Ëngth
)

3166 
	`BERDecodeE¼Ü
();

3167 
	`Decode
(
dec
, 
Ëngth
);

3168 
dec
.
	`Mes§geEnd
();

3169 
	}
}

3171 
size_t
 
	gIÁeg”
::
	$O³nPGPEncode
(
by‹
 *
ouut
, 
size_t
 
Ën
) const

3173 
A¼aySšk
 
	`sšk
(
ouut
, 
Ën
);

3174  
	`O³nPGPEncode
(
sšk
);

3175 
	}
}

3177 
size_t
 
	gIÁeg”
::
	$O³nPGPEncode
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
) const

3179 
wÜd16
 
b™CouÁ
 = 
	`B™CouÁ
();

3180 
bt
.
	`PutWÜd16
(
b™CouÁ
);

3181 
size_t
 
by‹CouÁ
 = 
	`B™sToBy‹s
(
b™CouÁ
);

3182 
	`Encode
(
bt
, 
by‹CouÁ
);

3183  2 + 
by‹CouÁ
;

3184 
	}
}

3186 
	gIÁeg”
::
	$O³nPGPDecode
(cÚ¡ 
by‹
 *
šput
, 
size_t
 
Ën
)

3188 
SŒšgStÜe
 
	`¡Üe
(
šput
, 
Ën
);

3189 
	`O³nPGPDecode
(
¡Üe
);

3190 
	}
}

3192 
	gIÁeg”
::
	$O³nPGPDecode
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
)

3194 
wÜd16
 
b™CouÁ
;

3195 ià(
bt
.
	`G‘WÜd16
(
b™CouÁ
è!ğ2 || bt.
	`MaxR‘r›vabË
(è< 
	`B™sToBy‹s
(bitCount))

3196 
throw
 
	`O³nPGPDecodeE¼
();

3197 
	`Decode
(
bt
, 
	`B™sToBy‹s
(
b™CouÁ
));

3198 
	}
}

3200 
	gIÁeg”
::
	$Rªdomize
(
RªdomNumb”G’”©Ü
 &
ºg
, 
size_t
 
nb™s
)

3202 cÚ¡ 
size_t
 
nby‹s
 = 
nb™s
/8 + 1;

3203 
SecBy‹Block
 
	`buf
(
nby‹s
);

3204 
ºg
.
	`G’”©eBlock
(
buf
, 
nby‹s
);

3205 ià(
nby‹s
)

3206 
buf
[0] = (
by‹
)
	`Crİ
(buf[0], 
nb™s
 % 8);

3207 
	`Decode
(
buf
, 
nby‹s
, 
UNSIGNED
);

3208 
	}
}

3210 
	gIÁeg”
::
	$Rªdomize
(
RªdomNumb”G’”©Ü
 &
ºg
, cÚ¡ 
IÁeg”
 &
mš
, cÚ¡ IÁeg” &
max
)

3212 ià(
mš
 > 
max
)

3213 
throw
 
	`Inv®idArgum’t
("Integer: Min must be‚o greaterhan Max");

3215 
IÁeg”
 
¿nge
 = 
max
 - 
mš
;

3216 cÚ¡ 
nb™s
 = 
¿nge
.
	`B™CouÁ
();

3220 
	`Rªdomize
(
ºg
, 
nb™s
);

3222 *
this
 > 
¿nge
);

3224 *
this
 +ğ
mš
;

3225 
	}
}

3227 
boŞ
 
	gIÁeg”
::
	$Rªdomize
(
RªdomNumb”G’”©Ü
 &
ºg
, cÚ¡ 
IÁeg”
 &
mš
, cÚ¡ IÁeg” &
max
, 
RªdomNumb”Ty³
 
ºTy³
, cÚ¡ IÁeg” &
equiv
, cÚ¡ IÁeg” &
mod
)

3229  
	`G’”©eRªdomNoThrow
(
ºg
, 
	`MakeP¬am‘”s
("Mš", 
mš
)("Max", 
max
)("RªdomNumb”Ty³", 
ºTy³
)("Equiv®’tTo", 
equiv
)("Mod", 
mod
));

3230 
	}
}

3232 şas 
	cKDF2_RNG
 : 
public
 
RªdomNumb”G’”©Ü


3234 
public
:

3235 
	$KDF2_RNG
(cÚ¡ 
by‹
 *
£ed
, 
size_t
 
£edSize
)

3236 : 
	`m_couÁ”
(0), 
	`m_couÁ”AndS“d
(
£edSize
 + 4)

3238 
	`memıy
(
m_couÁ”AndS“d
 + 4, 
£ed
, 
£edSize
);

3241 
	$G’”©eBlock
(
by‹
 *
ouut
, 
size_t
 
size
)

3243 
	`PutWÜd
(
çl£
, 
BIG_ENDIAN_ORDER
, 
m_couÁ”AndS“d
, 
m_couÁ”
);

3244 ++
m_couÁ”
;

3245 
P1363_KDF2
<
SHA1
>::
	`D”iveKey
(
ouut
, 
size
, 
m_couÁ”AndS“d
, m_couÁ”AndS“d.
	`size
(), 
NULL
, 0);

3246 
	}
}

3248 
	g´iv©e
:

3249 
wÜd32
 
m_couÁ”
;

3250 
SecBy‹Block
 
	gm_couÁ”AndS“d
;

3253 
boŞ
 
	gIÁeg”
::
	$G’”©eRªdomNoThrow
(
RªdomNumb”G’”©Ü
 &
i_ºg
, cÚ¡ 
NameV®uePaœs
 &
·¿ms
)

3255 
IÁeg”
 
mš
 = 
·¿ms
.
	`G‘V®ueW™hDeçuÉ
("Mš", IÁeg”::
	`Z”o
());

3256 
IÁeg”
 
max
;

3257 ià(!
·¿ms
.
	`G‘V®ue
("Max", 
max
))

3259 
b™L’gth
;

3260 ià(
·¿ms
.
	`G‘IÁV®ue
("B™L’gth", 
b™L’gth
))

3261 
max
 = 
IÁeg”
::
	`Pow”2
(
b™L’gth
);

3263 
throw
 
	`Inv®idArgum’t
("Integer: missing Max‡rgument");

3265 ià(
mš
 > 
max
)

3266 
throw
 
	`Inv®idArgum’t
("Integer: Min must be‚o greaterhan Max");

3268 
IÁeg”
 
equiv
 = 
·¿ms
.
	`G‘V®ueW™hDeçuÉ
("Equiv®’tTo", IÁeg”::
	`Z”o
());

3269 
IÁeg”
 
mod
 = 
·¿ms
.
	`G‘V®ueW™hDeçuÉ
("Mod", IÁeg”::
	`OÃ
());

3271 ià(
equiv
.
	`IsNeg©ive
(è||ƒquiv >ğ
mod
)

3272 
throw
 
	`Inv®idArgum’t
("Integer: invalid EquivalentTo‡nd/or Mod‡rgument");

3274 
IÁeg”
::
RªdomNumb”Ty³
 
ºTy³
 = 
·¿ms
.
	`G‘V®ueW™hDeçuÉ
("RªdomNumb”Ty³", IÁeg”::
ANY
);

3276 
memb”_±r
<
KDF2_RNG
> 
kdf2Rng
;

3277 
CÚ¡By‹A¼ayP¬am‘”
 
£ed
;

3278 ià(
·¿ms
.
	`G‘V®ue
(
Name
::
	`S“d
(), 
£ed
))

3280 
By‹Queue
 
bq
;

3281 
DERSequ’ûEncod”
 
	`£q
(
bq
);

3282 
mš
.
	`DEREncode
(
£q
);

3283 
max
.
	`DEREncode
(
£q
);

3284 
equiv
.
	`DEREncode
(
£q
);

3285 
mod
.
	`DEREncode
(
£q
);

3286 
	`DEREncodeUnsigÃd
(
£q
, 
ºTy³
);

3287 
	`DEREncodeOù‘SŒšg
(
£q
, 
£ed
.
	`begš
(), s“d.
	`size
());

3288 
£q
.
	`Mes§geEnd
();

3290 
SecBy‹Block
 
	`fš®S“d
((
size_t
)
bq
.
	`MaxR‘r›vabË
());

3291 
bq
.
	`G‘
(
fš®S“d
, fš®S“d.
	`size
());

3292 
kdf2Rng
.
	`»£t
(
Ãw
 
	`KDF2_RNG
(
fš®S“d
.
	`begš
(), fš®S“d.
	`size
()));

3294 
RªdomNumb”G’”©Ü
 &
ºg
 = 
kdf2Rng
.
	`g‘
(è? (RªdomNumb”G’”©Ü &)*kdf2Rng : 
i_ºg
;

3296 
ºTy³
)

3298 
ANY
:

3299 ià(
mod
 =ğ
	`OÃ
())

3300 
	`Rªdomize
(
ºg
, 
mš
, 
max
);

3303 
IÁeg”
 
mš1
 = 
mš
 + (
equiv
-mš)%
mod
;

3304 ià(
max
 < 
mš1
)

3305  
çl£
;

3306 
	`Rªdomize
(
ºg
, 
	`Z”o
(), (
max
 - 
mš1
è/ 
mod
);

3307 *
this
 *ğ
mod
;

3308 *
this
 +ğ
mš1
;

3310  
Œue
;

3312 
PRIME
:

3314 cÚ¡ 
PrimeS–eùÜ
 *
pS–eùÜ
 = 
·¿ms
.
	`G‘V®ueW™hDeçuÉ
(
Name
::
	`Poš‹rToPrimeS–eùÜ
(), (cÚ¡ PrimeS–eùÜ *)
NULL
);

3316 
i
;

3317 
i
 = 0;

3320 ià(++
i
==16)

3323 
IÁeg”
 
fœ¡
 = 
mš
;

3324 ià(
	`Fœ¡Prime
(
fœ¡
, 
max
, 
equiv
, 
mod
, 
pS–eùÜ
))

3327 *
this
 = 
fœ¡
;

3328 ià(!
	`Fœ¡Prime
(
fœ¡
, 
max
, 
equiv
, 
mod
, 
pS–eùÜ
))

3329  
Œue
;

3332  
çl£
;

3335 
	`Rªdomize
(
ºg
, 
mš
, 
max
);

3336 ià(
	`Fœ¡Prime
(*
this
, 
	`STDMIN
(*this+
mod
*
	`PrimeS—rchIÁ”v®
(
max
), max), 
equiv
, mod, 
pS–eùÜ
))

3337  
Œue
;

3342 
throw
 
	`Inv®idArgum’t
("Integer: invalid RandomNumberType‡rgument");

3344 
	}
}

3346 
	g¡d
::
i¡»am
& 
İ”©Ü
>>(
¡d
::i¡»am& 
š
, 
	gIÁeg”
 &
	ga
)

3348 
	gc
;

3349 
	gËngth
 = 0;

3350 
	gSecBlock
<> 
¡r
(
Ëngth
 + 16);

3352 
	g¡d
::
ws
(
š
);

3356 
	gš
.
»ad
(&
c
, 1);

3357 
	g¡r
[
Ëngth
++] = 
c
;

3358 ià(
	gËngth
 >ğ
¡r
.
size
())

3359 
¡r
.
Grow
(
Ëngth
 + 16);

3361 
	gš
 && (
	gc
=='-' || 
c
=='x' || (c>='0' && c<='9') || (c>='a' && c<='f') || (c>='A' && c<='F') || c=='h' || c=='H' || c=='o' || c=='O' || c==',' || c=='.'));

3363 ià(
	gš
.
gcouÁ
())

3364 
	gš
.
putback
(
c
);

3365 
	g¡r
[
Ëngth
-1] = '\0';

3366 
	ga
 = 
IÁeg”
(
¡r
);

3368  
	gš
;

3371 
	g¡d
::
o¡»am
& 
İ”©Ü
<<(
¡d
::o¡»am& 
out
, cÚ¡ 
	gIÁeg”
 &
	ga
)

3374 
	gf
 = 
out
.
æags
(è& 
¡d
::
ios
::
ba£f›ld
;

3375 
	gba£
, 
	gblock
;

3376 
	gsuffix
;

3377 
	gf
)

3379 
	g¡d
::
ios
::
où
 :

3380 
ba£
 = 8;

3381 
	gblock
 = 8;

3382 
	gsuffix
 = 'o';

3384 
	g¡d
::
ios
::
hex
 :

3385 
ba£
 = 16;

3386 
	gblock
 = 4;

3387 
	gsuffix
 = 'h';

3390 
ba£
 = 10;

3391 
	gblock
 = 3;

3392 
	gsuffix
 = '.';

3395 
IÁeg”
 
	g‹mp1
=
a
, 
	g‹mp2
;

3397 ià(
	ga
.
IsNeg©ive
())

3399 
	gout
 << '-';

3400 
	g‹mp1
.
Neg©e
();

3403 ià(!
	ga
)

3404 
	gout
 << '0';

3406 cÚ¡ 
	guµ”
[]="0123456789ABCDEF";

3407 cÚ¡ 
	glow”
[]="0123456789abcdef";

3409 cÚ¡ * 
	gvec
 = (
out
.
æags
(è& 
¡d
::
ios
::
uµ”ÿ£
è? 
uµ”
 : 
low”
;

3410 
	gi
=0;

3411 
	gSecBlock
<> 
s
(
a
.
B™CouÁ
(è/ (
B™P»cisiÚ
(
ba£
)-1) + 1);

3413 !!
	g‹mp1
)

3415 
wÜd
 
	gdig™
;

3416 
	gIÁeg”
::
Divide
(
dig™
, 
‹mp2
, 
‹mp1
, 
ba£
);

3417 
	gs
[
i
++]=
vec
[
dig™
];

3418 
	g‹mp1
.
sw­
(
‹mp2
);

3421 
	gi
--)

3423 
	gout
 << 
	gs
[
i
];

3427  
	gout
 << 
	gsuffix
;

3430 
	gIÁeg”
& IÁeg”::
İ”©Ü
++()

3432 ià(
NÙNeg©ive
())

3434 ià(
Inüem’t
(
»g
,„eg.
size
()))

3436 
	g»g
.
CËªGrow
(2*
»g
.
size
());

3437 
	g»g
[
»g
.
size
()/2]=1;

3442 
wÜd
 
	gbÜrow
 = 
Deüem’t
(
»g
,„eg.
size
());

3443 
as£¹
(!
bÜrow
);

3444 ià(
WÜdCouÁ
()==0)

3445 *
this
 = 
Z”o
();

3447  *
	gthis
;

3450 
	gIÁeg”
& IÁeg”::
İ”©Ü
--()

3452 ià(
IsNeg©ive
())

3454 ià(
Inüem’t
(
»g
,„eg.
size
()))

3456 
	g»g
.
CËªGrow
(2*
»g
.
size
());

3457 
	g»g
[
»g
.
size
()/2]=1;

3462 ià(
Deüem’t
(
»g
,„eg.
size
()))

3463 *
	gthis
 = -
OÃ
();

3465  *
	gthis
;

3468 
	$Pos™iveAdd
(
IÁeg”
 &
sum
, cÚ¡ IÁeg” &
a
, cÚ¡ IÁeg”& 
b
)

3470 
ÿ¼y
;

3471 ià(
a
.
»g
.
	`size
(è=ğ
b
.reg.size())

3472 
ÿ¼y
 = 
	`Add
(
sum
.
»g
, 
a
.»g, 
b
.»g,‡.»g.
	`size
());

3473 ià(
a
.
»g
.
	`size
(è> 
b
.reg.size())

3475 
ÿ¼y
 = 
	`Add
(
sum
.
»g
, 
a
.»g, 
b
.»g, b.»g.
	`size
());

3476 
	`CİyWÜds
(
sum
.
»g
+
b
.»g.
	`size
(), 
a
.reg+b.reg.size(),‡.reg.size()-b.reg.size());

3477 
ÿ¼y
 = 
	`Inüem’t
(
sum
.
»g
+
b
.»g.
	`size
(), 
a
.reg.size()-b.reg.size(), carry);

3481 
ÿ¼y
 = 
	`Add
(
sum
.
»g
, 
a
.»g, 
b
.»g,‡.»g.
	`size
());

3482 
	`CİyWÜds
(
sum
.
»g
+
a
.»g.
	`size
(), 
b
.reg+a.reg.size(), b.reg.size()-a.reg.size());

3483 
ÿ¼y
 = 
	`Inüem’t
(
sum
.
»g
+
a
.»g.
	`size
(), 
b
.reg.size()-a.reg.size(), carry);

3486 ià(
ÿ¼y
)

3488 
sum
.
»g
.
	`CËªGrow
(2*sum.»g.
	`size
());

3489 
sum
.
»g
[sum.»g.
	`size
()/2] = 1;

3491 
sum
.
sign
 = 
IÁeg”
::
POSITIVE
;

3492 
	}
}

3494 
	$Pos™iveSubŒaù
(
IÁeg”
 &
diff
, cÚ¡ IÁeg” &
a
, cÚ¡ IÁeg”& 
b
)

3496 
aSize
 = 
a
.
	`WÜdCouÁ
();

3497 
aSize
 +=‡Size%2;

3498 
bSize
 = 
b
.
	`WÜdCouÁ
();

3499 
bSize
 += bSize%2;

3501 ià(
aSize
 =ğ
bSize
)

3503 ià(
	`Com·»
(
a
.
»g
, 
b
.»g, 
aSize
) >= 0)

3505 
	`SubŒaù
(
diff
.
»g
, 
a
.»g, 
b
.»g, 
aSize
);

3506 
diff
.
sign
 = 
IÁeg”
::
POSITIVE
;

3510 
	`SubŒaù
(
diff
.
»g
, 
b
.»g, 
a
.»g, 
aSize
);

3511 
diff
.
sign
 = 
IÁeg”
::
NEGATIVE
;

3514 ià(
aSize
 > 
bSize
)

3516 
wÜd
 
bÜrow
 = 
	`SubŒaù
(
diff
.
»g
, 
a
.»g, 
b
.»g, 
bSize
);

3517 
	`CİyWÜds
(
diff
.
»g
+
bSize
, 
a
.»g+bSize, 
aSize
-bSize);

3518 
bÜrow
 = 
	`Deüem’t
(
diff
.
»g
+
bSize
, 
aSize
-bSize, borrow);

3519 
	`as£¹
(!
bÜrow
);

3520 
diff
.
sign
 = 
IÁeg”
::
POSITIVE
;

3524 
wÜd
 
bÜrow
 = 
	`SubŒaù
(
diff
.
»g
, 
b
.»g, 
a
.»g, 
aSize
);

3525 
	`CİyWÜds
(
diff
.
»g
+
aSize
, 
b
.»g+aSize, 
bSize
-aSize);

3526 
bÜrow
 = 
	`Deüem’t
(
diff
.
»g
+
aSize
, 
bSize
-aSize, borrow);

3527 
	`as£¹
(!
bÜrow
);

3528 
diff
.
sign
 = 
IÁeg”
::
NEGATIVE
;

3530 
	}
}

3533 
	g‹m¶©e
 <
şass
 
	gT
> 
šlše
 cÚ¡ T& 
	$STDMAX2
(cÚ¡ 
T
& 
a
, cÚ¡ T& 
b
)

3535  
a
 < 
b
 ? b :‡;

3536 
	}
}

3538 
IÁeg”
 
	gIÁeg”
::
	$Plus
(cÚ¡ 
IÁeg”
& 
b
) const

3540 
IÁeg”
 
	`sum
((
wÜd
)0, 
	`STDMAX2
(
»g
.
	`size
(), 
b
.reg.size()));

3541 ià(
	`NÙNeg©ive
())

3543 ià(
b
.
	`NÙNeg©ive
())

3544 
	`Pos™iveAdd
(
sum
, *
this
, 
b
);

3546 
	`Pos™iveSubŒaù
(
sum
, *
this
, 
b
);

3550 ià(
b
.
	`NÙNeg©ive
())

3551 
	`Pos™iveSubŒaù
(
sum
, 
b
, *
this
);

3554 
	`Pos™iveAdd
(
sum
, *
this
, 
b
);

3555 
sum
.
sign
 = 
IÁeg”
::
NEGATIVE
;

3558  
sum
;

3559 
	}
}

3561 
	gIÁeg”
& IÁeg”::
İ”©Ü
+=(cÚ¡ 
IÁeg”
& 
t
)

3563 
»g
.
CËªGrow
(
t
.»g.
size
());

3564 ià(
NÙNeg©ive
())

3566 ià(
	gt
.
NÙNeg©ive
())

3567 
Pos™iveAdd
(*
this
, *this, 
t
);

3569 
Pos™iveSubŒaù
(*
this
, *this, 
t
);

3573 ià(
	gt
.
NÙNeg©ive
())

3574 
Pos™iveSubŒaù
(*
this
, 
t
, *this);

3577 
Pos™iveAdd
(*
this
, *this, 
t
);

3578 
	gsign
 = 
IÁeg”
::
NEGATIVE
;

3581  *
	gthis
;

3584 
IÁeg”
 
	gIÁeg”
::
	$Mšus
(cÚ¡ 
IÁeg”
& 
b
) const

3586 
IÁeg”
 
	`diff
((
wÜd
)0, 
	`STDMAX2
(
»g
.
	`size
(), 
b
.reg.size()));

3587 ià(
	`NÙNeg©ive
())

3589 ià(
b
.
	`NÙNeg©ive
())

3590 
	`Pos™iveSubŒaù
(
diff
, *
this
, 
b
);

3592 
	`Pos™iveAdd
(
diff
, *
this
, 
b
);

3596 ià(
b
.
	`NÙNeg©ive
())

3598 
	`Pos™iveAdd
(
diff
, *
this
, 
b
);

3599 
diff
.
sign
 = 
IÁeg”
::
NEGATIVE
;

3602 
	`Pos™iveSubŒaù
(
diff
, 
b
, *
this
);

3604  
diff
;

3605 
	}
}

3607 
	gIÁeg”
& IÁeg”::
İ”©Ü
-=(cÚ¡ 
IÁeg”
& 
t
)

3609 
»g
.
CËªGrow
(
t
.»g.
size
());

3610 ià(
NÙNeg©ive
())

3612 ià(
	gt
.
NÙNeg©ive
())

3613 
Pos™iveSubŒaù
(*
this
, *this, 
t
);

3615 
Pos™iveAdd
(*
this
, *this, 
t
);

3619 ià(
	gt
.
NÙNeg©ive
())

3621 
Pos™iveAdd
(*
this
, *this, 
t
);

3622 
	gsign
 = 
IÁeg”
::
NEGATIVE
;

3625 
Pos™iveSubŒaù
(*
this
, 
t
, *this);

3627  *
	gthis
;

3630 
	gIÁeg”
& IÁeg”::
İ”©Ü
<<=(
size_t
 
n
)

3632 cÚ¡ 
size_t
 
wÜdCouÁ
 = 
WÜdCouÁ
();

3633 cÚ¡ 
size_t
 
	gshiáWÜds
 = 
n
 / 
WORD_BITS
;

3634 cÚ¡ 
	gshiáB™s
 = ()(
n
 % 
WORD_BITS
);

3636 
	g»g
.
CËªGrow
(
RoundupSize
(
wÜdCouÁ
+
B™sToWÜds
(
n
)));

3637 
ShiáWÜdsLeáByWÜds
(
»g
, 
wÜdCouÁ
 + 
shiáWÜds
, shiftWords);

3638 
ShiáWÜdsLeáByB™s
(
»g
+
shiáWÜds
, 
wÜdCouÁ
+
B™sToWÜds
(
shiáB™s
), shiftBits);

3639  *
	gthis
;

3642 
	gIÁeg”
& IÁeg”::
İ”©Ü
>>=(
size_t
 
n
)

3644 cÚ¡ 
size_t
 
wÜdCouÁ
 = 
WÜdCouÁ
();

3645 cÚ¡ 
size_t
 
	gshiáWÜds
 = 
n
 / 
WORD_BITS
;

3646 cÚ¡ 
	gshiáB™s
 = ()(
n
 % 
WORD_BITS
);

3648 
ShiáWÜdsRightByWÜds
(
»g
, 
wÜdCouÁ
, 
shiáWÜds
);

3649 ià(
	gwÜdCouÁ
 > 
	gshiáWÜds
)

3650 
ShiáWÜdsRightByB™s
(
»g
, 
wÜdCouÁ
-
shiáWÜds
, 
shiáB™s
);

3651 ià(
IsNeg©ive
(è&& 
WÜdCouÁ
()==0)

3652 *
this
 = 
Z”o
();

3653  *
	gthis
;

3656 
	$Pos™iveMuÉly
(
IÁeg”
 &
´oduù
, cÚ¡ IÁeg” &
a
, cÚ¡ IÁeg” &
b
)

3658 
size_t
 
aSize
 = 
	`RoundupSize
(
a
.
	`WÜdCouÁ
());

3659 
size_t
 
bSize
 = 
	`RoundupSize
(
b
.
	`WÜdCouÁ
());

3661 
´oduù
.
»g
.
	`CËªNew
(
	`RoundupSize
(
aSize
+
bSize
));

3662 
´oduù
.
sign
 = 
IÁeg”
::
POSITIVE
;

3664 
IÁeg”SecBlock
 
	`wÜk¥aû
(
aSize
 + 
bSize
);

3665 
	`Asymm‘ricMuÉly
(
´oduù
.
»g
, 
wÜk¥aû
, 
a
.»g, 
aSize
, 
b
.»g, 
bSize
);

3666 
	}
}

3668 
	$MuÉly
(
IÁeg”
 &
´oduù
, cÚ¡ IÁeg” &
a
, cÚ¡ IÁeg” &
b
)

3670 
	`Pos™iveMuÉly
(
´oduù
, 
a
, 
b
);

3672 ià(
a
.
	`NÙNeg©ive
(è!ğ
b
.NotNegative())

3673 
´oduù
.
	`Neg©e
();

3674 
	}
}

3676 
IÁeg”
 
	gIÁeg”
::
	$Times
(cÚ¡ 
IÁeg”
 &
b
) const

3678 
IÁeg”
 
´oduù
;

3679 
	`MuÉly
(
´oduù
, *
this
, 
b
);

3680  
´oduù
;

3681 
	}
}

3705 
	$Pos™iveDivide
(
IÁeg”
 &
»mašd”
, IÁeg” &
quÙ›Á
,

3706 cÚ¡ 
IÁeg”
 &
a
, cÚ¡ IÁeg” &
b
)

3708 
aSize
 = 
a
.
	`WÜdCouÁ
();

3709 
bSize
 = 
b
.
	`WÜdCouÁ
();

3711 ià(!
bSize
)

3712 
throw
 
IÁeg”
::
	`DivideByZ”o
();

3714 ià(
aSize
 < 
bSize
)

3716 
»mašd”
 = 
a
;

3717 
»mašd”
.
sign
 = 
IÁeg”
::
POSITIVE
;

3718 
quÙ›Á
 = 
IÁeg”
::
	`Z”o
();

3722 
aSize
 +=‡Size%2;

3723 
bSize
 += bSize%2;

3725 
»mašd”
.
»g
.
	`CËªNew
(
	`RoundupSize
(
bSize
));

3726 
»mašd”
.
sign
 = 
IÁeg”
::
POSITIVE
;

3727 
quÙ›Á
.
»g
.
	`CËªNew
(
	`RoundupSize
(
aSize
-
bSize
+2));

3728 
quÙ›Á
.
sign
 = 
IÁeg”
::
POSITIVE
;

3730 
IÁeg”SecBlock
 
	`T
(
aSize
+3*(
bSize
+2));

3731 
	`Divide
(
»mašd”
.
»g
, 
quÙ›Á
.»g, 
T
, 
a
.»g, 
aSize
, 
b
.»g, 
bSize
);

3732 
	}
}

3734 
	gIÁeg”
::
	$Divide
(
IÁeg”
 &
»mašd”
, IÁeg” &
quÙ›Á
, cÚ¡ IÁeg” &
divid’d
, cÚ¡ IÁeg” &
divisÜ
)

3736 
	`Pos™iveDivide
(
»mašd”
, 
quÙ›Á
, 
divid’d
, 
divisÜ
);

3738 ià(
divid’d
.
	`IsNeg©ive
())

3740 
quÙ›Á
.
	`Neg©e
();

3741 ià(
»mašd”
.
	`NÙZ”o
())

3743 --
quÙ›Á
;

3744 
»mašd”
 = 
divisÜ
.
	`AbsŞu‹V®ue
() -„emainder;

3748 ià(
divisÜ
.
	`IsNeg©ive
())

3749 
quÙ›Á
.
	`Neg©e
();

3750 
	}
}

3752 
	gIÁeg”
::
	$DivideByPow”Of2
(
IÁeg”
 &
r
, IÁeg” &
q
, cÚ¡ IÁeg” &
a
, 
n
)

3754 
q
 = 
a
;

3755 
q
 >>ğ
n
;

3757 cÚ¡ 
size_t
 
wÜdCouÁ
 = 
	`B™sToWÜds
(
n
);

3758 ià(
wÜdCouÁ
 <ğ
a
.
	`WÜdCouÁ
())

3760 
r
.
»g
.
	`»size
(
	`RoundupSize
(
wÜdCouÁ
));

3761 
	`CİyWÜds
(
r
.
»g
, 
a
.»g, 
wÜdCouÁ
);

3762 
	`S‘WÜds
(
r
.
»g
+
wÜdCouÁ
, 0,„.»g.
	`size
()-wordCount);

3763 ià(
n
 % 
WORD_BITS
 != 0)

3764 
r
.
»g
[
wÜdCouÁ
-1] %ğ(
	`wÜd
(1è<< (
n
 % 
WORD_BITS
));

3768 
r
.
»g
.
	`»size
(
	`RoundupSize
(
a
.
	`WÜdCouÁ
()));

3769 
	`CİyWÜds
(
r
.
»g
, 
a
.»g,„.»g.
	`size
());

3771 
r
.
sign
 = 
POSITIVE
;

3773 ià(
a
.
	`IsNeg©ive
(è&& 
r
.
	`NÙZ”o
())

3775 --
q
;

3776 
r
 = 
	`Pow”2
(
n
) -„;

3778 
	}
}

3780 
IÁeg”
 
	gIÁeg”
::
	$DividedBy
(cÚ¡ 
IÁeg”
 &
b
) const

3782 
IÁeg”
 
»mašd”
, 
quÙ›Á
;

3783 
IÁeg”
::
	`Divide
(
»mašd”
, 
quÙ›Á
, *
this
, 
b
);

3784  
quÙ›Á
;

3785 
	}
}

3787 
IÁeg”
 
	gIÁeg”
::
	$Modulo
(cÚ¡ 
IÁeg”
 &
b
) const

3789 
IÁeg”
 
»mašd”
, 
quÙ›Á
;

3790 
IÁeg”
::
	`Divide
(
»mašd”
, 
quÙ›Á
, *
this
, 
b
);

3791  
»mašd”
;

3792 
	}
}

3794 
	gIÁeg”
::
	$Divide
(
wÜd
 &
»mašd”
, 
IÁeg”
 &
quÙ›Á
, cÚ¡ IÁeg” &
divid’d
, wÜd 
divisÜ
)

3796 ià(!
divisÜ
)

3797 
throw
 
IÁeg”
::
	`DivideByZ”o
();

3799 
	`as£¹
(
divisÜ
);

3801 ià((
divisÜ
 & (divisor-1)) == 0)

3803 
quÙ›Á
 = 
divid’d
 >> (
	`B™P»cisiÚ
(
divisÜ
)-1);

3804 
»mašd”
 = 
divid’d
.
»g
[0] & (
divisÜ
-1);

3808 
i
 = 
divid’d
.
	`WÜdCouÁ
();

3809 
quÙ›Á
.
»g
.
	`CËªNew
(
	`RoundupSize
(
i
));

3810 
»mašd”
 = 0;

3811 
i
--)

3813 
quÙ›Á
.
»g
[
i
] = 
	`DWÜd
(
divid’d
.»g[i], 
»mašd”
è/ 
divisÜ
;

3814 
»mašd”
 = 
	`DWÜd
(
divid’d
.
»g
[
i
],„emašd”è% 
divisÜ
;

3817 ià(
divid’d
.
	`NÙNeg©ive
())

3818 
quÙ›Á
.
sign
 = 
POSITIVE
;

3821 
quÙ›Á
.
sign
 = 
NEGATIVE
;

3822 ià(
»mašd”
)

3824 --
quÙ›Á
;

3825 
»mašd”
 = 
divisÜ
 -„emainder;

3828 
	}
}

3830 
IÁeg”
 
	gIÁeg”
::
	$DividedBy
(
wÜd
 
b
) const

3832 
wÜd
 
»mašd”
;

3833 
IÁeg”
 
quÙ›Á
;

3834 
IÁeg”
::
	`Divide
(
»mašd”
, 
quÙ›Á
, *
this
, 
b
);

3835  
quÙ›Á
;

3836 
	}
}

3838 
wÜd
 
	gIÁeg”
::
	$Modulo
(
wÜd
 
divisÜ
) const

3840 ià(!
divisÜ
)

3841 
throw
 
IÁeg”
::
	`DivideByZ”o
();

3843 
	`as£¹
(
divisÜ
);

3845 
wÜd
 
»mašd”
;

3847 ià((
divisÜ
 & (divisor-1)) == 0)

3848 
»mašd”
 = 
»g
[0] & (
divisÜ
-1);

3851 
i
 = 
	`WÜdCouÁ
();

3853 ià(
divisÜ
 <= 5)

3855 
DWÜd
 
	`sum
(0, 0);

3856 
i
--)

3857 
sum
 +ğ
»g
[
i
];

3858 
»mašd”
 = 
sum
 % 
divisÜ
;

3862 
»mašd”
 = 0;

3863 
i
--)

3864 
»mašd”
 = 
	`DWÜd
(
»g
[
i
],„emašd”è% 
divisÜ
;

3868 ià(
	`IsNeg©ive
(è&& 
»mašd”
)

3869 
»mašd”
 = 
divisÜ
 -„emainder;

3871  
»mašd”
;

3872 
	}
}

3874 
	gIÁeg”
::
	$Neg©e
()

3876 ià(!!(*
this
))

3877 
sign
 = 
	`Sign
(1-sign);

3878 
	}
}

3880 
	gIÁeg”
::
	$Pos™iveCom·»
(cÚ¡ 
IÁeg”
& 
t
) const

3882 
size
 = 
	`WÜdCouÁ
(), 
tSize
 = 
t
.WordCount();

3884 ià(
size
 =ğ
tSize
)

3885  
Cry±oPP
::
	`Com·»
(
»g
, 
t
.»g, 
size
);

3887  
size
 > 
tSize
 ? 1 : -1;

3888 
	}
}

3890 
	gIÁeg”
::
	$Com·»
(cÚ¡ 
IÁeg”
& 
t
) const

3892 ià(
	`NÙNeg©ive
())

3894 ià(
t
.
	`NÙNeg©ive
())

3895  
	`Pos™iveCom·»
(
t
);

3901 ià(
t
.
	`NÙNeg©ive
())

3904  -
	`Pos™iveCom·»
(
t
);

3906 
	}
}

3908 
IÁeg”
 
	gIÁeg”
::
	$Squ¬eRoÙ
() const

3910 ià(!
	`IsPos™ive
())

3911  
	`Z”o
();

3914 
IÁeg”
 
x
, 
y
 = 
	`Pow”2
((
	`B™CouÁ
()+1)/2);

3915 
	`as£¹
(
y
*y >ğ*
this
);

3919 
x
 = 
y
;

3920 
y
 = (
x
 + *
this
/x) >> 1;

3921 } 
y
<
x
);

3923  
x
;

3924 
	}
}

3926 
boŞ
 
	gIÁeg”
::
	$IsSqu¬e
() const

3928 
IÁeg”
 
r
 = 
	`Squ¬eRoÙ
();

3929  *
this
 =ğ
r
.
	`Squ¬ed
();

3930 
	}
}

3932 
boŞ
 
	gIÁeg”
::
	$IsUn™
() const

3934  (
	`WÜdCouÁ
(è=ğ1è&& (
»g
[0] == 1);

3935 
	}
}

3937 
IÁeg”
 
	gIÁeg”
::
	$MuÉliÿtiveInv”£
() const

3939  
	`IsUn™
(è? *
this
 : 
	`Z”o
();

3940 
	}
}

3942 
IÁeg”
 
	$a_times_b_mod_c
(cÚ¡ 
IÁeg”
 &
x
, cÚ¡ IÁeg”& 
y
, cÚ¡ IÁeg”& 
m
)

3944  
x
*
y
%
m
;

3945 
	}
}

3947 
IÁeg”
 
	$a_exp_b_mod_c
(cÚ¡ 
IÁeg”
 &
x
, cÚ¡ IÁeg”& 
e
, cÚ¡ IÁeg”& 
m
)

3949 
ModuÏrAr™hm‘ic
 
	`mr
(
m
);

3950  
mr
.
	`ExpÚ’tŸ‹
(
x
, 
e
);

3951 
	}
}

3953 
IÁeg”
 
	gIÁeg”
::
	$Gcd
(cÚ¡ 
IÁeg”
 &
a
, cÚ¡ IÁeg” &
b
)

3955  
Euşid—nDomašOf
<
IÁeg”
>().
	`Gcd
(
a
, 
b
);

3956 
	}
}

3958 
IÁeg”
 
	gIÁeg”
::
	$Inv”£Mod
(cÚ¡ 
IÁeg”
 &
m
) const

3960 
	`as£¹
(
m
.
	`NÙNeg©ive
());

3962 ià(
	`IsNeg©ive
())

3963  
	`Modulo
(
m
).
	`Inv”£Mod
(m);

3965 ià(
m
.
	`IsEv’
())

3967 ià(!
m
 || 
	`IsEv’
())

3968  
	`Z”o
();

3969 ià(*
this
 =ğ
	`OÃ
())

3970  
	`OÃ
();

3972 
IÁeg”
 
u
 = 
m
.
	`Modulo
(*
this
).
	`Inv”£Mod
(*this);

3973  !
u
 ? 
	`Z”o
(è: (
m
*(*
this
-u)+1)/(*this);

3976 
SecBlock
<
wÜd
> 
	`T
(
m
.
»g
.
	`size
() * 4);

3977 
IÁeg”
 
	`r
((
wÜd
)0, 
m
.
»g
.
	`size
());

3978 
k
 = 
	`Almo¡Inv”£
(
r
.
»g
, 
T
,„eg,„eg.
	`size
(), 
m
.reg, m.reg.size());

3979 
	`DivideByPow”2Mod
(
r
.
»g
,„.»g, 
k
, 
m
.»g, m.»g.
	`size
());

3980  
r
;

3981 
	}
}

3983 
wÜd
 
	gIÁeg”
::
	$Inv”£Mod
(
wÜd
 
mod
) const

3985 
wÜd
 
g0
 = 
mod
, 
g1
 = *
this
 % mod;

3986 
wÜd
 
v0
 = 0, 
v1
 = 1;

3987 
wÜd
 
y
;

3989 
g1
)

3991 ià(
g1
 == 1)

3992  
v1
;

3993 
y
 = 
g0
 / 
g1
;

3994 
g0
 = g0 % 
g1
;

3995 
v0
 +ğ
y
 * 
v1
;

3997 ià(!
g0
)

3999 ià(
g0
 == 1)

4000  
mod
-
v0
;

4001 
y
 = 
g1
 / 
g0
;

4002 
g1
 = g1 % 
g0
;

4003 
v1
 +ğ
y
 * 
v0
;

4006 
	}
}

4010 
	gModuÏrAr™hm‘ic
::
	$ModuÏrAr™hm‘ic
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
)

4012 
BERSequ’ûDecod”
 
	`£q
(
bt
);

4013 
OID
 
	`oid
(
£q
);

4014 ià(
oid
 !ğ
ASN1
::
	`´ime_f›ld
())

4015 
	`BERDecodeE¼Ü
();

4016 
m_modulus
.
	`BERDecode
(
£q
);

4017 
£q
.
	`Mes§geEnd
();

4018 
m_»suÉ
.
»g
.
	`»size
(
m_modulus
.»g.
	`size
());

4019 
	}
}

4021 
	gModuÏrAr™hm‘ic
::
	$DEREncode
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
) const

4023 
DERSequ’ûEncod”
 
	`£q
(
bt
);

4024 
ASN1
::
	`´ime_f›ld
().
	`DEREncode
(
£q
);

4025 
m_modulus
.
	`DEREncode
(
£q
);

4026 
£q
.
	`Mes§geEnd
();

4027 
	}
}

4029 
	gModuÏrAr™hm‘ic
::
	$DEREncodeEËm’t
(
Bufã»dT¿nsfÜm©iÚ
 &
out
, cÚ¡ 
EËm’t
 &
a
) const

4031 
a
.
	`DEREncodeAsOù‘SŒšg
(
out
, 
	`MaxEËm’tBy‹L’gth
());

4032 
	}
}

4034 
	gModuÏrAr™hm‘ic
::
	$BERDecodeEËm’t
(
Bufã»dT¿nsfÜm©iÚ
 &
š
, 
EËm’t
 &
a
) const

4036 
a
.
	`BERDecodeAsOù‘SŒšg
(
š
, 
	`MaxEËm’tBy‹L’gth
());

4037 
	}
}

4039 cÚ¡ 
	gIÁeg”
& 
	gModuÏrAr™hm‘ic
::
	$H®f
(cÚ¡ 
IÁeg”
 &
a
) const

4041 ià(
a
.
»g
.
	`size
()==
m_modulus
.reg.size())

4043 
Cry±oPP
::
	`DivideByPow”2Mod
(
m_»suÉ
.
»g
.
	`begš
(), 
a
.»g, 1, 
m_modulus
.»g,‡.»g.
	`size
());

4044  
m_»suÉ
;

4047  
m_»suÉ1
 = (
a
.
	`IsEv’
(è? (¨>> 1è: (×+
m_modulus
) >> 1));

4048 
	}
}

4050 cÚ¡ 
	gIÁeg”
& 
	gModuÏrAr™hm‘ic
::
	$Add
(cÚ¡ 
IÁeg”
 &
a
, cÚ¡ IÁeg” &
b
) const

4052 ià(
a
.
»g
.
	`size
()==
m_modulus
.»g.size(è&& 
b
.reg.size()==m_modulus.reg.size())

4054 ià(
Cry±oPP
::
	`Add
(
m_»suÉ
.
»g
.
	`begš
(), 
a
.»g, 
b
.»g,‡.»g.
	`size
())

4055 || 
	`Com·»
(
m_»suÉ
.
»g
, 
m_modulus
.»g, 
a
.»g.
	`size
()) >= 0)

4057 
Cry±oPP
::
	`SubŒaù
(
m_»suÉ
.
»g
.
	`begš
(), m_»suÉ.»g, 
m_modulus
.»g, 
a
.»g.
	`size
());

4059  
m_»suÉ
;

4063 
m_»suÉ1
 = 
a
+
b
;

4064 ià(
m_»suÉ1
 >ğ
m_modulus
)

4065 
m_»suÉ1
 -ğ
m_modulus
;

4066  
m_»suÉ1
;

4068 
	}
}

4070 
	gIÁeg”
& 
	gModuÏrAr™hm‘ic
::
	$AccumuÏ‹
(
IÁeg”
 &
a
, cÚ¡ IÁeg” &
b
) const

4072 ià(
a
.
»g
.
	`size
()==
m_modulus
.»g.size(è&& 
b
.reg.size()==m_modulus.reg.size())

4074 ià(
Cry±oPP
::
	`Add
(
a
.
»g
,‡.»g, 
b
.»g,‡.»g.
	`size
())

4075 || 
	`Com·»
(
a
.
»g
, 
m_modulus
.»g,‡.»g.
	`size
()) >= 0)

4077 
Cry±oPP
::
	`SubŒaù
(
a
.
»g
,‡.»g, 
m_modulus
.»g,‡.»g.
	`size
());

4082 
a
+=
b
;

4083 ià(
a
>=
m_modulus
)

4084 
a
-=
m_modulus
;

4087  
a
;

4088 
	}
}

4090 cÚ¡ 
	gIÁeg”
& 
	gModuÏrAr™hm‘ic
::
	$SubŒaù
(cÚ¡ 
IÁeg”
 &
a
, cÚ¡ IÁeg” &
b
) const

4092 ià(
a
.
»g
.
	`size
()==
m_modulus
.»g.size(è&& 
b
.reg.size()==m_modulus.reg.size())

4094 ià(
Cry±oPP
::
	`SubŒaù
(
m_»suÉ
.
»g
.
	`begš
(), 
a
.»g, 
b
.»g,‡.»g.
	`size
()))

4095 
Cry±oPP
::
	`Add
(
m_»suÉ
.
»g
.
	`begš
(), m_»suÉ.»g, 
m_modulus
.»g, 
a
.»g.
	`size
());

4096  
m_»suÉ
;

4100 
m_»suÉ1
 = 
a
-
b
;

4101 ià(
m_»suÉ1
.
	`IsNeg©ive
())

4102 
m_»suÉ1
 +ğ
m_modulus
;

4103  
m_»suÉ1
;

4105 
	}
}

4107 
	gIÁeg”
& 
	gModuÏrAr™hm‘ic
::
	$Reduû
(
IÁeg”
 &
a
, cÚ¡ IÁeg” &
b
) const

4109 ià(
a
.
»g
.
	`size
()==
m_modulus
.»g.size(è&& 
b
.reg.size()==m_modulus.reg.size())

4111 ià(
Cry±oPP
::
	`SubŒaù
(
a
.
»g
,‡.»g, 
b
.»g,‡.»g.
	`size
()))

4112 
Cry±oPP
::
	`Add
(
a
.
»g
,‡.»g, 
m_modulus
.»g,‡.»g.
	`size
());

4116 
a
-=
b
;

4117 ià(
a
.
	`IsNeg©ive
())

4118 
a
+=
m_modulus
;

4121  
a
;

4122 
	}
}

4124 cÚ¡ 
	gIÁeg”
& 
	gModuÏrAr™hm‘ic
::
	$Inv”£
(cÚ¡ 
IÁeg”
 &
a
) const

4126 ià(!
a
)

4127  
a
;

4129 
	`CİyWÜds
(
m_»suÉ
.
»g
.
	`begš
(), 
m_modulus
.»g, m_modulus.»g.
	`size
());

4130 ià(
Cry±oPP
::
	`SubŒaù
(
m_»suÉ
.
»g
.
	`begš
(), m_»suÉ.»g, 
a
.»g,‡.»g.
	`size
()))

4131 
	`Deüem’t
(
m_»suÉ
.
»g
.
	`begš
()+
a
.»g.
	`size
(), 
m_modulus
.reg.size()-a.reg.size());

4133  
m_»suÉ
;

4134 
	}
}

4136 
IÁeg”
 
	gModuÏrAr™hm‘ic
::
	$CasÿdeExpÚ’tŸ‹
(cÚ¡ 
IÁeg”
 &
x
, cÚ¡ IÁeg” &
e1
, cÚ¡ IÁeg” &
y
, cÚ¡ IÁeg” &
e2
) const

4138 ià(
m_modulus
.
	`IsOdd
())

4140 
MÚtgom”yR•»£Á©iÚ
 
	`dr
(
m_modulus
);

4141  
dr
.
	`CÚv”tOut
(dr.
	`CasÿdeExpÚ’tŸ‹
(dr.
	`CÚv”tIn
(
x
), 
e1
, dr.CÚv”tIn(
y
), 
e2
));

4144  
Ab¡¿ùRšg
<
IÁeg”
>::
	`CasÿdeExpÚ’tŸ‹
(
x
, 
e1
, 
y
, 
e2
);

4145 
	}
}

4147 
	gModuÏrAr™hm‘ic
::
	$SimuÉªeousExpÚ’tŸ‹
(
IÁeg”
 *
»suÉs
, cÚ¡ IÁeg” &
ba£
, cÚ¡ IÁeg” *
expÚ’ts
, 
expÚ’tsCouÁ
) const

4149 ià(
m_modulus
.
	`IsOdd
())

4151 
MÚtgom”yR•»£Á©iÚ
 
	`dr
(
m_modulus
);

4152 
dr
.
	`SimuÉªeousExpÚ’tŸ‹
(
»suÉs
, dr.
	`CÚv”tIn
(
ba£
), 
expÚ’ts
, 
expÚ’tsCouÁ
);

4153 
i
=0; i<
expÚ’tsCouÁ
; i++)

4154 
»suÉs
[
i
] = 
dr
.
	`CÚv”tOut
(results[i]);

4157 
Ab¡¿ùRšg
<
IÁeg”
>::
	`SimuÉªeousExpÚ’tŸ‹
(
»suÉs
, 
ba£
, 
expÚ’ts
, 
expÚ’tsCouÁ
);

4158 
	}
}

4160 
	gMÚtgom”yR•»£Á©iÚ
::
	$MÚtgom”yR•»£Á©iÚ
(cÚ¡ 
IÁeg”
 &
m
)

4161 : 
	`ModuÏrAr™hm‘ic
(
m
),

4162 
	`m_u
((
wÜd
)0, 
m_modulus
.
»g
.
	`size
()),

4163 
	`m_wÜk¥aû
(5*
m_modulus
.
»g
.
	$size
())

4165 ià(!
m_modulus
.
	`IsOdd
())

4166 
throw
 
	`Inv®idArgum’t
("MontgomeryRepresentation: Montgomery„epresentation„equires‡n odd modulus");

4168 
	`RecursiveInv”£ModPow”2
(
m_u
.
»g
, 
m_wÜk¥aû
, 
m_modulus
.»g, m_modulus.»g.
	`size
());

4169 
	}
}

4171 cÚ¡ 
	gIÁeg”
& 
	gMÚtgom”yR•»£Á©iÚ
::
	$MuÉly
(cÚ¡ 
IÁeg”
 &
a
, cÚ¡ IÁeg” &
b
) const

4173 
wÜd
 *cÚ¡ 
T
 = 
m_wÜk¥aû
.
	`begš
();

4174 
wÜd
 *cÚ¡ 
R
 = 
m_»suÉ
.
»g
.
	`begš
();

4175 cÚ¡ 
size_t
 
N
 = 
m_modulus
.
»g
.
	`size
();

4176 
	`as£¹
(
a
.
»g
.
	`size
()<=
N
 && 
b
.reg.size()<=N);

4178 
	`Asymm‘ricMuÉly
(
T
, T+2*
N
, 
a
.
»g
,‡.»g.
	`size
(), 
b
.reg, b.reg.size());

4179 
	`S‘WÜds
(
T
+
a
.
»g
.
	`size
()+
b
.»g.size(), 0, 2*
N
-a.reg.size()-b.reg.size());

4180 
	`MÚtgom”yReduû
(
R
, 
T
+2*
N
, T, 
m_modulus
.
»g
, 
m_u
.reg, N);

4181  
m_»suÉ
;

4182 
	}
}

4184 cÚ¡ 
	gIÁeg”
& 
	gMÚtgom”yR•»£Á©iÚ
::
	$Squ¬e
(cÚ¡ 
IÁeg”
 &
a
) const

4186 
wÜd
 *cÚ¡ 
T
 = 
m_wÜk¥aû
.
	`begš
();

4187 
wÜd
 *cÚ¡ 
R
 = 
m_»suÉ
.
»g
.
	`begš
();

4188 cÚ¡ 
size_t
 
N
 = 
m_modulus
.
»g
.
	`size
();

4189 
	`as£¹
(
a
.
»g
.
	`size
()<=
N
);

4191 
Cry±oPP
::
	`Squ¬e
(
T
, T+2*
N
, 
a
.
»g
,‡.»g.
	`size
());

4192 
	`S‘WÜds
(
T
+2*
a
.
»g
.
	`size
(), 0, 2*
N
-2*a.reg.size());

4193 
	`MÚtgom”yReduû
(
R
, 
T
+2*
N
, T, 
m_modulus
.
»g
, 
m_u
.reg, N);

4194  
m_»suÉ
;

4195 
	}
}

4197 
IÁeg”
 
	gMÚtgom”yR•»£Á©iÚ
::
	$CÚv”tOut
(cÚ¡ 
IÁeg”
 &
a
) const

4199 
wÜd
 *cÚ¡ 
T
 = 
m_wÜk¥aû
.
	`begš
();

4200 
wÜd
 *cÚ¡ 
R
 = 
m_»suÉ
.
»g
.
	`begš
();

4201 cÚ¡ 
size_t
 
N
 = 
m_modulus
.
»g
.
	`size
();

4202 
	`as£¹
(
a
.
»g
.
	`size
()<=
N
);

4204 
	`CİyWÜds
(
T
, 
a
.
»g
,‡.»g.
	`size
());

4205 
	`S‘WÜds
(
T
+
a
.
»g
.
	`size
(), 0, 2*
N
-a.reg.size());

4206 
	`MÚtgom”yReduû
(
R
, 
T
+2*
N
, T, 
m_modulus
.
»g
, 
m_u
.reg, N);

4207  
m_»suÉ
;

4208 
	}
}

4210 cÚ¡ 
	gIÁeg”
& 
	gMÚtgom”yR•»£Á©iÚ
::
	$MuÉliÿtiveInv”£
(cÚ¡ 
IÁeg”
 &
a
) const

4213 
wÜd
 *cÚ¡ 
T
 = 
m_wÜk¥aû
.
	`begš
();

4214 
wÜd
 *cÚ¡ 
R
 = 
m_»suÉ
.
»g
.
	`begš
();

4215 cÚ¡ 
size_t
 
N
 = 
m_modulus
.
»g
.
	`size
();

4216 
	`as£¹
(
a
.
»g
.
	`size
()<=
N
);

4218 
	`CİyWÜds
(
T
, 
a
.
»g
,‡.»g.
	`size
());

4219 
	`S‘WÜds
(
T
+
a
.
»g
.
	`size
(), 0, 2*
N
-a.reg.size());

4220 
	`MÚtgom”yReduû
(
R
, 
T
+2*
N
, T, 
m_modulus
.
»g
, 
m_u
.reg, N);

4221 
k
 = 
	`Almo¡Inv”£
(
R
, 
T
, R, 
N
, 
m_modulus
.
»g
, N);

4225 ià(
k
>
N
*
WORD_BITS
)

4226 
	`DivideByPow”2Mod
(
R
, R, 
k
-
N
*
WORD_BITS
, 
m_modulus
.
»g
, N);

4228 
	`MuÉlyByPow”2Mod
(
R
, R, 
N
*
WORD_BITS
-
k
, 
m_modulus
.
»g
, N);

4230  
m_»suÉ
;

4231 
	}
}

4233 
	gNAMESPACE_END


	@integer.h

1 #iâdeà
CRYPTOPP_INTEGER_H


2 
	#CRYPTOPP_INTEGER_H


	)

6 
	~"üy±lib.h
"

7 
	~"£cblock.h
"

9 
	~<iosfwd
>

10 
	~<®gÜ™hm
>

12 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

14 
	sIn™ŸlizeIÁeg”


16 
	`In™ŸlizeIÁeg”
();

19 
SecBlock
<
	twÜd
, 
	tAÎoÿtÜW™hCËªup
<wÜd, 
	tCRYPTOPP_BOOL_X86
> > 
	tIÁeg”SecBlock
;

26 
şass
 
CRYPTOPP_DLL
 
IÁeg”
 : 
´iv©e
 
In™ŸlizeIÁeg”
, 
public
 
ASN1Objeù


28 
public
:

32 şas 
	cDivideByZ”o
 : 
public
 
Exû±iÚ


34 
public
:

35 
	`DivideByZ”o
(è: 
	`Exû±iÚ
(
OTHER_ERROR
, "Integer: division by zero") {}

36 
	}
};

39 şas 
	cRªdomNumb”NÙFound
 : 
public
 
Exû±iÚ


41 
public
:

42 
RªdomNumb”NÙFound
(è: 
Exû±iÚ
(
OTHER_ERROR
, "Integer:‚o integer satisfieshe given…arameters") {}

46 
	eSign
 {
	gPOSITIVE
=0, 
	gNEGATIVE
=1};

49 
	eSigÃdÃss
 {

51 
	gUNSIGNED
,

53 
	gSIGNED
};

56 
	eRªdomNumb”Ty³
 {

58 
	gANY
,

60 
	gPRIME
};

66 
IÁeg”
();

69 
IÁeg”
(cÚ¡ IÁeg”& 
t
);

72 
IÁeg”
(sigÃd 
v®ue
);

75 
IÁeg”
(
Sign
 
s
, 
lwÜd
 
v®ue
);

78 
IÁeg”
(
Sign
 
s
, 
wÜd
 
highWÜd
, wÜd 
lowWÜd
);

84 
ex¶ic™
 
IÁeg”
(cÚ¡ *
¡r
);

85 
ex¶ic™
 
IÁeg”
(cÚ¡ 
wch¬_t
 *
¡r
);

88 
IÁeg”
(cÚ¡ 
by‹
 *
’codedIÁeg”
, 
size_t
 
by‹CouÁ
, 
SigÃdÃss
 
s
=
UNSIGNED
);

91 
IÁeg”
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
, 
size_t
 
by‹CouÁ
, 
SigÃdÃss
 
s
=
UNSIGNED
);

94 
ex¶ic™
 
IÁeg”
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
);

98 
IÁeg”
(
RªdomNumb”G’”©Ü
 &
ºg
, 
size_t
 
b™couÁ
);

101 cÚ¡ 
	gIÁeg”
 & 
CRYPTOPP_API
 
Z”o
();

103 cÚ¡ 
	gIÁeg”
 & 
CRYPTOPP_API
 
OÃ
();

105 cÚ¡ 
	gIÁeg”
 & 
CRYPTOPP_API
 
Two
();

118 
IÁeg”
(
RªdomNumb”G’”©Ü
 &
ºg
, cÚ¡ IÁeg” &
mš
, cÚ¡ IÁeg” &
max
, 
RªdomNumb”Ty³
 
ºTy³
=
ANY
, cÚ¡ IÁeg” &
equiv
=
Z”o
(), cÚ¡ IÁeg” &
mod
=
OÃ
());

121 
IÁeg”
 
CRYPTOPP_API
 
Pow”2
(
size_t
 
e
);

128 
size_t
 
	$MšEncodedSize
(
SigÃdÃss
=
UNSIGNED
) const;

134 
	$Encode
(
by‹
 *
ouut
, 
size_t
 
ouutL’
, 
SigÃdÃss
=
UNSIGNED
) const;

136 
	$Encode
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
, 
size_t
 
ouutL’
, 
SigÃdÃss
=
UNSIGNED
) const;

139 
	$DEREncode
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
) const;

142 
	$DEREncodeAsOù‘SŒšg
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
, 
size_t
 
Ëngth
) const;

145 
size_t
 
	$O³nPGPEncode
(
by‹
 *
ouut
, 
size_t
 
bufãrSize
) const;

147 
size_t
 
	$O³nPGPEncode
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
) const;

150 
	`Decode
(cÚ¡ 
by‹
 *
šput
, 
size_t
 
šputL’
, 
SigÃdÃss
=
UNSIGNED
);

153 
	`Decode
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
, 
size_t
 
šputL’
, 
SigÃdÃss
=
UNSIGNED
);

156 
	`BERDecode
(cÚ¡ 
by‹
 *
šput
, 
size_t
 
šputL’
);

158 
	`BERDecode
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
);

161 
	`BERDecodeAsOù‘SŒšg
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
, 
size_t
 
Ëngth
);

163 şas 
	cO³nPGPDecodeE¼
 : 
public
 
Exû±iÚ


165 
public
:

166 
	`O³nPGPDecodeE¼
(è: 
	`Exû±iÚ
(
INVALID_DATA_FORMAT
, "OpenPGP decodeƒrror") {}

167 
	}
};

170 
O³nPGPDecode
(cÚ¡ 
by‹
 *
šput
, 
size_t
 
šputL’
);

172 
O³nPGPDecode
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
);

178 
boŞ
 
	$IsCÚv”bËToLÚg
() const;

180 sigÃd 
	$CÚv”tToLÚg
() const;

183 
	$B™CouÁ
() const;

185 
	$By‹CouÁ
() const;

187 
	$WÜdCouÁ
() const;

190 
boŞ
 
	$G‘B™
(
size_t
 
i
) const;

192 
by‹
 
	$G‘By‹
(
size_t
 
i
) const;

194 
lwÜd
 
	$G‘B™s
(
size_t
 
i
, size_ˆ
n
) const;

197 
boŞ
 
	$IsZ”o
(ècÚ¡ { !*
this
;
	}
}

199 
boŞ
 
	$NÙZ”o
(ècÚ¡ { !
	`IsZ”o
();
	}
}

201 
boŞ
 
	$IsNeg©ive
(ècÚ¡ { 
sign
 =ğ
NEGATIVE
;
	}
}

203 
boŞ
 
	$NÙNeg©ive
(ècÚ¡ { !
	`IsNeg©ive
();
	}
}

205 
boŞ
 
	$IsPos™ive
(ècÚ¡ { 
	`NÙNeg©ive
(è&& 
	`NÙZ”o
();
	}
}

207 
boŞ
 
	$NÙPos™ive
(ècÚ¡ { !
	`IsPos™ive
();
	}
}

209 
boŞ
 
	$IsEv’
(ècÚ¡ { 
	`G‘B™
(0è=ğ0;
	}
}

211 
boŞ
 
	$IsOdd
(ècÚ¡ { 
	`G‘B™
(0è=ğ1;
	}
}

217 
	gIÁeg”
& 
	gİ”©Ü
=(cÚ¡ 
IÁeg”
& 
t
);

220 
	gIÁeg”
& 
	gİ”©Ü
+=(cÚ¡ 
IÁeg”
& 
t
);

222 
	gIÁeg”
& 
	gİ”©Ü
-=(cÚ¡ 
IÁeg”
& 
t
);

224 
	gIÁeg”
& 
	gİ”©Ü
*=(cÚ¡ 
IÁeg”
& 
t
è{ *
this
 = 
Times
(t);}

226 
	gIÁeg”
& 
	gİ”©Ü
/=(cÚ¡ 
IÁeg”
& 
t
è{ *
this
 = 
DividedBy
(t);}

228 
	gIÁeg”
& 
	gİ”©Ü
%=(cÚ¡ 
IÁeg”
& 
t
è{ *
this
 = 
Modulo
(t);}

230 
	gIÁeg”
& 
	gİ”©Ü
/=(
wÜd
 
t
è{ *
this
 = 
DividedBy
(t);}

232 
	gIÁeg”
& 
	gİ”©Ü
%=(
wÜd
 
t
è{ *
this
 = 
IÁeg”
(
POSITIVE
, 0, 
Modulo
(t));}

235 
	gIÁeg”
& 
	gİ”©Ü
<<=(
size_t
);

237 
	gIÁeg”
& 
	gİ”©Ü
>>=(
size_t
);

240 
Rªdomize
(
RªdomNumb”G’”©Ü
 &
ºg
, 
size_t
 
b™couÁ
);

242 
Rªdomize
(
RªdomNumb”G’”©Ü
 &
ºg
, cÚ¡ 
IÁeg”
 &
mš
, cÚ¡ IÁeg” &
max
);

245 
boŞ
 
Rªdomize
(
RªdomNumb”G’”©Ü
 &
ºg
, cÚ¡ 
IÁeg”
 &
mš
, cÚ¡ IÁeg” &
max
, 
RªdomNumb”Ty³
 
ºTy³
, cÚ¡ IÁeg” &
equiv
=
Z”o
(), cÚ¡ IÁeg” &
mod
=
OÃ
());

247 
boŞ
 
G’”©eRªdomNoThrow
(
RªdomNumb”G’”©Ü
 &
ºg
, cÚ¡ 
NameV®uePaœs
 &
·¿ms
 = 
g_nuÎNameV®uePaœs
);

248 
	$G’”©eRªdom
(
RªdomNumb”G’”©Ü
 &
ºg
, cÚ¡ 
NameV®uePaœs
 &
·¿ms
 = 
g_nuÎNameV®uePaœs
)

250 ià(!
	`G’”©eRªdomNoThrow
(
ºg
, 
·¿ms
))

251 
throw
 
	`RªdomNumb”NÙFound
();

252 
	}
}

255 
S‘B™
(
size_t
 
n
, 
boŞ
 
v®ue
=1);

257 
S‘By‹
(
size_t
 
n
, 
by‹
 
v®ue
);

260 
Neg©e
();

262 
	$S‘Pos™ive
(è{
sign
 = 
POSITIVE
;
	}
}

264 
	$S‘Neg©ive
(è{ià(!!(*
this
)è
sign
 = 
NEGATIVE
;
	}
}

267 
sw­
(
IÁeg”
 &
a
);

273 
boŞ
 
	gİ”©Ü
!() const;

275 
IÁeg”
 
	gİ”©Ü
+(ècÚ¡ { *
	gthis
;}

277 
IÁeg”
 
	gİ”©Ü
-() const;

279 
	gIÁeg”
& 
	gİ”©Ü
++();

281 
	gIÁeg”
& 
	gİ”©Ü
--();

283 
IÁeg”
 
	gİ”©Ü
++(è{IÁeg” 
	g‹mp
 = *
this
; ++*
	gthis
; emp;}

285 
IÁeg”
 
	gİ”©Ü
--(è{IÁeg” 
	g‹mp
 = *
this
; --*
	gthis
; emp;}

295 
	$Com·»
(cÚ¡ 
IÁeg”
& 
a
) const;

298 
IÁeg”
 
	$Plus
(cÚ¡ 
IÁeg”
 &
b
) const;

300 
IÁeg”
 
	$Mšus
(cÚ¡ 
IÁeg”
 &
b
) const;

302 
IÁeg”
 
	$Times
(cÚ¡ 
IÁeg”
 &
b
) const;

304 
IÁeg”
 
	$DividedBy
(cÚ¡ 
IÁeg”
 &
b
) const;

306 
IÁeg”
 
	$Modulo
(cÚ¡ 
IÁeg”
 &
b
) const;

308 
IÁeg”
 
	$DividedBy
(
wÜd
 
b
) const;

310 
wÜd
 
	$Modulo
(
wÜd
 
b
) const;

313 
IÁeg”
 
İ”©Ü
>>(
size_t
 
n
ècÚ¡ { 
	`IÁeg”
(*
this
)>>ò;
	}
}

315 
IÁeg”
 
	gİ”©Ü
<<(
size_t
 
	gn
ècÚ¡ { IÁeg”(*
this
)<<=
n
;}

321 
IÁeg”
 
	$AbsŞu‹V®ue
() const;

323 
IÁeg”
 
	$DoubËd
(ècÚ¡ { 
	`Plus
(*
this
);
	}
}

325 
IÁeg”
 
	$Squ¬ed
(ècÚ¡ { 
	`Times
(*
this
);
	}
}

327 
IÁeg”
 
	$Squ¬eRoÙ
() const;

329 
boŞ
 
	$IsSqu¬e
() const;

332 
boŞ
 
	$IsUn™
() const;

334 
IÁeg”
 
	$MuÉliÿtiveInv”£
() const;

337 
CRYPTOPP_DLL
 
ä›nd
 
IÁeg”
 
CRYPTOPP_API
 
	`a_times_b_mod_c
(cÚ¡ IÁeg” &
x
, cÚ¡ IÁeg”& 
y
, cÚ¡ IÁeg”& 
m
);

339 
CRYPTOPP_DLL
 
ä›nd
 
IÁeg”
 
CRYPTOPP_API
 
	`a_exp_b_mod_c
(cÚ¡ IÁeg” &
x
, cÚ¡ IÁeg”& 
e
, cÚ¡ IÁeg”& 
m
);

342 
CRYPTOPP_API
 
	`Divide
(
IÁeg”
 &
r
, IÁeg” &
q
, cÚ¡ IÁeg” &
a
, cÚ¡ IÁeg” &
d
);

344 
CRYPTOPP_API
 
	`Divide
(
wÜd
 &
r
, 
IÁeg”
 &
q
, cÚ¡ IÁeg” &
a
, wÜd 
d
);

347 
CRYPTOPP_API
 
	`DivideByPow”Of2
(
IÁeg”
 &
r
, IÁeg” &
q
, cÚ¡ IÁeg” &
a
, 
n
);

350 
IÁeg”
 
CRYPTOPP_API
 
	`Gcd
(cÚ¡ IÁeg” &
a
, cÚ¡ IÁeg” &
n
);

352 
IÁeg”
 
	$Inv”£Mod
(cÚ¡ 
IÁeg”
 &
n
) const;

354 
wÜd
 
	$Inv”£Mod
(
wÜd
 
n
) const;

360 
ä›nd
 
CRYPTOPP_DLL
 
¡d
::
i¡»am
& 
CRYPTOPP_API
 
İ”©Ü
>>(¡d::i¡»am& 
š
, 
IÁeg”
 &
a
);

362 
ä›nd
 
CRYPTOPP_DLL
 
¡d
::
o¡»am
& 
CRYPTOPP_API
 
İ”©Ü
<<(¡d::o¡»am& 
out
, cÚ¡ 
IÁeg”
 &
a
);

365 
´iv©e
:

366 
ä›nd
 
şass
 
ModuÏrAr™hm‘ic
;

367 
ä›nd
 
şass
 
MÚtgom”yR•»£Á©iÚ
;

368 
ä›nd
 
şass
 
H®fMÚtgom”yR•»£Á©iÚ
;

370 
	`IÁeg”
(
wÜd
 
v®ue
, 
size_t
 
Ëngth
);

372 
	$Pos™iveCom·»
(cÚ¡ 
IÁeg”
 &
t
) const;

373 
ä›nd
 
	`Pos™iveAdd
(
IÁeg”
 &
sum
, cÚ¡ IÁeg” &
a
, cÚ¡ IÁeg” &
b
);

374 
ä›nd
 
	`Pos™iveSubŒaù
(
IÁeg”
 &
diff
, cÚ¡ IÁeg” &
a
, cÚ¡ IÁeg” &
b
);

375 
ä›nd
 
	`Pos™iveMuÉly
(
IÁeg”
 &
´oduù
, cÚ¡ IÁeg” &
a
, cÚ¡ IÁeg” &
b
);

376 
ä›nd
 
	`Pos™iveDivide
(
IÁeg”
 &
»mašd”
, IÁeg” &
quÙ›Á
, cÚ¡ IÁeg” &
divid’d
, cÚ¡ IÁeg” &
divisÜ
);

378 
IÁeg”SecBlock
 
»g
;

379 
Sign
 
sign
;

380 
	}
};

383 
šlše
 
boŞ
 
	gİ”©Ü
==(cÚ¡ 
Cry±oPP
::
IÁeg”
& 
a
, cÚ¡ 
	gCry±oPP
::IÁeg”& 
b
è{‡.
Com·»
(b)==0;}

385 
šlše
 
boŞ
 
	gİ”©Ü
!=(cÚ¡ 
Cry±oPP
::
IÁeg”
& 
a
, cÚ¡ 
	gCry±oPP
::IÁeg”& 
b
è{‡.
Com·»
(b)!=0;}

387 
šlše
 
boŞ
 
	gİ”©Ü
> (cÚ¡ 
	gCry±oPP
::
IÁeg”
& 
a
, cÚ¡ Cry±oPP::IÁeg”& 
b
è{‡.
Com·»
(b)> 0;}

389 
šlše
 
boŞ
 
	gİ”©Ü
>=(cÚ¡ 
Cry±oPP
::
IÁeg”
& 
a
, cÚ¡ 
	gCry±oPP
::IÁeg”& 
b
è{‡.
Com·»
(b)>=0;}

391 
šlše
 
boŞ
 
	gİ”©Ü
< (cÚ¡ 
	gCry±oPP
::
IÁeg”
& 
a
, cÚ¡ Cry±oPP::IÁeg”& 
b
è{‡.
Com·»
(b)< 0;}

393 
šlše
 
boŞ
 
	gİ”©Ü
<=(cÚ¡ 
Cry±oPP
::
IÁeg”
& 
a
, cÚ¡ 
	gCry±oPP
::IÁeg”& 
b
è{‡.
Com·»
(b)<=0;}

395 
šlše
 
	gCry±oPP
::
IÁeg”
 
İ”©Ü
+(cÚ¡ 
Cry±oPP
::IÁeg” &
a
, cÚ¡ Cry±oPP::IÁeg” &
b
è{‡.
Plus
(b);}

397 
šlše
 
	gCry±oPP
::
IÁeg”
 
İ”©Ü
-(cÚ¡ 
Cry±oPP
::IÁeg” &
a
, cÚ¡ Cry±oPP::IÁeg” &
b
è{‡.
Mšus
(b);}

399 
šlše
 
	gCry±oPP
::
IÁeg”
 
İ”©Ü
*(cÚ¡ 
Cry±oPP
::IÁeg” &
a
, cÚ¡ Cry±oPP::IÁeg” &
b
è{‡.
Times
(b);}

401 
šlše
 
	gCry±oPP
::
IÁeg”
 
İ”©Ü
/(cÚ¡ 
Cry±oPP
::IÁeg” &
a
, cÚ¡ Cry±oPP::IÁeg” &
b
è{‡.
DividedBy
(b);}

403 
šlše
 
	gCry±oPP
::
IÁeg”
 
İ”©Ü
%(cÚ¡ 
Cry±oPP
::IÁeg” &
a
, cÚ¡ Cry±oPP::IÁeg” &
b
è{‡.
Modulo
(b);}

405 
šlše
 
	gCry±oPP
::
IÁeg”
 
İ”©Ü
/(cÚ¡ 
Cry±oPP
::IÁeg” &
a
, Cry±oPP::
wÜd
 
b
è{‡.
DividedBy
(b);}

407 
šlše
 
	gCry±oPP
::
wÜd
 
İ”©Ü
%(cÚ¡ 
Cry±oPP
::
IÁeg”
 &
a
, Cry±oPP::wÜd 
b
è{‡.
Modulo
(b);}

409 
	gNAMESPACE_END


411 #iâdeà
__BORLANDC__


412 
	$NAMESPACE_BEGIN
(
¡d
)

413 
šlše
 
	$sw­
(
Cry±oPP
::
IÁeg”
 &
a
, Cry±oPP::IÁeg” &
b
)

415 
a
.
	`sw­
(
b
);

416 
	}
}

417 
	gNAMESPACE_END


	@iterhash.cpp

3 #iâdeà
__GNUC__


4 
	#CRYPTOPP_MANUALLY_INSTANTIATE_TEMPLATES


	)

7 
	~"™”hash.h
"

8 
	~"misc.h
"

10 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

12 
‹m¶©e
 <
şass
 
T
, cÏs 
BASE
> 
I‹¿‹dHashBa£
<T, BASE>::
	$Upd©e
(cÚ¡ 
by‹
 *
šput
, 
size_t
 
Ën
)

14 
HashWÜdTy³
 
ŞdCouÁLo
 = 
m_couÁLo
, 
ŞdCouÁHi
 = 
m_couÁHi
;

15 ià((
m_couÁLo
 = 
ŞdCouÁLo
 + 
	`HashWÜdTy³
(
Ën
)) < oldCountLo)

16 
m_couÁHi
++;

17 
m_couÁHi
 +ğ(
HashWÜdTy³
)
SaãRightShiá
<8*(HashWÜdTy³)>(
Ën
);

18 ià(
m_couÁHi
 < 
ŞdCouÁHi
 || 
SaãRightShiá
<2*8*(
HashWÜdTy³
)>(
Ën
) != 0)

19 
throw
 
	`HashIÅutTooLÚg
(
this
->
	`AlgÜ™hmName
());

21 
blockSize
 = 
this
->
	`BlockSize
();

22 
num
 = 
	`ModPow”Of2
(
ŞdCouÁLo
, 
blockSize
);

23 
T
* 
d©aBuf
 = 
this
->
	`D©aBuf
();

24 
by‹
* 
d©a
 = (by‹ *)
d©aBuf
;

26 ià(
num
 != 0)

28 ià(
num
+
Ën
 >ğ
blockSize
)

30 
	`memıy
(
d©a
+
num
, 
šput
, 
blockSize
-num);

31 
	`HashBlock
(
d©aBuf
);

32 
šput
 +ğ(
blockSize
-
num
);

33 
Ën
 -ğ(
blockSize
-
num
);

34 
num
 = 0;

39 
	`memıy
(
d©a
+
num
, 
šput
, 
Ën
);

45 ià(
Ën
 >ğ
blockSize
)

47 ià(
šput
 =ğ
d©a
)

49 
	`as£¹
(
Ën
 =ğ
blockSize
);

50 
	`HashBlock
(
d©aBuf
);

53 ià(
IsAligÃd
<
T
>(
šput
))

55 
size_t
 
ËáOv”
 = 
	`HashMuÉËBlocks
((
T
 *)
šput
, 
Ën
);

56 
šput
 +ğ(
Ën
 - 
ËáOv”
);

57 
Ën
 = 
ËáOv”
;

62 
	`memıy
(
d©a
, 
šput
, 
blockSize
);

63 
	`HashBlock
(
d©aBuf
);

64 
šput
+=
blockSize
;

65 
Ën
-=
blockSize
;

66 } 
Ën
 >ğ
blockSize
);

69 ià(
Ën
 && 
d©a
 !ğ
šput
)

70 
	`memıy
(
d©a
, 
šput
, 
Ën
);

71 
	}
}

73 
	g‹m¶©e
 <
şass
 
	gT
, cÏs 
	gBASE
> 
by‹
 * 
	gI‹¿‹dHashBa£
<T, BASE>::
	$C»©eUpd©eS·û
(
size_t
 &
size
)

75 
blockSize
 = 
this
->
	`BlockSize
();

76 
num
 = 
	`ModPow”Of2
(
m_couÁLo
, 
blockSize
);

77 
size
 = 
blockSize
 - 
num
;

78  (
by‹
 *)
	`D©aBuf
(è+ 
num
;

79 
	}
}

81 
	g‹m¶©e
 <
şass
 
	gT
, cÏs 
	gBASE
> 
size_t
 
	gI‹¿‹dHashBa£
<T, BASE>::
	$HashMuÉËBlocks
(cÚ¡ 
T
 *
šput
, 
size_t
 
Ëngth
)

83 
blockSize
 = 
this
->
	`BlockSize
();

84 
boŞ
 
noRev”£
 = 
	`N©iveBy‹Ord”Is
(
this
->
	`G‘By‹Ord”
());

85 
T
* 
d©aBuf
 = 
this
->
	`D©aBuf
();

88 ià(
noRev”£
)

89 
this
->
	`HashEndŸnCÜ»ùedBlock
(
šput
);

92 
	`By‹Rev”£
(
d©aBuf
, 
šput
, 
this
->
	`BlockSize
());

93 
this
->
	`HashEndŸnCÜ»ùedBlock
(
d©aBuf
);

96 
šput
 +ğ
blockSize
/(
T
);

97 
Ëngth
 -ğ
blockSize
;

99 
Ëngth
 >ğ
blockSize
);

100  
Ëngth
;

101 
	}
}

103 
	g‹m¶©e
 <
şass
 
	gT
, cÏs 
	gBASE
> 
	gI‹¿‹dHashBa£
<T, BASE>::
	$PadLa¡Block
(
Ï¡BlockSize
, 
by‹
 
·dFœ¡
)

105 
blockSize
 = 
this
->
	`BlockSize
();

106 
num
 = 
	`ModPow”Of2
(
m_couÁLo
, 
blockSize
);

107 
T
* 
d©aBuf
 = 
this
->
	`D©aBuf
();

108 
by‹
* 
d©a
 = (by‹ *)
d©aBuf
;

109 
d©a
[
num
++] = 
·dFœ¡
;

110 ià(
num
 <ğ
Ï¡BlockSize
)

111 
	`mem£t
(
d©a
+
num
, 0, 
Ï¡BlockSize
-num);

114 
	`mem£t
(
d©a
+
num
, 0, 
blockSize
-num);

115 
	`HashBlock
(
d©aBuf
);

116 
	`mem£t
(
d©a
, 0, 
Ï¡BlockSize
);

118 
	}
}

120 
	g‹m¶©e
 <
şass
 
	gT
, cÏs 
	gBASE
> 
	gI‹¿‹dHashBa£
<T, BASE>::
	$Re¡¬t
()

122 
m_couÁLo
 = 
m_couÁHi
 = 0;

123 
	`In™
();

124 
	}
}

126 
	g‹m¶©e
 <
şass
 
	gT
, cÏs 
	gBASE
> 
	gI‹¿‹dHashBa£
<T, BASE>::
	$Trunÿ‹dFš®
(
by‹
 *
dige¡
, 
size_t
 
size
)

128 
this
->
	`ThrowIfInv®idTrunÿ‹dSize
(
size
);

130 
T
* 
d©aBuf
 = 
this
->
	`D©aBuf
();

131 
T
* 
¡©eBuf
 = 
this
->
	`S‹Buf
();

132 
blockSize
 = 
this
->
	`BlockSize
();

133 
By‹Ord”
 
Üd”
 = 
this
->
	`G‘By‹Ord”
();

135 
	`PadLa¡Block
(
blockSize
 - 2*(
HashWÜdTy³
));

136 
d©aBuf
[
blockSize
/(
T
)-2+
Üd”
] = 
	`CÚd™iÚ®By‹Rev”£
(Üd”, 
this
->
	`G‘B™CouÁLo
());

137 
d©aBuf
[
blockSize
/(
T
)-1-
Üd”
] = 
	`CÚd™iÚ®By‹Rev”£
(Üd”, 
this
->
	`G‘B™CouÁHi
());

139 
	`HashBlock
(
d©aBuf
);

141 ià(
IsAligÃd
<
HashWÜdTy³
>(
dige¡
è&& 
size
%(HashWordType)==0)

142 
CÚd™iÚ®By‹Rev”£
<
HashWÜdTy³
>(
Üd”
, (HashWÜdTy³ *)
dige¡
, 
¡©eBuf
, 
size
);

145 
CÚd™iÚ®By‹Rev”£
<
HashWÜdTy³
>(
Üd”
, 
¡©eBuf
, s‹Buf, 
this
->
	`Dige¡Size
());

146 
	`memıy
(
dige¡
, 
¡©eBuf
, 
size
);

149 
this
->
	`Re¡¬t
();

150 
	}
}

152 #ifdeà
__GNUC__


153 
‹m¶©e
 
şass
 
	gI‹¿‹dHashBa£
<
	gwÜd64
, 
	gHashT¿nsfÜm©iÚ
>;

154 
‹m¶©e
 
şass
 
	gI‹¿‹dHashBa£
<
	gwÜd64
, 
	gMes§geAuth’tiÿtiÚCode
>;

156 
‹m¶©e
 
şass
 
	gI‹¿‹dHashBa£
<
	gwÜd32
, 
	gHashT¿nsfÜm©iÚ
>;

157 
‹m¶©e
 
şass
 
	gI‹¿‹dHashBa£
<
	gwÜd32
, 
	gMes§geAuth’tiÿtiÚCode
>;

160 
	gNAMESPACE_END


	@iterhash.h

1 #iâdeà
CRYPTOPP_ITERHASH_H


2 
	#CRYPTOPP_ITERHASH_H


	)

4 
	~"üy±lib.h
"

5 
	~"£cblock.h
"

6 
	~"misc.h
"

7 
	~"sim¶e.h
"

9 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

12 şas 
	cCRYPTOPP_DLL
 
HashIÅutTooLÚg
 : 
public
 
Inv®idD©aFÜm©


14 
public
:

15 
ex¶ic™
 
	$HashIÅutTooLÚg
(cÚ¡ 
¡d
::
¡ršg
 &
®g
)

16 : 
	`Inv®idD©aFÜm©
("I‹¿‹dHashBa£: iÅuˆd©¨exûed maximum‡Îowed by hash funùiÚ " + 
®g
) {}

17 
	}
};

20 
	g‹m¶©e
 <
şass
 
	gT
, cÏs 
	gBASE
>

21 şas 
	cCRYPTOPP_NO_VTABLE
 
	mI‹¿‹dHashBa£
 : 
public
 
BASE


23 
public
:

24 
T
 
	tHashWÜdTy³
;

26 
	$I‹¿‹dHashBa£
(è: 
	`m_couÁLo
(0), 
	$m_couÁHi
(0) {}

27 
	$O±im®BlockSize
(ècÚ¡ { 
this
->
	`BlockSize
();
	}
}

28 
	$O±im®D©aAlignm’t
(ècÚ¡ { 
G‘Alignm’tOf
<
T
>();
	}
}

29 
Upd©e
(cÚ¡ 
by‹
 *
šput
, 
size_t
 
Ëngth
);

30 
by‹
 * 
C»©eUpd©eS·û
(
size_t
 &
size
);

31 
Re¡¬t
();

32 
Trunÿ‹dFš®
(
by‹
 *
dige¡
, 
size_t
 
size
);

34 
	g´Ùeùed
:

35 
šlše
 
T
 
	$G‘B™CouÁHi
(ècÚ¡ { (
m_couÁLo
 >> (8*(
T
)-3)è+ (
m_couÁHi
 << 3);
	}
}

36 
šlše
 
T
 
	$G‘B™CouÁLo
(ècÚ¡ { 
m_couÁLo
 << 3;
	}
}

38 
PadLa¡Block
(
Ï¡BlockSize
, 
by‹
 
·dFœ¡
=0x80);

39 
vœtu®
 
In™
() =0;

41 
vœtu®
 
By‹Ord”
 
	$G‘By‹Ord”
() const =0;

42 
vœtu®
 
	`HashEndŸnCÜ»ùedBlock
(cÚ¡ 
HashWÜdTy³
 *
d©a
) =0;

43 
vœtu®
 
size_t
 
	`HashMuÉËBlocks
(cÚ¡ 
T
 *
šput
, size_ˆ
Ëngth
);

44 
	$HashBlock
(cÚ¡ 
HashWÜdTy³
 *
šput
è{
	`HashMuÉËBlocks
(šput, 
this
->
	`BlockSize
());
	}
}

46 
vœtu®
 
T
* 
D©aBuf
() =0;

47 
vœtu®
 
T
* 
S‹Buf
() =0;

49 
	g´iv©e
:

50 
T
 
m_couÁLo
, 
	gm_couÁHi
;

54 
	g‹m¶©e
 <
şass
 
	gT_HashWÜdTy³
, cÏs 
	gT_EndŸÂess
, 
	gT_BlockSize
, cÏs 
	gT_Ba£
 = 
HashT¿nsfÜm©iÚ
>

55 
şass
 
CRYPTOPP_NO_VTABLE
 
I‹¿‹dHash
 : 
public
 
I‹¿‹dHashBa£
<
T_HashWÜdTy³
, 
	gT_Ba£
>

57 
	gpublic
:

58 
T_EndŸÂess
 
	tBy‹Ord”CÏss
;

59 
T_HashWÜdTy³
 
	tHashWÜdTy³
;

61 
CRYPTOPP_CONSTANT
(
BLOCKSIZE
 = 
T_BlockSize
)

63 
CRYPTOPP_COMPILE_ASSERT
((
T_BlockSize
 & (T_BlockSize - 1)) == 0);

64 
BlockSize
(ècÚ¡ { 
	gT_BlockSize
;}

66 
By‹Ord”
 
G‘By‹Ord”
(ècÚ¡ { 
	gT_EndŸÂess
::
ToEnum
();}

68 
šlše
 
CÜ»ùEndŸÃss
(
HashWÜdTy³
 *
out
, cÚ¡ HashWÜdTy³ *
š
, 
size_t
 
by‹CouÁ
)

70 
CÚd™iÚ®By‹Rev”£
(
T_EndŸÂess
::
ToEnum
(), 
out
, 
š
, 
by‹CouÁ
);

73 
	g´Ùeùed
:

74 
T_HashWÜdTy³
* 
D©aBuf
(è{ 
this
->
m_d©a
;}

75 
	gFixedSizeSecBlock
<
	gT_HashWÜdTy³
, 
	gT_BlockSize
/(T_HashWÜdTy³)> 
	gm_d©a
;

79 
	g‹m¶©e
 <
şass
 
	gT_HashWÜdTy³
, cÏs 
	gT_EndŸÂess
, 
	gT_BlockSize
, 
	gT_S‹Size
, cÏs 
	gT_T¿nsfÜm
, 
	gT_Dige¡Size
 = 0, 
boŞ
 
	gT_S‹AligÃd
 = 
çl£
>

80 
şass
 
CRYPTOPP_NO_VTABLE
 
I‹¿‹dHashW™hSticT¿nsfÜm


81 : 
public
 
ClÚabËIm¶
<
T_T¿nsfÜm
, 
	gAlgÜ™hmIm¶
<
	gI‹¿‹dHash
<
	gT_HashWÜdTy³
, 
	gT_EndŸÂess
, 
	gT_BlockSize
>, 
	gT_T¿nsfÜm
> >

83 
	gpublic
:

84 
CRYPTOPP_CONSTANT
(
DIGESTSIZE
 = 
T_Dige¡Size
 ? T_Dige¡Siz: 
T_S‹Size
)

85 
Dige¡Size
(ècÚ¡ { 
DIGESTSIZE
;};

87 
	g´Ùeùed
:

88 
I‹¿‹dHashW™hSticT¿nsfÜm
(è{
this
->
In™
();}

89 
HashEndŸnCÜ»ùedBlock
(cÚ¡ 
T_HashWÜdTy³
 *
d©a
è{
	gT_T¿nsfÜm
::
T¿nsfÜm
(
this
->
m_¡©e
, data);}

90 
In™
(è{
	gT_T¿nsfÜm
::
In™S‹
(
this
->
m_¡©e
);}

92 
T_HashWÜdTy³
* 
S‹Buf
(è{ 
	gthis
->
	gm_¡©e
;}

93 
	gFixedSizeAligÃdSecBlock
<
	gT_HashWÜdTy³
, 
	gT_BlockSize
/(T_HashWÜdTy³), 
	gT_S‹AligÃd
> 
	gm_¡©e
;

96 #iâdeà
__GNUC__


97 
CRYPTOPP_DLL_TEMPLATE_CLASS
 
	gI‹¿‹dHashBa£
<
	gwÜd64
, 
	gHashT¿nsfÜm©iÚ
>;

98 
CRYPTOPP_STATIC_TEMPLATE_CLASS
 
	gI‹¿‹dHashBa£
<
	gwÜd64
, 
	gMes§geAuth’tiÿtiÚCode
>;

100 
CRYPTOPP_DLL_TEMPLATE_CLASS
 
	gI‹¿‹dHashBa£
<
	gwÜd32
, 
	gHashT¿nsfÜm©iÚ
>;

101 
CRYPTOPP_STATIC_TEMPLATE_CLASS
 
	gI‹¿‹dHashBa£
<
	gwÜd32
, 
	gMes§geAuth’tiÿtiÚCode
>;

104 
	gNAMESPACE_END


	@lubyrack.h

3 #iâdeà
CRYPTOPP_LUBYRACK_H


4 
	#CRYPTOPP_LUBYRACK_H


	)

8 
	~"sim¶e.h
"

9 
	~"£cblock.h
"

11 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

13 
‹m¶©e
 <
şass
 
T
> 
	sDige¡SizeDoubËWÜk¬ound


15 
	`CRYPTOPP_CONSTANT
(
RESULT
 = 2*
T
::
DIGESTSIZE
)

19 
‹m¶©e
 <
şass
 
T
>

20 
LR_Info
 : 
public
 
V¬ŸbËKeyL’gth
<16, 0, 2*(
INT_MAX
/2), 2>,…ubliø
FixedBlockSize
<
Dige¡SizeDoubËWÜk¬ound
<
T
>::
RESULT
>

22 
¡d
::
¡ršg
 
	`SticAlgÜ™hmName
(è{ std::
	`¡ršg
("LR/")+
T
::StaticAlgorithmName();}

23 
	}
};

26 
	g‹m¶©e
 <
şass
 
	gT
>

27 
şass
 
	gLR
 : 
public
 
LR_Info
<
T
>,…ubliø
	gBlockCh”Docum’tiÚ


29 
şass
 
CRYPTOPP_NO_VTABLE
 
	gBa£
 : 
public
 
BlockCh”Im¶
<
LR_Info
<
T
> >

31 
public
:

33 
UncheckedS‘Key
(cÚ¡ 
by‹
 *
u£rKey
, 
Ëngth
, cÚ¡ 
NameV®uePaœs
 &
·¿ms
)

35 
	gthis
->
As£¹V®idKeyL’gth
(
Ëngth
);

37 
	gL
 = 
Ëngth
/2;

38 
	gbufãr
.
New
(2*
S
);

39 
	gdige¡
.
New
(
S
);

40 
	gkey
.
Assign
(
u£rKey
, 2*
L
);

43 
	g´Ùeùed
:

44 
CRYPTOPP_CONSTANT
(
S
=
T
::
DIGESTSIZE
)

45 
L
;

46 
SecBy‹Block
 
	gkey
;

48 
mubË
 
T
 
	ghm
;

49 
mubË
 
SecBy‹Block
 
	gbufãr
, 
	gdige¡
;

52 şas 
	cCRYPTOPP_NO_VTABLE
 
	gEnc
 : 
public
 
Ba£


54 
public
:

56 
	#KL
 
this
->
key


	)

57 
	#KR
 
this
->
key
+this->
L


	)

58 
	#BL
 
this
->
bufãr


	)

59 
	#BR
 
this
->
bufãr
+this->
S


	)

60 
	#IL
 
šBlock


	)

61 
	#IR
 
šBlock
+
this
->
S


	)

62 
	#OL
 
outBlock


	)

63 
	#OR
 
outBlock
+
this
->
S


	)

65 
ProûssAndXÜBlock
(cÚ¡ 
by‹
 *
šBlock
, cÚ¡ by‹ *
xÜBlock
, by‹ *
outBlock
) const

67 
	gthis
->
	ghm
.
Upd©e
(
KL
, 
this
->
L
);

68 
	gthis
->
	ghm
.
Upd©e
(
IL
, 
this
->
S
);

69 
	gthis
->
	ghm
.
Fš®
(
BR
);

70 
xÜbuf
(
BR
, 
IR
, 
this
->
S
);

72 
	gthis
->
	ghm
.
Upd©e
(
KR
, 
this
->
L
);

73 
	gthis
->
	ghm
.
Upd©e
(
BR
, 
this
->
S
);

74 
	gthis
->
	ghm
.
Fš®
(
BL
);

75 
xÜbuf
(
BL
, 
IL
, 
this
->
S
);

77 
	gthis
->
	ghm
.
Upd©e
(
KL
, 
this
->
L
);

78 
	gthis
->
	ghm
.
Upd©e
(
BL
, 
this
->
S
);

79 
	gthis
->
	ghm
.
Fš®
(
this
->
dige¡
);

80 
xÜbuf
(
BR
, 
this
->
dige¡
,his->
S
);

82 
	gthis
->
	ghm
.
Upd©e
(
KR
, 
this
->
L
);

83 
	gthis
->
	ghm
.
Upd©e
(
OR
, 
this
->
S
);

84 
	gthis
->
	ghm
.
Fš®
(
this
->
dige¡
);

85 
xÜbuf
(
BL
, 
this
->
dige¡
,his->
S
);

87 ià(
	gxÜBlock
)

88 
xÜbuf
(
outBlock
, 
xÜBlock
, 
this
->
bufãr
, 2*this->
S
);

90 
memıy_s
(
outBlock
, 2*
this
->
S
,his->
bufãr
, 2*this->S);

94 şas 
	cCRYPTOPP_NO_VTABLE
 
	gDec
 : 
public
 
Ba£


96 
public
:

97 
ProûssAndXÜBlock
(cÚ¡ 
by‹
 *
šBlock
, cÚ¡ by‹ *
xÜBlock
, by‹ *
outBlock
) const

99 
	gthis
->
	ghm
.
Upd©e
(
KR
, 
this
->
L
);

100 
	gthis
->
	ghm
.
Upd©e
(
IR
, 
this
->
S
);

101 
	gthis
->
	ghm
.
Fš®
(
BL
);

102 
xÜbuf
(
BL
, 
IL
, 
this
->
S
);

104 
	gthis
->
	ghm
.
Upd©e
(
KL
, 
this
->
L
);

105 
	gthis
->
	ghm
.
Upd©e
(
BL
, 
this
->
S
);

106 
	gthis
->
	ghm
.
Fš®
(
BR
);

107 
xÜbuf
(
BR
, 
IR
, 
this
->
S
);

109 
	gthis
->
	ghm
.
Upd©e
(
KR
, 
this
->
L
);

110 
	gthis
->
	ghm
.
Upd©e
(
BR
, 
this
->
S
);

111 
	gthis
->
	ghm
.
Fš®
(
this
->
dige¡
);

112 
xÜbuf
(
BL
, 
this
->
dige¡
,his->
S
);

114 
	gthis
->
	ghm
.
Upd©e
(
KL
, 
this
->
L
);

115 
	gthis
->
	ghm
.
Upd©e
(
OL
, 
this
->
S
);

116 
	gthis
->
	ghm
.
Fš®
(
this
->
dige¡
);

117 
xÜbuf
(
BR
, 
this
->
dige¡
,his->
S
);

119 ià(
	gxÜBlock
)

120 
xÜbuf
(
outBlock
, 
xÜBlock
, 
this
->
bufãr
, 2*this->
S
);

122 
memıy
(
outBlock
, 
this
->
bufãr
, 2*this->
S
);

124 #undeà
KL


125 #undeà
KR


126 #undeà
BL


127 #undeà
BR


128 #undeà
IL


129 #undeà
IR


130 #undeà
OL


131 #undeà
OR


134 
	gpublic
:

135 
BlockCh”Fš®
<
	tENCRYPTION
, 
	tEnc
> 
	tEnüy±iÚ
;

136 
	gBlockCh”Fš®
<
	tDECRYPTION
, 
	tDec
> 
	tDeüy±iÚ
;

139 
	gNAMESPACE_END


	@luc.cpp

3 
	~"pch.h
"

4 
	~"luc.h
"

5 
	~"a¢.h
"

6 
	~"nbtheÜy.h
"

7 
	~"sha.h
"

8 
	~"®g·¿m.h
"

10 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

12 
	$LUC_Te¡In¡ªtŸtiÚs
()

14 
LUC_HMP
<
SHA
>::
SigÃr
 
t1
;

15 
LUCFunùiÚ
 
t2
;

16 
Inv”tibËLUCFunùiÚ
 
t3
;

17 
	}
}

19 
	gDL_AlgÜ™hm_LUC_HMP
::
Sign
(cÚ¡ 
DL_GroupP¬am‘”s
<
IÁeg”
> &
·¿ms
, cÚ¡ IÁeg” &
x
, cÚ¡ IÁeg” &
k
, cÚ¡ IÁeg” &
e
, IÁeg” &
r
, IÁeg” &
s
) const

21 cÚ¡ 
	gIÁeg”
 &
	gq
 = 
·¿ms
.
G‘SubgroupOrd”
();

22 
	gr
 = 
·¿ms
.
ExpÚ’tŸ‹Ba£
(
k
);

23 
	gs
 = (
k
 + 
x
*(
r
+
e
)è% 
q
;

26 
boŞ
 
	gDL_AlgÜ™hm_LUC_HMP
::
V”ify
(cÚ¡ 
DL_GroupP¬am‘”s
<
IÁeg”
> &
·¿ms
, cÚ¡ 
DL_PublicKey
<IÁeg”> &
publicKey
, cÚ¡ IÁeg” &
e
, cÚ¡ IÁeg” &
r
, cÚ¡ IÁeg” &
s
) const

28 
IÁeg”
 
	gp
 = 
·¿ms
.
G‘GroupOrd”
()-1;

29 cÚ¡ 
	gIÁeg”
 &
	gq
 = 
·¿ms
.
G‘SubgroupOrd”
();

31 
IÁeg”
 
	gVsg
 = 
·¿ms
.
ExpÚ’tŸ‹Ba£
(
s
);

32 
IÁeg”
 
	gVry
 = 
publicKey
.
ExpÚ’tŸ‹PublicEËm’t
((
r
+
e
)%
q
);

33  (
Vsg
*
	gVsg
 + 
Vry
*
	gVry
 + 
r
*
	gr
è% 
	gp
 =ğ(Vsg * Vry *„ + 4è% 
p
;

36 
IÁeg”
 
	gDL_Ba£P»computiÚ_LUC
::
ExpÚ’tŸ‹
(cÚ¡ 
DL_GroupP»computiÚ
<
EËm’t
> &
group
, cÚ¡ IÁeg” &
expÚ’t
) const

38  
Luÿs
(
expÚ’t
, 
m_g
, 
¡©ic_ÿ¡
<cÚ¡ 
DL_GroupP»computiÚ_LUC
 &>(
group
).
G‘Modulus
());

41 
	gDL_GroupP¬am‘”s_LUC
::
	$SimuÉªeousExpÚ’tŸ‹
(
EËm’t
 *
»suÉs
, cÚ¡ EËm’ˆ&
ba£
, cÚ¡ 
IÁeg”
 *
expÚ’ts
, 
expÚ’tsCouÁ
) const

43 
i
=0; i<
expÚ’tsCouÁ
; i++)

44 
»suÉs
[
i
] = 
	`Luÿs
(
expÚ’ts
[i], 
ba£
, 
	`G‘Modulus
());

45 
	}
}

47 
	gLUCFunùiÚ
::
	$BERDecode
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
)

49 
BERSequ’ûDecod”
 
	`£q
(
bt
);

50 
m_n
.
	`BERDecode
(
£q
);

51 
m_e
.
	`BERDecode
(
£q
);

52 
£q
.
	`Mes§geEnd
();

53 
	}
}

55 
	gLUCFunùiÚ
::
	$DEREncode
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
) const

57 
DERSequ’ûEncod”
 
	`£q
(
bt
);

58 
m_n
.
	`DEREncode
(
£q
);

59 
m_e
.
	`DEREncode
(
£q
);

60 
£q
.
	`Mes§geEnd
();

61 
	}
}

63 
IÁeg”
 
	gLUCFunùiÚ
::
	$AµlyFunùiÚ
(cÚ¡ 
IÁeg”
 &
x
) const

65 
	`DoQuickSª™yCheck
();

66  
	`Luÿs
(
m_e
, 
x
, 
m_n
);

67 
	}
}

69 
boŞ
 
	gLUCFunùiÚ
::
	$V®id©e
(
RªdomNumb”G’”©Ü
 &
ºg
, 
Ëv–
) const

71 
boŞ
 
·ss
 = 
Œue
;

72 
·ss
 =…as && 
m_n
 > 
IÁeg”
::
	`OÃ
(è&& m_n.
	`IsOdd
();

73 
·ss
 =…as && 
m_e
 > 
IÁeg”
::
	`OÃ
(è&& m_e.
	`IsOdd
(è&& m_< 
m_n
;

74  
·ss
;

75 
	}
}

77 
boŞ
 
	gLUCFunùiÚ
::
	$G‘VoidV®ue
(cÚ¡ *
Çme
, cÚ¡ 
¡d
::
ty³_šfo
 &
v®ueTy³
, *
pV®ue
) const

79  
	`G‘V®ueH–³r
(
this
, 
Çme
, 
v®ueTy³
, 
pV®ue
).
	`AssigÇbË
()

80 
	`CRYPTOPP_GET_FUNCTION_ENTRY
(
Modulus
)

81 
	`CRYPTOPP_GET_FUNCTION_ENTRY
(
PublicExpÚ’t
)

83 
	}
}

85 
	gLUCFunùiÚ
::
	$AssignFrom
(cÚ¡ 
NameV®uePaœs
 &
sourû
)

87 
	`AssignFromH–³r
(
this
, 
sourû
)

88 
	`CRYPTOPP_SET_FUNCTION_ENTRY
(
Modulus
)

89 
	`CRYPTOPP_SET_FUNCTION_ENTRY
(
PublicExpÚ’t
)

91 
	}
}

96 şas 
	cLUCPrimeS–eùÜ
 : 
public
 
PrimeS–eùÜ


98 
public
:

99 
	$LUCPrimeS–eùÜ
(cÚ¡ 
IÁeg”
 &
e
è: 
	$m_e
(
e
) {}

100 
boŞ
 
	$IsAcû±abË
(cÚ¡ 
IÁeg”
 &
ÿndid©e
) const

102  
	`R–©iv–yPrime
(
m_e
, 
ÿndid©e
+1) && RelativelyPrime(m_e, candidate-1);

103 
	}
}

104 
IÁeg”
 
	gm_e
;

107 
	gInv”tibËLUCFunùiÚ
::
	$G’”©eRªdom
(
RªdomNumb”G’”©Ü
 &
ºg
, cÚ¡ 
NameV®uePaœs
 &
®g
)

109 
modulusSize
 = 2048;

110 
®g
.
	`G‘IÁV®ue
("ModulusSize", 
modulusSize
) ||‡lg.GetIntValue("KeySize", modulusSize);

112 ià(
modulusSize
 < 16)

113 
throw
 
	`Inv®idArgum’t
("InvertibleLUCFunction: specified modulus size isoo small");

115 
m_e
 = 
®g
.
	`G‘V®ueW™hDeçuÉ
("PublicExpÚ’t", 
	`IÁeg”
(17));

117 ià(
m_e
 < 5 || m_e.
	`IsEv’
())

118 
throw
 
	`Inv®idArgum’t
("InvertibleLUCFunction: invalid…ublicƒxponent");

120 
LUCPrimeS–eùÜ
 
	`£ËùÜ
(
m_e
);

121 
AlgÜ™hmP¬am‘”s
 
´imeP¬am
 = 
	`MakeP¬am‘”sFÜTwoPrimesOfEqu®Size
(
modulusSize
)

122 ("Poš‹rToPrimeS–eùÜ", 
£ËùÜ
.
	`G‘S–eùÜPoš‹r
());

123 
m_p
.
	`G’”©eRªdom
(
ºg
, 
´imeP¬am
);

124 
m_q
.
	`G’”©eRªdom
(
ºg
, 
´imeP¬am
);

126 
m_n
 = 
m_p
 * 
m_q
;

127 
m_u
 = 
m_q
.
	`Inv”£Mod
(
m_p
);

128 
	}
}

130 
	gInv”tibËLUCFunùiÚ
::
	$In™Ÿlize
(
RªdomNumb”G’”©Ü
 &
ºg
, 
keyb™s
, cÚ¡ 
IÁeg”
 &
e
)

132 
	`G’”©eRªdom
(
ºg
, 
	`MakeP¬am‘”s
("ModulusSize", ()
keyb™s
)("PublicExpÚ’t", 
e
));

133 
	}
}

135 
	gInv”tibËLUCFunùiÚ
::
	$BERDecode
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
)

137 
BERSequ’ûDecod”
 
	`£q
(
bt
);

139 
IÁeg”
 
	`v”siÚ
(
£q
);

140 ià(!!
v”siÚ
)

141 
	`BERDecodeE¼Ü
();

143 
m_n
.
	`BERDecode
(
£q
);

144 
m_e
.
	`BERDecode
(
£q
);

145 
m_p
.
	`BERDecode
(
£q
);

146 
m_q
.
	`BERDecode
(
£q
);

147 
m_u
.
	`BERDecode
(
£q
);

148 
£q
.
	`Mes§geEnd
();

149 
	}
}

151 
	gInv”tibËLUCFunùiÚ
::
	$DEREncode
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
) const

153 
DERSequ’ûEncod”
 
	`£q
(
bt
);

155 cÚ¡ 
by‹
 
v”siÚ
[] = {
INTEGER
, 1, 0};

156 
£q
.
	`Put
(
v”siÚ
, (version));

157 
m_n
.
	`DEREncode
(
£q
);

158 
m_e
.
	`DEREncode
(
£q
);

159 
m_p
.
	`DEREncode
(
£q
);

160 
m_q
.
	`DEREncode
(
£q
);

161 
m_u
.
	`DEREncode
(
£q
);

162 
£q
.
	`Mes§geEnd
();

163 
	}
}

165 
IÁeg”
 
	gInv”tibËLUCFunùiÚ
::
	$C®cuÏ‹Inv”£
(
RªdomNumb”G’”©Ü
 &
ºg
, cÚ¡ 
IÁeg”
 &
x
) const

168 
	`DoQuickSª™yCheck
();

169  
	`Inv”£Luÿs
(
m_e
, 
x
, 
m_q
, 
m_p
, 
m_u
);

170 
	}
}

172 
boŞ
 
	gInv”tibËLUCFunùiÚ
::
	$V®id©e
(
RªdomNumb”G’”©Ü
 &
ºg
, 
Ëv–
) const

174 
boŞ
 
·ss
 = 
LUCFunùiÚ
::
	`V®id©e
(
ºg
, 
Ëv–
);

175 
·ss
 =…as && 
m_p
 > 
IÁeg”
::
	`OÃ
(è&& m_p.
	`IsOdd
(è&& m_°< 
m_n
;

176 
·ss
 =…as && 
m_q
 > 
IÁeg”
::
	`OÃ
(è&& m_q.
	`IsOdd
(è&& m_q < 
m_n
;

177 
·ss
 =…as && 
m_u
.
	`IsPos™ive
(è&& m_u < 
m_p
;

178 ià(
Ëv–
 >= 1)

180 
·ss
 =…as && 
m_p
 * 
m_q
 =ğ
m_n
;

181 
·ss
 =…as && 
	`R–©iv–yPrime
(
m_e
, 
m_p
+1);

182 
·ss
 =…as && 
	`R–©iv–yPrime
(
m_e
, 
m_p
-1);

183 
·ss
 =…as && 
	`R–©iv–yPrime
(
m_e
, 
m_q
+1);

184 
·ss
 =…as && 
	`R–©iv–yPrime
(
m_e
, 
m_q
-1);

185 
·ss
 =…as && 
m_u
 * 
m_q
 % 
m_p
 == 1;

187 ià(
Ëv–
 >= 2)

188 
·ss
 =…as && 
	`V”ifyPrime
(
ºg
, 
m_p
, 
Ëv–
-2è&& V”ifyPrimeÔng, 
m_q
,†evel-2);

189  
·ss
;

190 
	}
}

192 
boŞ
 
	gInv”tibËLUCFunùiÚ
::
	$G‘VoidV®ue
(cÚ¡ *
Çme
, cÚ¡ 
¡d
::
ty³_šfo
 &
v®ueTy³
, *
pV®ue
) const

194  
G‘V®ueH–³r
<
LUCFunùiÚ
>(
this
, 
Çme
, 
v®ueTy³
, 
pV®ue
).
	`AssigÇbË
()

195 
	`CRYPTOPP_GET_FUNCTION_ENTRY
(
Prime1
)

196 
	`CRYPTOPP_GET_FUNCTION_ENTRY
(
Prime2
)

197 
	`CRYPTOPP_GET_FUNCTION_ENTRY
(
MuÉliÿtiveInv”£OfPrime2ModPrime1
)

199 
	}
}

201 
	gInv”tibËLUCFunùiÚ
::
	$AssignFrom
(cÚ¡ 
NameV®uePaœs
 &
sourû
)

203 
AssignFromH–³r
<
LUCFunùiÚ
>(
this
, 
sourû
)

204 
	`CRYPTOPP_SET_FUNCTION_ENTRY
(
Prime1
)

205 
	`CRYPTOPP_SET_FUNCTION_ENTRY
(
Prime2
)

206 
	`CRYPTOPP_SET_FUNCTION_ENTRY
(
MuÉliÿtiveInv”£OfPrime2ModPrime1
)

208 
	}
}

210 
	gNAMESPACE_END


	@luc.h

1 #iâdeà
CRYPTOPP_LUC_H


2 
	#CRYPTOPP_LUC_H


	)

7 
	~"pkc¥ad.h
"

8 
	~"ß•.h
"

9 
	~"š‹g”.h
"

10 
	~"dh.h
"

12 
	~<lim™s.h
>

14 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

22 
şass
 
LUCFunùiÚ
 : 
public
 
T¿pdoÜFunùiÚ
,…ubliø
PublicKey


24 
LUCFunùiÚ
 
	tThisCÏss
;

26 
public
:

27 
	`In™Ÿlize
(cÚ¡ 
IÁeg”
 &
n
, cÚ¡ IÁeg” &
e
)

28 {
m_n
 = 
n
; 
m_e
 = 
e
;}

30 
	`BERDecode
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
);

31 
	`DEREncode
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
) const;

33 
IÁeg”
 
	`AµlyFunùiÚ
(cÚ¡ IÁeg” &
x
) const;

34 
IÁeg”
 
	`P»imageBound
(ècÚ¡ { 
m_n
;}

35 
IÁeg”
 
	`ImageBound
(ècÚ¡ { 
m_n
;}

37 
boŞ
 
	`V®id©e
(
RªdomNumb”G’”©Ü
 &
ºg
, 
Ëv–
) const;

38 
boŞ
 
	`G‘VoidV®ue
(cÚ¡ *
Çme
, cÚ¡ 
¡d
::
ty³_šfo
 &
v®ueTy³
, *
pV®ue
) const;

39 
	`AssignFrom
(cÚ¡ 
NameV®uePaœs
 &
sourû
);

42 cÚ¡ 
IÁeg”
 & 
	`G‘Modulus
(ècÚ¡ { 
m_n
;}

43 cÚ¡ 
IÁeg”
 & 
	`G‘PublicExpÚ’t
(ècÚ¡ { 
m_e
;}

45 
	`S‘Modulus
(cÚ¡ 
IÁeg”
 &
n
è{
m_n
 =‚;}

46 
	`S‘PublicExpÚ’t
(cÚ¡ 
IÁeg”
 &
e
è{
m_e
 =ƒ;}

48 
´Ùeùed
:

49 
IÁeg”
 
m_n
, 
m_e
;

50 
	}
};

53 
şass
 
	gInv”tibËLUCFunùiÚ
 : 
public
 
LUCFunùiÚ
,…ubliø
	gT¿pdoÜFunùiÚInv”£
,…ubliø
	gPriv©eKey


55 
Inv”tibËLUCFunùiÚ
 
	tThisCÏss
;

57 
	gpublic
:

58 
In™Ÿlize
(
RªdomNumb”G’”©Ü
 &
ºg
, 
modulusB™s
, cÚ¡ 
IÁeg”
 &
eS¹
=17);

59 
In™Ÿlize
(cÚ¡ 
IÁeg”
 &
n
, cÚ¡ IÁeg” &
e
, cÚ¡ IÁeg” &
p
, cÚ¡ IÁeg” &
q
, cÚ¡ IÁeg” &
u
)

60 {
	gm_n
 = 
n
; 
	gm_e
 = 
e
; 
	gm_p
 = 
p
; 
	gm_q
 = 
q
; 
	gm_u
 = 
u
;}

62 
BERDecode
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
);

63 
DEREncode
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
) const;

65 
IÁeg”
 
C®cuÏ‹Inv”£
(
RªdomNumb”G’”©Ü
 &
ºg
, cÚ¡ IÁeg” &
x
) const;

67 
boŞ
 
V®id©e
(
RªdomNumb”G’”©Ü
 &
ºg
, 
Ëv–
) const;

68 
boŞ
 
G‘VoidV®ue
(cÚ¡ *
Çme
, cÚ¡ 
¡d
::
ty³_šfo
 &
v®ueTy³
, *
pV®ue
) const;

69 
AssignFrom
(cÚ¡ 
NameV®uePaœs
 &
sourû
);

71 
G’”©eRªdom
(
RªdomNumb”G’”©Ü
 &
ºg
, cÚ¡ 
NameV®uePaœs
 &
®g
);

74 cÚ¡ 
	gIÁeg”
& 
G‘Prime1
(ècÚ¡ { 
	gm_p
;}

75 cÚ¡ 
	gIÁeg”
& 
G‘Prime2
(ècÚ¡ { 
	gm_q
;}

76 cÚ¡ 
	gIÁeg”
& 
G‘MuÉliÿtiveInv”£OfPrime2ModPrime1
(ècÚ¡ { 
	gm_u
;}

78 
S‘Prime1
(cÚ¡ 
IÁeg”
 &
p
è{
	gm_p
 =…;}

79 
S‘Prime2
(cÚ¡ 
IÁeg”
 &
q
è{
	gm_q
 = q;}

80 
S‘MuÉliÿtiveInv”£OfPrime2ModPrime1
(cÚ¡ 
IÁeg”
 &
u
è{
	gm_u
 = u;}

82 
	g´Ùeùed
:

83 
IÁeg”
 
m_p
, 
	gm_q
, 
	gm_u
;

86 
	sLUC


88 
	m¡d
::
¡ršg
 
SticAlgÜ™hmName
() { "LUC";}

89 
LUCFunùiÚ
 
	tPublicKey
;

90 
Inv”tibËLUCFunùiÚ
 
	tPriv©eKey
;

94 
	g‹m¶©e
 <
şass
 
	gSTANDARD
>

95 
	gLUCES
 : 
public
 
TF_ES
<
STANDARD
, 
	gLUC
>

100 
	g‹m¶©e
 <
şass
 
	gSTANDARD
, cÏs 
	gH
>

101 
	gLUCSS
 : 
public
 
TF_SS
<
STANDARD
, 
	gH
, 
	gLUC
>

106 
	gLUCES
<
	tOAEP
<
	tSHA
> >::
	tDeüy±Ü
 
	tLUCES_OAEP_SHA_Deüy±Ü
;

107 
	gLUCES
<
	tOAEP
<
	tSHA
> >::
	tEnüy±Ü
 
	tLUCES_OAEP_SHA_Enüy±Ü
;

109 
	gLUCSS
<
	tPKCS1v15
, 
	tSHA
>::
	tSigÃr
 
	tLUCSSA_PKCS1v15_SHA_SigÃr
;

110 
	gLUCSS
<
	tPKCS1v15
, 
	tSHA
>::
	tV”if›r
 
	tLUCSSA_PKCS1v15_SHA_V”if›r
;

115 
şass
 
	gDL_GroupP»computiÚ_LUC
 : 
public
 
DL_GroupP»computiÚ
<
IÁeg”
>

117 
public
:

118 cÚ¡ 
Ab¡¿ùGroup
<
EËm’t
> & 
G‘Group
(ècÚ¡ {
as£¹
(
çl£
); 
	gthrow
 0;}

119 
EËm’t
 
BERDecodeEËm’t
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
ècÚ¡ { 
IÁeg”
(bt);}

120 
DEREncodeEËm’t
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
, cÚ¡ 
EËm’t
 &
v
ècÚ¡ {
	gv
.
DEREncode
(bt);}

123 
S‘Modulus
(cÚ¡ 
IÁeg”
 &
v
è{
	gm_p
 = v;}

124 cÚ¡ 
	gIÁeg”
 & 
G‘Modulus
(ècÚ¡ { 
	gm_p
;}

126 
	g´iv©e
:

127 
IÁeg”
 
m_p
;

131 
şass
 
	gDL_Ba£P»computiÚ_LUC
 : 
public
 
DL_FixedBa£P»computiÚ
<
IÁeg”
>

133 
public
:

135 
boŞ
 
IsIn™Ÿlized
(ècÚ¡ { 
m_g
.
NÙZ”o
();}

136 
S‘Ba£
(cÚ¡ 
DL_GroupP»computiÚ
<
EËm’t
> &
group
, cÚ¡ 
IÁeg”
 &
ba£
è{
	gm_g
 = base;}

137 cÚ¡ 
	gIÁeg”
 & 
G‘Ba£
(cÚ¡ 
DL_GroupP»computiÚ
<
EËm’t
> &
group
ècÚ¡ { 
	gm_g
;}

138 
P»compu‹
(cÚ¡ 
DL_GroupP»computiÚ
<
EËm’t
> &
group
, 
maxExpB™s
, 
¡Üage
) {}

139 
Lßd
(cÚ¡ 
DL_GroupP»computiÚ
<
EËm’t
> &
group
, 
Bufã»dT¿nsfÜm©iÚ
 &
¡ÜedP»computiÚ
) {}

140 
Save
(cÚ¡ 
DL_GroupP»computiÚ
<
EËm’t
> &
group
, 
Bufã»dT¿nsfÜm©iÚ
 &
¡ÜedP»computiÚ
) const {}

141 
IÁeg”
 
ExpÚ’tŸ‹
(cÚ¡ 
DL_GroupP»computiÚ
<
EËm’t
> &
group
, cÚ¡ IÁeg” &
expÚ’t
) const;

142 
IÁeg”
 
CasÿdeExpÚ’tŸ‹
(cÚ¡ 
DL_GroupP»computiÚ
<
EËm’t
> &
group
, cÚ¡ IÁeg” &
expÚ’t
, cÚ¡ 
DL_FixedBa£P»computiÚ
<IÁeg”> &
pc2
, cÚ¡ IÁeg” &
expÚ’t2
) const

143 {
throw
 
NÙIm¶em’‹d
("DL_BasePrecomputation_LUC: CascadeExponentiate‚ot implemented");}

145 
	g´iv©e
:

146 
IÁeg”
 
m_g
;

150 
şass
 
	gDL_GroupP¬am‘”s_LUC
 : 
public
 
DL_GroupP¬am‘”s_IÁeg”Ba£dIm¶
<
DL_GroupP»computiÚ_LUC
, 
	gDL_Ba£P»computiÚ_LUC
>

152 
	gpublic
:

154 
boŞ
 
IsId’t™y
(cÚ¡ 
IÁeg”
 &
–em’t
ècÚ¡ {ƒËm’ˆ=ğIÁeg”::
Two
();}

155 
SimuÉªeousExpÚ’tŸ‹
(
EËm’t
 *
»suÉs
, cÚ¡ EËm’ˆ&
ba£
, cÚ¡ 
IÁeg”
 *
expÚ’ts
, 
expÚ’tsCouÁ
) const;

156 
EËm’t
 
MuÉlyEËm’ts
(cÚ¡ EËm’ˆ&
a
, cÚ¡ EËm’ˆ&
b
) const

157 {
throw
 
NÙIm¶em’‹d
("LUC_GroupParameters: MultiplyElements can‚ot be implemented");}

158 
EËm’t
 
CasÿdeExpÚ’tŸ‹
(cÚ¡ EËm’ˆ&
–em’t1
, cÚ¡ 
IÁeg”
 &
expÚ’t1
, cÚ¡ EËm’ˆ&
–em’t2
, cÚ¡ IÁeg” &
expÚ’t2
) const

159 {
throw
 
NÙIm¶em’‹d
("LUC_GroupParameters: MultiplyElements can‚ot be implemented");}

162 
boŞ
 
G‘VoidV®ue
(cÚ¡ *
Çme
, cÚ¡ 
¡d
::
ty³_šfo
 &
v®ueTy³
, *
pV®ue
) const

164  
	gG‘V®ueH–³r
<
	gDL_GroupP¬am‘”s_IÁeg”Ba£d
>(
	gthis
, 
	gÇme
, 
	gv®ueTy³
, 
	gpV®ue
).
AssigÇbË
();

167 
	g´iv©e
:

168 
G‘F›ldTy³
() const { 2;}

172 şas 
	cDL_GroupP¬am‘”s_LUC_DeçuÉSaãPrime
 : 
public
 
DL_GroupP¬am‘”s_LUC


174 
public
:

175 
NoCoçùÜMuÉliÿtiÚ
 
	tDeçuÉCoçùÜO±iÚ
;

177 
	m´Ùeùed
:

178 
	$G‘DeçuÉSubgroupOrd”Size
(
modulusSize
) const { modulusSize-1;}

179 
	}
};

182 
şass
 
	gDL_AlgÜ™hm_LUC_HMP
 : 
public
 
DL_Elgam®LikeSigÇtu»AlgÜ™hm
<
IÁeg”
>

184 
public
:

185 cÚ¡ * 
SticAlgÜ™hmName
() { "LUC-HMP";}

187 
Sign
(cÚ¡ 
DL_GroupP¬am‘”s
<
IÁeg”
> &
·¿ms
, cÚ¡ IÁeg” &
x
, cÚ¡ IÁeg” &
k
, cÚ¡ IÁeg” &
e
, IÁeg” &
r
, IÁeg” &
s
) const;

188 
boŞ
 
V”ify
(cÚ¡ 
DL_GroupP¬am‘”s
<
IÁeg”
> &
·¿ms
, cÚ¡ 
DL_PublicKey
<IÁeg”> &
publicKey
, cÚ¡ IÁeg” &
e
, cÚ¡ IÁeg” &
r
, cÚ¡ IÁeg” &
s
) const;

190 
size_t
 
RL’
(cÚ¡ 
DL_GroupP¬am‘”s
<
IÁeg”
> &
·¿ms
) const

191 { 
	g·¿ms
.
G‘GroupOrd”
().
By‹CouÁ
();}

195 
	sDL_SigÇtu»Keys_LUC


197 
DL_GroupP¬am‘”s_LUC
 
	tGroupP¬am‘”s
;

198 
	mDL_PublicKey_GFP
<
	tGroupP¬am‘”s
> 
	tPublicKey
;

199 
	mDL_Priv©eKey_GFP
<
	tGroupP¬am‘”s
> 
	tPriv©eKey
;

203 
	g‹m¶©e
 <
şass
 
	gH
>

204 
	gLUC_HMP
 : 
public
 
DL_SS
<
DL_SigÇtu»Keys_LUC
, 
	gDL_AlgÜ™hm_LUC_HMP
, 
	gDL_SigÇtu»Mes§geEncodšgM‘hod_DSA
, 
	gH
>

209 
	sDL_Cry±oKeys_LUC


211 
DL_GroupP¬am‘”s_LUC_DeçuÉSaãPrime
 
	tGroupP¬am‘”s
;

212 
	mDL_PublicKey_GFP
<
	tGroupP¬am‘”s
> 
	tPublicKey
;

213 
	mDL_Priv©eKey_GFP
<
	tGroupP¬am‘”s
> 
	tPriv©eKey
;

217 
	g‹m¶©e
 <
şass
 
	gCOFACTOR_OPTION
 = 
NoCoçùÜMuÉliÿtiÚ
, 
boŞ
 
	gDHAES_MODE
 = 
Œue
>

218 
LUC_IES


219 : 
public
 
DL_ES
<

220 
DL_Cry±oKeys_LUC
,

221 
	gDL_KeyAg»em’tAlgÜ™hm_DH
<
	gIÁeg”
, 
	gCOFACTOR_OPTION
>,

222 
	gDL_KeyD”iv©iÚAlgÜ™hm_P1363
<
	gIÁeg”
, 
	gDHAES_MODE
, 
	gP1363_KDF2
<
	gSHA1
> >,

223 
	gDL_Enüy±iÚAlgÜ™hm_XÜ
<
	gHMAC
<
	gSHA1
>, 
	gDHAES_MODE
>,

224 
	gLUC_IES
<> >

226 
	g¡d
::
¡ršg
 
SticAlgÜ™hmName
() { "LUC-IES";}

232 
	gDH_Domaš
<
	tDL_GroupP¬am‘”s_LUC_DeçuÉSaãPrime
> 
	tLUC_DH
;

234 
	gNAMESPACE_END


	@mars.cpp

5 
	~"pch.h
"

6 
	~"m¬s.h
"

7 
	~"misc.h
"

9 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

11 
MARS
::
Ba£
::
	$UncheckedS‘Key
(cÚ¡ 
by‹
 *
u£rKey
, 
Ëngth
, cÚ¡ 
NameV®uePaœs
 &)

13 
	`As£¹V®idKeyL’gth
(
Ëngth
);

16 
FixedSizeSecBlock
<
wÜd32
, 15> 
T
;

17 
	`G‘U£rKey
(
LITTLE_ENDIAN_ORDER
, 
T
.
	`begš
(), 15, 
u£rKey
, 
Ëngth
);

18 
T
[
Ëngth
/4] =†ength/4;

20 
j
=0; j<4; j++)

22 
i
;

24 
i
=0; i<15; i++)

25 
T
[
i
] = T[i] ^ 
	`rÙlFixed
(T[(i+8)%15] ^ T[(i+13)%15], 3è^ (4*i+
j
);

28 
k
=0; k<4; k++)

29 
i
=0; i<15; i++)

30 
T
[
i
] = 
	`rÙlFixed
(T[i] + 
Sbox
[T[(i+14)%15]%512], 9);

33 
i
=0; i<10; i++)

34 
m_k
[10*
j
+
i
] = 
T
[4*i%15];

38 
i
 = 5; i < 37; i += 2)

40 
wÜd32
 
m
, 
w
 = 
m_k
[
i
] | 3;

41 
m
 = (~
w
 ^ (w<<1)) & (~w ^ (w>>1)) & 0x7ffffffe;

42 
m
 &= m>>1; m &= m>>2; m &= m>>4;

43 
m
 |= m<<1; m |= m<<2; m |= m<<4;

44 
m
 &= 0x7ffffffc;

45 
w
 ^ğ
	`rÙlMod
(
Sbox
[265 + (
m_k
[
i
] & 3)], m_k[i-1]è& 
m
;

46 
m_k
[
i
] = 
w
;

48 
	}
}

50 
	#S
(
a
è
Sbox
[×)&0x1ff]

	)

51 
	#S0
(
a
è
Sbox
[×)&0xff]

	)

52 
	#S1
(
a
è
Sbox
[(×)&0xffè+ 256]

	)

54 
	gBlockG‘AndPut
<
	twÜd32
, 
	tL™eEndŸn
> 
	tBlock
;

56 
	gMARS
::
Enc
::
	$ProûssAndXÜBlock
(cÚ¡ 
by‹
 *
šBlock
, cÚ¡ by‹ *
xÜBlock
, by‹ *
outBlock
) const

58 
i
;

59 
wÜd32
 
a
, 
b
, 
c
, 
d
, 
l
, 
m
, 
r
, 
t
;

60 cÚ¡ 
wÜd32
 *
k
 = 
m_k
;

62 
Block
::
	`G‘
(
šBlock
)(
a
)(
b
)(
c
)(
d
);

64 
a
 +ğ
k
[0]; 
b
 +ğk[1]; 
c
 +ğk[2]; 
d
 += k[3];

66 
i
=0; i<8; i++)

68 
b
 = (b ^ 
	`S0
(
a
)è+ 
	`S1
(a>>8);

69 
c
 +ğ
	`S0
(
a
>>16);

70 
a
 = 
	`rÙrFixed
(a, 24);

71 
d
 ^ğ
	`S1
(
a
);

72 
a
 +ğ(
i
%4==0è? 
d
 : 0;

73 
a
 +ğ(
i
%4==1è? 
b
 : 0;

74 
t
 = 
a
;‡ = 
b
; b = 
c
; c = 
d
; d =;

77 
i
=0; i<16; i++)

79 
t
 = 
	`rÙlFixed
(
a
, 13);

80 
r
 = 
	`rÙlFixed
(
t
 * 
k
[2*
i
+5], 10);

81 
m
 = 
a
 + 
k
[2*
i
+4];

82 
l
 = 
	`rÙlMod
((
	`S
(
m
è^ 
	`rÙrFixed
(
r
, 5) ^„),„);

83 
c
 +ğ
	`rÙlMod
(
m
, 
	`rÙrFixed
(
r
, 5));

84 (
i
<8 ? 
b
 : 
d
è+ğ
l
;

85 (
i
<8 ? 
d
 : 
b
è^ğ
r
;

86 
a
 = 
b
; b = 
c
; c = 
d
; d = 
t
;

89 
i
=0; i<8; i++)

91 
a
 -ğ(
i
%4==2è? 
d
 : 0;

92 
a
 -ğ(
i
%4==3è? 
b
 : 0;

93 
b
 ^ğ
	`S1
(
a
);

94 
c
 -ğ
	`S0
(
a
>>24);

95 
t
 = 
	`rÙlFixed
(
a
, 24);

96 
d
 = (d - 
	`S1
(
a
>>16)è^ 
	`S0
(
t
);

97 
a
 = 
b
; b = 
c
; c = 
d
; d = 
t
;

100 
a
 -ğ
k
[36]; 
b
 -ğk[37]; 
c
 -ğk[38]; 
d
 -= k[39];

102 
Block
::
	`Put
(
xÜBlock
, 
outBlock
)(
a
)(
b
)(
c
)(
d
);

103 
	}
}

105 
	gMARS
::
Dec
::
	$ProûssAndXÜBlock
(cÚ¡ 
by‹
 *
šBlock
, cÚ¡ by‹ *
xÜBlock
, by‹ *
outBlock
) const

107 
i
;

108 
wÜd32
 
a
, 
b
, 
c
, 
d
, 
l
, 
m
, 
r
, 
t
;

109 cÚ¡ 
wÜd32
 *
k
 = 
m_k
;

111 
Block
::
	`G‘
(
šBlock
)(
d
)(
c
)(
b
)(
a
);

113 
d
 +ğ
k
[36]; 
c
 +ğk[37]; 
b
 +ğk[38]; 
a
 += k[39];

115 
i
=0; i<8; i++)

117 
b
 = (b ^ 
	`S0
(
a
)è+ 
	`S1
(a>>8);

118 
c
 +ğ
	`S0
(
a
>>16);

119 
a
 = 
	`rÙrFixed
(a, 24);

120 
d
 ^ğ
	`S1
(
a
);

121 
a
 +ğ(
i
%4==0è? 
d
 : 0;

122 
a
 +ğ(
i
%4==1è? 
b
 : 0;

123 
t
 = 
a
;‡ = 
b
; b = 
c
; c = 
d
; d =;

126 
i
=0; i<16; i++)

128 
t
 = 
	`rÙrFixed
(
a
, 13);

129 
r
 = 
	`rÙlFixed
(
a
 * 
k
[35-2*
i
], 10);

130 
m
 = 
t
 + 
k
[34-2*
i
];

131 
l
 = 
	`rÙlMod
((
	`S
(
m
è^ 
	`rÙrFixed
(
r
, 5) ^„),„);

132 
c
 -ğ
	`rÙlMod
(
m
, 
	`rÙrFixed
(
r
, 5));

133 (
i
<8 ? 
b
 : 
d
è-ğ
l
;

134 (
i
<8 ? 
d
 : 
b
è^ğ
r
;

135 
a
 = 
b
; b = 
c
; c = 
d
; d = 
t
;

138 
i
=0; i<8; i++)

140 
a
 -ğ(
i
%4==2è? 
d
 : 0;

141 
a
 -ğ(
i
%4==3è? 
b
 : 0;

142 
b
 ^ğ
	`S1
(
a
);

143 
c
 -ğ
	`S0
(
a
>>24);

144 
t
 = 
	`rÙlFixed
(
a
, 24);

145 
d
 = (d - 
	`S1
(
a
>>16)è^ 
	`S0
(
t
);

146 
a
 = 
b
; b = 
c
; c = 
d
; d = 
t
;

149 
d
 -ğ
k
[0]; 
c
 -ğk[1]; 
b
 -ğk[2]; 
a
 -= k[3];

151 
Block
::
	`Put
(
xÜBlock
, 
outBlock
)(
d
)(
c
)(
b
)(
a
);

152 
	}
}

154 
	gNAMESPACE_END


	@mars.h

1 #iâdeà
CRYPTOPP_MARS_H


2 
	#CRYPTOPP_MARS_H


	)

7 
	~"£ckey.h
"

8 
	~"£cblock.h
"

10 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

13 
MARS_Info
 : 
public
 
FixedBlockSize
<16>,…ubliø
V¬ŸbËKeyL’gth
<16, 16, 56, 4>

15 cÚ¡ *
	`SticAlgÜ™hmName
() { "MARS";}

16 
	}
};

19 
şass
 
	gMARS
 : 
public
 
MARS_Info
,…ubliø
	gBlockCh”Docum’tiÚ


21 
şass
 
CRYPTOPP_NO_VTABLE
 
	gBa£
 : 
public
 
BlockCh”Im¶
<
MARS_Info
>

23 
public
:

24 
UncheckedS‘Key
(cÚ¡ 
by‹
 *
u£rKey
, 
Ëngth
, cÚ¡ 
NameV®uePaœs
 &
·¿ms
);

26 
	g´Ùeùed
:

27 cÚ¡ 
wÜd32
 
Sbox
[512];

29 
	gFixedSizeSecBlock
<
	gwÜd32
, 40> 
	gm_k
;

32 şas 
	cCRYPTOPP_NO_VTABLE
 
	gEnc
 : 
public
 
Ba£


34 
public
:

35 
ProûssAndXÜBlock
(cÚ¡ 
by‹
 *
šBlock
, cÚ¡ by‹ *
xÜBlock
, by‹ *
outBlock
) const;

38 şas 
	cCRYPTOPP_NO_VTABLE
 
	gDec
 : 
public
 
Ba£


40 
public
:

41 
ProûssAndXÜBlock
(cÚ¡ 
by‹
 *
šBlock
, cÚ¡ by‹ *
xÜBlock
, by‹ *
outBlock
) const;

44 
	gpublic
:

45 
BlockCh”Fš®
<
	tENCRYPTION
, 
	tEnc
> 
	tEnüy±iÚ
;

46 
	gBlockCh”Fš®
<
	tDECRYPTION
, 
	tDec
> 
	tDeüy±iÚ
;

49 
	gMARS
::
	tEnüy±iÚ
 
	tMARSEnüy±iÚ
;

50 
	gMARS
::
	tDeüy±iÚ
 
	tMARSDeüy±iÚ
;

52 
	gNAMESPACE_END


	@marss.cpp

3 
	~"pch.h
"

4 
	~"m¬s.h
"

6 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

8 cÚ¡ 
wÜd32
 
MARS
::
Ba£
::
Sbox
[512] = {

137 
	}
};

139 
	gNAMESPACE_END


	@md2.cpp

17 
	~"pch.h
"

18 
	#CRYPTOPP_ENABLE_NAMESPACE_WEAK
 1

	)

19 
	~"md2.h
"

21 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

22 
Çme¥aû
 
W—k1
 {

24 
MD2
::
	`MD2
()

25 : 
	`m_X
(48), 
	`m_C
(16), 
	`m_buf
(16)

27 
	`In™
();

30 
MD2
::
	`In™
()

32 
	`mem£t
(
m_X
, 0, 48);

33 
	`mem£t
(
m_C
, 0, 16);

34 
	`mem£t
(
m_buf
, 0, 16);

35 
m_couÁ
 = 0;

38 
MD2
::
	`Upd©e
(cÚ¡ 
by‹
 *
buf
, 
size_t
 
Ën
)

40 cÚ¡ 
by‹
 
S
[256] = {

61 
Ën
)

63 
L
 = 
	`UnsigÃdMš
(16U-
m_couÁ
, 
Ën
);

64 
	`memıy
(
m_buf
+
m_couÁ
, 
buf
, 
L
);

65 
m_couÁ
+=
L
;

66 
buf
+=
L
;

67 
Ën
-=
L
;

68 ià(
m_couÁ
==16)

70 
by‹
 
t
;

71 
i
,
j
;

73 
m_couÁ
=0;

74 
	`memıy
(
m_X
+16, 
m_buf
, 16);

75 
t
=
m_C
[15];

76 
i
=0; i<16; i++)

78 
m_X
[32+
i
]=m_X[16+i]^m_X[i];

79 
t
=
m_C
[
i
]^=
S
[
m_buf
[i]^t];

82 
t
=0;

83 
i
=0; i<18; i++)

85 
j
=0; j<48; j+=8)

87 
t
=
m_X
[
j
+0]^=
S
[t];

88 
t
=
m_X
[
j
+1]^=
S
[t];

89 
t
=
m_X
[
j
+2]^=
S
[t];

90 
t
=
m_X
[
j
+3]^=
S
[t];

91 
t
=
m_X
[
j
+4]^=
S
[t];

92 
t
=
m_X
[
j
+5]^=
S
[t];

93 
t
=
m_X
[
j
+6]^=
S
[t];

94 
t
=
m_X
[
j
+7]^=
S
[t];

96 
t
=Ñ+
i
) & 0xFF;

102 
MD2
::
	`Trunÿ‹dFš®
(
by‹
 *
hash
, 
size_t
 
size
)

104 
	`ThrowIfInv®idTrunÿ‹dSize
(
size
);

106 
by‹
 
·ddšg
[16];

107 
wÜd32
 
·dËn
;

108 
i
;

110 
·dËn
ğ16-
m_couÁ
;

111 
i
=0; i<
·dËn
; i++è
·ddšg
[i]=(
by‹
)padlen;

112 
	`Upd©e
(
·ddšg
, 
·dËn
);

113 
	`Upd©e
(
m_C
, 16);

114 
	`memıy
(
hash
, 
m_X
, 
size
);

116 
	`In™
();

119 
	}
}

120 
	gNAMESPACE_END


	@md2.h

1 #iâdeà
CRYPTOPP_MD2_H


2 
	#CRYPTOPP_MD2_H


	)

4 
	~"üy±lib.h
"

5 
	~"£cblock.h
"

7 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

9 
Çme¥aû
 
W—k1
 {

12 şas 
	cMD2
 : 
public
 
HashT¿nsfÜm©iÚ


14 
public
:

15 
	`MD2
();

16 
	`Upd©e
(cÚ¡ 
by‹
 *
šput
, 
size_t
 
Ëngth
);

17 
	`Trunÿ‹dFš®
(
by‹
 *
hash
, 
size_t
 
size
);

18 
	`Dige¡Size
(ècÚ¡ { 
DIGESTSIZE
;}

19 
	`BlockSize
(ècÚ¡ { 
BLOCKSIZE
;}

20 cÚ¡ * 
	`SticAlgÜ™hmName
() { "MD2";}

22 
	`CRYPTOPP_CONSTANT
(
DIGESTSIZE
 = 16)

23 
	`CRYPTOPP_CONSTANT
(
BLOCKSIZE
 = 16)

25 
´iv©e
:

26 
	`T¿nsfÜm
();

27 
	`In™
();

28 
SecBy‹Block
 
m_X
, 
m_C
, 
m_buf
;

29 
m_couÁ
;

30 
	}
};

33 #ià
CRYPTOPP_ENABLE_NAMESPACE_WEAK
 >= 1

34 
Çme¥aû
 
	gW—k
 {
usšg
‚ame¥aû 
	gW—k1
;}

36 
usšg
 
Çme¥aû
 
	gW—k1
;

37 #ifdeà
__GNUC__


40 #´agm¨
mes§ge
("You may be using‡ weak‡lgorithmhat has been„etained for backwards compatibility. Please '#define CRYPTOPP_ENABLE_NAMESPACE_WEAK 1' before includinghis .h file‡nd…rependhe class‚ame with 'Weak::'o„emovehis warning.")

44 
	gNAMESPACE_END


	@md4.cpp

17 
	~"pch.h
"

18 
	#CRYPTOPP_ENABLE_NAMESPACE_WEAK
 1

	)

19 
	~"md4.h
"

20 
	~"misc.h
"

22 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

23 
Çme¥aû
 
W—k1
 {

25 
MD4
::
	`In™S‹
(
HashWÜdTy³
 *
¡©e
)

27 
¡©e
[0] = 0x67452301L;

28 
¡©e
[1] = 0xefcdab89L;

29 
¡©e
[2] = 0x98badcfeL;

30 
¡©e
[3] = 0x10325476L;

33 
MD4
::
	`T¿nsfÜm
 (
wÜd32
 *
dige¡
, cÚ¡ wÜd32 *
š
)

36 
	#F
(
x
, 
y
, 
z
è((zè^ ((xè& ((yè^ (z))))

	)

37 
	#G
(
x
, 
y
, 
z
è(((xè& (y)è| ((xè& (z)è| ((yè& (z)))

	)

38 
	#H
(
x
, 
y
, 
z
è((xè^ (yè^ (z))

	)

40 
wÜd32
 
A
, 
B
, 
C
, 
D
;

42 
A
=
dige¡
[0];

43 
B
=
dige¡
[1];

44 
C
=
dige¡
[2];

45 
D
=
dige¡
[3];

47 
	#funùiÚ
(
a
,
b
,
c
,
d
,
k
,
s
èa=
	`rÙlFixed
×+
	`F
(b,c,d)+
š
[k],s);

	)

48 
	`funùiÚ
(
A
,
B
,
C
,
D
, 0, 3);

49 
	`funùiÚ
(
D
,
A
,
B
,
C
, 1, 7);

50 
	`funùiÚ
(
C
,
D
,
A
,
B
, 2,11);

51 
	`funùiÚ
(
B
,
C
,
D
,
A
, 3,19);

52 
	`funùiÚ
(
A
,
B
,
C
,
D
, 4, 3);

53 
	`funùiÚ
(
D
,
A
,
B
,
C
, 5, 7);

54 
	`funùiÚ
(
C
,
D
,
A
,
B
, 6,11);

55 
	`funùiÚ
(
B
,
C
,
D
,
A
, 7,19);

56 
	`funùiÚ
(
A
,
B
,
C
,
D
, 8, 3);

57 
	`funùiÚ
(
D
,
A
,
B
,
C
, 9, 7);

58 
	`funùiÚ
(
C
,
D
,
A
,
B
,10,11);

59 
	`funùiÚ
(
B
,
C
,
D
,
A
,11,19);

60 
	`funùiÚ
(
A
,
B
,
C
,
D
,12, 3);

61 
	`funùiÚ
(
D
,
A
,
B
,
C
,13, 7);

62 
	`funùiÚ
(
C
,
D
,
A
,
B
,14,11);

63 
	`funùiÚ
(
B
,
C
,
D
,
A
,15,19);

65 #undeà
funùiÚ


66 
	#funùiÚ
(
a
,
b
,
c
,
d
,
k
,
s
èa=
	`rÙlFixed
×+
	`G
(b,c,d)+
š
[k]+0x5a827999,s);

	)

67 
	`funùiÚ
(
A
,
B
,
C
,
D
, 0, 3);

68 
	`funùiÚ
(
D
,
A
,
B
,
C
, 4, 5);

69 
	`funùiÚ
(
C
,
D
,
A
,
B
, 8, 9);

70 
	`funùiÚ
(
B
,
C
,
D
,
A
,12,13);

71 
	`funùiÚ
(
A
,
B
,
C
,
D
, 1, 3);

72 
	`funùiÚ
(
D
,
A
,
B
,
C
, 5, 5);

73 
	`funùiÚ
(
C
,
D
,
A
,
B
, 9, 9);

74 
	`funùiÚ
(
B
,
C
,
D
,
A
,13,13);

75 
	`funùiÚ
(
A
,
B
,
C
,
D
, 2, 3);

76 
	`funùiÚ
(
D
,
A
,
B
,
C
, 6, 5);

77 
	`funùiÚ
(
C
,
D
,
A
,
B
,10, 9);

78 
	`funùiÚ
(
B
,
C
,
D
,
A
,14,13);

79 
	`funùiÚ
(
A
,
B
,
C
,
D
, 3, 3);

80 
	`funùiÚ
(
D
,
A
,
B
,
C
, 7, 5);

81 
	`funùiÚ
(
C
,
D
,
A
,
B
,11, 9);

82 
	`funùiÚ
(
B
,
C
,
D
,
A
,15,13);

84 #undeà
funùiÚ


85 
	#funùiÚ
(
a
,
b
,
c
,
d
,
k
,
s
èa=
	`rÙlFixed
×+
	`H
(b,c,d)+
š
[k]+0x6ed9eba1,s);

	)

86 
	`funùiÚ
(
A
,
B
,
C
,
D
, 0, 3);

87 
	`funùiÚ
(
D
,
A
,
B
,
C
, 8, 9);

88 
	`funùiÚ
(
C
,
D
,
A
,
B
, 4,11);

89 
	`funùiÚ
(
B
,
C
,
D
,
A
,12,15);

90 
	`funùiÚ
(
A
,
B
,
C
,
D
, 2, 3);

91 
	`funùiÚ
(
D
,
A
,
B
,
C
,10, 9);

92 
	`funùiÚ
(
C
,
D
,
A
,
B
, 6,11);

93 
	`funùiÚ
(
B
,
C
,
D
,
A
,14,15);

94 
	`funùiÚ
(
A
,
B
,
C
,
D
, 1, 3);

95 
	`funùiÚ
(
D
,
A
,
B
,
C
, 9, 9);

96 
	`funùiÚ
(
C
,
D
,
A
,
B
, 5,11);

97 
	`funùiÚ
(
B
,
C
,
D
,
A
,13,15);

98 
	`funùiÚ
(
A
,
B
,
C
,
D
, 3, 3);

99 
	`funùiÚ
(
D
,
A
,
B
,
C
,11, 9);

100 
	`funùiÚ
(
C
,
D
,
A
,
B
, 7,11);

101 
	`funùiÚ
(
B
,
C
,
D
,
A
,15,15);

103 
dige¡
[0]+=
A
;

104 
dige¡
[1]+=
B
;

105 
dige¡
[2]+=
C
;

106 
dige¡
[3]+=
D
;

109 
	}
}

110 
	gNAMESPACE_END


	@md4.h

1 #iâdeà
CRYPTOPP_MD4_H


2 
	#CRYPTOPP_MD4_H


	)

4 
	~"™”hash.h
"

6 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

8 
Çme¥aû
 
W—k1
 {

13 
şass
 
MD4
 : 
public
 
I‹¿‹dHashW™hSticT¿nsfÜm
<
wÜd32
, 
L™eEndŸn
, 64, 16, MD4>

15 
public
:

16 
	`In™S‹
(
HashWÜdTy³
 *
¡©e
);

17 
	`T¿nsfÜm
(
wÜd32
 *
dige¡
, cÚ¡ wÜd32 *
d©a
);

18 cÚ¡ *
	`SticAlgÜ™hmName
() { "MD4";}

21 
	}
}

22 #ià
CRYPTOPP_ENABLE_NAMESPACE_WEAK
 >= 1

23 
Çme¥aû
 
	gW—k
 {
usšg
‚ame¥aû 
	gW—k1
;}

25 
usšg
 
Çme¥aû
 
	gW—k1
;

26 #ifdeà
__GNUC__


29 #´agm¨
mes§ge
("You may be using‡ weak‡lgorithmhat has been„etained for backwards compatibility. Please '#define CRYPTOPP_ENABLE_NAMESPACE_WEAK 1' before includinghis .h file‡nd…rependhe class‚ame with 'Weak::'o„emovehis warning.")

33 
	gNAMESPACE_END


	@md5.cpp

4 
	~"pch.h
"

5 
	#CRYPTOPP_ENABLE_NAMESPACE_WEAK
 1

	)

6 
	~"md5.h
"

7 
	~"misc.h
"

9 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

10 
Çme¥aû
 
W—k1
 {

12 
	`MD5_Te¡In¡ªtŸtiÚs
()

14 
MD5
 
x
;

17 
MD5
::
	`In™S‹
(
HashWÜdTy³
 *
¡©e
)

19 
¡©e
[0] = 0x67452301L;

20 
¡©e
[1] = 0xefcdab89L;

21 
¡©e
[2] = 0x98badcfeL;

22 
¡©e
[3] = 0x10325476L;

25 
MD5
::
	`T¿nsfÜm
 (
wÜd32
 *
dige¡
, cÚ¡ wÜd32 *
š
)

28 
	#F1
(
x
, 
y
, 
z
è(z ^ (x & (y ^ z)))

	)

29 
	#F2
(
x
, 
y
, 
z
è
	`F1
(z, x, y)

	)

30 
	#F3
(
x
, 
y
, 
z
è(x ^ y ^ z)

	)

31 
	#F4
(
x
, 
y
, 
z
è(y ^ (x | ~z))

	)

33 
	#MD5STEP
(
f
, 
w
, 
x
, 
y
, 
z
, 
d©a
, 
s
) \

34 
w
 = 
	`rÙlFixed
(w + 
	`f
(
x
, 
y
, 
z
è+ 
d©a
, 
s
è+ 
	)
x

36 
wÜd32
 
a
, 
b
, 
c
, 
d
;

38 
a
=
dige¡
[0];

39 
b
=
dige¡
[1];

40 
c
=
dige¡
[2];

41 
d
=
dige¡
[3];

43 
	`MD5STEP
(
F1
, 
a
, 
b
, 
c
, 
d
, 
š
[0] + 0xd76aa478, 7);

44 
	`MD5STEP
(
F1
, 
d
, 
a
, 
b
, 
c
, 
š
[1] + 0xe8c7b756, 12);

45 
	`MD5STEP
(
F1
, 
c
, 
d
, 
a
, 
b
, 
š
[2] + 0x242070db, 17);

46 
	`MD5STEP
(
F1
, 
b
, 
c
, 
d
, 
a
, 
š
[3] + 0xc1bdceee, 22);

47 
	`MD5STEP
(
F1
, 
a
, 
b
, 
c
, 
d
, 
š
[4] + 0xf57c0faf, 7);

48 
	`MD5STEP
(
F1
, 
d
, 
a
, 
b
, 
c
, 
š
[5] + 0x4787c62a, 12);

49 
	`MD5STEP
(
F1
, 
c
, 
d
, 
a
, 
b
, 
š
[6] + 0xa8304613, 17);

50 
	`MD5STEP
(
F1
, 
b
, 
c
, 
d
, 
a
, 
š
[7] + 0xfd469501, 22);

51 
	`MD5STEP
(
F1
, 
a
, 
b
, 
c
, 
d
, 
š
[8] + 0x698098d8, 7);

52 
	`MD5STEP
(
F1
, 
d
, 
a
, 
b
, 
c
, 
š
[9] + 0x8b44f7af, 12);

53 
	`MD5STEP
(
F1
, 
c
, 
d
, 
a
, 
b
, 
š
[10] + 0xffff5bb1, 17);

54 
	`MD5STEP
(
F1
, 
b
, 
c
, 
d
, 
a
, 
š
[11] + 0x895cd7be, 22);

55 
	`MD5STEP
(
F1
, 
a
, 
b
, 
c
, 
d
, 
š
[12] + 0x6b901122, 7);

56 
	`MD5STEP
(
F1
, 
d
, 
a
, 
b
, 
c
, 
š
[13] + 0xfd987193, 12);

57 
	`MD5STEP
(
F1
, 
c
, 
d
, 
a
, 
b
, 
š
[14] + 0xa679438e, 17);

58 
	`MD5STEP
(
F1
, 
b
, 
c
, 
d
, 
a
, 
š
[15] + 0x49b40821, 22);

60 
	`MD5STEP
(
F2
, 
a
, 
b
, 
c
, 
d
, 
š
[1] + 0xf61e2562, 5);

61 
	`MD5STEP
(
F2
, 
d
, 
a
, 
b
, 
c
, 
š
[6] + 0xc040b340, 9);

62 
	`MD5STEP
(
F2
, 
c
, 
d
, 
a
, 
b
, 
š
[11] + 0x265e5a51, 14);

63 
	`MD5STEP
(
F2
, 
b
, 
c
, 
d
, 
a
, 
š
[0] + 0xe9b6c7aa, 20);

64 
	`MD5STEP
(
F2
, 
a
, 
b
, 
c
, 
d
, 
š
[5] + 0xd62f105d, 5);

65 
	`MD5STEP
(
F2
, 
d
, 
a
, 
b
, 
c
, 
š
[10] + 0x02441453, 9);

66 
	`MD5STEP
(
F2
, 
c
, 
d
, 
a
, 
b
, 
š
[15] + 0xd8a1e681, 14);

67 
	`MD5STEP
(
F2
, 
b
, 
c
, 
d
, 
a
, 
š
[4] + 0xe7d3fbc8, 20);

68 
	`MD5STEP
(
F2
, 
a
, 
b
, 
c
, 
d
, 
š
[9] + 0x21e1cde6, 5);

69 
	`MD5STEP
(
F2
, 
d
, 
a
, 
b
, 
c
, 
š
[14] + 0xc33707d6, 9);

70 
	`MD5STEP
(
F2
, 
c
, 
d
, 
a
, 
b
, 
š
[3] + 0xf4d50d87, 14);

71 
	`MD5STEP
(
F2
, 
b
, 
c
, 
d
, 
a
, 
š
[8] + 0x455a14ed, 20);

72 
	`MD5STEP
(
F2
, 
a
, 
b
, 
c
, 
d
, 
š
[13] + 0xa9e3e905, 5);

73 
	`MD5STEP
(
F2
, 
d
, 
a
, 
b
, 
c
, 
š
[2] + 0xfcefa3f8, 9);

74 
	`MD5STEP
(
F2
, 
c
, 
d
, 
a
, 
b
, 
š
[7] + 0x676f02d9, 14);

75 
	`MD5STEP
(
F2
, 
b
, 
c
, 
d
, 
a
, 
š
[12] + 0x8d2a4c8a, 20);

77 
	`MD5STEP
(
F3
, 
a
, 
b
, 
c
, 
d
, 
š
[5] + 0xfffa3942, 4);

78 
	`MD5STEP
(
F3
, 
d
, 
a
, 
b
, 
c
, 
š
[8] + 0x8771f681, 11);

79 
	`MD5STEP
(
F3
, 
c
, 
d
, 
a
, 
b
, 
š
[11] + 0x6d9d6122, 16);

80 
	`MD5STEP
(
F3
, 
b
, 
c
, 
d
, 
a
, 
š
[14] + 0xfde5380c, 23);

81 
	`MD5STEP
(
F3
, 
a
, 
b
, 
c
, 
d
, 
š
[1] + 0xa4beea44, 4);

82 
	`MD5STEP
(
F3
, 
d
, 
a
, 
b
, 
c
, 
š
[4] + 0x4bdecfa9, 11);

83 
	`MD5STEP
(
F3
, 
c
, 
d
, 
a
, 
b
, 
š
[7] + 0xf6bb4b60, 16);

84 
	`MD5STEP
(
F3
, 
b
, 
c
, 
d
, 
a
, 
š
[10] + 0xbebfbc70, 23);

85 
	`MD5STEP
(
F3
, 
a
, 
b
, 
c
, 
d
, 
š
[13] + 0x289b7ec6, 4);

86 
	`MD5STEP
(
F3
, 
d
, 
a
, 
b
, 
c
, 
š
[0] + 0xeaa127fa, 11);

87 
	`MD5STEP
(
F3
, 
c
, 
d
, 
a
, 
b
, 
š
[3] + 0xd4ef3085, 16);

88 
	`MD5STEP
(
F3
, 
b
, 
c
, 
d
, 
a
, 
š
[6] + 0x04881d05, 23);

89 
	`MD5STEP
(
F3
, 
a
, 
b
, 
c
, 
d
, 
š
[9] + 0xd9d4d039, 4);

90 
	`MD5STEP
(
F3
, 
d
, 
a
, 
b
, 
c
, 
š
[12] + 0xe6db99e5, 11);

91 
	`MD5STEP
(
F3
, 
c
, 
d
, 
a
, 
b
, 
š
[15] + 0x1fa27cf8, 16);

92 
	`MD5STEP
(
F3
, 
b
, 
c
, 
d
, 
a
, 
š
[2] + 0xc4ac5665, 23);

94 
	`MD5STEP
(
F4
, 
a
, 
b
, 
c
, 
d
, 
š
[0] + 0xf4292244, 6);

95 
	`MD5STEP
(
F4
, 
d
, 
a
, 
b
, 
c
, 
š
[7] + 0x432aff97, 10);

96 
	`MD5STEP
(
F4
, 
c
, 
d
, 
a
, 
b
, 
š
[14] + 0xab9423a7, 15);

97 
	`MD5STEP
(
F4
, 
b
, 
c
, 
d
, 
a
, 
š
[5] + 0xfc93a039, 21);

98 
	`MD5STEP
(
F4
, 
a
, 
b
, 
c
, 
d
, 
š
[12] + 0x655b59c3, 6);

99 
	`MD5STEP
(
F4
, 
d
, 
a
, 
b
, 
c
, 
š
[3] + 0x8f0ccc92, 10);

100 
	`MD5STEP
(
F4
, 
c
, 
d
, 
a
, 
b
, 
š
[10] + 0xffeff47d, 15);

101 
	`MD5STEP
(
F4
, 
b
, 
c
, 
d
, 
a
, 
š
[1] + 0x85845dd1, 21);

102 
	`MD5STEP
(
F4
, 
a
, 
b
, 
c
, 
d
, 
š
[8] + 0x6fa87e4f, 6);

103 
	`MD5STEP
(
F4
, 
d
, 
a
, 
b
, 
c
, 
š
[15] + 0xfe2ce6e0, 10);

104 
	`MD5STEP
(
F4
, 
c
, 
d
, 
a
, 
b
, 
š
[6] + 0xa3014314, 15);

105 
	`MD5STEP
(
F4
, 
b
, 
c
, 
d
, 
a
, 
š
[13] + 0x4e0811a1, 21);

106 
	`MD5STEP
(
F4
, 
a
, 
b
, 
c
, 
d
, 
š
[4] + 0xf7537e82, 6);

107 
	`MD5STEP
(
F4
, 
d
, 
a
, 
b
, 
c
, 
š
[11] + 0xbd3af235, 10);

108 
	`MD5STEP
(
F4
, 
c
, 
d
, 
a
, 
b
, 
š
[2] + 0x2ad7d2bb, 15);

109 
	`MD5STEP
(
F4
, 
b
, 
c
, 
d
, 
a
, 
š
[9] + 0xeb86d391, 21);

111 
dige¡
[0]+=
a
;

112 
dige¡
[1]+=
b
;

113 
dige¡
[2]+=
c
;

114 
dige¡
[3]+=
d
;

117 
	}
}

118 
	gNAMESPACE_END


	@md5.h

1 #iâdeà
CRYPTOPP_MD5_H


2 
	#CRYPTOPP_MD5_H


	)

4 
	~"™”hash.h
"

6 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

8 
Çme¥aû
 
W—k1
 {

11 
şass
 
MD5
 : 
public
 
I‹¿‹dHashW™hSticT¿nsfÜm
<
wÜd32
, 
L™eEndŸn
, 64, 16, MD5>

13 
public
:

14 
	`In™S‹
(
HashWÜdTy³
 *
¡©e
);

15 
	`T¿nsfÜm
(
wÜd32
 *
dige¡
, cÚ¡ wÜd32 *
d©a
);

16 cÚ¡ * 
	`SticAlgÜ™hmName
() { "MD5";}

19 
	}
}

20 #ià
CRYPTOPP_ENABLE_NAMESPACE_WEAK
 >= 1

21 
Çme¥aû
 
	gW—k
 {
usšg
‚ame¥aû 
	gW—k1
;}

23 
usšg
 
Çme¥aû
 
	gW—k1
;

24 #ifdeà
__GNUC__


27 #´agm¨
mes§ge
("You may be using‡ weak‡lgorithmhat has been„etained for backwards compatibility. Please '#define CRYPTOPP_ENABLE_NAMESPACE_WEAK 1' before includinghis .h file‡nd…rependhe class‚ame with 'Weak::'o„emovehis warning.")

31 
	gNAMESPACE_END


	@mdc.h

3 #iâdeà
CRYPTOPP_MDC_H


4 
	#CRYPTOPP_MDC_H


	)

9 
	~"£ckey.h
"

10 
	~"misc.h
"

12 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

15 
‹m¶©e
 <
şass
 
T
>

16 
MDC_Info
 : 
public
 
FixedBlockSize
<
T
::
DIGESTSIZE
>,…ubliø
FixedKeyL’gth
<T::
BLOCKSIZE
>

18 
¡d
::
¡ršg
 
	`SticAlgÜ™hmName
(è{ std::
	`¡ršg
("MDC/")+
T
::StaticAlgorithmName();}

19 
	}
};

23 
	g‹m¶©e
 <
şass
 
	gT
>

24 
şass
 
	gMDC
 : 
public
 
MDC_Info
<
T
>

26 
şass
 
CRYPTOPP_NO_VTABLE
 
Enc
 : 
public
 
BlockCh”Im¶
<
MDC_Info
<
T
> >

28 
ty³Çme
 
	tT
::
	tHashWÜdTy³
 HashWordType;

30 
	gpublic
:

31 
UncheckedS‘Key
(cÚ¡ 
by‹
 *
u£rKey
, 
Ëngth
, cÚ¡ 
NameV®uePaœs
 &
·¿ms
)

33 
	gthis
->
As£¹V®idKeyL’gth
(
Ëngth
);

34 
memıy_s
(
m_key
, m_key.
size
(), 
u£rKey
, 
this
->
KEYLENGTH
);

35 
	gT
::
CÜ»ùEndŸÃss
(
Key
(), Key(), 
this
->
KEYLENGTH
);

38 
ProûssAndXÜBlock
(cÚ¡ 
by‹
 *
šBlock
, cÚ¡ by‹ *
xÜBlock
, by‹ *
outBlock
) const

40 
	gT
::
CÜ»ùEndŸÃss
(
Bufãr
(), (
HashWÜdTy³
 *)
šBlock
, 
this
->
BLOCKSIZE
);

41 
	gT
::
T¿nsfÜm
(
Bufãr
(), 
Key
());

42 ià(
	gxÜBlock
)

44 
	gT
::
CÜ»ùEndŸÃss
(
Bufãr
(), Bufãr(), 
this
->
BLOCKSIZE
);

45 
xÜbuf
(
outBlock
, 
xÜBlock
, 
m_bufãr
, 
this
->
BLOCKSIZE
);

48 
	gT
::
CÜ»ùEndŸÃss
((
HashWÜdTy³
 *)
outBlock
, 
Bufãr
(), 
this
->
BLOCKSIZE
);

51 
boŞ
 
IsP”mutiÚ
(ècÚ¡ { 
	gçl£
;}

53 
O±im®D©aAlignm’t
(ècÚ¡ { (
	gHashWÜdTy³
);}

55 
	g´iv©e
:

56 
HashWÜdTy³
 *
Key
(è{ (HashWÜdTy³ *)
m_key
.
d©a
();}

57 cÚ¡ 
HashWÜdTy³
 *
Key
(ècÚ¡ { (cÚ¡ 
	gHashWÜdTy³
 *)
	gm_key
.
d©a
();}

58 
HashWÜdTy³
 *
Bufãr
(ècÚ¡ { (
	gHashWÜdTy³
 *)
	gm_bufãr
.
d©a
();}

61 
	gFixedSizeSecBlock
<
	gby‹
, 
	gMDC_Info
<
	gT
>::
KEYLENGTH
, 
	gAÎoÿtÜW™hCËªup
<by‹> > 
	gm_key
;

62 
mubË
 
	gFixedSizeSecBlock
<
	gby‹
, 
	gMDC_Info
<
	gT
>::
BLOCKSIZE
, 
	gAÎoÿtÜW™hCËªup
<by‹> > 
	gm_bufãr
;

65 
	gpublic
:

67 
BlockCh”Fš®
<
	tENCRYPTION
, 
	tEnc
> 
	tEnüy±iÚ
;

70 
	gNAMESPACE_END


	@misc.cpp

3 
	~"pch.h
"

5 #iâdeà
CRYPTOPP_IMPORTS


7 
	~"misc.h
"

8 
	~"wÜds.h
"

9 
	~<Ãw
>

11 #ià
defšed
(
CRYPTOPP_MEMALIGN_AVAILABLE
è|| defšed(
CRYPTOPP_MM_MALLOC_AVAILABLE
è|| defšed(
QNX
)

12 
	~<m®loc.h
>

15 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

17 
	$xÜbuf
(
by‹
 *
buf
, cÚ¡ by‹ *
mask
, 
size_t
 
couÁ
)

19 
size_t
 
i
;

21 ià(
IsAligÃd
<
wÜd32
>(
buf
è&& IsAligÃd<wÜd32>(
mask
))

23 ià(!
CRYPTOPP_BOOL_SLOW_WORD64
 && 
IsAligÃd
<
wÜd64
>(
buf
è&& IsAligÃd<wÜd64>(
mask
))

25 
i
=0; i<
couÁ
/8; i++)

26 ((
wÜd64
*)
buf
)[
i
] ^ğ((wÜd64*)
mask
)[i];

27 
couÁ
 -ğ8*
i
;

28 ià(!
couÁ
)

30 
buf
 +ğ8*
i
;

31 
mask
 +ğ8*
i
;

34 
i
=0; i<
couÁ
/4; i++)

35 ((
wÜd32
*)
buf
)[
i
] ^ğ((wÜd32*)
mask
)[i];

36 
couÁ
 -ğ4*
i
;

37 ià(!
couÁ
)

39 
buf
 +ğ4*
i
;

40 
mask
 +ğ4*
i
;

43 
i
=0; i<
couÁ
; i++)

44 
buf
[
i
] ^ğ
mask
[i];

45 
	}
}

47 
	$xÜbuf
(
by‹
 *
ouut
, cÚ¡ by‹ *
šput
, cÚ¡ by‹ *
mask
, 
size_t
 
couÁ
)

49 
size_t
 
i
;

51 ià(
IsAligÃd
<
wÜd32
>(
ouut
è&& IsAligÃd<wÜd32>(
šput
è&& IsAligÃd<wÜd32>(
mask
))

53 ià(!
CRYPTOPP_BOOL_SLOW_WORD64
 && 
IsAligÃd
<
wÜd64
>(
ouut
è&& IsAligÃd<wÜd64>(
šput
è&& IsAligÃd<wÜd64>(
mask
))

55 
i
=0; i<
couÁ
/8; i++)

56 ((
wÜd64
*)
ouut
)[
i
] = ((wÜd64*)
šput
)[i] ^ ((wÜd64*)
mask
)[i];

57 
couÁ
 -ğ8*
i
;

58 ià(!
couÁ
)

60 
ouut
 +ğ8*
i
;

61 
šput
 +ğ8*
i
;

62 
mask
 +ğ8*
i
;

65 
i
=0; i<
couÁ
/4; i++)

66 ((
wÜd32
*)
ouut
)[
i
] = ((wÜd32*)
šput
)[i] ^ ((wÜd32*)
mask
)[i];

67 
couÁ
 -ğ4*
i
;

68 ià(!
couÁ
)

70 
ouut
 +ğ4*
i
;

71 
šput
 +ğ4*
i
;

72 
mask
 +ğ4*
i
;

75 
i
=0; i<
couÁ
; i++)

76 
ouut
[
i
] = 
šput
[i] ^ 
mask
[i];

77 
	}
}

79 
boŞ
 
	$V”ifyBufsEqu®
(cÚ¡ 
by‹
 *
buf
, cÚ¡ by‹ *
mask
, 
size_t
 
couÁ
)

81 
size_t
 
i
;

82 
by‹
 
acc8
 = 0;

84 ià(
IsAligÃd
<
wÜd32
>(
buf
è&& IsAligÃd<wÜd32>(
mask
))

86 
wÜd32
 
acc32
 = 0;

87 ià(!
CRYPTOPP_BOOL_SLOW_WORD64
 && 
IsAligÃd
<
wÜd64
>(
buf
è&& IsAligÃd<wÜd64>(
mask
))

89 
wÜd64
 
acc64
 = 0;

90 
i
=0; i<
couÁ
/8; i++)

91 
acc64
 |ğ((
wÜd64
*)
buf
)[
i
] ^ ((wÜd64*)
mask
)[i];

92 
couÁ
 -ğ8*
i
;

93 ià(!
couÁ
)

94  
acc64
 == 0;

95 
buf
 +ğ8*
i
;

96 
mask
 +ğ8*
i
;

97 
acc32
 = 
	`wÜd32
(
acc64
) | word32(acc64>>32);

100 
i
=0; i<
couÁ
/4; i++)

101 
acc32
 |ğ((
wÜd32
*)
buf
)[
i
] ^ ((wÜd32*)
mask
)[i];

102 
couÁ
 -ğ4*
i
;

103 ià(!
couÁ
)

104  
acc32
 == 0;

105 
buf
 +ğ4*
i
;

106 
mask
 +ğ4*
i
;

107 
acc8
 = 
	`by‹
(
acc32
) | byte(acc32>>8) | byte(acc32>>16) | byte(acc32>>24);

110 
i
=0; i<
couÁ
; i++)

111 
acc8
 |ğ
buf
[
i
] ^ 
mask
[i];

112  
acc8
 == 0;

113 
	}
}

115 #ià!(
defšed
(
_MSC_VER
) && (_MSC_VER < 1300))

116 
usšg
 
	g¡d
::
Ãw_hªdËr
;

117 
usšg
 
	g¡d
::
£t_Ãw_hªdËr
;

120 
	$C®lNewHªdËr
()

122 
Ãw_hªdËr
 
ÃwHªdËr
 = 
	`£t_Ãw_hªdËr
(
NULL
);

123 ià(
ÃwHªdËr
)

124 
	`£t_Ãw_hªdËr
(
ÃwHªdËr
);

126 ià(
ÃwHªdËr
)

127 
	`ÃwHªdËr
();

129 
throw
 
¡d
::
	`bad_®loc
();

130 
	}
}

132 #ià
CRYPTOPP_BOOL_ALIGN16_ENABLED


134 * 
	$AligÃdAÎoÿ‹
(
size_t
 
size
)

136 
by‹
 *
p
;

137 #ifdeà
CRYPTOPP_MM_MALLOC_AVAILABLE


138 !(
p
 = (
by‹
 *)
	`_mm_m®loc
(
size
, 16)))

139 #–ià
	`defšed
(
CRYPTOPP_MEMALIGN_AVAILABLE
)

140 !(
p
 = (
by‹
 *)
	`mem®ign
(16, 
size
)))

141 #–ià
	`defšed
(
CRYPTOPP_MALLOC_ALIGNMENT_IS_16
)

142 !(
p
 = (
by‹
 *)
	`m®loc
(
size
)))

144 !(
p
 = (
by‹
 *)
	`m®loc
(
size
 + 16)))

146 
	`C®lNewHªdËr
();

148 #ifdeà
CRYPTOPP_NO_ALIGNED_ALLOC


149 
size_t
 
adju¡m’t
 = 16-((size_t)
p
%16);

150 
p
 +ğ
adju¡m’t
;

151 
p
[-1] = (
by‹
)
adju¡m’t
;

154 
	`as£¹
(
	`IsAligÃdOn
(
p
, 16));

155  
p
;

156 
	}
}

158 
	$AligÃdD—Îoÿ‹
(*
p
)

160 #ifdeà
CRYPTOPP_MM_MALLOC_AVAILABLE


161 
	`_mm_ä“
(
p
);

162 #–ià
	`defšed
(
CRYPTOPP_NO_ALIGNED_ALLOC
)

163 
p
 = (
by‹
 *)p - ((byte *)p)[-1];

164 
	`ä“
(
p
);

166 
	`ä“
(
p
);

168 
	}
}

172 * 
	$UÇligÃdAÎoÿ‹
(
size_t
 
size
)

174 *
p
;

175 !(
p
 = 
	`m®loc
(
size
)))

176 
	`C®lNewHªdËr
();

177  
p
;

178 
	}
}

180 
	$UÇligÃdD—Îoÿ‹
(*
p
)

182 
	`ä“
(
p
);

183 
	}
}

185 
	gNAMESPACE_END


	@misc.h

1 #iâdeà
CRYPTOPP_MISC_H


2 
	#CRYPTOPP_MISC_H


	)

4 
	~"üy±lib.h
"

5 
	~"sm¬Œ.h
"

6 
	~<¡ršg.h
>

8 #ifdeà
_MSC_VER


9 #ià
_MSC_VER
 >= 1400

11 
	#_š‹¾ockedb™‹¡ªd£t
 
CRYPTOPP_DISABLED_INTRINSIC_1


	)

12 
	#_š‹¾ockedb™‹¡ªd»£t
 
CRYPTOPP_DISABLED_INTRINSIC_2


	)

13 
	#_š‹¾ockedb™‹¡ªd£t64
 
CRYPTOPP_DISABLED_INTRINSIC_3


	)

14 
	#_š‹¾ockedb™‹¡ªd»£t64
 
CRYPTOPP_DISABLED_INTRINSIC_4


	)

15 
	~<šŒš.h
>

16 #undeà
_š‹¾ockedb™‹¡ªd£t


17 #undeà
_š‹¾ockedb™‹¡ªd»£t


18 #undeà
_š‹¾ockedb™‹¡ªd£t64


19 #undeà
_š‹¾ockedb™‹¡ªd»£t64


20 
	#CRYPTOPP_FAST_ROTATE
(
x
è1

	)

21 #–ià
_MSC_VER
 >= 1300

22 
	#CRYPTOPP_FAST_ROTATE
(
x
è((xè=ğ32 | (xè=ğ64)

	)

24 
	#CRYPTOPP_FAST_ROTATE
(
x
è((xè=ğ32)

	)

26 #–ià(
defšed
(
__MWERKS__
è&& 
TARGET_CPU_PPC
) || \

27 (
defšed
(
__GNUC__
è&& (defšed(
_ARCH_PWR2
è|| defšed(
_ARCH_PWR
è|| defšed(
_ARCH_PPC
è|| defšed(
_ARCH_PPC64
è|| 
	$defšed
(
_ARCH_COM
)))

28 
	#CRYPTOPP_FAST_ROTATE
(
x
è((xè=ğ32)

	)

29 #–ià
	`defšed
(
__GNUC__
è&& (
CRYPTOPP_BOOL_X64
 || 
CRYPTOPP_BOOL_X86
)

30 
	#CRYPTOPP_FAST_ROTATE
(
x
è1

	)

32 
	#CRYPTOPP_FAST_ROTATE
(
x
è0

	)

35 #ifdeà
__BORLANDC__


36 
	~<mem.h
>

39 #ià
	`defšed
(
__GNUC__
è&& defšed(
__lšux__
)

40 
	#CRYPTOPP_BYTESWAP_AVAILABLE


	)

41 
	~<by‹sw­.h
>

44 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

48 
‹m¶©e
 <
boŞ
 
b
>

49 
	sCompeAs£¹


51 
dummy
[2*
b
-1];

54 
	#CRYPTOPP_COMPILE_ASSERT
(
as£¹iÚ
è
	`CRYPTOPP_COMPILE_ASSERT_INSTANCE
×s£¹iÚ, 
__LINE__
)

	)

55 #ià
	`defšed
(
CRYPTOPP_EXPORTS
è|| defšed(
CRYPTOPP_IMPORTS
)

56 
	#CRYPTOPP_COMPILE_ASSERT_INSTANCE
(
as£¹iÚ
, 
š¡ªû
)

	)

58 
	#CRYPTOPP_COMPILE_ASSERT_INSTANCE
(
as£¹iÚ
, 
š¡ªû
è
CompeAs£¹
<×s£¹iÚ)> 
	`CRYPTOPP_ASSERT_JOIN
(
üy±İp_as£¹_
, in¡ªû)

	)

60 
	#CRYPTOPP_ASSERT_JOIN
(
X
, 
Y
è
	`CRYPTOPP_DO_ASSERT_JOIN
(X, Y)

	)

61 
	#CRYPTOPP_DO_ASSERT_JOIN
(
X
, 
Y
èX##
	)
Y

65 şas 
	cCRYPTOPP_DLL
 
Em±y


70 
‹m¶©e
 <
şass
 
BASE1
, cÏs 
BASE2
>

71 
şass
 
CRYPTOPP_NO_VTABLE
 
TwoBa£s
 : 
public
 
BASE1
,…ubliø
BASE2


73 
	}
};

76 
	g‹m¶©e
 <
şass
 
	gBASE1
, cÏs 
	gBASE2
, cÏs 
	gBASE3
>

77 
şass
 
CRYPTOPP_NO_VTABLE
 
	gTh»eBa£s
 : 
public
 
BASE1
,…ubliø
	gBASE2
,…ubliø
	gBASE3


81 
	g‹m¶©e
 <
şass
 
	gT
>

82 şas 
	cObjeùHŞd”


84 
	m´Ùeùed
:

85 
T
 
m_objeù
;

88 şas 
	cNÙCİyabË


90 
	mpublic
:

91 
	$NÙCİyabË
() {}

92 
´iv©e
:

93 
	`NÙCİyabË
(cÚ¡ 
NÙCİyabË
 &);

94 
İ”©Ü
=(cÚ¡ 
NÙCİyabË
 &);

95 
	}
};

97 
	g‹m¶©e
 <
şass
 
	gT
>

98 
	sNewObjeù


100 
T
* 
İ”©Ü
()(ècÚ¡ { 
Ãw
 
	mT
;}

107 
	g‹m¶©e
 <
şass
 
	gT
, cÏs 
	gF
 = 
NewObjeù
<
T
>, 
	gš¡ªû
=0>

108 şas 
	cSšgËtÚ


110 
public
:

111 
SšgËtÚ
(
F
 
objeùFaùÜy
 = 
	$F
()è: 
	$m_objeùFaùÜy
(
objeùFaùÜy
) {}

114 
CRYPTOPP_NOINLINE
 cÚ¡ 
T
 & 
	$Ref
(
CRYPTOPP_NOINLINE_DOTDOTDOT
) const;

116 
´iv©e
:

117 
F
 
m_objeùFaùÜy
;

118 
	}
};

120 
	g‹m¶©e
 <
şass
 
	gT
, cÏs 
	gF
, 
	gš¡ªû
>

121 cÚ¡ 
	gT
 & 
	gSšgËtÚ
<T, 
	gF
, 
	gš¡ªû
>::
	$Ref
(
CRYPTOPP_NOINLINE_DOTDOTDOT
) const

123 vŞ©
sim¶e_±r
<
T
> 
s_pObjeù
;

124 
T
 *
p
 = 
s_pObjeù
.
m_p
;

126 ià(
p
)

127  *
p
;

129 
T
 *
ÃwObjeù
 = 
	`m_objeùFaùÜy
();

130 
p
 = 
s_pObjeù
.
m_p
;

132 ià(
p
)

134 
d–‘e
 
ÃwObjeù
;

135  *
p
;

138 
s_pObjeù
.
m_p
 = 
ÃwObjeù
;

139  *
ÃwObjeù
;

140 
	}
}

144 #ià(!
__STDC_WANT_SECURE_LIB__
 && !
defšed
(
_MEMORY_S_DEFINED
))

145 
šlše
 
	$memıy_s
(*
de¡
, 
size_t
 
sizeInBy‹s
, cÚ¡ *
¤c
, size_ˆ
couÁ
)

147 ià(
couÁ
 > 
sizeInBy‹s
)

148 
throw
 
	`Inv®idArgum’t
("memcpy_s: buffer overflow");

149 
	`memıy
(
de¡
, 
¤c
, 
couÁ
);

150 
	}
}

152 
šlše
 
	$memmove_s
(*
de¡
, 
size_t
 
sizeInBy‹s
, cÚ¡ *
¤c
, size_ˆ
couÁ
)

154 ià(
couÁ
 > 
sizeInBy‹s
)

155 
throw
 
	`Inv®idArgum’t
("memmove_s: buffer overflow");

156 
	`memmove
(
de¡
, 
¤c
, 
couÁ
);

157 
	}
}

159 #ià
__BORLANDC__
 >= 0x620

161 
	#memıy_s
 
Cry±oPP
::
memıy_s


	)

162 
	#memmove_s
 
Cry±oPP
::
memmove_s


	)

166 
šlše
 * 
	$mem£t_z
(*
±r
, 
v®ue
, 
size_t
 
num
)

169 #ià
CRYPTOPP_GCC_VERSION
 >= 30001

170 ià(
	`__butš_cÚ¡ªt_p
(
num
) &&‚um==0)

171  
±r
;

173  
	`mem£t
(
±r
, 
v®ue
, 
num
);

174 
	}
}

177 
	g‹m¶©e
 <
şass
 
	gT
> 
šlše
 cÚ¡ T& 
	$STDMIN
(cÚ¡ 
T
& 
a
, cÚ¡ T& 
b
)

179  
b
 < 
a
 ? b :‡;

180 
	}
}

182 
	g‹m¶©e
 <
şass
 
	gT1
, cÏs 
	gT2
> 
šlše
 cÚ¡ 
T1
 
	$UnsigÃdMš
(cÚ¡ 
T1
& 
a
, cÚ¡ 
T2
& 
b
)

184 
	`CRYPTOPP_COMPILE_ASSERT
(((
T1
)<=(
T2
è&& 
	`T2
(-1)>0è|| ((T1)>(T2è&& 
	`T1
(-1)>0));

185 
	`as£¹
(
a
==0 ||‡>0);

186 
	`as£¹
(
b
>=0);

188 ià((
T1
)<=(
T2
))

189  
b
 < (
T2
)
a
 ? (
T1
)b :‡;

191  (
T1
)
b
 < 
a
 ? (T1)b :‡;

192 
	}
}

194 
	g‹m¶©e
 <
şass
 
	gT
> 
šlše
 cÚ¡ T& 
	$STDMAX
(cÚ¡ 
T
& 
a
, cÚ¡ T& 
b
)

196  
a
 < 
b
 ? b :‡;

197 
	}
}

199 
	#RETURN_IF_NONZERO
(
x
è
size_t
 
»tuºedV®ue
 = x; iàÔ‘uºedV®ueè 
	)
returnedValue

202 
	#GETBYTE
(
x
, 
y
è()
	`by‹
((x)>>(8*(y)))

	)

207 
	#CRYPTOPP_GET_BYTE_AS_BYTE
(
x
, 
y
è
	`by‹
((x)>>(8*(y)))

	)

209 
	g‹m¶©e
 <
şass
 
	gT
>

210 
	$P¬™y
(
T
 
v®ue
)

212 
i
=8*(
v®ue
)/2; i>0; i/=2)

213 
v®ue
 ^ğv®u>> 
i
;

214  ()
v®ue
&1;

215 
	}
}

217 
	g‹m¶©e
 <
şass
 
	gT
>

218 
	$By‹P»cisiÚ
(cÚ¡ 
T
 &
v®ue
)

220 ià(!
v®ue
)

223 
l
=0, 
h
=8*(
v®ue
);

225 
h
-
l
 > 8)

227 
t
 = (
l
+
h
)/2;

228 ià(
v®ue
 >> 
t
)

229 
l
 = 
t
;

231 
h
 = 
t
;

234  
h
/8;

235 
	}
}

237 
	g‹m¶©e
 <
şass
 
	gT
>

238 
	$B™P»cisiÚ
(cÚ¡ 
T
 &
v®ue
)

240 ià(!
v®ue
)

243 
l
=0, 
h
=8*(
v®ue
);

245 
h
-
l
 > 1)

247 
t
 = (
l
+
h
)/2;

248 ià(
v®ue
 >> 
t
)

249 
l
 = 
t
;

251 
h
 = 
t
;

254  
h
;

255 
	}
}

257 
šlše
 
	$T¿šgZ”os
(
wÜd32
 
v
)

259 #ià
	`defšed
(
__GNUC__
è&& 
CRYPTOPP_GCC_VERSION
 >= 30400

260  
	`__butš_ùz
(
v
);

261 #–ià
	`defšed
(
_MSC_VER
) && _MSC_VER >= 1400

262 
»suÉ
;

263 
	`_B™SÿnFÜw¬d
(&
»suÉ
, 
v
);

264  
»suÉ
;

267 cÚ¡ 
MuÉlyDeBruijnB™Pos™iÚ
[32] =

272  
MuÉlyDeBruijnB™Pos™iÚ
[((
wÜd32
)((
v
 & -v) * 0x077CB531U)) >> 27];

274 
	}
}

276 
šlše
 
	$T¿šgZ”os
(
wÜd64
 
v
)

278 #ià
	`defšed
(
__GNUC__
è&& 
CRYPTOPP_GCC_VERSION
 >= 30400

279  
	`__butš_ùzÎ
(
v
);

280 #–ià
	`defšed
(
_MSC_VER
è&& _MSC_VER >ğ1400 && (defšed(
_M_X64
è|| defšed(
_M_IA64
))

281 
»suÉ
;

282 
	`_B™SÿnFÜw¬d64
(&
»suÉ
, 
v
);

283  
»suÉ
;

285  
	`wÜd32
(
v
è? 
	`T¿šgZ”os
(word32(v)) : 32 + TrailingZeros(word32(v>>32));

287 
	}
}

289 
	g‹m¶©e
 <
şass
 
	gT
>

290 
šlše
 
T
 
	$Crİ
(
T
 
v®ue
, 
size_t
 
size
)

292 ià(
size
 < 8*(
v®ue
))

293  
	`T
(
v®ue
 & ((T(1è<< 
size
) - 1));

295  
v®ue
;

296 
	}
}

298 
	g‹m¶©e
 <
şass
 
	gT1
, cÏs 
	gT2
>

299 
šlše
 
boŞ
 
	$SaãCÚv”t
(
T1
 
äom
, 
T2
 &
to
)

301 
to
 = (
T2
)
äom
;

302 ià(
äom
 !ğ
to
 || (from > 0) != (to > 0))

303  
çl£
;

304  
Œue
;

305 
	}
}

307 
šlše
 
size_t
 
	$B™sToBy‹s
(
size_t
 
b™CouÁ
)

309  ((
b™CouÁ
+7)/(8));

310 
	}
}

312 
šlše
 
size_t
 
	$By‹sToWÜds
(
size_t
 
by‹CouÁ
)

314  ((
by‹CouÁ
+
WORD_SIZE
-1)/WORD_SIZE);

315 
	}
}

317 
šlše
 
size_t
 
	$B™sToWÜds
(
size_t
 
b™CouÁ
)

319  ((
b™CouÁ
+
WORD_BITS
-1)/(WORD_BITS));

320 
	}
}

322 
šlše
 
size_t
 
	$B™sToDwÜds
(
size_t
 
b™CouÁ
)

324  ((
b™CouÁ
+2*
WORD_BITS
-1)/(2*WORD_BITS));

325 
	}
}

327 
CRYPTOPP_DLL
 
CRYPTOPP_API
 
xÜbuf
(
by‹
 *
buf
, cÚ¡ by‹ *
mask
, 
size_t
 
couÁ
);

328 
CRYPTOPP_DLL
 
CRYPTOPP_API
 
xÜbuf
(
by‹
 *
ouut
, cÚ¡ by‹ *
šput
, cÚ¡ by‹ *
mask
, 
size_t
 
couÁ
);

330 
CRYPTOPP_DLL
 
boŞ
 
CRYPTOPP_API
 
V”ifyBufsEqu®
(cÚ¡ 
by‹
 *
buf1
, cÚ¡ by‹ *
buf2
, 
size_t
 
couÁ
);

332 
	g‹m¶©e
 <
şass
 
	gT
>

333 
šlše
 
boŞ
 
	$IsPow”Of2
(cÚ¡ 
T
 &
n
)

335  
n
 > 0 && (n & (n-1)) == 0;

336 
	}
}

338 
	g‹m¶©e
 <
şass
 
	gT1
, cÏs 
	gT2
>

339 
šlše
 
T2
 
	$ModPow”Of2
(cÚ¡ 
T1
 &
a
, cÚ¡ 
T2
 &
b
)

341 
	`as£¹
(
	`IsPow”Of2
(
b
));

342  
	`T2
(
a
è& (
b
-1);

343 
	}
}

345 
	g‹m¶©e
 <
şass
 
	gT1
, cÏs 
	gT2
>

346 
šlše
 
T1
 
	$RoundDownToMuÉËOf
(cÚ¡ 
T1
 &
n
, cÚ¡ 
T2
 &
m
)

348 ià(
	`IsPow”Of2
(
m
))

349  
n
 - 
	`ModPow”Of2
Ò, 
m
);

351  
n
 -‚%
m
;

352 
	}
}

354 
	g‹m¶©e
 <
şass
 
	gT1
, cÏs 
	gT2
>

355 
šlše
 
T1
 
	$RoundUpToMuÉËOf
(cÚ¡ 
T1
 &
n
, cÚ¡ 
T2
 &
m
)

357 ià(
n
+
m
-1 <‚)

358 
throw
 
	`Inv®idArgum’t
("RoundUpToMultipleOf: integer overflow");

359  
	`RoundDownToMuÉËOf
(
n
+
m
-1, m);

360 
	}
}

362 
	g‹m¶©e
 <
şass
 
	gT
>

363 
šlše
 
	$G‘Alignm’tOf
(
T
 *
dummy
=
NULL
)

365 #ifdeà
CRYPTOPP_ALLOW_UNALIGNED_DATA_ACCESS


366 ià((
T
) < 16)

370 #ià(
_MSC_VER
 >= 1300)

371  
	`__®ignof
(
T
);

372 #–ià
	`defšed
(
__GNUC__
)

373  
	`__®ignof__
(
T
);

374 #–ià
CRYPTOPP_BOOL_SLOW_WORD64


375  
	`UnsigÃdMš
(4U, (
T
));

377  (
T
);

379 
	}
}

381 
šlše
 
boŞ
 
	$IsAligÃdOn
(cÚ¡ *
p
, 
®ignm’t
)

383  
®ignm’t
==1 || (
	`IsPow”Of2
×lignm’tè? 
	`ModPow”Of2
((
size_t
)
p
,‡lignment) == 0 : (size_t)p %‡lignment == 0);

384 
	}
}

386 
	g‹m¶©e
 <
şass
 
	gT
>

387 
šlše
 
boŞ
 
	$IsAligÃd
(cÚ¡ *
p
, 
T
 *
dummy
=
NULL
)

389  
	`IsAligÃdOn
(
p
, 
G‘Alignm’tOf
<
T
>());

390 
	}
}

392 #ifdeà
IS_LITTLE_ENDIAN


393 
L™eEndŸn
 
	tN©iveBy‹Ord”
;

395 
BigEndŸn
 
	tN©iveBy‹Ord”
;

398 
šlše
 
By‹Ord”
 
	$G‘N©iveBy‹Ord”
()

400  
N©iveBy‹Ord”
::
	`ToEnum
();

401 
	}
}

403 
šlše
 
boŞ
 
	$N©iveBy‹Ord”Is
(
By‹Ord”
 
Üd”
)

405  
Üd”
 =ğ
	`G‘N©iveBy‹Ord”
();

406 
	}
}

408 
	g‹m¶©e
 <
şass
 
	gT
>

409 
	g¡d
::
¡ršg
 
	$IÁToSŒšg
(
T
 
a
, 
ba£
 = 10)

411 ià(
a
 == 0)

413 
boŞ
 
Ãg©e
 = 
çl£
;

414 ià(
a
 < 0)

416 
Ãg©e
 = 
Œue
;

417 
a
 = 0-a;

419 
¡d
::
¡ršg
 
»suÉ
;

420 
a
 > 0)

422 
T
 
dig™
 = 
a
 % 
ba£
;

423 
»suÉ
 = ((
dig™
 < 10 ? '0' : ('a' - 10)) + digit) +„esult;

424 
a
 /ğ
ba£
;

426 ià(
Ãg©e
)

427 
»suÉ
 = "-" +„esult;

428  
»suÉ
;

429 
	}
}

431 
	g‹m¶©e
 <
şass
 
	gT1
, cÏs 
	gT2
>

432 
šlše
 
T1
 
	$S©u¿tšgSubŒaù
(cÚ¡ 
T1
 &
a
, cÚ¡ 
T2
 &
b
)

434  
	`T1
((
a
 > 
b
) ? (a - b) : 0);

435 
	}
}

437 
	g‹m¶©e
 <
şass
 
	gT
>

438 
šlše
 
Ch”Dœ
 
	$G‘Ch”Dœ
(cÚ¡ 
T
 &
obj
)

440  
obj
.
	`IsFÜw¬dT¿nsfÜm©iÚ
(è? 
ENCRYPTION
 : 
DECRYPTION
;

441 
	}
}

443 
CRYPTOPP_DLL
 
CRYPTOPP_API
 
C®lNewHªdËr
();

445 
šlše
 
	$Inüem’tCouÁ”ByOÃ
(
by‹
 *
šout
, 
s
)

447 
i
=
s
-1, 
ÿ¼y
=1; i>=0 && carry; i--)

448 
ÿ¼y
 = !++
šout
[
i
];

449 
	}
}

451 
šlše
 
	$Inüem’tCouÁ”ByOÃ
(
by‹
 *
ouut
, cÚ¡ by‹ *
šput
, 
s
)

453 
i
, 
ÿ¼y
;

454 
i
=
s
-1, 
ÿ¼y
=1; i>=0 && carry; i--)

455 
ÿ¼y
 = ((
ouut
[
i
] = 
šput
[i]+1) == 0);

456 
	`memıy_s
(
ouut
, 
s
, 
šput
, 
i
+1);

457 
	}
}

459 
	g‹m¶©e
 <
şass
 
	gT
>

460 
šlše
 
	$CÚd™iÚ®Sw­
(
boŞ
 
c
, 
T
 &
a
, T &
b
)

462 
T
 
t
 = 
c
 * (
a
 ^ 
b
);

463 
a
 ^ğ
t
;

464 
b
 ^ğ
t
;

465 
	}
}

467 
	g‹m¶©e
 <
şass
 
	gT
>

468 
šlše
 
	$CÚd™iÚ®Sw­Poš‹rs
(
boŞ
 
c
, 
T
 &
a
, T &
b
)

470 
±rdiff_t
 
t
 = 
c
 * (
a
 - 
b
);

471 
a
 -ğ
t
;

472 
b
 +ğ
t
;

473 
	}
}

477 
	g‹m¶©e
 <
şass
 
	gT
>

478 
	$Secu»WeBufãr
(
T
 *
buf
, 
size_t
 
n
)

481 vŞ©
T
 *
p
 = 
buf
+
n
;

482 
n
--)

483 *(--
p
) = 0;

484 
	}
}

486 #ià(
_MSC_VER
 >ğ1400 || 
defšed
(
__GNUC__
)è&& (
CRYPTOPP_BOOL_X64
 || 
CRYPTOPP_BOOL_X86
)

488 
	g‹m¶©e
<> 
šlše
 
	$Secu»WeBufãr
(
by‹
 *
buf
, 
size_t
 
n
)

490 vŞ©
by‹
 *
p
 = 
buf
;

491 #ifdeà
__GNUC__


492 
asm
 vŞ©e("»°¡osb" : "+c"(
n
), "+D"(
p
) : "a"(0) : "memory");

494 
	`__¡osb
((
by‹
 *)(
size_t
)
p
, 0, 
n
);

496 
	}
}

498 
	g‹m¶©e
<> 
šlše
 
	$Secu»WeBufãr
(
wÜd16
 *
buf
, 
size_t
 
n
)

500 vŞ©
wÜd16
 *
p
 = 
buf
;

501 #ifdeà
__GNUC__


502 
asm
 vŞ©e("»°¡osw" : "+c"(
n
), "+D"(
p
) : "a"(0) : "memory");

504 
	`__¡osw
((
wÜd16
 *)(
size_t
)
p
, 0, 
n
);

506 
	}
}

508 
	g‹m¶©e
<> 
šlše
 
	$Secu»WeBufãr
(
wÜd32
 *
buf
, 
size_t
 
n
)

510 vŞ©
wÜd32
 *
p
 = 
buf
;

511 #ifdeà
__GNUC__


512 
asm
 vŞ©e("»°¡o¦" : "+c"(
n
), "+D"(
p
) : "a"(0) : "memory");

514 
	`__¡osd
((*)(
size_t
)
p
, 0, 
n
);

516 
	}
}

518 
	g‹m¶©e
<> 
šlše
 
	$Secu»WeBufãr
(
wÜd64
 *
buf
, 
size_t
 
n
)

520 #ià
CRYPTOPP_BOOL_X64


521 vŞ©
wÜd64
 *
p
 = 
buf
;

522 #ifdeà
__GNUC__


523 
asm
 vŞ©e("»°¡osq" : "+c"(
n
), "+D"(
p
) : "a"(0) : "memory");

525 
	`__¡osq
((
wÜd64
 *)(
size_t
)
p
, 0, 
n
);

528 
	`Secu»WeBufãr
((
wÜd32
 *)
buf
, 2*
n
);

530 
	}
}

534 
	g‹m¶©e
 <
şass
 
	gT
>

535 
šlše
 
	$Secu»WeA¼ay
(
T
 *
buf
, 
size_t
 
n
)

537 ià((
T
è% 8 =ğ0 && 
G‘Alignm’tOf
<T>(è% G‘Alignm’tOf<
wÜd64
>() == 0)

538 
	`Secu»WeBufãr
((
wÜd64
 *)
buf
, 
n
 * ((
T
)/8));

539 ià((
T
è% 4 =ğ0 && 
G‘Alignm’tOf
<T>(è% G‘Alignm’tOf<
wÜd32
>() == 0)

540 
	`Secu»WeBufãr
((
wÜd32
 *)
buf
, 
n
 * ((
T
)/4));

541 ià((
T
è% 2 =ğ0 && 
G‘Alignm’tOf
<T>(è% G‘Alignm’tOf<
wÜd16
>() == 0)

542 
	`Secu»WeBufãr
((
wÜd16
 *)
buf
, 
n
 * ((
T
)/2));

544 
	`Secu»WeBufãr
((
by‹
 *)
buf
, 
n
 * (
T
));

545 
	}
}

548 
	g¡d
::
¡ršg
 
	$SŒšgN¬row
(cÚ¡ 
wch¬_t
 *
¡r
, 
boŞ
 
throwOnE¼Ü
 = 
Œue
)

550 #ifdeà
_MSC_VER


551 #´agm¨
	`w¬nšg
(
push
)

552 #´agm¨
	`w¬nšg
(
di§bË
: 4996)

554 
size_t
 
size
 = 
	`wc¡ombs
(
NULL
, 
¡r
, 0);

555 ià(
size
 =ğ
	`size_t
(0)-1)

557 ià(
throwOnE¼Ü
)

558 
throw
 
	`Inv®idArgum’t
("StringNarrow: wcstombs() call failed");

560  
¡d
::
	`¡ršg
();

562 
¡d
::
¡ršg
 
	`»suÉ
(
size
, 0);

563 
	`wc¡ombs
(&
»suÉ
[0], 
¡r
, 
size
);

564  
»suÉ
;

565 #ifdeà
_MSC_VER


566 #´agm¨
	`w¬nšg
(
pİ
)

568 
	}
}

570 #ià
CRYPTOPP_BOOL_ALIGN16_ENABLED


571 
CRYPTOPP_DLL
 * 
CRYPTOPP_API
 
AligÃdAÎoÿ‹
(
size_t
 
size
);

572 
CRYPTOPP_DLL
 
CRYPTOPP_API
 
AligÃdD—Îoÿ‹
(*
p
);

575 
CRYPTOPP_DLL
 * 
CRYPTOPP_API
 
UÇligÃdAÎoÿ‹
(
size_t
 
size
);

576 
CRYPTOPP_DLL
 
CRYPTOPP_API
 
UÇligÃdD—Îoÿ‹
(*
p
);

580 
	g‹m¶©e
 <
şass
 
	gT
> 
šlše
 
T
 
	$rÙlFixed
(
T
 
x
, 
y
)

582 
	`as£¹
(
y
 < (
T
)*8);

583  
y
 ? 
	`T
((
x
<<yè| (x>>((
T
)*8-y))) : x;

584 
	}
}

586 
	g‹m¶©e
 <
şass
 
	gT
> 
šlše
 
T
 
	$rÙrFixed
(
T
 
x
, 
y
)

588 
	`as£¹
(
y
 < (
T
)*8);

589  
y
 ? 
	`T
((
x
>>yè| (x<<((
T
)*8-y))) : x;

590 
	}
}

592 
	g‹m¶©e
 <
şass
 
	gT
> 
šlše
 
T
 
	$rÙlV¬ŸbË
(
T
 
x
, 
y
)

594 
	`as£¹
(
y
 < (
T
)*8);

595  
	`T
((
x
<<
y
è| (x>>((
T
)*8-y)));

596 
	}
}

598 
	g‹m¶©e
 <
şass
 
	gT
> 
šlše
 
T
 
	$rÙrV¬ŸbË
(
T
 
x
, 
y
)

600 
	`as£¹
(
y
 < (
T
)*8);

601  
	`T
((
x
>>
y
è| (x<<((
T
)*8-y)));

602 
	}
}

604 
	g‹m¶©e
 <
şass
 
	gT
> 
šlše
 
T
 
	$rÙlMod
(
T
 
x
, 
y
)

606 
y
 %ğ(
T
)*8;

607  
	`T
((
x
<<
y
è| (x>>((
T
)*8-y)));

608 
	}
}

610 
	g‹m¶©e
 <
şass
 
	gT
> 
šlše
 
T
 
	$rÙrMod
(
T
 
x
, 
y
)

612 
y
 %ğ(
T
)*8;

613  
	`T
((
x
>>
y
è| (x<<((
T
)*8-y)));

614 
	}
}

616 #ifdeà
_MSC_VER


618 
	g‹m¶©e
<> 
šlše
 
wÜd32
 
	grÙlFixed
<
	gwÜd32
>(wÜd32 
	gx
, 
	gy
)

620 
as£¹
(
y
 < 8*(
x
));

621  
	gy
 ? 
_ÌÙl
(
x
, 
y
) : x;

624 
	g‹m¶©e
<> 
šlše
 
wÜd32
 
	grÙrFixed
<
	gwÜd32
>(wÜd32 
	gx
, 
	gy
)

626 
as£¹
(
y
 < 8*(
x
));

627  
	gy
 ? 
_ÌÙr
(
x
, 
y
) : x;

630 
	g‹m¶©e
<> 
šlše
 
wÜd32
 
	grÙlV¬ŸbË
<
	gwÜd32
>(wÜd32 
	gx
, 
	gy
)

632 
as£¹
(
y
 < 8*(
x
));

633  
_ÌÙl
(
x
, 
y
);

636 
	g‹m¶©e
<> 
šlše
 
wÜd32
 
	grÙrV¬ŸbË
<
	gwÜd32
>(wÜd32 
	gx
, 
	gy
)

638 
as£¹
(
y
 < 8*(
x
));

639  
_ÌÙr
(
x
, 
y
);

642 
	g‹m¶©e
<> 
šlše
 
wÜd32
 
	grÙlMod
<
	gwÜd32
>(wÜd32 
	gx
, 
	gy
)

644  
_ÌÙl
(
x
, 
y
);

647 
	g‹m¶©e
<> 
šlše
 
wÜd32
 
	grÙrMod
<
	gwÜd32
>(wÜd32 
	gx
, 
	gy
)

649  
_ÌÙr
(
x
, 
y
);

654 #ià
_MSC_VER
 >ğ1300 && !
defšed
(
__INTEL_COMPILER
)

657 
	g‹m¶©e
<> 
šlše
 
wÜd64
 
	grÙlFixed
<
	gwÜd64
>(wÜd64 
	gx
, 
	gy
)

659 
as£¹
(
y
 < 8*(
x
));

660  
	gy
 ? 
_rÙl64
(
x
, 
y
) : x;

663 
	g‹m¶©e
<> 
šlše
 
wÜd64
 
	grÙrFixed
<
	gwÜd64
>(wÜd64 
	gx
, 
	gy
)

665 
as£¹
(
y
 < 8*(
x
));

666  
	gy
 ? 
_rÙr64
(
x
, 
y
) : x;

669 
	g‹m¶©e
<> 
šlše
 
wÜd64
 
	grÙlV¬ŸbË
<
	gwÜd64
>(wÜd64 
	gx
, 
	gy
)

671 
as£¹
(
y
 < 8*(
x
));

672  
_rÙl64
(
x
, 
y
);

675 
	g‹m¶©e
<> 
šlše
 
wÜd64
 
	grÙrV¬ŸbË
<
	gwÜd64
>(wÜd64 
	gx
, 
	gy
)

677 
as£¹
(
y
 < 8*(
x
));

678  
_rÙr64
(
x
, 
y
);

681 
	g‹m¶©e
<> 
šlše
 
wÜd64
 
	grÙlMod
<
	gwÜd64
>(wÜd64 
	gx
, 
	gy
)

683  
_rÙl64
(
x
, 
y
);

686 
	g‹m¶©e
<> 
šlše
 
wÜd64
 
	grÙrMod
<
	gwÜd64
>(wÜd64 
	gx
, 
	gy
)

688  
_rÙr64
(
x
, 
y
);

693 #ià
_MSC_VER
 >ğ1400 && !
defšed
(
__INTEL_COMPILER
)

696 
	g‹m¶©e
<> 
šlše
 
wÜd16
 
	grÙlFixed
<
	gwÜd16
>(wÜd16 
	gx
, 
	gy
)

698 
as£¹
(
y
 < 8*(
x
));

699  
	gy
 ? 
_rÙl16
(
x
, 
y
) : x;

702 
	g‹m¶©e
<> 
šlše
 
wÜd16
 
	grÙrFixed
<
	gwÜd16
>(wÜd16 
	gx
, 
	gy
)

704 
as£¹
(
y
 < 8*(
x
));

705  
	gy
 ? 
_rÙr16
(
x
, 
y
) : x;

708 
	g‹m¶©e
<> 
šlše
 
wÜd16
 
	grÙlV¬ŸbË
<
	gwÜd16
>(wÜd16 
	gx
, 
	gy
)

710 
as£¹
(
y
 < 8*(
x
));

711  
_rÙl16
(
x
, 
y
);

714 
	g‹m¶©e
<> 
šlše
 
wÜd16
 
	grÙrV¬ŸbË
<
	gwÜd16
>(wÜd16 
	gx
, 
	gy
)

716 
as£¹
(
y
 < 8*(
x
));

717  
_rÙr16
(
x
, 
y
);

720 
	g‹m¶©e
<> 
šlše
 
wÜd16
 
	grÙlMod
<
	gwÜd16
>(wÜd16 
	gx
, 
	gy
)

722  
_rÙl16
(
x
, 
y
);

725 
	g‹m¶©e
<> 
šlše
 
wÜd16
 
	grÙrMod
<
	gwÜd16
>(wÜd16 
	gx
, 
	gy
)

727  
_rÙr16
(
x
, 
y
);

730 
	g‹m¶©e
<> 
šlše
 
by‹
 
	grÙlFixed
<
	gby‹
>(by‹ 
	gx
, 
	gy
)

732 
as£¹
(
y
 < 8*(
x
));

733  
	gy
 ? 
_rÙl8
(
x
, 
y
) : x;

736 
	g‹m¶©e
<> 
šlše
 
by‹
 
	grÙrFixed
<
	gby‹
>(by‹ 
	gx
, 
	gy
)

738 
as£¹
(
y
 < 8*(
x
));

739  
	gy
 ? 
_rÙr8
(
x
, 
y
) : x;

742 
	g‹m¶©e
<> 
šlše
 
by‹
 
	grÙlV¬ŸbË
<
	gby‹
>(by‹ 
	gx
, 
	gy
)

744 
as£¹
(
y
 < 8*(
x
));

745  
_rÙl8
(
x
, 
y
);

748 
	g‹m¶©e
<> 
šlše
 
by‹
 
	grÙrV¬ŸbË
<
	gby‹
>(by‹ 
	gx
, 
	gy
)

750 
as£¹
(
y
 < 8*(
x
));

751  
_rÙr8
(
x
, 
y
);

754 
	g‹m¶©e
<> 
šlše
 
by‹
 
	grÙlMod
<
	gby‹
>(by‹ 
	gx
, 
	gy
)

756  
_rÙl8
(
x
, 
y
);

759 
	g‹m¶©e
<> 
šlše
 
by‹
 
	grÙrMod
<
	gby‹
>(by‹ 
	gx
, 
	gy
)

761  
_rÙr8
(
x
, 
y
);

766 #ià(
defšed
(
__MWERKS__
è&& 
TARGET_CPU_PPC
)

768 
	g‹m¶©e
<> 
šlše
 
wÜd32
 
	grÙlFixed
<
	gwÜd32
>(wÜd32 
	gx
, 
	gy
)

770 
as£¹
(
y
 < 32);

771  
	gy
 ? 
__¾wšm
(
x
,
y
,0,31) : x;

774 
	g‹m¶©e
<> 
šlše
 
wÜd32
 
	grÙrFixed
<
	gwÜd32
>(wÜd32 
	gx
, 
	gy
)

776 
as£¹
(
y
 < 32);

777  
	gy
 ? 
__¾wšm
(
x
,32-
y
,0,31) : x;

780 
	g‹m¶©e
<> 
šlše
 
wÜd32
 
	grÙlV¬ŸbË
<
	gwÜd32
>(wÜd32 
	gx
, 
	gy
)

782 
as£¹
(
y
 < 32);

783  (
__¾wnm
(
x
,
y
,0,31));

786 
	g‹m¶©e
<> 
šlše
 
wÜd32
 
	grÙrV¬ŸbË
<
	gwÜd32
>(wÜd32 
	gx
, 
	gy
)

788 
as£¹
(
y
 < 32);

789  (
__¾wnm
(
x
,32-
y
,0,31));

792 
	g‹m¶©e
<> 
šlše
 
wÜd32
 
	grÙlMod
<
	gwÜd32
>(wÜd32 
	gx
, 
	gy
)

794  (
__¾wnm
(
x
,
y
,0,31));

797 
	g‹m¶©e
<> 
šlše
 
wÜd32
 
	grÙrMod
<
	gwÜd32
>(wÜd32 
	gx
, 
	gy
)

799  (
__¾wnm
(
x
,32-
y
,0,31));

806 
	g‹m¶©e
 <
şass
 
	gT
>

807 
šlše
 
	$G‘By‹
(
By‹Ord”
 
Üd”
, 
T
 
v®ue
, 
šdex
)

809 ià(
Üd”
 =ğ
LITTLE_ENDIAN_ORDER
)

810  
	`GETBYTE
(
v®ue
, 
šdex
);

812  
	`GETBYTE
(
v®ue
, (
T
)-
šdex
-1);

813 
	}
}

815 
šlše
 
by‹
 
	$By‹Rev”£
(
by‹
 
v®ue
)

817  
v®ue
;

818 
	}
}

820 
šlše
 
wÜd16
 
	$By‹Rev”£
(
wÜd16
 
v®ue
)

822 #ifdeà
CRYPTOPP_BYTESWAP_AVAILABLE


823  
	`bsw­_16
(
v®ue
);

824 #–ià
	`defšed
(
_MSC_VER
) && _MSC_VER >= 1300

825  
	`_by‹sw­_ushÜt
(
v®ue
);

827  
	`rÙlFixed
(
v®ue
, 8U);

829 
	}
}

831 
šlše
 
wÜd32
 
	$By‹Rev”£
(
wÜd32
 
v®ue
)

833 #ià
	`defšed
(
__GNUC__
è&& defšed(
CRYPTOPP_X86_ASM_AVAILABLE
)

834 
	`__asm__
 ("bsw­ %0" : "ô" (
v®ue
) : "0" (value));

835  
v®ue
;

836 #–ià
	`defšed
(
CRYPTOPP_BYTESWAP_AVAILABLE
)

837  
	`bsw­_32
(
v®ue
);

838 #–ià
	`defšed
(
__MWERKS__
è&& 
TARGET_CPU_PPC


839  (
wÜd32
)
	`__lwbrx
(&
v®ue
,0);

840 #–ià
_MSC_VER
 >ğ1400 || (_MSC_VER >ğ1300 && !
	`defšed
(
_DLL
))

841  
	`_by‹sw­_ulÚg
(
v®ue
);

842 #–ià
	`CRYPTOPP_FAST_ROTATE
(32)

844  (
	`rÙrFixed
(
v®ue
, 8Uè& 0xff00ff00è| (
	`rÙlFixed
(value, 8U) & 0x00ff00ff);

847 
v®ue
 = ((value & 0xFF00FF00) >> 8) | ((value & 0x00FF00FF) << 8);

848  
	`rÙlFixed
(
v®ue
, 16U);

850 
	}
}

852 
šlše
 
wÜd64
 
	$By‹Rev”£
(
wÜd64
 
v®ue
)

854 #ià
	`defšed
(
__GNUC__
è&& defšed(
CRYPTOPP_X86_ASM_AVAILABLE
è&& defšed(
__x86_64__
)

855 
	`__asm__
 ("bsw­ %0" : "ô" (
v®ue
) : "0" (value));

856  
v®ue
;

857 #–ià
	`defšed
(
CRYPTOPP_BYTESWAP_AVAILABLE
)

858  
	`bsw­_64
(
v®ue
);

859 #–ià
	`defšed
(
_MSC_VER
) && _MSC_VER >= 1300

860  
	`_by‹sw­_ušt64
(
v®ue
);

861 #–ià
CRYPTOPP_BOOL_SLOW_WORD64


862  (
	`wÜd64
(
	`By‹Rev”£
(
	`wÜd32
(
v®ue
))) << 32) | ByteReverse(word32(value>>32));

864 
v®ue
 = ((v®u& 
	`W64LIT
(0xFF00FF00FF00FF00)) >> 8) | ((value & W64LIT(0x00FF00FF00FF00FF)) << 8);

865 
v®ue
 = ((v®u& 
	`W64LIT
(0xFFFF0000FFFF0000)) >> 16) | ((value & W64LIT(0x0000FFFF0000FFFF)) << 16);

866  
	`rÙlFixed
(
v®ue
, 32U);

868 
	}
}

870 
šlše
 
by‹
 
	$B™Rev”£
(
by‹
 
v®ue
)

872 
v®ue
 = ((value & 0xAA) >> 1) | ((value & 0x55) << 1);

873 
v®ue
 = ((value & 0xCC) >> 2) | ((value & 0x33) << 2);

874  
	`rÙlFixed
(
v®ue
, 4U);

875 
	}
}

877 
šlše
 
wÜd16
 
	$B™Rev”£
(
wÜd16
 
v®ue
)

879 
v®ue
 = ((value & 0xAAAA) >> 1) | ((value & 0x5555) << 1);

880 
v®ue
 = ((value & 0xCCCC) >> 2) | ((value & 0x3333) << 2);

881 
v®ue
 = ((value & 0xF0F0) >> 4) | ((value & 0x0F0F) << 4);

882  
	`By‹Rev”£
(
v®ue
);

883 
	}
}

885 
šlše
 
wÜd32
 
	$B™Rev”£
(
wÜd32
 
v®ue
)

887 
v®ue
 = ((value & 0xAAAAAAAA) >> 1) | ((value & 0x55555555) << 1);

888 
v®ue
 = ((value & 0xCCCCCCCC) >> 2) | ((value & 0x33333333) << 2);

889 
v®ue
 = ((value & 0xF0F0F0F0) >> 4) | ((value & 0x0F0F0F0F) << 4);

890  
	`By‹Rev”£
(
v®ue
);

891 
	}
}

893 
šlše
 
wÜd64
 
	$B™Rev”£
(
wÜd64
 
v®ue
)

895 #ià
CRYPTOPP_BOOL_SLOW_WORD64


896  (
	`wÜd64
(
	`B™Rev”£
(
	`wÜd32
(
v®ue
))) << 32) | BitReverse(word32(value>>32));

898 
v®ue
 = ((v®u& 
	`W64LIT
(0xAAAAAAAAAAAAAAAA)) >> 1) | ((value & W64LIT(0x5555555555555555)) << 1);

899 
v®ue
 = ((v®u& 
	`W64LIT
(0xCCCCCCCCCCCCCCCC)) >> 2) | ((value & W64LIT(0x3333333333333333)) << 2);

900 
v®ue
 = ((v®u& 
	`W64LIT
(0xF0F0F0F0F0F0F0F0)) >> 4) | ((value & W64LIT(0x0F0F0F0F0F0F0F0F)) << 4);

901  
	`By‹Rev”£
(
v®ue
);

903 
	}
}

905 
	g‹m¶©e
 <
şass
 
	gT
>

906 
šlše
 
T
 
	$B™Rev”£
(
T
 
v®ue
)

908 ià((
T
) == 1)

909  (
T
)
	`B™Rev”£
((
by‹
)
v®ue
);

910 ià((
T
) == 2)

911  (
T
)
	`B™Rev”£
((
wÜd16
)
v®ue
);

912 ià((
T
) == 4)

913  (
T
)
	`B™Rev”£
((
wÜd32
)
v®ue
);

916 
	`as£¹
((
T
) == 8);

917  (
T
)
	`B™Rev”£
((
wÜd64
)
v®ue
);

919 
	}
}

921 
	g‹m¶©e
 <
şass
 
	gT
>

922 
šlše
 
T
 
	$CÚd™iÚ®By‹Rev”£
(
By‹Ord”
 
Üd”
, 
T
 
v®ue
)

924  
	`N©iveBy‹Ord”Is
(
Üd”
è? 
v®ue
 : 
	`By‹Rev”£
(value);

925 
	}
}

927 
	g‹m¶©e
 <
şass
 
	gT
>

928 
	$By‹Rev”£
(
T
 *
out
, cÚ¡ T *
š
, 
size_t
 
by‹CouÁ
)

930 
	`as£¹
(
by‹CouÁ
 % (
T
) == 0);

931 
size_t
 
couÁ
 = 
by‹CouÁ
/(
T
);

932 
size_t
 
i
=0; i<
couÁ
; i++)

933 
out
[
i
] = 
	`By‹Rev”£
(
š
[i]);

934 
	}
}

936 
	g‹m¶©e
 <
şass
 
	gT
>

937 
šlše
 
	$CÚd™iÚ®By‹Rev”£
(
By‹Ord”
 
Üd”
, 
T
 *
out
, cÚ¡ T *
š
, 
size_t
 
by‹CouÁ
)

939 ià(!
	`N©iveBy‹Ord”Is
(
Üd”
))

940 
	`By‹Rev”£
(
out
, 
š
, 
by‹CouÁ
);

941 ià(
š
 !ğ
out
)

942 
	`memıy_s
(
out
, 
by‹CouÁ
, 
š
, byteCount);

943 
	}
}

945 
	g‹m¶©e
 <
şass
 
	gT
>

946 
šlše
 
	$G‘U£rKey
(
By‹Ord”
 
Üd”
, 
T
 *
out
, 
size_t
 
ou’
, cÚ¡ 
by‹
 *
š
, size_ˆ
šËn
)

948 cÚ¡ 
size_t
 
U
 = (
T
);

949 
	`as£¹
(
šËn
 <ğ
ou’
*
U
);

950 
	`memıy_s
(
out
, 
ou’
*
U
, 
š
, 
šËn
);

951 
	`mem£t_z
((
by‹
 *)
out
+
šËn
, 0, 
ou’
*
U
-inlen);

952 
	`CÚd™iÚ®By‹Rev”£
(
Üd”
, 
out
, out, 
	`RoundUpToMuÉËOf
(
šËn
, 
U
));

953 
	}
}

955 #iâdeà
CRYPTOPP_ALLOW_UNALIGNED_DATA_ACCESS


956 
šlše
 
by‹
 
	$UÇligÃdG‘WÜdNÚTem¶©e
(
By‹Ord”
 
Üd”
, cÚ¡ 
by‹
 *
block
, const byte *)

958  
block
[0];

959 
	}
}

961 
šlše
 
wÜd16
 
	$UÇligÃdG‘WÜdNÚTem¶©e
(
By‹Ord”
 
Üd”
, cÚ¡ 
by‹
 *
block
, cÚ¡ 
wÜd16
 *)

963  (
Üd”
 =ğ
BIG_ENDIAN_ORDER
)

964 ? 
block
[1] | (block[0] << 8)

965 : 
block
[0] | (block[1] << 8);

966 
	}
}

968 
šlše
 
wÜd32
 
	$UÇligÃdG‘WÜdNÚTem¶©e
(
By‹Ord”
 
Üd”
, cÚ¡ 
by‹
 *
block
, cÚ¡ 
wÜd32
 *)

970  (
Üd”
 =ğ
BIG_ENDIAN_ORDER
)

971 ? 
	`wÜd32
(
block
[3]) | (word32(block[2]) << 8) | (word32(block[1]) << 16) | (word32(block[0]) << 24)

972 : 
	`wÜd32
(
block
[0]) | (word32(block[1]) << 8) | (word32(block[2]) << 16) | (word32(block[3]) << 24);

973 
	}
}

975 
šlše
 
wÜd64
 
	$UÇligÃdG‘WÜdNÚTem¶©e
(
By‹Ord”
 
Üd”
, cÚ¡ 
by‹
 *
block
, cÚ¡ 
wÜd64
 *)

977  (
Üd”
 =ğ
BIG_ENDIAN_ORDER
)

979 (
	`wÜd64
(
block
[7]) |

980 (
	`wÜd64
(
block
[6]) << 8) |

981 (
	`wÜd64
(
block
[5]) << 16) |

982 (
	`wÜd64
(
block
[4]) << 24) |

983 (
	`wÜd64
(
block
[3]) << 32) |

984 (
	`wÜd64
(
block
[2]) << 40) |

985 (
	`wÜd64
(
block
[1]) << 48) |

986 (
	`wÜd64
(
block
[0]) << 56))

988 (
	`wÜd64
(
block
[0]) |

989 (
	`wÜd64
(
block
[1]) << 8) |

990 (
	`wÜd64
(
block
[2]) << 16) |

991 (
	`wÜd64
(
block
[3]) << 24) |

992 (
	`wÜd64
(
block
[4]) << 32) |

993 (
	`wÜd64
(
block
[5]) << 40) |

994 (
	`wÜd64
(
block
[6]) << 48) |

995 (
	`wÜd64
(
block
[7]) << 56));

996 
	}
}

998 
šlše
 
	$UÇligÃdPutWÜdNÚTem¶©e
(
By‹Ord”
 
Üd”
, 
by‹
 *
block
, by‹ 
v®ue
, cÚ¡ by‹ *
xÜBlock
)

1000 
block
[0] = 
xÜBlock
 ? (
v®ue
 ^ xorBlock[0]) : value;

1001 
	}
}

1003 
šlše
 
	$UÇligÃdPutWÜdNÚTem¶©e
(
By‹Ord”
 
Üd”
, 
by‹
 *
block
, 
wÜd16
 
v®ue
, cÚ¡ by‹ *
xÜBlock
)

1005 ià(
Üd”
 =ğ
BIG_ENDIAN_ORDER
)

1007 ià(
xÜBlock
)

1009 
block
[0] = 
xÜBlock
[0] ^ 
	`CRYPTOPP_GET_BYTE_AS_BYTE
(
v®ue
, 1);

1010 
block
[1] = 
xÜBlock
[1] ^ 
	`CRYPTOPP_GET_BYTE_AS_BYTE
(
v®ue
, 0);

1014 
block
[0] = 
	`CRYPTOPP_GET_BYTE_AS_BYTE
(
v®ue
, 1);

1015 
block
[1] = 
	`CRYPTOPP_GET_BYTE_AS_BYTE
(
v®ue
, 0);

1020 ià(
xÜBlock
)

1022 
block
[0] = 
xÜBlock
[0] ^ 
	`CRYPTOPP_GET_BYTE_AS_BYTE
(
v®ue
, 0);

1023 
block
[1] = 
xÜBlock
[1] ^ 
	`CRYPTOPP_GET_BYTE_AS_BYTE
(
v®ue
, 1);

1027 
block
[0] = 
	`CRYPTOPP_GET_BYTE_AS_BYTE
(
v®ue
, 0);

1028 
block
[1] = 
	`CRYPTOPP_GET_BYTE_AS_BYTE
(
v®ue
, 1);

1031 
	}
}

1033 
šlše
 
	$UÇligÃdPutWÜdNÚTem¶©e
(
By‹Ord”
 
Üd”
, 
by‹
 *
block
, 
wÜd32
 
v®ue
, cÚ¡ by‹ *
xÜBlock
)

1035 ià(
Üd”
 =ğ
BIG_ENDIAN_ORDER
)

1037 ià(
xÜBlock
)

1039 
block
[0] = 
xÜBlock
[0] ^ 
	`CRYPTOPP_GET_BYTE_AS_BYTE
(
v®ue
, 3);

1040 
block
[1] = 
xÜBlock
[1] ^ 
	`CRYPTOPP_GET_BYTE_AS_BYTE
(
v®ue
, 2);

1041 
block
[2] = 
xÜBlock
[2] ^ 
	`CRYPTOPP_GET_BYTE_AS_BYTE
(
v®ue
, 1);

1042 
block
[3] = 
xÜBlock
[3] ^ 
	`CRYPTOPP_GET_BYTE_AS_BYTE
(
v®ue
, 0);

1046 
block
[0] = 
	`CRYPTOPP_GET_BYTE_AS_BYTE
(
v®ue
, 3);

1047 
block
[1] = 
	`CRYPTOPP_GET_BYTE_AS_BYTE
(
v®ue
, 2);

1048 
block
[2] = 
	`CRYPTOPP_GET_BYTE_AS_BYTE
(
v®ue
, 1);

1049 
block
[3] = 
	`CRYPTOPP_GET_BYTE_AS_BYTE
(
v®ue
, 0);

1054 ià(
xÜBlock
)

1056 
block
[0] = 
xÜBlock
[0] ^ 
	`CRYPTOPP_GET_BYTE_AS_BYTE
(
v®ue
, 0);

1057 
block
[1] = 
xÜBlock
[1] ^ 
	`CRYPTOPP_GET_BYTE_AS_BYTE
(
v®ue
, 1);

1058 
block
[2] = 
xÜBlock
[2] ^ 
	`CRYPTOPP_GET_BYTE_AS_BYTE
(
v®ue
, 2);

1059 
block
[3] = 
xÜBlock
[3] ^ 
	`CRYPTOPP_GET_BYTE_AS_BYTE
(
v®ue
, 3);

1063 
block
[0] = 
	`CRYPTOPP_GET_BYTE_AS_BYTE
(
v®ue
, 0);

1064 
block
[1] = 
	`CRYPTOPP_GET_BYTE_AS_BYTE
(
v®ue
, 1);

1065 
block
[2] = 
	`CRYPTOPP_GET_BYTE_AS_BYTE
(
v®ue
, 2);

1066 
block
[3] = 
	`CRYPTOPP_GET_BYTE_AS_BYTE
(
v®ue
, 3);

1069 
	}
}

1071 
šlše
 
	$UÇligÃdPutWÜdNÚTem¶©e
(
By‹Ord”
 
Üd”
, 
by‹
 *
block
, 
wÜd64
 
v®ue
, cÚ¡ by‹ *
xÜBlock
)

1073 ià(
Üd”
 =ğ
BIG_ENDIAN_ORDER
)

1075 ià(
xÜBlock
)

1077 
block
[0] = 
xÜBlock
[0] ^ 
	`CRYPTOPP_GET_BYTE_AS_BYTE
(
v®ue
, 7);

1078 
block
[1] = 
xÜBlock
[1] ^ 
	`CRYPTOPP_GET_BYTE_AS_BYTE
(
v®ue
, 6);

1079 
block
[2] = 
xÜBlock
[2] ^ 
	`CRYPTOPP_GET_BYTE_AS_BYTE
(
v®ue
, 5);

1080 
block
[3] = 
xÜBlock
[3] ^ 
	`CRYPTOPP_GET_BYTE_AS_BYTE
(
v®ue
, 4);

1081 
block
[4] = 
xÜBlock
[4] ^ 
	`CRYPTOPP_GET_BYTE_AS_BYTE
(
v®ue
, 3);

1082 
block
[5] = 
xÜBlock
[5] ^ 
	`CRYPTOPP_GET_BYTE_AS_BYTE
(
v®ue
, 2);

1083 
block
[6] = 
xÜBlock
[6] ^ 
	`CRYPTOPP_GET_BYTE_AS_BYTE
(
v®ue
, 1);

1084 
block
[7] = 
xÜBlock
[7] ^ 
	`CRYPTOPP_GET_BYTE_AS_BYTE
(
v®ue
, 0);

1088 
block
[0] = 
	`CRYPTOPP_GET_BYTE_AS_BYTE
(
v®ue
, 7);

1089 
block
[1] = 
	`CRYPTOPP_GET_BYTE_AS_BYTE
(
v®ue
, 6);

1090 
block
[2] = 
	`CRYPTOPP_GET_BYTE_AS_BYTE
(
v®ue
, 5);

1091 
block
[3] = 
	`CRYPTOPP_GET_BYTE_AS_BYTE
(
v®ue
, 4);

1092 
block
[4] = 
	`CRYPTOPP_GET_BYTE_AS_BYTE
(
v®ue
, 3);

1093 
block
[5] = 
	`CRYPTOPP_GET_BYTE_AS_BYTE
(
v®ue
, 2);

1094 
block
[6] = 
	`CRYPTOPP_GET_BYTE_AS_BYTE
(
v®ue
, 1);

1095 
block
[7] = 
	`CRYPTOPP_GET_BYTE_AS_BYTE
(
v®ue
, 0);

1100 ià(
xÜBlock
)

1102 
block
[0] = 
xÜBlock
[0] ^ 
	`CRYPTOPP_GET_BYTE_AS_BYTE
(
v®ue
, 0);

1103 
block
[1] = 
xÜBlock
[1] ^ 
	`CRYPTOPP_GET_BYTE_AS_BYTE
(
v®ue
, 1);

1104 
block
[2] = 
xÜBlock
[2] ^ 
	`CRYPTOPP_GET_BYTE_AS_BYTE
(
v®ue
, 2);

1105 
block
[3] = 
xÜBlock
[3] ^ 
	`CRYPTOPP_GET_BYTE_AS_BYTE
(
v®ue
, 3);

1106 
block
[4] = 
xÜBlock
[4] ^ 
	`CRYPTOPP_GET_BYTE_AS_BYTE
(
v®ue
, 4);

1107 
block
[5] = 
xÜBlock
[5] ^ 
	`CRYPTOPP_GET_BYTE_AS_BYTE
(
v®ue
, 5);

1108 
block
[6] = 
xÜBlock
[6] ^ 
	`CRYPTOPP_GET_BYTE_AS_BYTE
(
v®ue
, 6);

1109 
block
[7] = 
xÜBlock
[7] ^ 
	`CRYPTOPP_GET_BYTE_AS_BYTE
(
v®ue
, 7);

1113 
block
[0] = 
	`CRYPTOPP_GET_BYTE_AS_BYTE
(
v®ue
, 0);

1114 
block
[1] = 
	`CRYPTOPP_GET_BYTE_AS_BYTE
(
v®ue
, 1);

1115 
block
[2] = 
	`CRYPTOPP_GET_BYTE_AS_BYTE
(
v®ue
, 2);

1116 
block
[3] = 
	`CRYPTOPP_GET_BYTE_AS_BYTE
(
v®ue
, 3);

1117 
block
[4] = 
	`CRYPTOPP_GET_BYTE_AS_BYTE
(
v®ue
, 4);

1118 
block
[5] = 
	`CRYPTOPP_GET_BYTE_AS_BYTE
(
v®ue
, 5);

1119 
block
[6] = 
	`CRYPTOPP_GET_BYTE_AS_BYTE
(
v®ue
, 6);

1120 
block
[7] = 
	`CRYPTOPP_GET_BYTE_AS_BYTE
(
v®ue
, 7);

1123 
	}
}

1126 
	g‹m¶©e
 <
şass
 
	gT
>

1127 
šlše
 
T
 
	$G‘WÜd
(
boŞ
 
assumeAligÃd
, 
By‹Ord”
 
Üd”
, cÚ¡ 
by‹
 *
block
)

1129 #iâdeà
CRYPTOPP_ALLOW_UNALIGNED_DATA_ACCESS


1130 ià(!
assumeAligÃd
)

1131  
	`UÇligÃdG‘WÜdNÚTem¶©e
(
Üd”
, 
block
, (
T
*)
NULL
);

1132 
	`as£¹
(
IsAligÃd
<
T
>(
block
));

1134  
	`CÚd™iÚ®By‹Rev”£
(
Üd”
, *
»š‹½»t_ÿ¡
<cÚ¡ 
T
 *>(
block
));

1135 
	}
}

1137 
	g‹m¶©e
 <
şass
 
	gT
>

1138 
šlše
 
	$G‘WÜd
(
boŞ
 
assumeAligÃd
, 
By‹Ord”
 
Üd”
, 
T
 &
»suÉ
, cÚ¡ 
by‹
 *
block
)

1140 
»suÉ
 = 
G‘WÜd
<
T
>(
assumeAligÃd
, 
Üd”
, 
block
);

1141 
	}
}

1143 
	g‹m¶©e
 <
şass
 
	gT
>

1144 
šlše
 
	$PutWÜd
(
boŞ
 
assumeAligÃd
, 
By‹Ord”
 
Üd”
, 
by‹
 *
block
, 
T
 
v®ue
, cÚ¡ by‹ *
xÜBlock
 = 
NULL
)

1146 #iâdeà
CRYPTOPP_ALLOW_UNALIGNED_DATA_ACCESS


1147 ià(!
assumeAligÃd
)

1148  
	`UÇligÃdPutWÜdNÚTem¶©e
(
Üd”
, 
block
, 
v®ue
, 
xÜBlock
);

1149 
	`as£¹
(
IsAligÃd
<
T
>(
block
));

1150 
	`as£¹
(
IsAligÃd
<
T
>(
xÜBlock
));

1152 *
»š‹½»t_ÿ¡
<
T
 *>(
block
èğ
	`CÚd™iÚ®By‹Rev”£
(
Üd”
, 
v®ue
è^ (
xÜBlock
 ? *reinterpret_cast<const T *>(xorBlock) : 0);

1153 
	}
}

1155 
	g‹m¶©e
 <
şass
 
	gT
, cÏs 
	gB
, 
boŞ
 
	gA
=
çl£
>

1156 şas 
	cG‘Block


1158 
public
:

1159 
	$G‘Block
(cÚ¡ *
block
)

1160 : 
	`m_block
((cÚ¡ 
by‹
 *)
block
) {}

1162 
‹m¶©e
 <
şass
 
U
>

1163 
šlše
 
G‘Block
<
T
, 
B
, 
A
> & 
	$İ”©Ü
()(
U
 &
x
)

1165 
	`CRYPTOPP_COMPILE_ASSERT
((
U
è>ğ(
T
));

1166 
x
 = 
G‘WÜd
<
T
>(
A
, 
B
::
	`ToEnum
(), 
m_block
);

1167 
m_block
 +ğ(
T
);

1168  *
this
;

1169 
	}
}

1171 
	g´iv©e
:

1172 cÚ¡ 
by‹
 *
m_block
;

1175 
	g‹m¶©e
 <
şass
 
	gT
, cÏs 
	gB
, 
boŞ
 
	gA
=
çl£
>

1176 şas 
	cPutBlock


1178 
public
:

1179 
	$PutBlock
(cÚ¡ *
xÜBlock
, *
block
)

1180 : 
	`m_xÜBlock
((cÚ¡ 
by‹
 *)
xÜBlock
), 
	`m_block
((by‹ *)
block
) {}

1182 
‹m¶©e
 <
şass
 
U
>

1183 
šlše
 
PutBlock
<
T
, 
B
, 
A
> & 
	$İ”©Ü
()(
U
 
x
)

1185 
	`PutWÜd
(
A
, 
B
::
	`ToEnum
(), 
m_block
, (
T
)
x
, 
m_xÜBlock
);

1186 
m_block
 +ğ(
T
);

1187 ià(
m_xÜBlock
)

1188 
m_xÜBlock
 +ğ(
T
);

1189  *
this
;

1190 
	}
}

1192 
	g´iv©e
:

1193 cÚ¡ 
by‹
 *
m_xÜBlock
;

1194 
by‹
 *
	gm_block
;

1197 
	g‹m¶©e
 <
şass
 
	gT
, cÏs 
	gB
, 
boŞ
 
	gGA
=
çl£
, boŞ 
	gPA
=false>

1198 
	sBlockG‘AndPut


1201 
šlše
 
G‘Block
<
T
, 
B
, 
GA
> 
G‘
(cÚ¡ *
block
) { GetBlock<T, B, GA>(block);}

1202 
	mPutBlock
<
	tT
, 
	tB
, 
	tPA
> 
	tPut
;

1205 
	g‹m¶©e
 <
şass
 
	gT
>

1206 
	g¡d
::
¡ršg
 
	$WÜdToSŒšg
(
T
 
v®ue
, 
By‹Ord”
 
Üd”
 = 
BIG_ENDIAN_ORDER
)

1208 ià(!
	`N©iveBy‹Ord”Is
(
Üd”
))

1209 
v®ue
 = 
	`By‹Rev”£
(value);

1211  
¡d
::
	`¡ršg
((*)&
v®ue
, (value));

1212 
	}
}

1214 
	g‹m¶©e
 <
şass
 
	gT
>

1215 
T
 
	$SŒšgToWÜd
(cÚ¡ 
¡d
::
¡ršg
 &
¡r
, 
By‹Ord”
 
Üd”
 = 
BIG_ENDIAN_ORDER
)

1217 
T
 
v®ue
 = 0;

1218 
	`memıy_s
(&
v®ue
, (v®ue), 
¡r
.
	`d©a
(), 
	`UnsigÃdMš
(¡r.
	`size
(), (value)));

1219  
	`N©iveBy‹Ord”Is
(
Üd”
è? 
v®ue
 : 
	`By‹Rev”£
(value);

1220 
	}
}

1224 
	g‹m¶©e
 <
boŞ
 
	gov”æow
> 
	gSaãShiá”
;

1226 
	g‹m¶©e
<> 
	gSaãShiá”
<
	gŒue
>

1228 
	g‹m¶©e
 <
şass
 
	gT
>

1229 
šlše
 
T
 
RightShiá
(T 
v®ue
, 
b™s
)

1234 
	g‹m¶©e
 <
şass
 
	gT
>

1235 
šlše
 
T
 
LeáShiá
(T 
v®ue
, 
b™s
)

1241 
	g‹m¶©e
<> 
	gSaãShiá”
<
	gçl£
>

1243 
	g‹m¶©e
 <
şass
 
	gT
>

1244 
šlše
 
T
 
RightShiá
(T 
v®ue
, 
b™s
)

1246  
	gv®ue
 >> 
	gb™s
;

1249 
	g‹m¶©e
 <
şass
 
	gT
>

1250 
šlše
 
T
 
LeáShiá
(T 
v®ue
, 
b™s
)

1252  
	gv®ue
 << 
	gb™s
;

1256 
	g‹m¶©e
 <
	gb™s
, 
şass
 
	gT
>

1257 
šlše
 
T
 
	$SaãRightShiá
(
T
 
v®ue
)

1259  
SaãShiá”
<(
b™s
>=(8*(
T
)))>::
	`RightShiá
(
v®ue
, bits);

1260 
	}
}

1262 
	g‹m¶©e
 <
	gb™s
, 
şass
 
	gT
>

1263 
šlše
 
T
 
	$SaãLeáShiá
(
T
 
v®ue
)

1265  
SaãShiá”
<(
b™s
>=(8*(
T
)))>::
	`LeáShiá
(
v®ue
, bits);

1266 
	}
}

1270 
	#CRYPTOPP_BLOCK_1
(
n
, 
t
, 
s
èt* 
m_
##
	`n
(è{ (ˆ*)(
m_agg»g©e
+0);} 
size_t
 
	`SS1
(è{ Ñ)*(s);} size_ˆm_##n##
	`Size
(è{ (s);}

	)

1271 
	#CRYPTOPP_BLOCK_2
(
n
, 
t
, 
s
èt* 
m_
##
	`n
(è{ (ˆ*)(
m_agg»g©e
+
	`SS1
());} 
size_t
 
	`SS2
(è{ SS1()+Ñ)*(s);} size_ˆm_##n##
	`Size
(è{ (s);}

	)

1272 
	#CRYPTOPP_BLOCK_3
(
n
, 
t
, 
s
èt* 
m_
##
	`n
(è{ (ˆ*)(
m_agg»g©e
+
	`SS2
());} 
size_t
 
	`SS3
(è{ SS2()+Ñ)*(s);} size_ˆm_##n##
	`Size
(è{ (s);}

	)

1273 
	#CRYPTOPP_BLOCK_4
(
n
, 
t
, 
s
èt* 
m_
##
	`n
(è{ (ˆ*)(
m_agg»g©e
+
	`SS3
());} 
size_t
 
	`SS4
(è{ SS3()+Ñ)*(s);} size_ˆm_##n##
	`Size
(è{ (s);}

	)

1274 
	#CRYPTOPP_BLOCK_5
(
n
, 
t
, 
s
èt* 
m_
##
	`n
(è{ (ˆ*)(
m_agg»g©e
+
	`SS4
());} 
size_t
 
	`SS5
(è{ SS4()+Ñ)*(s);} size_ˆm_##n##
	`Size
(è{ (s);}

	)

1275 
	#CRYPTOPP_BLOCK_6
(
n
, 
t
, 
s
èt* 
m_
##
	`n
(è{ (ˆ*)(
m_agg»g©e
+
	`SS5
());} 
size_t
 
	`SS6
(è{ SS5()+Ñ)*(s);} size_ˆm_##n##
	`Size
(è{ (s);}

	)

1276 
	#CRYPTOPP_BLOCK_7
(
n
, 
t
, 
s
èt* 
m_
##
	`n
(è{ (ˆ*)(
m_agg»g©e
+
	`SS6
());} 
size_t
 
	`SS7
(è{ SS6()+Ñ)*(s);} size_ˆm_##n##
	`Size
(è{ (s);}

	)

1277 
	#CRYPTOPP_BLOCK_8
(
n
, 
t
, 
s
èt* 
m_
##
	`n
(è{ (ˆ*)(
m_agg»g©e
+
	`SS7
());} 
size_t
 
	`SS8
(è{ SS7()+Ñ)*(s);} size_ˆm_##n##
	`Size
(è{ (s);}

	)

1278 
	#CRYPTOPP_BLOCKS_END
(
i
è
size_t
 
	`SST
(è{ 
SS
##
	`i
();} 
	`AÎoÿ‹Blocks
(è{
m_agg»g©e
.
	`New
(SST());} 
AligÃdSecBy‹Block
 m_agg»g©e;

	)

1280 
	gNAMESPACE_END


	@modarith.h

1 #iâdeà
CRYPTOPP_MODARITH_H


2 
	#CRYPTOPP_MODARITH_H


	)

6 
	~"üy±lib.h
"

7 
	~"misc.h
"

8 
	~"š‹g”.h
"

9 
	~"®geb¿.h
"

11 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

13 
CRYPTOPP_DLL_TEMPLATE_CLASS
 
Ab¡¿ùGroup
<
IÁeg”
>;

14 
CRYPTOPP_DLL_TEMPLATE_CLASS
 
Ab¡¿ùRšg
<
IÁeg”
>;

15 
CRYPTOPP_DLL_TEMPLATE_CLASS
 
Ab¡¿ùEuşid—nDomaš
<
IÁeg”
>;

19 
şass
 
CRYPTOPP_DLL
 
ModuÏrAr™hm‘ic
 : 
public
 
Ab¡¿ùRšg
<
IÁeg”
>

21 
public
:

23 
	tRªdomiz©iÚP¬am‘”
;

24 
IÁeg”
 
	tEËm’t
;

26 
	`ModuÏrAr™hm‘ic
(cÚ¡ 
IÁeg”
 &
modulus
 = IÁeg”::
	`OÃ
())

27 : 
	`m_modulus
(
modulus
), 
	`m_»suÉ
((
wÜd
)0, modulus.
»g
.
	`size
()) {}

29 
	`ModuÏrAr™hm‘ic
(cÚ¡ 
ModuÏrAr™hm‘ic
 &
ma
)

30 : 
	`m_modulus
(
ma
.
m_modulus
), 
	`m_»suÉ
((
wÜd
)0, m_modulus.
»g
.
	`size
()) {}

32 
	`ModuÏrAr™hm‘ic
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
);

34 
vœtu®
 
ModuÏrAr™hm‘ic
 * 
	`ClÚe
(ècÚ¡ { 
Ãw
 
	`ModuÏrAr™hm‘ic
(*
this
);}

36 
	`DEREncode
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
) const;

38 
	`DEREncodeEËm’t
(
Bufã»dT¿nsfÜm©iÚ
 &
out
, cÚ¡ 
EËm’t
 &
a
) const;

39 
	`BERDecodeEËm’t
(
Bufã»dT¿nsfÜm©iÚ
 &
š
, 
EËm’t
 &
a
) const;

41 cÚ¡ 
IÁeg”
& 
	`G‘Modulus
(ècÚ¡ { 
m_modulus
;}

42 
	`S‘Modulus
(cÚ¡ 
IÁeg”
 &
ÃwModulus
è{
m_modulus
 =‚ewModulus; 
m_»suÉ
.
»g
.
	`»size
(m_modulus.»g.
	`size
());}

44 
vœtu®
 
boŞ
 
	`IsMÚtgom”yR•»£Á©iÚ
(ècÚ¡ { 
çl£
;}

46 
vœtu®
 
IÁeg”
 
	`CÚv”tIn
(cÚ¡ IÁeg” &
a
) const

47 { 
a
%
m_modulus
;}

49 
vœtu®
 
IÁeg”
 
	`CÚv”tOut
(cÚ¡ IÁeg” &
a
) const

50 { 
a
;}

52 cÚ¡ 
IÁeg”
& 
	`H®f
(cÚ¡ IÁeg” &
a
) const;

54 
boŞ
 
	`Equ®
(cÚ¡ 
IÁeg”
 &
a
, cÚ¡ IÁeg” &
b
) const

55 { 
a
==
b
;}

57 cÚ¡ 
IÁeg”
& 
	`Id’t™y
() const

58 { 
IÁeg”
::
	`Z”o
();}

60 cÚ¡ 
IÁeg”
& 
	`Add
(cÚ¡ IÁeg” &
a
, cÚ¡ IÁeg” &
b
) const;

62 
IÁeg”
& 
	`AccumuÏ‹
(IÁeg” &
a
, cÚ¡ IÁeg” &
b
) const;

64 cÚ¡ 
IÁeg”
& 
	`Inv”£
(cÚ¡ IÁeg” &
a
) const;

66 cÚ¡ 
IÁeg”
& 
	`SubŒaù
(cÚ¡ IÁeg” &
a
, cÚ¡ IÁeg” &
b
) const;

68 
IÁeg”
& 
	`Reduû
(IÁeg” &
a
, cÚ¡ IÁeg” &
b
) const;

70 cÚ¡ 
IÁeg”
& 
	`DoubË
(cÚ¡ IÁeg” &
a
) const

71 { 
	`Add
(
a
,‡);}

73 cÚ¡ 
IÁeg”
& 
	`MuÉliÿtiveId’t™y
() const

74 { 
IÁeg”
::
	`OÃ
();}

76 cÚ¡ 
IÁeg”
& 
	`MuÉly
(cÚ¡ IÁeg” &
a
, cÚ¡ IÁeg” &
b
) const

77 { 
m_»suÉ1
 = 
a
*
b
%
m_modulus
;}

79 cÚ¡ 
IÁeg”
& 
	`Squ¬e
(cÚ¡ IÁeg” &
a
) const

80 { 
m_»suÉ1
 = 
a
.
	`Squ¬ed
()%
m_modulus
;}

82 
boŞ
 
	`IsUn™
(cÚ¡ 
IÁeg”
 &
a
) const

83 { 
IÁeg”
::
	`Gcd
(
a
, 
m_modulus
).
	`IsUn™
();}

85 cÚ¡ 
IÁeg”
& 
	`MuÉliÿtiveInv”£
(cÚ¡ IÁeg” &
a
) const

86 { 
m_»suÉ1
 = 
a
.
	`Inv”£Mod
(
m_modulus
);}

88 cÚ¡ 
IÁeg”
& 
	`Divide
(cÚ¡ IÁeg” &
a
, cÚ¡ IÁeg” &
b
) const

89 { 
	`MuÉly
(
a
, 
	`MuÉliÿtiveInv”£
(
b
));}

91 
IÁeg”
 
	`CasÿdeExpÚ’tŸ‹
(cÚ¡ IÁeg” &
x
, cÚ¡ IÁeg” &
e1
, cÚ¡ IÁeg” &
y
, cÚ¡ IÁeg” &
e2
) const;

93 
	`SimuÉªeousExpÚ’tŸ‹
(
EËm’t
 *
»suÉs
, cÚ¡ EËm’ˆ&
ba£
, cÚ¡ 
IÁeg”
 *
expÚ’ts
, 
expÚ’tsCouÁ
) const;

95 
	`MaxEËm’tB™L’gth
() const

96 { (
m_modulus
-1).
	`B™CouÁ
();}

98 
	`MaxEËm’tBy‹L’gth
() const

99 { (
m_modulus
-1).
	`By‹CouÁ
();}

101 
EËm’t
 
	`RªdomEËm’t
Ğ
RªdomNumb”G’”©Ü
 &
ºg
 , cÚ¡ 
Rªdomiz©iÚP¬am‘”
 &
ignÜe_fÜ_now
 = 0 ) const

104  
	`EËm’t
Ğ
ºg
 , 
	`IÁeg”
Ğ(è0è, 
m_modulus
 - Integer( () 1 ) ) ;

107 
boŞ
 
İ”©Ü
==(cÚ¡ 
ModuÏrAr™hm‘ic
 &
rhs
) const

108 { 
m_modulus
 =ğ
rhs
.m_modulus;}

110 cÚ¡ 
Rªdomiz©iÚP¬am‘”
 
DeçuÉRªdomiz©iÚP¬am‘”
 ;

112 
´Ùeùed
:

113 
IÁeg”
 
m_modulus
;

114 
mubË
 
IÁeg”
 
m_»suÉ
, 
m_»suÉ1
;

116 
	}
};

122 şas 
	cCRYPTOPP_DLL
 
	mMÚtgom”yR•»£Á©iÚ
 : 
public
 
ModuÏrAr™hm‘ic


124 
public
:

125 
MÚtgom”yR•»£Á©iÚ
(cÚ¡ 
IÁeg”
 &
modulus
);

127 
vœtu®
 
ModuÏrAr™hm‘ic
 * 
	$ClÚe
(ècÚ¡ { 
Ãw
 
	`MÚtgom”yR•»£Á©iÚ
(*
this
);}

129 
boŞ
 
	$IsMÚtgom”yR•»£Á©iÚ
(ècÚ¡ { 
Œue
;
	}
}

131 
IÁeg”
 
	$CÚv”tIn
(cÚ¡ 
IÁeg”
 &
a
) const

132 { (
a
<<(
WORD_BITS
*
m_modulus
.
»g
.
	`size
()))%m_modulus;
	}
}

134 
IÁeg”
 
	$CÚv”tOut
(cÚ¡ 
IÁeg”
 &
a
) const;

136 cÚ¡ 
IÁeg”
& 
	$MuÉliÿtiveId’t™y
() const

137 { 
m_»suÉ1
 = 
IÁeg”
::
	`Pow”2
(
WORD_BITS
*
m_modulus
.
»g
.
	`size
())%m_modulus;
	}
}

139 cÚ¡ 
	gIÁeg”
& 
	$MuÉly
(cÚ¡ 
IÁeg”
 &
a
, cÚ¡ IÁeg” &
b
) const;

141 cÚ¡ 
IÁeg”
& 
	$Squ¬e
(cÚ¡ 
IÁeg”
 &
a
) const;

143 cÚ¡ 
IÁeg”
& 
	$MuÉliÿtiveInv”£
(cÚ¡ 
IÁeg”
 &
a
) const;

145 
IÁeg”
 
	$CasÿdeExpÚ’tŸ‹
(cÚ¡ 
IÁeg”
 &
x
, cÚ¡ IÁeg” &
e1
, cÚ¡ IÁeg” &
y
, cÚ¡ IÁeg” &
e2
) const

146 { 
Ab¡¿ùRšg
<
IÁeg”
>::
	`CasÿdeExpÚ’tŸ‹
(
x
, 
e1
, 
y
, 
e2
);
	}
}

148 
	$SimuÉªeousExpÚ’tŸ‹
(
EËm’t
 *
»suÉs
, cÚ¡ EËm’ˆ&
ba£
, cÚ¡ 
IÁeg”
 *
expÚ’ts
, 
expÚ’tsCouÁ
) const

149 {
Ab¡¿ùRšg
<
IÁeg”
>::
	`SimuÉªeousExpÚ’tŸ‹
(
»suÉs
, 
ba£
, 
expÚ’ts
, 
expÚ’tsCouÁ
);
	}
}

151 
	g´iv©e
:

152 
IÁeg”
 
m_u
;

153 
mubË
 
IÁeg”SecBlock
 
	gm_wÜk¥aû
;

156 
	gNAMESPACE_END


	@modes.cpp

3 
	~"pch.h
"

5 #iâdeà
CRYPTOPP_IMPORTS


7 
	~"modes.h
"

9 #iâdeà
NDEBUG


10 
	~"des.h
"

13 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

15 #iâdeà
NDEBUG


16 
	$Modes_Te¡In¡ªtŸtiÚs
()

18 
CFB_Mode
<
DES
>::
Enüy±iÚ
 
m0
;

19 
CFB_Mode
<
DES
>::
Deüy±iÚ
 
m1
;

20 
OFB_Mode
<
DES
>::
Enüy±iÚ
 
m2
;

21 
CTR_Mode
<
DES
>::
Enüy±iÚ
 
m3
;

22 
ECB_Mode
<
DES
>::
Enüy±iÚ
 
m4
;

23 
CBC_Mode
<
DES
>::
Enüy±iÚ
 
m5
;

24 
	}
}

27 
	gCFB_ModePŞicy
::
	$I‹¿‹
(
by‹
 *
ouut
, cÚ¡ by‹ *
šput
, 
Ch”Dœ
 
dœ
, 
size_t
 
™”©iÚCouÁ
)

29 
	`as£¹
(
m_ch”
->
	`IsFÜw¬dT¿nsfÜm©iÚ
());

30 
	`as£¹
(
m_ãedbackSize
 =ğ
	`BlockSize
());

32 
s
 = 
	`BlockSize
();

33 ià(
dœ
 =ğ
ENCRYPTION
)

35 
m_ch”
->
	`ProûssAndXÜBlock
(
m_»gi¡”
, 
šput
, 
ouut
);

36 
m_ch”
->
	`AdvªûdProûssBlocks
(
ouut
, 
šput
+
s
, ouut+s, (
™”©iÚCouÁ
-1)*s, 0);

37 
	`memıy
(
m_»gi¡”
, 
ouut
+(
™”©iÚCouÁ
-1)*
s
, s);

41 
	`memıy
(
m_‹mp
, 
šput
+(
™”©iÚCouÁ
-1)*
s
, s);

42 
m_ch”
->
	`AdvªûdProûssBlocks
(
šput
, iÅut+
s
, 
ouut
+s, (
™”©iÚCouÁ
-1)*s, 
BlockT¿nsfÜm©iÚ
::
BT_Rev”£DœeùiÚ
);

43 
m_ch”
->
	`ProûssAndXÜBlock
(
m_»gi¡”
, 
šput
, 
ouut
);

44 
	`memıy
(
m_»gi¡”
, 
m_‹mp
, 
s
);

46 
	}
}

48 
	gCFB_ModePŞicy
::
	$T¿nsfÜmRegi¡”
()

50 
	`as£¹
(
m_ch”
->
	`IsFÜw¬dT¿nsfÜm©iÚ
());

51 
m_ch”
->
	`ProûssBlock
(
m_»gi¡”
, 
m_‹mp
);

52 
upd©eSize
 = 
	`BlockSize
()-
m_ãedbackSize
;

53 
	`memmove_s
(
m_»gi¡”
, m_»gi¡”.
	`size
(), m_»gi¡”+
m_ãedbackSize
, 
upd©eSize
);

54 
	`memıy_s
(
m_»gi¡”
+
upd©eSize
, m_»gi¡”.
	`size
()-upd©eSize, 
m_‹mp
, 
m_ãedbackSize
);

55 
	}
}

57 
	gCFB_ModePŞicy
::
	$Ch”ResynchrÚize
(cÚ¡ 
by‹
 *
iv
, 
size_t
 
Ëngth
)

59 
	`as£¹
(
Ëngth
 =ğ
	`BlockSize
());

60 
	`CİyOrZ”o
(
m_»gi¡”
, 
iv
, 
Ëngth
);

61 
	`T¿nsfÜmRegi¡”
();

62 
	}
}

64 
	gCFB_ModePŞicy
::
	$S‘F“dbackSize
(
ãedbackSize
)

66 ià(
ãedbackSize
 > 
	`BlockSize
())

67 
throw
 
	`Inv®idArgum’t
("CFB_Mode: invalid feedback size");

68 
m_ãedbackSize
 = 
ãedbackSize
 ? f“dbackSiz: 
	`BlockSize
();

69 
	}
}

71 
	gCFB_ModePŞicy
::
	$ResizeBufãrs
()

73 
Ch”ModeBa£
::
	`ResizeBufãrs
();

74 
m_‹mp
.
	`New
(
	`BlockSize
());

75 
	}
}

77 
	gOFB_ModePŞicy
::
	$Wr™eKey¡»am
(
by‹
 *
key¡»amBufãr
, 
size_t
 
™”©iÚCouÁ
)

79 
	`as£¹
(
m_ch”
->
	`IsFÜw¬dT¿nsfÜm©iÚ
());

80 
s
 = 
	`BlockSize
();

81 
m_ch”
->
	`ProûssBlock
(
m_»gi¡”
, 
key¡»amBufãr
);

82 ià(
™”©iÚCouÁ
 > 1)

83 
m_ch”
->
	`AdvªûdProûssBlocks
(
key¡»amBufãr
, 
NULL
, key¡»amBufãr+
s
, s*(
™”©iÚCouÁ
-1), 0);

84 
	`memıy
(
m_»gi¡”
, 
key¡»amBufãr
+
s
*(
™”©iÚCouÁ
-1), s);

85 
	}
}

87 
	gOFB_ModePŞicy
::
	$Ch”ResynchrÚize
(
by‹
 *
key¡»amBufãr
, cÚ¡ by‹ *
iv
, 
size_t
 
Ëngth
)

89 
	`as£¹
(
Ëngth
 =ğ
	`BlockSize
());

90 
	`CİyOrZ”o
(
m_»gi¡”
, 
iv
, 
Ëngth
);

91 
	}
}

93 
	gCTR_ModePŞicy
::
	$S“kToI‹¿tiÚ
(
lwÜd
 
™”©iÚCouÁ
)

95 
ÿ¼y
=0;

96 
i
=
	`BlockSize
()-1; i>=0; i--)

98 
sum
 = 
m_»gi¡”
[
i
] + 
	`by‹
(
™”©iÚCouÁ
è+ 
ÿ¼y
;

99 
m_couÁ”A¼ay
[
i
] = (
by‹
è
sum
;

100 
ÿ¼y
 = 
sum
 >> 8;

101 
™”©iÚCouÁ
 >>= 8;

103 
	}
}

105 
	gCTR_ModePŞicy
::
	$Inüem’tCouÁ”By256
()

107 
	`Inüem’tCouÁ”ByOÃ
(
m_couÁ”A¼ay
, 
	`BlockSize
()-1);

108 
	}
}

110 
	gCTR_ModePŞicy
::
	$O³¿‹Key¡»am
(
Key¡»amO³¿tiÚ
 
İ”©iÚ
, 
by‹
 *
ouut
, cÚ¡ by‹ *
šput
, 
size_t
 
™”©iÚCouÁ
)

112 
	`as£¹
(
m_ch”
->
	`IsFÜw¬dT¿nsfÜm©iÚ
());

113 
s
 = 
	`BlockSize
();

114 
šputInüem’t
 = 
šput
 ? 
s
 : 0;

116 
™”©iÚCouÁ
)

118 
by‹
 
lsb
 = 
m_couÁ”A¼ay
[
s
-1];

119 
size_t
 
blocks
 = 
	`UnsigÃdMš
(
™”©iÚCouÁ
, 256U-
lsb
);

120 
m_ch”
->
	`AdvªûdProûssBlocks
(
m_couÁ”A¼ay
, 
šput
, 
ouut
, 
blocks
*
s
, 
BlockT¿nsfÜm©iÚ
::
BT_InBlockIsCouÁ”
|BlockT¿nsfÜm©iÚ::
BT_AÎowP¬®Ël
);

121 ià((
m_couÁ”A¼ay
[
s
-1] = 
lsb
 + (
by‹
)
blocks
) == 0)

122 
	`Inüem’tCouÁ”By256
();

124 
ouut
 +ğ
blocks
*
s
;

125 
šput
 +ğ
blocks
*
šputInüem’t
;

126 
™”©iÚCouÁ
 -ğ
blocks
;

128 
	}
}

130 
	gCTR_ModePŞicy
::
	$Ch”ResynchrÚize
(
by‹
 *
key¡»amBufãr
, cÚ¡ by‹ *
iv
, 
size_t
 
Ëngth
)

132 
	`as£¹
(
Ëngth
 =ğ
	`BlockSize
());

133 
	`CİyOrZ”o
(
m_»gi¡”
, 
iv
, 
Ëngth
);

134 
m_couÁ”A¼ay
 = 
m_»gi¡”
;

135 
	}
}

137 
	gBlockOr›ÁedCh”ModeBa£
::
	$UncheckedS‘Key
(cÚ¡ 
by‹
 *
key
, 
Ëngth
, cÚ¡ 
NameV®uePaœs
 &
·¿ms
)

139 
m_ch”
->
	`S‘Key
(
key
, 
Ëngth
, 
·¿ms
);

140 
	`ResizeBufãrs
();

141 ià(
	`IsResynchrÚizabË
())

143 
size_t
 
ivL’gth
;

144 cÚ¡ 
by‹
 *
iv
 = 
	`G‘IVAndThrowIfInv®id
(
·¿ms
, 
ivL’gth
);

145 
	`ResynchrÚize
(
iv
, ()
ivL’gth
);

147 
	}
}

149 
	gECB_OÃWay
::
	$ProûssD©a
(
by‹
 *
outSŒšg
, cÚ¡ by‹ *
šSŒšg
, 
size_t
 
Ëngth
)

151 
	`as£¹
(
Ëngth
%
	`BlockSize
()==0);

152 
m_ch”
->
	`AdvªûdProûssBlocks
(
šSŒšg
, 
NULL
, 
outSŒšg
, 
Ëngth
, 
BlockT¿nsfÜm©iÚ
::
BT_AÎowP¬®Ël
);

153 
	}
}

155 
	gCBC_Enüy±iÚ
::
	$ProûssD©a
(
by‹
 *
outSŒšg
, cÚ¡ by‹ *
šSŒšg
, 
size_t
 
Ëngth
)

157 ià(!
Ëngth
)

159 
	`as£¹
(
Ëngth
%
	`BlockSize
()==0);

161 
blockSize
 = 
	`BlockSize
();

162 
m_ch”
->
	`AdvªûdProûssBlocks
(
šSŒšg
, 
m_»gi¡”
, 
outSŒšg
, 
blockSize
, 
BlockT¿nsfÜm©iÚ
::
BT_XÜIÅut
);

163 ià(
Ëngth
 > 
blockSize
)

164 
m_ch”
->
	`AdvªûdProûssBlocks
(
šSŒšg
+
blockSize
, 
outSŒšg
, outSŒšg+blockSize, 
Ëngth
-blockSize, 
BlockT¿nsfÜm©iÚ
::
BT_XÜIÅut
);

165 
	`memıy
(
m_»gi¡”
, 
outSŒšg
 + 
Ëngth
 - 
blockSize
, blockSize);

166 
	}
}

168 
	gCBC_CTS_Enüy±iÚ
::
	$ProûssLa¡Block
(
by‹
 *
outSŒšg
, cÚ¡ by‹ *
šSŒšg
, 
size_t
 
Ëngth
)

170 ià(
Ëngth
 <ğ
	`BlockSize
())

172 ià(!
m_¡Ş’IV
)

173 
throw
 
	`Inv®idArgum’t
("CBC_Encryption: message isoo short for ciphertext stealing");

176 
	`memıy
(
outSŒšg
, 
m_»gi¡”
, 
Ëngth
);

177 
outSŒšg
 = 
m_¡Ş’IV
;

182 
	`xÜbuf
(
m_»gi¡”
, 
šSŒšg
, 
	`BlockSize
());

183 
m_ch”
->
	`ProûssBlock
(
m_»gi¡”
);

184 
šSŒšg
 +ğ
	`BlockSize
();

185 
Ëngth
 -ğ
	`BlockSize
();

186 
	`memıy
(
outSŒšg
+
	`BlockSize
(), 
m_»gi¡”
, 
Ëngth
);

190 
	`xÜbuf
(
m_»gi¡”
, 
šSŒšg
, 
Ëngth
);

191 
m_ch”
->
	`ProûssBlock
(
m_»gi¡”
);

192 
	`memıy
(
outSŒšg
, 
m_»gi¡”
, 
	`BlockSize
());

193 
	}
}

195 
	gCBC_Deüy±iÚ
::
	$ProûssD©a
(
by‹
 *
outSŒšg
, cÚ¡ by‹ *
šSŒšg
, 
size_t
 
Ëngth
)

197 ià(!
Ëngth
)

199 
	`as£¹
(
Ëngth
%
	`BlockSize
()==0);

201 
blockSize
 = 
	`BlockSize
();

202 
	`memıy
(
m_‹mp
, 
šSŒšg
+
Ëngth
-
blockSize
, blockSize);

203 ià(
Ëngth
 > 
blockSize
)

204 
m_ch”
->
	`AdvªûdProûssBlocks
(
šSŒšg
+
blockSize
, inSŒšg, 
outSŒšg
+blockSize, 
Ëngth
-blockSize, 
BlockT¿nsfÜm©iÚ
::
BT_Rev”£DœeùiÚ
|BlockT¿nsfÜm©iÚ::
BT_AÎowP¬®Ël
);

205 
m_ch”
->
	`ProûssAndXÜBlock
(
šSŒšg
, 
m_»gi¡”
, 
outSŒšg
);

206 
m_»gi¡”
.
	`sw­
(
m_‹mp
);

207 
	}
}

209 
	gCBC_CTS_Deüy±iÚ
::
	$ProûssLa¡Block
(
by‹
 *
outSŒšg
, cÚ¡ by‹ *
šSŒšg
, 
size_t
 
Ëngth
)

211 cÚ¡ 
by‹
 *
²
, *
²1
;

212 
boŞ
 
¡—lIV
 = 
Ëngth
 <ğ
	`BlockSize
();

214 ià(
¡—lIV
)

216 
²
 = 
šSŒšg
;

217 
²1
 = 
m_»gi¡”
;

221 
²
 = 
šSŒšg
 + 
	`BlockSize
();

222 
²1
 = 
šSŒšg
;

223 
Ëngth
 -ğ
	`BlockSize
();

227 
	`memıy
(
m_‹mp
, 
²1
, 
	`BlockSize
());

228 
m_ch”
->
	`ProûssBlock
(
m_‹mp
);

229 
	`xÜbuf
(
m_‹mp
, 
²
, 
Ëngth
);

231 ià(
¡—lIV
)

232 
	`memıy
(
outSŒšg
, 
m_‹mp
, 
Ëngth
);

235 
	`memıy
(
outSŒšg
+
	`BlockSize
(), 
m_‹mp
, 
Ëngth
);

237 
	`memıy
(
m_‹mp
, 
²
, 
Ëngth
);

238 
m_ch”
->
	`ProûssBlock
(
m_‹mp
);

239 
	`xÜbuf
(
outSŒšg
, 
m_‹mp
, 
m_»gi¡”
, 
	`BlockSize
());

241 
	}
}

243 
	gNAMESPACE_END


	@modes.h

1 #iâdeà
CRYPTOPP_MODES_H


2 
	#CRYPTOPP_MODES_H


	)

7 
	~"üy±lib.h
"

8 
	~"£cblock.h
"

9 
	~"misc.h
"

10 
	~"¡rchr.h
"

11 
	~"¬gÇmes.h
"

12 
	~"®g·¿m.h
"

14 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

27 
Ch”ModeDocum’tiÚ
 : 
public
 
Symm‘ricCh”Docum’tiÚ


29 
	}
};

31 şas 
	cCRYPTOPP_DLL
 
CRYPTOPP_NO_VTABLE
 
	mCh”ModeBa£
 : 
public
 
Symm‘ricCh”


33 
public
:

34 
size_t
 
	$MšKeyL’gth
(ècÚ¡ { 
m_ch”
->
	`MšKeyL’gth
();}

35 
size_t
 
	$MaxKeyL’gth
(ècÚ¡ { 
m_ch”
->
	`MaxKeyL’gth
();
	}
}

36 
size_t
 
	$DeçuÉKeyL’gth
(ècÚ¡ { 
m_ch”
->
	`DeçuÉKeyL’gth
();
	}
}

37 
size_t
 
	$G‘V®idKeyL’gth
(
size_t
 
n
ècÚ¡ { 
m_ch”
->
	`G‘V®idKeyL’gth
Ò);
	}
}

38 
boŞ
 
	$IsV®idKeyL’gth
(
size_t
 
n
ècÚ¡ { 
m_ch”
->
	`IsV®idKeyL’gth
Ò);
	}
}

40 
	$O±im®D©aAlignm’t
(ècÚ¡ { 
m_ch”
->
	`O±im®D©aAlignm’t
();
	}
}

42 
	$IVSize
(ècÚ¡ { 
	`BlockSize
();
	}
}

43 
vœtu®
 
IV_Requœem’t
 
	$IVRequœem’t
() const =0;

45 
	$S‘Ch”
(
BlockCh”
 &
ch”
)

47 
this
->
	`ThrowIfResynchrÚizabË
();

48 
this
->
m_ch”
 = &
ch”
;

49 
this
->
	`ResizeBufãrs
();

50 
	}
}

52 
	$S‘Ch”W™hIV
(
BlockCh”
 &
ch”
, cÚ¡ 
by‹
 *
iv
, 
ãedbackSize
 = 0)

54 
this
->
	`ThrowIfInv®idIV
(
iv
);

55 
this
->
m_ch”
 = &
ch”
;

56 
this
->
	`ResizeBufãrs
();

57 
this
->
	`S‘F“dbackSize
(
ãedbackSize
);

58 ià(
this
->
	`IsResynchrÚizabË
())

59 
this
->
	`ResynchrÚize
(
iv
);

60 
	}
}

62 
	g´Ùeùed
:

63 
	$Ch”ModeBa£
(è: 
	$m_ch”
(
NULL
è{
	}
}

64 
šlše
 
	$BlockSize
(ècÚ¡ {
	`as£¹
(
m_»gi¡”
.
	`size
(è> 0);  ()m_»gi¡”.size();
	}
}

65 
vœtu®
 
	$S‘F“dbackSize
(
ãedbackSize
)

67 ià(!(
ãedbackSize
 =ğ0 || f“dbackSiz=ğ
	`BlockSize
()))

68 
throw
 
	`Inv®idArgum’t
("CipherModeBase: feedback size cannot be specified forhis cipher mode");

69 
	}
}

70 
vœtu®
 
	$ResizeBufãrs
()

72 
m_»gi¡”
.
	`New
(
m_ch”
->
	`BlockSize
());

73 
	}
}

75 
BlockCh”
 *
	gm_ch”
;

76 
AligÃdSecBy‹Block
 
	gm_»gi¡”
;

79 
	g‹m¶©e
 <
şass
 
	gPOLICY_INTERFACE
>

80 
şass
 
CRYPTOPP_NO_VTABLE
 
	gModePŞicyCommÚTem¶©e
 : 
public
 
Ch”ModeBa£
,…ubliø
	gPOLICY_INTERFACE


82 
G‘Alignm’t
(ècÚ¡ { 
	gm_ch”
->
O±im®D©aAlignm’t
();}

83 
Ch”S‘Key
(cÚ¡ 
NameV®uePaœs
 &
·¿ms
, cÚ¡ 
by‹
 *
key
, 
size_t
 
Ëngth
);

86 
	g‹m¶©e
 <
şass
 
	gPOLICY_INTERFACE
>

87 
	gModePŞicyCommÚTem¶©e
<
	gPOLICY_INTERFACE
>::
	$Ch”S‘Key
(cÚ¡ 
NameV®uePaœs
 &
·¿ms
, cÚ¡ 
by‹
 *
key
, 
size_t
 
Ëngth
)

89 
m_ch”
->
	`S‘Key
(
key
, 
Ëngth
, 
·¿ms
);

90 
	`ResizeBufãrs
();

91 
ãedbackSize
 = 
·¿ms
.
	`G‘IÁV®ueW™hDeçuÉ
(
Name
::
	`F“dbackSize
(), 0);

92 
	`S‘F“dbackSize
(
ãedbackSize
);

93 
	}
}

95 
şass
 
CRYPTOPP_DLL
 
CRYPTOPP_NO_VTABLE
 
	gCFB_ModePŞicy
 : 
public
 
ModePŞicyCommÚTem¶©e
<
CFB_Ch”Ab¡¿ùPŞicy
>

97 
public
:

98 
IV_Requœem’t
 
IVRequœem’t
(ècÚ¡ { 
RANDOM_IV
;}

99 cÚ¡ * 
CRYPTOPP_API
 
SticAlgÜ™hmName
() { "CFB";}

101 
	g´Ùeùed
:

102 
G‘By‹sP”I‹¿tiÚ
(ècÚ¡ { 
m_ãedbackSize
;}

103 
by‹
 * 
G‘Regi¡”Begš
(è{ 
	gm_»gi¡”
 + 
BlockSize
(è- 
	gm_ãedbackSize
;}

104 
boŞ
 
CªI‹¿‹
(ècÚ¡ { 
	gm_ãedbackSize
 =ğ
BlockSize
();}

105 
I‹¿‹
(
by‹
 *
ouut
, cÚ¡ by‹ *
šput
, 
Ch”Dœ
 
dœ
, 
size_t
 
™”©iÚCouÁ
);

106 
T¿nsfÜmRegi¡”
();

107 
Ch”ResynchrÚize
(cÚ¡ 
by‹
 *
iv
, 
size_t
 
Ëngth
);

108 
S‘F“dbackSize
(
ãedbackSize
);

109 
ResizeBufãrs
();

111 
SecBy‹Block
 
	gm_‹mp
;

112 
	gm_ãedbackSize
;

115 
šlše
 
	$CİyOrZ”o
(*
de¡
, cÚ¡ *
¤c
, 
size_t
 
s
)

117 ià(
¤c
)

118 
	`memıy_s
(
de¡
, 
s
, 
¤c
, s);

120 
	`mem£t
(
de¡
, 0, 
s
);

121 
	}
}

123 
şass
 
CRYPTOPP_DLL
 
CRYPTOPP_NO_VTABLE
 
	gOFB_ModePŞicy
 : 
public
 
ModePŞicyCommÚTem¶©e
<
Add™iveCh”Ab¡¿ùPŞicy
>

125 
public
:

126 
boŞ
 
Ch”IsRªdomAcûss
(ècÚ¡ { 
çl£
;}

127 
IV_Requœem’t
 
IVRequœem’t
(ècÚ¡ { 
	gUNIQUE_IV
;}

128 cÚ¡ * 
CRYPTOPP_API
 
SticAlgÜ™hmName
() { "OFB";}

130 
	g´iv©e
:

131 
G‘By‹sP”I‹¿tiÚ
(ècÚ¡ { 
BlockSize
();}

132 
G‘I‹¿tiÚsToBufãr
(ècÚ¡ { 
	gm_ch”
->
O±im®Numb”OfP¬®ËlBlocks
();}

133 
Wr™eKey¡»am
(
by‹
 *
key¡»amBufãr
, 
size_t
 
™”©iÚCouÁ
);

134 
Ch”ResynchrÚize
(
by‹
 *
key¡»amBufãr
, cÚ¡ by‹ *
iv
, 
size_t
 
Ëngth
);

137 
şass
 
CRYPTOPP_DLL
 
CRYPTOPP_NO_VTABLE
 
	gCTR_ModePŞicy
 : 
public
 
ModePŞicyCommÚTem¶©e
<
Add™iveCh”Ab¡¿ùPŞicy
>

139 
public
:

140 
boŞ
 
Ch”IsRªdomAcûss
(ècÚ¡ { 
Œue
;}

141 
IV_Requœem’t
 
IVRequœem’t
(ècÚ¡ { 
	gRANDOM_IV
;}

142 cÚ¡ * 
CRYPTOPP_API
 
SticAlgÜ™hmName
() { "CTR";}

144 
	g´Ùeùed
:

145 
vœtu®
 
Inüem’tCouÁ”By256
();

147 
G‘Alignm’t
(ècÚ¡ { 
	gm_ch”
->
O±im®D©aAlignm’t
();}

148 
G‘By‹sP”I‹¿tiÚ
(ècÚ¡ { 
BlockSize
();}

149 
G‘I‹¿tiÚsToBufãr
(ècÚ¡ { 
	gm_ch”
->
O±im®Numb”OfP¬®ËlBlocks
();}

150 
Wr™eKey¡»am
(
by‹
 *
bufãr
, 
size_t
 
™”©iÚCouÁ
)

151 {
O³¿‹Key¡»am
(
WRITE_KEYSTREAM
, 
bufãr
, 
NULL
, 
™”©iÚCouÁ
);}

152 
boŞ
 
CªO³¿‹Key¡»am
(ècÚ¡ { 
	gŒue
;}

153 
O³¿‹Key¡»am
(
Key¡»amO³¿tiÚ
 
İ”©iÚ
, 
by‹
 *
ouut
, cÚ¡ by‹ *
šput
, 
size_t
 
™”©iÚCouÁ
);

154 
Ch”ResynchrÚize
(
by‹
 *
key¡»amBufãr
, cÚ¡ by‹ *
iv
, 
size_t
 
Ëngth
);

155 
S“kToI‹¿tiÚ
(
lwÜd
 
™”©iÚCouÁ
);

157 
AligÃdSecBy‹Block
 
	gm_couÁ”A¼ay
;

160 şas 
	cCRYPTOPP_DLL
 
CRYPTOPP_NO_VTABLE
 
	mBlockOr›ÁedCh”ModeBa£
 : 
public
 
Ch”ModeBa£


162 
public
:

163 
UncheckedS‘Key
(cÚ¡ 
by‹
 *
key
, 
Ëngth
, cÚ¡ 
NameV®uePaœs
 &
·¿ms
);

164 
	$Mªd©ÜyBlockSize
(ècÚ¡ { 
	`BlockSize
();}

165 
boŞ
 
	$IsRªdomAcûss
(ècÚ¡ { 
çl£
;
	}
}

166 
boŞ
 
	$IsS–fInv”tšg
(ècÚ¡ { 
çl£
;
	}
}

167 
boŞ
 
	$IsFÜw¬dT¿nsfÜm©iÚ
(ècÚ¡ { 
m_ch”
->
	`IsFÜw¬dT¿nsfÜm©iÚ
();
	}
}

168 
ResynchrÚize
(cÚ¡ 
by‹
 *
iv
, 
Ëngth
=-1è{
memıy_s
(
m_»gi¡”
, m_»gi¡”.
size
(), iv, 
ThrowIfInv®idIVL’gth
(length));}

170 
	g´Ùeùed
:

171 
boŞ
 
	$RequœeAligÃdIÅut
(ècÚ¡ { 
Œue
;
	}
}

172 
	$ResizeBufãrs
()

174 
Ch”ModeBa£
::
	`ResizeBufãrs
();

175 
m_bufãr
.
	`New
(
	`BlockSize
());

176 
	}
}

178 
SecBy‹Block
 
	gm_bufãr
;

181 şas 
	cCRYPTOPP_DLL
 
CRYPTOPP_NO_VTABLE
 
	mECB_OÃWay
 : 
public
 
BlockOr›ÁedCh”ModeBa£


183 
public
:

184 
	$S‘Key
(cÚ¡ 
by‹
 *
key
, 
size_t
 
Ëngth
, cÚ¡ 
NameV®uePaœs
 &
·¿ms
 = 
g_nuÎNameV®uePaœs
)

185 {
m_ch”
->
	`S‘Key
(
key
, 
Ëngth
, 
·¿ms
); 
BlockOr›ÁedCh”ModeBa£
::
	`ResizeBufãrs
();}

186 
IV_Requœem’t
 
	$IVRequœem’t
(ècÚ¡ { 
NOT_RESYNCHRONIZABLE
;
	}
}

187 
	$O±im®BlockSize
(ècÚ¡ { 
	`BlockSize
(è* 
m_ch”
->
	`O±im®Numb”OfP¬®ËlBlocks
();
	}
}

188 
ProûssD©a
(
by‹
 *
outSŒšg
, cÚ¡ by‹ *
šSŒšg
, 
size_t
 
Ëngth
);

189 cÚ¡ * 
CRYPTOPP_API
 
	$SticAlgÜ™hmName
(è{ "ECB";
	}
}

192 şas 
	cCRYPTOPP_DLL
 
CRYPTOPP_NO_VTABLE
 
	mCBC_ModeBa£
 : 
public
 
BlockOr›ÁedCh”ModeBa£


194 
public
:

195 
IV_Requœem’t
 
	$IVRequœem’t
(ècÚ¡ { 
UNPREDICTABLE_RANDOM_IV
;}

196 
boŞ
 
	$RequœeAligÃdIÅut
(ècÚ¡ { 
çl£
;
	}
}

197 
	$MšLa¡BlockSize
(ècÚ¡ { 0;
	}
}

198 cÚ¡ * 
CRYPTOPP_API
 
	$SticAlgÜ™hmName
(è{ "CBC";
	}
}

201 şas 
	cCRYPTOPP_DLL
 
CRYPTOPP_NO_VTABLE
 
	mCBC_Enüy±iÚ
 : 
public
 
CBC_ModeBa£


203 
public
:

204 
ProûssD©a
(
by‹
 *
outSŒšg
, cÚ¡ by‹ *
šSŒšg
, 
size_t
 
Ëngth
);

207 şas 
	cCRYPTOPP_DLL
 
CRYPTOPP_NO_VTABLE
 
	mCBC_CTS_Enüy±iÚ
 : 
public
 
CBC_Enüy±iÚ


209 
public
:

210 
	$S‘StŞ’IV
(
by‹
 *
iv
è{
m_¡Ş’IV
 = iv;}

211 
	$MšLa¡BlockSize
(ècÚ¡ { 
	`BlockSize
()+1;
	}
}

212 
ProûssLa¡Block
(
by‹
 *
outSŒšg
, cÚ¡ by‹ *
šSŒšg
, 
size_t
 
Ëngth
);

213 cÚ¡ * 
CRYPTOPP_API
 
	$SticAlgÜ™hmName
(è{ "CBC/CTS";
	}
}

215 
	g´Ùeùed
:

216 
	$UncheckedS‘Key
(cÚ¡ 
by‹
 *
key
, 
Ëngth
, cÚ¡ 
NameV®uePaœs
 &
·¿ms
)

218 
CBC_Enüy±iÚ
::
	`UncheckedS‘Key
(
key
, 
Ëngth
, 
·¿ms
);

219 
m_¡Ş’IV
 = 
·¿ms
.
	`G‘V®ueW™hDeçuÉ
(
Name
::
	`StŞ’IV
(), (
by‹
 *)
NULL
);

220 
	}
}

222 
by‹
 *
	gm_¡Ş’IV
;

225 şas 
	cCRYPTOPP_DLL
 
CRYPTOPP_NO_VTABLE
 
	mCBC_Deüy±iÚ
 : 
public
 
CBC_ModeBa£


227 
public
:

228 
ProûssD©a
(
by‹
 *
outSŒšg
, cÚ¡ by‹ *
šSŒšg
, 
size_t
 
Ëngth
);

230 
	m´Ùeùed
:

231 
	$ResizeBufãrs
()

233 
BlockOr›ÁedCh”ModeBa£
::
	`ResizeBufãrs
();

234 
m_‹mp
.
	`New
(
	`BlockSize
());

236 
AligÃdSecBy‹Block
 
m_‹mp
;

237 
	}
};

239 şas 
	cCRYPTOPP_DLL
 
CRYPTOPP_NO_VTABLE
 
	mCBC_CTS_Deüy±iÚ
 : 
public
 
CBC_Deüy±iÚ


241 
public
:

242 
	$MšLa¡BlockSize
(ècÚ¡ { 
	`BlockSize
()+1;}

243 
	`ProûssLa¡Block
(
by‹
 *
outSŒšg
, cÚ¡ by‹ *
šSŒšg
, 
size_t
 
Ëngth
);

244 
	}
};

247 
	g‹m¶©e
 <
şass
 
	gCIPHER
, cÏs 
	gBASE
>

248 
şass
 
	gCh”ModeFš®Tem¶©e_Ch”HŞd”
 : 
´Ùeùed
 
ObjeùHŞd”
<
CIPHER
>, 
public
 
	gAlgÜ™hmIm¶
<
	gBASE
, Ch”ModeFš®Tem¶©e_Ch”HŞd”<
	gCIPHER
, BASE> >

250 
	gpublic
:

251 
Ch”ModeFš®Tem¶©e_Ch”HŞd”
()

253 
this
->
m_ch”
 = &this->
m_objeù
;

254 
	gthis
->
ResizeBufãrs
();

256 
Ch”ModeFš®Tem¶©e_Ch”HŞd”
(cÚ¡ 
by‹
 *
key
, 
size_t
 
Ëngth
)

258 
	gthis
->
	gm_ch”
 = &
this
->
m_objeù
;

259 
	gthis
->
S‘Key
(
key
, 
Ëngth
);

261 
Ch”ModeFš®Tem¶©e_Ch”HŞd”
(cÚ¡ 
by‹
 *
key
, 
size_t
 
Ëngth
, cÚ¡ by‹ *
iv
)

263 
	gthis
->
	gm_ch”
 = &
this
->
m_objeù
;

264 
	gthis
->
S‘Key
(
key
, 
Ëngth
, 
MakeP¬am‘”s
(
Name
::
IV
(), 
CÚ¡By‹A¼ayP¬am‘”
(
iv
, 
this
->
m_ch”
->
BlockSize
())));

266 
Ch”ModeFš®Tem¶©e_Ch”HŞd”
(cÚ¡ 
by‹
 *
key
, 
size_t
 
Ëngth
, cÚ¡ by‹ *
iv
, 
ãedbackSize
)

268 
	gthis
->
	gm_ch”
 = &
this
->
m_objeù
;

269 
	gthis
->
S‘Key
(
key
, 
Ëngth
, 
MakeP¬am‘”s
(
Name
::
IV
(), 
CÚ¡By‹A¼ayP¬am‘”
(
iv
, 
this
->
m_ch”
->
BlockSize
()))(Name::
F“dbackSize
(), 
ãedbackSize
));

272 
	g¡d
::
¡ršg
 
CRYPTOPP_API
 
SticAlgÜ™hmName
()

273 { 
CIPHER
::
SticAlgÜ™hmName
(è+ "/" + 
BASE
::StaticAlgorithmName();}

277 
	g‹m¶©e
 <
şass
 
	gBASE
>

278 şas 
	cCh”ModeFš®Tem¶©e_Ex‹º®Ch”
 : 
public
 
BASE


280 
public
:

281 
	$Ch”ModeFš®Tem¶©e_Ex‹º®Ch”
() {}

282 
	$Ch”ModeFš®Tem¶©e_Ex‹º®Ch”
(
BlockCh”
 &
ch”
)

283 {
this
->
	`S‘Ch”
(
ch”
);
	}
}

284 
	$Ch”ModeFš®Tem¶©e_Ex‹º®Ch”
(
BlockCh”
 &
ch”
, cÚ¡ 
by‹
 *
iv
, 
ãedbackSize
 = 0)

285 {
this
->
	`S‘Ch”W™hIV
(
ch”
, 
iv
, 
ãedbackSize
);
	}
}

287 
	g¡d
::
¡ršg
 
	$AlgÜ™hmName
() const

288 { (
this
->
m_ch”
 ?his->m_ch”->
	`AlgÜ™hmName
(è+ "/" : 
¡d
::
	`¡ršg
("")è+ 
BASE
::
	`SticAlgÜ™hmName
();
	}
}

291 
CRYPTOPP_DLL_TEMPLATE_CLASS
 
	gCFB_Ch”Tem¶©e
<
	gAb¡¿ùPŞicyHŞd”
<
	gCFB_Ch”Ab¡¿ùPŞicy
, 
	gCFB_ModePŞicy
> >;

292 
CRYPTOPP_DLL_TEMPLATE_CLASS
 
	gCFB_Enüy±iÚTem¶©e
<
	gAb¡¿ùPŞicyHŞd”
<
	gCFB_Ch”Ab¡¿ùPŞicy
, 
	gCFB_ModePŞicy
> >;

293 
CRYPTOPP_DLL_TEMPLATE_CLASS
 
	gCFB_Deüy±iÚTem¶©e
<
	gAb¡¿ùPŞicyHŞd”
<
	gCFB_Ch”Ab¡¿ùPŞicy
, 
	gCFB_ModePŞicy
> >;

296 
	g‹m¶©e
 <
şass
 
	gCIPHER
>

297 
	gCFB_Mode
 : 
public
 
Ch”ModeDocum’tiÚ


299 
Ch”ModeFš®Tem¶©e_Ch”HŞd”
<
	tCPP_TYPENAME
 
	tCIPHER
::
	tEnüy±iÚ
, 
	tCÚü‘ePŞicyHŞd”
<
	tEm±y
, 
	tCFB_Enüy±iÚTem¶©e
<
	tAb¡¿ùPŞicyHŞd”
<
	tCFB_Ch”Ab¡¿ùPŞicy
, 
	tCFB_ModePŞicy
> > > > Encryption;

300 
	gCh”ModeFš®Tem¶©e_Ch”HŞd”
<
	tCPP_TYPENAME
 
	tCIPHER
::
	tEnüy±iÚ
, 
	tCÚü‘ePŞicyHŞd”
<
	tEm±y
, 
	tCFB_Deüy±iÚTem¶©e
<
	tAb¡¿ùPŞicyHŞd”
<
	tCFB_Ch”Ab¡¿ùPŞicy
, 
	tCFB_ModePŞicy
> > > > 
	tDeüy±iÚ
;

304 
	gCFB_Mode_Ex‹º®Ch”
 : 
public
 
Ch”ModeDocum’tiÚ


306 
Ch”ModeFš®Tem¶©e_Ex‹º®Ch”
<
	tCÚü‘ePŞicyHŞd”
<
	tEm±y
, 
	tCFB_Enüy±iÚTem¶©e
<
	tAb¡¿ùPŞicyHŞd”
<
	tCFB_Ch”Ab¡¿ùPŞicy
, 
	tCFB_ModePŞicy
> > > > 
	tEnüy±iÚ
;

307 
	gCh”ModeFš®Tem¶©e_Ex‹º®Ch”
<
	tCÚü‘ePŞicyHŞd”
<
	tEm±y
, 
	tCFB_Deüy±iÚTem¶©e
<
	tAb¡¿ùPŞicyHŞd”
<
	tCFB_Ch”Ab¡¿ùPŞicy
, 
	tCFB_ModePŞicy
> > > > 
	tDeüy±iÚ
;

311 
	g‹m¶©e
 <
şass
 
	gCIPHER
>

312 
	gCFB_FIPS_Mode
 : 
public
 
Ch”ModeDocum’tiÚ


314 
Ch”ModeFš®Tem¶©e_Ch”HŞd”
<
	tCPP_TYPENAME
 
	tCIPHER
::
	tEnüy±iÚ
, 
	tCÚü‘ePŞicyHŞd”
<
	tEm±y
, 
	tCFB_RequœeFuÎD©aBlocks
<
	tCFB_Enüy±iÚTem¶©e
<
	tAb¡¿ùPŞicyHŞd”
<
	tCFB_Ch”Ab¡¿ùPŞicy
, 
	tCFB_ModePŞicy
> > > > > Encryption;

315 
	gCh”ModeFš®Tem¶©e_Ch”HŞd”
<
	tCPP_TYPENAME
 
	tCIPHER
::
	tEnüy±iÚ
, 
	tCÚü‘ePŞicyHŞd”
<
	tEm±y
, 
	tCFB_RequœeFuÎD©aBlocks
<
	tCFB_Deüy±iÚTem¶©e
<
	tAb¡¿ùPŞicyHŞd”
<
	tCFB_Ch”Ab¡¿ùPŞicy
, 
	tCFB_ModePŞicy
> > > > > 
	tDeüy±iÚ
;

319 
	gCFB_FIPS_Mode_Ex‹º®Ch”
 : 
public
 
Ch”ModeDocum’tiÚ


321 
Ch”ModeFš®Tem¶©e_Ex‹º®Ch”
<
	tCÚü‘ePŞicyHŞd”
<
	tEm±y
, 
	tCFB_RequœeFuÎD©aBlocks
<
	tCFB_Enüy±iÚTem¶©e
<
	tAb¡¿ùPŞicyHŞd”
<
	tCFB_Ch”Ab¡¿ùPŞicy
, 
	tCFB_ModePŞicy
> > > > > 
	tEnüy±iÚ
;

322 
	gCh”ModeFš®Tem¶©e_Ex‹º®Ch”
<
	tCÚü‘ePŞicyHŞd”
<
	tEm±y
, 
	tCFB_RequœeFuÎD©aBlocks
<
	tCFB_Deüy±iÚTem¶©e
<
	tAb¡¿ùPŞicyHŞd”
<
	tCFB_Ch”Ab¡¿ùPŞicy
, 
	tCFB_ModePŞicy
> > > > > 
	tDeüy±iÚ
;

325 
CRYPTOPP_DLL_TEMPLATE_CLASS
 
	gAdd™iveCh”Tem¶©e
<
	gAb¡¿ùPŞicyHŞd”
<
	gAdd™iveCh”Ab¡¿ùPŞicy
, 
	gOFB_ModePŞicy
> >;

328 
	g‹m¶©e
 <
şass
 
	gCIPHER
>

329 
	gOFB_Mode
 : 
public
 
Ch”ModeDocum’tiÚ


331 
Ch”ModeFš®Tem¶©e_Ch”HŞd”
<
	tCPP_TYPENAME
 
	tCIPHER
::
	tEnüy±iÚ
, 
	tCÚü‘ePŞicyHŞd”
<
	tEm±y
, 
	tAdd™iveCh”Tem¶©e
<
	tAb¡¿ùPŞicyHŞd”
<
	tAdd™iveCh”Ab¡¿ùPŞicy
, 
	tOFB_ModePŞicy
> > > > Encryption;

332 
Enüy±iÚ
 
	tDeüy±iÚ
;

336 
	gOFB_Mode_Ex‹º®Ch”
 : 
public
 
Ch”ModeDocum’tiÚ


338 
Ch”ModeFš®Tem¶©e_Ex‹º®Ch”
<
	tCÚü‘ePŞicyHŞd”
<
	tEm±y
, 
	tAdd™iveCh”Tem¶©e
<
	tAb¡¿ùPŞicyHŞd”
<
	tAdd™iveCh”Ab¡¿ùPŞicy
, 
	tOFB_ModePŞicy
> > > > 
	tEnüy±iÚ
;

339 
Enüy±iÚ
 
	tDeüy±iÚ
;

342 
CRYPTOPP_DLL_TEMPLATE_CLASS
 
	gAdd™iveCh”Tem¶©e
<
	gAb¡¿ùPŞicyHŞd”
<
	gAdd™iveCh”Ab¡¿ùPŞicy
, 
	gCTR_ModePŞicy
> >;

343 
CRYPTOPP_DLL_TEMPLATE_CLASS
 
	gCh”ModeFš®Tem¶©e_Ex‹º®Ch”
<
	gCÚü‘ePŞicyHŞd”
<
	gEm±y
, 
	gAdd™iveCh”Tem¶©e
<
	gAb¡¿ùPŞicyHŞd”
<
	gAdd™iveCh”Ab¡¿ùPŞicy
, 
	gCTR_ModePŞicy
> > > >;

346 
	g‹m¶©e
 <
şass
 
	gCIPHER
>

347 
	gCTR_Mode
 : 
public
 
Ch”ModeDocum’tiÚ


349 
Ch”ModeFš®Tem¶©e_Ch”HŞd”
<
	tCPP_TYPENAME
 
	tCIPHER
::
	tEnüy±iÚ
, 
	tCÚü‘ePŞicyHŞd”
<
	tEm±y
, 
	tAdd™iveCh”Tem¶©e
<
	tAb¡¿ùPŞicyHŞd”
<
	tAdd™iveCh”Ab¡¿ùPŞicy
, 
	tCTR_ModePŞicy
> > > > Encryption;

350 
Enüy±iÚ
 
	tDeüy±iÚ
;

354 
	gCTR_Mode_Ex‹º®Ch”
 : 
public
 
Ch”ModeDocum’tiÚ


356 
Ch”ModeFš®Tem¶©e_Ex‹º®Ch”
<
	tCÚü‘ePŞicyHŞd”
<
	tEm±y
, 
	tAdd™iveCh”Tem¶©e
<
	tAb¡¿ùPŞicyHŞd”
<
	tAdd™iveCh”Ab¡¿ùPŞicy
, 
	tCTR_ModePŞicy
> > > > 
	tEnüy±iÚ
;

357 
Enüy±iÚ
 
	tDeüy±iÚ
;

361 
	g‹m¶©e
 <
şass
 
	gCIPHER
>

362 
	gECB_Mode
 : 
public
 
Ch”ModeDocum’tiÚ


364 
Ch”ModeFš®Tem¶©e_Ch”HŞd”
<
	tCPP_TYPENAME
 
	tCIPHER
::
	tEnüy±iÚ
, 
	tECB_OÃWay
> Encryption;

365 
	gCh”ModeFš®Tem¶©e_Ch”HŞd”
<
	tCPP_TYPENAME
 
	tCIPHER
::
	tDeüy±iÚ
, 
	tECB_OÃWay
> Decryption;

368 
CRYPTOPP_DLL_TEMPLATE_CLASS
 
	gCh”ModeFš®Tem¶©e_Ex‹º®Ch”
<
	gECB_OÃWay
>;

371 
	gECB_Mode_Ex‹º®Ch”
 : 
public
 
Ch”ModeDocum’tiÚ


373 
Ch”ModeFš®Tem¶©e_Ex‹º®Ch”
<
	tECB_OÃWay
> 
	tEnüy±iÚ
;

374 
Enüy±iÚ
 
	tDeüy±iÚ
;

378 
	g‹m¶©e
 <
şass
 
	gCIPHER
>

379 
	gCBC_Mode
 : 
public
 
Ch”ModeDocum’tiÚ


381 
Ch”ModeFš®Tem¶©e_Ch”HŞd”
<
	tCPP_TYPENAME
 
	tCIPHER
::
	tEnüy±iÚ
, 
	tCBC_Enüy±iÚ
> Encryption;

382 
	gCh”ModeFš®Tem¶©e_Ch”HŞd”
<
	tCPP_TYPENAME
 
	tCIPHER
::
	tDeüy±iÚ
, 
	tCBC_Deüy±iÚ
> Decryption;

385 
CRYPTOPP_DLL_TEMPLATE_CLASS
 
	gCh”ModeFš®Tem¶©e_Ex‹º®Ch”
<
	gCBC_Enüy±iÚ
>;

386 
CRYPTOPP_DLL_TEMPLATE_CLASS
 
	gCh”ModeFš®Tem¶©e_Ex‹º®Ch”
<
	gCBC_Deüy±iÚ
>;

389 
	gCBC_Mode_Ex‹º®Ch”
 : 
public
 
Ch”ModeDocum’tiÚ


391 
Ch”ModeFš®Tem¶©e_Ex‹º®Ch”
<
	tCBC_Enüy±iÚ
> 
	tEnüy±iÚ
;

392 
	gCh”ModeFš®Tem¶©e_Ex‹º®Ch”
<
	tCBC_Deüy±iÚ
> 
	tDeüy±iÚ
;

396 
	g‹m¶©e
 <
şass
 
	gCIPHER
>

397 
	gCBC_CTS_Mode
 : 
public
 
Ch”ModeDocum’tiÚ


399 
Ch”ModeFš®Tem¶©e_Ch”HŞd”
<
	tCPP_TYPENAME
 
	tCIPHER
::
	tEnüy±iÚ
, 
	tCBC_CTS_Enüy±iÚ
> Encryption;

400 
	gCh”ModeFš®Tem¶©e_Ch”HŞd”
<
	tCPP_TYPENAME
 
	tCIPHER
::
	tDeüy±iÚ
, 
	tCBC_CTS_Deüy±iÚ
> Decryption;

403 
CRYPTOPP_DLL_TEMPLATE_CLASS
 
	gCh”ModeFš®Tem¶©e_Ex‹º®Ch”
<
	gCBC_CTS_Enüy±iÚ
>;

404 
CRYPTOPP_DLL_TEMPLATE_CLASS
 
	gCh”ModeFš®Tem¶©e_Ex‹º®Ch”
<
	gCBC_CTS_Deüy±iÚ
>;

407 
	gCBC_CTS_Mode_Ex‹º®Ch”
 : 
public
 
Ch”ModeDocum’tiÚ


409 
Ch”ModeFš®Tem¶©e_Ex‹º®Ch”
<
	tCBC_CTS_Enüy±iÚ
> 
	tEnüy±iÚ
;

410 
	gCh”ModeFš®Tem¶©e_Ex‹º®Ch”
<
	tCBC_CTS_Deüy±iÚ
> 
	tDeüy±iÚ
;

413 #ifdeà
CRYPTOPP_MAINTAIN_BACKWARDS_COMPATIBILITY


414 
	gCFB_Mode_Ex‹º®Ch”
::
	tEnüy±iÚ
 
	tCFBEnüy±iÚ
;

415 
	gCFB_Mode_Ex‹º®Ch”
::
	tDeüy±iÚ
 
	tCFBDeüy±iÚ
;

416 
	gOFB_Mode_Ex‹º®Ch”
::
	tEnüy±iÚ
 
	tOFB
;

417 
	gCTR_Mode_Ex‹º®Ch”
::
	tEnüy±iÚ
 
	tCouÁ”Mode
;

420 
	gNAMESPACE_END


	@modexppc.h

1 #iâdeà
CRYPTOPP_MODEXPPC_H


2 
	#CRYPTOPP_MODEXPPC_H


	)

4 
	~"mod¬™h.h
"

5 
	~"•»comp.h
"

6 
	~"sm¬Œ.h
"

7 
	~"pubkey.h
"

9 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

11 
CRYPTOPP_DLL_TEMPLATE_CLASS
 
DL_FixedBa£P»computiÚIm¶
<
IÁeg”
>;

13 
şass
 
ModExpP»computiÚ
 : 
public
 
DL_GroupP»computiÚ
<
IÁeg”
>

15 
public
:

17 
boŞ
 
	`N“dCÚv”siÚs
(ècÚ¡ { 
Œue
;}

18 
EËm’t
 
	`CÚv”tIn
(cÚ¡ EËm’ˆ&
v
ècÚ¡ { 
m_mr
->ConvertIn(v);}

19 
vœtu®
 
EËm’t
 
	`CÚv”tOut
(cÚ¡ EËm’ˆ&
v
ècÚ¡ { 
m_mr
->ConvertOut(v);}

20 cÚ¡ 
Ab¡¿ùGroup
<
EËm’t
> & 
	`G‘Group
(ècÚ¡ { 
m_mr
->
	`MuÉliÿtiveGroup
();}

21 
EËm’t
 
	`BERDecodeEËm’t
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
ècÚ¡ { 
	`IÁeg”
(bt);}

22 
	`DEREncodeEËm’t
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
, cÚ¡ 
EËm’t
 &
v
ècÚ¡ {v.
	`DEREncode
(bt);}

25 
	`S‘Modulus
(cÚ¡ 
IÁeg”
 &
v
è{
m_mr
.
	`»£t
(
Ãw
 
	`MÚtgom”yR•»£Á©iÚ
(v));}

26 cÚ¡ 
IÁeg”
 & 
	`G‘Modulus
(ècÚ¡ { 
m_mr
->GetModulus();}

28 
´iv©e
:

29 
v®ue_±r
<
MÚtgom”yR•»£Á©iÚ
> 
m_mr
;

30 
	}
};

32 
	gNAMESPACE_END


	@mqueue.cpp

3 
	~"pch.h
"

5 #iâdeà
CRYPTOPP_IMPORTS


7 
	~"mqueue.h
"

9 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

11 
Mes§geQueue
::
	$Mes§geQueue
(
nodeSize
)

12 : 
	`m_queue
(
nodeSize
), 
	`m_Ëngths
(1, 0U), 
	$m_mes§geCouÁs
(1, 0U)

14 
	}
}

16 
size_t
 
	gMes§geQueue
::
	$CİyRªgeTo2
(
Bufã»dT¿nsfÜm©iÚ
 &
rg‘
, 
lwÜd
 &
begš
,†wÜd 
’d
, cÚ¡ 
¡d
::
¡ršg
 &
chªÃl
, 
boŞ
 
blockšg
) const

18 ià(
begš
 >ğ
	`MaxR‘r›vabË
())

21  
m_queue
.
	`CİyRªgeTo2
(
rg‘
, 
begš
, 
	`STDMIN
(
	`MaxR‘r›vabË
(), 
’d
), 
chªÃl
, 
blockšg
);

22 
	}
}

24 
size_t
 
	gMes§geQueue
::
	$T¿nsãrTo2
(
Bufã»dT¿nsfÜm©iÚ
 &
rg‘
, 
lwÜd
 &
ŒªsãrBy‹s
, cÚ¡ 
¡d
::
¡ršg
 &
chªÃl
, 
boŞ
 
blockšg
)

26 
ŒªsãrBy‹s
 = 
	`STDMIN
(
	`MaxR‘r›vabË
(),ransferBytes);

27 
size_t
 
blockedBy‹s
 = 
m_queue
.
	`T¿nsãrTo2
(
rg‘
, 
ŒªsãrBy‹s
, 
chªÃl
, 
blockšg
);

28 
m_Ëngths
.
	`äÚt
(è-ğ
ŒªsãrBy‹s
;

29  
blockedBy‹s
;

30 
	}
}

32 
boŞ
 
	gMes§geQueue
::
	$G‘NextMes§ge
()

34 ià(
	`Numb”OfMes§ges
(è> 0 && !
	`AnyR‘r›vabË
())

36 
m_Ëngths
.
	`pİ_äÚt
();

37 ià(
m_mes§geCouÁs
[0] =ğ0 && m_mes§geCouÁs.
	`size
() > 1)

38 
m_mes§geCouÁs
.
	`pİ_äÚt
();

39  
Œue
;

42  
çl£
;

43 
	}
}

45 
	gMes§geQueue
::
	$CİyMes§gesTo
(
Bufã»dT¿nsfÜm©iÚ
 &
rg‘
, 
couÁ
, cÚ¡ 
¡d
::
¡ršg
 &
chªÃl
) const

47 
By‹Queue
::
W®k”
 
	`w®k”
(
m_queue
);

48 
¡d
::
deque
<
lwÜd
>::
cÚ¡_™”©Ü
 
™
 = 
m_Ëngths
.
	`begš
();

49 
i
;

50 
i
=0; i<
couÁ
 && 
™
 !ğ--
m_Ëngths
.
	`’d
(); ++i, ++it)

52 
w®k”
.
	`T¿nsãrTo
(
rg‘
, *
™
, 
chªÃl
);

53 ià(
	`G‘AutoSigÇlPrİag©iÚ
())

54 
rg‘
.
	`ChªÃlMes§geEnd
(
chªÃl
, 
	`G‘AutoSigÇlPrİag©iÚ
()-1);

56  
i
;

57 
	}
}

59 
	gMes§geQueue
::
	$sw­
(
Mes§geQueue
 &
rhs
)

61 
m_queue
.
	`sw­
(
rhs
.m_queue);

62 
m_Ëngths
.
	`sw­
(
rhs
.m_lengths);

63 
	}
}

65 cÚ¡ 
by‹
 * 
	gMes§geQueue
::
	$Spy
(
size_t
 &
cÚtiguousSize
) const

67 cÚ¡ 
by‹
 *
»suÉ
 = 
m_queue
.
	`Spy
(
cÚtiguousSize
);

68 
cÚtiguousSize
 = 
	`UnsigÃdMš
(cÚtiguousSize, 
	`MaxR‘r›vabË
());

69  
»suÉ
;

70 
	}
}

74 
	gEqu®™yCom·risÚF‹r
::
	$M­ChªÃl
(cÚ¡ 
¡d
::
¡ršg
 &
chªÃl
) const

76 ià(
chªÃl
 =ğ
m_fœ¡ChªÃl
)

78 ià(
chªÃl
 =ğ
m_£cÚdChªÃl
)

82 
	}
}

84 
size_t
 
	gEqu®™yCom·risÚF‹r
::
	$ChªÃlPut2
(cÚ¡ 
¡d
::
¡ršg
 &
chªÃl
, cÚ¡ 
by‹
 *
šSŒšg
, 
size_t
 
Ëngth
, 
mes§geEnd
, 
boŞ
 
blockšg
)

86 ià(!
blockšg
)

87 
throw
 
	`BlockšgIÅutOÆy
("EqualityComparisonFilter");

89 
i
 = 
	`M­ChªÃl
(
chªÃl
);

91 ià(
i
 == 2)

92  
	`Ouut
(3, 
šSŒšg
, 
Ëngth
, 
mes§geEnd
, 
blockšg
, 
chªÃl
);

93 ià(
m_mism©chD‘eùed
)

97 
Mes§geQueue
 &
q1
 = 
m_q
[
i
], &
q2
 = m_q[1-i];

99 ià(
q2
.
	`AnyMes§ges
(è&& q2.
	`MaxR‘r›vabË
(è< 
Ëngth
)

100 
mism©ch
;

102 
Ëngth
 > 0 && 
q2
.
	`AnyR‘r›vabË
())

104 
size_t
 
Ën
 = 
Ëngth
;

105 cÚ¡ 
by‹
 *
d©a
 = 
q2
.
	`Spy
(
Ën
);

106 
Ën
 = 
	`STDMIN
Ö’, 
Ëngth
);

107 ià(
	`memcmp
(
šSŒšg
, 
d©a
, 
Ën
) != 0)

108 
mism©ch
;

109 
šSŒšg
 +ğ
Ën
;

110 
Ëngth
 -ğ
Ën
;

111 
q2
.
	`Sk
(
Ën
);

114 
q1
.
	`Put
(
šSŒšg
, 
Ëngth
);

116 ià(
mes§geEnd
)

118 ià(
q2
.
	`AnyR‘r›vabË
())

119 
mism©ch
;

120 ià(
q2
.
	`AnyMes§ges
())

121 
q2
.
	`G‘NextMes§ge
();

122 ià(
q2
.
	`Numb”OfMes§geS”›s
() > 0)

123 
mism©ch
;

125 
q1
.
	`Mes§geEnd
();

130 
mism©ch
:

131  
	`HªdËMism©chD‘eùed
(
blockšg
);

133 
	}
}

135 
boŞ
 
	gEqu®™yCom·risÚF‹r
::
	$ChªÃlMes§geS”›sEnd
(cÚ¡ 
¡d
::
¡ršg
 &
chªÃl
, 
´İag©iÚ
, 
boŞ
 
blockšg
)

137 
i
 = 
	`M­ChªÃl
(
chªÃl
);

139 ià(
i
 == 2)

141 
	`OuutMes§geS”›sEnd
(4, 
´İag©iÚ
, 
blockšg
, 
chªÃl
);

142  
çl£
;

144 ià(
m_mism©chD‘eùed
)

145  
çl£
;

148 
Mes§geQueue
 &
q1
 = 
m_q
[
i
], &
q2
 = m_q[1-i];

150 ià(
q2
.
	`AnyR‘r›vabË
(è|| q2.
	`AnyMes§ges
())

151 
mism©ch
;

152 ià(
q2
.
	`Numb”OfMes§geS”›s
() > 0)

153  
	`Ouut
(2, (cÚ¡ 
by‹
 *)"\1", 1, 0, 
blockšg
) != 0;

155 
q1
.
	`Mes§geS”›sEnd
();

157  
çl£
;

159 
mism©ch
:

160  
	`HªdËMism©chD‘eùed
(
blockšg
);

162 
	}
}

164 
boŞ
 
	gEqu®™yCom·risÚF‹r
::
	$HªdËMism©chD‘eùed
(
boŞ
 
blockšg
)

166 
m_mism©chD‘eùed
 = 
Œue
;

167 ià(
m_throwIfNÙEqu®
)

168 
throw
 
	`Mism©chD‘eùed
();

169  
	`Ouut
(1, (cÚ¡ 
by‹
 *)"\0", 1, 0, 
blockšg
) != 0;

170 
	}
}

172 
	gNAMESPACE_END


	@mqueue.h

1 #iâdeà
CRYPTOPP_MQUEUE_H


2 
	#CRYPTOPP_MQUEUE_H


	)

4 
	~"queue.h
"

5 
	~"f‹rs.h
"

6 
	~<deque
>

8 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

11 
şass
 
CRYPTOPP_DLL
 
Mes§geQueue
 : 
public
 
AutoSigÇlšg
<
Bufã»dT¿nsfÜm©iÚ
>

13 
public
:

14 
	`Mes§geQueue
(
nodeSize
=256);

16 
	`IsŞ©edIn™Ÿlize
(cÚ¡ 
NameV®uePaœs
 &
·¿m‘”s
)

17 {
m_queue
.
	`IsŞ©edIn™Ÿlize
(
·¿m‘”s
); 
m_Ëngths
.
	`assign
(1, 0U); 
m_mes§geCouÁs
.assign(1, 0U);}

18 
size_t
 
	`Put2
(cÚ¡ 
by‹
 *
begš
, size_ˆ
Ëngth
, 
mes§geEnd
, 
boŞ
 
blockšg
)

20 
m_queue
.
	`Put
(
begš
, 
Ëngth
);

21 
m_Ëngths
.
	`back
(è+ğ
Ëngth
;

22 ià(
mes§geEnd
)

24 
m_Ëngths
.
	`push_back
(0);

25 
m_mes§geCouÁs
.
	`back
()++;

29 
boŞ
 
	`IsŞ©edFlush
(boŞ 
h¬dFlush
, boŞ 
blockšg
è{ 
çl£
;}

30 
boŞ
 
	`IsŞ©edMes§geS”›sEnd
(boŞ 
blockšg
)

31 {
m_mes§geCouÁs
.
	`push_back
(0);  
çl£
;}

33 
lwÜd
 
	`MaxR‘r›vabË
() const

34 { 
m_Ëngths
.
	`äÚt
();}

35 
boŞ
 
	`AnyR‘r›vabË
() const

36 { 
m_Ëngths
.
	`äÚt
() > 0;}

38 
size_t
 
	`T¿nsãrTo2
(
Bufã»dT¿nsfÜm©iÚ
 &
rg‘
, 
lwÜd
 &
ŒªsãrBy‹s
, cÚ¡ 
¡d
::
¡ršg
 &
chªÃl
=
DEFAULT_CHANNEL
, 
boŞ
 
blockšg
=
Œue
);

39 
size_t
 
	`CİyRªgeTo2
(
Bufã»dT¿nsfÜm©iÚ
 &
rg‘
, 
lwÜd
 &
begš
,†wÜd 
’d
=
LWORD_MAX
, cÚ¡ 
¡d
::
¡ršg
 &
chªÃl
=
DEFAULT_CHANNEL
, 
boŞ
 
blockšg
=
Œue
) const;

41 
lwÜd
 
	`TÙ®By‹sR‘r›vabË
() const

42 { 
m_queue
.
	`MaxR‘r›vabË
();}

43 
	`Numb”OfMes§ges
() const

44 { ()
m_Ëngths
.
	`size
()-1;}

45 
boŞ
 
	`G‘NextMes§ge
();

47 
	`Numb”OfMes§gesInThisS”›s
() const

48 { 
m_mes§geCouÁs
[0];}

49 
	`Numb”OfMes§geS”›s
() const

50 { ()
m_mes§geCouÁs
.
	`size
()-1;}

52 
	`CİyMes§gesTo
(
Bufã»dT¿nsfÜm©iÚ
 &
rg‘
, 
couÁ
=
UINT_MAX
, cÚ¡ 
¡d
::
¡ršg
 &
chªÃl
=
DEFAULT_CHANNEL
) const;

54 cÚ¡ 
by‹
 * 
	`Spy
(
size_t
 &
cÚtiguousSize
) const;

56 
	`sw­
(
Mes§geQueue
 &
rhs
);

58 
´iv©e
:

59 
By‹Queue
 
m_queue
;

60 
¡d
::
deque
<
lwÜd
> 
m_Ëngths
;

61 
¡d
::
deque
<> 
m_mes§geCouÁs
;

62 
	}
};

66 
şass
 
CRYPTOPP_DLL
 
	gEqu®™yCom·risÚF‹r
 : 
public
 
UnæushabË
<
MuÉichªÃl
<
F‹r
> >

68 
public
:

69 
Mism©chD‘eùed
 : 
public
 
Exû±iÚ
 {Mism©chD‘eùed(è: Exû±iÚ(
DATA_INTEGRITY_CHECK_FAILED
, "EqualityComparisonFilter: did‚ot„eceivehe same data onwo channels") {}};

72 
Equ®™yCom·risÚF‹r
(
Bufã»dT¿nsfÜm©iÚ
 *
©chm’t
=
NULL
, 
boŞ
 
throwIfNÙEqu®
=
Œue
, cÚ¡ 
¡d
::
¡ršg
 &
fœ¡ChªÃl
="0", cÚ¡ std::¡ršg &
£cÚdChªÃl
="1")

73 : 
m_throwIfNÙEqu®
(
throwIfNÙEqu®
), 
m_mism©chD‘eùed
(
çl£
)

74 , 
m_fœ¡ChªÃl
(
fœ¡ChªÃl
), 
m_£cÚdChªÃl
(
£cÚdChªÃl
)

75 {
D‘ach
(
©chm’t
);}

77 
size_t
 
ChªÃlPut2
(cÚ¡ 
¡d
::
¡ršg
 &
chªÃl
, cÚ¡ 
by‹
 *
begš
, size_ˆ
Ëngth
, 
mes§geEnd
, 
boŞ
 
blockšg
);

78 
boŞ
 
ChªÃlMes§geS”›sEnd
(cÚ¡ 
¡d
::
¡ršg
 &
chªÃl
, 
´İag©iÚ
=-1, boŞ 
blockšg
=
Œue
);

80 
	g´iv©e
:

81 
M­ChªÃl
(cÚ¡ 
¡d
::
¡ršg
 &
chªÃl
) const;

82 
boŞ
 
HªdËMism©chD‘eùed
(boŞ 
blockšg
);

84 
boŞ
 
	gm_throwIfNÙEqu®
, 
	gm_mism©chD‘eùed
;

85 
	g¡d
::
¡ršg
 
m_fœ¡ChªÃl
, 
	gm_£cÚdChªÃl
;

86 
Mes§geQueue
 
	gm_q
[2];

89 
	gNAMESPACE_END


91 #iâdeà
__BORLANDC__


92 
	$NAMESPACE_BEGIN
(
¡d
)

93 
‹m¶©e
<> 
šlše
 
	$sw­
(
Cry±oPP
::
Mes§geQueue
 &
a
, Cry±oPP::Mes§geQueu&
b
)

95 
a
.
	`sw­
(
b
);

96 
	}
}

97 
	gNAMESPACE_END


	@mqv.cpp

3 
	~"pch.h
"

4 
	~"mqv.h
"

6 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

8 
	$Te¡In¡ªtŸtiÚs_MQV
()

10 
MQV
 
mqv
;

11 
	}
}

13 
	gNAMESPACE_END


	@mqv.h

1 #iâdeà
CRYPTOPP_MQV_H


2 
	#CRYPTOPP_MQV_H


	)

7 
	~"gåüy±.h
"

9 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

12 
‹m¶©e
 <
şass
 
GROUP_PARAMETERS
, cÏs 
COFACTOR_OPTION
 = 
CPP_TYPENAME
 GROUP_PARAMETERS::
DeçuÉCoçùÜO±iÚ
>

13 şas 
	cMQV_Domaš
 : 
public
 
Auth’tiÿ‹dKeyAg»em’tDomaš


15 
public
:

16 
GROUP_PARAMETERS
 
	tGroupP¬am‘”s
;

17 
ty³Çme
 
	tGroupP¬am‘”s
::
	tEËm’t
 Element;

18 
MQV_Domaš
<
	tGROUP_PARAMETERS
, 
	tCOFACTOR_OPTION
> 
	tDomaš
;

20 
	$MQV_Domaš
() {}

22 
	$MQV_Domaš
(cÚ¡ 
GroupP¬am‘”s
 &
·¿ms
)

23 : 
	$m_groupP¬am‘”s
(
·¿ms
è{
	}
}

25 
	$MQV_Domaš
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
)

26 {
m_groupP¬am‘”s
.
	`BERDecode
(
bt
);
	}
}

28 
	g‹m¶©e
 <
şass
 
	gT1
, cÏs 
	gT2
>

29 
	$MQV_Domaš
(
T1
 
v1
, 
T2
 
v2
)

30 {
m_groupP¬am‘”s
.
	`In™Ÿlize
(
v1
, 
v2
);
	}
}

32 
	g‹m¶©e
 <
şass
 
	gT1
, cÏs 
	gT2
, cÏs 
	gT3
>

33 
	$MQV_Domaš
(
T1
 
v1
, 
T2
 
v2
, 
T3
 
v3
)

34 {
m_groupP¬am‘”s
.
	`In™Ÿlize
(
v1
, 
v2
, 
v3
);
	}
}

36 
	g‹m¶©e
 <
şass
 
	gT1
, cÏs 
	gT2
, cÏs 
	gT3
, cÏs 
	gT4
>

37 
	$MQV_Domaš
(
T1
 
v1
, 
T2
 
v2
, 
T3
 
v3
, 
T4
 
v4
)

38 {
m_groupP¬am‘”s
.
	`In™Ÿlize
(
v1
, 
v2
, 
v3
, 
v4
);
	}
}

40 cÚ¡ 
	gGroupP¬am‘”s
 & 
	$G‘GroupP¬am‘”s
(ècÚ¡ { 
m_groupP¬am‘”s
;
	}
}

41 
	gGroupP¬am‘”s
 & 
	$AcûssGroupP¬am‘”s
(è{ 
m_groupP¬am‘”s
;
	}
}

43 
	gCry±oP¬am‘”s
 & 
	$AcûssCry±oP¬am‘”s
(è{ 
	`AcûssAb¡¿ùGroupP¬am‘”s
();
	}
}

45 
	$Ag»edV®ueL’gth
(ècÚ¡ { 
	`G‘Ab¡¿ùGroupP¬am‘”s
().
	`G‘EncodedEËm’tSize
(
çl£
);
	}
}

46 
	$SticPriv©eKeyL’gth
(ècÚ¡ { 
	`G‘Ab¡¿ùGroupP¬am‘”s
().
	`G‘SubgroupOrd”
().
	`By‹CouÁ
();
	}
}

47 
	$SticPublicKeyL’gth
(ècÚ¡ { 
	`G‘Ab¡¿ùGroupP¬am‘”s
().
	`G‘EncodedEËm’tSize
(
Œue
);
	}
}

49 
	$G’”©eSticPriv©eKey
(
RªdomNumb”G’”©Ü
 &
ºg
, 
by‹
 *
´iv©eKey
) const

51 
IÁeg”
 
	`x
(
ºg
, IÁeg”::
	`OÃ
(), 
	`G‘Ab¡¿ùGroupP¬am‘”s
().
	`G‘MaxExpÚ’t
());

52 
x
.
	`Encode
(
´iv©eKey
, 
	`SticPriv©eKeyL’gth
());

53 
	}
}

55 
	$G’”©eSticPublicKey
(
RªdomNumb”G’”©Ü
 &
ºg
, cÚ¡ 
by‹
 *
´iv©eKey
, by‹ *
publicKey
) const

57 cÚ¡ 
DL_GroupP¬am‘”s
<
EËm’t
> &
·¿ms
 = 
	`G‘Ab¡¿ùGroupP¬am‘”s
();

58 
IÁeg”
 
	`x
(
´iv©eKey
, 
	`SticPriv©eKeyL’gth
());

59 
EËm’t
 
y
 = 
·¿ms
.
	`ExpÚ’tŸ‹Ba£
(
x
);

60 
·¿ms
.
	`EncodeEËm’t
(
Œue
, 
y
, 
publicKey
);

61 
	}
}

63 
	$Ephem”®Priv©eKeyL’gth
(ècÚ¡ { 
	`SticPriv©eKeyL’gth
(è+ 
	`SticPublicKeyL’gth
();
	}
}

64 
	$Ephem”®PublicKeyL’gth
(ècÚ¡ { 
	`SticPublicKeyL’gth
();
	}
}

66 
	$G’”©eEphem”®Priv©eKey
(
RªdomNumb”G’”©Ü
 &
ºg
, 
by‹
 *
´iv©eKey
) const

68 cÚ¡ 
DL_GroupP¬am‘”s
<
EËm’t
> &
·¿ms
 = 
	`G‘Ab¡¿ùGroupP¬am‘”s
();

69 
IÁeg”
 
	`x
(
ºg
, IÁeg”::
	`OÃ
(), 
·¿ms
.
	`G‘MaxExpÚ’t
());

70 
x
.
	`Encode
(
´iv©eKey
, 
	`SticPriv©eKeyL’gth
());

71 
EËm’t
 
y
 = 
·¿ms
.
	`ExpÚ’tŸ‹Ba£
(
x
);

72 
·¿ms
.
	`EncodeEËm’t
(
Œue
, 
y
, 
´iv©eKey
+
	`SticPriv©eKeyL’gth
());

73 
	}
}

75 
	$G’”©eEphem”®PublicKey
(
RªdomNumb”G’”©Ü
 &
ºg
, cÚ¡ 
by‹
 *
´iv©eKey
, by‹ *
publicKey
) const

77 
	`memıy
(
publicKey
, 
´iv©eKey
+
	`SticPriv©eKeyL’gth
(), 
	`Ephem”®PublicKeyL’gth
());

78 
	}
}

80 
boŞ
 
	$Ag»e
(
by‹
 *
ag»edV®ue
,

81 cÚ¡ 
by‹
 *
¡©icPriv©eKey
, cÚ¡ by‹ *
•hem”®Priv©eKey
,

82 cÚ¡ 
by‹
 *
¡©icOth”PublicKey
, cÚ¡ by‹ *
•hem”®Oth”PublicKey
,

83 
boŞ
 
v®id©eSticOth”PublicKey
=
Œue
) const

85 
Œy


87 cÚ¡ 
DL_GroupP¬am‘”s
<
EËm’t
> &
·¿ms
 = 
	`G‘Ab¡¿ùGroupP¬am‘”s
();

88 
EËm’t
 
WW
 = 
·¿ms
.
	`DecodeEËm’t
(
¡©icOth”PublicKey
, 
v®id©eSticOth”PublicKey
);

89 
EËm’t
 
VV
 = 
·¿ms
.
	`DecodeEËm’t
(
•hem”®Oth”PublicKey
, 
Œue
);

91 
IÁeg”
 
	`s
(
¡©icPriv©eKey
, 
	`SticPriv©eKeyL’gth
());

92 
IÁeg”
 
	`u
(
•hem”®Priv©eKey
, 
	`SticPriv©eKeyL’gth
());

93 
EËm’t
 
V
 = 
·¿ms
.
	`DecodeEËm’t
(
•hem”®Priv©eKey
+
	`SticPriv©eKeyL’gth
(), 
çl£
);

95 cÚ¡ 
IÁeg”
 &
r
 = 
·¿ms
.
	`G‘SubgroupOrd”
();

96 
IÁeg”
 
h2
 = IÁeg”::
	`Pow”2
((
r
.
	`B™CouÁ
()+1)/2);

97 
IÁeg”
 
e
 = ((
h2
+
·¿ms
.
	`CÚv”tEËm’tToIÁeg”
(
V
)%h2)*
s
+
u
è% 
r
;

98 
IÁeg”
 
‰
 = 
h2
 + 
·¿ms
.
	`CÚv”tEËm’tToIÁeg”
(
VV
) % h2;

100 ià(
COFACTOR_OPTION
::
	`ToEnum
(è=ğ
NO_COFACTOR_MULTIPLICTION
)

102 
EËm’t
 
P
 = 
·¿ms
.
	`ExpÚ’tŸ‹EËm’t
(
WW
, 
‰
);

103 
P
 = 
m_groupP¬am‘”s
.
	`MuÉlyEËm’ts
(P, 
VV
);

104 
EËm’t
 
R
[2];

105 cÚ¡ 
IÁeg”
 
e2
[2] = {
r
, 
e
};

106 
·¿ms
.
	`SimuÉªeousExpÚ’tŸ‹
(
R
, 
P
, 
e2
, 2);

107 ià(!
·¿ms
.
	`IsId’t™y
(
R
[0]) ||…arams.IsIdentity(R[1]))

108  
çl£
;

109 
·¿ms
.
	`EncodeEËm’t
(
çl£
, 
R
[1], 
ag»edV®ue
);

113 cÚ¡ 
IÁeg”
 &
k
 = 
·¿ms
.
	`G‘CoçùÜ
();

114 ià(
COFACTOR_OPTION
::
	`ToEnum
(è=ğ
COMPATIBLE_COFACTOR_MULTIPLICTION
)

115 
e
 = 
	`ModuÏrAr™hm‘ic
(
r
).
	`Divide
Ó, 
k
);

116 
EËm’t
 
P
 = 
m_groupP¬am‘”s
.
	`CasÿdeExpÚ’tŸ‹
(
VV
, 
k
*
e
, 
WW
, k*Ó*
‰
%
r
));

117 ià(
·¿ms
.
	`IsId’t™y
(
P
))

118  
çl£
;

119 
·¿ms
.
	`EncodeEËm’t
(
çl£
, 
P
, 
ag»edV®ue
);

122 
	`ÿtch
 (
DL_BadEËm’t
 &)

124  
çl£
;

126  
Œue
;

127 
	}
}

129 
	g´iv©e
:

130 
DL_GroupP¬am‘”s
<
EËm’t
> & 
	$AcûssAb¡¿ùGroupP¬am‘”s
(è{ 
m_groupP¬am‘”s
;
	}
}

131 cÚ¡ 
	gDL_GroupP¬am‘”s
<
	gEËm’t
> & 
	$G‘Ab¡¿ùGroupP¬am‘”s
(ècÚ¡ { 
m_groupP¬am‘”s
;
	}
}

133 
GroupP¬am‘”s
 
	gm_groupP¬am‘”s
;

137 
	gMQV_Domaš
<
	tDL_GroupP¬am‘”s_GFP_DeçuÉSaãPrime
> 
	tMQV
;

139 
	gNAMESPACE_END


	@nbtheory.cpp

3 
	~"pch.h
"

5 #iâdeà
CRYPTOPP_IMPORTS


7 
	~"nbtheÜy.h
"

8 
	~"mod¬™h.h
"

9 
	~"®g·¿m.h
"

11 
	~<m©h.h
>

12 
	~<veùÜ
>

14 #ifdeà
_OPENMP


16 
	~<omp.h
>

19 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

21 cÚ¡ 
wÜd
 
s_Ï¡Sm®lPrime
 = 32719;

23 
	sNewPrimeTabË


25 
¡d
::
veùÜ
<
wÜd16
> * 
	`İ”©Ü
()() const

27 cÚ¡ 
maxPrimeTabËSize
 = 3511;

29 
¡d
::
auto_±r
<¡d::
veùÜ
<
wÜd16
> > 
	`pPrimeTabË
(
Ãw
 std::vector<word16>);

30 
¡d
::
veùÜ
<
wÜd16
> &
´imeTabË
 = *
pPrimeTabË
;

31 
´imeTabË
.
	`»£rve
(
maxPrimeTabËSize
);

33 
´imeTabË
.
	`push_back
(2);

34 
‹¡EÁr›sEnd
 = 1;

36 
p
=3;…<=
s_Ï¡Sm®lPrime
;…+=2)

38 
j
;

39 
j
=1; j<
‹¡EÁr›sEnd
; j++)

40 ià(
p
%
´imeTabË
[
j
] == 0)

42 ià(
j
 =ğ
‹¡EÁr›sEnd
)

44 
´imeTabË
.
	`push_back
(
p
);

45 
‹¡EÁr›sEnd
 = 
	`UnsigÃdMš
(54U, 
´imeTabË
.
	`size
());

49  
pPrimeTabË
.
	`»Ëa£
();

53 cÚ¡ 
wÜd16
 * 
	$G‘PrimeTabË
(&
size
)

55 cÚ¡ 
¡d
::
veùÜ
<
wÜd16
> &
´imeTabË
 = 
SšgËtÚ
<¡d::veùÜ<wÜd16>, 
NewPrimeTabË
>().
	`Ref
();

56 
size
 = ()
´imeTabË
.
	`size
();

57  &
´imeTabË
[0];

58 
	}
}

60 
boŞ
 
	$IsSm®lPrime
(cÚ¡ 
IÁeg”
 &
p
)

62 
´imeTabËSize
;

63 cÚ¡ 
wÜd16
 * 
´imeTabË
 = 
	`G‘PrimeTabË
(
´imeTabËSize
);

65 ià(
p
.
	`IsPos™ive
(è&&… <ğ
´imeTabË
[
´imeTabËSize
-1])

66  
¡d
::
	`bš¬y_£¬ch
(
´imeTabË
,…rimeTabË+
´imeTabËSize
, (
wÜd16
)
p
.
	`CÚv”tToLÚg
());

68  
çl£
;

69 
	}
}

71 
boŞ
 
	$TrŸlDivisiÚ
(cÚ¡ 
IÁeg”
 &
p
, 
bound
)

73 
´imeTabËSize
;

74 cÚ¡ 
wÜd16
 * 
´imeTabË
 = 
	`G‘PrimeTabË
(
´imeTabËSize
);

76 
	`as£¹
(
´imeTabË
[
´imeTabËSize
-1] >ğ
bound
);

78 
i
;

79 
i
 = 0; 
´imeTabË
[i]<
bound
; i++)

80 ià((
p
 % 
´imeTabË
[
i
]) == 0)

81  
Œue
;

83 ià(
bound
 =ğ
´imeTabË
[
i
])

84  (
p
 % 
bound
 == 0);

86  
çl£
;

87 
	}
}

89 
boŞ
 
	$Sm®lDivisÜsTe¡
(cÚ¡ 
IÁeg”
 &
p
)

91 
´imeTabËSize
;

92 cÚ¡ 
wÜd16
 * 
´imeTabË
 = 
	`G‘PrimeTabË
(
´imeTabËSize
);

93  !
	`TrŸlDivisiÚ
(
p
, 
´imeTabË
[
´imeTabËSize
-1]);

94 
	}
}

96 
boŞ
 
	$IsF”m©ProbabËPrime
(cÚ¡ 
IÁeg”
 &
n
, cÚ¡ IÁeg” &
b
)

98 ià(
n
 <= 3)

99  
n
==2 ||‚==3;

101 
	`as£¹
(
n
>3 && 
b
>1 && b<n-1);

102  
	`a_exp_b_mod_c
(
b
, 
n
-1,‚)==1;

103 
	}
}

105 
boŞ
 
	$IsSŒÚgProbabËPrime
(cÚ¡ 
IÁeg”
 &
n
, cÚ¡ IÁeg” &
b
)

107 ià(
n
 <= 3)

108  
n
==2 ||‚==3;

110 
	`as£¹
(
n
>3 && 
b
>1 && b<n-1);

112 ià((
n
.
	`IsEv’
(è&&‚!=2è|| 
	`GCD
(
b
,‚) != 1)

113  
çl£
;

115 
IÁeg”
 
nmšus1
 = (
n
-1);

116 
a
;

119 
a
=0; ;‡++)

120 ià(
nmšus1
.
	`G‘B™
(
a
))

122 
IÁeg”
 
m
 = 
nmšus1
>>
a
;

124 
IÁeg”
 
z
 = 
	`a_exp_b_mod_c
(
b
, 
m
, 
n
);

125 ià(
z
==1 || z==
nmšus1
)

126  
Œue
;

127 
j
=1; j<
a
; j++)

129 
z
 = z.
	`Squ¬ed
()%
n
;

130 ià(
z
==
nmšus1
)

131  
Œue
;

132 ià(
z
==1)

133  
çl£
;

135  
çl£
;

136 
	}
}

138 
boŞ
 
	$RabšMËrTe¡
(
RªdomNumb”G’”©Ü
 &
ºg
, cÚ¡ 
IÁeg”
 &
n
, 
rounds
)

140 ià(
n
 <= 3)

141  
n
==2 ||‚==3;

143 
	`as£¹
(
n
>3);

145 
IÁeg”
 
b
;

146 
i
=0; i<
rounds
; i++)

148 
b
.
	`Rªdomize
(
ºg
, 2, 
n
-2);

149 ià(!
	`IsSŒÚgProbabËPrime
(
n
, 
b
))

150  
çl£
;

152  
Œue
;

153 
	}
}

155 
boŞ
 
	$IsLuÿsProbabËPrime
(cÚ¡ 
IÁeg”
 &
n
)

157 ià(
n
 <= 1)

158  
çl£
;

160 ià(
n
.
	`IsEv’
())

161  
n
==2;

163 
	`as£¹
(
n
>2);

165 
IÁeg”
 
b
=3;

166 
i
=0;

167 
j
;

169 (
j
=
	`Jacobi
(
b
.
	`Squ¬ed
()-4, 
n
)) == 1)

171 ià(++
i
==64 && 
n
.
	`IsSqu¬e
())

172  
çl£
;

173 ++
b
; ++b;

176 ià(
j
==0)

177  
çl£
;

179  
	`Luÿs
(
n
+1, 
b
,‚)==2;

180 
	}
}

182 
boŞ
 
	$IsSŒÚgLuÿsProbabËPrime
(cÚ¡ 
IÁeg”
 &
n
)

184 ià(
n
 <= 1)

185  
çl£
;

187 ià(
n
.
	`IsEv’
())

188  
n
==2;

190 
	`as£¹
(
n
>2);

192 
IÁeg”
 
b
=3;

193 
i
=0;

194 
j
;

196 (
j
=
	`Jacobi
(
b
.
	`Squ¬ed
()-4, 
n
)) == 1)

198 ià(++
i
==64 && 
n
.
	`IsSqu¬e
())

199  
çl£
;

200 ++
b
; ++b;

203 ià(
j
==0)

204  
çl£
;

206 
IÁeg”
 
n1
 = 
n
+1;

207 
a
;

210 
a
=0; ;‡++)

211 ià(
n1
.
	`G‘B™
(
a
))

213 
IÁeg”
 
m
 = 
n1
>>
a
;

215 
IÁeg”
 
z
 = 
	`Luÿs
(
m
, 
b
, 
n
);

216 ià(
z
==2 || z==
n
-2)

217  
Œue
;

218 
i
=1; i<
a
; i++)

220 
z
 = (z.
	`Squ¬ed
()-2)%
n
;

221 ià(
z
==
n
-2)

222  
Œue
;

223 ià(
z
==2)

224  
çl£
;

226  
çl£
;

227 
	}
}

229 
	sNewLa¡Sm®lPrimeSqu¬ed


231 
IÁeg”
 * 
İ”©Ü
()() const

233  
Ãw
 
IÁeg”
(IÁeg”(
s_Ï¡Sm®lPrime
).
Squ¬ed
());

237 
boŞ
 
	$IsPrime
(cÚ¡ 
IÁeg”
 &
p
)

239 ià(
p
 <ğ
s_Ï¡Sm®lPrime
)

240  
	`IsSm®lPrime
(
p
);

241 ià(
p
 <ğ
SšgËtÚ
<
IÁeg”
, 
NewLa¡Sm®lPrimeSqu¬ed
>().
	`Ref
())

242  
	`Sm®lDivisÜsTe¡
(
p
);

244  
	`Sm®lDivisÜsTe¡
(
p
è&& 
	`IsSŒÚgProbabËPrime
Õ, 3è&& 
	`IsSŒÚgLuÿsProbabËPrime
(p);

245 
	}
}

247 
boŞ
 
	$V”ifyPrime
(
RªdomNumb”G’”©Ü
 &
ºg
, cÚ¡ 
IÁeg”
 &
p
, 
Ëv–
)

249 
boŞ
 
·ss
 = 
	`IsPrime
(
p
è&& 
	`RabšMËrTe¡
(
ºg
,…, 1);

250 ià(
Ëv–
 >= 1)

251 
·ss
 =…as && 
	`RabšMËrTe¡
(
ºg
, 
p
, 10);

252  
·ss
;

253 
	}
}

255 
	$PrimeS—rchIÁ”v®
(cÚ¡ 
IÁeg”
 &
max
)

257  
max
.
	`B™CouÁ
();

258 
	}
}

260 
šlše
 
boŞ
 
	$Fa¡ProbabËPrimeTe¡
(cÚ¡ 
IÁeg”
 &
n
)

262  
	`IsSŒÚgProbabËPrime
(
n
,2);

263 
	}
}

265 
AlgÜ™hmP¬am‘”s
 
	$MakeP¬am‘”sFÜTwoPrimesOfEqu®Size
(
´oduùB™L’gth
)

267 ià(
´oduùB™L’gth
 < 16)

268 
throw
 
	`Inv®idArgum’t
("invalid bit†ength");

270 
IÁeg”
 
mšP
, 
maxP
;

272 ià(
´oduùB™L’gth
%2==0)

274 
mšP
 = 
	`IÁeg”
(182è<< (
´oduùB™L’gth
/2-8);

275 
maxP
 = 
IÁeg”
::
	`Pow”2
(
´oduùB™L’gth
/2)-1;

279 
mšP
 = 
IÁeg”
::
	`Pow”2
((
´oduùB™L’gth
-1)/2);

280 
maxP
 = 
	`IÁeg”
(181è<< ((
´oduùB™L’gth
+1)/2-8);

283  
	`MakeP¬am‘”s
("RªdomNumb”Ty³", 
IÁeg”
::
PRIME
)("Mš", 
mšP
)("Max", 
maxP
);

284 
	}
}

286 şas 
	cPrimeS›ve


288 
	mpublic
:

290 
PrimeS›ve
(cÚ¡ 
IÁeg”
 &
fœ¡
, cÚ¡ IÁeg” &
Ï¡
, cÚ¡ IÁeg” &
¡•
, sigÃd 
d–
=0);

291 
boŞ
 
NextCªdid©e
(
IÁeg”
 &
c
);

293 
DoS›ve
();

294 
S›veSšgË
(
¡d
::
veùÜ
<
boŞ
> &
s›ve
, 
wÜd16
 
p
, cÚ¡ 
IÁeg”
 &
fœ¡
, cÚ¡ IÁeg” &
¡•
, wÜd16 
¡•Inv
);

296 
IÁeg”
 
	mm_fœ¡
, 
	mm_Ï¡
, 
	mm_¡•
;

297 sigÃd 
	mm_d–
;

298 
wÜd
 
	mm_Ãxt
;

299 
	m¡d
::
veùÜ
<
boŞ
> 
m_s›ve
;

302 
	gPrimeS›ve
::
	$PrimeS›ve
(cÚ¡ 
IÁeg”
 &
fœ¡
, cÚ¡ IÁeg” &
Ï¡
, cÚ¡ IÁeg” &
¡•
, sigÃd 
d–
)

303 : 
	`m_fœ¡
(
fœ¡
), 
	`m_Ï¡
(
Ï¡
), 
	`m_¡•
(
¡•
), 
	`m_d–
(
d–
), 
	$m_Ãxt
(0)

305 
	`DoS›ve
();

306 
	}
}

308 
boŞ
 
	gPrimeS›ve
::
	$NextCªdid©e
(
IÁeg”
 &
c
)

310 
boŞ
 
§ã
 = 
	`SaãCÚv”t
(
¡d
::
	`fšd
(
m_s›ve
.
	`begš
()+
m_Ãxt
, m_s›ve.
	`’d
(), 
çl£
) - m_sieve.begin(), m_next);

311 
	`as£¹
(
§ã
);

312 ià(
m_Ãxt
 =ğ
m_s›ve
.
	`size
())

314 
m_fœ¡
 +ğ(
m_s›ve
.
	`size
())*
m_¡•
;

315 ià(
m_fœ¡
 > 
m_Ï¡
)

316  
çl£
;

319 
m_Ãxt
 = 0;

320 
	`DoS›ve
();

321  
	`NextCªdid©e
(
c
);

326 
c
 = 
m_fœ¡
 + (
m_Ãxt
)*
m_¡•
;

327 ++
m_Ãxt
;

328  
Œue
;

330 
	}
}

332 
	gPrimeS›ve
::
S›veSšgË
(
¡d
::
veùÜ
<
boŞ
> &
s›ve
, 
wÜd16
 
p
, cÚ¡ 
IÁeg”
 &
fœ¡
, cÚ¡ IÁeg” &
¡•
, wÜd16 
¡•Inv
)

334 ià(
	g¡•Inv
)

336 
size_t
 
	gs›veSize
 = 
s›ve
.
size
();

337 
size_t
 
	gj
 = (
wÜd32
(
p
-(
fœ¡
%p))*
¡•Inv
) %…;

339 ià(
	gfœ¡
.
WÜdCouÁ
(è<ğ1 && 
fœ¡
 + 
¡•
*(
j
è=ğ
p
)

340 
j
 +ğ
p
;

341 ; 
	gj
 < 
	gs›veSize
; j +ğ
p
)

342 
s›ve
[
j
] = 
Œue
;

346 
	gPrimeS›ve
::
	$DoS›ve
()

348 
´imeTabËSize
;

349 cÚ¡ 
wÜd16
 * 
´imeTabË
 = 
	`G‘PrimeTabË
(
´imeTabËSize
);

351 cÚ¡ 
maxS›veSize
 = 32768;

352 
s›veSize
 = 
	`STDMIN
(
	`IÁeg”
(
maxS›veSize
), (
m_Ï¡
-
m_fœ¡
)/
m_¡•
+1).
	`CÚv”tToLÚg
();

354 
m_s›ve
.
	`ş—r
();

355 
m_s›ve
.
	`»size
(
s›veSize
, 
çl£
);

357 ià(
m_d–
 == 0)

359 
i
 = 0; i < 
´imeTabËSize
; ++i)

360 
	`S›veSšgË
(
m_s›ve
, 
´imeTabË
[
i
], 
m_fœ¡
, 
m_¡•
, (
wÜd16
)m_¡•.
	`Inv”£Mod
(primeTable[i]));

364 
	`as£¹
(
m_¡•
%2==0);

365 
IÁeg”
 
qFœ¡
 = (
m_fœ¡
-
m_d–
) >> 1;

366 
IÁeg”
 
h®fS‹p
 = 
m_¡•
 >> 1;

367 
i
 = 0; i < 
´imeTabËSize
; ++i)

369 
wÜd16
 
p
 = 
´imeTabË
[
i
];

370 
wÜd16
 
¡•Inv
 = (wÜd16)
m_¡•
.
	`Inv”£Mod
(
p
);

371 
	`S›veSšgË
(
m_s›ve
, 
p
, 
m_fœ¡
, 
m_¡•
, 
¡•Inv
);

373 
wÜd16
 
h®fS‹pInv
 = 2*
¡•Inv
 < 
p
 ? 2*stepInv : 2*stepInv-p;

374 
	`S›veSšgË
(
m_s›ve
, 
p
, 
qFœ¡
, 
h®fS‹p
, 
h®fS‹pInv
);

377 
	}
}

379 
boŞ
 
	$Fœ¡Prime
(
IÁeg”
 &
p
, cÚ¡ IÁeg” &
max
, cÚ¡ IÁeg” &
equiv
, cÚ¡ IÁeg” &
mod
, cÚ¡ 
PrimeS–eùÜ
 *
pS–eùÜ
)

381 
	`as£¹
(!
equiv
.
	`IsNeg©ive
(è&&ƒquiv < 
mod
);

383 
IÁeg”
 
gcd
 = 
	`GCD
(
equiv
, 
mod
);

384 ià(
gcd
 !ğ
IÁeg”
::
	`OÃ
())

387 ià(
p
 <ğ
gcd
 && gcd <ğ
max
 && 
	`IsPrime
(gcdè&& (!
pS–eùÜ
 ||…S–eùÜ->
	`IsAcû±abË
(gcd)))

389 
p
 = 
gcd
;

390  
Œue
;

393  
çl£
;

396 
´imeTabËSize
;

397 cÚ¡ 
wÜd16
 * 
´imeTabË
 = 
	`G‘PrimeTabË
(
´imeTabËSize
);

399 ià(
p
 <ğ
´imeTabË
[
´imeTabËSize
-1])

401 cÚ¡ 
wÜd16
 *
pIŒ
;

403 --
p
;

404 ià(
p
.
	`IsPos™ive
())

405 
pIŒ
 = 
¡d
::
	`uµ”_bound
(
´imeTabË
,…rimeTabË+
´imeTabËSize
, (
wÜd
)
p
.
	`CÚv”tToLÚg
());

407 
pIŒ
 = 
´imeTabË
;

409 
pIŒ
 < 
´imeTabË
+
´imeTabËSize
 && !(*pIŒ%
mod
 =ğ
equiv
 && (!
pS–eùÜ
 ||…S–eùÜ->
	`IsAcû±abË
(*pItr))))

410 ++
pIŒ
;

412 ià(
pIŒ
 < 
´imeTabË
+
´imeTabËSize
)

414 
p
 = *
pIŒ
;

415  
p
 <ğ
max
;

418 
p
 = 
´imeTabË
[
´imeTabËSize
-1]+1;

421 
	`as£¹
(
p
 > 
´imeTabË
[
´imeTabËSize
-1]);

423 ià(
mod
.
	`IsOdd
())

424  
	`Fœ¡Prime
(
p
, 
max
, 
	`CRT
(
equiv
, 
mod
, 1, 2, 1), mod<<1, 
pS–eùÜ
);

426 
p
 +ğ(
equiv
-p)%
mod
;

428 ià(
p
>
max
)

429  
çl£
;

431 
PrimeS›ve
 
	`s›ve
(
p
, 
max
, 
mod
);

433 
s›ve
.
	`NextCªdid©e
(
p
))

435 ià((!
pS–eùÜ
 ||…S–eùÜ->
	`IsAcû±abË
(
p
)è&& 
	`Fa¡ProbabËPrimeTe¡
Õè&& 
	`IsPrime
(p))

436  
Œue
;

439  
çl£
;

440 
	}
}

443 
boŞ
 
	$ProvePrime
(cÚ¡ 
IÁeg”
 &
p
, cÚ¡ IÁeg” &
q
)

445 
	`as£¹
(
p
 < 
q
*q*q);

446 
	`as£¹
(
p
 % 
q
 == 1);

453 
IÁeg”
 
r
 = (
p
-1)/
q
;

454 ià(((
r
%
q
).
	`Squ¬ed
()-4*Ô/q)).
	`IsSqu¬e
())

455  
çl£
;

457 
´imeTabËSize
;

458 cÚ¡ 
wÜd16
 * 
´imeTabË
 = 
	`G‘PrimeTabË
(
´imeTabËSize
);

460 
	`as£¹
(
´imeTabËSize
 >= 50);

461 
i
=0; i<50; i++)

463 
IÁeg”
 
b
 = 
	`a_exp_b_mod_c
(
´imeTabË
[
i
], 
r
, 
p
);

464 ià(
b
 != 1)

465  
	`a_exp_b_mod_c
(
b
, 
q
, 
p
) == 1;

467  
çl£
;

468 
	}
}

470 
IÁeg”
 
	$MihaescuProvabËPrime
(
RªdomNumb”G’”©Ü
 &
ºg
, 
pb™s
)

472 
IÁeg”
 
p
;

473 
IÁeg”
 
mšP
 = IÁeg”::
	`Pow”2
(
pb™s
-1);

474 
IÁeg”
 
maxP
 = IÁeg”::
	`Pow”2
(
pb™s
) - 1;

476 ià(
maxP
 <ğ
	`IÁeg”
(
s_Ï¡Sm®lPrime
).
	`Squ¬ed
())

479 
p
.
	`Rªdomize
(
ºg
, 
mšP
, 
maxP
, 
IÁeg”
::
PRIME
);

480  
p
;

483 
qb™s
 = (
pb™s
+2)/3 + 1 + 
ºg
.
	`G’”©eWÜd32
(0,…bits/36);

484 
IÁeg”
 
q
 = 
	`MihaescuProvabËPrime
(
ºg
, 
qb™s
);

485 
IÁeg”
 
q2
 = 
q
<<1;

487 
Œue
)

496 
p
.
	`Rªdomize
(
ºg
, 
mšP
, 
maxP
, 
IÁeg”
::
ANY
, 1, 
q2
);

497 
PrimeS›ve
 
	`s›ve
(
p
, 
	`STDMIN
Õ+
	`PrimeS—rchIÁ”v®
(
maxP
)*
q2
, maxP), q2);

499 
s›ve
.
	`NextCªdid©e
(
p
))

501 ià(
	`Fa¡ProbabËPrimeTe¡
(
p
è&& 
	`ProvePrime
Õ, 
q
))

502  
p
;

507  
p
;

508 
	}
}

510 
IÁeg”
 
	$Mau»rProvabËPrime
(
RªdomNumb”G’”©Ü
 &
ºg
, 
b™s
)

512 cÚ¡ 
sm®lPrimeBound
 = 29, 
c_İt
=10;

513 
IÁeg”
 
p
;

515 
´imeTabËSize
;

516 cÚ¡ 
wÜd16
 * 
´imeTabË
 = 
	`G‘PrimeTabË
(
´imeTabËSize
);

518 ià(
b™s
 < 
sm®lPrimeBound
)

521 
p
.
	`Rªdomize
(
ºg
, 
IÁeg”
::
	`Pow”2
(
b™s
-1), IÁeg”::Pow”2(b™s)-1, IÁeg”::
ANY
, 1, 2);

522 
	`TrŸlDivisiÚ
(
p
, 1 << ((
b™s
+1)/2)));

526 cÚ¡ 
m¬gš
 = 
b™s
 > 50 ? 20 : (bits-10)/2;

527 
»ÏtiveSize
;

529 
»ÏtiveSize
 = 
	`pow
(2.0, (
ºg
.
	`G’”©eWÜd32
())/0xffffffff - 1);

530 
b™s
 * 
»ÏtiveSize
 >ğb™ - 
m¬gš
);

532 
IÁeg”
 
a
,
b
;

533 
IÁeg”
 
q
 = 
	`Mau»rProvabËPrime
(
ºg
, (
b™s
*
»ÏtiveSize
));

534 
IÁeg”
 
I
 = IÁeg”::
	`Pow”2
(
b™s
-2)/
q
;

535 
IÁeg”
 
I2
 = 
I
 << 1;

536 
ŒŸlDivisÜBound
 = ()
	`STDMIN
(()
´imeTabË
[
´imeTabËSize
-1], ()
b™s
*b™s/
c_İt
);

537 
boŞ
 
sucûss
 = 
çl£
;

538 !
sucûss
)

540 
p
.
	`Rªdomize
(
ºg
, 
I
, 
I2
, 
IÁeg”
::
ANY
);

541 
p
 *ğ
q
;… <<= 1; ++p;

542 ià(!
	`TrŸlDivisiÚ
(
p
, 
ŒŸlDivisÜBound
))

544 
a
.
	`Rªdomize
(
ºg
, 2, 
p
-1, 
IÁeg”
::
ANY
);

545 
b
 = 
	`a_exp_b_mod_c
(
a
, (
p
-1)/
q
,…);

546 
sucûss
 = (
	`GCD
(
b
-1, 
p
è=ğ1è&& (
	`a_exp_b_mod_c
(b, 
q
,…) == 1);

550  
p
;

551 
	}
}

553 
IÁeg”
 
	$CRT
(cÚ¡ 
IÁeg”
 &
xp
, cÚ¡ IÁeg” &
p
, cÚ¡ IÁeg” &
xq
, cÚ¡ IÁeg” &
q
, cÚ¡ IÁeg” &
u
)

556  
p
 * (
u
 * (
xq
-
xp
è% 
q
) + xp;

570 
	}
}

572 
IÁeg”
 
	$ModuÏrSqu¬eRoÙ
(cÚ¡ 
IÁeg”
 &
a
, cÚ¡ IÁeg” &
p
)

574 ià(
p
%4 == 3)

575  
	`a_exp_b_mod_c
(
a
, (
p
+1)/4,…);

577 
IÁeg”
 
q
=
p
-1;

578 
r
=0;

579 
q
.
	`IsEv’
())

581 
r
++;

582 
q
 >>= 1;

585 
IÁeg”
 
n
=2;

586 
	`Jacobi
(
n
, 
p
) != -1)

587 ++
n
;

589 
IÁeg”
 
y
 = 
	`a_exp_b_mod_c
(
n
, 
q
, 
p
);

590 
IÁeg”
 
x
 = 
	`a_exp_b_mod_c
(
a
, (
q
-1)/2, 
p
);

591 
IÁeg”
 
b
 = (
x
.
	`Squ¬ed
()%
p
)*
a
%p;

592 
x
 = 
a
*x%
p
;

593 
IÁeg”
 
‹mpb
, 
t
;

595 
b
 != 1)

597 
m
=0;

598 
‹mpb
 = 
b
;

601 
m
++;

602 
b
 = b.
	`Squ¬ed
()%
p
;

603 ià(
m
==
r
)

604  
IÁeg”
::
	`Z”o
();

606 
b
 != 1);

608 
t
 = 
y
;

609 
i
=0; i<
r
-
m
-1; i++)

610 
t
 =.
	`Squ¬ed
()%
p
;

611 
y
 = 
t
.
	`Squ¬ed
()%
p
;

612 
r
 = 
m
;

613 
x
 = x*
t
%
p
;

614 
b
 = 
‹mpb
*
y
%
p
;

617 
	`as£¹
(
x
.
	`Squ¬ed
()%
p
 =ğ
a
);

618  
x
;

619 
	}
}

621 
boŞ
 
	$SŞveModuÏrQuad¿ticEqu©iÚ
(
IÁeg”
 &
r1
, IÁeg” &
r2
, cÚ¡ IÁeg” &
a
, cÚ¡ IÁeg” &
b
, cÚ¡ IÁeg” &
c
, cÚ¡ IÁeg” &
p
)

623 
IÁeg”
 
D
 = (
b
.
	`Squ¬ed
(è- 4*
a
*
c
è% 
p
;

624 
	`Jacobi
(
D
, 
p
))

627 
	`as£¹
(
çl£
);

628  
çl£
;

630  
çl£
;

632 
r1
 = 
r2
 = (-
b
*(
a
+a).
	`Inv”£Mod
(
p
)) %…;

633 
	`as£¹
(((
r1
.
	`Squ¬ed
()*
a
 +„1*
b
 + 
c
è% 
p
).
	`IsZ”o
());

634  
Œue
;

636 
IÁeg”
 
s
 = 
	`ModuÏrSqu¬eRoÙ
(
D
, 
p
);

637 
IÁeg”
 
t
 = (
a
+a).
	`Inv”£Mod
(
p
);

638 
r1
 = (
s
-
b
)*
t
 % 
p
;

639 
r2
 = (-
s
-
b
)*
t
 % 
p
;

640 
	`as£¹
(((
r1
.
	`Squ¬ed
()*
a
 +„1*
b
 + 
c
è% 
p
).
	`IsZ”o
());

641 
	`as£¹
(((
r2
.
	`Squ¬ed
()*
a
 +„2*
b
 + 
c
è% 
p
).
	`IsZ”o
());

642  
Œue
;

644 
	}
}

646 
IÁeg”
 
	$ModuÏrRoÙ
(cÚ¡ 
IÁeg”
 &
a
, cÚ¡ IÁeg” &
dp
, cÚ¡ IÁeg” &
dq
,

647 cÚ¡ 
IÁeg”
 &
p
, cÚ¡ IÁeg” &
q
, cÚ¡ IÁeg” &
u
)

649 
IÁeg”
 
p2
, 
q2
;

650 #´agm¨
omp
 
·¿Î–


651 #´agm¨
omp
 
£ùiÚs


653 #´agm¨
omp
 
£ùiÚ


654 
p2
 = 
	`ModuÏrExpÚ’tŸtiÚ
((
a
 % 
p
), 
dp
,…);

655 #´agm¨
omp
 
£ùiÚ


656 
q2
 = 
	`ModuÏrExpÚ’tŸtiÚ
((
a
 % 
q
), 
dq
, q);

658  
	`CRT
(
p2
, 
p
, 
q2
, 
q
, 
u
);

659 
	}
}

661 
IÁeg”
 
	$ModuÏrRoÙ
(cÚ¡ 
IÁeg”
 &
a
, cÚ¡ IÁeg” &
e
,

662 cÚ¡ 
IÁeg”
 &
p
, cÚ¡ IÁeg” &
q
)

664 
IÁeg”
 
dp
 = 
	`Euşid—nMuÉliÿtiveInv”£
(
e
, 
p
-1);

665 
IÁeg”
 
dq
 = 
	`Euşid—nMuÉliÿtiveInv”£
(
e
, 
q
-1);

666 
IÁeg”
 
u
 = 
	`Euşid—nMuÉliÿtiveInv”£
(
p
, 
q
);

667 
	`as£¹
(!!
dp
 && !!
dq
 && !!
u
);

668  
	`ModuÏrRoÙ
(
a
, 
dp
, 
dq
, 
p
, 
q
, 
u
);

669 
	}
}

785 
	$Jacobi
(cÚ¡ 
IÁeg”
 &
aIn
, cÚ¡ IÁeg” &
bIn
)

787 
	`as£¹
(
bIn
.
	`IsOdd
());

789 
IÁeg”
 
b
 = 
bIn
, 
a
 = 
aIn
%bIn;

790 
»suÉ
 = 1;

792 !!
a
)

794 
i
=0;

795 
a
.
	`G‘B™
(
i
)==0)

796 
i
++;

797 
a
>>=
i
;

799 ià(
i
%2==1 && (
b
%8==3 || b%8==5))

800 
»suÉ
 = -result;

802 ià(
a
%4==3 && 
b
%4==3)

803 
»suÉ
 = -result;

805 
¡d
::
	`sw­
(
a
, 
b
);

806 
a
 %ğ
b
;

809  (
b
==1è? 
»suÉ
 : 0;

810 
	}
}

812 
IÁeg”
 
	$Luÿs
(cÚ¡ 
IÁeg”
 &
e
, cÚ¡ IÁeg” &
pIn
, cÚ¡ IÁeg” &
n
)

814 
i
 = 
e
.
	`B™CouÁ
();

815 ià(
i
==0)

816  
IÁeg”
::
	`Two
();

818 
MÚtgom”yR•»£Á©iÚ
 
	`m
(
n
);

819 
IÁeg”
 
p
=
m
.
	`CÚv”tIn
(
pIn
%
n
), 
two
=m.CÚv”tIn(IÁeg”::
	`Two
());

820 
IÁeg”
 
v
=
p
, 
v1
=
m
.
	`SubŒaù
(m.
	`Squ¬e
Õ), 
two
);

822 
i
--;

823 
i
--)

825 ià(
e
.
	`G‘B™
(
i
))

828 
v
 = 
m
.
	`SubŒaù
(m.
	`MuÉly
(v,
v1
), 
p
);

830 
v1
 = 
m
.
	`SubŒaù
(m.
	`Squ¬e
(v1), 
two
);

835 
v1
 = 
m
.
	`SubŒaù
(m.
	`MuÉly
(
v
,v1), 
p
);

837 
v
 = 
m
.
	`SubŒaù
(m.
	`Squ¬e
(v), 
two
);

840  
m
.
	`CÚv”tOut
(
v
);

841 
	}
}

998 
IÁeg”
 
	$Inv”£Luÿs
(cÚ¡ 
IÁeg”
 &
e
, cÚ¡ IÁeg” &
m
, cÚ¡ IÁeg” &
p
, cÚ¡ IÁeg” &
q
, cÚ¡ IÁeg” &
u
)

1000 
IÁeg”
 
d
 = (
m
*m-4);

1001 
IÁeg”
 
p2
, 
q2
;

1002 #´agm¨
omp
 
·¿Î–


1003 #´agm¨
omp
 
£ùiÚs


1005 #´agm¨
omp
 
£ùiÚ


1007 
p2
 = 
p
-
	`Jacobi
(
d
,p);

1008 
p2
 = 
	`Luÿs
(
	`Euşid—nMuÉliÿtiveInv”£
(
e
,p2), 
m
, 
p
);

1010 #´agm¨
omp
 
£ùiÚ


1012 
q2
 = 
q
-
	`Jacobi
(
d
,q);

1013 
q2
 = 
	`Luÿs
(
	`Euşid—nMuÉliÿtiveInv”£
(
e
,q2), 
m
, 
q
);

1016  
	`CRT
(
p2
, 
p
, 
q2
, 
q
, 
u
);

1017 
	}
}

1019 
	$FaùÜšgWÜkFaùÜ
(
n
)

1023 ià(
n
<5)  0;

1024  ()(2.4 * 
	`pow
(()
n
, 1.0/3.0è*…ow(
	`log
((n)), 2.0/3.0) - 5);

1025 
	}
}

1027 
	$Disü‘eLogWÜkFaùÜ
(
n
)

1030 ià(
n
<5)  0;

1031  ()(2.4 * 
	`pow
(()
n
, 1.0/3.0è*…ow(
	`log
((n)), 2.0/3.0) - 5);

1032 
	}
}

1036 
	gPrimeAndG’”©Ü
::
	$G’”©e
(sigÃd 
d–
, 
RªdomNumb”G’”©Ü
 &
ºg
, 
pb™s
, 
qb™s
)

1039 
	`as£¹
(
qb™s
 > 4);

1040 
	`as£¹
(
pb™s
 > 
qb™s
);

1042 ià(
qb™s
+1 =ğ
pb™s
)

1044 
IÁeg”
 
mšP
 = IÁeg”::
	`Pow”2
(
pb™s
-1);

1045 
IÁeg”
 
maxP
 = IÁeg”::
	`Pow”2
(
pb™s
) - 1;

1046 
boŞ
 
sucûss
 = 
çl£
;

1048 !
sucûss
)

1050 
p
.
	`Rªdomize
(
ºg
, 
mšP
, 
maxP
, 
IÁeg”
::
ANY
, 6+5*
d–
, 12);

1051 
PrimeS›ve
 
	`s›ve
(
p
, 
	`STDMIN
Õ+
	`PrimeS—rchIÁ”v®
(
maxP
)*12, maxP), 12, 
d–
);

1053 
s›ve
.
	`NextCªdid©e
(
p
))

1055 
	`as£¹
(
	`IsSm®lPrime
(
p
è|| 
	`Sm®lDivisÜsTe¡
(p));

1056 
q
 = (
p
-
d–
) >> 1;

1057 
	`as£¹
(
	`IsSm®lPrime
(
q
è|| 
	`Sm®lDivisÜsTe¡
(q));

1058 ià(
	`Fa¡ProbabËPrimeTe¡
(
q
è&& Fa¡ProbabËPrimeTe¡(
p
è&& 
	`IsPrime
(q) && IsPrime(p))

1060 
sucûss
 = 
Œue
;

1066 ià(
d–
 == 1)

1070 
g
=2; 
	`Jacobi
(g, 
p
) != 1; ++g) {}

1072 
	`as£¹
((
p
%8==1 ||…%8==7è? 
g
==2 : (p%12==1 ||…%12==11) ? g==3 : g==4);

1076 
	`as£¹
(
d–
 == -1);

1079 
g
=3; ; ++g)

1080 ià(
	`Jacobi
(
g
*g-4, 
p
)==-1 && 
	`Luÿs
(
q
, g,…)==2)

1086 
IÁeg”
 
mšQ
 = IÁeg”::
	`Pow”2
(
qb™s
-1);

1087 
IÁeg”
 
maxQ
 = IÁeg”::
	`Pow”2
(
qb™s
) - 1;

1088 
IÁeg”
 
mšP
 = IÁeg”::
	`Pow”2
(
pb™s
-1);

1089 
IÁeg”
 
maxP
 = IÁeg”::
	`Pow”2
(
pb™s
) - 1;

1093 
q
.
	`Rªdomize
(
ºg
, 
mšQ
, 
maxQ
, 
IÁeg”
::
PRIME
);

1094 } !
p
.
	`Rªdomize
(
ºg
, 
mšP
, 
maxP
, 
IÁeg”
::
PRIME
, 
d–
%
q
, q));

1097 ià(
d–
==1)

1101 
IÁeg”
 
	`h
(
ºg
, 2, 
p
-2, IÁeg”::
ANY
);

1102 
g
 = 
	`a_exp_b_mod_c
(
h
, (
p
-1)/
q
,…);

1103 } 
g
 <= 1);

1104 
	`as£¹
(
	`a_exp_b_mod_c
(
g
, 
q
, 
p
)==1);

1108 
	`as£¹
(
d–
==-1);

1111 
IÁeg”
 
	`h
(
ºg
, 3, 
p
-1, IÁeg”::
ANY
);

1112 ià(
	`Jacobi
(
h
*h-4, 
p
)==1)

1114 
g
 = 
	`Luÿs
((
p
+1)/
q
, 
h
,…);

1115 } 
g
 <= 2);

1116 
	`as£¹
(
	`Luÿs
(
q
, 
g
, 
p
) == 2);

1119 
	}
}

1121 
	gNAMESPACE_END


	@nbtheory.h

3 #iâdeà
CRYPTOPP_NBTHEORY_H


4 
	#CRYPTOPP_NBTHEORY_H


	)

6 
	~"š‹g”.h
"

7 
	~"®g·¿m.h
"

9 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

12 
CRYPTOPP_DLL
 cÚ¡ 
wÜd16
 * 
CRYPTOPP_API
 
	`G‘PrimeTabË
(&
size
);

17 
CRYPTOPP_DLL
 
IÁeg”
 
CRYPTOPP_API
 
	`Mau»rProvabËPrime
(
RªdomNumb”G’”©Ü
 &
ºg
, 
b™s
);

18 
CRYPTOPP_DLL
 
IÁeg”
 
CRYPTOPP_API
 
	`MihaescuProvabËPrime
(
RªdomNumb”G’”©Ü
 &
ºg
, 
b™s
);

20 
CRYPTOPP_DLL
 
boŞ
 
CRYPTOPP_API
 
	`IsSm®lPrime
(cÚ¡ 
IÁeg”
 &
p
);

24 
CRYPTOPP_DLL
 
boŞ
 
CRYPTOPP_API
 
	`TrŸlDivisiÚ
(cÚ¡ 
IÁeg”
 &
p
, 
bound
);

27 
CRYPTOPP_DLL
 
boŞ
 
CRYPTOPP_API
 
	`Sm®lDivisÜsTe¡
(cÚ¡ 
IÁeg”
 &
p
);

30 
CRYPTOPP_DLL
 
boŞ
 
CRYPTOPP_API
 
	`IsF”m©ProbabËPrime
(cÚ¡ 
IÁeg”
 &
n
, cÚ¡ IÁeg” &
b
);

31 
CRYPTOPP_DLL
 
boŞ
 
CRYPTOPP_API
 
	`IsLuÿsProbabËPrime
(cÚ¡ 
IÁeg”
 &
n
);

33 
CRYPTOPP_DLL
 
boŞ
 
CRYPTOPP_API
 
	`IsSŒÚgProbabËPrime
(cÚ¡ 
IÁeg”
 &
n
, cÚ¡ IÁeg” &
b
);

34 
CRYPTOPP_DLL
 
boŞ
 
CRYPTOPP_API
 
	`IsSŒÚgLuÿsProbabËPrime
(cÚ¡ 
IÁeg”
 &
n
);

38 
CRYPTOPP_DLL
 
boŞ
 
CRYPTOPP_API
 
	`RabšMËrTe¡
(
RªdomNumb”G’”©Ü
 &
ºg
, cÚ¡ 
IÁeg”
 &
w
, 
rounds
);

41 
CRYPTOPP_DLL
 
boŞ
 
CRYPTOPP_API
 
	`IsPrime
(cÚ¡ 
IÁeg”
 &
p
);

44 
CRYPTOPP_DLL
 
boŞ
 
CRYPTOPP_API
 
	`V”ifyPrime
(
RªdomNumb”G’”©Ü
 &
ºg
, cÚ¡ 
IÁeg”
 &
p
, 
Ëv–
 = 1);

46 şas 
	cCRYPTOPP_DLL
 
PrimeS–eùÜ


48 
public
:

49 cÚ¡ 
PrimeS–eùÜ
 *
	$G‘S–eùÜPoš‹r
(ècÚ¡ { 
this
;}

50 
vœtu®
 
boŞ
 
	$IsAcû±abË
(cÚ¡ 
IÁeg”
 &
ÿndid©e
) const =0;

51 
	}
};

55 
CRYPTOPP_DLL
 
boŞ
 
CRYPTOPP_API
 
Fœ¡Prime
(
IÁeg”
 &
p
, cÚ¡ IÁeg” &
max
, cÚ¡ IÁeg” &
equiv
, cÚ¡ IÁeg” &
mod
, cÚ¡ 
PrimeS–eùÜ
 *
pS–eùÜ
);

57 
CRYPTOPP_DLL
 
CRYPTOPP_API
 
PrimeS—rchIÁ”v®
(cÚ¡ 
IÁeg”
 &
max
);

59 
CRYPTOPP_DLL
 
AlgÜ™hmP¬am‘”s
 
CRYPTOPP_API
 
MakeP¬am‘”sFÜTwoPrimesOfEqu®Size
(
´oduùB™L’gth
);

63 
šlše
 
IÁeg”
 
	$GCD
(cÚ¡ 
IÁeg”
 &
a
, cÚ¡ IÁeg” &
b
)

64 { 
IÁeg”
::
	`Gcd
(
a
,
b
);
	}
}

65 
šlše
 
boŞ
 
	$R–©iv–yPrime
(cÚ¡ 
IÁeg”
 &
a
, cÚ¡ IÁeg” &
b
)

66 { 
IÁeg”
::
	`Gcd
(
a
,
b
è=ğIÁeg”::
	`OÃ
();
	}
}

67 
šlše
 
IÁeg”
 
	$LCM
(cÚ¡ 
IÁeg”
 &
a
, cÚ¡ IÁeg” &
b
)

68 { 
a
/
IÁeg”
::
	`Gcd
×,
b
)*b;
	}
}

69 
šlše
 
IÁeg”
 
	$Euşid—nMuÉliÿtiveInv”£
(cÚ¡ 
IÁeg”
 &
a
, cÚ¡ IÁeg” &
b
)

70 { 
a
.
	`Inv”£Mod
(
b
);
	}
}

73 
CRYPTOPP_DLL
 
IÁeg”
 
CRYPTOPP_API
 
CRT
(cÚ¡ IÁeg” &
xp
, cÚ¡ IÁeg” &
p
, cÚ¡ IÁeg” &
xq
, cÚ¡ IÁeg” &
q
, cÚ¡ IÁeg” &
u
);

77 
CRYPTOPP_DLL
 
CRYPTOPP_API
 
Jacobi
(cÚ¡ 
IÁeg”
 &
a
, cÚ¡ IÁeg” &
b
);

80 
CRYPTOPP_DLL
 
IÁeg”
 
CRYPTOPP_API
 
Luÿs
(cÚ¡ IÁeg” &
e
, cÚ¡ IÁeg” &
p
, cÚ¡ IÁeg” &
n
);

82 
CRYPTOPP_DLL
 
IÁeg”
 
CRYPTOPP_API
 
Inv”£Luÿs
(cÚ¡ IÁeg” &
e
, cÚ¡ IÁeg” &
m
, cÚ¡ IÁeg” &
p
, cÚ¡ IÁeg” &
q
, cÚ¡ IÁeg” &
u
);

84 
šlše
 
IÁeg”
 
	$ModuÏrExpÚ’tŸtiÚ
(cÚ¡ 
IÁeg”
 &
a
, cÚ¡ IÁeg” &
e
, cÚ¡ IÁeg” &
m
)

85 { 
	`a_exp_b_mod_c
(
a
, 
e
, 
m
);
	}
}

87 
CRYPTOPP_DLL
 
IÁeg”
 
CRYPTOPP_API
 
ModuÏrSqu¬eRoÙ
(cÚ¡ IÁeg” &
a
, cÚ¡ IÁeg” &
p
);

92 
CRYPTOPP_DLL
 
IÁeg”
 
CRYPTOPP_API
 
ModuÏrRoÙ
(cÚ¡ IÁeg” &
a
, cÚ¡ IÁeg” &
dp
, cÚ¡ IÁeg” &
dq
, cÚ¡ IÁeg” &
p
, cÚ¡ IÁeg” &
q
, cÚ¡ IÁeg” &
u
);

96 
CRYPTOPP_DLL
 
boŞ
 
CRYPTOPP_API
 
SŞveModuÏrQuad¿ticEqu©iÚ
(
IÁeg”
 &
r1
, IÁeg” &
r2
, cÚ¡ IÁeg” &
a
, cÚ¡ IÁeg” &
b
, cÚ¡ IÁeg” &
c
, cÚ¡ IÁeg” &
p
);

99 
CRYPTOPP_DLL
 
CRYPTOPP_API
 
Disü‘eLogWÜkFaùÜ
(
b™Ëngth
);

100 
CRYPTOPP_DLL
 
CRYPTOPP_API
 
FaùÜšgWÜkFaùÜ
(
b™Ëngth
);

105 şas 
	cCRYPTOPP_DLL
 
	mPrimeAndG’”©Ü


107 
	mpublic
:

108 
	$PrimeAndG’”©Ü
() {}

112 
	$PrimeAndG’”©Ü
(sigÃd 
d–
, 
RªdomNumb”G’”©Ü
 &
ºg
, 
pb™s
)

113 {
	`G’”©e
(
d–
, 
ºg
, 
pb™s
,…b™s-1);
	}
}

116 
	$PrimeAndG’”©Ü
(sigÃd 
d–
, 
RªdomNumb”G’”©Ü
 &
ºg
, 
pb™s
, 
qb™s
)

117 {
	`G’”©e
(
d–
, 
ºg
, 
pb™s
, 
qb™s
);
	}
}

119 
G’”©e
(sigÃd 
d–
, 
RªdomNumb”G’”©Ü
 &
ºg
, 
pb™s
, 
qb™s
);

121 cÚ¡ 
	gIÁeg”
& 
	$Prime
(ècÚ¡ { 
p
;
	}
}

122 cÚ¡ 
	gIÁeg”
& 
	$SubPrime
(ècÚ¡ { 
q
;
	}
}

123 cÚ¡ 
	gIÁeg”
& 
	$G’”©Ü
(ècÚ¡ { 
g
;
	}
}

125 
	g´iv©e
:

126 
IÁeg”
 
p
, 
	gq
, 
	gg
;

129 
	gNAMESPACE_END


	@network.cpp

3 
	~"pch.h
"

4 
	~"ÃtwÜk.h
"

5 
	~"wa™.h
"

7 
	#CRYPTOPP_TRACE_NETWORK
 0

	)

9 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

11 #ifdeà
HIGHRES_TIMER_AVAILABLE


13 
lwÜd
 
Lim™edBªdwidth
::
	$Compu‹Cu¼’tT¿nsûiveLim™
()

15 ià(!
m_maxBy‹sP”SecÚd
)

16  
ULONG_MAX
;

18 
curTime
 = 
	`G‘CurTimeAndCËªUp
();

19 
lwÜd
 
tÙ®
 = 0;

20 
OpQueue
::
size_ty³
 
i
=0; i!=
m_İs
.
	`size
(); ++i)

21 
tÙ®
 +ğ
m_İs
[
i
].
£cÚd
;

22  
	`S©u¿tšgSubŒaù
(
m_maxBy‹sP”SecÚd
, 
tÙ®
);

23 
	}
}

25 
	gLim™edBªdwidth
::
	$TimeToNextT¿nsûive
()

27 ià(!
m_maxBy‹sP”SecÚd
)

30 ià(!
m_ÃxtT¿nsûiveTime
)

31 
	`Compu‹NextT¿nsûiveTime
();

33  
	`S©u¿tšgSubŒaù
(
m_ÃxtT¿nsûiveTime
, 
m_tim”
.
	`EÏp£dTimeAsDoubË
());

34 
	}
}

36 
	gLim™edBªdwidth
::
	$NÙeT¿nsûive
(
lwÜd
 
size
)

38 ià(
m_maxBy‹sP”SecÚd
)

40 
curTime
 = 
	`G‘CurTimeAndCËªUp
();

41 
m_İs
.
	`push_back
(
¡d
::
	`make_·œ
(
curTime
, 
size
));

42 
m_ÃxtT¿nsûiveTime
 = 0;

44 
	}
}

46 
	gLim™edBªdwidth
::
	$Compu‹NextT¿nsûiveTime
()

48 
curTime
 = 
	`G‘CurTimeAndCËªUp
();

49 
lwÜd
 
tÙ®
 = 0;

50 
i
=0; i!=
m_İs
.
	`size
(); ++i)

51 
tÙ®
 +ğ
m_İs
[
i
].
£cÚd
;

52 
m_ÃxtT¿nsûiveTime
 =

53 (
tÙ®
 < 
m_maxBy‹sP”SecÚd
è? 
curTime
 : 
m_İs
.
	`äÚt
().
fœ¡
 + 1000;

54 
	}
}

56 
	gLim™edBªdwidth
::
	$G‘CurTimeAndCËªUp
()

58 ià(!
m_maxBy‹sP”SecÚd
)

61 
curTime
 = 
m_tim”
.
	`EÏp£dTimeAsDoubË
();

62 
m_İs
.
	`size
(è&& (m_İs.
	`äÚt
().
fœ¡
 + 1000 < 
curTime
))

63 
m_İs
.
	`pİ_äÚt
();

64  
curTime
;

65 
	}
}

67 
	gLim™edBªdwidth
::
	$G‘Wa™Objeùs
(
Wa™ObjeùCÚš”
 &
cÚš”
, cÚ¡ 
C®lSck
 &
ÿÎSck
)

69 
ÃxtT¿nsûiveTime
 = 
	`TimeToNextT¿nsûive
();

70 ià(
ÃxtT¿nsûiveTime
)

71 
cÚš”
.
	`ScheduËEv’t
(
ÃxtT¿nsûiveTime
, 
	`C®lSck
("Lim™edBªdwidth::G‘Wa™Objeùs()", &
ÿÎSck
));

72 
	}
}

76 
size_t
 
	gNÚblockšgSourû
::
	$G’”®Pump2
(

77 
lwÜd
& 
by‹CouÁ
, 
boŞ
 
blockšgOuut
,

78 
maxTime
, 
boŞ
 
checkD–im™”
, 
by‹
 
d–im™”
)

80 
m_blockedByS³edLim™
 = 
çl£
;

82 ià(!
	`G‘MaxBy‹sP”SecÚd
())

84 
size_t
 
»t
 = 
	`DoPump
(
by‹CouÁ
, 
blockšgOuut
, 
maxTime
, 
checkD–im™”
, 
d–im™”
);

85 
m_doPumpBlocked
 = (
»t
 != 0);

86  
»t
;

89 
boŞ
 
fÜev”
 = (
maxTime
 =ğ
INFINITE_TIME
);

90 
timeToGo
 = 
maxTime
;

91 
Tim”
 
	`tim”
(Tim”::
MILLISECONDS
, 
fÜev”
);

92 
lwÜd
 
maxSize
 = 
by‹CouÁ
;

93 
by‹CouÁ
 = 0;

95 
tim”
.
	`S¹Tim”
();

97 
Œue
)

99 
lwÜd
 
curMaxSize
 = 
	`UnsigÃdMš
(
	`Compu‹Cu¼’tT¿nsûiveLim™
(), 
maxSize
 - 
by‹CouÁ
);

101 ià(
curMaxSize
 || 
m_doPumpBlocked
)

103 ià(!
fÜev”
è
timeToGo
 = 
	`S©u¿tšgSubŒaù
(
maxTime
, 
tim”
.
	`EÏp£dTime
());

104 
size_t
 
»t
 = 
	`DoPump
(
curMaxSize
, 
blockšgOuut
, 
timeToGo
, 
checkD–im™”
, 
d–im™”
);

105 
m_doPumpBlocked
 = (
»t
 != 0);

106 ià(
curMaxSize
)

108 
	`NÙeT¿nsûive
(
curMaxSize
);

109 
by‹CouÁ
 +ğ
curMaxSize
;

111 ià(
»t
)

112  
»t
;

115 ià(
maxSize
 !ğ
ULONG_MAX
 && 
by‹CouÁ
 >= maxSize)

118 ià(!
fÜev”
)

120 
timeToGo
 = 
	`S©u¿tšgSubŒaù
(
maxTime
, 
tim”
.
	`EÏp£dTime
());

121 ià(!
timeToGo
)

125 
wa™Time
 = 
	`TimeToNextT¿nsûive
();

126 ià(!
fÜev”
 && 
wa™Time
 > 
timeToGo
)

128 
m_blockedByS³edLim™
 = 
Œue
;

132 
Wa™ObjeùCÚš”
 
cÚš”
;

133 
Lim™edBªdwidth
::
	`G‘Wa™Objeùs
(
cÚš”
, 
	`C®lSck
("NonblockingSource::GeneralPump2() - speed†imit", 0));

134 
cÚš”
.
	`Wa™
(()
wa™Time
);

138 
	}
}

140 
size_t
 
	gNÚblockšgSourû
::
	$PumpMes§ges2
(&
mes§geCouÁ
, 
boŞ
 
blockšg
)

142 ià(
mes§geCouÁ
 == 0)

145 
mes§geCouÁ
 = 0;

147 
lwÜd
 
by‹CouÁ
;

149 
by‹CouÁ
 = 
LWORD_MAX
;

150 
	`RETURN_IF_NONZERO
(
	`Pump2
(
by‹CouÁ
, 
blockšg
));

151 } 
by‹CouÁ
 =ğ
LWORD_MAX
);

153 ià(!
m_mes§geEndS’t
 && 
	`SourûExhau¡ed
())

155 
	`RETURN_IF_NONZERO
(
	`A‰achedT¿nsfÜm©iÚ
()->
	`Put2
(
NULL
, 0, 
	`G‘AutoSigÇlPrİag©iÚ
(), 
Œue
));

156 
m_mes§geEndS’t
 = 
Œue
;

157 
mes§geCouÁ
 = 1;

160 
	}
}

162 
lwÜd
 
	gNÚblockšgSšk
::
	$TimedFlush
(
maxTime
, 
size_t
 
rg‘Size
)

164 
m_blockedByS³edLim™
 = 
çl£
;

166 
size_t
 
curBufSize
 = 
	`G‘Cu¼’tBufãrSize
();

167 ià(
curBufSize
 <ğ
rg‘Size
 && (rg‘Siz|| !
	`EofP’dšg
()))

170 ià(!
	`G‘MaxBy‹sP”SecÚd
())

171  
	`DoFlush
(
maxTime
, 
rg‘Size
);

173 
boŞ
 
fÜev”
 = (
maxTime
 =ğ
INFINITE_TIME
);

174 
timeToGo
 = 
maxTime
;

175 
Tim”
 
	`tim”
(Tim”::
MILLISECONDS
, 
fÜev”
);

176 
lwÜd
 
tÙ®Flushed
 = 0;

178 
tim”
.
	`S¹Tim”
();

180 
Œue
)

182 
size_t
 
æushSize
 = 
	`UnsigÃdMš
(
curBufSize
 - 
rg‘Size
, 
	`Compu‹Cu¼’tT¿nsûiveLim™
());

183 ià(
æushSize
 || 
	`EofP’dšg
())

185 ià(!
fÜev”
è
timeToGo
 = 
	`S©u¿tšgSubŒaù
(
maxTime
, 
tim”
.
	`EÏp£dTime
());

186 
size_t
 
»t
 = (size_t)
	`DoFlush
(
timeToGo
, 
curBufSize
 - 
æushSize
);

187 ià(
»t
)

189 
	`NÙeT¿nsûive
(
»t
);

190 
curBufSize
 -ğ
»t
;

191 
tÙ®Flushed
 +ğ
»t
;

195 ià(
curBufSize
 <ğ
rg‘Size
 && (rg‘Siz|| !
	`EofP’dšg
()))

198 ià(!
fÜev”
)

200 
timeToGo
 = 
	`S©u¿tšgSubŒaù
(
maxTime
, 
tim”
.
	`EÏp£dTime
());

201 ià(!
timeToGo
)

205 
wa™Time
 = 
	`TimeToNextT¿nsûive
();

206 ià(!
fÜev”
 && 
wa™Time
 > 
timeToGo
)

208 
m_blockedByS³edLim™
 = 
Œue
;

212 
Wa™ObjeùCÚš”
 
cÚš”
;

213 
Lim™edBªdwidth
::
	`G‘Wa™Objeùs
(
cÚš”
, 
	`C®lSck
("NonblockingSink::TimedFlush() - speed†imit", 0));

214 
cÚš”
.
	`Wa™
(()
wa™Time
);

217  
tÙ®Flushed
;

218 
	}
}

220 
boŞ
 
	gNÚblockšgSšk
::
	$IsŞ©edFlush
(
boŞ
 
h¬dFlush
, boŞ 
blockšg
)

222 
	`TimedFlush
(
blockšg
 ? 
INFINITE_TIME
 : 0);

223  
h¬dFlush
 && (!!
	`G‘Cu¼’tBufãrSize
(è|| 
	`EofP’dšg
());

224 
	}
}

228 
	gN‘wÜkSourû
::
	$N‘wÜkSourû
(
Bufã»dT¿nsfÜm©iÚ
 *
©chm’t
)

229 : 
	`NÚblockšgSourû
(
©chm’t
), 
	`m_buf
(1024*16)

230 , 
	`m_wa™šgFÜResuÉ
(
çl£
), 
	`m_ouutBlocked
(false)

231 , 
	`m_d©aBegš
(0), 
	$m_d©aEnd
(0)

233 
	}
}

235 
	gN‘wÜkSourû
::
	$G‘MaxWa™ObjeùCouÁ
() const

237  
Lim™edBªdwidth
::
	`G‘MaxWa™ObjeùCouÁ
()

238 + 
	`G‘Reûiv”
().
	`G‘MaxWa™ObjeùCouÁ
()

239 + 
	`A‰achedT¿nsfÜm©iÚ
()->
	`G‘MaxWa™ObjeùCouÁ
();

240 
	}
}

242 
	gN‘wÜkSourû
::
	$G‘Wa™Objeùs
(
Wa™ObjeùCÚš”
 &
cÚš”
, 
C®lSck
 cÚ¡& 
ÿÎSck
)

244 ià(
	`BlockedByS³edLim™
())

245 
Lim™edBªdwidth
::
	`G‘Wa™Objeùs
(
cÚš”
, 
	`C®lSck
("N‘wÜkSourû::G‘Wa™Objeùs(è- s³ed†im™", &
ÿÎSck
));

246 ià(!
m_ouutBlocked
)

248 ià(
m_d©aBegš
 =ğ
m_d©aEnd
)

249 
	`AcûssReûiv”
().
	`G‘Wa™Objeùs
(
cÚš”
, 
	`C®lSck
("N‘wÜkSourû::G‘Wa™Objeùs(è-‚Ød©a", &
ÿÎSck
));

251 
cÚš”
.
	`S‘NoWa™
(
	`C®lSck
("N‘wÜkSourû::G‘Wa™Objeùs(è- havd©a", &
ÿÎSck
));

254 
	`A‰achedT¿nsfÜm©iÚ
()->
	`G‘Wa™Objeùs
(
cÚš”
, 
	`C®lSck
("N‘wÜkSourû::G‘Wa™Objeùs(è-‡‰achm’t", &
ÿÎSck
));

255 
	}
}

257 
size_t
 
	gN‘wÜkSourû
::
	$DoPump
(
lwÜd
 &
by‹CouÁ
, 
boŞ
 
blockšgOuut
, 
maxTime
, boŞ 
checkD–im™”
, 
by‹
 
d–im™”
)

259 
N‘wÜkReûiv”
 &
»ûiv”
 = 
	`AcûssReûiv”
();

261 
lwÜd
 
maxSize
 = 
by‹CouÁ
;

262 
by‹CouÁ
 = 0;

263 
boŞ
 
fÜev”
 = 
maxTime
 =ğ
INFINITE_TIME
;

264 
Tim”
 
	`tim”
(Tim”::
MILLISECONDS
, 
fÜev”
);

265 
Bufã»dT¿nsfÜm©iÚ
 *
t
 = 
	`A‰achedT¿nsfÜm©iÚ
();

267 ià(
m_ouutBlocked
)

268 
DoOuut
;

270 
Œue
)

272 ià(
m_d©aBegš
 =ğ
m_d©aEnd
)

274 ià(
»ûiv”
.
	`EofReûived
())

277 ià(
m_wa™šgFÜResuÉ
)

279 ià(
»ûiv”
.
	`Mu¡Wa™FÜResuÉ
() &&

280 !
»ûiv”
.
	`Wa™
(
	`S©u¿tšgSubŒaù
(
maxTime
, 
tim”
.
	`EÏp£dTime
()),

281 
	`C®lSck
("NetworkSource::DoPump() - wait„eceive„esult", 0)))

284 
»cvResuÉ
 = 
»ûiv”
.
	`G‘ReûiveResuÉ
();

285 #ià
CRYPTOPP_TRACE_NETWORK


286 
	`OuutDebugSŒšg
((
	`IÁToSŒšg
(()
this
è+ ": Reûived " + IÁToSŒšg(
»cvResuÉ
è+ " by‹s\n").
	`c_¡r
());

288 
m_d©aEnd
 +ğ
»cvResuÉ
;

289 
m_wa™šgFÜResuÉ
 = 
çl£
;

291 ià(!
»ûiv”
.
	`Mu¡Wa™ToReûive
(è&& !»ûiv”.
	`EofReûived
(è&& 
m_d©aEnd
 !ğ
m_buf
.
	`size
())

292 
ReûiveNoWa™
;

296 
m_d©aEnd
 = 
m_d©aBegš
 = 0;

298 ià(
»ûiv”
.
	`Mu¡Wa™ToReûive
())

300 ià(!
»ûiv”
.
	`Wa™
(
	`S©u¿tšgSubŒaù
(
maxTime
, 
tim”
.
	`EÏp£dTime
()),

301 
	`C®lSck
("NetworkSource::DoPump() - wait„eceive", 0)))

304 
»ûiv”
.
	`Reûive
(
m_buf
+
m_d©aEnd
, m_buf.
	`size
()-m_dataEnd);

305 
m_wa™šgFÜResuÉ
 = 
Œue
;

309 
ReûiveNoWa™
:

310 
m_wa™šgFÜResuÉ
 = 
Œue
;

313 #ià
CRYPTOPP_TRACE_NETWORK


314 
	`OuutDebugSŒšg
((
	`IÁToSŒšg
(()
this
è+ ": Reûivšg " + IÁToSŒšg(
m_buf
.
	`size
()-
m_d©aEnd
è+ " by‹s\n").
	`c_¡r
());

316 
»ûiv”
.
	`Reûive
(
m_buf
+
m_d©aEnd
, m_buf.
	`size
()-m_dataEnd))

318 
»cvResuÉ
 = 
»ûiv”
.
	`G‘ReûiveResuÉ
();

319 #ià
CRYPTOPP_TRACE_NETWORK


320 
	`OuutDebugSŒšg
((
	`IÁToSŒšg
(()
this
è+ ": Reûived " + IÁToSŒšg(
»cvResuÉ
è+ " by‹s\n").
	`c_¡r
());

322 
m_d©aEnd
 +ğ
»cvResuÉ
;

323 ià(
»ûiv”
.
	`EofReûived
(è|| 
m_d©aEnd
 > 
m_buf
.
	`size
() /2)

325 
m_wa™šgFÜResuÉ
 = 
çl£
;

334 
m_putSize
 = 
	`UnsigÃdMš
(
m_d©aEnd
 - 
m_d©aBegš
, 
maxSize
 - 
by‹CouÁ
);

336 ià(
checkD–im™”
)

337 
m_putSize
 = 
¡d
::
	`fšd
(
m_buf
+
m_d©aBegš
, m_buf+m_d©aBegš+m_putSize, 
d–im™”
) - (m_buf+m_dataBegin);

339 
DoOuut
:

340 
size_t
 
»suÉ
 = 
t
->
	`PutModifŸbË2
(
m_buf
+
m_d©aBegš
, 
m_putSize
, 0, 
fÜev”
 || 
blockšgOuut
);

341 ià(
»suÉ
)

343 ià(
t
->
	`Wa™
(
	`S©u¿tšgSubŒaù
(
maxTime
, 
tim”
.
	`EÏp£dTime
()),

344 
	`C®lSck
("NetworkSource::DoPump() - wait‡ttachment", 0)))

345 
DoOuut
;

348 
m_ouutBlocked
 = 
Œue
;

349  
»suÉ
;

352 
m_ouutBlocked
 = 
çl£
;

354 
by‹CouÁ
 +ğ
m_putSize
;

355 
m_d©aBegš
 +ğ
m_putSize
;

356 ià(
checkD–im™”
 && 
m_d©aBegš
 < 
m_d©aEnd
 && 
m_buf
[m_d©aBegš] =ğ
d–im™”
)

358 ià(
maxSize
 !ğ
ULONG_MAX
 && 
by‹CouÁ
 == maxSize)

363 ià(
maxTime
 > 0 && 
tim”
.
	`EÏp£dTime
() > maxTime)

369 
	}
}

373 
	gN‘wÜkSšk
::
	$N‘wÜkSšk
(
maxBufãrSize
, 
autoFlushBound
)

374 : 
	`m_maxBufãrSize
(
maxBufãrSize
), 
	`m_autoFlushBound
(
autoFlushBound
)

375 , 
	`m_ÃedS’dResuÉ
(
çl£
), 
	`m_wasBlocked
(çl£), 
	`m_eofS‹
(
EOF_NONE
)

376 , 
	`m_bufãr
(
	`STDMIN
(16U*1024U+256, 
maxBufãrSize
)), 
	`m_skBy‹s
(0)

377 , 
	`m_¥“dTim”
(
Tim”
::
MILLISECONDS
), 
	`m_by‹CouÁSšûLa¡Tim”Re£t
(0)

378 , 
	`m_cu¼’tS³ed
(0), 
	$m_maxOb£rvedS³ed
(0)

380 
	}
}

382 
	gN‘wÜkSšk
::
	$Compu‹Cu¼’tS³ed
()

384 ià(
m_¥“dTim”
.
	`EÏp£dTime
() > 1000)

386 
m_cu¼’tS³ed
 = 
m_by‹CouÁSšûLa¡Tim”Re£t
 * 1000 / 
m_¥“dTim”
.
	`EÏp£dTime
();

387 
m_maxOb£rvedS³ed
 = 
	`STDMAX
(
m_cu¼’tS³ed
, m_maxObservedSpeed * 0.98f);

388 
m_by‹CouÁSšûLa¡Tim”Re£t
 = 0;

389 
m_¥“dTim”
.
	`S¹Tim”
();

392  
m_cu¼’tS³ed
;

393 
	}
}

395 
	gN‘wÜkSšk
::
	$G‘MaxOb£rvedS³ed
() const

397 
lwÜd
 
m
 = 
	`G‘MaxBy‹sP”SecÚd
();

398  
m
 ? 
	`STDMIN
(
m_maxOb£rvedS³ed
, (
CRYPTOPP_VC6_INT64
 m)) : m_maxObservedSpeed;

399 
	}
}

401 
	gN‘wÜkSšk
::
	$G‘MaxWa™ObjeùCouÁ
() const

403  
Lim™edBªdwidth
::
	`G‘MaxWa™ObjeùCouÁ
(è+ 
	`G‘S’d”
().GetMaxWaitObjectCount();

404 
	}
}

406 
	gN‘wÜkSšk
::
	$G‘Wa™Objeùs
(
Wa™ObjeùCÚš”
 &
cÚš”
, 
C®lSck
 cÚ¡& 
ÿÎSck
)

408 ià(
	`BlockedByS³edLim™
())

409 
Lim™edBªdwidth
::
	`G‘Wa™Objeùs
(
cÚš”
, 
	`C®lSck
("N‘wÜkSšk::G‘Wa™Objeùs(è- s³ed†im™", &
ÿÎSck
));

410 ià(
m_wasBlocked
)

411 
	`AcûssS’d”
().
	`G‘Wa™Objeùs
(
cÚš”
, 
	`C®lSck
("N‘wÜkSšk::G‘Wa™Objeùs(è- wa blocked", &
ÿÎSck
));

412 ià(!
m_bufãr
.
	`IsEm±y
())

413 
	`AcûssS’d”
().
	`G‘Wa™Objeùs
(
cÚš”
, 
	`C®lSck
("N‘wÜkSšk::G‘Wa™Objeùs(è- bufã¸nÙƒm±y", &
ÿÎSck
));

414 ià(
	`EofP’dšg
())

415 
	`AcûssS’d”
().
	`G‘Wa™Objeùs
(
cÚš”
, 
	`C®lSck
("N‘wÜkSšk::G‘Wa™Objeùs(è- EOF…’dšg", &
ÿÎSck
));

416 
	}
}

418 
size_t
 
	gN‘wÜkSšk
::
	$Put2
(cÚ¡ 
by‹
 *
šSŒšg
, 
size_t
 
Ëngth
, 
mes§geEnd
, 
boŞ
 
blockšg
)

420 ià(
m_eofS‹
 =ğ
EOF_DONE
)

422 ià(
Ëngth
 || 
mes§geEnd
)

423 
throw
 
	`Exû±iÚ
(
Exû±iÚ
::
OTHER_ERROR
, "NetworkSink::Put2() being called‡fter EOF had been sent");

428 ià(
m_eofS‹
 > 
EOF_NONE
)

429 
EofS™e
;

432 ià(
m_skBy‹s
)

434 
	`as£¹
(
Ëngth
 >ğ
m_skBy‹s
);

435 
šSŒšg
 +ğ
m_skBy‹s
;

436 
Ëngth
 -ğ
m_skBy‹s
;

439 
m_bufãr
.
	`Put
(
šSŒšg
, 
Ëngth
);

441 ià(!
blockšg
 || 
m_bufãr
.
	`Cu¼’tSize
(è> 
m_autoFlushBound
)

442 
	`TimedFlush
(0, 0);

444 
size_t
 
rg‘Size
 = 
mes§geEnd
 ? 0 : 
m_maxBufãrSize
;

445 ià(
blockšg
)

446 
	`TimedFlush
(
INFINITE_TIME
, 
rg‘Size
);

448 ià(
m_bufãr
.
	`Cu¼’tSize
(è> 
rg‘Size
)

450 
	`as£¹
(!
blockšg
);

451 
m_wasBlocked
 = 
Œue
;

452 
m_skBy‹s
 +ğ
Ëngth
;

453 
size_t
 
blockedBy‹s
 = 
	`UnsigÃdMš
(
Ëngth
, 
m_bufãr
.
	`Cu¼’tSize
(è- 
rg‘Size
);

454  
STDMAX
<
size_t
>(
blockedBy‹s
, 1);

457 
m_wasBlocked
 = 
çl£
;

458 
m_skBy‹s
 = 0;

461 ià(
mes§geEnd
)

463 
m_eofS‹
 = 
EOF_PENDING_SEND
;

465 
EofS™e
:

466 
	`TimedFlush
(
blockšg
 ? 
INFINITE_TIME
 : 0, 0);

467 ià(
m_eofS‹
 !ğ
EOF_DONE
)

472 
	}
}

474 
lwÜd
 
	gN‘wÜkSšk
::
	$DoFlush
(
maxTime
, 
size_t
 
rg‘Size
)

476 
N‘wÜkS’d”
 &
£nd”
 = 
	`AcûssS’d”
();

478 
boŞ
 
fÜev”
 = 
maxTime
 =ğ
INFINITE_TIME
;

479 
Tim”
 
	`tim”
(Tim”::
MILLISECONDS
, 
fÜev”
);

480 
tÙ®FlushSize
 = 0;

482 
Œue
)

484 ià(
m_bufãr
.
	`Cu¼’tSize
(è<ğ
rg‘Size
)

487 ià(
m_ÃedS’dResuÉ
)

489 ià(
£nd”
.
	`Mu¡Wa™FÜResuÉ
() &&

490 !
£nd”
.
	`Wa™
(
	`S©u¿tšgSubŒaù
(
maxTime
, 
tim”
.
	`EÏp£dTime
()),

491 
	`C®lSck
("NetworkSink::DoFlush() - wait send„esult", 0)))

494 
£ndResuÉ
 = 
£nd”
.
	`G‘S’dResuÉ
();

495 #ià
CRYPTOPP_TRACE_NETWORK


496 
	`OuutDebugSŒšg
((
	`IÁToSŒšg
(()
this
è+ ": S’ˆ" + IÁToSŒšg(
£ndResuÉ
è+ " by‹s\n").
	`c_¡r
());

498 
m_bufãr
.
	`Sk
(
£ndResuÉ
);

499 
tÙ®FlushSize
 +ğ
£ndResuÉ
;

500 
m_ÃedS’dResuÉ
 = 
çl£
;

502 ià(!
m_bufãr
.
	`AnyR‘r›vabË
())

506 
timeOut
 = 
maxTime
 ? 
	`S©u¿tšgSubŒaù
(maxTime, 
tim”
.
	`EÏp£dTime
()) : 0;

507 ià(
£nd”
.
	`Mu¡Wa™ToS’d
(è&& !£nd”.
	`Wa™
(
timeOut
, 
	`C®lSck
("NetworkSink::DoFlush() - wait send", 0)))

510 
size_t
 
cÚtiguousSize
 = 0;

511 cÚ¡ 
by‹
 *
block
 = 
m_bufãr
.
	`Spy
(
cÚtiguousSize
);

513 #ià
CRYPTOPP_TRACE_NETWORK


514 
	`OuutDebugSŒšg
((
	`IÁToSŒšg
(()
this
è+ ": S’dšg " + IÁToSŒšg(
cÚtiguousSize
è+ " by‹s\n").
	`c_¡r
());

516 
£nd”
.
	`S’d
(
block
, 
cÚtiguousSize
);

517 
m_ÃedS’dResuÉ
 = 
Œue
;

519 ià(
maxTime
 > 0 && 
timeOut
 == 0)

523 
m_by‹CouÁSšûLa¡Tim”Re£t
 +ğ
tÙ®FlushSize
;

524 
	`Compu‹Cu¼’tS³ed
();

526 ià(
m_bufãr
.
	`IsEm±y
(è&& !
m_ÃedS’dResuÉ
)

528 ià(
m_eofS‹
 =ğ
EOF_PENDING_SEND
)

530 
£nd”
.
	`S’dEof
();

531 
m_eofS‹
 = 
£nd”
.
	`Mu¡Wa™FÜEof
(è? 
EOF_PENDING_DELIVERY
 : 
EOF_DONE
;

534 
m_eofS‹
 =ğ
EOF_PENDING_DELIVERY
)

536 
timeOut
 = 
maxTime
 ? 
	`S©u¿tšgSubŒaù
(maxTime, 
tim”
.
	`EÏp£dTime
()) : 0;

537 ià(!
£nd”
.
	`Wa™
(
timeOut
, 
	`C®lSck
("NetworkSink::DoFlush() - wait EOF", 0)))

540 ià(
£nd”
.
	`EofS’t
())

541 
m_eofS‹
 = 
EOF_DONE
;

545  
tÙ®FlushSize
;

546 
	}
}

550 
	gNAMESPACE_END


	@network.h

1 #iâdeà
CRYPTOPP_NETWORK_H


2 
	#CRYPTOPP_NETWORK_H


	)

4 
	~"cÚfig.h
"

6 #ifdeà
HIGHRES_TIMER_AVAILABLE


8 
	~"f‹rs.h
"

9 
	~"h¹im”.h
"

11 
	~<deque
>

13 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

15 şas 
	cLim™edBªdwidth


17 
public
:

18 
	$Lim™edBªdwidth
(
lwÜd
 
maxBy‹sP”SecÚd
 = 0)

19 : 
	`m_maxBy‹sP”SecÚd
(
maxBy‹sP”SecÚd
), 
	`m_tim”
(
Tim”
::
MILLISECONDS
)

20 , 
	$m_ÃxtT¿nsûiveTime
(0)

21 { 
m_tim”
.
	`S¹Tim”
(); }

23 
lwÜd
 
	$G‘MaxBy‹sP”SecÚd
() const

24 {  
m_maxBy‹sP”SecÚd
; 
	}
}

26 
	$S‘MaxBy‹sP”SecÚd
(
lwÜd
 
v
)

27 { 
m_maxBy‹sP”SecÚd
 = 
v
; 
	}
}

29 
lwÜd
 
Compu‹Cu¼’tT¿nsûiveLim™
();

31 
TimeToNextT¿nsûive
();

33 
NÙeT¿nsûive
(
lwÜd
 
size
);

35 
	gpublic
:

38 
	$G‘MaxWa™ObjeùCouÁ
(ècÚ¡ {  0; 
	}
}

39 
G‘Wa™Objeùs
(
Wa™ObjeùCÚš”
 &
cÚš”
, cÚ¡ 
C®lSck
 &
ÿÎSck
);

41 
	g´iv©e
:

42 
lwÜd
 
m_maxBy‹sP”SecÚd
;

44 
	g¡d
::
	tdeque
<
	t¡d
::
	t·œ
<, 
	tlwÜd
> > 
	tOpQueue
;

45 
OpQueue
 
	gm_İs
;

47 
Tim”
 
	gm_tim”
;

48 
	gm_ÃxtT¿nsûiveTime
;

50 
Compu‹NextT¿nsûiveTime
();

51 
G‘CurTimeAndCËªUp
();

55 
şass
 
CRYPTOPP_NO_VTABLE
 
	gNÚblockšgSourû
 : 
public
 
AutoSigÇlšg
<
Sourû
>,…ubliø
	gLim™edBªdwidth


57 
	gpublic
:

58 
NÚblockšgSourû
(
Bufã»dT¿nsfÜm©iÚ
 *
©chm’t
)

59 : 
m_mes§geEndS’t
(
çl£
è, 
m_doPumpBlocked
(çl£), 
m_blockedByS³edLim™
(çl£è{
D‘ach
(
©chm’t
);}

66 
size_t
 
G’”®Pump2
(
lwÜd
 &
by‹CouÁ
, 
boŞ
 
blockšgOuut
=
Œue
, 
maxTime
=
INFINITE_TIME
, boŞ 
checkD–im™”
=
çl£
, 
by‹
 
d–im™”
='\n');

68 
lwÜd
 
G’”®Pump
ÖwÜd 
maxSize
=
LWORD_MAX
, 
maxTime
=
INFINITE_TIME
, 
boŞ
 
checkD–im™”
=
çl£
, 
by‹
 
d–im™”
='\n')

70 
G’”®Pump2
(
maxSize
, 
Œue
, 
maxTime
, 
checkD–im™”
, 
d–im™”
);

71  
	gmaxSize
;

73 
lwÜd
 
TimedPump
(
maxTime
)

74 { 
G’”®Pump
(
LWORD_MAX
, 
maxTime
);}

75 
lwÜd
 
PumpLše
(
by‹
 
d–im™”
='\n',†wÜd 
maxSize
=1024)

76 { 
G’”®Pump
(
maxSize
, 
INFINITE_TIME
, 
Œue
, 
d–im™”
);}

78 
size_t
 
Pump2
(
lwÜd
 &
by‹CouÁ
, 
boŞ
 
blockšg
=
Œue
)

79 { 
G’”®Pump2
(
by‹CouÁ
, 
blockšg
, blockšg ? 
INFINITE_TIME
 : 0);}

80 
size_t
 
PumpMes§ges2
(&
mes§geCouÁ
, 
boŞ
 
blockšg
=
Œue
);

83 
	g´Ùeùed
:

84 
vœtu®
 
size_t
 
DoPump
(
lwÜd
 &
by‹CouÁ
, 
boŞ
 
blockšgOuut
,

85 
maxTime
, 
boŞ
 
checkD–im™”
, 
by‹
 
d–im™”
) =0;

87 
boŞ
 
BlockedByS³edLim™
(ècÚ¡ {  
	gm_blockedByS³edLim™
; }

89 
	g´iv©e
:

90 
boŞ
 
m_mes§geEndS’t
, 
	gm_doPumpBlocked
, 
	gm_blockedByS³edLim™
;

94 şas 
	cCRYPTOPP_NO_VTABLE
 
	mN‘wÜkReûiv”
 : 
public
 
Wa™abË


96 
public
:

97 
vœtu®
 
boŞ
 
	$Mu¡Wa™ToReûive
(è{ 
çl£
;}

98 
vœtu®
 
boŞ
 
	$Mu¡Wa™FÜResuÉ
(è{ 
çl£
;
	}
}

100 
vœtu®
 
boŞ
 
Reûive
(
by‹
* 
buf
, 
size_t
 
bufL’
) =0;

101 
vœtu®
 
G‘ReûiveResuÉ
() =0;

102 
vœtu®
 
boŞ
 
	$EofReûived
() const =0;

103 
	}
};

105 şas 
	cCRYPTOPP_NO_VTABLE
 
	mNÚblockšgSškInfo


107 
	mpublic
:

108 
vœtu®
 ~
	$NÚblockšgSškInfo
() {}

109 
vœtu®
 
size_t
 
	$G‘MaxBufãrSize
() const =0;

110 
vœtu®
 
size_t
 
	$G‘Cu¼’tBufãrSize
() const =0;

111 
vœtu®
 
boŞ
 
	$EofP’dšg
() const =0;

113 
vœtu®
 
	`Compu‹Cu¼’tS³ed
() =0;

115 
vœtu®
 
	$G‘MaxOb£rvedS³ed
() const =0;

116 
	}
};

119 
şass
 
CRYPTOPP_NO_VTABLE
 
	gNÚblockšgSšk
 : 
public
 
Sšk
,…ubliø
	gNÚblockšgSškInfo
,…ubliø
	gLim™edBªdwidth


121 
	gpublic
:

122 
NÚblockšgSšk
(è: 
m_blockedByS³edLim™
(
çl£
) {}

124 
boŞ
 
IsŞ©edFlush
(boŞ 
h¬dFlush
, boŞ 
blockšg
);

136 
lwÜd
 
TimedFlush
(
maxTime
, 
size_t
 
rg‘Size
 = 0);

138 
vœtu®
 
S‘MaxBufãrSize
(
size_t
 
maxBufãrSize
) =0;

140 
vœtu®
 
S‘AutoFlushBound
(
size_t
 
bound
) =0;

142 
	g´Ùeùed
:

143 
vœtu®
 
lwÜd
 
DoFlush
(
maxTime
, 
size_t
 
rg‘Size
) = 0;

145 
boŞ
 
BlockedByS³edLim™
(ècÚ¡ {  
	gm_blockedByS³edLim™
; }

147 
	g´iv©e
:

148 
boŞ
 
m_blockedByS³edLim™
;

152 şas 
	cCRYPTOPP_NO_VTABLE
 
	mN‘wÜkS’d”
 : 
public
 
Wa™abË


154 
public
:

155 
vœtu®
 
boŞ
 
	$Mu¡Wa™ToS’d
(è{ 
çl£
;}

156 
vœtu®
 
boŞ
 
	$Mu¡Wa™FÜResuÉ
(è{ 
çl£
;
	}
}

157 
vœtu®
 
S’d
(cÚ¡ 
by‹
* 
buf
, 
size_t
 
bufL’
) =0;

158 
vœtu®
 
G‘S’dResuÉ
() =0;

159 
vœtu®
 
boŞ
 
	$Mu¡Wa™FÜEof
(è{ 
çl£
;
	}
}

160 
vœtu®
 
S’dEof
() =0;

161 
vœtu®
 
boŞ
 
	$EofS’t
(è{ 
çl£
;
	}
}

165 şas 
	cCRYPTOPP_NO_VTABLE
 
	mN‘wÜkSourû
 : 
public
 
NÚblockšgSourû


167 
public
:

168 
N‘wÜkSourû
(
Bufã»dT¿nsfÜm©iÚ
 *
©chm’t
);

170 
	$G‘MaxWa™ObjeùCouÁ
() const;

171 
	`G‘Wa™Objeùs
(
Wa™ObjeùCÚš”
 &
cÚš”
, 
C®lSck
 cÚ¡& 
ÿÎSck
);

173 
boŞ
 
	$SourûExhau¡ed
(ècÚ¡ { 
m_d©aBegš
 =ğ
m_d©aEnd
 && 
	`G‘Reûiv”
().
	`EofReûived
();}

175 
´Ùeùed
:

176 
size_t
 
	`DoPump
(
lwÜd
 &
by‹CouÁ
, 
boŞ
 
blockšgOuut
, 
maxTime
, boŞ 
checkD–im™”
, 
by‹
 
d–im™”
);

178 
vœtu®
 
N‘wÜkReûiv”
 & 
	`AcûssReûiv”
() =0;

179 cÚ¡ 
N‘wÜkReûiv”
 & 
	$G‘Reûiv”
(ècÚ¡ { 
cÚ¡_ÿ¡
<
N‘wÜkSourû
 *>(
this
)->
	`AcûssReûiv”
();
	}
}

181 
	g´iv©e
:

182 
SecBy‹Block
 
m_buf
;

183 
size_t
 
	gm_putSize
, 
	gm_d©aBegš
, 
	gm_d©aEnd
;

184 
boŞ
 
	gm_wa™šgFÜResuÉ
, 
	gm_ouutBlocked
;

188 şas 
	cCRYPTOPP_NO_VTABLE
 
	mN‘wÜkSšk
 : 
public
 
NÚblockšgSšk


190 
public
:

191 
N‘wÜkSšk
(
maxBufãrSize
, 
autoFlushBound
);

193 
	$G‘MaxWa™ObjeùCouÁ
() const;

194 
	`G‘Wa™Objeùs
(
Wa™ObjeùCÚš”
 &
cÚš”
, 
C®lSck
 cÚ¡& 
ÿÎSck
);

196 
size_t
 
	`Put2
(cÚ¡ 
by‹
 *
šSŒšg
, size_ˆ
Ëngth
, 
mes§geEnd
, 
boŞ
 
blockšg
);

198 
	$S‘MaxBufãrSize
(
size_t
 
maxBufãrSize
è{
m_maxBufãrSize
 = maxBufãrSize; 
m_bufãr
.
	`S‘NodeSize
(
	`UnsigÃdMš
(maxBufferSize, 16U*1024U+256U));}

199 
	$S‘AutoFlushBound
(
size_t
 
bound
è{
m_autoFlushBound
 = bound;
	}
}

201 
size_t
 
	$G‘MaxBufãrSize
(ècÚ¡ { 
m_maxBufãrSize
;
	}
}

202 
size_t
 
	$G‘Cu¼’tBufãrSize
(ècÚ¡ { (
size_t
)
m_bufãr
.
	`Cu¼’tSize
();
	}
}

204 
	$CË¬Bufãr
(è{ 
m_bufãr
.
	`CË¬
(); 
	}
}

206 
boŞ
 
	$EofP’dšg
(ècÚ¡ {  
m_eofS‹
 > 
EOF_NONE
 && m_eofS‹ < 
EOF_DONE
; 
	}
}

209 
Compu‹Cu¼’tS³ed
();

211 
	$G‘MaxOb£rvedS³ed
() const;

213 
´Ùeùed
:

214 
lwÜd
 
	`DoFlush
(
maxTime
, 
size_t
 
rg‘Size
);

216 
vœtu®
 
N‘wÜkS’d”
 & 
	`AcûssS’d”
() =0;

217 cÚ¡ 
N‘wÜkS’d”
 & 
	$G‘S’d”
(ècÚ¡ { 
cÚ¡_ÿ¡
<
N‘wÜkSšk
 *>(
this
)->
	`AcûssS’d”
();
	}
}

219 
	g´iv©e
:

220 
	eEofS‹
 { 
EOF_NONE
, 
	gEOF_PENDING_SEND
, 
	gEOF_PENDING_DELIVERY
, 
	gEOF_DONE
 };

222 
size_t
 
	gm_maxBufãrSize
, 
	gm_autoFlushBound
;

223 
boŞ
 
	gm_ÃedS’dResuÉ
, 
	gm_wasBlocked
;

224 
EofS‹
 
	gm_eofS‹
;

225 
By‹Queue
 
	gm_bufãr
;

226 
size_t
 
	gm_skBy‹s
;

227 
Tim”
 
	gm_¥“dTim”
;

228 
	gm_by‹CouÁSšûLa¡Tim”Re£t
, 
	gm_cu¼’tS³ed
, 
	gm_maxOb£rvedS³ed
;

231 
	gNAMESPACE_END


	@nr.h

1 #iâdeà
CRYPTOPP_NR_H


2 
	#CRYPTOPP_NR_H


	)

4 
	~"gåüy±.h
"

	@oaep.cpp

3 
	~"pch.h
"

5 #iâdeà
CRYPTOPP_IMPORTS


7 
	~"ß•.h
"

8 
	~<funùiÚ®
>

10 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

14 
size_t
 
OAEP_Ba£
::
	$MaxUÅaddedL’gth
(
size_t
 
·ddedL’gth
) const

16  
	`S©u¿tšgSubŒaù
(
·ddedL’gth
/8, 1+2*
	`Dige¡Size
());

17 
	}
}

19 
	gOAEP_Ba£
::
	$Pad
(
RªdomNumb”G’”©Ü
 &
ºg
, cÚ¡ 
by‹
 *
šput
, 
size_t
 
šputL’gth
, by‹ *
ß•Block
, size_ˆ
ß•BlockL’
, cÚ¡ 
NameV®uePaœs
 &
·¿m‘”s
) const

21 
	`as£¹
 (
šputL’gth
 <ğ
	`MaxUÅaddedL’gth
(
ß•BlockL’
));

24 ià(
ß•BlockL’
 % 8 != 0)

26 
ß•Block
[0] = 0;

27 
ß•Block
++;

29 
ß•BlockL’
 /= 8;

31 
¡d
::
auto_±r
<
HashT¿nsfÜm©iÚ
> 
	`pHash
(
	`NewHash
());

32 cÚ¡ 
size_t
 
hL’
 = 
pHash
->
	`Dige¡Size
();

33 cÚ¡ 
size_t
 
£edL’
 = 
hL’
, 
dbL’
 = 
ß•BlockL’
-seedLen;

34 
by‹
 *cÚ¡ 
maskedS“d
 = 
ß•Block
;

35 
by‹
 *cÚ¡ 
maskedDB
 = 
ß•Block
+
£edL’
;

37 
CÚ¡By‹A¼ayP¬am‘”
 
’codšgP¬am‘”s
;

38 
·¿m‘”s
.
	`G‘V®ue
(
Name
::
	`EncodšgP¬am‘”s
(), 
’codšgP¬am‘”s
);

41 
pHash
->
	`C®cuÏ‹Dige¡
(
maskedDB
, 
’codšgP¬am‘”s
.
	`begš
(),ƒncodšgP¬am‘”s.
	`size
());

42 
	`mem£t
(
maskedDB
+
hL’
, 0, 
dbL’
-hL’-
šputL’gth
-1);

43 
maskedDB
[
dbL’
-
šputL’gth
-1] = 0x01;

44 
	`memıy
(
maskedDB
+
dbL’
-
šputL’gth
, 
šput
, inputLength);

46 
ºg
.
	`G’”©eBlock
(
maskedS“d
, 
£edL’
);

47 
¡d
::
auto_±r
<
MaskG’”©šgFunùiÚ
> 
	`pMGF
(
	`NewMGF
());

48 
pMGF
->
	`G’”©eAndMask
(*
pHash
, 
maskedDB
, 
dbL’
, 
maskedS“d
, 
£edL’
);

49 
pMGF
->
	`G’”©eAndMask
(*
pHash
, 
maskedS“d
, 
£edL’
, 
maskedDB
, 
dbL’
);

50 
	}
}

52 
DecodšgResuÉ
 
	gOAEP_Ba£
::
	$UÅad
(cÚ¡ 
by‹
 *
ß•Block
, 
size_t
 
ß•BlockL’
, by‹ *
ouut
, cÚ¡ 
NameV®uePaœs
 &
·¿m‘”s
) const

54 
boŞ
 
šv®id
 = 
çl£
;

57 ià(
ß•BlockL’
 % 8 != 0)

59 
šv®id
 = (
ß•Block
[0] != 0) || invalid;

60 
ß•Block
++;

62 
ß•BlockL’
 /= 8;

64 
¡d
::
auto_±r
<
HashT¿nsfÜm©iÚ
> 
	`pHash
(
	`NewHash
());

65 cÚ¡ 
size_t
 
hL’
 = 
pHash
->
	`Dige¡Size
();

66 cÚ¡ 
size_t
 
£edL’
 = 
hL’
, 
dbL’
 = 
ß•BlockL’
-seedLen;

68 
šv®id
 = (
ß•BlockL’
 < 2*
hL’
+1) || invalid;

70 
SecBy‹Block
 
	`t
(
ß•Block
, 
ß•BlockL’
);

71 
by‹
 *cÚ¡ 
maskedS“d
 = 
t
;

72 
by‹
 *cÚ¡ 
maskedDB
 = 
t
+
£edL’
;

74 
¡d
::
auto_±r
<
MaskG’”©šgFunùiÚ
> 
	`pMGF
(
	`NewMGF
());

75 
pMGF
->
	`G’”©eAndMask
(*
pHash
, 
maskedS“d
, 
£edL’
, 
maskedDB
, 
dbL’
);

76 
pMGF
->
	`G’”©eAndMask
(*
pHash
, 
maskedDB
, 
dbL’
, 
maskedS“d
, 
£edL’
);

78 
CÚ¡By‹A¼ayP¬am‘”
 
’codšgP¬am‘”s
;

79 
·¿m‘”s
.
	`G‘V®ue
(
Name
::
	`EncodšgP¬am‘”s
(), 
’codšgP¬am‘”s
);

82 
by‹
 *
M
 = 
¡d
::
	`fšd
(
maskedDB
+
hL’
, maskedDB+
dbL’
, 0x01);

83 
šv®id
 = (
M
 =ğ
maskedDB
+
dbL’
) || invalid;

84 
šv®id
 = (
¡d
::
	`fšd_if
(
maskedDB
+
hL’
, 
M
, std::
	`bšd2nd
(¡d::
nÙ_equ®_to
<
by‹
>(), 0)) != M) || invalid;

85 
šv®id
 = !
pHash
->
	`V”ifyDige¡
(
maskedDB
, 
’codšgP¬am‘”s
.
	`begš
(),ƒncodšgP¬am‘”s.
	`size
()) || invalid;

87 ià(
šv®id
)

88  
	`DecodšgResuÉ
();

90 
M
++;

91 
	`memıy
(
ouut
, 
M
, 
maskedDB
+
dbL’
-M);

92  
	`DecodšgResuÉ
(
maskedDB
+
dbL’
-
M
);

93 
	}
}

95 
	gNAMESPACE_END


	@oaep.h

1 #iâdeà
CRYPTOPP_OAEP_H


2 
	#CRYPTOPP_OAEP_H


	)

4 
	~"pubkey.h
"

5 
	~"sha.h
"

7 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

10 şas 
	cCRYPTOPP_DLL
 
OAEP_Ba£
 : 
public
 
PK_Enüy±iÚMes§geEncodšgM‘hod


12 
public
:

13 
boŞ
 
	$P¬am‘”SuµÜ‹d
(cÚ¡ *
Çme
ècÚ¡ { 
	`¡rcmp
Òame, 
Name
::
	`EncodšgP¬am‘”s
()) == 0;}

14 
size_t
 
	$MaxUÅaddedL’gth
(
size_t
 
·ddedL’gth
) const;

15 
	$Pad
(
RªdomNumb”G’”©Ü
 &
ºg
, cÚ¡ 
by‹
 *
¿w
, 
size_t
 
šputL’gth
, by‹ *
·dded
, size_ˆ
·ddedL’gth
, cÚ¡ 
NameV®uePaœs
 &
·¿m‘”s
) const;

16 
DecodšgResuÉ
 
	$UÅad
(cÚ¡ 
by‹
 *
·dded
, 
size_t
 
·ddedL’gth
, by‹ *
¿w
, cÚ¡ 
NameV®uePaœs
 &
·¿m‘”s
) const;

18 
´Ùeùed
:

19 
vœtu®
 
	$Dige¡Size
() const =0;

20 
vœtu®
 
HashT¿nsfÜm©iÚ
 * 
	$NewHash
() const =0;

21 
vœtu®
 
MaskG’”©šgFunùiÚ
 * 
	$NewMGF
() const =0;

22 
	}
};

25 
	g‹m¶©e
 <
şass
 
	gH
, cÏs 
	gMGF
=
P1363_MGF1
>

26 
şass
 
OAEP
 : 
public
 
OAEP_Ba£
,…ubliø
	gEnüy±iÚSnd¬d


28 
	gpublic
:

29 
¡d
::
¡ršg
 
CRYPTOPP_API
 
SticAlgÜ™hmName
(è{ std::¡ršg("OAEP-"è+ 
MGF
::SticAlgÜ™hmName(è+ "(" + 
H
::StaticAlgorithmName() + ")";}

30 
	gOAEP
<
	tH
, 
	tMGF
> 
	tEnüy±iÚMes§geEncodšgM‘hod
;

32 
	g´Ùeùed
:

33 
Dige¡Size
(ècÚ¡ { 
H
::
DIGESTSIZE
;}

34 
HashT¿nsfÜm©iÚ
 * 
NewHash
(ècÚ¡ { 
Ãw
 
	gH
;}

35 
MaskG’”©šgFunùiÚ
 * 
NewMGF
(ècÚ¡ { 
Ãw
 
	gMGF
;}

38 
CRYPTOPP_DLL_TEMPLATE_CLASS
 
	gOAEP
<
	gSHA
>;

40 
	gNAMESPACE_END


	@oids.h

1 #iâdeà
CRYPTOPP_OIDS_H


2 
	#CRYPTOPP_OIDS_H


	)

6 
	~"a¢.h
"

8 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

10 
	$NAMESPACE_BEGIN
(
ASN1
)

12 
	#DEFINE_OID
(
v®ue
, 
Çme
è
šlše
 
OID
 
	`Çme
(è{ v®ue;
	}

	)
}

14 
	$DEFINE_OID
(1, 
iso
)

15 
	`DEFINE_OID
(
	`iso
()+2, 
memb”_body
)

16 
	`DEFINE_OID
(
	`memb”_body
()+840, 
iso_us
)

17 
	`DEFINE_OID
(
	`iso_us
()+10040, 
ªsi_x9_57
)

18 
	`DEFINE_OID
(
	`ªsi_x9_57
()+4+1, 
id_d§
)

19 
	`DEFINE_OID
(
	`iso_us
()+10045, 
ªsi_x9_62
)

20 
	`DEFINE_OID
(
	`ªsi_x9_62
()+1, 
id_f›ldTy³
)

21 
	`DEFINE_OID
(
	`id_f›ldTy³
()+1, 
´ime_f›ld
)

22 
	`DEFINE_OID
(
	`id_f›ldTy³
()+2, 
ch¬aù”i¡ic_two_f›ld
)

23 
	`DEFINE_OID
(
	`ch¬aù”i¡ic_two_f›ld
()+3, 
id_ch¬aù”i¡ic_two_basis
)

24 
	`DEFINE_OID
(
	`id_ch¬aù”i¡ic_two_basis
()+1, 
gnBasis
)

25 
	`DEFINE_OID
(
	`id_ch¬aù”i¡ic_two_basis
()+2, 
Basis
)

26 
	`DEFINE_OID
(
	`id_ch¬aù”i¡ic_two_basis
()+3, 
µBasis
)

27 
	`DEFINE_OID
(
	`ªsi_x9_62
()+2, 
id_publicKeyTy³
)

28 
	`DEFINE_OID
(
	`id_publicKeyTy³
()+1, 
id_ecPublicKey
)

29 
	`DEFINE_OID
(
	`ªsi_x9_62
()+3, 
ªsi_x9_62_curves
)

30 
	`DEFINE_OID
(
	`ªsi_x9_62_curves
()+1, 
ªsi_x9_62_curves_´ime
)

31 
	`DEFINE_OID
(
	`ªsi_x9_62_curves_´ime
()+1, 
£ı192r1
)

32 
	`DEFINE_OID
(
	`ªsi_x9_62_curves_´ime
()+7, 
£ı256r1
)

33 
	`DEFINE_OID
(
	`iso_us
()+113549, 
r§dsi
)

34 
	`DEFINE_OID
(
	`r§dsi
()+1, 
pkcs
)

35 
	`DEFINE_OID
(
	`pkcs
()+1, 
pkcs_1
)

36 
	`DEFINE_OID
(
	`pkcs_1
()+1, 
r§Enüy±iÚ
);

37 
	`DEFINE_OID
(
	`r§dsi
()+2, 
r§dsi_dige¡AlgÜ™hm
)

38 
	`DEFINE_OID
(
	`r§dsi_dige¡AlgÜ™hm
()+2, 
id_md2
)

39 
	`DEFINE_OID
(
	`r§dsi_dige¡AlgÜ™hm
()+5, 
id_md5
)

40 
	`DEFINE_OID
(
	`iso
()+3, 
id’tif›d_Ügªiz©iÚ
);

41 
	`DEFINE_OID
(
	`id’tif›d_Ügªiz©iÚ
()+14, 
oiw
);

42 
	`DEFINE_OID
(
	`oiw
()+3, 
oiw_£csig
);

43 
	`DEFINE_OID
(
	`oiw_£csig
()+2, 
oiw_£csig_®gÜ™hms
);

44 
	`DEFINE_OID
(
	`oiw_£csig_®gÜ™hms
()+26, 
id_sha1
);

46 
	`DEFINE_OID
(
	`id’tif›d_Ügªiz©iÚ
()+36, 
‹ËŒu¡
);

47 
	`DEFINE_OID
(
	`‹ËŒu¡
()+3, 
‹ËŒu¡_®gÜ™hm
)

48 
	`DEFINE_OID
(
	`‹ËŒu¡_®gÜ™hm
()+2+1, 
id_remd160
)

49 
	`DEFINE_OID
(
	`‹ËŒu¡_®gÜ™hm
()+3+2+8+1, 
‹ËŒu¡_–lticCurve
)

50 
	`DEFINE_OID
(
	`‹ËŒu¡_–lticCurve
()+1+1, 
b¿špoŞP160r1
)

51 
	`DEFINE_OID
(
	`‹ËŒu¡_–lticCurve
()+1+3, 
b¿špoŞP192r1
)

52 
	`DEFINE_OID
(
	`‹ËŒu¡_–lticCurve
()+1+5, 
b¿špoŞP224r1
)

53 
	`DEFINE_OID
(
	`‹ËŒu¡_–lticCurve
()+1+7, 
b¿špoŞP256r1
)

54 
	`DEFINE_OID
(
	`‹ËŒu¡_–lticCurve
()+1+9, 
b¿špoŞP320r1
)

55 
	`DEFINE_OID
(
	`‹ËŒu¡_–lticCurve
()+1+11, 
b¿špoŞP384r1
)

56 
	`DEFINE_OID
(
	`‹ËŒu¡_–lticCurve
()+1+13, 
b¿špoŞP512r1
)

58 
	`DEFINE_OID
(
	`id’tif›d_Ügªiz©iÚ
()+132, 
û¹icom
);

59 
	`DEFINE_OID
(
	`û¹icom
()+0, 
û¹icom_–lticCurve
);

62 
	`DEFINE_OID
(
	`û¹icom_–lticCurve
()+6, 
£ı112r1
);

63 
	`DEFINE_OID
(
	`û¹icom_–lticCurve
()+7, 
£ı112r2
);

64 
	`DEFINE_OID
(
	`û¹icom_–lticCurve
()+8, 
£ı160r1
);

65 
	`DEFINE_OID
(
	`û¹icom_–lticCurve
()+9, 
£ı160k1
);

66 
	`DEFINE_OID
(
	`û¹icom_–lticCurve
()+10, 
£ı256k1
);

67 
	`DEFINE_OID
(
	`û¹icom_–lticCurve
()+28, 
£ı128r1
);

68 
	`DEFINE_OID
(
	`û¹icom_–lticCurve
()+29, 
£ı128r2
);

69 
	`DEFINE_OID
(
	`û¹icom_–lticCurve
()+30, 
£ı160r2
);

70 
	`DEFINE_OID
(
	`û¹icom_–lticCurve
()+31, 
£ı192k1
);

71 
	`DEFINE_OID
(
	`û¹icom_–lticCurve
()+32, 
£ı224k1
);

72 
	`DEFINE_OID
(
	`û¹icom_–lticCurve
()+33, 
£ı224r1
);

73 
	`DEFINE_OID
(
	`û¹icom_–lticCurve
()+34, 
£ı384r1
);

74 
	`DEFINE_OID
(
	`û¹icom_–lticCurve
()+35, 
£ı521r1
);

76 
	`DEFINE_OID
(
	`û¹icom_–lticCurve
()+1, 
£ù163k1
);

77 
	`DEFINE_OID
(
	`û¹icom_–lticCurve
()+2, 
£ù163r1
);

78 
	`DEFINE_OID
(
	`û¹icom_–lticCurve
()+3, 
£ù239k1
);

79 
	`DEFINE_OID
(
	`û¹icom_–lticCurve
()+4, 
£ù113r1
);

80 
	`DEFINE_OID
(
	`û¹icom_–lticCurve
()+5, 
£ù113r2
);

81 
	`DEFINE_OID
(
	`û¹icom_–lticCurve
()+15, 
£ù163r2
);

82 
	`DEFINE_OID
(
	`û¹icom_–lticCurve
()+16, 
£ù283k1
);

83 
	`DEFINE_OID
(
	`û¹icom_–lticCurve
()+17, 
£ù283r1
);

84 
	`DEFINE_OID
(
	`û¹icom_–lticCurve
()+22, 
£ù131r1
);

85 
	`DEFINE_OID
(
	`û¹icom_–lticCurve
()+23, 
£ù131r2
);

86 
	`DEFINE_OID
(
	`û¹icom_–lticCurve
()+24, 
£ù193r1
);

87 
	`DEFINE_OID
(
	`û¹icom_–lticCurve
()+25, 
£ù193r2
);

88 
	`DEFINE_OID
(
	`û¹icom_–lticCurve
()+26, 
£ù233k1
);

89 
	`DEFINE_OID
(
	`û¹icom_–lticCurve
()+27, 
£ù233r1
);

90 
	`DEFINE_OID
(
	`û¹icom_–lticCurve
()+36, 
£ù409k1
);

91 
	`DEFINE_OID
(
	`û¹icom_–lticCurve
()+37, 
£ù409r1
);

92 
	`DEFINE_OID
(
	`û¹icom_–lticCurve
()+38, 
£ù571k1
);

93 
	`DEFINE_OID
(
	`û¹icom_–lticCurve
()+39, 
£ù571r1
);

94 
	$DEFINE_OID
(2, 
jošt_iso_cc™t
)

95 
	`DEFINE_OID
(
	`jošt_iso_cc™t
()+16, 
couÁry
)

96 
	`DEFINE_OID
(
	`couÁry
()+840, 
jošt_iso_cc™t_us
)

97 
	`DEFINE_OID
(
	`jošt_iso_cc™t_us
()+1, 
us_Ügªiz©iÚ
)

98 
	`DEFINE_OID
(
	`us_Ügªiz©iÚ
()+101, 
us_gov
)

99 
	`DEFINE_OID
(
	`us_gov
()+3, 
csÜ
)

100 
	`DEFINE_OID
(
	`csÜ
()+4, 
ni¡®gÜ™hms
)

101 
	`DEFINE_OID
(
	`ni¡®gÜ™hms
()+1, 
«s
)

102 
	`DEFINE_OID
(
	`«s
()+1, 
id_«s128_ECB
)

103 
	`DEFINE_OID
(
	`«s
()+2, 
id_«s128_cbc
)

104 
	`DEFINE_OID
(
	`«s
()+3, 
id_«s128_ofb
)

105 
	`DEFINE_OID
(
	`«s
()+4, 
id_«s128_cfb
)

106 
	`DEFINE_OID
(
	`«s
()+21, 
id_«s192_ECB
)

107 
	`DEFINE_OID
(
	`«s
()+22, 
id_«s192_cbc
)

108 
	`DEFINE_OID
(
	`«s
()+23, 
id_«s192_ofb
)

109 
	`DEFINE_OID
(
	`«s
()+24, 
id_«s192_cfb
)

110 
	`DEFINE_OID
(
	`«s
()+41, 
id_«s256_ECB
)

111 
	`DEFINE_OID
(
	`«s
()+42, 
id_«s256_cbc
)

112 
	`DEFINE_OID
(
	`«s
()+43, 
id_«s256_ofb
)

113 
	`DEFINE_OID
(
	`«s
()+44, 
id_«s256_cfb
)

114 
	`DEFINE_OID
(
	`ni¡®gÜ™hms
()+2, 
ni¡_hash®gs
)

115 
	`DEFINE_OID
(
	`ni¡_hash®gs
()+1, 
id_sha256
)

116 
	`DEFINE_OID
(
	`ni¡_hash®gs
()+2, 
id_sha384
)

117 
	`DEFINE_OID
(
	`ni¡_hash®gs
()+3, 
id_sha512
)

119 
NAMESPACE_END


121 
NAMESPACE_END


	@osrng.cpp

5 
	~"pch.h
"

7 #iâdeà
CRYPTOPP_IMPORTS


9 
	~"o¤ng.h
"

11 #ifdeà
OS_RNG_AVAILABLE


13 
	~"ºg.h
"

15 #ifdeà
CRYPTOPP_WIN32_AVAILABLE


16 #iâdeà
_WIN32_WINNT


17 
	#_WIN32_WINNT
 0x0400

	)

19 
	~<wšdows.h
>

20 
	~<wšüy±.h
>

23 #ifdeà
CRYPTOPP_UNIX_AVAILABLE


24 
	~<”ºo.h
>

25 
	~<fú.h
>

26 
	~<uni¡d.h
>

29 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

31 #ià
	`defšed
(
NONBLOCKING_RNG_AVAILABLE
è|| defšed(
BLOCKING_RNG_AVAILABLE
)

32 
OS_RNG_E¼
::
	$OS_RNG_E¼
(cÚ¡ 
¡d
::
¡ršg
 &
İ”©iÚ
)

33 : 
	`Exû±iÚ
(
OTHER_ERROR
, "OS_Rng: " + 
İ”©iÚ
 + " operation failed withƒrror " +

34 #ifdeà
CRYPTOPP_WIN32_AVAILABLE


35 "0x" + 
	`IÁToSŒšg
(
	`G‘La¡E¼Ü
(), 16)

37 
	$IÁToSŒšg
(
”ºo
)

41 
	}
}

44 #ifdeà
NONBLOCKING_RNG_AVAILABLE


46 #ifdeà
CRYPTOPP_WIN32_AVAILABLE


48 
	gMiüosoáCry±oProvid”
::
	$MiüosoáCry±oProvid”
()

50 if(!
	`Cry±AcquœeCÚ‹xt
(&
m_hProvid”
, 0, 0, 
PROV_RSA_FULL
, 
CRYPT_VERIFYCONTEXT
))

51 
throw
 
	`OS_RNG_E¼
("CryptAcquireContext");

52 
	}
}

54 
	gMiüosoáCry±oProvid”
::~
	$MiüosoáCry±oProvid”
()

56 
	`Cry±R–—£CÚ‹xt
(
m_hProvid”
, 0);

57 
	}
}

61 
	gNÚblockšgRng
::
	$NÚblockšgRng
()

63 #iâdeà
CRYPTOPP_WIN32_AVAILABLE


64 
m_fd
 = 
	`İ’
("/dev/u¿ndom",
O_RDONLY
);

65 ià(
m_fd
 == -1)

66 
throw
 
	`OS_RNG_E¼
("open /dev/urandom");

68 
	}
}

70 
	gNÚblockšgRng
::~
	$NÚblockšgRng
()

72 #iâdeà
CRYPTOPP_WIN32_AVAILABLE


73 
	`şo£
(
m_fd
);

75 
	}
}

77 
	gNÚblockšgRng
::
	$G’”©eBlock
(
by‹
 *
ouut
, 
size_t
 
size
)

79 #ifdeà
CRYPTOPP_WIN32_AVAILABLE


80 #ifdeà
WORKAROUND_MS_BUG_Q258000


81 cÚ¡ 
MiüosoáCry±oProvid”
 &
m_Provid”
 = 
SšgËtÚ
<MiüosoáCry±oProvid”>().
	`Ref
();

83 ià(!
	`Cry±G’Rªdom
(
m_Provid”
.
	`G‘Provid”HªdË
(), (
DWORD
)
size
, 
ouut
))

84 
throw
 
	`OS_RNG_E¼
("CryptGenRandom");

86 
size
)

88 
ssize_t
 
Ën
 = 
	`»ad
(
m_fd
, 
ouut
, 
size
);

90 ià(
Ën
 < 0)

93 ià(
”ºo
 !ğ
EINTR
 &&ƒ¼nØ!ğ
EAGAIN
)

94 
throw
 
	`OS_RNG_E¼
("read /dev/urandom");

99 
ouut
 +ğ
Ën
;

100 
size
 -ğ
Ën
;

103 
	}
}

109 #ifdeà
BLOCKING_RNG_AVAILABLE


111 #iâdeà
CRYPTOPP_BLOCKING_RNG_FILENAME


112 #ifdeà
__O³nBSD__


113 
	#CRYPTOPP_BLOCKING_RNG_FILENAME
 "/dev/¤ªdom"

	)

115 
	#CRYPTOPP_BLOCKING_RNG_FILENAME
 "/dev/¿ndom"

	)

119 
	gBlockšgRng
::
	$BlockšgRng
()

121 
m_fd
 = 
	`İ’
(
CRYPTOPP_BLOCKING_RNG_FILENAME
,
O_RDONLY
);

122 ià(
m_fd
 == -1)

123 
throw
 
	`OS_RNG_E¼
("İ’ " 
CRYPTOPP_BLOCKING_RNG_FILENAME
);

124 
	}
}

126 
	gBlockšgRng
::~
	$BlockšgRng
()

128 
	`şo£
(
m_fd
);

129 
	}
}

131 
	gBlockšgRng
::
	$G’”©eBlock
(
by‹
 *
ouut
, 
size_t
 
size
)

133 
size
)

137 
ssize_t
 
Ën
 = 
	`»ad
(
m_fd
, 
ouut
, 
size
);

138 ià(
Ën
 < 0)

141 ià(
”ºo
 !ğ
EINTR
 &&ƒ¼nØ!ğ
EAGAIN
)

142 
throw
 
	`OS_RNG_E¼
("»ad " 
CRYPTOPP_BLOCKING_RNG_FILENAME
);

147 
size
 -ğ
Ën
;

148 
ouut
 +ğ
Ën
;

149 ià(
size
)

150 
	`¦“p
(1);

152 
	}
}

158 
	$OS_G’”©eRªdomBlock
(
boŞ
 
blockšg
, 
by‹
 *
ouut
, 
size_t
 
size
)

160 #ifdeà
NONBLOCKING_RNG_AVAILABLE


161 ià(
blockšg
)

164 #ifdeà
BLOCKING_RNG_AVAILABLE


165 
BlockšgRng
 
ºg
;

166 
ºg
.
	`G’”©eBlock
(
ouut
, 
size
);

170 #ifdeà
BLOCKING_RNG_AVAILABLE


171 ià(!
blockšg
)

174 #ifdeà
NONBLOCKING_RNG_AVAILABLE


175 
NÚblockšgRng
 
ºg
;

176 
ºg
.
	`G’”©eBlock
(
ouut
, 
size
);

179 
	}
}

181 
	gAutoS“dedRªdomPoŞ
::
	$Re£ed
(
boŞ
 
blockšg
, 
£edSize
)

183 
SecBy‹Block
 
	`£ed
(
£edSize
);

184 
	`OS_G’”©eRªdomBlock
(
blockšg
, 
£ed
, 
£edSize
);

185 
	`IncÜpÜ©eEÁrİy
(
£ed
, 
£edSize
);

186 
	}
}

188 
	gNAMESPACE_END


	@osrng.h

1 #iâdeà
CRYPTOPP_OSRNG_H


2 
	#CRYPTOPP_OSRNG_H


	)

6 
	~"cÚfig.h
"

8 #ifdeà
OS_RNG_AVAILABLE


10 
	~"¿ndpoŞ.h
"

11 
	~"ºg.h
"

12 
	~"«s.h
"

13 
	~"sha.h
"

14 
	~"fs140.h
"

16 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

19 şas 
	cCRYPTOPP_DLL
 
OS_RNG_E¼
 : 
public
 
Exû±iÚ


21 
public
:

22 
	`OS_RNG_E¼
(cÚ¡ 
¡d
::
¡ršg
 &
İ”©iÚ
);

25 #ifdeà
NONBLOCKING_RNG_AVAILABLE


27 #ifdeà
CRYPTOPP_WIN32_AVAILABLE


28 şas 
	cCRYPTOPP_DLL
 
MiüosoáCry±oProvid”


30 
public
:

31 
	`MiüosoáCry±oProvid”
();

32 ~
	`MiüosoáCry±oProvid”
();

33 #ià
	$defšed
(
_WIN64
)

34 
	t__št64
 
	tProvid”HªdË
;

36 
	tProvid”HªdË
;

38 
Provid”HªdË
 
	$G‘Provid”HªdË
(ècÚ¡ { 
m_hProvid”
;}

39 
´iv©e
:

40 
Provid”HªdË
 
m_hProvid”
;

41 
	}
};

43 #´agm¨
comm’t
(
lib
, "advapi32.lib")

47 şas 
	cCRYPTOPP_DLL
 
	mNÚblockšgRng
 : 
public
 
RªdomNumb”G’”©Ü


49 
public
:

50 
NÚblockšgRng
();

51 ~
NÚblockšgRng
();

52 
G’”©eBlock
(
by‹
 *
ouut
, 
size_t
 
size
);

54 
	m´Ùeùed
:

55 #ifdeà
CRYPTOPP_WIN32_AVAILABLE


56 #iâdeà
WORKAROUND_MS_BUG_Q258000


57 
MiüosoáCry±oProvid”
 
m_Provid”
;

60 
	mm_fd
;

66 #ifdeà
BLOCKING_RNG_AVAILABLE


69 şas 
	cCRYPTOPP_DLL
 
	mBlockšgRng
 : 
public
 
RªdomNumb”G’”©Ü


71 
public
:

72 
BlockšgRng
();

73 ~
BlockšgRng
();

74 
G’”©eBlock
(
by‹
 *
ouut
, 
size_t
 
size
);

76 
	m´Ùeùed
:

77 
m_fd
;

82 
CRYPTOPP_DLL
 
CRYPTOPP_API
 
OS_G’”©eRªdomBlock
(
boŞ
 
blockšg
, 
by‹
 *
ouut
, 
size_t
 
size
);

86 şas 
	cCRYPTOPP_DLL
 
	mAutoS“dedRªdomPoŞ
 : 
public
 
RªdomPoŞ


88 
public
:

90 
ex¶ic™
 
	$AutoS“dedRªdomPoŞ
(
boŞ
 
blockšg
 = 
çl£
, 
£edSize
 = 32)

91 {
	`Re£ed
(
blockšg
, 
£edSize
);}

92 
	`Re£ed
(
boŞ
 
blockšg
 = 
çl£
, 
£edSize
 = 32);

93 
	}
};

96 
	g‹m¶©e
 <
şass
 
	gBLOCK_CIPHER
>

97 
şass
 
	gAutoS“dedX917RNG
 : 
public
 
RªdomNumb”G’”©Ü
,…ubliø
	gNÙCİyabË


99 
	gpublic
:

101 
ex¶ic™
 
AutoS“dedX917RNG
(
boŞ
 
blockšg
 = 
çl£
, boŞ 
autoS“d
 = 
Œue
)

102 {ià(
autoS“d
è
Re£ed
(
blockšg
);}

103 
Re£ed
(
boŞ
 
blockšg
 = 
çl£
, cÚ¡ 
by‹
 *
add™iÚ®EÁrİy
 = 
NULL
, 
size_t
 
Ëngth
 = 0);

105 
Re£ed
(cÚ¡ 
by‹
 *
key
, 
size_t
 
keyËngth
, cÚ¡ by‹ *
£ed
, cÚ¡ by‹ *
timeVeùÜ
);

107 
boŞ
 
CªIncÜpÜ©eEÁrİy
(ècÚ¡ { 
	gŒue
;}

108 
IncÜpÜ©eEÁrİy
(cÚ¡ 
by‹
 *
šput
, 
size_t
 
Ëngth
è{
Re£ed
(
çl£
, input,†ength);}

109 
G’”©eIÁoBufã»dT¿nsfÜm©iÚ
(
Bufã»dT¿nsfÜm©iÚ
 &
rg‘
, cÚ¡ 
¡d
::
¡ršg
 &
chªÃl
, 
lwÜd
 
Ëngth
è{
	gm_ºg
->GenerateIntoBufferedTransformation(target, channel,†ength);}

111 
	g´iv©e
:

112 
memb”_±r
<
RªdomNumb”G’”©Ü
> 
m_ºg
;

115 
	g‹m¶©e
 <
şass
 
	gBLOCK_CIPHER
>

116 
	gAutoS“dedX917RNG
<
	gBLOCK_CIPHER
>::
	$Re£ed
(cÚ¡ 
by‹
 *
key
, 
size_t
 
keyËngth
, cÚ¡ by‹ *
£ed
, cÚ¡ by‹ *
timeVeùÜ
)

118 
m_ºg
.
	`»£t
(
Ãw
 
	`X917RNG
Òew 
ty³Çme
 
BLOCK_CIPHER
::
	`Enüy±iÚ
(
key
, 
keyËngth
), 
£ed
, 
timeVeùÜ
));

119 
	}
}

121 
	g‹m¶©e
 <
şass
 
	gBLOCK_CIPHER
>

122 
	gAutoS“dedX917RNG
<
	gBLOCK_CIPHER
>::
	$Re£ed
(
boŞ
 
blockšg
, cÚ¡ 
by‹
 *
šput
, 
size_t
 
Ëngth
)

124 
SecBy‹Block
 
	`£ed
(
BLOCK_CIPHER
::
BLOCKSIZE
 + BLOCK_CIPHER::
DEFAULT_KEYLENGTH
);

125 cÚ¡ 
by‹
 *
key
;

128 
	`OS_G’”©eRªdomBlock
(
blockšg
, 
£ed
, s“d.
	`size
());

129 ià(
Ëngth
 > 0)

131 
SHA256
 
hash
;

132 
hash
.
	`Upd©e
(
£ed
, s“d.
	`size
());

133 
hash
.
	`Upd©e
(
šput
, 
Ëngth
);

134 
hash
.
	`Trunÿ‹dFš®
(
£ed
, 
	`UnsigÃdMš
(hash.
	`Dige¡Size
(), s“d.
	`size
()));

136 
key
 = 
£ed
 + 
BLOCK_CIPHER
::
BLOCKSIZE
;

138 
	`memcmp
(
key
, 
£ed
, 
	`STDMIN
(()
BLOCK_CIPHER
::
BLOCKSIZE
, ()BLOCK_CIPHER::
DEFAULT_KEYLENGTH
)) == 0);

140 
	`Re£ed
(
key
, 
BLOCK_CIPHER
::
DEFAULT_KEYLENGTH
, 
£ed
, 
NULL
);

141 
	}
}

143 
CRYPTOPP_DLL_TEMPLATE_CLASS
 
	gAutoS“dedX917RNG
<
	gAES
>;

146 #ià
CRYPTOPP_ENABLE_COMPLIANCE_WITH_FIPS_140_2


147 
	gAutoS“dedX917RNG
<
	tAES
> 
	tDeçuÉAutoS“dedRNG
;

149 
AutoS“dedRªdomPoŞ
 
	tDeçuÉAutoS“dedRNG
;

152 
	gNAMESPACE_END


	@panama.cpp

5 
	~"pch.h
"

7 #iâdeà
CRYPTOPP_GENERATE_X64_MASM


9 
	~"·Çma.h
"

10 
	~"misc.h
"

11 
	~"ıu.h
"

13 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

15 
‹m¶©e
 <
şass
 
B
>

16 
Pªama
<
B
>::
	$Re£t
()

18 
	`mem£t
(
m_¡©e
, 0, m_¡©e.
	`SizeInBy‹s
());

19 #ià
CRYPTOPP_BOOL_SSSE3_ASM_AVAILABLE


20 
m_¡©e
[17] = 
	`HasSSSE3
();

22 
	}
}

26 #ifdeà
CRYPTOPP_X64_MASM_AVAILABLE


28 
Pªama_SSE2_PuÎ
(
size_t
 
couÁ
, 
wÜd32
 *
¡©e
, wÜd32 *
z
, cÚ¡ wÜd32 *
y
);

30 #–ià
CRYPTOPP_BOOL_SSE2_ASM_AVAILABLE


32 #ifdeà
CRYPTOPP_GENERATE_X64_MASM


33 
Pªama_SSE2_PuÎ
 
PROC
 
FRAME


34 
»x_push_»g
 
rdi


35 
	$®loc_¡ack
(2*16)

36 
§ve_xmm128
 
xmm6
, 0
h


37 
§ve_xmm128
 
xmm7
, 10
h


38 .
’d´Şog


40 #´agm¨
	`w¬nšg
(
di§bË
: 4731)

41 
CRYPTOPP_NOINLINE
 
	$Pªama_SSE2_PuÎ
(
size_t
 
couÁ
, 
wÜd32
 *
¡©e
, wÜd32 *
z
, cÚ¡ wÜd32 *
y
)

43 #ifdeà
CRYPTOPP_GNU_STYLE_INLINE_ASSEMBLY


44 
asm
 
__vŞ©e__


47 
	`AS_PUSH_IF86
Ğ
bx
)

49 
	`AS2
Ğ
mov
 
AS_REG_1
, 
couÁ
)

50 
	`AS2
Ğ
mov
 
AS_REG_2
, 
¡©e
)

51 
	`AS2
Ğ
mov
 
AS_REG_3
, 
z
)

52 
	`AS2
Ğ
mov
 
AS_REG_4
, 
y
)

56 #ià
CRYPTOPP_BOOL_X86


57 
	#REG_loİEnd
 [
e¥
]

	)

58 #–ià
	`defšed
(
CRYPTOPP_GENERATE_X64_MASM
)

59 
	#REG_loİEnd
 
rdi


	)

61 
	#REG_loİEnd
 
r8


	)

64 
	`AS2
Ğ
shl
 
AS_REG_1
, 5)

65 
	`ASJ
Ğ
jz
, 5, 
f
)

66 
	`AS2
Ğ
mov
 
AS_REG_6d
, [
AS_REG_2
+4*17])

67 
	`AS2
Ğ
add
 
AS_REG_1
, 
AS_REG_6
)

69 #ià
CRYPTOPP_BOOL_X64


70 
	`AS2
Ğ
mov
 
REG_loİEnd
, 
AS_REG_1
)

72 
	`AS1
Ğ
push
 
ebp
)

73 
	`AS1
Ğ
push
 
AS_REG_1
)

76 
	`AS2
Ğ
movdqa
 
xmm0
, 
XMMWORD_PTR
 [
AS_REG_2
+0*16])

77 
	`AS2
Ğ
movdqa
 
xmm1
, 
XMMWORD_PTR
 [
AS_REG_2
+1*16])

78 
	`AS2
Ğ
movdqa
 
xmm2
, 
XMMWORD_PTR
 [
AS_REG_2
+2*16])

79 
	`AS2
Ğ
movdqa
 
xmm3
, 
XMMWORD_PTR
 [
AS_REG_2
+3*16])

80 
	`AS2
Ğ
mov
 
—x
, 
dwÜd
 
±r
 [
AS_REG_2
+4*16])

82 
	`ASL
(4)

84 #ià
CRYPTOPP_BOOL_SSSE3_ASM_AVAILABLE


85 
	`AS2
Ğ
‹¡
 
AS_REG_6
, 1)

86 
	`ASJ
Ğ
jnz
, 6, 
f
)

88 
	`AS2
Ğ
movdqa
 
xmm6
, 
xmm2
)

89 
	`AS2
Ğ
movss
 
xmm6
, 
xmm3
)

90 
	`ASS
Ğ
pshufd
 
xmm5
, 
xmm6
, 0, 3, 2, 1)

91 
	`AS2
Ğ
movd
 
xmm6
, 
—x
)

92 
	`AS2
Ğ
movdqa
 
xmm7
, 
xmm3
)

93 
	`AS2
Ğ
movss
 
xmm7
, 
xmm6
)

94 
	`ASS
Ğ
pshufd
 
xmm6
, 
xmm7
, 0, 3, 2, 1)

95 #ià
CRYPTOPP_BOOL_SSSE3_ASM_AVAILABLE


96 
	`ASJ
Ğ
jmp
, 7, 
f
)

97 
	`ASL
(6)

98 
	`AS2
Ğ
movdqa
 
xmm5
, 
xmm3
)

99 
	`AS3
Ğ
·ligÄ
 
xmm5
, 
xmm2
, 4)

100 
	`AS2
Ğ
movd
 
xmm6
, 
—x
)

101 
	`AS3
Ğ
·ligÄ
 
xmm6
, 
xmm3
, 4)

102 
	`ASL
(7)

105 
	`AS2
Ğ
movd
 
AS_REG_1d
, 
xmm2
)

106 
	`AS1
Ğ
nÙ
 
AS_REG_1d
)

107 
	`AS2
Ğ
movd
 
AS_REG_7d
, 
xmm3
)

108 
	`AS2
Ğ
Ü
 
AS_REG_1d
, 
AS_REG_7d
)

109 
	`AS2
Ğ
xÜ
 
—x
, 
AS_REG_1d
)

111 
	#SSE2_Index
(
i
è
	`ASM_MOD
(((i)*13+16), 17)

	)

113 
	#pi
(
i
) \

114 
	`AS2
Ğ
movd
 
AS_REG_1d
, 
xmm7
)\

115 
	`AS2
Ğ
rŞ
 
AS_REG_1d
, 
	`ASM_MOD
((ASM_MOD(5*
i
,17)*(ASM_MOD(5*i,17)+1)/2), 32))\

116 
	`AS2
Ğ
mov
 [
AS_REG_2
+
	`SSE2_Index
(
	`ASM_MOD
(5*(
i
), 17))*4], 
AS_REG_1d
)

	)

118 
	#pi4
(
x
, 
y
, 
z
, 
a
, 
b
, 
c
, 
d
) \

119 
	`AS2
Ğ
pcm³qb
 
xmm7
, xmm7)\

120 
	`AS2
Ğ
pxÜ
 
xmm7
, 
x
)\

121 
	`AS2
Ğ
pÜ
 
xmm7
, 
y
)\

122 
	`AS2
Ğ
pxÜ
 
xmm7
, 
z
)\

123 
	`pi
(
a
)\

124 
	`ASS
Ğ
pshuæw
 
xmm7
, xmm7, 1, 0, 3, 2)\

125 
	`pi
(
b
)\

126 
	`AS2
Ğ
puÅckhqdq
 
xmm7
, xmm7)\

127 
	`pi
(
c
)\

128 
	`ASS
Ğ
pshuæw
 
xmm7
, xmm7, 1, 0, 3, 2)\

129 
	`pi
(
d
)

	)

131 
	`pi4
(
xmm1
, 
xmm2
, 
xmm3
, 1, 5, 9, 13)

132 
	`pi4
(
xmm0
, 
xmm1
, 
xmm2
, 2, 6, 10, 14)

133 
	`pi4
(
xmm6
, 
xmm0
, 
xmm1
, 3, 7, 11, 15)

134 
	`pi4
(
xmm5
, 
xmm6
, 
xmm0
, 4, 8, 12, 16)

137 
	`AS2
Ğ
movdqa
 
xmm4
, 
xmm3
)

138 
	`AS2
Ğ
puÅcklqdq
 
xmm3
, 
xmm2
)

139 
	`AS2
Ğ
puÅckhdq
 
xmm4
, 
xmm2
)

140 
	`AS2
Ğ
movdqa
 
xmm2
, 
xmm1
)

141 
	`AS2
Ğ
puÅcklqdq
 
xmm1
, 
xmm0
)

142 
	`AS2
Ğ
puÅckhdq
 
xmm2
, 
xmm0
)

145 
	`AS2
Ğ
‹¡
 
AS_REG_3
, AS_REG_3)

146 
	`ASJ
Ğ
jz
, 0, 
f
)

147 
	`AS2
Ğ
movdqa
 
xmm6
, 
xmm4
)

148 
	`AS2
Ğ
puÅcklqdq
 
xmm4
, 
xmm2
)

149 
	`AS2
Ğ
puÅckhqdq
 
xmm6
, 
xmm2
)

150 
	`AS2
Ğ
‹¡
 
AS_REG_4
, 15)

151 
	`ASJ
Ğ
jnz
, 2, 
f
)

152 
	`AS2
Ğ
‹¡
 
AS_REG_4
, AS_REG_4)

153 
	`ASJ
Ğ
jz
, 1, 
f
)

154 
	`AS2
Ğ
pxÜ
 
xmm4
, [
AS_REG_4
])

155 
	`AS2
Ğ
pxÜ
 
xmm6
, [
AS_REG_4
+16])

156 
	`AS2
Ğ
add
 
AS_REG_4
, 32)

157 
	`ASJ
Ğ
jmp
, 1, 
f
)

158 
	`ASL
(2)

159 
	`AS2
Ğ
movdqu
 
xmm0
, [
AS_REG_4
])

160 
	`AS2
Ğ
movdqu
 
xmm2
, [
AS_REG_4
+16])

161 
	`AS2
Ğ
pxÜ
 
xmm4
, 
xmm0
)

162 
	`AS2
Ğ
pxÜ
 
xmm6
, 
xmm2
)

163 
	`AS2
Ğ
add
 
AS_REG_4
, 32)

164 
	`ASL
(1)

165 
	`AS2
Ğ
‹¡
 
AS_REG_3
, 15)

166 
	`ASJ
Ğ
jnz
, 3, 
f
)

167 
	`AS2
Ğ
movdqa
 
XMMWORD_PTR
 [
AS_REG_3
], 
xmm4
)

168 
	`AS2
Ğ
movdqa
 
XMMWORD_PTR
 [
AS_REG_3
+16], 
xmm6
)

169 
	`AS2
Ğ
add
 
AS_REG_3
, 32)

170 
	`ASJ
Ğ
jmp
, 0, 
f
)

171 
	`ASL
(3)

172 
	`AS2
Ğ
movdqu
 
XMMWORD_PTR
 [
AS_REG_3
], 
xmm4
)

173 
	`AS2
Ğ
movdqu
 
XMMWORD_PTR
 [
AS_REG_3
+16], 
xmm6
)

174 
	`AS2
Ğ
add
 
AS_REG_3
, 32)

175 
	`ASL
(0)

178 
	`AS2
Ğ
Ëa
 
AS_REG_1
, [
AS_REG_6
 + 32])

179 
	`AS2
Ğ
ªd
 
AS_REG_1
, 31*32)

180 
	`AS2
Ğ
Ëa
 
AS_REG_7
, [
AS_REG_6
 + (32-24)*32])

181 
	`AS2
Ğ
ªd
 
AS_REG_7
, 31*32)

183 
	`AS2
Ğ
movdqa
 
xmm0
, 
XMMWORD_PTR
 [
AS_REG_2
+20*4+
AS_REG_1
+0*8])

184 
	`AS2
Ğ
pxÜ
 
xmm3
, 
xmm0
)

185 
	`ASS
Ğ
pshufd
 
xmm0
, xmm0, 2, 3, 0, 1)

186 
	`AS2
Ğ
movdqa
 
XMMWORD_PTR
 [
AS_REG_2
+20*4+
AS_REG_1
+0*8], 
xmm3
)

187 
	`AS2
Ğ
pxÜ
 
xmm0
, 
XMMWORD_PTR
 [
AS_REG_2
+20*4+
AS_REG_7
+2*8])

188 
	`AS2
Ğ
movdqa
 
XMMWORD_PTR
 [
AS_REG_2
+20*4+
AS_REG_7
+2*8], 
xmm0
)

190 
	`AS2
Ğ
movdqa
 
xmm4
, 
XMMWORD_PTR
 [
AS_REG_2
+20*4+
AS_REG_1
+2*8])

191 
	`AS2
Ğ
pxÜ
 
xmm1
, 
xmm4
)

192 
	`AS2
Ğ
movdqa
 
XMMWORD_PTR
 [
AS_REG_2
+20*4+
AS_REG_1
+2*8], 
xmm1
)

193 
	`AS2
Ğ
pxÜ
 
xmm4
, 
XMMWORD_PTR
 [
AS_REG_2
+20*4+
AS_REG_7
+0*8])

194 
	`AS2
Ğ
movdqa
 
XMMWORD_PTR
 [
AS_REG_2
+20*4+
AS_REG_7
+0*8], 
xmm4
)

197 
	`AS2
Ğ
movdqa
 
xmm3
, 
XMMWORD_PTR
 [
AS_REG_2
+3*16])

198 
	`AS2
Ğ
movdqa
 
xmm2
, 
XMMWORD_PTR
 [
AS_REG_2
+2*16])

199 
	`AS2
Ğ
movdqa
 
xmm1
, 
XMMWORD_PTR
 [
AS_REG_2
+1*16])

200 
	`AS2
Ğ
movdqa
 
xmm0
, 
XMMWORD_PTR
 [
AS_REG_2
+0*16])

202 #ià
CRYPTOPP_BOOL_SSSE3_ASM_AVAILABLE


203 
	`AS2
Ğ
‹¡
 
AS_REG_6
, 1)

204 
	`ASJ
Ğ
jnz
, 8, 
f
)

206 
	`AS2
Ğ
movd
 
xmm6
, 
—x
)

207 
	`AS2
Ğ
movdqa
 
xmm7
, 
xmm3
)

208 
	`AS2
Ğ
movss
 
xmm7
, 
xmm6
)

209 
	`AS2
Ğ
movdqa
 
xmm6
, 
xmm2
)

210 
	`AS2
Ğ
movss
 
xmm6
, 
xmm3
)

211 
	`AS2
Ğ
movdqa
 
xmm5
, 
xmm1
)

212 
	`AS2
Ğ
movss
 
xmm5
, 
xmm2
)

213 
	`AS2
Ğ
movdqa
 
xmm4
, 
xmm0
)

214 
	`AS2
Ğ
movss
 
xmm4
, 
xmm1
)

215 
	`ASS
Ğ
pshufd
 
xmm7
, xmm7, 0, 3, 2, 1)

216 
	`ASS
Ğ
pshufd
 
xmm6
, xmm6, 0, 3, 2, 1)

217 
	`ASS
Ğ
pshufd
 
xmm5
, xmm5, 0, 3, 2, 1)

218 
	`ASS
Ğ
pshufd
 
xmm4
, xmm4, 0, 3, 2, 1)

219 #ià
CRYPTOPP_BOOL_SSSE3_ASM_AVAILABLE


220 
	`ASJ
Ğ
jmp
, 9, 
f
)

221 
	`ASL
(8)

222 
	`AS2
Ğ
movd
 
xmm7
, 
—x
)

223 
	`AS3
Ğ
·ligÄ
 
xmm7
, 
xmm3
, 4)

224 
	`AS2
Ğ
movq
 
xmm6
, 
xmm3
)

225 
	`AS3
Ğ
·ligÄ
 
xmm6
, 
xmm2
, 4)

226 
	`AS2
Ğ
movq
 
xmm5
, 
xmm2
)

227 
	`AS3
Ğ
·ligÄ
 
xmm5
, 
xmm1
, 4)

228 
	`AS2
Ğ
movq
 
xmm4
, 
xmm1
)

229 
	`AS3
Ğ
·ligÄ
 
xmm4
, 
xmm0
, 4)

230 
	`ASL
(9)

233 
	`AS2
Ğ
xÜ
 
—x
, 1)

234 
	`AS2
Ğ
movd
 
AS_REG_1d
, 
xmm0
)

235 
	`AS2
Ğ
xÜ
 
—x
, 
AS_REG_1d
)

236 
	`AS2
Ğ
movd
 
AS_REG_1d
, 
xmm3
)

237 
	`AS2
Ğ
xÜ
 
—x
, 
AS_REG_1d
)

239 
	`AS2
Ğ
pxÜ
 
xmm3
, 
xmm2
)

240 
	`AS2
Ğ
pxÜ
 
xmm2
, 
xmm1
)

241 
	`AS2
Ğ
pxÜ
 
xmm1
, 
xmm0
)

242 
	`AS2
Ğ
pxÜ
 
xmm0
, 
xmm7
)

243 
	`AS2
Ğ
pxÜ
 
xmm3
, 
xmm7
)

244 
	`AS2
Ğ
pxÜ
 
xmm2
, 
xmm6
)

245 
	`AS2
Ğ
pxÜ
 
xmm1
, 
xmm5
)

246 
	`AS2
Ğ
pxÜ
 
xmm0
, 
xmm4
)

249 
	`AS2
Ğ
Ëa
 
AS_REG_1
, [
AS_REG_6
 + (32-4)*32])

250 
	`AS2
Ğ
ªd
 
AS_REG_1
, 31*32)

251 
	`AS2
Ğ
Ëa
 
AS_REG_7
, [
AS_REG_6
 + 16*32])

252 
	`AS2
Ğ
ªd
 
AS_REG_7
, 31*32)

254 
	`AS2
Ğ
movdqa
 
xmm4
, 
XMMWORD_PTR
 [
AS_REG_2
+20*4+
AS_REG_1
+0*16])

255 
	`AS2
Ğ
movdqa
 
xmm5
, 
XMMWORD_PTR
 [
AS_REG_2
+20*4+
AS_REG_7
+0*16])

256 
	`AS2
Ğ
movdqa
 
xmm6
, 
xmm4
)

257 
	`AS2
Ğ
puÅcklqdq
 
xmm4
, 
xmm5
)

258 
	`AS2
Ğ
puÅckhqdq
 
xmm6
, 
xmm5
)

259 
	`AS2
Ğ
pxÜ
 
xmm3
, 
xmm4
)

260 
	`AS2
Ğ
pxÜ
 
xmm2
, 
xmm6
)

262 
	`AS2
Ğ
movdqa
 
xmm4
, 
XMMWORD_PTR
 [
AS_REG_2
+20*4+
AS_REG_1
+1*16])

263 
	`AS2
Ğ
movdqa
 
xmm5
, 
XMMWORD_PTR
 [
AS_REG_2
+20*4+
AS_REG_7
+1*16])

264 
	`AS2
Ğ
movdqa
 
xmm6
, 
xmm4
)

265 
	`AS2
Ğ
puÅcklqdq
 
xmm4
, 
xmm5
)

266 
	`AS2
Ğ
puÅckhqdq
 
xmm6
, 
xmm5
)

267 
	`AS2
Ğ
pxÜ
 
xmm1
, 
xmm4
)

268 
	`AS2
Ğ
pxÜ
 
xmm0
, 
xmm6
)

271 
	`AS2
Ğ
add
 
AS_REG_6
, 32)

272 
	`AS2
Ğ
cmp
 
AS_REG_6
, 
REG_loİEnd
)

273 
	`ASJ
Ğ
jÃ
, 4, 
b
)

276 
	`AS2
Ğ
mov
 [
AS_REG_2
+4*16], 
—x
)

277 
	`AS2
Ğ
movdqa
 
XMMWORD_PTR
 [
AS_REG_2
+3*16], 
xmm3
)

278 
	`AS2
Ğ
movdqa
 
XMMWORD_PTR
 [
AS_REG_2
+2*16], 
xmm2
)

279 
	`AS2
Ğ
movdqa
 
XMMWORD_PTR
 [
AS_REG_2
+1*16], 
xmm1
)

280 
	`AS2
Ğ
movdqa
 
XMMWORD_PTR
 [
AS_REG_2
+0*16], 
xmm0
)

282 #ià
CRYPTOPP_BOOL_X86


283 
	`AS2
Ğ
add
 
e¥
, 4)

284 
	`AS1
Ğ
pİ
 
ebp
)

286 
	`ASL
(5)

288 #ifdeà
CRYPTOPP_GNU_STYLE_INLINE_ASSEMBLY


289 
	`AS_POP_IF86
Ğ
bx
)

292 #ià
CRYPTOPP_BOOL_X64


293 : "D" (
couÁ
), "S" (
¡©e
), "d" (
z
), "c" (
y
)

296 : "c" (
couÁ
), "d" (
¡©e
), "S" (
z
), "D" (
y
)

301 #ifdeà
CRYPTOPP_GENERATE_X64_MASM


302 
movdqa
 
xmm6
, [
r¥
 + 0
h
]

303 
movdqa
 
xmm7
, [
r¥
 + 10
h
]

304 
add
 
r¥
, 2*16

305 
pİ
 
rdi


306 
»t


307 
Pªama_SSE2_PuÎ
 
ENDP


309 
	}
}

313 #iâdeà
CRYPTOPP_GENERATE_X64_MASM


315 
‹m¶©e
 <
şass
 
B
>

316 
Pªama
<
B
>::
I‹¿‹
(
size_t
 
couÁ
, cÚ¡ 
wÜd32
 *
p
, 
by‹
 *
ouut
, cÚ¡ by‹ *
šput
, 
Key¡»amO³¿tiÚ
 
İ”©iÚ
)

318 
wÜd32
 
b¡¬t
 = 
m_¡©e
[17];

319 
wÜd32
 *cÚ¡ 
aPŒ
 = 
m_¡©e
;

320 
wÜd32
 
cPŒ
[17];

322 
	#bPŒ
 ((
by‹
 *)(
aPŒ
+20))

	)

327 
	#a
(
i
è
aPŒ
[((i)*13+16) % 17]

328 
	#c
(
i
è
cPŒ
[((i)*13+16è% 17]

	)

330 
	#b
(
i
, 
j
è
b
##i[(j)*2%8 + (j)/4]

	)

333 
	#US
(
i
è{
wÜd32
 
t
=
	`b
(0,i); b(0,i)=
	`CÚd™iÚ®By‹Rev”£
(
B
::
	`ToEnum
(), 
p
[i])^t; b(25,(i+6)%8)^ñ;}

	)

334 
	#UL
(
i
è{
wÜd32
 
t
=
	`b
(0,i); b(0,i)=
	`a
(i+1)^t; b(25,(i+6)%8)^ñ;}

	)

336 
	#GP
(
i
è
	`c
(5*i%17èğ
	`rÙlFixed
(
	`a
(iè^ (a((i+1)%17è| ~a((i+2)%17)), ((5*i%17)*((5*i%17)+1)/2)%32)

	)

338 
	#T
(
i
,
x
è
	`a
(ièğ
	`c
(iè^ c((i+1)%17è^ c((i+4)%17è^ 
	)
x

339 
	#TS1S
(
i
è
	`T
(i+1, 
	`CÚd™iÚ®By‹Rev”£
(
B
::
	`ToEnum
(), 
p
[i]))

	)

340 
	#TS1L
(
i
è
	`T
(i+1, 
	`b
(4,i))

	)

341 
	#TS2
(
i
è
	`T
(i+9, 
	`b
(16,i))

	)

343 
couÁ
--)

345 ià(
ouut
)

347 
	#PANAMA_OUTPUT
(
x
) \

348 
	`CRYPTOPP_KEYSTREAM_OUTPUT_WORD
(
x
, 
B
::
	`ToEnum
(), 0, 
	`a
(0+9));\

349 
	`CRYPTOPP_KEYSTREAM_OUTPUT_WORD
(
x
, 
B
::
	`ToEnum
(), 1, 
	`a
(1+9));\

350 
	`CRYPTOPP_KEYSTREAM_OUTPUT_WORD
(
x
, 
B
::
	`ToEnum
(), 2, 
	`a
(2+9));\

351 
	`CRYPTOPP_KEYSTREAM_OUTPUT_WORD
(
x
, 
B
::
	`ToEnum
(), 3, 
	`a
(3+9));\

352 
	`CRYPTOPP_KEYSTREAM_OUTPUT_WORD
(
x
, 
B
::
	`ToEnum
(), 4, 
	`a
(4+9));\

353 
	`CRYPTOPP_KEYSTREAM_OUTPUT_WORD
(
x
, 
B
::
	`ToEnum
(), 5, 
	`a
(5+9));\

354 
	`CRYPTOPP_KEYSTREAM_OUTPUT_WORD
(
x
, 
B
::
	`ToEnum
(), 6, 
	`a
(6+9));\

355 
	`CRYPTOPP_KEYSTREAM_OUTPUT_WORD
(
x
, 
B
::
	`ToEnum
(), 7, 
	`a
(7+9));

	)

357 
wÜd32
 
	tWÜdTy³
;

358 
CRYPTOPP_KEYSTREAM_OUTPUT_SWITCH
(
PANAMA_OUTPUT
, 4*8);

361 
wÜd32
 *cÚ¡ 
b16
 = (wÜd32 *)(
bPŒ
+((
b¡¬t
+16*32) & 31*32));

362 
wÜd32
 *cÚ¡ 
b4
 = (wÜd32 *)(
bPŒ
+((
b¡¬t
+(32-4)*32) & 31*32));

363 
b¡¬t
 += 32;

364 
wÜd32
 *cÚ¡ 
b0
 = (wÜd32 *)(
bPŒ
+((
b¡¬t
) & 31*32));

365 
wÜd32
 *cÚ¡ 
b25
 = (wÜd32 *)(
bPŒ
+((
b¡¬t
+(32-25)*32) & 31*32));

367 ià(
p
)

369 
US
(0); US(1); US(2); US(3); US(4); US(5); US(6); US(7);

373 
UL
(0); UL(1); UL(2); UL(3); UL(4); UL(5); UL(6); UL(7);

376 
GP
(0);

377 
GP
(1);

378 
GP
(2);

379 
GP
(3);

380 
GP
(4);

381 
GP
(5);

382 
GP
(6);

383 
GP
(7);

384 
GP
(8);

385 
GP
(9);

386 
GP
(10);

387 
GP
(11);

388 
GP
(12);

389 
GP
(13);

390 
GP
(14);

391 
GP
(15);

392 
GP
(16);

394 
T
(0,1);

396 ià(
p
)

398 
TS1S
(0); TS1S(1); TS1S(2); TS1S(3); TS1S(4); TS1S(5); TS1S(6); TS1S(7);

399 
p
 += 8;

403 
TS1L
(0); TS1L(1); TS1L(2); TS1L(3); TS1L(4); TS1L(5); TS1L(6); TS1L(7);

406 
TS2
(0); TS2(1); TS2(2); TS2(3); TS2(4); TS2(5); TS2(6); TS2(7);

408 
m_¡©e
[17] = 
b¡¬t
;

411 
Çme¥aû
 
W—k
 {

412 
‹m¶©e
 <
şass
 
B
>

413 
size_t
 
PªamaHash
<
B
>::
HashMuÉËBlocks
(cÚ¡ 
wÜd32
 *
šput
, size_ˆ
Ëngth
)

415 
this
->
I‹¿‹
(
Ëngth
 /his->
BLOCKSIZE
, 
šput
);

416  
Ëngth
 % 
this
->
BLOCKSIZE
;

419 
‹m¶©e
 <
şass
 
B
>

420 
PªamaHash
<
B
>::
Trunÿ‹dFš®
(
by‹
 *
hash
, 
size_t
 
size
)

422 
this
->
ThrowIfInv®idTrunÿ‹dSize
(
size
);

424 
this
->
PadLa¡Block
Ñhis->
BLOCKSIZE
, 0x01);

426 
HashEndŸnCÜ»ùedBlock
(
this
->
m_d©a
);

428 
this
->
I‹¿‹
(32);

430 
FixedSizeSecBlock
<
wÜd32
, 8> 
buf
;

431 
this
->
I‹¿‹
(1, 
NULL
, 
buf
.
By‹PŒ
(), NULL);

433 
memıy
(
hash
, 
buf
, 
size
);

435 
this
->
Re¡¬t
();

439 
‹m¶©e
 <
şass
 
B
>

440 
PªamaCh”PŞicy
<
B
>::
Ch”S‘Key
(cÚ¡ 
NameV®uePaœs
 &
·¿ms
, cÚ¡ 
by‹
 *
key
, 
size_t
 
Ëngth
)

442 
as£¹
(
Ëngth
==32);

443 
memıy
(
m_key
, 
key
, 32);

446 
‹m¶©e
 <
şass
 
B
>

447 
PªamaCh”PŞicy
<
B
>::
Ch”ResynchrÚize
(
by‹
 *
key¡»amBufãr
, cÚ¡ by‹ *
iv
, 
size_t
 
Ëngth
)

449 
as£¹
(
Ëngth
==32);

450 
this
->
Re£t
();

451 
this
->
I‹¿‹
(1, 
m_key
);

452 ià(
iv
 && 
IsAligÃd
<
wÜd32
>(iv))

453 
this
->
I‹¿‹
(1, (cÚ¡ 
wÜd32
 *)
iv
);

456 
FixedSizeSecBlock
<
wÜd32
, 8> 
buf
;

457 ià(
iv
)

458 
memıy
(
buf
, 
iv
, 32);

460 
mem£t
(
buf
, 0, 32);

461 
this
->
I‹¿‹
(1, 
buf
);

464 #ià
CRYPTOPP_BOOL_SSE2_ASM_AVAILABLE
 || 
defšed
(
CRYPTOPP_X64_MASM_AVAILABLE
)

465 ià(
B
::
ToEnum
(è=ğ
LITTLE_ENDIAN_ORDER
 && 
HasSSE2
(è&& !
IsP4
())

466 
Pªama_SSE2_PuÎ
(32, 
this
->
m_¡©e
, 
NULL
, NULL);

469 
this
->
I‹¿‹
(32);

472 #ià
CRYPTOPP_BOOL_X86
 || 
CRYPTOPP_BOOL_X64


473 
‹m¶©e
 <
şass
 
B
>

474 
PªamaCh”PŞicy
<
B
>::
G‘Alignm’t
() const

476 #ià
CRYPTOPP_BOOL_SSE2_ASM_AVAILABLE
 || 
defšed
(
CRYPTOPP_X64_MASM_AVAILABLE
)

477 ià(
B
::
ToEnum
(è=ğ
LITTLE_ENDIAN_ORDER
 && 
HasSSE2
())

485 
‹m¶©e
 <
şass
 
B
>

486 
PªamaCh”PŞicy
<
B
>::
O³¿‹Key¡»am
(
Key¡»amO³¿tiÚ
 
İ”©iÚ
, 
by‹
 *
ouut
, cÚ¡ by‹ *
šput
, 
size_t
 
™”©iÚCouÁ
)

488 #ià
CRYPTOPP_BOOL_SSE2_ASM_AVAILABLE
 || 
defšed
(
CRYPTOPP_X64_MASM_AVAILABLE
)

489 ià(
B
::
ToEnum
(è=ğ
LITTLE_ENDIAN_ORDER
 && 
HasSSE2
())

490 
Pªama_SSE2_PuÎ
(
™”©iÚCouÁ
, 
this
->
m_¡©e
, (
wÜd32
 *)
ouut
, (cÚ¡ wÜd32 *)
šput
);

493 
this
->
I‹¿‹
(
™”©iÚCouÁ
, 
NULL
, 
ouut
, 
šput
, 
İ”©iÚ
);

496 
‹m¶©e
 
şass
 
Pªama
<
BigEndŸn
>;

497 
‹m¶©e
 
şass
 
Pªama
<
L™eEndŸn
>;

499 
‹m¶©e
 
şass
 
W—k
::
PªamaHash
<
BigEndŸn
>;

500 
‹m¶©e
 
şass
 
W—k
::
PªamaHash
<
L™eEndŸn
>;

502 
‹m¶©e
 
şass
 
PªamaCh”PŞicy
<
BigEndŸn
>;

503 
‹m¶©e
 
şass
 
PªamaCh”PŞicy
<
L™eEndŸn
>;

505 
NAMESPACE_END


	@panama.h

1 #iâdeà
CRYPTOPP_PANAMA_H


2 
	#CRYPTOPP_PANAMA_H


	)

4 
	~"¡rchr.h
"

5 
	~"™”hash.h
"

7 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

10 
‹m¶©e
 <
şass
 
B
>

11 şas 
	cCRYPTOPP_NO_VTABLE
 
Pªama


13 
public
:

14 
	`Re£t
();

15 
	`I‹¿‹
(
size_t
 
couÁ
, cÚ¡ 
wÜd32
 *
p
=
NULL
, 
by‹
 *
ouut
=NULL, cÚ¡ by‹ *
šput
=NULL, 
Key¡»amO³¿tiÚ
 
İ”©iÚ
=
WRITE_KEYSTREAM
);

17 
´Ùeùed
:

18 
wÜd32
 
	tSge
[8];

19 
	$CRYPTOPP_CONSTANT
(
STAGES
 = 32)

21 
FixedSizeAligÃdSecBlock
<
wÜd32
, 20 + 8*32> 
m_¡©e
;

24 
Çme¥aû
 
W—k
 {

26 
‹m¶©e
 <
şass
 
B
 = 
L™eEndŸn
>

27 
şass
 
PªamaHash
 : 
´Ùeùed
 
Pªama
<
B
>, 
public
 
AlgÜ™hmIm¶
<
I‹¿‹dHash
<
wÜd32
, 
N©iveBy‹Ord”
, 32>, PanamaHash<B> >

29 
public
:

30 
	`CRYPTOPP_CONSTANT
(
DIGESTSIZE
 = 32)

31 
	`PªamaHash
(è{
Pªama
<
B
>::
	`Re£t
();}

32 
	`Dige¡Size
(ècÚ¡ { 
DIGESTSIZE
;}

33 
	`Trunÿ‹dFš®
(
by‹
 *
hash
, 
size_t
 
size
);

34 cÚ¡ * 
	`SticAlgÜ™hmName
(è{ 
B
::
	`ToEnum
(è=ğ
BIG_ENDIAN_ORDER
 ? "Panama-BE" : "Panama-LE";}

36 
´Ùeùed
:

37 
	`In™
(è{
Pªama
<
B
>::
	`Re£t
();}

38 
	`HashEndŸnCÜ»ùedBlock
(cÚ¡ 
wÜd32
 *
d©a
è{
this
->
	`I‹¿‹
(1, data);}

39 
size_t
 
	`HashMuÉËBlocks
(cÚ¡ 
wÜd32
 *
šput
, size_ˆ
Ëngth
);

40 
wÜd32
* 
	`S‹Buf
(è{ 
NULL
;}

42 
	}
}

45 
	g‹m¶©e
 <
şass
 
	gT_Hash
, cÏs 
	gT_Info
 = 
T_Hash
>

46 
şass
 
H”m‘icHashFunùiÚMAC
 : 
public
 
AlgÜ™hmIm¶
<
Sim¶eKeyšgIÁ”çûIm¶
<
TwoBa£s
<
Mes§geAuth’tiÿtiÚCode
, 
	gV¬ŸbËKeyL’gth
<32, 0, 
	gINT_MAX
> > >, 
	gT_Info
>

48 
	gpublic
:

49 
UncheckedS‘Key
(cÚ¡ 
by‹
 *
key
, 
Ëngth
, cÚ¡ 
NameV®uePaœs
 &
·¿ms
)

51 
	gm_key
.
Assign
(
key
, 
Ëngth
);

52 
Re¡¬t
();

55 
Re¡¬t
()

57 
	gm_hash
.
Re¡¬t
();

58 
	gm_keyed
 = 
çl£
;

61 
Upd©e
(cÚ¡ 
by‹
 *
šput
, 
size_t
 
Ëngth
)

63 ià(!
	gm_keyed
)

64 
KeyHash
();

65 
	gm_hash
.
Upd©e
(
šput
, 
Ëngth
);

68 
Trunÿ‹dFš®
(
by‹
 *
dige¡
, 
size_t
 
dige¡Size
)

70 ià(!
	gm_keyed
)

71 
KeyHash
();

72 
	gm_hash
.
Trunÿ‹dFš®
(
dige¡
, 
dige¡Size
);

73 
	gm_keyed
 = 
çl£
;

76 
Dige¡Size
() const

77 { 
	gm_hash
.
Dige¡Size
();}

78 
BlockSize
() const

79 { 
	gm_hash
.
BlockSize
();}

80 
O±im®BlockSize
() const

81 { 
	gm_hash
.
O±im®BlockSize
();}

82 
O±im®D©aAlignm’t
() const

83 { 
	gm_hash
.
O±im®D©aAlignm’t
();}

85 
	g´Ùeùed
:

86 
KeyHash
()

88 
m_hash
.
Upd©e
(
m_key
, m_key.
size
());

89 
	gm_keyed
 = 
Œue
;

92 
T_Hash
 
	gm_hash
;

93 
boŞ
 
	gm_keyed
;

94 
SecBy‹Block
 
	gm_key
;

97 
Çme¥aû
 
	gW—k
 {

99 
	g‹m¶©e
 <
şass
 
	gB
 = 
L™eEndŸn
>

100 
şass
 
PªamaMAC
 : 
public
 
H”m‘icHashFunùiÚMAC
<
PªamaHash
<
B
> >

102 
public
:

103 
PªamaMAC
() {}

104 
PªamaMAC
(cÚ¡ 
by‹
 *
key
, 
Ëngth
)

105 {
this
->
S‘Key
(
key
, 
Ëngth
);}

110 
	g‹m¶©e
 <
şass
 
	gB
>

111 
	gPªamaCh”Info
 : 
public
 
FixedKeyL’gth
<32, 
	gSim¶eKeyšgIÁ”çû
::
UNIQUE_IV
, 32>

113 cÚ¡ * 
SticAlgÜ™hmName
(è{ 
	gB
::
ToEnum
(è=ğ
BIG_ENDIAN_ORDER
 ? "Panama-BE" : "Panama-LE";}

117 
	g‹m¶©e
 <
şass
 
	gB
>

118 
şass
 
	gPªamaCh”PŞicy
 : 
public
 
Add™iveCh”CÚü‘ePŞicy
<
wÜd32
, 8>,

119 
public
 
	gPªamaCh”Info
<
	gB
>,

120 
´Ùeùed
 
	gPªama
<
	gB
>

122 
	g´Ùeùed
:

123 
Ch”S‘Key
(cÚ¡ 
NameV®uePaœs
 &
·¿ms
, cÚ¡ 
by‹
 *
key
, 
size_t
 
Ëngth
);

124 
O³¿‹Key¡»am
(
Key¡»amO³¿tiÚ
 
İ”©iÚ
, 
by‹
 *
ouut
, cÚ¡ by‹ *
šput
, 
size_t
 
™”©iÚCouÁ
);

125 
boŞ
 
Ch”IsRªdomAcûss
(ècÚ¡ { 
	gçl£
;}

126 
Ch”ResynchrÚize
(
by‹
 *
key¡»amBufãr
, cÚ¡ by‹ *
iv
, 
size_t
 
Ëngth
);

127 #ià
CRYPTOPP_BOOL_X86
 || 
CRYPTOPP_BOOL_X64


128 
G‘Alignm’t
() const;

131 
	gFixedSizeSecBlock
<
	gwÜd32
, 8> 
	gm_key
;

135 
	g‹m¶©e
 <
şass
 
	gB
 = 
L™eEndŸn
>

136 
PªamaCh”
 : 
public
 
PªamaCh”Info
<
B
>,…ubliø
	gSymm‘ricCh”Docum’tiÚ


138 
	gSymm‘ricCh”Fš®
<
	tCÚü‘ePŞicyHŞd”
<
	tPªamaCh”PŞicy
<
	tB
>, 
	tAdd™iveCh”Tem¶©e
<> >, 
	tPªamaCh”Info
<B> > 
	tEnüy±iÚ
;

139 
Enüy±iÚ
 
	tDeüy±iÚ
;

142 
	gNAMESPACE_END


	@pch.cpp

1 
	~"pch.h
"

	@pch.h

1 #iâdeà
CRYPTOPP_PCH_H


2 
	#CRYPTOPP_PCH_H


	)

4 #ifdeà
CRYPTOPP_GENERATE_X64_MASM


6 
	~"ıu.h
"

10 
	~"cÚfig.h
"

12 #ifdeà
USE_PRECOMPILED_HEADERS


13 
	~"sim¶e.h
"

14 
	~"£cblock.h
"

15 
	~"misc.h
"

16 
	~"sm¬Œ.h
"

	@pkcspad.cpp

3 
	~"pch.h
"

5 #iâdeà
CRYPTOPP_PKCSPAD_CPP


6 
	#CRYPTOPP_PKCSPAD_CPP


	)

8 
	~"pkc¥ad.h
"

9 
	~<as£¹.h
>

11 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

14 
‹m¶©e
<> cÚ¡ 
by‹
 
PKCS_Dige¡DecÜ©iÚ
<
W—k1
::
MD2
>::
decÜ©iÚ
[] = {0x30,0x20,0x30,0x0c,0x06,0x08,0x2a,0x86,0x48,0x86,0xf7,0x0d,0x02,0x02,0x05,0x00,0x04,0x10
	}
};

15 
	g‹m¶©e
<> cÚ¡ 
	gPKCS_Dige¡DecÜ©iÚ
<
	gW—k1
::
MD2
>::
Ëngth
 = (
PKCS_Dige¡DecÜ©iÚ
<
W—k1
::MD2>::
decÜ©iÚ
);

17 
	g‹m¶©e
<> cÚ¡ 
by‹
 
	gPKCS_Dige¡DecÜ©iÚ
<
	gW—k1
::
MD5
>::
decÜ©iÚ
[] = {0x30,0x20,0x30,0x0c,0x06,0x08,0x2a,0x86,0x48,0x86,0xf7,0x0d,0x02,0x05,0x05,0x00,0x04,0x10};

18 
	g‹m¶©e
<> cÚ¡ 
	gPKCS_Dige¡DecÜ©iÚ
<
	gW—k1
::
MD5
>::
Ëngth
 = (
PKCS_Dige¡DecÜ©iÚ
<
W—k1
::MD5>::
decÜ©iÚ
);

20 
	g‹m¶©e
<> cÚ¡ 
by‹
 
	gPKCS_Dige¡DecÜ©iÚ
<
	gRIPEMD160
>::
decÜ©iÚ
[] = {0x30,0x21,0x30,0x09,0x06,0x05,0x2b,0x24,0x03,0x02,0x01,0x05,0x00,0x04,0x14};

21 
	g‹m¶©e
<> cÚ¡ 
	gPKCS_Dige¡DecÜ©iÚ
<
	gRIPEMD160
>::
Ëngth
 = (
PKCS_Dige¡DecÜ©iÚ
<
RIPEMD160
>::
decÜ©iÚ
);

23 
	g‹m¶©e
<> cÚ¡ 
by‹
 
	gPKCS_Dige¡DecÜ©iÚ
<
	gTig”
>::
decÜ©iÚ
[] = {0x30,0x29,0x30,0x0D,0x06,0x09,0x2B,0x06,0x01,0x04,0x01,0xDA,0x47,0x0C,0x02,0x05,0x00,0x04,0x18};

24 
	g‹m¶©e
<> cÚ¡ 
	gPKCS_Dige¡DecÜ©iÚ
<
	gTig”
>::
Ëngth
 = (
PKCS_Dige¡DecÜ©iÚ
<
Tig”
>::
decÜ©iÚ
);

26 
size_t
 
	gPKCS_Enüy±iÚPaddšgScheme
::
	$MaxUÅaddedL’gth
(
size_t
 
·ddedL’gth
) const

28  
	`S©u¿tšgSubŒaù
(
·ddedL’gth
/8, 10U);

29 
	}
}

31 
	gPKCS_Enüy±iÚPaddšgScheme
::
	$Pad
(
RªdomNumb”G’”©Ü
 &
ºg
, cÚ¡ 
by‹
 *
šput
, 
size_t
 
šputL’
, by‹ *
pkcsBlock
, size_ˆ
pkcsBlockL’
, cÚ¡ 
NameV®uePaœs
 &
·¿m‘”s
) const

33 
	`as£¹
 (
šputL’
 <ğ
	`MaxUÅaddedL’gth
(
pkcsBlockL’
));

36 ià(
pkcsBlockL’
 % 8 != 0)

38 
pkcsBlock
[0] = 0;

39 
pkcsBlock
++;

41 
pkcsBlockL’
 /= 8;

43 
pkcsBlock
[0] = 2;

46 
i
 = 1; i < 
pkcsBlockL’
-
šputL’
-1; i++)

47 
pkcsBlock
[
i
] = (
by‹
)
ºg
.
	`G’”©eWÜd32
(1, 0xff);

49 
pkcsBlock
[
pkcsBlockL’
-
šputL’
-1] = 0;

50 
	`memıy
(
pkcsBlock
+
pkcsBlockL’
-
šputL’
, 
šput
, inputLen);

51 
	}
}

53 
DecodšgResuÉ
 
	gPKCS_Enüy±iÚPaddšgScheme
::
	$UÅad
(cÚ¡ 
by‹
 *
pkcsBlock
, 
size_t
 
pkcsBlockL’
, by‹ *
ouut
, cÚ¡ 
NameV®uePaœs
 &
·¿m‘”s
) const

55 
boŞ
 
šv®id
 = 
çl£
;

56 
size_t
 
maxOuutL’
 = 
	`MaxUÅaddedL’gth
(
pkcsBlockL’
);

59 ià(
pkcsBlockL’
 % 8 != 0)

61 
šv®id
 = (
pkcsBlock
[0] != 0) || invalid;

62 
pkcsBlock
++;

64 
pkcsBlockL’
 /= 8;

67 
šv®id
 = (
pkcsBlock
[0] != 2) || invalid;

70 
size_t
 
i
=1;

71 
i
<
pkcsBlockL’
 && 
pkcsBlock
[i++]) {

73 
	`as£¹
(
i
==
pkcsBlockL’
 || 
pkcsBlock
[i-1]==0);

75 
size_t
 
ouutL’
 = 
pkcsBlockL’
 - 
i
;

76 
šv®id
 = (
ouutL’
 > 
maxOuutL’
) || invalid;

78 ià(
šv®id
)

79  
	`DecodšgResuÉ
();

81 
	`memıy
 (
ouut
, 
pkcsBlock
+
i
, 
ouutL’
);

82  
	`DecodšgResuÉ
(
ouutL’
);

83 
	}
}

87 #iâdeà
CRYPTOPP_IMPORTS


89 
	gPKCS1v15_SigÇtu»Mes§geEncodšgM‘hod
::
	$Compu‹Mes§geR•»£Á©ive
(
RªdomNumb”G’”©Ü
 &
ºg
,

90 cÚ¡ 
by‹
 *
»cov”abËMes§ge
, 
size_t
 
»cov”abËMes§geL’gth
,

91 
HashT¿nsfÜm©iÚ
 &
hash
, 
HashId’tif›r
 
hashId’tif›r
, 
boŞ
 
mes§geEm±y
,

92 
by‹
 *
»´e£Á©ive
, 
size_t
 
»´e£Á©iveB™L’gth
) const

94 
	`as£¹
(
»´e£Á©iveB™L’gth
 >ğ
	`MšR•»£Á©iveB™L’gth
(
hashId’tif›r
.
£cÚd
, 
hash
.
	`Dige¡Size
()));

96 
size_t
 
pkcsBlockL’
 = 
»´e£Á©iveB™L’gth
;

98 ià(
pkcsBlockL’
 % 8 != 0)

100 
»´e£Á©ive
[0] = 0;

101 
»´e£Á©ive
++;

103 
pkcsBlockL’
 /= 8;

105 
»´e£Á©ive
[0] = 1;

107 
dige¡Size
 = 
hash
.
	`Dige¡Size
();

108 
by‹
 *
pPaddšg
 = 
»´e£Á©ive
 + 1;

109 
by‹
 *
pDige¡
 = 
»´e£Á©ive
 + 
pkcsBlockL’
 - 
dige¡Size
;

110 
by‹
 *
pHashId
 = 
pDige¡
 - 
hashId’tif›r
.
£cÚd
;

111 
by‹
 *
pS•¬©Ü
 = 
pHashId
 - 1;

114 
	`mem£t
(
pPaddšg
, 0xff, 
pS•¬©Ü
-pPadding);

115 *
pS•¬©Ü
 = 0;

116 
	`memıy
(
pHashId
, 
hashId’tif›r
.
fœ¡
, hashId’tif›r.
£cÚd
);

117 
hash
.
	`Fš®
(
pDige¡
);

118 
	}
}

122 
	gNAMESPACE_END


	@pkcspad.h

1 #iâdeà
CRYPTOPP_PKCSPAD_H


2 
	#CRYPTOPP_PKCSPAD_H


	)

4 
	~"üy±lib.h
"

5 
	~"pubkey.h
"

7 #ifdeà
CRYPTOPP_IS_DLL


8 
	~"sha.h
"

11 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

14 şas 
	cPKCS_Enüy±iÚPaddšgScheme
 : 
public
 
PK_Enüy±iÚMes§geEncodšgM‘hod


16 
public
:

17 cÚ¡ * 
	$SticAlgÜ™hmName
() { "EME-PKCS1-v1_5";}

19 
size_t
 
	$MaxUÅaddedL’gth
(
size_t
 
·ddedL’gth
) const;

20 
	$Pad
(
RªdomNumb”G’”©Ü
 &
ºg
, cÚ¡ 
by‹
 *
¿w
, 
size_t
 
šputL’gth
, by‹ *
·dded
, size_ˆ
·ddedL’gth
, cÚ¡ 
NameV®uePaœs
 &
·¿m‘”s
) const;

21 
DecodšgResuÉ
 
	$UÅad
(cÚ¡ 
by‹
 *
·dded
, 
size_t
 
·ddedL’gth
, by‹ *
¿w
, cÚ¡ 
NameV®uePaœs
 &
·¿m‘”s
) const;

22 
	}
};

24 
	g‹m¶©e
 <
şass
 
	gH
> cÏs 
	cPKCS_Dige¡DecÜ©iÚ


26 
	mpublic
:

27 cÚ¡ 
by‹
 
decÜ©iÚ
[];

28 cÚ¡ 
	mËngth
;

33 
şass
 
	gSHA1
;

34 
şass
 
	gRIPEMD160
;

35 
şass
 
	gTig”
;

36 
şass
 
	gSHA224
;

37 
şass
 
	gSHA256
;

38 
şass
 
	gSHA384
;

39 
şass
 
	gSHA512
;

40 
Çme¥aû
 
	gW—k1
 {

41 
şass
 
	gMD2
;

42 
şass
 
	gMD5
;

46 #ifdeà
CRYPTOPP_IS_DLL


47 
CRYPTOPP_DLL_TEMPLATE_CLASS
 
	gPKCS_Dige¡DecÜ©iÚ
<
	gSHA1
>;

48 
CRYPTOPP_DLL_TEMPLATE_CLASS
 
	gPKCS_Dige¡DecÜ©iÚ
<
	gSHA224
>;

49 
CRYPTOPP_DLL_TEMPLATE_CLASS
 
	gPKCS_Dige¡DecÜ©iÚ
<
	gSHA256
>;

50 
CRYPTOPP_DLL_TEMPLATE_CLASS
 
	gPKCS_Dige¡DecÜ©iÚ
<
	gSHA384
>;

51 
CRYPTOPP_DLL_TEMPLATE_CLASS
 
	gPKCS_Dige¡DecÜ©iÚ
<
	gSHA512
>;

55 şas 
	cCRYPTOPP_DLL
 
	mPKCS1v15_SigÇtu»Mes§geEncodšgM‘hod
 : 
public
 
PK_D‘”mši¡icSigÇtu»Mes§geEncodšgM‘hod


57 
public
:

58 cÚ¡ * 
CRYPTOPP_API
 
	$SticAlgÜ™hmName
() { "EMSA-PKCS1-v1_5";}

60 
size_t
 
	$MšR•»£Á©iveB™L’gth
(
size_t
 
hashId’tif›rSize
, size_ˆ
dige¡Size
) const

61 { 8 * (
dige¡Size
 + 
hashId’tif›rSize
 + 10);
	}
}

63 
	$Compu‹Mes§geR•»£Á©ive
(
RªdomNumb”G’”©Ü
 &
ºg
,

64 cÚ¡ 
by‹
 *
»cov”abËMes§ge
, 
size_t
 
»cov”abËMes§geL’gth
,

65 
HashT¿nsfÜm©iÚ
 &
hash
, 
HashId’tif›r
 
hashId’tif›r
, 
boŞ
 
mes§geEm±y
,

66 
by‹
 *
»´e£Á©ive
, 
size_t
 
»´e£Á©iveB™L’gth
) const;

68 
	sHashId’tif›rLookup


70 
‹m¶©e
 <
şass
 
H
> 
	sHashId’tif›rLookup2


72 
HashId’tif›r
 
	`Lookup
()

74  
	`HashId’tif›r
(
PKCS_Dige¡DecÜ©iÚ
<
H
>::
decÜ©iÚ
, PKCS_Dige¡DecÜ©iÚ<H>::
Ëngth
);

77 
	}
};

86 
	gPKCS1v15
 : 
public
 
SigÇtu»Snd¬d
,…ubliø
	gEnüy±iÚSnd¬d


88 
PKCS_Enüy±iÚPaddšgScheme
 
	tEnüy±iÚMes§geEncodšgM‘hod
;

89 
PKCS1v15_SigÇtu»Mes§geEncodšgM‘hod
 
	tSigÇtu»Mes§geEncodšgM‘hod
;

92 
	gNAMESPACE_END


	@polynomi.cpp

6 
	~"pch.h
"

7 
	~"pŞynomi.h
"

8 
	~"£cblock.h
"

10 
	~<s¡»am
>

11 
	~<io¡»am
>

13 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

15 
‹m¶©e
 <
şass
 
T
>

16 
PŞynomŸlOv”
<
T
>::
	$Rªdomize
(
RªdomNumb”G’”©Ü
 &
ºg
, cÚ¡ 
Rªdomiz©iÚP¬am‘”
 &
·¿m‘”
, cÚ¡ 
Ršg
 &
ršg
)

18 
m_cÛffic›Ás
.
	`»size
(
·¿m‘”
.
m_cÛffic›ÁCouÁ
);

19 
i
=0; i<
m_cÛffic›Ás
.
	`size
(); ++i)

20 
m_cÛffic›Ás
[
i
] = 
ršg
.
	`RªdomEËm’t
(
ºg
, 
·¿m‘”
.
m_cÛffic›ÁP¬am‘”
);

21 
	}
}

23 
	g‹m¶©e
 <
şass
 
	gT
>

24 
	gPŞynomŸlOv”
<
	gT
>::
	$FromSŒ
(cÚ¡ *
¡r
, cÚ¡ 
Ršg
 &
ršg
)

26 
¡d
::
i¡ršg¡»am
 
	`š
((*)
¡r
);

27 
boŞ
 
pos™ive
 = 
Œue
;

28 
CÛffic›ÁTy³
 
cÛf
;

29 
pow”
;

31 
š
)

33 
¡d
::
	`ws
(
š
);

34 ià(
š
.
	`³ek
() == 'x')

35 
cÛf
 = 
ršg
.
	`MuÉliÿtiveId’t™y
();

37 
š
 >> 
cÛf
;

39 
¡d
::
	`ws
(
š
);

40 ià(
š
.
	`³ek
() == 'x')

42 
š
.
	`g‘
();

43 
¡d
::
	`ws
(
š
);

44 ià(
š
.
	`³ek
() == '^')

46 
š
.
	`g‘
();

47 
š
 >> 
pow”
;

50 
pow”
 = 1;

53 
pow”
 = 0;

55 ià(!
pos™ive
)

56 
cÛf
 = 
ršg
.
	`Inv”£
(coef);

58 
	`S‘CÛffic›Á
(
pow”
, 
cÛf
, 
ršg
);

60 
¡d
::
	`ws
(
š
);

61 
š
.
	`g‘
())

64 
pos™ive
 = 
Œue
;

67 
pos™ive
 = 
çl£
;

73 
	}
}

75 
	g‹m¶©e
 <
şass
 
	gT
>

76 
	gPŞynomŸlOv”
<
	gT
>::
	$CÛffic›ÁCouÁ
(cÚ¡ 
Ršg
 &
ršg
) const

78 
couÁ
 = 
m_cÛffic›Ás
.
	`size
();

79 
couÁ
 && 
ršg
.
	`Equ®
(
m_cÛffic›Ás
[couÁ-1],„šg.
	`Id’t™y
()))

80 
couÁ
--;

81 
cÚ¡_ÿ¡
<
¡d
::
veùÜ
<
CÛffic›ÁTy³
> &>(
m_cÛffic›Ás
).
	`»size
(
couÁ
);

82  
couÁ
;

83 
	}
}

85 
	g‹m¶©e
 <
şass
 
	gT
>

86 
ty³Çme
 
	gPŞynomŸlOv”
<
	gT
>::
CÛffic›ÁTy³
 
PŞynomŸlOv”
<
T
>::
	$G‘CÛffic›Á
(
i
, cÚ¡ 
Ršg
 &
ršg
) const

88  (
i
 < 
m_cÛffic›Ás
.
	`size
()è? m_cÛffic›Ás[i] : 
ršg
.
	`Id’t™y
();

89 
	}
}

91 
	g‹m¶©e
 <
şass
 
	gT
>

92 
	gPŞynomŸlOv”
<
	gT
>& PŞynomŸlOv”<T>::
İ”©Ü
=(cÚ¡ 
PŞynomŸlOv”
<
T
>& 
t
)

94 ià(
this
 !ğ&
t
)

96 
m_cÛffic›Ás
.
»size
(
t
.m_cÛffic›Ás.
size
());

97 
	gi
=0; i<
	gm_cÛffic›Ás
.
size
(); i++)

98 
	gm_cÛffic›Ás
[
i
] = 
t
.
m_cÛffic›Ás
[i];

100  *
	gthis
;

103 
	g‹m¶©e
 <
şass
 
	gT
>

104 
	gPŞynomŸlOv”
<
	gT
>& PŞynomŸlOv”<T>::
AccumuÏ‹
(cÚ¡ 
PŞynomŸlOv”
<
T
>& 
t
, cÚ¡ 
Ršg
 &
ršg
)

106 
	gcouÁ
 = 
t
.
CÛffic›ÁCouÁ
(
ršg
);

108 ià(
	gcouÁ
 > 
CÛffic›ÁCouÁ
(
ršg
))

109 
	gm_cÛffic›Ás
.
»size
(
couÁ
, 
ršg
.
Id’t™y
());

111 
	gi
=0; i<
	gcouÁ
; i++)

112 
	gršg
.
AccumuÏ‹
(
m_cÛffic›Ás
[
i
], 
t
.
G‘CÛffic›Á
(i, 
ršg
));

114  *
	gthis
;

117 
	g‹m¶©e
 <
şass
 
	gT
>

118 
	gPŞynomŸlOv”
<
	gT
>& PŞynomŸlOv”<T>::
Reduû
(cÚ¡ 
PŞynomŸlOv”
<
T
>& 
t
, cÚ¡ 
Ršg
 &
ršg
)

120 
	gcouÁ
 = 
t
.
CÛffic›ÁCouÁ
(
ršg
);

122 ià(
	gcouÁ
 > 
CÛffic›ÁCouÁ
(
ršg
))

123 
	gm_cÛffic›Ás
.
»size
(
couÁ
, 
ršg
.
Id’t™y
());

125 
	gi
=0; i<
	gcouÁ
; i++)

126 
	gršg
.
Reduû
(
m_cÛffic›Ás
[
i
], 
t
.
G‘CÛffic›Á
(i, 
ršg
));

128  *
	gthis
;

131 
	g‹m¶©e
 <
şass
 
	gT
>

132 
ty³Çme
 
	gPŞynomŸlOv”
<
	gT
>::
CÛffic›ÁTy³
 
PŞynomŸlOv”
<
T
>::
	$Ev®u©eAt
(cÚ¡ 
CÛffic›ÁTy³
 &
x
, cÚ¡ 
Ršg
 &
ršg
) const

134 
deg»e
 = 
	`Deg»e
(
ršg
);

136 ià(
deg»e
 < 0)

137  
ršg
.
	`Id’t™y
();

139 
CÛffic›ÁTy³
 
»suÉ
 = 
m_cÛffic›Ás
[
deg»e
];

140 
j
=
deg»e
-1; j>=0; j--)

142 
»suÉ
 = 
ršg
.
	`MuÉly
ÔesuÉ, 
x
);

143 
ršg
.
	`AccumuÏ‹
(
»suÉ
, 
m_cÛffic›Ás
[
j
]);

145  
»suÉ
;

146 
	}
}

148 
	g‹m¶©e
 <
şass
 
	gT
>

149 
	gPŞynomŸlOv”
<
	gT
>& PŞynomŸlOv”<T>::
	$ShiáLeá
(
n
, cÚ¡ 
Ršg
 &
ršg
)

151 
i
 = 
	`CÛffic›ÁCouÁ
(
ršg
è+ 
n
;

152 
m_cÛffic›Ás
.
	`»size
(
i
, 
ršg
.
	`Id’t™y
());

153 
i
 > 
n
)

155 
i
--;

156 
m_cÛffic›Ás
[
i
] = m_cÛffic›Ás[i-
n
];

158 
i
)

160 
i
--;

161 
m_cÛffic›Ás
[
i
] = 
ršg
.
	`Id’t™y
();

163  *
this
;

164 
	}
}

166 
	g‹m¶©e
 <
şass
 
	gT
>

167 
	gPŞynomŸlOv”
<
	gT
>& PŞynomŸlOv”<T>::
	$ShiáRight
(
n
, cÚ¡ 
Ršg
 &
ršg
)

169 
couÁ
 = 
	`CÛffic›ÁCouÁ
(
ršg
);

170 ià(
couÁ
 > 
n
)

172 
i
=0; i<
couÁ
-
n
; i++)

173 
m_cÛffic›Ás
[
i
] = m_cÛffic›Ás[i+
n
];

174 
m_cÛffic›Ás
.
	`»size
(
couÁ
-
n
, 
ršg
.
	`Id’t™y
());

177 
m_cÛffic›Ás
.
	`»size
(0, 
ršg
.
	`Id’t™y
());

178  *
this
;

179 
	}
}

181 
	g‹m¶©e
 <
şass
 
	gT
>

182 
	gPŞynomŸlOv”
<
	gT
>::
	$S‘CÛffic›Á
(
i
, cÚ¡ 
CÛffic›ÁTy³
 &
v®ue
, cÚ¡ 
Ršg
 &
ršg
)

184 ià(
i
 >ğ
m_cÛffic›Ás
.
	`size
())

185 
m_cÛffic›Ás
.
	`»size
(
i
+1, 
ršg
.
	`Id’t™y
());

186 
m_cÛffic›Ás
[
i
] = 
v®ue
;

187 
	}
}

189 
	g‹m¶©e
 <
şass
 
	gT
>

190 
	gPŞynomŸlOv”
<
	gT
>::
	$Neg©e
(cÚ¡ 
Ršg
 &
ršg
)

192 
couÁ
 = 
	`CÛffic›ÁCouÁ
(
ršg
);

193 
i
=0; i<
couÁ
; i++)

194 
m_cÛffic›Ás
[
i
] = 
ršg
.
	`Inv”£
(m_coefficients[i]);

195 
	}
}

197 
	g‹m¶©e
 <
şass
 
	gT
>

198 
	gPŞynomŸlOv”
<
	gT
>::
sw­
(
PŞynomŸlOv”
<
T
> &
t
)

200 
m_cÛffic›Ás
.
sw­
(
t
.m_coefficients);

203 
	g‹m¶©e
 <
şass
 
	gT
>

204 
boŞ
 
	gPŞynomŸlOv”
<
	gT
>::
Equ®s
(cÚ¡ 
PŞynomŸlOv”
<
T
>& 
t
, cÚ¡ 
Ršg
 &
ršg
) const

206 
	gcouÁ
 = 
CÛffic›ÁCouÁ
(
ršg
);

208 ià(
	gcouÁ
 !ğ
t
.
CÛffic›ÁCouÁ
(
ršg
))

209  
çl£
;

211 
	gi
=0; i<
	gcouÁ
; i++)

212 ià(!
	gršg
.
Equ®
(
m_cÛffic›Ás
[
i
], 
t
.m_coefficients[i]))

213  
	gçl£
;

215  
	gŒue
;

218 
	g‹m¶©e
 <
şass
 
	gT
>

219 
	gPŞynomŸlOv”
<
	gT
> PŞynomŸlOv”<T>::
Plus
(cÚ¡ 
PŞynomŸlOv”
<
T
>& 
t
, cÚ¡ 
Ršg
 &
ršg
) const

221 
	gi
;

222 
	gcouÁ
 = 
CÛffic›ÁCouÁ
(
ršg
);

223 
	gtCouÁ
 = 
t
.
CÛffic›ÁCouÁ
(
ršg
);

225 ià(
	gcouÁ
 > 
	gtCouÁ
)

227 
	gPŞynomŸlOv”
<
	gT
> 
»suÉ
(
ršg
, 
couÁ
);

229 
	gi
=0; i<
	gtCouÁ
; i++)

230 
	g»suÉ
.
	gm_cÛffic›Ás
[
i
] = 
ršg
.
Add
(
m_cÛffic›Ás
[i], 
t
.m_coefficients[i]);

231 ; 
	gi
<
	gcouÁ
; i++)

232 
	g»suÉ
.
	gm_cÛffic›Ás
[
i
] = 
m_cÛffic›Ás
[i];

234  
	g»suÉ
;

238 
	gPŞynomŸlOv”
<
	gT
> 
»suÉ
(
ršg
, 
tCouÁ
);

240 
	gi
=0; i<
	gcouÁ
; i++)

241 
	g»suÉ
.
	gm_cÛffic›Ás
[
i
] = 
ršg
.
Add
(
m_cÛffic›Ás
[i], 
t
.m_coefficients[i]);

242 ; 
	gi
<
	gtCouÁ
; i++)

243 
	g»suÉ
.
	gm_cÛffic›Ás
[
i
] = 
t
.
m_cÛffic›Ás
[i];

245  
	g»suÉ
;

249 
	g‹m¶©e
 <
şass
 
	gT
>

250 
	gPŞynomŸlOv”
<
	gT
> PŞynomŸlOv”<T>::
Mšus
(cÚ¡ 
PŞynomŸlOv”
<
T
>& 
t
, cÚ¡ 
Ršg
 &
ršg
) const

252 
	gi
;

253 
	gcouÁ
 = 
CÛffic›ÁCouÁ
(
ršg
);

254 
	gtCouÁ
 = 
t
.
CÛffic›ÁCouÁ
(
ršg
);

256 ià(
	gcouÁ
 > 
	gtCouÁ
)

258 
	gPŞynomŸlOv”
<
	gT
> 
»suÉ
(
ršg
, 
couÁ
);

260 
	gi
=0; i<
	gtCouÁ
; i++)

261 
	g»suÉ
.
	gm_cÛffic›Ás
[
i
] = 
ršg
.
SubŒaù
(
m_cÛffic›Ás
[i], 
t
.m_coefficients[i]);

262 ; 
	gi
<
	gcouÁ
; i++)

263 
	g»suÉ
.
	gm_cÛffic›Ás
[
i
] = 
m_cÛffic›Ás
[i];

265  
	g»suÉ
;

269 
	gPŞynomŸlOv”
<
	gT
> 
»suÉ
(
ršg
, 
tCouÁ
);

271 
	gi
=0; i<
	gcouÁ
; i++)

272 
	g»suÉ
.
	gm_cÛffic›Ás
[
i
] = 
ršg
.
SubŒaù
(
m_cÛffic›Ás
[i], 
t
.m_coefficients[i]);

273 ; 
	gi
<
	gtCouÁ
; i++)

274 
	g»suÉ
.
	gm_cÛffic›Ás
[
i
] = 
ršg
.
Inv”£
(
t
.
m_cÛffic›Ás
[i]);

276  
	g»suÉ
;

280 
	g‹m¶©e
 <
şass
 
	gT
>

281 
	gPŞynomŸlOv”
<
	gT
> PŞynomŸlOv”<T>::
	$Inv”£
(cÚ¡ 
Ršg
 &
ršg
) const

283 
couÁ
 = 
	`CÛffic›ÁCouÁ
(
ršg
);

284 
PŞynomŸlOv”
<
T
> 
	`»suÉ
(
ršg
, 
couÁ
);

286 
i
=0; i<
couÁ
; i++)

287 
»suÉ
.
m_cÛffic›Ás
[
i
] = 
ršg
.
	`Inv”£
(m_coefficients[i]);

289  
»suÉ
;

290 
	}
}

292 
	g‹m¶©e
 <
şass
 
	gT
>

293 
	gPŞynomŸlOv”
<
	gT
> PŞynomŸlOv”<T>::
Times
(cÚ¡ 
PŞynomŸlOv”
<
T
>& 
t
, cÚ¡ 
Ršg
 &
ršg
) const

295 ià(
IsZ”o
(
ršg
è|| 
	gt
.IsZero(ring))

296  
	gPŞynomŸlOv”
<
	gT
>();

298 
	gcouÁ1
 = 
CÛffic›ÁCouÁ
(
ršg
), 
	gcouÁ2
 = 
t
.CoefficientCount(ring);

299 
	gPŞynomŸlOv”
<
	gT
> 
»suÉ
(
ršg
, 
couÁ1
 + 
couÁ2
 - 1);

301 
	gi
=0; i<
	gcouÁ1
; i++)

302 
	gj
=0; j<
	gcouÁ2
; j++)

303 
	gršg
.
AccumuÏ‹
(
»suÉ
.
m_cÛffic›Ás
[
i
+
j
], 
ršg
.
MuÉly
(m_cÛffic›Ás[i], 
t
.m_coefficients[j]));

305  
	g»suÉ
;

308 
	g‹m¶©e
 <
şass
 
	gT
>

309 
	gPŞynomŸlOv”
<
	gT
> PŞynomŸlOv”<T>::
DividedBy
(cÚ¡ 
PŞynomŸlOv”
<
T
>& 
t
, cÚ¡ 
Ršg
 &
ršg
) const

311 
	gPŞynomŸlOv”
<
	gT
> 
	g»mašd”
, 
	gquÙ›Á
;

312 
Divide
(
»mašd”
, 
quÙ›Á
, *
this
, 
t
, 
ršg
);

313  
	gquÙ›Á
;

316 
	g‹m¶©e
 <
şass
 
	gT
>

317 
	gPŞynomŸlOv”
<
	gT
> PŞynomŸlOv”<T>::
Modulo
(cÚ¡ 
PŞynomŸlOv”
<
T
>& 
t
, cÚ¡ 
Ršg
 &
ršg
) const

319 
	gPŞynomŸlOv”
<
	gT
> 
	g»mašd”
, 
	gquÙ›Á
;

320 
Divide
(
»mašd”
, 
quÙ›Á
, *
this
, 
t
, 
ršg
);

321  
	g»mašd”
;

324 
	g‹m¶©e
 <
şass
 
	gT
>

325 
	gPŞynomŸlOv”
<
	gT
> PŞynomŸlOv”<T>::
	$MuÉliÿtiveInv”£
(cÚ¡ 
Ršg
 &
ršg
) const

327  
	`Deg»e
(
ršg
)==0 ?„šg.
	`MuÉliÿtiveInv”£
(
m_cÛffic›Ás
[0]è:„šg.
	`Id’t™y
();

328 
	}
}

330 
	g‹m¶©e
 <
şass
 
	gT
>

331 
boŞ
 
	gPŞynomŸlOv”
<
	gT
>::
	$IsUn™
(cÚ¡ 
Ršg
 &
ršg
) const

333  
	`Deg»e
(
ršg
)==0 &&„šg.
	`IsUn™
(
m_cÛffic›Ás
[0]);

334 
	}
}

336 
	g‹m¶©e
 <
şass
 
	gT
>

337 
	g¡d
::
i¡»am
& 
PŞynomŸlOv”
<
T
>::
	$IÅut
(
¡d
::
i¡»am
 &
š
, cÚ¡ 
Ršg
 &
ršg
)

339 
c
;

340 
Ëngth
 = 0;

341 
SecBlock
<> 
	`¡r
(
Ëngth
 + 16);

342 
boŞ
 
·»n
 = 
çl£
;

344 
¡d
::
	`ws
(
š
);

346 ià(
š
.
	`³ek
() == '(')

348 
·»n
 = 
Œue
;

349 
š
.
	`g‘
();

354 
š
.
	`»ad
(&
c
, 1);

355 
¡r
[
Ëngth
++] = 
c
;

356 ià(
Ëngth
 >ğ
¡r
.
	`size
())

357 
¡r
.
	`Grow
(
Ëngth
 + 16);

361 
š
 && ((
·»n
 && 
c
 != ')') || (!paren && c != '\n')));

363 
¡r
[
Ëngth
-1] = '\0';

364 *
this
 = 
PŞynomŸlOv”
<
T
>(
¡r
, 
ršg
);

366  
š
;

367 
	}
}

369 
	g‹m¶©e
 <
şass
 
	gT
>

370 
	g¡d
::
o¡»am
& 
PŞynomŸlOv”
<
T
>::
	$Ouut
(
¡d
::
o¡»am
 &
out
, cÚ¡ 
Ršg
 &
ršg
) const

372 
i
 = 
	`CÛffic›ÁCouÁ
(
ršg
);

373 ià(
i
)

375 
boŞ
 
fœ¡T”m
 = 
Œue
;

377 
i
--)

379 ià(
m_cÛffic›Ás
[
i
] !ğ
ršg
.
	`Id’t™y
())

381 ià(
fœ¡T”m
)

383 
fœ¡T”m
 = 
çl£
;

384 ià(!
i
 || !
ršg
.
	`Equ®
(
m_cÛffic›Ás
[i],„šg.
	`MuÉliÿtiveId’t™y
()))

385 
out
 << 
m_cÛffic›Ás
[
i
];

389 
CÛffic›ÁTy³
 
šv”£
 = 
ršg
.
	`Inv”£
(
m_cÛffic›Ás
[
i
]);

390 
¡d
::
o¡ršg¡»am
 
p¡r
, 
n¡r
;

392 
p¡r
 << 
m_cÛffic›Ás
[
i
];

393 
n¡r
 << 
šv”£
;

395 ià(
p¡r
.
	`¡r
().
	`size
(è<ğ
n¡r
.str().size())

397 
out
 << " + ";

398 ià(!
i
 || !
ršg
.
	`Equ®
(
m_cÛffic›Ás
[i],„šg.
	`MuÉliÿtiveId’t™y
()))

399 
out
 << 
m_cÛffic›Ás
[
i
];

403 
out
 << " - ";

404 ià(!
i
 || !
ršg
.
	`Equ®
(
šv”£
,„šg.
	`MuÉliÿtiveId’t™y
()))

405 
out
 << 
šv”£
;

409 
i
)

414 
out
 << "x";

417 
out
 << "x^" << 
i
;

424 
out
 << 
ršg
.
	`Id’t™y
();

426  
out
;

427 
	}
}

429 
	g‹m¶©e
 <
şass
 
	gT
>

430 
	gPŞynomŸlOv”
<
	gT
>::
Divide
(
PŞynomŸlOv”
<
T
> &
r
, PŞynomŸlOv”<T> &
q
, cÚ¡ PŞynomŸlOv”<T> &
a
, cÚ¡ PŞynomŸlOv”<T> &
d
, cÚ¡ 
Ršg
 &
ršg
)

432 
	gi
 = 
a
.
CÛffic›ÁCouÁ
(
ršg
);

433 cÚ¡ 
	gdDeg»e
 = 
d
.
Deg»e
(
ršg
);

435 ià(
	gdDeg»e
 < 0)

436 
throw
 
DivideByZ”o
();

438 
	gr
 = 
a
;

439 
	gq
.
	gm_cÛffic›Ás
.
»size
(
STDMAX
(0, (
i
 - 
dDeg»e
)));

441 
	gi
 > ()
	gdDeg»e
)

443 --
	gi
;

444 
	gq
.
	gm_cÛffic›Ás
[
i
-
dDeg»e
] = 
ršg
.
Divide
(
r
.
m_cÛffic›Ás
[i], 
d
.m_coefficients[dDegree]);

445 
	gj
=0; j<=
dDeg»e
; j++)

446 
	gršg
.
Reduû
(
r
.
m_cÛffic›Ás
[
i
-
dDeg»e
+
j
], 
ršg
.
MuÉly
(
q
.m_cÛffic›Ás[i-dDeg»e], 
d
.m_coefficients[j]));

449 
	gr
.
CÛffic›ÁCouÁ
(
ršg
);

455 
	g‹m¶©e
 <
şass
 
	gT
>

456 
	gRšgOfPŞynomŸlsOv”
<
	gT
>::
C®cuÏ‹AÍha
(
¡d
::
veùÜ
<
CÛffic›ÁTy³
> &
®pha
, cÚ¡ CÛffic›ÁTy³ 
x
[], cÚ¡ CÛffic›ÁTy³ 
y
[], 
n
) const

458 
	gj
=0; j<
	gn
; ++j)

459 
	g®pha
[
j
] = 
y
[j];

461 
	gk
=1; k<
	gn
; ++k)

463 
	gj
=
n
-1; j>=
k
; --j)

465 
	gm_ršg
.
Reduû
(
®pha
[
j
],‡lpha[j-1]);

467 
CÛffic›ÁTy³
 
	gd
 = 
m_ršg
.
SubŒaù
(
x
[
j
], x[j-
k
]);

468 ià(!
	gm_ršg
.
IsUn™
(
d
))

469 
throw
 
IÁ”pŞ©iÚFaed
();

470 
	g®pha
[
j
] = 
m_ršg
.
Divide
(
®pha
[j], 
d
);

475 
	g‹m¶©e
 <
şass
 
	gT
>

476 
ty³Çme
 
	gRšgOfPŞynomŸlsOv”
<
	gT
>::
EËm’t
 
RšgOfPŞynomŸlsOv”
<
T
>::
	$IÁ”pŞ©e
(cÚ¡ 
CÛffic›ÁTy³
 
x
[], cÚ¡ CÛffic›ÁTy³ 
y
[], 
n
) const

478 
	`as£¹
(
n
 > 0);

480 
¡d
::
veùÜ
<
CÛffic›ÁTy³
> 
	`®pha
(
n
);

481 
	`C®cuÏ‹AÍha
(
®pha
, 
x
, 
y
, 
n
);

483 
¡d
::
veùÜ
<
CÛffic›ÁTy³
> 
	`cÛffic›Ás
((
size_t
)
n
, 
m_ršg
.
	`Id’t™y
());

484 
cÛffic›Ás
[0] = 
®pha
[
n
-1];

486 
j
=
n
-2; j>=0; --j)

488 
i
=
n
-
j
-1; i>0; i--)

489 
cÛffic›Ás
[
i
] = 
m_ršg
.
	`SubŒaù
(cÛffic›Ás[i-1], m_ršg.
	`MuÉly
(cÛffic›Ás[i], 
x
[
j
]));

491 
cÛffic›Ás
[0] = 
m_ršg
.
	`SubŒaù
(
®pha
[
j
], m_ršg.
	`MuÉly
(cÛffic›Ás[0], 
x
[j]));

494  
PŞynomŸlOv”
<
T
>(
cÛffic›Ás
.
	`begš
(), cÛffic›Ás.
	`’d
());

495 
	}
}

497 
	g‹m¶©e
 <
şass
 
	gT
>

498 
ty³Çme
 
	gRšgOfPŞynomŸlsOv”
<
	gT
>::
CÛffic›ÁTy³
 
RšgOfPŞynomŸlsOv”
<
T
>::
	$IÁ”pŞ©eAt
(cÚ¡ 
CÛffic›ÁTy³
 &
pos™iÚ
, cÚ¡ CÛffic›ÁTy³ 
x
[], cÚ¡ CÛffic›ÁTy³ 
y
[], 
n
) const

500 
	`as£¹
(
n
 > 0);

502 
¡d
::
veùÜ
<
CÛffic›ÁTy³
> 
	`®pha
(
n
);

503 
	`C®cuÏ‹AÍha
(
®pha
, 
x
, 
y
, 
n
);

505 
CÛffic›ÁTy³
 
»suÉ
 = 
®pha
[
n
-1];

506 
j
=
n
-2; j>=0; --j)

508 
»suÉ
 = 
m_ršg
.
	`MuÉly
ÔesuÉ, m_ršg.
	`SubŒaù
(
pos™iÚ
, 
x
[
j
]));

509 
m_ršg
.
	`AccumuÏ‹
(
»suÉ
, 
®pha
[
j
]);

511  
»suÉ
;

512 
	}
}

514 
	g‹m¶©e
 <
şass
 
	gRšg
, cÏs 
	gEËm’t
>

515 
	$P»·»BulkPŞynomŸlIÁ”pŞ©iÚ
(cÚ¡ 
Ršg
 &
ršg
, 
EËm’t
 *
w
, cÚ¡ EËm’ˆ
x
[], 
n
)

517 
i
=0; i<
n
; i++)

519 
EËm’t
 
t
 = 
ršg
.
	`MuÉliÿtiveId’t™y
();

520 
j
=0; j<
n
; j++)

521 ià(
i
 !ğ
j
)

522 
t
 = 
ršg
.
	`MuÉly
Ñ,„šg.
	`SubŒaù
(
x
[
i
], x[
j
]));

523 
w
[
i
] = 
ršg
.
	`MuÉliÿtiveInv”£
(
t
);

525 
	}
}

527 
	g‹m¶©e
 <
şass
 
	gRšg
, cÏs 
	gEËm’t
>

528 
	$P»·»BulkPŞynomŸlIÁ”pŞ©iÚAt
(cÚ¡ 
Ršg
 &
ršg
, 
EËm’t
 *
v
, cÚ¡ EËm’ˆ&
pos™iÚ
, cÚ¡ EËm’ˆ
x
[], cÚ¡ EËm’ˆ
w
[], 
n
)

530 
	`as£¹
(
n
 > 0);

532 
¡d
::
veùÜ
<
EËm’t
> 
	`a
(2*
n
-1);

533 
i
;

535 
i
=0; i<
n
; i++)

536 
a
[
n
-1+
i
] = 
ršg
.
	`SubŒaù
(
pos™iÚ
, 
x
[i]);

538 
i
=
n
-1; i>1; i--)

539 
a
[
i
-1] = 
ršg
.
	`MuÉly
(a[2*i],‡[2*i-1]);

541 
a
[0] = 
ršg
.
	`MuÉliÿtiveId’t™y
();

543 
i
=0; i<
n
-1; i++)

545 
¡d
::
	`sw­
(
a
[2*
i
+1],‡[2*i+2]);

546 
a
[2*
i
+1] = 
ršg
.
	`MuÉly
(a[i],‡[2*i+1]);

547 
a
[2*
i
+2] = 
ršg
.
	`MuÉly
(a[i],‡[2*i+2]);

550 
i
=0; i<
n
; i++)

551 
v
[
i
] = 
ršg
.
	`MuÉly
(
a
[
n
-1+i], 
w
[i]);

552 
	}
}

554 
	g‹m¶©e
 <
şass
 
	gRšg
, cÏs 
	gEËm’t
>

555 
EËm’t
 
	$BulkPŞynomŸlIÁ”pŞ©eAt
(cÚ¡ 
Ršg
 &
ršg
, cÚ¡ 
EËm’t
 
y
[], cÚ¡ EËm’ˆ
v
[], 
n
)

557 
EËm’t
 
»suÉ
 = 
ršg
.
	`Id’t™y
();

558 
i
=0; i<
n
; i++)

559 
ršg
.
	`AccumuÏ‹
(
»suÉ
,„šg.
	`MuÉly
(
y
[
i
], 
v
[i]));

560  
»suÉ
;

561 
	}
}

565 
	g‹m¶©e
 <
şass
 
	gT
, 
	gš¡ªû
>

566 cÚ¡ 
	gPŞynomŸlOv”FixedRšg
<
	gT
, 
	gš¡ªû
> &PŞynomŸlOv”FixedRšg<T, in¡ªû>::
	$Z”o
()

568  
SšgËtÚ
<
ThisTy³
>().
	`Ref
();

569 
	}
}

571 
	g‹m¶©e
 <
şass
 
	gT
, 
	gš¡ªû
>

572 cÚ¡ 
	gPŞynomŸlOv”FixedRšg
<
	gT
, 
	gš¡ªû
> &PŞynomŸlOv”FixedRšg<T, in¡ªû>::
	$OÃ
()

574  
SšgËtÚ
<
ThisTy³
, 
NewOÃPŞynomŸl
>().
	`Ref
();

575 
	}
}

577 
	gNAMESPACE_END


	@polynomi.h

1 #iâdeà
CRYPTOPP_POLYNOMI_H


2 
	#CRYPTOPP_POLYNOMI_H


	)

6 
	~"üy±lib.h
"

7 
	~"misc.h
"

8 
	~"®geb¿.h
"

10 
	~<iosfwd
>

11 
	~<veùÜ
>

13 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

17 
‹m¶©e
 <
şass
 
T
> cÏs 
	cPŞynomŸlOv”


19 
public
:

23 şas 
	cDivideByZ”o
 : 
public
 
Exû±iÚ


25 
public
:

26 
	`DivideByZ”o
(è: 
	`Exû±iÚ
(
OTHER_ERROR
, "PolynomialOver<T>: division by zero") {}

30 şas 
	cRªdomiz©iÚP¬am‘”


32 
public
:

33 
	`Rªdomiz©iÚP¬am‘”
(
cÛffic›ÁCouÁ
, cÚ¡ 
ty³Çme
 
T
::
Rªdomiz©iÚP¬am‘”
 &
cÛffic›ÁP¬am‘”
 )

34 : 
	`m_cÛffic›ÁCouÁ
(
cÛffic›ÁCouÁ
), 
	`m_cÛffic›ÁP¬am‘”
(
cÛffic›ÁP¬am‘”
) {}

36 
´iv©e
:

37 
m_cÛffic›ÁCouÁ
;

38 
ty³Çme
 
T
::
Rªdomiz©iÚP¬am‘”
 
m_cÛffic›ÁP¬am‘”
;

39 
ä›nd
 
şass
 
PŞynomŸlOv”
<
T
>;

40 
	}
};

42 
T
 
	tRšg
;

43 
ty³Çme
 
	tT
::
	tEËm’t
 
	tCÛffic›ÁTy³
;

49 
	$PŞynomŸlOv”
(è{
	}
}

52 
	$PŞynomŸlOv”
(cÚ¡ 
Ršg
 &
ršg
, 
couÁ
)

53 : 
	`m_cÛffic›Ás
((
size_t
)
couÁ
, 
ršg
.
	$Id’t™y
()è{
	}
}

56 
PŞynomŸlOv”
(cÚ¡ PŞynomŸlOv”<
Ršg
> &
t
)

57 : 
m_cÛffic›Ás
(
t
.m_cÛffic›Ás.
	$size
()è{*
this
 = 
t
;
	}
}

60 
	$PŞynomŸlOv”
(cÚ¡ 
CÛffic›ÁTy³
 &
–em’t
)

61 : 
	$m_cÛffic›Ás
(1, 
–em’t
è{
	}
}

64 
	g‹m¶©e
 <
ty³Çme
 
	gI‹¿tÜ
> 
	$PŞynomŸlOv”
(
I‹¿tÜ
 
begš
, I‹¿tÜ 
’d
)

65 : 
	$m_cÛffic›Ás
(
begš
, 
’d
è{
	}
}

68 
	$PŞynomŸlOv”
(cÚ¡ *
¡r
, cÚ¡ 
Ršg
 &
ršg
è{
	`FromSŒ
(¡r,„šg);
	}
}

71 
PŞynomŸlOv”
(cÚ¡ 
by‹
 *
’codedPŞynomŸlOv”
, 
by‹CouÁ
);

74 
ex¶ic™
 
PŞynomŸlOv”
(cÚ¡ 
by‹
 *
BEREncodedPŞynomŸlOv”
);

77 
ex¶ic™
 
PŞynomŸlOv”
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
);

80 
	$PŞynomŸlOv”
(
RªdomNumb”G’”©Ü
 &
ºg
, cÚ¡ 
Rªdomiz©iÚP¬am‘”
 &
·¿m‘”
, cÚ¡ 
Ršg
 &
ršg
)

81 {
	`Rªdomize
(
ºg
, 
·¿m‘”
, 
ršg
);
	}
}

87 
	$Deg»e
(cÚ¡ 
Ršg
 &
ršg
ècÚ¡ { (
	`CÛffic›ÁCouÁ
Ôšg))-1;
	}
}

89 
	$CÛffic›ÁCouÁ
(cÚ¡ 
Ršg
 &
ršg
) const;

91 
CÛffic›ÁTy³
 
	$G‘CÛffic›Á
(
i
, cÚ¡ 
Ršg
 &
ršg
) const;

97 
PŞynomŸlOv”
<
Ršg
>& 
İ”©Ü
=(cÚ¡ PŞynomŸlOv”<Ršg>& 
t
);

100 
	`Rªdomize
(
RªdomNumb”G’”©Ü
 &
ºg
, cÚ¡ 
Rªdomiz©iÚP¬am‘”
 &
·¿m‘”
, cÚ¡ 
Ršg
 &
ršg
);

103 
	`S‘CÛffic›Á
(
i
, cÚ¡ 
CÛffic›ÁTy³
 &
v®ue
, cÚ¡ 
Ršg
 &
ršg
);

106 
	`Neg©e
(cÚ¡ 
Ršg
 &
ršg
);

109 
	`sw­
(
PŞynomŸlOv”
<
Ršg
> &
t
);

115 
boŞ
 
	`Equ®s
(cÚ¡ 
PŞynomŸlOv”
<
Ršg
> &
t
, cÚ¡ Ršg &
ršg
) const;

116 
boŞ
 
	$IsZ”o
(cÚ¡ 
Ršg
 &
ršg
ècÚ¡ { 
	`CÛffic›ÁCouÁ
Ôšg)==0;
	}
}

118 
	gPŞynomŸlOv”
<
	gRšg
> 
Plus
(cÚ¡ 
PŞynomŸlOv”
<
Ršg
>& 
t
, cÚ¡ Ršg &
ršg
) const;

119 
	gPŞynomŸlOv”
<
	gRšg
> 
Mšus
(cÚ¡ 
PŞynomŸlOv”
<
Ršg
>& 
t
, cÚ¡ Ršg &
ršg
) const;

120 
	gPŞynomŸlOv”
<
	gRšg
> 
	$Inv”£
(cÚ¡ 
Ršg
 &
ršg
) const;

122 
PŞynomŸlOv”
<
Ršg
> 
	`Times
(cÚ¡ PŞynomŸlOv”<Ršg>& 
t
, cÚ¡ Ršg &
ršg
) const;

123 
PŞynomŸlOv”
<
Ršg
> 
	`DividedBy
(cÚ¡ PŞynomŸlOv”<Ršg>& 
t
, cÚ¡ Ršg &
ršg
) const;

124 
PŞynomŸlOv”
<
Ršg
> 
	`Modulo
(cÚ¡ PŞynomŸlOv”<Ršg>& 
t
, cÚ¡ Ršg &
ršg
) const;

125 
PŞynomŸlOv”
<
Ršg
> 
	$MuÉliÿtiveInv”£
(cÚ¡ 
Ršg
 &
ršg
) const;

126 
boŞ
 
	$IsUn™
(cÚ¡ 
Ršg
 &
ršg
) const;

128 
PŞynomŸlOv”
<
Ršg
>& 
	`AccumuÏ‹
(cÚ¡ PŞynomŸlOv”<Ršg>& 
t
, cÚ¡ Ršg &
ršg
);

129 
PŞynomŸlOv”
<
Ršg
>& 
	`Reduû
(cÚ¡ PŞynomŸlOv”<Ršg>& 
t
, cÚ¡ Ršg &
ršg
);

132 
PŞynomŸlOv”
<
Ršg
> 
	$DoubËd
(cÚ¡ 
Ršg
 &
ršg
ècÚ¡ { 
	`Plus
(*
this
,„šg);
	}
}

134 
	gPŞynomŸlOv”
<
	gRšg
> 
	$Squ¬ed
(cÚ¡ 
Ršg
 &
ršg
ècÚ¡ { 
	`Times
(*
this
,„šg);
	}
}

136 
CÛffic›ÁTy³
 
	$Ev®u©eAt
(cÚ¡ 
CÛffic›ÁTy³
 &
x
, cÚ¡ 
Ršg
 &
ršg
) const;

138 
PŞynomŸlOv”
<
Ršg
>& 
	`ShiáLeá
(
n
, cÚ¡ Ršg &
ršg
);

139 
PŞynomŸlOv”
<
Ršg
>& 
	`ShiáRight
(
n
, cÚ¡ Ršg &
ršg
);

142 
	`Divide
(
PŞynomŸlOv”
<
Ršg
> &
r
, PŞynomŸlOv”<Ršg> &
q
, cÚ¡ PŞynomŸlOv”<Ršg> &
a
, cÚ¡ PŞynomŸlOv”<Ršg> &
d
, cÚ¡ Ršg &
ršg
);

147 
¡d
::
i¡»am
& 
	`IÅut
(¡d::i¡»am &
š
, cÚ¡ 
Ršg
 &
ršg
);

148 
¡d
::
o¡»am
& 
	$Ouut
(
¡d
::
o¡»am
 &
out
, cÚ¡ 
Ršg
 &
ršg
) const;

151 
´iv©e
:

152 
	`FromSŒ
(cÚ¡ *
¡r
, cÚ¡ 
Ršg
 &
ršg
);

154 
¡d
::
veùÜ
<
CÛffic›ÁTy³
> 
m_cÛffic›Ás
;

155 
	}
};

159 
	g‹m¶©e
 <
şass
 
	gT
, 
	gš¡ªû
> cÏs 
	gPŞynomŸlOv”FixedRšg
 : 
´iv©e
 
PŞynomŸlOv”
<
T
>

161 
PŞynomŸlOv”
<
	tT
> 
	tB
;

162 
	gPŞynomŸlOv”FixedRšg
<
	tT
, 
	tš¡ªû
> 
	tThisTy³
;

164 
	gpublic
:

165 
T
 
	tRšg
;

166 
ty³Çme
 
	tT
::
	tEËm’t
 
	tCÛffic›ÁTy³
;

167 
ty³Çme
 
	tB
::
	tDivideByZ”o
 DivideByZero;

168 
ty³Çme
 
	tB
::
	tRªdomiz©iÚP¬am‘”
 RandomizationParameter;

173 
PŞynomŸlOv”FixedRšg
(
couÁ
 = 0è: 
B
(
ms_fixedRšg
, count) {}

176 
PŞynomŸlOv”FixedRšg
(cÚ¡ 
ThisTy³
 &
t
è: 
B
(t) {}

178 
ex¶ic™
 
PŞynomŸlOv”FixedRšg
(cÚ¡ 
B
 &
t
) : B(t) {}

181 
PŞynomŸlOv”FixedRšg
(cÚ¡ 
CÛffic›ÁTy³
 &
–em’t
è: 
B
(element) {}

184 
‹m¶©e
 <
ty³Çme
 
I‹¿tÜ
> 
PŞynomŸlOv”FixedRšg
(I‹¿tÜ 
fœ¡
, I‹¿tÜ 
Ï¡
)

185 : 
B
(
fœ¡
, 
Ï¡
) {}

188 
ex¶ic™
 
PŞynomŸlOv”FixedRšg
(cÚ¡ *
¡r
è: 
B
(¡r, 
ms_fixedRšg
) {}

191 
PŞynomŸlOv”FixedRšg
(cÚ¡ 
by‹
 *
’codedPŞy
, 
by‹CouÁ
è: 
B
(encodedPoly, byteCount) {}

194 
ex¶ic™
 
PŞynomŸlOv”FixedRšg
(cÚ¡ 
by‹
 *
BEREncodedPŞy
è: 
B
(BEREncodedPoly) {}

197 
ex¶ic™
 
PŞynomŸlOv”FixedRšg
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
è: 
B
(bt) {}

200 
PŞynomŸlOv”FixedRšg
(
RªdomNumb”G’”©Ü
 &
ºg
, cÚ¡ 
Rªdomiz©iÚP¬am‘”
 &
·¿m‘”
è: 
B
Ông,…¬am‘”, 
ms_fixedRšg
) {}

202 cÚ¡ 
	gThisTy³
 &
Z”o
();

203 cÚ¡ 
	gThisTy³
 &
OÃ
();

209 
Deg»e
(ècÚ¡ { 
	gB
::Deg»e(
ms_fixedRšg
);}

211 
CÛffic›ÁCouÁ
(ècÚ¡ { 
	gB
::CÛffic›ÁCouÁ(
ms_fixedRšg
);}

213 
CÛffic›ÁTy³
 
G‘CÛffic›Á
(
i
ècÚ¡ { 
	gB
::G‘CÛffic›Á(i, 
ms_fixedRšg
);}

215 
CÛffic›ÁTy³
 
	gİ”©Ü
[](
	gi
ècÚ¡ { 
	gB
::
G‘CÛffic›Á
(
i
, 
ms_fixedRšg
);}

221 
	gThisTy³
& 
	gİ”©Ü
=(cÚ¡ 
ThisTy³
& 
t
è{
B
::
İ”©Ü
=Ñ);  *
	gthis
;}

223 
	gThisTy³
& 
	gİ”©Ü
+=(cÚ¡ 
ThisTy³
& 
t
è{
AccumuÏ‹
Ñ, 
ms_fixedRšg
);  *
	gthis
;}

225 
	gThisTy³
& 
	gİ”©Ü
-=(cÚ¡ 
ThisTy³
& 
t
è{
Reduû
Ñ, 
ms_fixedRšg
);  *
	gthis
;}

227 
	gThisTy³
& 
	gİ”©Ü
*=(cÚ¡ 
ThisTy³
& 
t
è{ *
this
 = *this*t;}

229 
	gThisTy³
& 
	gİ”©Ü
/=(cÚ¡ 
ThisTy³
& 
t
è{ *
this
 = *this/t;}

231 
	gThisTy³
& 
	gİ”©Ü
%=(cÚ¡ 
ThisTy³
& 
t
è{ *
this
 = *this%t;}

234 
	gThisTy³
& 
	gİ”©Ü
<<=(
n
è{
ShiáLeá
Ò, 
ms_fixedRšg
);  *
	gthis
;}

236 
	gThisTy³
& 
	gİ”©Ü
>>=(
n
è{
ShiáRight
Ò, 
ms_fixedRšg
);  *
	gthis
;}

239 
S‘CÛffic›Á
(
i
, cÚ¡ 
CÛffic›ÁTy³
 &
v®ue
è{
	gB
::S‘CÛffic›Á(i, v®ue, 
ms_fixedRšg
);}

242 
Rªdomize
(
RªdomNumb”G’”©Ü
 &
ºg
, cÚ¡ 
Rªdomiz©iÚP¬am‘”
 &
·¿m‘”
è{
	gB
::RªdomizeÔng,…¬am‘”, 
ms_fixedRšg
);}

245 
Neg©e
(è{
	gB
::Neg©e(
ms_fixedRšg
);}

247 
sw­
(
ThisTy³
 &
t
è{
	gB
::swap(t);}

253 
boŞ
 
	gİ”©Ü
!(ècÚ¡ { 
CÛffic›ÁCouÁ
()==0;}

255 
ThisTy³
 
	gİ”©Ü
+(ècÚ¡ { *
	gthis
;}

257 
ThisTy³
 
	gİ”©Ü
-(ècÚ¡ { ThisTy³(
Inv”£
(
ms_fixedRšg
));}

263 
ä›nd
 
ThisTy³
 
	gİ”©Ü
>>(ThisTy³ 
	ga
, 
	gn
è{ ThisTy³(
a
>>=
n
);}

265 
ä›nd
 
ThisTy³
 
	gİ”©Ü
<<(ThisTy³ 
	ga
, 
	gn
è{ ThisTy³(
a
<<=
n
);}

271 
ThisTy³
 
MuÉliÿtiveInv”£
(ècÚ¡ { ThisTy³(
B
::MuÉliÿtiveInv”£(
ms_fixedRšg
));}

273 
boŞ
 
IsUn™
(ècÚ¡ { 
	gB
::IsUn™(
ms_fixedRšg
);}

276 
ThisTy³
 
DoubËd
(ècÚ¡ { ThisTy³(
B
::DoubËd(
ms_fixedRšg
));}

278 
ThisTy³
 
Squ¬ed
(ècÚ¡ { ThisTy³(
B
::Squ¬ed(
ms_fixedRšg
));}

280 
CÛffic›ÁTy³
 
Ev®u©eAt
(cÚ¡ CÛffic›ÁTy³ &
x
ècÚ¡ { 
	gB
::Ev®u©eAt(x, 
ms_fixedRšg
);}

283 
Divide
(
ThisTy³
 &
r
, ThisTy³ &
q
, cÚ¡ ThisTy³ &
a
, cÚ¡ ThisTy³ &
d
)

284 {
	gB
::
Divide
(
r
, 
q
, 
a
, 
d
, 
ms_fixedRšg
);}

290 
ä›nd
 
	g¡d
::
i¡»am
& 
İ”©Ü
>>(
¡d
::i¡»am& 
š
, 
	gThisTy³
 &
	ga
)

291 { 
	ga
.
IÅut
(
š
, 
ms_fixedRšg
);}

293 
ä›nd
 
	g¡d
::
o¡»am
& 
İ”©Ü
<<(
¡d
::o¡»am& 
out
, cÚ¡ 
	gThisTy³
 &
	ga
)

294 { 
	ga
.
Ouut
(
out
, 
ms_fixedRšg
);}

297 
	g´iv©e
:

298 
	sNewOÃPŞynomŸl


300 
ThisTy³
 * 
İ”©Ü
()() const

302  
Ãw
 
ThisTy³
(
ms_fixedRšg
.
MuÉliÿtiveId’t™y
());

306 cÚ¡ 
Ršg
 
	gms_fixedRšg
;

310 
	g‹m¶©e
 <
şass
 
	gT
> cÏs 
	gRšgOfPŞynomŸlsOv”
 : 
public
 
Ab¡¿ùEuşid—nDomaš
<
PŞynomŸlOv”
<
T
> >

312 
public
:

313 
T
 
	tCÛffic›ÁRšg
;

314 
	gPŞynomŸlOv”
<
	tT
> 
	tEËm’t
;

315 
ty³Çme
 
	tEËm’t
::
	tCÛffic›ÁTy³
 CoefficientType;

316 
ty³Çme
 
	tEËm’t
::
	tRªdomiz©iÚP¬am‘”
 RandomizationParameter;

318 
RšgOfPŞynomŸlsOv”
(cÚ¡ 
CÛffic›ÁRšg
 &
ršg
è: 
m_ršg
(ring) {}

320 
EËm’t
 
RªdomEËm’t
(
RªdomNumb”G’”©Ü
 &
ºg
, cÚ¡ 
Rªdomiz©iÚP¬am‘”
 &
·¿m‘”
)

321 { 
EËm’t
(
ºg
, 
·¿m‘”
, 
m_ršg
);}

323 
boŞ
 
Equ®
(cÚ¡ 
EËm’t
 &
a
, cÚ¡ EËm’ˆ&
b
) const

324 { 
	ga
.
Equ®s
(
b
, 
m_ršg
);}

326 cÚ¡ 
	gEËm’t
& 
Id’t™y
() const

327 { 
	gthis
->
	g»suÉ
 = 
m_ršg
.
Id’t™y
();}

329 cÚ¡ 
	gEËm’t
& 
Add
(cÚ¡ 
EËm’t
 &
a
, cÚ¡ EËm’ˆ&
b
) const

330 { 
	gthis
->
	g»suÉ
 = 
a
.
Plus
(
b
, 
m_ršg
);}

332 
	gEËm’t
& 
AccumuÏ‹
(
EËm’t
 &
a
, cÚ¡ EËm’ˆ&
b
) const

333 {
	ga
.
AccumuÏ‹
(
b
, 
m_ršg
); ‡;}

335 cÚ¡ 
	gEËm’t
& 
Inv”£
(cÚ¡ 
EËm’t
 &
a
) const

336 { 
	gthis
->
	g»suÉ
 = 
a
.
Inv”£
(
m_ršg
);}

338 cÚ¡ 
	gEËm’t
& 
SubŒaù
(cÚ¡ 
EËm’t
 &
a
, cÚ¡ EËm’ˆ&
b
) const

339 { 
	gthis
->
	g»suÉ
 = 
a
.
Mšus
(
b
, 
m_ršg
);}

341 
	gEËm’t
& 
Reduû
(
EËm’t
 &
a
, cÚ¡ EËm’ˆ&
b
) const

342 { 
	ga
.
Reduû
(
b
, 
m_ršg
);}

344 cÚ¡ 
	gEËm’t
& 
DoubË
(cÚ¡ 
EËm’t
 &
a
) const

345 { 
	gthis
->
	g»suÉ
 = 
a
.
DoubËd
(
m_ršg
);}

347 cÚ¡ 
	gEËm’t
& 
MuÉliÿtiveId’t™y
() const

348 { 
	gthis
->
	g»suÉ
 = 
m_ršg
.
MuÉliÿtiveId’t™y
();}

350 cÚ¡ 
	gEËm’t
& 
MuÉly
(cÚ¡ 
EËm’t
 &
a
, cÚ¡ EËm’ˆ&
b
) const

351 { 
	gthis
->
	g»suÉ
 = 
a
.
Times
(
b
, 
m_ršg
);}

353 cÚ¡ 
	gEËm’t
& 
Squ¬e
(cÚ¡ 
EËm’t
 &
a
) const

354 { 
	gthis
->
	g»suÉ
 = 
a
.
Squ¬ed
(
m_ršg
);}

356 
boŞ
 
IsUn™
(cÚ¡ 
EËm’t
 &
a
) const

357 { 
	ga
.
IsUn™
(
m_ršg
);}

359 cÚ¡ 
	gEËm’t
& 
MuÉliÿtiveInv”£
(cÚ¡ 
EËm’t
 &
a
) const

360 { 
	gthis
->
	g»suÉ
 = 
a
.
MuÉliÿtiveInv”£
(
m_ršg
);}

362 cÚ¡ 
	gEËm’t
& 
Divide
(cÚ¡ 
EËm’t
 &
a
, cÚ¡ EËm’ˆ&
b
) const

363 { 
	gthis
->
	g»suÉ
 = 
a
.
DividedBy
(
b
, 
m_ršg
);}

365 cÚ¡ 
	gEËm’t
& 
Mod
(cÚ¡ 
EËm’t
 &
a
, cÚ¡ EËm’ˆ&
b
) const

366 { 
	gthis
->
	g»suÉ
 = 
a
.
Modulo
(
b
, 
m_ršg
);}

368 
DivisiÚAlgÜ™hm
(
EËm’t
 &
r
, EËm’ˆ&
q
, cÚ¡ EËm’ˆ&
a
, cÚ¡ EËm’ˆ&
d
) const

369 {
	gEËm’t
::
Divide
(
r
, 
q
, 
a
, 
d
, 
m_ršg
);}

371 şas 
	cIÁ”pŞ©iÚFaed
 : 
public
 
Exû±iÚ


373 
public
:

374 
IÁ”pŞ©iÚFaed
(è: 
Exû±iÚ
(
OTHER_ERROR
, "RingOfPolynomialsOver<T>: interpolation failed") {}

377 
EËm’t
 
	$IÁ”pŞ©e
(cÚ¡ 
CÛffic›ÁTy³
 
x
[], cÚ¡ CÛffic›ÁTy³ 
y
[], 
n
) const;

380 
CÛffic›ÁTy³
 
	$IÁ”pŞ©eAt
(cÚ¡ 
CÛffic›ÁTy³
 &
pos™iÚ
, cÚ¡ CÛffic›ÁTy³ 
x
[], cÚ¡ CÛffic›ÁTy³ 
y
[], 
n
) const;

386 
´Ùeùed
:

387 
	`C®cuÏ‹AÍha
(
¡d
::
veùÜ
<
CÛffic›ÁTy³
> &
®pha
, cÚ¡ CÛffic›ÁTy³ 
x
[], cÚ¡ CÛffic›ÁTy³ 
y
[], 
n
) const;

389 
CÛffic›ÁRšg
 
m_ršg
;

390 
	}
};

392 
	g‹m¶©e
 <
şass
 
	gRšg
, cÏs 
	gEËm’t
>

393 
P»·»BulkPŞynomŸlIÁ”pŞ©iÚ
(cÚ¡ 
Ršg
 &
ršg
, 
EËm’t
 *
w
, cÚ¡ EËm’ˆ
x
[], 
n
);

394 
	g‹m¶©e
 <
şass
 
	gRšg
, cÏs 
	gEËm’t
>

395 
P»·»BulkPŞynomŸlIÁ”pŞ©iÚAt
(cÚ¡ 
Ršg
 &
ršg
, 
EËm’t
 *
v
, cÚ¡ EËm’ˆ&
pos™iÚ
, cÚ¡ EËm’ˆ
x
[], cÚ¡ EËm’ˆ
w
[], 
n
);

396 
	g‹m¶©e
 <
şass
 
	gRšg
, cÏs 
	gEËm’t
>

397 
EËm’t
 
BulkPŞynomŸlIÁ”pŞ©eAt
(cÚ¡ 
Ršg
 &
ršg
, cÚ¡ EËm’ˆ
y
[], cÚ¡ EËm’ˆ
v
[], 
n
);

400 
	g‹m¶©e
 <
şass
 
	gT
, 
	gš¡ªû
>

401 
šlše
 
boŞ
 
	gİ”©Ü
==(cÚ¡ 
Cry±oPP
::
PŞynomŸlOv”FixedRšg
<
T
, 
	gš¡ªû
> &
	ga
, cÚ¡ 
	gCry±oPP
::PŞynomŸlOv”FixedRšg<T, in¡ªû> &
	gb
)

402 { 
	ga
.
Equ®s
(
b
, 
a
.
ms_fixedRšg
);}

404 
	g‹m¶©e
 <
şass
 
	gT
, 
	gš¡ªû
>

405 
šlše
 
boŞ
 
	gİ”©Ü
!=(cÚ¡ 
Cry±oPP
::
PŞynomŸlOv”FixedRšg
<
T
, 
	gš¡ªû
> &
	ga
, cÚ¡ 
	gCry±oPP
::PŞynomŸlOv”FixedRšg<T, in¡ªû> &
	gb
)

406 { !(
	ga
==
b
);}

409 
	g‹m¶©e
 <
şass
 
	gT
, 
	gš¡ªû
>

410 
šlše
 
boŞ
 
	gİ”©Ü
> (cÚ¡ 
	gCry±oPP
::
PŞynomŸlOv”FixedRšg
<
T
, 
	gš¡ªû
> &
	ga
, cÚ¡ Cry±oPP::PŞynomŸlOv”FixedRšg<T, in¡ªû> &
	gb
)

411 { 
	ga
.
Deg»e
(è> 
	gb
.Degree();}

413 
	g‹m¶©e
 <
şass
 
	gT
, 
	gš¡ªû
>

414 
šlše
 
boŞ
 
	gİ”©Ü
>=(cÚ¡ 
Cry±oPP
::
PŞynomŸlOv”FixedRšg
<
T
, 
	gš¡ªû
> &
	ga
, cÚ¡ 
	gCry±oPP
::PŞynomŸlOv”FixedRšg<T, in¡ªû> &
	gb
)

415 { 
	ga
.
Deg»e
(è>ğ
b
.Degree();}

417 
	g‹m¶©e
 <
şass
 
	gT
, 
	gš¡ªû
>

418 
šlše
 
boŞ
 
	gİ”©Ü
< (cÚ¡ 
	gCry±oPP
::
PŞynomŸlOv”FixedRšg
<
T
, 
	gš¡ªû
> &
	ga
, cÚ¡ Cry±oPP::PŞynomŸlOv”FixedRšg<T, in¡ªû> &
	gb
)

419 { 
	ga
.
Deg»e
(è< 
	gb
.Degree();}

421 
	g‹m¶©e
 <
şass
 
	gT
, 
	gš¡ªû
>

422 
šlše
 
boŞ
 
	gİ”©Ü
<=(cÚ¡ 
Cry±oPP
::
PŞynomŸlOv”FixedRšg
<
T
, 
	gš¡ªû
> &
	ga
, cÚ¡ 
	gCry±oPP
::PŞynomŸlOv”FixedRšg<T, in¡ªû> &
	gb
)

423 { 
	ga
.
Deg»e
(è<ğ
b
.Degree();}

426 
	g‹m¶©e
 <
şass
 
	gT
, 
	gš¡ªû
>

427 
šlše
 
	gCry±oPP
::
PŞynomŸlOv”FixedRšg
<
T
, 
	gš¡ªû
> 
	gİ”©Ü
+(cÚ¡ Cry±oPP::PŞynomŸlOv”FixedRšg<T, in¡ªû> &
	ga
, cÚ¡ Cry±oPP::PŞynomŸlOv”FixedRšg<T, in¡ªû> &
	gb
)

428 { 
	gCry±oPP
::
PŞynomŸlOv”FixedRšg
<
T
, 
	gš¡ªû
>(
	ga
.
Plus
(
b
, 
a
.
ms_fixedRšg
));}

430 
	g‹m¶©e
 <
şass
 
	gT
, 
	gš¡ªû
>

431 
šlše
 
	gCry±oPP
::
PŞynomŸlOv”FixedRšg
<
T
, 
	gš¡ªû
> 
	gİ”©Ü
-(cÚ¡ Cry±oPP::PŞynomŸlOv”FixedRšg<T, in¡ªû> &
	ga
, cÚ¡ Cry±oPP::PŞynomŸlOv”FixedRšg<T, in¡ªû> &
	gb
)

432 { 
	gCry±oPP
::
PŞynomŸlOv”FixedRšg
<
T
, 
	gš¡ªû
>(
	ga
.
Mšus
(
b
, 
a
.
ms_fixedRšg
));}

434 
	g‹m¶©e
 <
şass
 
	gT
, 
	gš¡ªû
>

435 
šlše
 
	gCry±oPP
::
PŞynomŸlOv”FixedRšg
<
T
, 
	gš¡ªû
> 
	gİ”©Ü
*(cÚ¡ Cry±oPP::PŞynomŸlOv”FixedRšg<T, in¡ªû> &
	ga
, cÚ¡ Cry±oPP::PŞynomŸlOv”FixedRšg<T, in¡ªû> &
	gb
)

436 { 
	gCry±oPP
::
PŞynomŸlOv”FixedRšg
<
T
, 
	gš¡ªû
>(
	ga
.
Times
(
b
, 
a
.
ms_fixedRšg
));}

438 
	g‹m¶©e
 <
şass
 
	gT
, 
	gš¡ªû
>

439 
šlše
 
	gCry±oPP
::
PŞynomŸlOv”FixedRšg
<
T
, 
	gš¡ªû
> 
	gİ”©Ü
/(cÚ¡ Cry±oPP::PŞynomŸlOv”FixedRšg<T, in¡ªû> &
	ga
, cÚ¡ Cry±oPP::PŞynomŸlOv”FixedRšg<T, in¡ªû> &
	gb
)

440 { 
	gCry±oPP
::
PŞynomŸlOv”FixedRšg
<
T
, 
	gš¡ªû
>(
	ga
.
DividedBy
(
b
, 
a
.
ms_fixedRšg
));}

442 
	g‹m¶©e
 <
şass
 
	gT
, 
	gš¡ªû
>

443 
šlše
 
	gCry±oPP
::
PŞynomŸlOv”FixedRšg
<
T
, 
	gš¡ªû
> 
	gİ”©Ü
%(cÚ¡ Cry±oPP::PŞynomŸlOv”FixedRšg<T, in¡ªû> &
	ga
, cÚ¡ Cry±oPP::PŞynomŸlOv”FixedRšg<T, in¡ªû> &
	gb
)

444 { 
	gCry±oPP
::
PŞynomŸlOv”FixedRšg
<
T
, 
	gš¡ªû
>(
	ga
.
Modulo
(
b
, 
a
.
ms_fixedRšg
));}

446 
NAMESPACE_END


448 
	$NAMESPACE_BEGIN
(
¡d
)

449 
‹m¶©e
<
şass
 
T
> 
šlše
 
	`sw­
(
Cry±oPP
::
PŞynomŸlOv”
<T> &
a
, Cry±oPP::PŞynomŸlOv”<T> &
b
)

451 
a
.
	`sw­
(
b
);

452 
	}
}

453 
	g‹m¶©e
<
şass
 
	gT
, 
	gi
> 
šlše
 
sw­
(
Cry±oPP
::
PŞynomŸlOv”FixedRšg
<
T
,
i
> &
a
, Cry±oPP::PŞynomŸlOv”FixedRšg<T,i> &
b
)

455 
	ga
.
sw­
(
b
);

457 
	gNAMESPACE_END


	@pssr.cpp

3 
	~"pch.h
"

4 
	~"ps¤.h
"

5 
	~<funùiÚ®
>

7 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

10 
‹m¶©e
<> cÚ¡ 
by‹
 
EMSA2HashId
<
RIPEMD160
>::
id
 = 0x31;

11 
‹m¶©e
<> cÚ¡ 
by‹
 
EMSA2HashId
<
RIPEMD128
>::
id
 = 0x32;

12 
‹m¶©e
<> cÚ¡ 
by‹
 
EMSA2HashId
<
WhœÍoŞ
>::
id
 = 0x37;

14 #iâdeà
CRYPTOPP_IMPORTS


16 
size_t
 
PSSR_MEM_Ba£
::
	$MšR•»£Á©iveB™L’gth
(
size_t
 
hashId’tif›rL’gth
, size_ˆ
dige¡L’gth
) const

18 
size_t
 
§ÉL’
 = 
	`S®tL’
(
dige¡L’gth
);

19 
size_t
 
mšPadL’
 = 
	`MšPadL’
(
dige¡L’gth
);

20  9 + 8*(
mšPadL’
 + 
§ÉL’
 + 
dige¡L’gth
 + 
hashId’tif›rL’gth
);

21 
	}
}

23 
size_t
 
	gPSSR_MEM_Ba£
::
	$MaxRecov”abËL’gth
(
size_t
 
»´e£Á©iveB™L’gth
, size_ˆ
hashId’tif›rL’gth
, size_ˆ
dige¡L’gth
) const

25 ià(
	`AÎowRecov”y
())

26  
	`S©u¿tšgSubŒaù
(
»´e£Á©iveB™L’gth
, 
	`MšR•»£Á©iveB™L’gth
(
hashId’tif›rL’gth
, 
dige¡L’gth
)) / 8;

28 
	}
}

30 
boŞ
 
	gPSSR_MEM_Ba£
::
	$IsProbabi¡ic
() const

32  
	`S®tL’
(1) > 0;

33 
	}
}

35 
boŞ
 
	gPSSR_MEM_Ba£
::
	$AÎowNÚ»cov”abËP¬t
() const

37  
Œue
;

38 
	}
}

40 
boŞ
 
	gPSSR_MEM_Ba£
::
	$Recov”abËP¬tFœ¡
() const

42  
çl£
;

43 
	}
}

45 
	gPSSR_MEM_Ba£
::
	$Compu‹Mes§geR•»£Á©ive
(
RªdomNumb”G’”©Ü
 &
ºg
,

46 cÚ¡ 
by‹
 *
»cov”abËMes§ge
, 
size_t
 
»cov”abËMes§geL’gth
,

47 
HashT¿nsfÜm©iÚ
 &
hash
, 
HashId’tif›r
 
hashId’tif›r
, 
boŞ
 
mes§geEm±y
,

48 
by‹
 *
»´e£Á©ive
, 
size_t
 
»´e£Á©iveB™L’gth
) const

50 
	`as£¹
(
»´e£Á©iveB™L’gth
 >ğ
	`MšR•»£Á©iveB™L’gth
(
hashId’tif›r
.
£cÚd
, 
hash
.
	`Dige¡Size
()));

52 cÚ¡ 
size_t
 
u
 = 
hashId’tif›r
.
£cÚd
 + 1;

53 cÚ¡ 
size_t
 
»´e£Á©iveBy‹L’gth
 = 
	`B™sToBy‹s
(
»´e£Á©iveB™L’gth
);

54 cÚ¡ 
size_t
 
dige¡Size
 = 
hash
.
	`Dige¡Size
();

55 cÚ¡ 
size_t
 
§ÉSize
 = 
	`S®tL’
(
dige¡Size
);

56 
by‹
 *cÚ¡ 
h
 = 
»´e£Á©ive
 + 
»´e£Á©iveBy‹L’gth
 - 
u
 - 
dige¡Size
;

58 
SecBy‹Block
 
	`dige¡
(
dige¡Size
), 
	`§É
(
§ÉSize
);

59 
hash
.
	`Fš®
(
dige¡
);

60 
ºg
.
	`G’”©eBlock
(
§É
, 
§ÉSize
);

63 
by‹
 
c
[8];

64 
	`PutWÜd
(
çl£
, 
BIG_ENDIAN_ORDER
, 
c
, (
wÜd32
)
SaãRightShiá
<29>(
»cov”abËMes§geL’gth
));

65 
	`PutWÜd
(
çl£
, 
BIG_ENDIAN_ORDER
, 
c
+4, 
	`wÜd32
(
»cov”abËMes§geL’gth
 << 3));

66 
hash
.
	`Upd©e
(
c
, 8);

67 
hash
.
	`Upd©e
(
»cov”abËMes§ge
, 
»cov”abËMes§geL’gth
);

68 
hash
.
	`Upd©e
(
dige¡
, 
dige¡Size
);

69 
hash
.
	`Upd©e
(
§É
, 
§ÉSize
);

70 
hash
.
	`Fš®
(
h
);

73 
	`G‘MGF
().
	`G’”©eAndMask
(
hash
, 
»´e£Á©ive
, 
»´e£Á©iveBy‹L’gth
 - 
u
 - 
dige¡Size
, 
h
, dige¡Size, 
çl£
);

74 
by‹
 *
xÜS¹
 = 
»´e£Á©ive
 + 
»´e£Á©iveBy‹L’gth
 - 
u
 - 
dige¡Size
 - 
§É
.
	`size
(è- 
»cov”abËMes§geL’gth
 - 1;

75 
xÜS¹
[0] ^= 1;

76 
	`xÜbuf
(
xÜS¹
 + 1, 
»cov”abËMes§ge
, 
»cov”abËMes§geL’gth
);

77 
	`xÜbuf
(
xÜS¹
 + 1 + 
»cov”abËMes§geL’gth
, 
§É
, s®t.
	`size
());

78 
	`memıy
(
»´e£Á©ive
 + 
»´e£Á©iveBy‹L’gth
 - 
u
, 
hashId’tif›r
.
fœ¡
, hashId’tif›r.
£cÚd
);

79 
»´e£Á©ive
[
»´e£Á©iveBy‹L’gth
 - 1] = 
hashId’tif›r
.
£cÚd
 ? 0xcc : 0xbc;

80 ià(
»´e£Á©iveB™L’gth
 % 8 != 0)

81 
»´e£Á©ive
[0] = (
by‹
)
	`Crİ
Ô•»£Á©ive[0], 
»´e£Á©iveB™L’gth
 % 8);

82 
	}
}

84 
DecodšgResuÉ
 
	gPSSR_MEM_Ba£
::
	$Recov”Mes§geFromR•»£Á©ive
(

85 
HashT¿nsfÜm©iÚ
 &
hash
, 
HashId’tif›r
 
hashId’tif›r
, 
boŞ
 
mes§geEm±y
,

86 
by‹
 *
»´e£Á©ive
, 
size_t
 
»´e£Á©iveB™L’gth
,

87 
by‹
 *
»cov”abËMes§ge
) const

89 
	`as£¹
(
»´e£Á©iveB™L’gth
 >ğ
	`MšR•»£Á©iveB™L’gth
(
hashId’tif›r
.
£cÚd
, 
hash
.
	`Dige¡Size
()));

91 cÚ¡ 
size_t
 
u
 = 
hashId’tif›r
.
£cÚd
 + 1;

92 cÚ¡ 
size_t
 
»´e£Á©iveBy‹L’gth
 = 
	`B™sToBy‹s
(
»´e£Á©iveB™L’gth
);

93 cÚ¡ 
size_t
 
dige¡Size
 = 
hash
.
	`Dige¡Size
();

94 cÚ¡ 
size_t
 
§ÉSize
 = 
	`S®tL’
(
dige¡Size
);

95 cÚ¡ 
by‹
 *cÚ¡ 
h
 = 
»´e£Á©ive
 + 
»´e£Á©iveBy‹L’gth
 - 
u
 - 
dige¡Size
;

97 
SecBy‹Block
 
	`dige¡
(
dige¡Size
);

98 
hash
.
	`Fš®
(
dige¡
);

100 
DecodšgResuÉ
 
	`»suÉ
(0);

101 
boŞ
 &
v®id
 = 
»suÉ
.
isV®idCodšg
;

102 
size_t
 &
»cov”abËMes§geL’gth
 = 
»suÉ
.
mes§geL’gth
;

104 
v®id
 = (
»´e£Á©ive
[
»´e£Á©iveBy‹L’gth
 - 1] =ğ(
hashId’tif›r
.
£cÚd
 ? 0xcc : 0xbc)) && valid;

105 
v®id
 = 
	`V”ifyBufsEqu®
(
»´e£Á©ive
 + 
»´e£Á©iveBy‹L’gth
 - 
u
, 
hashId’tif›r
.
fœ¡
, hashId’tif›r.
£cÚd
) && valid;

107 
	`G‘MGF
().
	`G’”©eAndMask
(
hash
, 
»´e£Á©ive
, 
»´e£Á©iveBy‹L’gth
 - 
u
 - 
dige¡Size
, 
h
, digestSize);

108 ià(
»´e£Á©iveB™L’gth
 % 8 != 0)

109 
»´e£Á©ive
[0] = (
by‹
)
	`Crİ
Ô•»£Á©ive[0], 
»´e£Á©iveB™L’gth
 % 8);

112 
by‹
 *
§É
 = 
»´e£Á©ive
 + 
»´e£Á©iveBy‹L’gth
 - 
u
 - 
dige¡Size
 - 
§ÉSize
;

113 
by‹
 *
M
 = 
¡d
::
	`fšd_if
(
»´e£Á©ive
, 
§É
-1, std::
	`bšd2nd
(¡d::
nÙ_equ®_to
<byte>(), 0));

114 
»cov”abËMes§geL’gth
 = 
§É
-
M
-1;

115 ià(*
M
 == 0x01

116 && (
size_t
)(
M
 - 
»´e£Á©ive
 - (
»´e£Á©iveB™L’gth
 % 8 !ğ0)è>ğ
	`MšPadL’
(
dige¡Size
)

117 && 
»cov”abËMes§geL’gth
 <ğ
	`MaxRecov”abËL’gth
(
»´e£Á©iveB™L’gth
, 
hashId’tif›r
.
£cÚd
, 
dige¡Size
))

119 
	`memıy
(
»cov”abËMes§ge
, 
M
+1, 
»cov”abËMes§geL’gth
);

123 
»cov”abËMes§geL’gth
 = 0;

124 
v®id
 = 
çl£
;

128 
by‹
 
c
[8];

129 
	`PutWÜd
(
çl£
, 
BIG_ENDIAN_ORDER
, 
c
, (
wÜd32
)
SaãRightShiá
<29>(
»cov”abËMes§geL’gth
));

130 
	`PutWÜd
(
çl£
, 
BIG_ENDIAN_ORDER
, 
c
+4, 
	`wÜd32
(
»cov”abËMes§geL’gth
 << 3));

131 
hash
.
	`Upd©e
(
c
, 8);

132 
hash
.
	`Upd©e
(
»cov”abËMes§ge
, 
»cov”abËMes§geL’gth
);

133 
hash
.
	`Upd©e
(
dige¡
, 
dige¡Size
);

134 
hash
.
	`Upd©e
(
§É
, 
§ÉSize
);

135 
v®id
 = 
hash
.
	`V”ify
(
h
) && valid;

137 ià(!
	`AÎowRecov”y
(è&& 
v®id
 && 
»cov”abËMes§geL’gth
 != 0)

138 {
throw
 
	`NÙIm¶em’‹d
("PSSR_MEM: message„ecovery disabled");}

140  
»suÉ
;

141 
	}
}

145 
	gNAMESPACE_END


	@pssr.h

1 #iâdeà
CRYPTOPP_PSSR_H


2 
	#CRYPTOPP_PSSR_H


	)

4 
	~"pubkey.h
"

5 
	~"em§2.h
"

7 #ifdeà
CRYPTOPP_IS_DLL


8 
	~"sha.h
"

11 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

13 şas 
	cCRYPTOPP_DLL
 
PSSR_MEM_Ba£
 : 
public
 
PK_Recov”abËSigÇtu»Mes§geEncodšgM‘hod


15 
vœtu®
 
boŞ
 
	$AÎowRecov”y
() const =0;

16 
vœtu®
 
size_t
 
	$S®tL’
(
size_t
 
hashL’
) const =0;

17 
vœtu®
 
size_t
 
	$MšPadL’
(
size_t
 
hashL’
) const =0;

18 
vœtu®
 cÚ¡ 
MaskG’”©šgFunùiÚ
 & 
	$G‘MGF
() const =0;

20 
public
:

21 
size_t
 
	$MšR•»£Á©iveB™L’gth
(
size_t
 
hashId’tif›rL’gth
, size_ˆ
dige¡L’gth
) const;

22 
size_t
 
	$MaxRecov”abËL’gth
(
size_t
 
»´e£Á©iveB™L’gth
, size_ˆ
hashId’tif›rL’gth
, size_ˆ
dige¡L’gth
) const;

23 
boŞ
 
	$IsProbabi¡ic
() const;

24 
boŞ
 
	$AÎowNÚ»cov”abËP¬t
() const;

25 
boŞ
 
	$Recov”abËP¬tFœ¡
() const;

26 
	$Compu‹Mes§geR•»£Á©ive
(
RªdomNumb”G’”©Ü
 &
ºg
,

27 cÚ¡ 
by‹
 *
»cov”abËMes§ge
, 
size_t
 
»cov”abËMes§geL’gth
,

28 
HashT¿nsfÜm©iÚ
 &
hash
, 
HashId’tif›r
 
hashId’tif›r
, 
boŞ
 
mes§geEm±y
,

29 
by‹
 *
»´e£Á©ive
, 
size_t
 
»´e£Á©iveB™L’gth
) const;

30 
DecodšgResuÉ
 
	$Recov”Mes§geFromR•»£Á©ive
(

31 
HashT¿nsfÜm©iÚ
 &
hash
, 
HashId’tif›r
 
hashId’tif›r
, 
boŞ
 
mes§geEm±y
,

32 
by‹
 *
»´e£Á©ive
, 
size_t
 
»´e£Á©iveB™L’gth
,

33 
by‹
 *
»cov”abËMes§ge
) const;

36 
‹m¶©e
 <
boŞ
 
USE_HASH_ID
> 
şass
 
PSSR_MEM_Ba£W™hHashId
;

37 
‹m¶©e
<> 
şass
 
PSSR_MEM_Ba£W™hHashId
<
Œue
> : 
public
 
EMSA2HashIdLookup
<
PSSR_MEM_Ba£
> {
	}
};

38 
	g‹m¶©e
<> 
şass
 
	gPSSR_MEM_Ba£W™hHashId
<
	gçl£
> : 
public
 
PSSR_MEM_Ba£
 {};

40 
	g‹m¶©e
 <
boŞ
 
	gALLOW_RECOVERY
, 
şass
 
	gMGF
=
P1363_MGF1
, 
	gSALT_LEN
=-1, 
	gMIN_PAD_LEN
=0, boŞ 
	gUSE_HASH_ID
=
çl£
>

41 
şass
 
PSSR_MEM
 : 
public
 
PSSR_MEM_Ba£W™hHashId
<
USE_HASH_ID
>

43 
vœtu®
 
boŞ
 
AÎowRecov”y
(ècÚ¡ { 
ALLOW_RECOVERY
;}

44 
vœtu®
 
size_t
 
S®tL’
(size_ˆ
hashL’
ècÚ¡ { 
	gSALT_LEN
 < 0 ? 
	ghashL’
 : 
SALT_LEN
;}

45 
vœtu®
 
size_t
 
MšPadL’
(size_ˆ
hashL’
ècÚ¡ { 
	gMIN_PAD_LEN
 < 0 ? 
	ghashL’
 : 
MIN_PAD_LEN
;}

46 
vœtu®
 cÚ¡ 
	gMaskG’”©šgFunùiÚ
 & 
G‘MGF
(ècÚ¡ {
MGF
 
	gmgf
;  mgf;}

48 
	gpublic
:

49 
¡d
::
¡ršg
 
CRYPTOPP_API
 
SticAlgÜ™hmName
(è{ std::¡ršg(
ALLOW_RECOVERY
 ? "PSSR-" : "PSS-"è+ 
MGF
::StaticAlgorithmName();}

53 
	gPSSR
 : 
public
 
SigÇtu»Snd¬d


55 
PSSR_MEM
<
	tŒue
> 
	tSigÇtu»Mes§geEncodšgM‘hod
;

59 
	gPSS
 : 
public
 
SigÇtu»Snd¬d


61 
PSSR_MEM
<
	tçl£
> 
	tSigÇtu»Mes§geEncodšgM‘hod
;

64 
	gNAMESPACE_END


	@pubkey.cpp

3 
	~"pch.h
"

5 #iâdeà
CRYPTOPP_IMPORTS


7 
	~"pubkey.h
"

9 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

11 
	$P1363_MGF1KDF2_CommÚ
(
HashT¿nsfÜm©iÚ
 &
hash
, 
by‹
 *
ouut
, 
size_t
 
ouutL’gth
, cÚ¡ by‹ *
šput
, size_ˆ
šputL’gth
, cÚ¡ by‹ *
d”iv©iÚP¬ams
, size_ˆ
d”iv©iÚP¬amsL’gth
, 
boŞ
 
mask
, 
couÁ”S¹
)

13 
A¼aySšk
 *
sšk
;

14 
HashF‹r
 
	`f‹r
(
hash
, 
sšk
 = 
mask
 ? 
Ãw
 
	`A¼ayXÜSšk
(
ouut
, 
ouutL’gth
è:‚ew 
	`A¼aySšk
(output, outputLength));

15 
wÜd32
 
couÁ”
 = 
couÁ”S¹
;

16 
sšk
->
	`AvaabËSize
() > 0)

18 
f‹r
.
	`Put
(
šput
, 
šputL’gth
);

19 
f‹r
.
	`PutWÜd32
(
couÁ”
++);

20 
f‹r
.
	`Put
(
d”iv©iÚP¬ams
, 
d”iv©iÚP¬amsL’gth
);

21 
f‹r
.
	`Mes§geEnd
();

23 
	}
}

25 
boŞ
 
	gPK_D‘”mši¡icSigÇtu»Mes§geEncodšgM‘hod
::
	$V”ifyMes§geR•»£Á©ive
(

26 
HashT¿nsfÜm©iÚ
 &
hash
, 
HashId’tif›r
 
hashId’tif›r
, 
boŞ
 
mes§geEm±y
,

27 
by‹
 *
»´e£Á©ive
, 
size_t
 
»´e£Á©iveB™L’gth
) const

29 
SecBy‹Block
 
	`compu‹dR•»£Á©ive
(
	`B™sToBy‹s
(
»´e£Á©iveB™L’gth
));

30 
	`Compu‹Mes§geR•»£Á©ive
(
	`NuÎRNG
(), 
NULL
, 0, 
hash
, 
hashId’tif›r
, 
mes§geEm±y
, 
compu‹dR•»£Á©ive
, 
»´e£Á©iveB™L’gth
);

31  
	`V”ifyBufsEqu®
(
»´e£Á©ive
, 
compu‹dR•»£Á©ive
, compu‹dR•»£Á©ive.
	`size
());

32 
	}
}

34 
boŞ
 
	gPK_Recov”abËSigÇtu»Mes§geEncodšgM‘hod
::
	$V”ifyMes§geR•»£Á©ive
(

35 
HashT¿nsfÜm©iÚ
 &
hash
, 
HashId’tif›r
 
hashId’tif›r
, 
boŞ
 
mes§geEm±y
,

36 
by‹
 *
»´e£Á©ive
, 
size_t
 
»´e£Á©iveB™L’gth
) const

38 
SecBy‹Block
 
	`»cov”edMes§ge
(
	`MaxRecov”abËL’gth
(
»´e£Á©iveB™L’gth
, 
hashId’tif›r
.
£cÚd
, 
hash
.
	`Dige¡Size
()));

39 
DecodšgResuÉ
 
»suÉ
 = 
	`Recov”Mes§geFromR•»£Á©ive
(

40 
hash
, 
hashId’tif›r
, 
mes§geEm±y
, 
»´e£Á©ive
, 
»´e£Á©iveB™L’gth
, 
»cov”edMes§ge
);

41  
»suÉ
.
isV®idCodšg
 &&„esuÉ.
mes§geL’gth
 == 0;

42 
	}
}

44 
	gTF_SigÃrBa£
::
	$IÅutRecov”abËMes§ge
(
PK_Mes§geAccumuÏtÜ
 &
mes§geAccumuÏtÜ
, cÚ¡ 
by‹
 *
»cov”abËMes§ge
, 
size_t
 
»cov”abËMes§geL’gth
) const

46 
PK_Mes§geAccumuÏtÜBa£
 &
ma
 = 
¡©ic_ÿ¡
<PK_Mes§geAccumuÏtÜBa£ &>(
mes§geAccumuÏtÜ
);

47 
HashId’tif›r
 
id
 = 
	`G‘HashId’tif›r
();

48 cÚ¡ 
Mes§geEncodšgIÁ”çû
 &
’codšg
 = 
	`G‘Mes§geEncodšgIÁ”çû
();

50 ià(
	`Mes§geR•»£Á©iveB™L’gth
(è< 
’codšg
.
	`MšR•»£Á©iveB™L’gth
(
id
.
£cÚd
, 
ma
.
	`AcûssHash
().
	`Dige¡Size
()))

51 
throw
 
PK_SigÇtu»Scheme
::
	`KeyTooShÜt
();

53 
size_t
 
maxRecov”abËL’gth
 = 
’codšg
.
	`MaxRecov”abËL’gth
(
	`Mes§geR•»£Á©iveB™L’gth
(), 
	`G‘HashId’tif›r
().
£cÚd
, 
ma
.
	`AcûssHash
().
	`Dige¡Size
());

55 ià(
maxRecov”abËL’gth
 == 0)

56 {
throw
 
	`NÙIm¶em’‹d
("TF_SignerBase:his‡lgorithm does‚ot support messsage„ecovery orhe key isoo short");}

57 ià(
»cov”abËMes§geL’gth
 > 
maxRecov”abËL’gth
)

58 
throw
 
	`Inv®idArgum’t
("TF_SignerBase:he„ecoverable message…art isoo†ong forhe given key‡nd‡lgorithm");

60 
ma
.
m_»cov”abËMes§ge
.
	`Assign
(
»cov”abËMes§ge
, 
»cov”abËMes§geL’gth
);

61 
’codšg
.
	`ProûssRecov”abËMes§ge
(

62 
ma
.
	`AcûssHash
(),

63 
»cov”abËMes§ge
, 
»cov”abËMes§geL’gth
,

64 
NULL
, 0, 
ma
.
m_£misigÇtu»
);

65 
	}
}

67 
size_t
 
	gTF_SigÃrBa£
::
	$SignAndRe¡¬t
(
RªdomNumb”G’”©Ü
 &
ºg
, 
PK_Mes§geAccumuÏtÜ
 &
mes§geAccumuÏtÜ
, 
by‹
 *
sigÇtu»
, 
boŞ
 
»¡¬t
) const

69 
PK_Mes§geAccumuÏtÜBa£
 &
ma
 = 
¡©ic_ÿ¡
<PK_Mes§geAccumuÏtÜBa£ &>(
mes§geAccumuÏtÜ
);

70 
HashId’tif›r
 
id
 = 
	`G‘HashId’tif›r
();

71 cÚ¡ 
Mes§geEncodšgIÁ”çû
 &
’codšg
 = 
	`G‘Mes§geEncodšgIÁ”çû
();

73 ià(
	`Mes§geR•»£Á©iveB™L’gth
(è< 
’codšg
.
	`MšR•»£Á©iveB™L’gth
(
id
.
£cÚd
, 
ma
.
	`AcûssHash
().
	`Dige¡Size
()))

74 
throw
 
PK_SigÇtu»Scheme
::
	`KeyTooShÜt
();

76 
SecBy‹Block
 
	`»´e£Á©ive
(
	`Mes§geR•»£Á©iveL’gth
());

77 
’codšg
.
	`Compu‹Mes§geR•»£Á©ive
(
ºg
,

78 
ma
.
m_»cov”abËMes§ge
, ma.m_»cov”abËMes§ge.
	`size
(),

79 
ma
.
	`AcûssHash
(), 
id
, ma.
m_em±y
,

80 
»´e£Á©ive
, 
	`Mes§geR•»£Á©iveB™L’gth
());

81 
ma
.
m_em±y
 = 
Œue
;

83 
IÁeg”
 
	`r
(
»´e£Á©ive
,„•»£Á©ive.
	`size
());

84 
size_t
 
sigÇtu»L’gth
 = 
	`SigÇtu»L’gth
();

85 
	`G‘T¿pdoÜFunùiÚIÁ”çû
().
	`C®cuÏ‹RªdomizedInv”£
(
ºg
, 
r
).
	`Encode
(
sigÇtu»
, 
sigÇtu»L’gth
);

86  
sigÇtu»L’gth
;

87 
	}
}

89 
	gTF_V”if›rBa£
::
	$IÅutSigÇtu»
(
PK_Mes§geAccumuÏtÜ
 &
mes§geAccumuÏtÜ
, cÚ¡ 
by‹
 *
sigÇtu»
, 
size_t
 
sigÇtu»L’gth
) const

91 
PK_Mes§geAccumuÏtÜBa£
 &
ma
 = 
¡©ic_ÿ¡
<PK_Mes§geAccumuÏtÜBa£ &>(
mes§geAccumuÏtÜ
);

92 
HashId’tif›r
 
id
 = 
	`G‘HashId’tif›r
();

93 cÚ¡ 
Mes§geEncodšgIÁ”çû
 &
’codšg
 = 
	`G‘Mes§geEncodšgIÁ”çû
();

95 ià(
	`Mes§geR•»£Á©iveB™L’gth
(è< 
’codšg
.
	`MšR•»£Á©iveB™L’gth
(
id
.
£cÚd
, 
ma
.
	`AcûssHash
().
	`Dige¡Size
()))

96 
throw
 
PK_SigÇtu»Scheme
::
	`KeyTooShÜt
();

98 
ma
.
m_»´e£Á©ive
.
	`New
(
	`Mes§geR•»£Á©iveL’gth
());

99 
IÁeg”
 
x
 = 
	`G‘T¿pdoÜFunùiÚIÁ”çû
().
	`AµlyFunùiÚ
(
	`IÁeg”
(
sigÇtu»
, 
sigÇtu»L’gth
));

100 ià(
x
.
	`B™CouÁ
(è> 
	`Mes§geR•»£Á©iveB™L’gth
())

101 
x
 = 
IÁeg”
::
	`Z”o
();

102 
x
.
	`Encode
(
ma
.
m_»´e£Á©ive
, ma.m_»´e£Á©ive.
	`size
());

103 
	}
}

105 
boŞ
 
	gTF_V”if›rBa£
::
	$V”ifyAndRe¡¬t
(
PK_Mes§geAccumuÏtÜ
 &
mes§geAccumuÏtÜ
) const

107 
PK_Mes§geAccumuÏtÜBa£
 &
ma
 = 
¡©ic_ÿ¡
<PK_Mes§geAccumuÏtÜBa£ &>(
mes§geAccumuÏtÜ
);

108 
HashId’tif›r
 
id
 = 
	`G‘HashId’tif›r
();

109 cÚ¡ 
Mes§geEncodšgIÁ”çû
 &
’codšg
 = 
	`G‘Mes§geEncodšgIÁ”çû
();

111 ià(
	`Mes§geR•»£Á©iveB™L’gth
(è< 
’codšg
.
	`MšR•»£Á©iveB™L’gth
(
id
.
£cÚd
, 
ma
.
	`AcûssHash
().
	`Dige¡Size
()))

112 
throw
 
PK_SigÇtu»Scheme
::
	`KeyTooShÜt
();

114 
boŞ
 
»suÉ
 = 
’codšg
.
	`V”ifyMes§geR•»£Á©ive
(

115 
ma
.
	`AcûssHash
(), 
id
, ma.
m_em±y
, ma.
m_»´e£Á©ive
, 
	`Mes§geR•»£Á©iveB™L’gth
());

116 
ma
.
m_em±y
 = 
Œue
;

117  
»suÉ
;

118 
	}
}

120 
DecodšgResuÉ
 
	gTF_V”if›rBa£
::
	$Recov”AndRe¡¬t
(
by‹
 *
»cov”edMes§ge
, 
PK_Mes§geAccumuÏtÜ
 &
mes§geAccumuÏtÜ
) const

122 
PK_Mes§geAccumuÏtÜBa£
 &
ma
 = 
¡©ic_ÿ¡
<PK_Mes§geAccumuÏtÜBa£ &>(
mes§geAccumuÏtÜ
);

123 
HashId’tif›r
 
id
 = 
	`G‘HashId’tif›r
();

124 cÚ¡ 
Mes§geEncodšgIÁ”çû
 &
’codšg
 = 
	`G‘Mes§geEncodšgIÁ”çû
();

126 ià(
	`Mes§geR•»£Á©iveB™L’gth
(è< 
’codšg
.
	`MšR•»£Á©iveB™L’gth
(
id
.
£cÚd
, 
ma
.
	`AcûssHash
().
	`Dige¡Size
()))

127 
throw
 
PK_SigÇtu»Scheme
::
	`KeyTooShÜt
();

129 
DecodšgResuÉ
 
»suÉ
 = 
’codšg
.
	`Recov”Mes§geFromR•»£Á©ive
(

130 
ma
.
	`AcûssHash
(), 
id
, ma.
m_em±y
, ma.
m_»´e£Á©ive
, 
	`Mes§geR•»£Á©iveB™L’gth
(), 
»cov”edMes§ge
);

131 
ma
.
m_em±y
 = 
Œue
;

132  
»suÉ
;

133 
	}
}

135 
DecodšgResuÉ
 
	gTF_Deüy±ÜBa£
::
	$Deüy±
(
RªdomNumb”G’”©Ü
 &
ºg
, cÚ¡ 
by‹
 *
ch”‹xt
, 
size_t
 
ch”‹xtL’gth
, by‹ *
¶aš‹xt
, cÚ¡ 
NameV®uePaœs
 &
·¿m‘”s
) const

137 ià(
ch”‹xtL’gth
 !ğ
	`FixedCh”‹xtL’gth
())

138 
throw
 
	`Inv®idArgum’t
(
	`AlgÜ™hmName
(è+ ": ch”‹xˆËngth oà" + 
	`IÁToSŒšg
(
ch”‹xtL’gth
è+ " dÛ¢'ˆm©chh»quœed†’gth oà" + IÁToSŒšg(
	`FixedCh”‹xtL’gth
()) + " forhis key");

140 
SecBy‹Block
 
	`·ddedBlock
(
	`PaddedBlockBy‹L’gth
());

141 
IÁeg”
 
x
 = 
	`G‘T¿pdoÜFunùiÚIÁ”çû
().
	`C®cuÏ‹Inv”£
(
ºg
, 
	`IÁeg”
(
ch”‹xt
, 
ch”‹xtL’gth
));

142 ià(
x
.
	`By‹CouÁ
(è> 
·ddedBlock
.
	`size
())

143 
x
 = 
IÁeg”
::
	`Z”o
();

144 
x
.
	`Encode
(
·ddedBlock
,…addedBlock.
	`size
());

145  
	`G‘Mes§geEncodšgIÁ”çû
().
	`UÅad
(
·ddedBlock
, 
	`PaddedBlockB™L’gth
(), 
¶aš‹xt
, 
·¿m‘”s
);

146 
	}
}

148 
	gTF_Enüy±ÜBa£
::
	$Enüy±
(
RªdomNumb”G’”©Ü
 &
ºg
, cÚ¡ 
by‹
 *
¶aš‹xt
, 
size_t
 
¶aš‹xtL’gth
, by‹ *
ch”‹xt
, cÚ¡ 
NameV®uePaœs
 &
·¿m‘”s
) const

150 ià(
¶aš‹xtL’gth
 > 
	`FixedMaxPÏš‹xtL’gth
())

152 ià(
	`FixedMaxPÏš‹xtL’gth
() < 1)

153 
throw
 
	`Inv®idArgum’t
(
	`AlgÜ™hmName
() + ":his key isoo shortoƒncrypt‡ny messages");

155 
throw
 
	`Inv®idArgum’t
(
	`AlgÜ™hmName
(è+ ": mes§gËngth oà" + 
	`IÁToSŒšg
(
¶aš‹xtL’gth
è+ "ƒxûed thmaximum oà" + IÁToSŒšg(
	`FixedMaxPÏš‹xtL’gth
()) + " forhis…ublic key");

158 
SecBy‹Block
 
	`·ddedBlock
(
	`PaddedBlockBy‹L’gth
());

159 
	`G‘Mes§geEncodšgIÁ”çû
().
	`Pad
(
ºg
, 
¶aš‹xt
, 
¶aš‹xtL’gth
, 
·ddedBlock
, 
	`PaddedBlockB™L’gth
(), 
·¿m‘”s
);

160 
	`G‘T¿pdoÜFunùiÚIÁ”çû
().
	`AµlyRªdomizedFunùiÚ
(
ºg
, 
	`IÁeg”
(
·ddedBlock
,…addedBlock.
	`size
())).
	`Encode
(
ch”‹xt
, 
	`FixedCh”‹xtL’gth
());

161 
	}
}

163 
	gNAMESPACE_END


	@pubkey.h

3 #iâdeà
CRYPTOPP_PUBKEY_H


4 
	#CRYPTOPP_PUBKEY_H


	)

35 
	~"mod¬™h.h
"

36 
	~"f‹rs.h
"

37 
	~"•»comp.h
"

38 
	~"fs140.h
"

39 
	~"¬gÇmes.h
"

40 
	~<memÜy
>

43 #undeà
INTERFACE


45 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

48 şas 
	cCRYPTOPP_DLL
 
CRYPTOPP_NO_VTABLE
 
T¿pdoÜFunùiÚBounds


50 
public
:

51 
vœtu®
 ~
	$T¿pdoÜFunùiÚBounds
() {}

53 
vœtu®
 
IÁeg”
 
	$P»imageBound
() const =0;

54 
vœtu®
 
IÁeg”
 
	$ImageBound
() const =0;

55 
vœtu®
 
IÁeg”
 
	$MaxP»image
(ècÚ¡ { --
	`P»imageBound
();
	}
}

56 
vœtu®
 
IÁeg”
 
	$MaxImage
(ècÚ¡ { --
	`ImageBound
();
	}
}

60 şas 
	cCRYPTOPP_DLL
 
CRYPTOPP_NO_VTABLE
 
	mRªdomizedT¿pdoÜFunùiÚ
 : 
public
 
T¿pdoÜFunùiÚBounds


62 
public
:

63 
vœtu®
 
IÁeg”
 
	$AµlyRªdomizedFunùiÚ
(
RªdomNumb”G’”©Ü
 &
ºg
, cÚ¡ 
IÁeg”
 &
x
) const =0;

64 
vœtu®
 
boŞ
 
	$IsRªdomized
(ècÚ¡ { 
Œue
;}

65 
	}
};

68 şas 
	cCRYPTOPP_DLL
 
CRYPTOPP_NO_VTABLE
 
	mT¿pdoÜFunùiÚ
 : 
public
 
RªdomizedT¿pdoÜFunùiÚ


70 
public
:

71 
IÁeg”
 
	$AµlyRªdomizedFunùiÚ
(
RªdomNumb”G’”©Ü
 &
ºg
, cÚ¡ 
IÁeg”
 &
x
) const

72 { 
	`AµlyFunùiÚ
(
x
);}

73 
boŞ
 
	$IsRªdomized
(ècÚ¡ { 
çl£
;
	}
}

75 
vœtu®
 
IÁeg”
 
	$AµlyFunùiÚ
(cÚ¡ 
IÁeg”
 &
x
) const =0;

76 
	}
};

79 şas 
	cCRYPTOPP_DLL
 
CRYPTOPP_NO_VTABLE
 
	mRªdomizedT¿pdoÜFunùiÚInv”£


81 
	mpublic
:

82 
vœtu®
 ~
	$RªdomizedT¿pdoÜFunùiÚInv”£
() {}

84 
vœtu®
 
IÁeg”
 
	$C®cuÏ‹RªdomizedInv”£
(
RªdomNumb”G’”©Ü
 &
ºg
, cÚ¡ 
IÁeg”
 &
x
) const =0;

85 
vœtu®
 
boŞ
 
	$IsRªdomized
(ècÚ¡ { 
Œue
;
	}
}

89 şas 
	cCRYPTOPP_DLL
 
CRYPTOPP_NO_VTABLE
 
	mT¿pdoÜFunùiÚInv”£
 : 
public
 
RªdomizedT¿pdoÜFunùiÚInv”£


91 
public
:

92 
vœtu®
 ~
	$T¿pdoÜFunùiÚInv”£
() {}

94 
IÁeg”
 
	$C®cuÏ‹RªdomizedInv”£
(
RªdomNumb”G’”©Ü
 &
ºg
, cÚ¡ 
IÁeg”
 &
x
) const

95 { 
	`C®cuÏ‹Inv”£
(
ºg
, 
x
);
	}
}

96 
boŞ
 
	$IsRªdomized
(ècÚ¡ { 
çl£
;
	}
}

98 
vœtu®
 
IÁeg”
 
	$C®cuÏ‹Inv”£
(
RªdomNumb”G’”©Ü
 &
ºg
, cÚ¡ 
IÁeg”
 &
x
) const =0;

99 
	}
};

104 şas 
	cCRYPTOPP_NO_VTABLE
 
	mPK_Enüy±iÚMes§geEncodšgM‘hod


106 
	mpublic
:

107 
vœtu®
 ~
	$PK_Enüy±iÚMes§geEncodšgM‘hod
() {}

109 
vœtu®
 
boŞ
 
	$P¬am‘”SuµÜ‹d
(cÚ¡ *
Çme
ècÚ¡ { 
çl£
;
	}
}

112 
vœtu®
 
size_t
 
	$MaxUÅaddedL’gth
(
size_t
 
·ddedL’gth
) const =0;

114 
vœtu®
 
	$Pad
(
RªdomNumb”G’”©Ü
 &
ºg
, cÚ¡ 
by‹
 *
¿w
, 
size_t
 
šputL’gth
, by‹ *
·dded
, size_ˆ
·ddedB™L’gth
, cÚ¡ 
NameV®uePaœs
 &
·¿m‘”s
) const =0;

116 
vœtu®
 
DecodšgResuÉ
 
	$UÅad
(cÚ¡ 
by‹
 *
·dded
, 
size_t
 
·ddedB™L’gth
, by‹ *
¿w
, cÚ¡ 
NameV®uePaœs
 &
·¿m‘”s
) const =0;

117 
	}
};

122 
	g‹m¶©e
 <
şass
 
	gTFI
, cÏs 
	gMEI
>

123 şas 
	cCRYPTOPP_NO_VTABLE
 
	mTF_Ba£


125 
	m´Ùeùed
:

126 
vœtu®
 cÚ¡ 
T¿pdoÜFunùiÚBounds
 & 
	$G‘T¿pdoÜFunùiÚBounds
() const =0;

128 
TFI
 
	tT¿pdoÜFunùiÚIÁ”çû
;

129 
vœtu®
 cÚ¡ 
T¿pdoÜFunùiÚIÁ”çû
 & 
	$G‘T¿pdoÜFunùiÚIÁ”çû
() const =0;

131 
MEI
 
	tMes§geEncodšgIÁ”çû
;

132 
vœtu®
 cÚ¡ 
Mes§geEncodšgIÁ”çû
 & 
	$G‘Mes§geEncodšgIÁ”çû
() const =0;

138 
‹m¶©e
 <
şass
 
BASE
>

139 şas 
	cCRYPTOPP_NO_VTABLE
 
PK_FixedL’gthCry±oSy¡emIm¶
 : 
public
 
BASE


141 
public
:

142 
size_t
 
	$MaxPÏš‹xtL’gth
(
size_t
 
ch”‹xtL’gth
) const

143 { 
ch”‹xtL’gth
 =ğ
	`FixedCh”‹xtL’gth
(è? 
	`FixedMaxPÏš‹xtL’gth
() : 0;}

144 
size_t
 
	$Ch”‹xtL’gth
(
size_t
 
¶aš‹xtL’gth
) const

145 { 
¶aš‹xtL’gth
 <ğ
	`FixedMaxPÏš‹xtL’gth
(è? 
	`FixedCh”‹xtL’gth
(è: 0;
	}
}

147 
vœtu®
 
size_t
 
	$FixedMaxPÏš‹xtL’gth
() const =0;

148 
vœtu®
 
size_t
 
	$FixedCh”‹xtL’gth
() const =0;

149 
	}
};

152 
	g‹m¶©e
 <
şass
 
	gINTERFACE
, cÏs 
	gBASE
>

153 
şass
 
CRYPTOPP_NO_VTABLE
 
	gTF_Cry±oSy¡emBa£
 : 
public
 
PK_FixedL’gthCry±oSy¡emIm¶
<
INTERFACE
>, 
´Ùeùed
 
	gBASE


155 
	gpublic
:

156 
boŞ
 
P¬am‘”SuµÜ‹d
(cÚ¡ *
Çme
ècÚ¡ { 
this
->
G‘Mes§geEncodšgIÁ”çû
().ParameterSupported(name);}

157 
size_t
 
FixedMaxPÏš‹xtL’gth
(ècÚ¡ { 
	gthis
->
G‘Mes§geEncodšgIÁ”çû
().
MaxUÅaddedL’gth
(
PaddedBlockB™L’gth
());}

158 
size_t
 
FixedCh”‹xtL’gth
(ècÚ¡ { 
	gthis
->
G‘T¿pdoÜFunùiÚBounds
().
MaxImage
().
By‹CouÁ
();}

160 
	g´Ùeùed
:

161 
size_t
 
PaddedBlockBy‹L’gth
(ècÚ¡ { 
B™sToBy‹s
(
PaddedBlockB™L’gth
());}

162 
size_t
 
PaddedBlockB™L’gth
(ècÚ¡ { 
	gthis
->
G‘T¿pdoÜFunùiÚBounds
().
P»imageBound
().
B™CouÁ
()-1;}

166 
şass
 
CRYPTOPP_DLL
 
CRYPTOPP_NO_VTABLE
 
	gTF_Deüy±ÜBa£
 : 
public
 
TF_Cry±oSy¡emBa£
<
PK_Deüy±Ü
, 
	gTF_Ba£
<
	gT¿pdoÜFunùiÚInv”£
, 
	gPK_Enüy±iÚMes§geEncodšgM‘hod
> >

168 
	gpublic
:

169 
DecodšgResuÉ
 
Deüy±
(
RªdomNumb”G’”©Ü
 &
ºg
, cÚ¡ 
by‹
 *
ch”‹xt
, 
size_t
 
ch”‹xtL’gth
, by‹ *
¶aš‹xt
, cÚ¡ 
NameV®uePaœs
 &
·¿m‘”s
 = 
g_nuÎNameV®uePaœs
) const;

173 
şass
 
CRYPTOPP_DLL
 
CRYPTOPP_NO_VTABLE
 
	gTF_Enüy±ÜBa£
 : 
public
 
TF_Cry±oSy¡emBa£
<
PK_Enüy±Ü
, 
	gTF_Ba£
<
	gRªdomizedT¿pdoÜFunùiÚ
, 
	gPK_Enüy±iÚMes§geEncodšgM‘hod
> >

175 
	gpublic
:

176 
Enüy±
(
RªdomNumb”G’”©Ü
 &
ºg
, cÚ¡ 
by‹
 *
¶aš‹xt
, 
size_t
 
¶aš‹xtL’gth
, by‹ *
ch”‹xt
, cÚ¡ 
NameV®uePaœs
 &
·¿m‘”s
 = 
g_nuÎNameV®uePaœs
) const;

181 
	g¡d
::
	t·œ
<cÚ¡ 
	tby‹
 *, 
	tsize_t
> 
	tHashId’tif›r
;

184 şas 
	cCRYPTOPP_NO_VTABLE
 
	mPK_SigÇtu»Mes§geEncodšgM‘hod


186 
	mpublic
:

187 
vœtu®
 ~
	$PK_SigÇtu»Mes§geEncodšgM‘hod
() {}

189 
vœtu®
 
size_t
 
	$MšR•»£Á©iveB™L’gth
(
size_t
 
hashId’tif›rL’gth
, size_ˆ
dige¡L’gth
) const

190 { 0;
	}
}

191 
vœtu®
 
size_t
 
	$MaxRecov”abËL’gth
(
size_t
 
»´e£Á©iveB™L’gth
, size_ˆ
hashId’tif›rL’gth
, size_ˆ
dige¡L’gth
) const

192 { 0;
	}
}

194 
boŞ
 
	$IsProbabi¡ic
() const

195 { 
Œue
;
	}
}

196 
boŞ
 
	$AÎowNÚ»cov”abËP¬t
() const

197 {
throw
 
	`NÙIm¶em’‹d
("PK_Mes§geEncodšgM‘hod:hi sigÇtu» schemdÛ nÙ suµÜˆmes§g»cov”y");
	}
}

198 
vœtu®
 
boŞ
 
	$Recov”abËP¬tFœ¡
() const

199 {
throw
 
	`NÙIm¶em’‹d
("PK_Mes§geEncodšgM‘hod:hi sigÇtu» schemdÛ nÙ suµÜˆmes§g»cov”y");
	}
}

202 
vœtu®
 
	$ProûssSemisigÇtu»
(
HashT¿nsfÜm©iÚ
 &
hash
, cÚ¡ 
by‹
 *
£misigÇtu»
, 
size_t
 
£misigÇtu»L’gth
ècÚ¡ {
	}
}

205 
vœtu®
 
	$ProûssRecov”abËMes§ge
(
HashT¿nsfÜm©iÚ
 &
hash
,

206 cÚ¡ 
by‹
 *
»cov”abËMes§ge
, 
size_t
 
»cov”abËMes§geL’gth
,

207 cÚ¡ 
by‹
 *
´esigÇtu»
, 
size_t
 
´esigÇtu»L’gth
,

208 
SecBy‹Block
 &
£misigÇtu»
) const

210 ià(
	`Recov”abËP¬tFœ¡
())

211 
	`as£¹
(!"ProcessRecoverableMessage()‚ot implemented");

212 
	}
}

214 
vœtu®
 
	$Compu‹Mes§geR•»£Á©ive
(
RªdomNumb”G’”©Ü
 &
ºg
,

215 cÚ¡ 
by‹
 *
»cov”abËMes§ge
, 
size_t
 
»cov”abËMes§geL’gth
,

216 
HashT¿nsfÜm©iÚ
 &
hash
, 
HashId’tif›r
 
hashId’tif›r
, 
boŞ
 
mes§geEm±y
,

217 
by‹
 *
»´e£Á©ive
, 
size_t
 
»´e£Á©iveB™L’gth
) const =0;

219 
vœtu®
 
boŞ
 
	$V”ifyMes§geR•»£Á©ive
(

220 
HashT¿nsfÜm©iÚ
 &
hash
, 
HashId’tif›r
 
hashId’tif›r
, 
boŞ
 
mes§geEm±y
,

221 
by‹
 *
»´e£Á©ive
, 
size_t
 
»´e£Á©iveB™L’gth
) const =0;

223 
vœtu®
 
DecodšgResuÉ
 
	$Recov”Mes§geFromR•»£Á©ive
(

224 
HashT¿nsfÜm©iÚ
 &
hash
, 
HashId’tif›r
 
hashId’tif›r
, 
boŞ
 
mes§geEm±y
,

225 
by‹
 *
»´e£Á©ive
, 
size_t
 
»´e£Á©iveB™L’gth
,

226 
by‹
 *
»cov”edMes§ge
) const

227 {
throw
 
	`NÙIm¶em’‹d
("PK_Mes§geEncodšgM‘hod:hi sigÇtu» schemdÛ nÙ suµÜˆmes§g»cov”y");
	}
}

229 
vœtu®
 
DecodšgResuÉ
 
	$Recov”Mes§geFromSemisigÇtu»
(

230 
HashT¿nsfÜm©iÚ
 &
hash
, 
HashId’tif›r
 
hashId’tif›r
,

231 cÚ¡ 
by‹
 *
´esigÇtu»
, 
size_t
 
´esigÇtu»L’gth
,

232 cÚ¡ 
by‹
 *
£misigÇtu»
, 
size_t
 
£misigÇtu»L’gth
,

233 
by‹
 *
»cov”edMes§ge
) const

234 {
throw
 
	`NÙIm¶em’‹d
("PK_Mes§geEncodšgM‘hod:hi sigÇtu» schemdÛ nÙ suµÜˆmes§g»cov”y");
	}
}

237 
	sHashId’tif›rLookup


239 
	g‹m¶©e
 <
şass
 
	gH
> 
	sHashId’tif›rLookup2


241 
HashId’tif›r
 
CRYPTOPP_API
 
Lookup
()

243  
HashId’tif›r
((cÚ¡ 
by‹
 *)
NULL
, 0);

249 şas 
	cCRYPTOPP_DLL
 
CRYPTOPP_NO_VTABLE
 
	mPK_D‘”mši¡icSigÇtu»Mes§geEncodšgM‘hod
 : 
public
 
PK_SigÇtu»Mes§geEncodšgM‘hod


251 
public
:

252 
boŞ
 
	$V”ifyMes§geR•»£Á©ive
(

253 
HashT¿nsfÜm©iÚ
 &
hash
, 
HashId’tif›r
 
hashId’tif›r
, 
boŞ
 
mes§geEm±y
,

254 
by‹
 *
»´e£Á©ive
, 
size_t
 
»´e£Á©iveB™L’gth
) const;

257 şas 
	cCRYPTOPP_DLL
 
CRYPTOPP_NO_VTABLE
 
PK_Recov”abËSigÇtu»Mes§geEncodšgM‘hod
 : 
public
 
PK_SigÇtu»Mes§geEncodšgM‘hod


259 
public
:

260 
boŞ
 
	$V”ifyMes§geR•»£Á©ive
(

261 
HashT¿nsfÜm©iÚ
 &
hash
, 
HashId’tif›r
 
hashId’tif›r
, 
boŞ
 
mes§geEm±y
,

262 
by‹
 *
»´e£Á©ive
, 
size_t
 
»´e£Á©iveB™L’gth
) const;

265 şas 
	cCRYPTOPP_DLL
 
DL_SigÇtu»Mes§geEncodšgM‘hod_DSA
 : 
public
 
PK_D‘”mši¡icSigÇtu»Mes§geEncodšgM‘hod


267 
public
:

268 
	$Compu‹Mes§geR•»£Á©ive
(
RªdomNumb”G’”©Ü
 &
ºg
,

269 cÚ¡ 
by‹
 *
»cov”abËMes§ge
, 
size_t
 
»cov”abËMes§geL’gth
,

270 
HashT¿nsfÜm©iÚ
 &
hash
, 
HashId’tif›r
 
hashId’tif›r
, 
boŞ
 
mes§geEm±y
,

271 
by‹
 *
»´e£Á©ive
, 
size_t
 
»´e£Á©iveB™L’gth
) const;

274 şas 
	cCRYPTOPP_DLL
 
DL_SigÇtu»Mes§geEncodšgM‘hod_NR
 : 
public
 
PK_D‘”mši¡icSigÇtu»Mes§geEncodšgM‘hod


276 
public
:

277 
	$Compu‹Mes§geR•»£Á©ive
(
RªdomNumb”G’”©Ü
 &
ºg
,

278 cÚ¡ 
by‹
 *
»cov”abËMes§ge
, 
size_t
 
»cov”abËMes§geL’gth
,

279 
HashT¿nsfÜm©iÚ
 &
hash
, 
HashId’tif›r
 
hashId’tif›r
, 
boŞ
 
mes§geEm±y
,

280 
by‹
 *
»´e£Á©ive
, 
size_t
 
»´e£Á©iveB™L’gth
) const;

283 şas 
	cCRYPTOPP_DLL
 
CRYPTOPP_NO_VTABLE
 
PK_Mes§geAccumuÏtÜBa£
 : 
public
 
PK_Mes§geAccumuÏtÜ


285 
public
:

286 
	$PK_Mes§geAccumuÏtÜBa£
(è: 
	$m_em±y
(
Œue
) {}

288 
vœtu®
 
HashT¿nsfÜm©iÚ
 & 
	`AcûssHash
() =0;

290 
	$Upd©e
(cÚ¡ 
by‹
 *
šput
, 
size_t
 
Ëngth
)

292 
	`AcûssHash
().
	`Upd©e
(
šput
, 
Ëngth
);

293 
m_em±y
 = m_em±y && 
Ëngth
 == 0;

294 
	}
}

296 
SecBy‹Block
 
	gm_»cov”abËMes§ge
, 
	gm_»´e£Á©ive
, 
	gm_´esigÇtu»
, 
	gm_£misigÇtu»
;

297 
IÁeg”
 
	gm_k
, 
	gm_s
;

298 
boŞ
 
	gm_em±y
;

301 
	g‹m¶©e
 <
şass
 
	gHASH_ALGORITHM
>

302 
şass
 
	gPK_Mes§geAccumuÏtÜIm¶
 : 
public
 
PK_Mes§geAccumuÏtÜBa£
, 
´Ùeùed
 
	gObjeùHŞd”
<
	gHASH_ALGORITHM
>

304 
	gpublic
:

305 
HashT¿nsfÜm©iÚ
 & 
AcûssHash
(è{ 
this
->
m_objeù
;}

309 
	g‹m¶©e
 <
şass
 
	gINTERFACE
, cÏs 
	gBASE
>

310 
şass
 
CRYPTOPP_NO_VTABLE
 
	gTF_SigÇtu»SchemeBa£
 : 
public
 
INTERFACE
, 
´Ùeùed
 
	gBASE


312 
	gpublic
:

313 
size_t
 
SigÇtu»L’gth
() const

314 { 
this
->
G‘T¿pdoÜFunùiÚBounds
().
MaxP»image
().
By‹CouÁ
();}

315 
size_t
 
MaxRecov”abËL’gth
() const

316 { 
	gthis
->
G‘Mes§geEncodšgIÁ”çû
().
MaxRecov”abËL’gth
(
Mes§geR•»£Á©iveB™L’gth
(), 
G‘HashId’tif›r
().
£cÚd
, 
G‘Dige¡Size
());}

317 
size_t
 
MaxRecov”abËL’gthFromSigÇtu»L’gth
(size_ˆ
sigÇtu»L’gth
) const

318 { 
	gthis
->
MaxRecov”abËL’gth
();}

320 
boŞ
 
IsProbabi¡ic
() const

321 { 
	gthis
->
G‘T¿pdoÜFunùiÚIÁ”çû
().
IsRªdomized
(è||his->
G‘Mes§geEncodšgIÁ”çû
().
IsProbabi¡ic
();}

322 
boŞ
 
AÎowNÚ»cov”abËP¬t
() const

323 { 
	gthis
->
G‘Mes§geEncodšgIÁ”çû
().
AÎowNÚ»cov”abËP¬t
();}

324 
boŞ
 
Recov”abËP¬tFœ¡
() const

325 { 
	gthis
->
G‘Mes§geEncodšgIÁ”çû
().
Recov”abËP¬tFœ¡
();}

327 
	g´Ùeùed
:

328 
size_t
 
Mes§geR•»£Á©iveL’gth
(ècÚ¡ { 
B™sToBy‹s
(
Mes§geR•»£Á©iveB™L’gth
());}

329 
size_t
 
Mes§geR•»£Á©iveB™L’gth
(ècÚ¡ { 
	gthis
->
G‘T¿pdoÜFunùiÚBounds
().
ImageBound
().
B™CouÁ
()-1;}

330 
vœtu®
 
HashId’tif›r
 
G‘HashId’tif›r
() const =0;

331 
vœtu®
 
size_t
 
G‘Dige¡Size
() const =0;

335 
şass
 
CRYPTOPP_DLL
 
CRYPTOPP_NO_VTABLE
 
	gTF_SigÃrBa£
 : 
public
 
TF_SigÇtu»SchemeBa£
<
PK_SigÃr
, 
	gTF_Ba£
<
	gRªdomizedT¿pdoÜFunùiÚInv”£
, 
	gPK_SigÇtu»Mes§geEncodšgM‘hod
> >

337 
	gpublic
:

338 
IÅutRecov”abËMes§ge
(
PK_Mes§geAccumuÏtÜ
 &
mes§geAccumuÏtÜ
, cÚ¡ 
by‹
 *
»cov”abËMes§ge
, 
size_t
 
»cov”abËMes§geL’gth
) const;

339 
size_t
 
SignAndRe¡¬t
(
RªdomNumb”G’”©Ü
 &
ºg
, 
PK_Mes§geAccumuÏtÜ
 &
mes§geAccumuÏtÜ
, 
by‹
 *
sigÇtu»
, 
boŞ
 
»¡¬t
=
Œue
) const;

343 
şass
 
CRYPTOPP_DLL
 
CRYPTOPP_NO_VTABLE
 
	gTF_V”if›rBa£
 : 
public
 
TF_SigÇtu»SchemeBa£
<
PK_V”if›r
, 
	gTF_Ba£
<
	gT¿pdoÜFunùiÚ
, 
	gPK_SigÇtu»Mes§geEncodšgM‘hod
> >

345 
	gpublic
:

346 
IÅutSigÇtu»
(
PK_Mes§geAccumuÏtÜ
 &
mes§geAccumuÏtÜ
, cÚ¡ 
by‹
 *
sigÇtu»
, 
size_t
 
sigÇtu»L’gth
) const;

347 
boŞ
 
V”ifyAndRe¡¬t
(
PK_Mes§geAccumuÏtÜ
 &
mes§geAccumuÏtÜ
) const;

348 
DecodšgResuÉ
 
Recov”AndRe¡¬t
(
by‹
 *
»cov”edMes§ge
, 
PK_Mes§geAccumuÏtÜ
 &
»cov”yAccumuÏtÜ
) const;

354 
	g‹m¶©e
 <
şass
 
	gT1
, cÏs 
	gT2
, cÏs 
	gT3
>

355 
	sTF_Cry±oSchemeO±iÚs


357 
T1
 
	tAlgÜ™hmInfo
;

358 
T2
 
	tKeys
;

359 
ty³Çme
 
	tKeys
::
	tPriv©eKey
 PrivateKey;

360 
ty³Çme
 
	tKeys
::
	tPublicKey
 PublicKey;

361 
T3
 
	tMes§geEncodšgM‘hod
;

365 
	g‹m¶©e
 <
şass
 
	gT1
, cÏs 
	gT2
, cÏs 
	gT3
, cÏs 
	gT4
>

366 
	gTF_SigÇtu»SchemeO±iÚs
 : 
public
 
TF_Cry±oSchemeO±iÚs
<
T1
, 
	gT2
, 
	gT3
>

368 
T4
 
	tHashFunùiÚ
;

372 
	g‹m¶©e
 <
şass
 
	gBASE
, cÏs 
	gSCHEME_OPTIONS
, cÏs 
	gKEY_CLASS
>

373 
şass
 
CRYPTOPP_NO_VTABLE
 
	gTF_ObjeùIm¶Ba£
 : 
public
 
AlgÜ™hmIm¶
<
BASE
, 
ty³Çme
 
	gSCHEME_OPTIONS
::
AlgÜ™hmInfo
>

375 
public
:

376 
SCHEME_OPTIONS
 
	tSchemeO±iÚs
;

377 
KEY_CLASS
 
	tKeyCÏss
;

379 
	gPublicKey
 & 
AcûssPublicKey
(è{ 
AcûssKey
();}

380 cÚ¡ 
	gPublicKey
 & 
G‘PublicKey
(ècÚ¡ { 
G‘Key
();}

382 
	gPriv©eKey
 & 
AcûssPriv©eKey
(è{ 
AcûssKey
();}

383 cÚ¡ 
	gPriv©eKey
 & 
G‘Priv©eKey
(ècÚ¡ { 
G‘Key
();}

385 
vœtu®
 cÚ¡ 
	gKeyCÏss
 & 
G‘Key
() const =0;

386 
vœtu®
 
	gKeyCÏss
 & 
AcûssKey
() =0;

388 cÚ¡ 
	gKeyCÏss
 & 
G‘T¿pdoÜFunùiÚ
(ècÚ¡ { 
G‘Key
();}

390 
PK_Mes§geAccumuÏtÜ
 * 
NewSigÇtu»AccumuÏtÜ
(
RªdomNumb”G’”©Ü
 &
ºg
) const

392  
Ãw
 
	gPK_Mes§geAccumuÏtÜIm¶
<
CPP_TYPENAME
 
	gSCHEME_OPTIONS
::
HashFunùiÚ
>;

394 
PK_Mes§geAccumuÏtÜ
 * 
NewV”ifiÿtiÚAccumuÏtÜ
() const

396  
Ãw
 
	gPK_Mes§geAccumuÏtÜIm¶
<
CPP_TYPENAME
 
	gSCHEME_OPTIONS
::
HashFunùiÚ
>;

399 
	g´Ùeùed
:

400 cÚ¡ 
ty³Çme
 
BASE
::
Mes§geEncodšgIÁ”çû
 & 
G‘Mes§geEncodšgIÁ”çû
() const

401 { 
SšgËtÚ
<
CPP_TYPENAME
 
SCHEME_OPTIONS
::
Mes§geEncodšgM‘hod
>().
Ref
();}

402 cÚ¡ 
	gT¿pdoÜFunùiÚBounds
 & 
G‘T¿pdoÜFunùiÚBounds
() const

403 { 
G‘Key
();}

404 cÚ¡ 
ty³Çme
 
	gBASE
::
T¿pdoÜFunùiÚIÁ”çû
 & 
G‘T¿pdoÜFunùiÚIÁ”çû
() const

405 { 
G‘Key
();}

408 
HashId’tif›r
 
G‘HashId’tif›r
() const

410 
CPP_TYPENAME
 
	tSchemeO±iÚs
::
	tMes§geEncodšgM‘hod
::
	tHashId’tif›rLookup
::
	t‹m¶©e
 
	tHashId’tif›rLookup2
<
	tCPP_TYPENAME
 SchemeO±iÚs::
	tHashFunùiÚ
> 
	tL
;

411  
	gL
::
Lookup
();

413 
size_t
 
G‘Dige¡Size
() const

415 
CPP_TYPENAME
 
	tSchemeO±iÚs
::
	tHashFunùiÚ
 
	tH
;

416  
	gH
::
DIGESTSIZE
;

421 
	g‹m¶©e
 <
şass
 
	gBASE
, cÏs 
	gSCHEME_OPTIONS
, cÏs 
	gKEY
>

422 
şass
 
	gTF_ObjeùIm¶ExtRef
 : 
public
 
TF_ObjeùIm¶Ba£
<
BASE
, 
	gSCHEME_OPTIONS
, 
	gKEY
>

424 
	gpublic
:

425 
TF_ObjeùIm¶ExtRef
(cÚ¡ 
KEY
 *
pKey
 = 
NULL
è: 
m_pKey
(pKey) {}

426 
S‘KeyPŒ
(cÚ¡ 
KEY
 *
pKey
è{
m_pKey
 =…Key;}

428 cÚ¡ 
	gKEY
 & 
G‘Key
(ècÚ¡ { *
	gm_pKey
;}

429 
	gKEY
 & 
AcûssKey
(è{
throw
 
NÙIm¶em’‹d
("TF_ObjectImplExtRef: cannot modify„efererenced key");}

431 
	g´iv©e
:

432 cÚ¡ 
KEY
 * 
m_pKey
;

436 
	g‹m¶©e
 <
şass
 
	gBASE
, cÏs 
	gSCHEME_OPTIONS
, cÏs 
	gKEY_CLASS
>

437 
şass
 
CRYPTOPP_NO_VTABLE
 
	gTF_ObjeùIm¶
 : 
public
 
TF_ObjeùIm¶Ba£
<
BASE
, 
	gSCHEME_OPTIONS
, 
	gKEY_CLASS
>

439 
	gpublic
:

440 
KEY_CLASS
 
	tKeyCÏss
;

442 cÚ¡ 
	gKeyCÏss
 & 
G‘Key
(ècÚ¡ { 
	gm_Œ­doÜFunùiÚ
;}

443 
	gKeyCÏss
 & 
AcûssKey
(è{ 
	gm_Œ­doÜFunùiÚ
;}

445 
	g´iv©e
:

446 
KeyCÏss
 
m_Œ­doÜFunùiÚ
;

450 
	g‹m¶©e
 <
şass
 
	gSCHEME_OPTIONS
>

451 
şass
 
	gTF_Deüy±ÜIm¶
 : 
public
 
TF_ObjeùIm¶
<
TF_Deüy±ÜBa£
, 
	gSCHEME_OPTIONS
, 
ty³Çme
 SCHEME_OPTIONS::
Priv©eKey
>

456 
	g‹m¶©e
 <
şass
 
	gSCHEME_OPTIONS
>

457 
şass
 
	gTF_Enüy±ÜIm¶
 : 
public
 
TF_ObjeùIm¶
<
TF_Enüy±ÜBa£
, 
	gSCHEME_OPTIONS
, 
ty³Çme
 SCHEME_OPTIONS::
PublicKey
>

462 
	g‹m¶©e
 <
şass
 
	gSCHEME_OPTIONS
>

463 
şass
 
	gTF_SigÃrIm¶
 : 
public
 
TF_ObjeùIm¶
<
TF_SigÃrBa£
, 
	gSCHEME_OPTIONS
, 
ty³Çme
 SCHEME_OPTIONS::
Priv©eKey
>

468 
	g‹m¶©e
 <
şass
 
	gSCHEME_OPTIONS
>

469 
şass
 
	gTF_V”if›rIm¶
 : 
public
 
TF_ObjeùIm¶
<
TF_V”if›rBa£
, 
	gSCHEME_OPTIONS
, 
ty³Çme
 SCHEME_OPTIONS::
PublicKey
>

476 şas 
	cCRYPTOPP_NO_VTABLE
 
	mMaskG’”©šgFunùiÚ


478 
	mpublic
:

479 
vœtu®
 ~
	$MaskG’”©šgFunùiÚ
() {}

480 
vœtu®
 
	$G’”©eAndMask
(
HashT¿nsfÜm©iÚ
 &
hash
, 
by‹
 *
ouut
, 
size_t
 
ouutL’gth
, cÚ¡ by‹ *
šput
, size_ˆ
šputL’gth
, 
boŞ
 
mask
 = 
Œue
) const =0;

481 
	}
};

483 
CRYPTOPP_DLL
 
CRYPTOPP_API
 
P1363_MGF1KDF2_CommÚ
(
HashT¿nsfÜm©iÚ
 &
hash
, 
by‹
 *
ouut
, 
size_t
 
ouutL’gth
, cÚ¡ by‹ *
šput
, size_ˆ
šputL’gth
, cÚ¡ by‹ *
d”iv©iÚP¬ams
, size_ˆ
d”iv©iÚP¬amsL’gth
, 
boŞ
 
mask
, 
couÁ”S¹
);

486 şas 
	cP1363_MGF1
 : 
public
 
MaskG’”©šgFunùiÚ


488 
public
:

489 cÚ¡ * 
CRYPTOPP_API
 
	$SticAlgÜ™hmName
() { "MGF1";}

490 
	$G’”©eAndMask
(
HashT¿nsfÜm©iÚ
 &
hash
, 
by‹
 *
ouut
, 
size_t
 
ouutL’gth
, cÚ¡ by‹ *
šput
, size_ˆ
šputL’gth
, 
boŞ
 
mask
 = 
Œue
) const

492 
	`P1363_MGF1KDF2_CommÚ
(
hash
, 
ouut
, 
ouutL’gth
, 
šput
, 
šputL’gth
, 
NULL
, 0, 
mask
, 0);

493 
	}
}

499 
	g‹m¶©e
 <
şass
 
	gH
>

500 şas 
	cP1363_KDF2


502 
	mpublic
:

503 
CRYPTOPP_API
 
	$D”iveKey
(
by‹
 *
ouut
, 
size_t
 
ouutL’gth
, cÚ¡ by‹ *
šput
, size_ˆ
šputL’gth
, cÚ¡ by‹ *
d”iv©iÚP¬ams
, size_ˆ
d”iv©iÚP¬amsL’gth
)

505 
H
 
h
;

506 
	`P1363_MGF1KDF2_CommÚ
(
h
, 
ouut
, 
ouutL’gth
, 
šput
, 
šputL’gth
, 
d”iv©iÚP¬ams
, 
d”iv©iÚP¬amsL’gth
, 
çl£
, 1);

508 
	}
};

513 şas 
	cDL_BadEËm’t
 : 
public
 
Inv®idD©aFÜm©


515 
public
:

516 
	$DL_BadEËm’t
(è: 
	`Inv®idD©aFÜm©
("CryptoPP: invalid groupƒlement") {}

517 
	}
};

520 
	g‹m¶©e
 <
şass
 
	gT
>

521 şas 
	cCRYPTOPP_NO_VTABLE
 
	mDL_GroupP¬am‘”s
 : 
public
 
Cry±oP¬am‘”s


523 
DL_GroupP¬am‘”s
<
	tT
> 
	tThisCÏss
;

525 
	mpublic
:

526 
T
 
	tEËm’t
;

528 
	$DL_GroupP¬am‘”s
(è: 
	$m_v®id©iÚLev–
(0) {}

531 
boŞ
 
	$V®id©e
(
RªdomNumb”G’”©Ü
 &
ºg
, 
Ëv–
) const

533 ià(!
	`G‘Ba£P»computiÚ
().
	`IsIn™Ÿlized
())

534  
çl£
;

536 ià(
m_v®id©iÚLev–
 > 
Ëv–
)

537  
Œue
;

539 
boŞ
 
·ss
 = 
	`V®id©eGroup
(
ºg
, 
Ëv–
);

540 
·ss
 =…as && 
	`V®id©eEËm’t
(
Ëv–
, 
	`G‘SubgroupG’”©Ü
(), &
	`G‘Ba£P»computiÚ
());

542 
m_v®id©iÚLev–
 = 
·ss
 ? 
Ëv–
+1 : 0;

544  
·ss
;

545 
	}
}

547 
boŞ
 
	$G‘VoidV®ue
(cÚ¡ *
Çme
, cÚ¡ 
¡d
::
ty³_šfo
 &
v®ueTy³
, *
pV®ue
) const

549  
	`G‘V®ueH–³r
(
this
, 
Çme
, 
v®ueTy³
, 
pV®ue
)

550 
	`CRYPTOPP_GET_FUNCTION_ENTRY
(
SubgroupOrd”
)

551 
	`CRYPTOPP_GET_FUNCTION_ENTRY
(
SubgroupG’”©Ü
)

553 
	}
}

555 
boŞ
 
	$SuµÜtsP»computiÚ
(ècÚ¡ { 
Œue
;
	}
}

557 
	$P»compu‹
(
´ecomputiÚStÜage
=16)

559 
	`AcûssBa£P»computiÚ
().
	`P»compu‹
(
	`G‘GroupP»computiÚ
(), 
	`G‘SubgroupOrd”
().
	`B™CouÁ
(), 
´ecomputiÚStÜage
);

560 
	}
}

562 
	$LßdP»computiÚ
(
Bufã»dT¿nsfÜm©iÚ
 &
¡ÜedP»computiÚ
)

564 
	`AcûssBa£P»computiÚ
().
	`Lßd
(
	`G‘GroupP»computiÚ
(), 
¡ÜedP»computiÚ
);

565 
m_v®id©iÚLev–
 = 0;

566 
	}
}

568 
	$SaveP»computiÚ
(
Bufã»dT¿nsfÜm©iÚ
 &
¡ÜedP»computiÚ
) const

570 
	`G‘Ba£P»computiÚ
().
	`Save
(
	`G‘GroupP»computiÚ
(), 
¡ÜedP»computiÚ
);

571 
	}
}

574 
vœtu®
 cÚ¡ 
	gEËm’t
 & 
	$G‘SubgroupG’”©Ü
(ècÚ¡ { 
	`G‘Ba£P»computiÚ
().
	`G‘Ba£
(
	`G‘GroupP»computiÚ
());
	}
}

575 
vœtu®
 
	$S‘SubgroupG’”©Ü
(cÚ¡ 
EËm’t
 &
ba£
è{
	`AcûssBa£P»computiÚ
().
	`S‘Ba£
(
	`G‘GroupP»computiÚ
(), ba£);
	}
}

576 
vœtu®
 
EËm’t
 
	$ExpÚ’tŸ‹Ba£
(cÚ¡ 
IÁeg”
 &
expÚ’t
) const

578  
	`G‘Ba£P»computiÚ
().
	`ExpÚ’tŸ‹
(
	`G‘GroupP»computiÚ
(), 
expÚ’t
);

579 
	}
}

580 
vœtu®
 
EËm’t
 
	$ExpÚ’tŸ‹EËm’t
(cÚ¡ 
EËm’t
 &
ba£
, cÚ¡ 
IÁeg”
 &
expÚ’t
) const

582 
EËm’t
 
»suÉ
;

583 
	`SimuÉªeousExpÚ’tŸ‹
(&
»suÉ
, 
ba£
, &
expÚ’t
, 1);

584  
»suÉ
;

585 
	}
}

587 
vœtu®
 cÚ¡ 
	gDL_GroupP»computiÚ
<
	gEËm’t
> & 
	$G‘GroupP»computiÚ
() const =0;

588 
vœtu®
 cÚ¡ 
DL_FixedBa£P»computiÚ
<
EËm’t
> & 
	$G‘Ba£P»computiÚ
() const =0;

589 
vœtu®
 
DL_FixedBa£P»computiÚ
<
EËm’t
> & 
	`AcûssBa£P»computiÚ
() =0;

590 
vœtu®
 cÚ¡ 
IÁeg”
 & 
	$G‘SubgroupOrd”
() const =0;

591 
vœtu®
 
IÁeg”
 
	$G‘MaxExpÚ’t
() const =0;

592 
vœtu®
 
IÁeg”
 
	$G‘GroupOrd”
(ècÚ¡ { 
	`G‘SubgroupOrd”
()*
	`G‘CoçùÜ
();
	}
}

593 
vœtu®
 
IÁeg”
 
	$G‘CoçùÜ
(ècÚ¡ { 
	`G‘GroupOrd”
()/
	`G‘SubgroupOrd”
();
	}
}

594 
vœtu®
 
	$G‘EncodedEËm’tSize
(
boŞ
 
»v”sibË
) const =0;

595 
vœtu®
 
	$EncodeEËm’t
(
boŞ
 
»v”sibË
, cÚ¡ 
EËm’t
 &
–em’t
, 
by‹
 *
’coded
) const =0;

596 
vœtu®
 
EËm’t
 
	$DecodeEËm’t
(cÚ¡ 
by‹
 *
’coded
, 
boŞ
 
checkFÜGroupMemb”sh
) const =0;

597 
vœtu®
 
IÁeg”
 
	$CÚv”tEËm’tToIÁeg”
(cÚ¡ 
EËm’t
 &
–em’t
) const =0;

598 
vœtu®
 
boŞ
 
	$V®id©eGroup
(
RªdomNumb”G’”©Ü
 &
ºg
, 
Ëv–
) const =0;

599 
vœtu®
 
boŞ
 
	`V®id©eEËm’t
(
Ëv–
, cÚ¡ 
EËm’t
 &
–em’t
, cÚ¡ 
DL_FixedBa£P»computiÚ
<EËm’t> *
´ecomp
) const =0;

600 
vœtu®
 
boŞ
 
	$Fa¡SubgroupCheckAvaabË
() const =0;

601 
vœtu®
 
boŞ
 
	$IsId’t™y
(cÚ¡ 
EËm’t
 &
–em’t
) const =0;

602 
vœtu®
 
	$SimuÉªeousExpÚ’tŸ‹
(
EËm’t
 *
»suÉs
, cÚ¡ EËm’ˆ&
ba£
, cÚ¡ 
IÁeg”
 *
expÚ’ts
, 
expÚ’tsCouÁ
) const =0;

604 
´Ùeùed
:

605 
	$P¬am‘”sChªged
(è{
m_v®id©iÚLev–
 = 0;
	}
}

607 
	g´iv©e
:

608 
mubË
 
m_v®id©iÚLev–
;

612 
	g‹m¶©e
 <
şass
 
	gGROUP_PRECOMP
, cÏs 
	gBASE_PRECOMP
 = 
DL_FixedBa£P»computiÚIm¶
<
CPP_TYPENAME
 
GROUP_PRECOMP
::
EËm’t
>, cÏs 
	gBASE
 = 
DL_GroupP¬am‘”s
<CPP_TYPENAME GROUP_PRECOMP::Element> >

613 şas 
	cDL_GroupP¬am‘”sIm¶
 : 
public
 
BASE


615 
public
:

616 
GROUP_PRECOMP
 
	tGroupP»computiÚ
;

617 
ty³Çme
 
	tGROUP_PRECOMP
::
	tEËm’t
 Element;

618 
BASE_PRECOMP
 
	tBa£P»computiÚ
;

620 cÚ¡ 
	mDL_GroupP»computiÚ
<
	mEËm’t
> & 
	$G‘GroupP»computiÚ
(ècÚ¡ { 
m_groupP»computiÚ
;}

621 cÚ¡ 
DL_FixedBa£P»computiÚ
<
EËm’t
> & 
	$G‘Ba£P»computiÚ
(ècÚ¡ { 
m_gpc
;
	}
}

622 
	gDL_FixedBa£P»computiÚ
<
	gEËm’t
> & 
	$AcûssBa£P»computiÚ
(è{ 
m_gpc
;
	}
}

624 
	g´Ùeùed
:

625 
GROUP_PRECOMP
 
m_groupP»computiÚ
;

626 
BASE_PRECOMP
 
	gm_gpc
;

630 
	g‹m¶©e
 <
şass
 
	gT
>

631 şas 
	cCRYPTOPP_NO_VTABLE
 
	mDL_Key


633 
	mpublic
:

634 
vœtu®
 cÚ¡ 
DL_GroupP¬am‘”s
<
T
> & 
	$G‘Ab¡¿ùGroupP¬am‘”s
() const =0;

635 
vœtu®
 
DL_GroupP¬am‘”s
<
T
> & 
	`AcûssAb¡¿ùGroupP¬am‘”s
() =0;

639 
‹m¶©e
 <
şass
 
T
>

640 
şass
 
CRYPTOPP_NO_VTABLE
 
DL_PublicKey
 : 
public
 
DL_Key
<
T
>

642 
DL_PublicKey
<
	tT
> 
	tThisCÏss
;

644 
public
:

645 
T
 
	tEËm’t
;

647 
boŞ
 
	`G‘VoidV®ue
(cÚ¡ *
Çme
, cÚ¡ 
¡d
::
ty³_šfo
 &
v®ueTy³
, *
pV®ue
) const

649  
	`G‘V®ueH–³r
(
this
, 
Çme
, 
v®ueTy³
, 
pV®ue
, &this->
	`G‘Ab¡¿ùGroupP¬am‘”s
())

650 
	`CRYPTOPP_GET_FUNCTION_ENTRY
(
PublicEËm’t
);

653 
	`AssignFrom
(cÚ¡ 
NameV®uePaœs
 &
sourû
);

656 
vœtu®
 cÚ¡ 
EËm’t
 & 
	`G‘PublicEËm’t
(ècÚ¡ { 
	`G‘PublicP»computiÚ
().
	`G‘Ba£
(
this
->
	`G‘Ab¡¿ùGroupP¬am‘”s
().
	`G‘GroupP»computiÚ
());}

657 
vœtu®
 
	`S‘PublicEËm’t
(cÚ¡ 
EËm’t
 &
y
è{
	`AcûssPublicP»computiÚ
().
	`S‘Ba£
(
this
->
	`G‘Ab¡¿ùGroupP¬am‘”s
().
	`G‘GroupP»computiÚ
(), y);}

658 
vœtu®
 
EËm’t
 
	`ExpÚ’tŸ‹PublicEËm’t
(cÚ¡ 
IÁeg”
 &
expÚ’t
) const

660 cÚ¡ 
DL_GroupP¬am‘”s
<
T
> &
·¿ms
 = 
this
->
	`G‘Ab¡¿ùGroupP¬am‘”s
();

661  
	`G‘PublicP»computiÚ
().
	`ExpÚ’tŸ‹
(
·¿ms
.
	`G‘GroupP»computiÚ
(), 
expÚ’t
);

663 
vœtu®
 
EËm’t
 
	`CasÿdeExpÚ’tŸ‹Ba£AndPublicEËm’t
(cÚ¡ 
IÁeg”
 &
ba£Exp
, cÚ¡ IÁeg” &
publicExp
) const

665 cÚ¡ 
DL_GroupP¬am‘”s
<
T
> &
·¿ms
 = 
this
->
	`G‘Ab¡¿ùGroupP¬am‘”s
();

666  
·¿ms
.
	`G‘Ba£P»computiÚ
().
	`CasÿdeExpÚ’tŸ‹
Õ¬ams.
	`G‘GroupP»computiÚ
(), 
ba£Exp
, 
	`G‘PublicP»computiÚ
(), 
publicExp
);

669 
vœtu®
 cÚ¡ 
DL_FixedBa£P»computiÚ
<
T
> & 
	`G‘PublicP»computiÚ
() const =0;

670 
vœtu®
 
DL_FixedBa£P»computiÚ
<
T
> & 
	`AcûssPublicP»computiÚ
() =0;

671 
	}
};

674 
	g‹m¶©e
 <
şass
 
	gT
>

675 
şass
 
CRYPTOPP_NO_VTABLE
 
	gDL_Priv©eKey
 : 
public
 
DL_Key
<
T
>

677 
DL_Priv©eKey
<
	tT
> 
	tThisCÏss
;

679 
	gpublic
:

680 
T
 
	tEËm’t
;

682 
MakePublicKey
(
DL_PublicKey
<
T
> &
pub
) const

684 
	gpub
.
AcûssAb¡¿ùGroupP¬am‘”s
().
AssignFrom
(
this
->
G‘Ab¡¿ùGroupP¬am‘”s
());

685 
	gpub
.
S‘PublicEËm’t
(
this
->
G‘Ab¡¿ùGroupP¬am‘”s
().
ExpÚ’tŸ‹Ba£
(
G‘Priv©eExpÚ’t
()));

688 
boŞ
 
G‘VoidV®ue
(cÚ¡ *
Çme
, cÚ¡ 
¡d
::
ty³_šfo
 &
v®ueTy³
, *
pV®ue
) const

690  
G‘V®ueH–³r
(
this
, 
Çme
, 
v®ueTy³
, 
pV®ue
, &this->
G‘Ab¡¿ùGroupP¬am‘”s
())

691 
CRYPTOPP_GET_FUNCTION_ENTRY
(
Priv©eExpÚ’t
);

694 
AssignFrom
(cÚ¡ 
NameV®uePaœs
 &
sourû
)

696 
	gthis
->
AcûssAb¡¿ùGroupP¬am‘”s
().
AssignFrom
(
sourû
);

697 
AssignFromH–³r
(
this
, 
sourû
)

698 
CRYPTOPP_SET_FUNCTION_ENTRY
(
Priv©eExpÚ’t
);

701 
vœtu®
 cÚ¡ 
	gIÁeg”
 & 
G‘Priv©eExpÚ’t
() const =0;

702 
vœtu®
 
S‘Priv©eExpÚ’t
(cÚ¡ 
IÁeg”
 &
x
) =0;

705 
	g‹m¶©e
 <
şass
 
	gT
>

706 
	gDL_PublicKey
<
	gT
>::
	$AssignFrom
(cÚ¡ 
NameV®uePaœs
 &
sourû
)

708 
DL_Priv©eKey
<
T
> *
pPriv©eKey
 = 
NULL
;

709 ià(
sourû
.
	`G‘ThisPoš‹r
(
pPriv©eKey
))

710 
pPriv©eKey
->
	`MakePublicKey
(*
this
);

713 
this
->
	`AcûssAb¡¿ùGroupP¬am‘”s
().
	`AssignFrom
(
sourû
);

714 
	`AssignFromH–³r
(
this
, 
sourû
)

715 
	`CRYPTOPP_SET_FUNCTION_ENTRY
(
PublicEËm’t
);

717 
	}
}

719 
şass
 
	gOID
;

722 
	g‹m¶©e
 <
şass
 
	gPK
, cÏs 
	gGP
, cÏs 
	gO
 = 
OID
>

723 şas 
	cDL_KeyIm¶
 : 
public
 
PK


725 
public
:

726 
GP
 
	tGroupP¬am‘”s
;

728 
O
 
	$G‘AlgÜ™hmID
(ècÚ¡ { 
	`G‘GroupP¬am‘”s
().
	`G‘AlgÜ™hmID
();}

733 
boŞ
 
	$BERDecodeAlgÜ™hmP¬am‘”s
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
)

734 {
	`AcûssGroupP¬am‘”s
().
	`BERDecode
(
bt
);  
Œue
;
	}
}

735 
boŞ
 
	$DEREncodeAlgÜ™hmP¬am‘”s
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
) const

736 {
	`G‘GroupP¬am‘”s
().
	`DEREncode
(
bt
);  
Œue
;
	}
}

738 cÚ¡ 
	gGP
 & 
	$G‘GroupP¬am‘”s
(ècÚ¡ { 
m_groupP¬am‘”s
;
	}
}

739 
	gGP
 & 
	$AcûssGroupP¬am‘”s
(è{ 
m_groupP¬am‘”s
;
	}
}

741 
	g´iv©e
:

742 
GP
 
m_groupP¬am‘”s
;

745 
şass
 
	gX509PublicKey
;

746 
şass
 
	gPKCS8Priv©eKey
;

749 
	g‹m¶©e
 <
şass
 
	gGP
>

750 
şass
 
	gDL_Priv©eKeyIm¶
 : 
public
 
DL_Priv©eKey
<
CPP_TYPENAME
 
GP
::
EËm’t
>,…ubliø
	gDL_KeyIm¶
<
	gPKCS8Priv©eKey
, 
	gGP
>

752 
	gpublic
:

753 
ty³Çme
 
	tGP
::
	tEËm’t
 Element;

756 
boŞ
 
V®id©e
(
RªdomNumb”G’”©Ü
 &
ºg
, 
Ëv–
) const

758 
boŞ
 
	g·ss
 = 
G‘Ab¡¿ùGroupP¬am‘”s
().
V®id©e
(
ºg
, 
Ëv–
);

760 cÚ¡ 
	gIÁeg”
 &
	gq
 = 
G‘Ab¡¿ùGroupP¬am‘”s
().
G‘SubgroupOrd”
();

761 cÚ¡ 
	gIÁeg”
 &
	gx
 = 
G‘Priv©eExpÚ’t
();

763 
	g·ss
 = 
·ss
 && 
x
.
IsPos™ive
(è&& x < 
q
;

764 ià(
	gËv–
 >= 1)

765 
·ss
 =…as && 
IÁeg”
::
Gcd
(
x
, 
q
è=ğIÁeg”::
OÃ
();

766  
	g·ss
;

769 
boŞ
 
G‘VoidV®ue
(cÚ¡ *
Çme
, cÚ¡ 
¡d
::
ty³_šfo
 &
v®ueTy³
, *
pV®ue
) const

771  
	gG‘V®ueH–³r
<
	gDL_Priv©eKey
<
	gEËm’t
> >(
	gthis
, 
	gÇme
, 
	gv®ueTy³
, 
	gpV®ue
).
AssigÇbË
();

774 
AssignFrom
(cÚ¡ 
NameV®uePaœs
 &
sourû
)

776 
	gAssignFromH–³r
<
	gDL_Priv©eKey
<
	gEËm’t
> >(
	gthis
, 
	gsourû
);

779 
G’”©eRªdom
(
RªdomNumb”G’”©Ü
 &
ºg
, cÚ¡ 
NameV®uePaœs
 &
·¿ms
)

781 ià(!
	g·¿ms
.
G‘ThisObjeù
(
this
->
AcûssGroupP¬am‘”s
()))

782 
	gthis
->
AcûssGroupP¬am‘”s
().
G’”©eRªdom
(
ºg
, 
·¿ms
);

784 
IÁeg”
 
x
(
ºg
, IÁeg”::
OÃ
(), 
G‘Ab¡¿ùGroupP¬am‘”s
().
G‘MaxExpÚ’t
());

787 
S‘Priv©eExpÚ’t
(
x
);

790 
boŞ
 
SuµÜtsP»computiÚ
(ècÚ¡ { 
	gŒue
;}

792 
P»compu‹
(
´ecomputiÚStÜage
=16)

793 {
AcûssAb¡¿ùGroupP¬am‘”s
().
P»compu‹
(
´ecomputiÚStÜage
);}

795 
LßdP»computiÚ
(
Bufã»dT¿nsfÜm©iÚ
 &
¡ÜedP»computiÚ
)

796 {
AcûssAb¡¿ùGroupP¬am‘”s
().
LßdP»computiÚ
(
¡ÜedP»computiÚ
);}

798 
SaveP»computiÚ
(
Bufã»dT¿nsfÜm©iÚ
 &
¡ÜedP»computiÚ
) const

799 {
G‘Ab¡¿ùGroupP¬am‘”s
().
SaveP»computiÚ
(
¡ÜedP»computiÚ
);}

802 cÚ¡ 
	gDL_GroupP¬am‘”s
<
	gEËm’t
> & 
G‘Ab¡¿ùGroupP¬am‘”s
(ècÚ¡ { 
	gthis
->
G‘GroupP¬am‘”s
();}

803 
	gDL_GroupP¬am‘”s
<
	gEËm’t
> & 
AcûssAb¡¿ùGroupP¬am‘”s
(è{ 
	gthis
->
AcûssGroupP¬am‘”s
();}

806 cÚ¡ 
	gIÁeg”
 & 
G‘Priv©eExpÚ’t
(ècÚ¡ { 
	gm_x
;}

807 
S‘Priv©eExpÚ’t
(cÚ¡ 
IÁeg”
 &
x
è{
	gm_x
 = x;}

810 
BERDecodePriv©eKey
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
, 
boŞ
, 
size_t
)

811 {
	gm_x
.
BERDecode
(
bt
);}

812 
DEREncodePriv©eKey
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
) const

813 {
	gm_x
.
DEREncode
(
bt
);}

815 
	g´iv©e
:

816 
IÁeg”
 
m_x
;

820 
	g‹m¶©e
 <
şass
 
	gBASE
, cÏs 
	gSIGNATURE_SCHEME
>

821 şas 
	cDL_Priv©eKey_W™hSigÇtu»Paœwi£CÚsi¡’cyTe¡
 : 
public
 
BASE


823 
public
:

824 
	$G’”©eRªdom
(
RªdomNumb”G’”©Ü
 &
ºg
, cÚ¡ 
NameV®uePaœs
 &
·¿ms
)

826 
BASE
::
	`G’”©eRªdom
(
ºg
, 
·¿ms
);

828 ià(
	`FIPS_140_2_Com¶ŸnûEÇbËd
())

830 
ty³Çme
 
SIGNATURE_SCHEME
::
SigÃr
 
	`sigÃr
(*
this
);

831 
ty³Çme
 
SIGNATURE_SCHEME
::
V”if›r
 
	`v”if›r
(
sigÃr
);

832 
	`SigÇtu»Paœwi£CÚsi¡’cyTe¡_FIPS_140_OÆy
(
sigÃr
, 
v”if›r
);

835 
	}
};

838 
	g‹m¶©e
 <
şass
 
	gGP
>

839 
şass
 
	gDL_PublicKeyIm¶
 : 
public
 
DL_PublicKey
<
ty³Çme
 
GP
::
EËm’t
>,…ubliø
	gDL_KeyIm¶
<
	gX509PublicKey
, 
	gGP
>

841 
	gpublic
:

842 
ty³Çme
 
	tGP
::
	tEËm’t
 Element;

845 
boŞ
 
V®id©e
(
RªdomNumb”G’”©Ü
 &
ºg
, 
Ëv–
) const

847 
boŞ
 
	g·ss
 = 
G‘Ab¡¿ùGroupP¬am‘”s
().
V®id©e
(
ºg
, 
Ëv–
);

848 
	g·ss
 = 
·ss
 && 
G‘Ab¡¿ùGroupP¬am‘”s
().
V®id©eEËm’t
(
Ëv–
, 
this
->
G‘PublicEËm’t
(), &
G‘PublicP»computiÚ
());

849  
	g·ss
;

852 
boŞ
 
G‘VoidV®ue
(cÚ¡ *
Çme
, cÚ¡ 
¡d
::
ty³_šfo
 &
v®ueTy³
, *
pV®ue
) const

854  
	gG‘V®ueH–³r
<
	gDL_PublicKey
<
	gEËm’t
> >(
	gthis
, 
	gÇme
, 
	gv®ueTy³
, 
	gpV®ue
).
AssigÇbË
();

857 
AssignFrom
(cÚ¡ 
NameV®uePaœs
 &
sourû
)

859 
	gAssignFromH–³r
<
	gDL_PublicKey
<
	gEËm’t
> >(
	gthis
, 
	gsourû
);

862 
boŞ
 
SuµÜtsP»computiÚ
(ècÚ¡ { 
	gŒue
;}

864 
P»compu‹
(
´ecomputiÚStÜage
=16)

866 
AcûssAb¡¿ùGroupP¬am‘”s
().
P»compu‹
(
´ecomputiÚStÜage
);

867 
AcûssPublicP»computiÚ
().
P»compu‹
(
G‘Ab¡¿ùGroupP¬am‘”s
().
G‘GroupP»computiÚ
(), G‘Ab¡¿ùGroupP¬am‘”s().
G‘SubgroupOrd”
().
B™CouÁ
(), 
´ecomputiÚStÜage
);

870 
LßdP»computiÚ
(
Bufã»dT¿nsfÜm©iÚ
 &
¡ÜedP»computiÚ
)

872 
AcûssAb¡¿ùGroupP¬am‘”s
().
LßdP»computiÚ
(
¡ÜedP»computiÚ
);

873 
AcûssPublicP»computiÚ
().
Lßd
(
G‘Ab¡¿ùGroupP¬am‘”s
().
G‘GroupP»computiÚ
(), 
¡ÜedP»computiÚ
);

876 
SaveP»computiÚ
(
Bufã»dT¿nsfÜm©iÚ
 &
¡ÜedP»computiÚ
) const

878 
G‘Ab¡¿ùGroupP¬am‘”s
().
SaveP»computiÚ
(
¡ÜedP»computiÚ
);

879 
G‘PublicP»computiÚ
().
Save
(
G‘Ab¡¿ùGroupP¬am‘”s
().
G‘GroupP»computiÚ
(), 
¡ÜedP»computiÚ
);

883 cÚ¡ 
	gDL_GroupP¬am‘”s
<
	gEËm’t
> & 
G‘Ab¡¿ùGroupP¬am‘”s
(ècÚ¡ { 
	gthis
->
G‘GroupP¬am‘”s
();}

884 
	gDL_GroupP¬am‘”s
<
	gEËm’t
> & 
AcûssAb¡¿ùGroupP¬am‘”s
(è{ 
	gthis
->
AcûssGroupP¬am‘”s
();}

887 cÚ¡ 
	gDL_FixedBa£P»computiÚ
<
	gEËm’t
> & 
G‘PublicP»computiÚ
(ècÚ¡ { 
	gm_ypc
;}

888 
	gDL_FixedBa£P»computiÚ
<
	gEËm’t
> & 
AcûssPublicP»computiÚ
(è{ 
	gm_ypc
;}

891 
boŞ
 
	gİ”©Ü
==(cÚ¡ 
DL_PublicKeyIm¶
<
GP
> &
rhs
) const

892 { 
this
->
G‘GroupP¬am‘”s
(è=ğ
rhs
.G‘GroupP¬am‘”s(è&&his->
G‘PublicEËm’t
() ==„hs.GetPublicElement();}

894 
	g´iv©e
:

895 
ty³Çme
 
GP
::
Ba£P»computiÚ
 
m_ypc
;

899 
	g‹m¶©e
 <
şass
 
	gT
>

900 şas 
	cCRYPTOPP_NO_VTABLE
 
	mDL_Elgam®LikeSigÇtu»AlgÜ™hm


902 
	mpublic
:

903 
vœtu®
 
Sign
(cÚ¡ 
DL_GroupP¬am‘”s
<
T
> &
·¿ms
, cÚ¡ 
IÁeg”
 &
´iv©eKey
, cÚ¡ IÁeg” &
k
, cÚ¡ IÁeg” &
e
, IÁeg” &
r
, IÁeg” &
s
) const =0;

904 
vœtu®
 
boŞ
 
V”ify
(cÚ¡ 
DL_GroupP¬am‘”s
<
T
> &
·¿ms
, cÚ¡ 
DL_PublicKey
<T> &
publicKey
, cÚ¡ 
IÁeg”
 &
e
, cÚ¡ IÁeg” &
r
, cÚ¡ IÁeg” &
s
) const =0;

905 
vœtu®
 
IÁeg”
 
Recov”P»sigÇtu»
(cÚ¡ 
DL_GroupP¬am‘”s
<
T
> &
·¿ms
, cÚ¡ 
DL_PublicKey
<T> &
publicKey
, cÚ¡ IÁeg” &
r
, cÚ¡ IÁeg” &
s
) const

906 {
throw
 
NÙIm¶em’‹d
("DL_ElgamalLikeSignatureAlgorithm:his signature scheme does‚ot support message„ecovery");}

907 
vœtu®
 
size_t
 
RL’
(cÚ¡ 
DL_GroupP¬am‘”s
<
T
> &
·¿ms
) const

908 { 
	g·¿ms
.
G‘SubgroupOrd”
().
By‹CouÁ
();}

909 
vœtu®
 
size_t
 
SL’
(cÚ¡ 
DL_GroupP¬am‘”s
<
T
> &
·¿ms
) const

910 { 
	g·¿ms
.
G‘SubgroupOrd”
().
By‹CouÁ
();}

914 
	g‹m¶©e
 <
şass
 
	gT
>

915 şas 
	cCRYPTOPP_NO_VTABLE
 
	mDL_KeyAg»em’tAlgÜ™hm


917 
	mpublic
:

918 
T
 
	tEËm’t
;

920 
vœtu®
 
EËm’t
 
Ag»eW™hEphem”®Priv©eKey
(cÚ¡ 
DL_GroupP¬am‘”s
<EËm’t> &
·¿ms
, cÚ¡ 
DL_FixedBa£P»computiÚ
<EËm’t> &
publicP»computiÚ
, cÚ¡ 
IÁeg”
 &
´iv©eExpÚ’t
) const =0;

921 
vœtu®
 
EËm’t
 
Ag»eW™hSticPriv©eKey
(cÚ¡ 
DL_GroupP¬am‘”s
<EËm’t> &
·¿ms
, cÚ¡ EËm’ˆ&
publicEËm’t
, 
boŞ
 
v®id©eOth”PublicKey
, cÚ¡ 
IÁeg”
 &
´iv©eExpÚ’t
) const =0;

925 
	g‹m¶©e
 <
şass
 
	gT
>

926 şas 
	cCRYPTOPP_NO_VTABLE
 
	mDL_KeyD”iv©iÚAlgÜ™hm


928 
	mpublic
:

929 
vœtu®
 
boŞ
 
	$P¬am‘”SuµÜ‹d
(cÚ¡ *
Çme
ècÚ¡ { 
çl£
;}

930 
vœtu®
 
	`D”ive
(cÚ¡ 
DL_GroupP¬am‘”s
<
T
> &
groupP¬ams
, 
by‹
 *
d”ivedKey
, 
size_t
 
d”ivedL’gth
, cÚ¡ T &
ag»edEËm’t
, cÚ¡ T &
•hem”®PublicKey
, cÚ¡ 
NameV®uePaœs
 &
d”iv©iÚP¬ams
) const =0;

931 
	}
};

934 şas 
	cCRYPTOPP_NO_VTABLE
 
	mDL_Symm‘ricEnüy±iÚAlgÜ™hm


936 
	mpublic
:

937 
vœtu®
 
boŞ
 
	$P¬am‘”SuµÜ‹d
(cÚ¡ *
Çme
ècÚ¡ { 
çl£
;}

938 
vœtu®
 
size_t
 
	$G‘Symm‘ricKeyL’gth
(
size_t
 
¶aš‹xtL’gth
) const =0;

939 
vœtu®
 
size_t
 
	$G‘Symm‘ricCh”‹xtL’gth
(
size_t
 
¶aš‹xtL’gth
) const =0;

940 
vœtu®
 
size_t
 
	$G‘MaxSymm‘ricPÏš‹xtL’gth
(
size_t
 
ch”‹xtL’gth
) const =0;

941 
vœtu®
 
	$Symm‘ricEnüy±
(
RªdomNumb”G’”©Ü
 &
ºg
, cÚ¡ 
by‹
 *
key
, cÚ¡ by‹ *
¶aš‹xt
, 
size_t
 
¶aš‹xtL’gth
, by‹ *
ch”‹xt
, cÚ¡ 
NameV®uePaœs
 &
·¿m‘”s
) const =0;

942 
vœtu®
 
DecodšgResuÉ
 
	$Symm‘ricDeüy±
(cÚ¡ 
by‹
 *
key
, cÚ¡ by‹ *
ch”‹xt
, 
size_t
 
ch”‹xtL’gth
, by‹ *
¶aš‹xt
, cÚ¡ 
NameV®uePaœs
 &
·¿m‘”s
) const =0;

943 
	}
};

946 
	g‹m¶©e
 <
şass
 
	gKI
>

947 şas 
	cCRYPTOPP_NO_VTABLE
 
	mDL_Ba£


949 
	m´Ùeùed
:

950 
KI
 
	tKeyIÁ”çû
;

951 
ty³Çme
 
	tKI
::
	tEËm’t
 Element;

953 cÚ¡ 
	mDL_GroupP¬am‘”s
<
	mEËm’t
> & 
	$G‘Ab¡¿ùGroupP¬am‘”s
(ècÚ¡ { 
	`G‘KeyIÁ”çû
().
	`G‘Ab¡¿ùGroupP¬am‘”s
();}

954 
DL_GroupP¬am‘”s
<
EËm’t
> & 
	$AcûssAb¡¿ùGroupP¬am‘”s
(è{ 
	`AcûssKeyIÁ”çû
().
	`AcûssAb¡¿ùGroupP¬am‘”s
();
	}
}

956 
vœtu®
 
	gKeyIÁ”çû
 & 
AcûssKeyIÁ”çû
() =0;

957 
vœtu®
 cÚ¡ 
	gKeyIÁ”çû
 & 
	$G‘KeyIÁ”çû
() const =0;

958 
	}
};

961 
	g‹m¶©e
 <
şass
 
	gINTERFACE
, cÏs 
	gKEY_INTERFACE
>

962 
şass
 
CRYPTOPP_NO_VTABLE
 
	gDL_SigÇtu»SchemeBa£
 : 
public
 
INTERFACE
,…ubliø
	gDL_Ba£
<
	gKEY_INTERFACE
>

964 
	gpublic
:

965 
size_t
 
SigÇtu»L’gth
() const

967  
G‘SigÇtu»AlgÜ™hm
().
RL’
(
this
->
G‘Ab¡¿ùGroupP¬am‘”s
())

968 + 
G‘SigÇtu»AlgÜ™hm
().
SL’
(
this
->
G‘Ab¡¿ùGroupP¬am‘”s
());

970 
size_t
 
MaxRecov”abËL’gth
() const

971 { 
G‘Mes§geEncodšgIÁ”çû
().
MaxRecov”abËL’gth
(0, 
G‘HashId’tif›r
().
£cÚd
, 
G‘Dige¡Size
());}

972 
size_t
 
MaxRecov”abËL’gthFromSigÇtu»L’gth
(size_ˆ
sigÇtu»L’gth
) const

973 {
as£¹
(
çl£
);  0;}

975 
boŞ
 
IsProbabi¡ic
() const

976 { 
	gŒue
;}

977 
boŞ
 
AÎowNÚ»cov”abËP¬t
() const

978 { 
G‘Mes§geEncodšgIÁ”çû
().
AÎowNÚ»cov”abËP¬t
();}

979 
boŞ
 
Recov”abËP¬tFœ¡
() const

980 { 
G‘Mes§geEncodšgIÁ”çû
().
Recov”abËP¬tFœ¡
();}

982 
	g´Ùeùed
:

983 
size_t
 
Mes§geR•»£Á©iveL’gth
(ècÚ¡ { 
B™sToBy‹s
(
Mes§geR•»£Á©iveB™L’gth
());}

984 
size_t
 
Mes§geR•»£Á©iveB™L’gth
(ècÚ¡ { 
	gthis
->
G‘Ab¡¿ùGroupP¬am‘”s
().
G‘SubgroupOrd”
().
B™CouÁ
();}

986 
vœtu®
 cÚ¡ 
	gDL_Elgam®LikeSigÇtu»AlgÜ™hm
<
CPP_TYPENAME
 
	gKEY_INTERFACE
::
EËm’t
> & 
G‘SigÇtu»AlgÜ™hm
() const =0;

987 
vœtu®
 cÚ¡ 
	gPK_SigÇtu»Mes§geEncodšgM‘hod
 & 
G‘Mes§geEncodšgIÁ”çû
() const =0;

988 
vœtu®
 
HashId’tif›r
 
G‘HashId’tif›r
() const =0;

989 
vœtu®
 
size_t
 
G‘Dige¡Size
() const =0;

993 
	g‹m¶©e
 <
şass
 
	gT
>

994 
şass
 
CRYPTOPP_NO_VTABLE
 
	gDL_SigÃrBa£
 : 
public
 
DL_SigÇtu»SchemeBa£
<
PK_SigÃr
, 
	gDL_Priv©eKey
<
	gT
> >

996 
	gpublic
:

998 
RawSign
(cÚ¡ 
IÁeg”
 &
k
, cÚ¡ IÁeg” &
e
, IÁeg” &
r
, IÁeg” &
s
) const

1000 cÚ¡ 
	gDL_Elgam®LikeSigÇtu»AlgÜ™hm
<
	gT
> &
	g®g
 = 
this
->
G‘SigÇtu»AlgÜ™hm
();

1001 cÚ¡ 
	gDL_GroupP¬am‘”s
<
	gT
> &
	g·¿ms
 = 
this
->
G‘Ab¡¿ùGroupP¬am‘”s
();

1002 cÚ¡ 
	gDL_Priv©eKey
<
	gT
> &
	gkey
 = 
this
->
G‘KeyIÁ”çû
();

1004 
	gr
 = 
·¿ms
.
CÚv”tEËm’tToIÁeg”
Õ¬ams.
ExpÚ’tŸ‹Ba£
(
k
));

1005 
	g®g
.
Sign
(
·¿ms
, 
key
.
G‘Priv©eExpÚ’t
(), 
k
, 
e
, 
r
, 
s
);

1008 
IÅutRecov”abËMes§ge
(
PK_Mes§geAccumuÏtÜ
 &
mes§geAccumuÏtÜ
, cÚ¡ 
by‹
 *
»cov”abËMes§ge
, 
size_t
 
»cov”abËMes§geL’gth
) const

1010 
	gPK_Mes§geAccumuÏtÜBa£
 &
	gma
 = 
¡©ic_ÿ¡
<
PK_Mes§geAccumuÏtÜBa£
 &>(
mes§geAccumuÏtÜ
);

1011 
	gma
.
	gm_»cov”abËMes§ge
.
Assign
(
»cov”abËMes§ge
, 
»cov”abËMes§geL’gth
);

1012 
	gthis
->
G‘Mes§geEncodšgIÁ”çû
().
ProûssRecov”abËMes§ge
(
ma
.
AcûssHash
(),

1013 
»cov”abËMes§ge
, 
»cov”abËMes§geL’gth
,

1014 
ma
.
m_´esigÇtu»
, ma.m_´esigÇtu».
size
(),

1015 
ma
.
m_£misigÇtu»
);

1018 
size_t
 
SignAndRe¡¬t
(
RªdomNumb”G’”©Ü
 &
ºg
, 
PK_Mes§geAccumuÏtÜ
 &
mes§geAccumuÏtÜ
, 
by‹
 *
sigÇtu»
, 
boŞ
 
»¡¬t
) const

1020 
	gthis
->
G‘M©”Ÿl
().
DoQuickSª™yCheck
();

1022 
	gPK_Mes§geAccumuÏtÜBa£
 &
	gma
 = 
¡©ic_ÿ¡
<
PK_Mes§geAccumuÏtÜBa£
 &>(
mes§geAccumuÏtÜ
);

1023 cÚ¡ 
	gDL_Elgam®LikeSigÇtu»AlgÜ™hm
<
	gT
> &
	g®g
 = 
this
->
G‘SigÇtu»AlgÜ™hm
();

1024 cÚ¡ 
	gDL_GroupP¬am‘”s
<
	gT
> &
	g·¿ms
 = 
this
->
G‘Ab¡¿ùGroupP¬am‘”s
();

1025 cÚ¡ 
	gDL_Priv©eKey
<
	gT
> &
	gkey
 = 
this
->
G‘KeyIÁ”çû
();

1027 
SecBy‹Block
 
»´e£Á©ive
(
this
->
Mes§geR•»£Á©iveL’gth
());

1028 
	gthis
->
G‘Mes§geEncodšgIÁ”çû
().
Compu‹Mes§geR•»£Á©ive
(

1029 
ºg
,

1030 
ma
.
m_»cov”abËMes§ge
, ma.m_»cov”abËMes§ge.
size
(),

1031 
ma
.
AcûssHash
(), 
this
->
G‘HashId’tif›r
(), ma.
m_em±y
,

1032 
»´e£Á©ive
, 
this
->
Mes§geR•»£Á©iveB™L’gth
());

1033 
	gma
.
	gm_em±y
 = 
Œue
;

1034 
IÁeg”
 
e
(
»´e£Á©ive
,„•»£Á©ive.
size
());

1038 ià(
	gºg
.
CªIncÜpÜ©eEÁrİy
())

1039 
	gºg
.
IncÜpÜ©eEÁrİy
(
»´e£Á©ive
,„•»£Á©ive.
size
());

1040 
IÁeg”
 
k
(
ºg
, 1, 
·¿ms
.
G‘SubgroupOrd”
()-1);

1041 
IÁeg”
 
	gr
, 
	gs
;

1042 
	gr
 = 
·¿ms
.
CÚv”tEËm’tToIÁeg”
Õ¬ams.
ExpÚ’tŸ‹Ba£
(
k
));

1043 
	g®g
.
Sign
(
·¿ms
, 
key
.
G‘Priv©eExpÚ’t
(), 
k
, 
e
, 
r
, 
s
);

1054 
size_t
 
	grL’
 = 
®g
.
RL’
(
·¿ms
);

1055 
	gr
.
Encode
(
sigÇtu»
, 
rL’
);

1056 
	gs
.
Encode
(
sigÇtu»
+
rL’
, 
®g
.
SL’
(
·¿ms
));

1058 ià(
	g»¡¬t
)

1059 
Re¡¬tMes§geAccumuÏtÜ
(
ºg
, 
ma
);

1061  
	gthis
->
SigÇtu»L’gth
();

1064 
	g´Ùeùed
:

1065 
Re¡¬tMes§geAccumuÏtÜ
(
RªdomNumb”G’”©Ü
 &
ºg
, 
PK_Mes§geAccumuÏtÜBa£
 &
ma
) const

1082 
	g‹m¶©e
 <
şass
 
	gT
>

1083 
şass
 
CRYPTOPP_NO_VTABLE
 
	gDL_V”if›rBa£
 : 
public
 
DL_SigÇtu»SchemeBa£
<
PK_V”if›r
, 
	gDL_PublicKey
<
	gT
> >

1085 
	gpublic
:

1086 
IÅutSigÇtu»
(
PK_Mes§geAccumuÏtÜ
 &
mes§geAccumuÏtÜ
, cÚ¡ 
by‹
 *
sigÇtu»
, 
size_t
 
sigÇtu»L’gth
) const

1088 
	gPK_Mes§geAccumuÏtÜBa£
 &
	gma
 = 
¡©ic_ÿ¡
<
PK_Mes§geAccumuÏtÜBa£
 &>(
mes§geAccumuÏtÜ
);

1089 cÚ¡ 
	gDL_Elgam®LikeSigÇtu»AlgÜ™hm
<
	gT
> &
	g®g
 = 
this
->
G‘SigÇtu»AlgÜ™hm
();

1090 cÚ¡ 
	gDL_GroupP¬am‘”s
<
	gT
> &
	g·¿ms
 = 
this
->
G‘Ab¡¿ùGroupP¬am‘”s
();

1092 
size_t
 
	grL’
 = 
®g
.
RL’
(
·¿ms
);

1093 
	gma
.
	gm_£misigÇtu»
.
Assign
(
sigÇtu»
, 
rL’
);

1094 
	gma
.
	gm_s
.
Decode
(
sigÇtu»
+
rL’
, 
®g
.
SL’
(
·¿ms
));

1096 
	gthis
->
G‘Mes§geEncodšgIÁ”çû
().
ProûssSemisigÇtu»
(
ma
.
AcûssHash
(), ma.
m_£misigÇtu»
, ma.m_£misigÇtu».
size
());

1099 
boŞ
 
V”ifyAndRe¡¬t
(
PK_Mes§geAccumuÏtÜ
 &
mes§geAccumuÏtÜ
) const

1101 
	gthis
->
G‘M©”Ÿl
().
DoQuickSª™yCheck
();

1103 
	gPK_Mes§geAccumuÏtÜBa£
 &
	gma
 = 
¡©ic_ÿ¡
<
PK_Mes§geAccumuÏtÜBa£
 &>(
mes§geAccumuÏtÜ
);

1104 cÚ¡ 
	gDL_Elgam®LikeSigÇtu»AlgÜ™hm
<
	gT
> &
	g®g
 = 
this
->
G‘SigÇtu»AlgÜ™hm
();

1105 cÚ¡ 
	gDL_GroupP¬am‘”s
<
	gT
> &
	g·¿ms
 = 
this
->
G‘Ab¡¿ùGroupP¬am‘”s
();

1106 cÚ¡ 
	gDL_PublicKey
<
	gT
> &
	gkey
 = 
this
->
G‘KeyIÁ”çû
();

1108 
SecBy‹Block
 
»´e£Á©ive
(
this
->
Mes§geR•»£Á©iveL’gth
());

1109 
	gthis
->
G‘Mes§geEncodšgIÁ”çû
().
Compu‹Mes§geR•»£Á©ive
(
NuÎRNG
(), 
ma
.
m_»cov”abËMes§ge
, ma.m_»cov”abËMes§ge.
size
(),

1110 
ma
.
AcûssHash
(), 
this
->
G‘HashId’tif›r
(), ma.
m_em±y
,

1111 
»´e£Á©ive
, 
this
->
Mes§geR•»£Á©iveB™L’gth
());

1112 
	gma
.
	gm_em±y
 = 
Œue
;

1113 
IÁeg”
 
e
(
»´e£Á©ive
,„•»£Á©ive.
size
());

1115 
IÁeg”
 
r
(
ma
.
m_£misigÇtu»
, ma.m_£misigÇtu».
size
());

1116  
	g®g
.
V”ify
(
·¿ms
, 
key
, 
e
, 
r
, 
ma
.
m_s
);

1119 
DecodšgResuÉ
 
Recov”AndRe¡¬t
(
by‹
 *
»cov”edMes§ge
, 
PK_Mes§geAccumuÏtÜ
 &
mes§geAccumuÏtÜ
) const

1121 
	gthis
->
G‘M©”Ÿl
().
DoQuickSª™yCheck
();

1123 
	gPK_Mes§geAccumuÏtÜBa£
 &
	gma
 = 
¡©ic_ÿ¡
<
PK_Mes§geAccumuÏtÜBa£
 &>(
mes§geAccumuÏtÜ
);

1124 cÚ¡ 
	gDL_Elgam®LikeSigÇtu»AlgÜ™hm
<
	gT
> &
	g®g
 = 
this
->
G‘SigÇtu»AlgÜ™hm
();

1125 cÚ¡ 
	gDL_GroupP¬am‘”s
<
	gT
> &
	g·¿ms
 = 
this
->
G‘Ab¡¿ùGroupP¬am‘”s
();

1126 cÚ¡ 
	gDL_PublicKey
<
	gT
> &
	gkey
 = 
this
->
G‘KeyIÁ”çû
();

1128 
SecBy‹Block
 
»´e£Á©ive
(
this
->
Mes§geR•»£Á©iveL’gth
());

1129 
	gthis
->
G‘Mes§geEncodšgIÁ”çû
().
Compu‹Mes§geR•»£Á©ive
(

1130 
NuÎRNG
(),

1131 
ma
.
m_»cov”abËMes§ge
, ma.m_»cov”abËMes§ge.
size
(),

1132 
ma
.
AcûssHash
(), 
this
->
G‘HashId’tif›r
(), ma.
m_em±y
,

1133 
»´e£Á©ive
, 
this
->
Mes§geR•»£Á©iveB™L’gth
());

1134 
	gma
.
	gm_em±y
 = 
Œue
;

1135 
IÁeg”
 
e
(
»´e£Á©ive
,„•»£Á©ive.
size
());

1137 
	gma
.
	gm_´esigÇtu»
.
New
(
·¿ms
.
G‘EncodedEËm’tSize
(
çl£
));

1138 
IÁeg”
 
r
(
ma
.
m_£misigÇtu»
, ma.m_£misigÇtu».
size
());

1139 
	g®g
.
Recov”P»sigÇtu»
(
·¿ms
, 
key
, 
r
, 
ma
.
m_s
).
Encode
(ma.
m_´esigÇtu»
, ma.m_´esigÇtu».
size
());

1141  
	gthis
->
G‘Mes§geEncodšgIÁ”çû
().
Recov”Mes§geFromSemisigÇtu»
(

1142 
ma
.
AcûssHash
(), 
this
->
G‘HashId’tif›r
(),

1143 
ma
.
m_´esigÇtu»
, ma.m_´esigÇtu».
size
(),

1144 
ma
.
m_£misigÇtu»
, ma.m_£misigÇtu».
size
(),

1145 
»cov”edMes§ge
);

1150 
	g‹m¶©e
 <
şass
 
	gPK
, cÏs 
	gKI
>

1151 
şass
 
CRYPTOPP_NO_VTABLE
 
	gDL_Cry±oSy¡emBa£
 : 
public
 
PK
,…ubliø
	gDL_Ba£
<
	gKI
>

1153 
	gpublic
:

1154 
ty³Çme
 
	tDL_Ba£
<
	tKI
>::
	tEËm’t
 Element;

1156 
size_t
 
MaxPÏš‹xtL’gth
(size_ˆ
ch”‹xtL’gth
) const

1158 
	gmšL’
 = 
this
->
G‘Ab¡¿ùGroupP¬am‘”s
().
G‘EncodedEËm’tSize
(
Œue
);

1159  
	gch”‹xtL’gth
 < 
	gmšL’
 ? 0 : 
G‘Symm‘ricEnüy±iÚAlgÜ™hm
().
G‘MaxSymm‘ricPÏš‹xtL’gth
(
ch”‹xtL’gth
 - 
mšL’
);

1162 
size_t
 
Ch”‹xtL’gth
(size_ˆ
¶aš‹xtL’gth
) const

1164 
size_t
 
	gËn
 = 
G‘Symm‘ricEnüy±iÚAlgÜ™hm
().
G‘Symm‘ricCh”‹xtL’gth
(
¶aš‹xtL’gth
);

1165  
	gËn
 =ğ0 ? 0 : 
this
->
G‘Ab¡¿ùGroupP¬am‘”s
().
G‘EncodedEËm’tSize
(
Œue
è+ 
Ën
;

1168 
boŞ
 
P¬am‘”SuµÜ‹d
(cÚ¡ *
Çme
) const

1169 { 
G‘KeyD”iv©iÚAlgÜ™hm
().
P¬am‘”SuµÜ‹d
(
Çme
è|| 
G‘Symm‘ricEnüy±iÚAlgÜ™hm
().ParameterSupported(name);}

1171 
	g´Ùeùed
:

1172 
vœtu®
 cÚ¡ 
DL_KeyAg»em’tAlgÜ™hm
<
EËm’t
> & 
G‘KeyAg»em’tAlgÜ™hm
() const =0;

1173 
vœtu®
 cÚ¡ 
	gDL_KeyD”iv©iÚAlgÜ™hm
<
	gEËm’t
> & 
G‘KeyD”iv©iÚAlgÜ™hm
() const =0;

1174 
vœtu®
 cÚ¡ 
	gDL_Symm‘ricEnüy±iÚAlgÜ™hm
 & 
G‘Symm‘ricEnüy±iÚAlgÜ™hm
() const =0;

1178 
	g‹m¶©e
 <
şass
 
	gT
>

1179 
şass
 
CRYPTOPP_NO_VTABLE
 
	gDL_Deüy±ÜBa£
 : 
public
 
DL_Cry±oSy¡emBa£
<
PK_Deüy±Ü
, 
	gDL_Priv©eKey
<
	gT
> >

1181 
	gpublic
:

1182 
T
 
	tEËm’t
;

1184 
DecodšgResuÉ
 
Deüy±
(
RªdomNumb”G’”©Ü
 &
ºg
, cÚ¡ 
by‹
 *
ch”‹xt
, 
size_t
 
ch”‹xtL’gth
, by‹ *
¶aš‹xt
, cÚ¡ 
NameV®uePaœs
 &
·¿m‘”s
 = 
g_nuÎNameV®uePaœs
) const

1186 
Œy


1188 cÚ¡ 
DL_KeyAg»em’tAlgÜ™hm
<
T
> &
ag»eAlg
 = 
this
->
G‘KeyAg»em’tAlgÜ™hm
();

1189 cÚ¡ 
	gDL_KeyD”iv©iÚAlgÜ™hm
<
	gT
> &
	gd”ivAlg
 = 
this
->
G‘KeyD”iv©iÚAlgÜ™hm
();

1190 cÚ¡ 
	gDL_Symm‘ricEnüy±iÚAlgÜ™hm
 &
	g’cAlg
 = 
this
->
G‘Symm‘ricEnüy±iÚAlgÜ™hm
();

1191 cÚ¡ 
	gDL_GroupP¬am‘”s
<
	gT
> &
	g·¿ms
 = 
this
->
G‘Ab¡¿ùGroupP¬am‘”s
();

1192 cÚ¡ 
	gDL_Priv©eKey
<
	gT
> &
	gkey
 = 
this
->
G‘KeyIÁ”çû
();

1194 
EËm’t
 
	gq
 = 
·¿ms
.
DecodeEËm’t
(
ch”‹xt
, 
Œue
);

1195 
size_t
 
	g–em’tSize
 = 
·¿ms
.
G‘EncodedEËm’tSize
(
Œue
);

1196 
	gch”‹xt
 +ğ
–em’tSize
;

1197 
	gch”‹xtL’gth
 -ğ
–em’tSize
;

1199 
EËm’t
 
	gz
 = 
ag»eAlg
.
Ag»eW™hSticPriv©eKey
(
·¿ms
, 
q
, 
Œue
, 
key
.
G‘Priv©eExpÚ’t
());

1201 
SecBy‹Block
 
d”ivedKey
(
’cAlg
.
G‘Symm‘ricKeyL’gth
ÓncAlg.
G‘MaxSymm‘ricPÏš‹xtL’gth
(
ch”‹xtL’gth
)));

1202 
	gd”ivAlg
.
D”ive
(
·¿ms
, 
d”ivedKey
, d”ivedKey.
size
(), 
z
, 
q
, 
·¿m‘”s
);

1204  
	g’cAlg
.
Symm‘ricDeüy±
(
d”ivedKey
, 
ch”‹xt
, 
ch”‹xtL’gth
, 
¶aš‹xt
, 
·¿m‘”s
);

1206 
ÿtch
 (
DL_BadEËm’t
 &)

1208  
DecodšgResuÉ
();

1214 
	g‹m¶©e
 <
şass
 
	gT
>

1215 
şass
 
CRYPTOPP_NO_VTABLE
 
	gDL_Enüy±ÜBa£
 : 
public
 
DL_Cry±oSy¡emBa£
<
PK_Enüy±Ü
, 
	gDL_PublicKey
<
	gT
> >

1217 
	gpublic
:

1218 
T
 
	tEËm’t
;

1220 
Enüy±
(
RªdomNumb”G’”©Ü
 &
ºg
, cÚ¡ 
by‹
 *
¶aš‹xt
, 
size_t
 
¶aš‹xtL’gth
, by‹ *
ch”‹xt
, cÚ¡ 
NameV®uePaœs
 &
·¿m‘”s
 = 
g_nuÎNameV®uePaœs
) const

1222 cÚ¡ 
DL_KeyAg»em’tAlgÜ™hm
<
T
> &
ag»eAlg
 = 
this
->
G‘KeyAg»em’tAlgÜ™hm
();

1223 cÚ¡ 
	gDL_KeyD”iv©iÚAlgÜ™hm
<
	gT
> &
	gd”ivAlg
 = 
this
->
G‘KeyD”iv©iÚAlgÜ™hm
();

1224 cÚ¡ 
	gDL_Symm‘ricEnüy±iÚAlgÜ™hm
 &
	g’cAlg
 = 
this
->
G‘Symm‘ricEnüy±iÚAlgÜ™hm
();

1225 cÚ¡ 
	gDL_GroupP¬am‘”s
<
	gT
> &
	g·¿ms
 = 
this
->
G‘Ab¡¿ùGroupP¬am‘”s
();

1226 cÚ¡ 
	gDL_PublicKey
<
	gT
> &
	gkey
 = 
this
->
G‘KeyIÁ”çû
();

1228 
IÁeg”
 
x
(
ºg
, IÁeg”::
OÃ
(), 
·¿ms
.
G‘MaxExpÚ’t
());

1229 
EËm’t
 
	gq
 = 
·¿ms
.
ExpÚ’tŸ‹Ba£
(
x
);

1230 
	g·¿ms
.
EncodeEËm’t
(
Œue
, 
q
, 
ch”‹xt
);

1231 
	g–em’tSize
 = 
·¿ms
.
G‘EncodedEËm’tSize
(
Œue
);

1232 
	gch”‹xt
 +ğ
–em’tSize
;

1234 
EËm’t
 
	gz
 = 
ag»eAlg
.
Ag»eW™hEphem”®Priv©eKey
(
·¿ms
, 
key
.
G‘PublicP»computiÚ
(), 
x
);

1236 
SecBy‹Block
 
d”ivedKey
(
’cAlg
.
G‘Symm‘ricKeyL’gth
(
¶aš‹xtL’gth
));

1237 
	gd”ivAlg
.
D”ive
(
·¿ms
, 
d”ivedKey
, d”ivedKey.
size
(), 
z
, 
q
, 
·¿m‘”s
);

1239 
	g’cAlg
.
Symm‘ricEnüy±
(
ºg
, 
d”ivedKey
, 
¶aš‹xt
, 
¶aš‹xtL’gth
, 
ch”‹xt
, 
·¿m‘”s
);

1244 
	g‹m¶©e
 <
şass
 
	gT1
, cÏs 
	gT2
>

1245 
	sDL_SchemeO±iÚsBa£


1247 
T1
 
	tAlgÜ™hmInfo
;

1248 
T2
 
	tGroupP¬am‘”s
;

1249 
ty³Çme
 
	tGroupP¬am‘”s
::
	tEËm’t
 Element;

1253 
	g‹m¶©e
 <
şass
 
	gT1
, cÏs 
	gT2
>

1254 
	gDL_KeyedSchemeO±iÚs
 : 
public
 
DL_SchemeO±iÚsBa£
<
T1
, 
ty³Çme
 
	gT2
::
PublicKey
::
GroupP¬am‘”s
>

1256 
T2
 
	tKeys
;

1257 
ty³Çme
 
	tKeys
::
	tPriv©eKey
 PrivateKey;

1258 
ty³Çme
 
	tKeys
::
	tPublicKey
 PublicKey;

1262 
	g‹m¶©e
 <
şass
 
	gT1
, cÏs 
	gT2
, cÏs 
	gT3
, cÏs 
	gT4
, cÏs 
	gT5
>

1263 
	gDL_SigÇtu»SchemeO±iÚs
 : 
public
 
DL_KeyedSchemeO±iÚs
<
T1
, 
	gT2
>

1265 
T3
 
	tSigÇtu»AlgÜ™hm
;

1266 
T4
 
	tMes§geEncodšgM‘hod
;

1267 
T5
 
	tHashFunùiÚ
;

1271 
	g‹m¶©e
 <
şass
 
	gT1
, cÏs 
	gT2
, cÏs 
	gT3
, cÏs 
	gT4
, cÏs 
	gT5
>

1272 
	gDL_Cry±oSchemeO±iÚs
 : 
public
 
DL_KeyedSchemeO±iÚs
<
T1
, 
	gT2
>

1274 
T3
 
	tKeyAg»em’tAlgÜ™hm
;

1275 
T4
 
	tKeyD”iv©iÚAlgÜ™hm
;

1276 
T5
 
	tSymm‘ricEnüy±iÚAlgÜ™hm
;

1280 
	g‹m¶©e
 <
şass
 
	gBASE
, cÏs 
	gSCHEME_OPTIONS
, cÏs 
	gKEY
>

1281 
şass
 
CRYPTOPP_NO_VTABLE
 
	gDL_ObjeùIm¶Ba£
 : 
public
 
AlgÜ™hmIm¶
<
BASE
, 
ty³Çme
 
	gSCHEME_OPTIONS
::
AlgÜ™hmInfo
>

1283 
public
:

1284 
SCHEME_OPTIONS
 
	tSchemeO±iÚs
;

1285 
ty³Çme
 
	tKEY
::
	tEËm’t
 Element;

1287 
	gPriv©eKey
 & 
AcûssPriv©eKey
(è{ 
	gm_key
;}

1288 
	gPublicKey
 & 
AcûssPublicKey
(è{ 
	gm_key
;}

1291 cÚ¡ 
	gKEY
 & 
G‘Key
(ècÚ¡ { 
	gm_key
;}

1292 
	gKEY
 & 
AcûssKey
(è{ 
	gm_key
;}

1294 
	g´Ùeùed
:

1295 
ty³Çme
 
BASE
::
KeyIÁ”çû
 & 
AcûssKeyIÁ”çû
(è{ 
m_key
;}

1296 cÚ¡ 
ty³Çme
 
	gBASE
::
KeyIÁ”çû
 & 
G‘KeyIÁ”çû
(ècÚ¡ { 
m_key
;}

1299 
HashId’tif›r
 
G‘HashId’tif›r
() const

1301 
ty³Çme
 
	tSchemeO±iÚs
::
	tMes§geEncodšgM‘hod
::
	tHashId’tif›rLookup
 
	tHashLookup
;

1302  
	gHashLookup
::
‹m¶©e
 
HashId’tif›rLookup2
<
CPP_TYPENAME
 
SchemeO±iÚs
::
HashFunùiÚ
>::
Lookup
();

1304 
size_t
 
G‘Dige¡Size
() const

1306 
CPP_TYPENAME
 
	tSchemeO±iÚs
::
	tHashFunùiÚ
 
	tH
;

1307  
	gH
::
DIGESTSIZE
;

1310 
	g´iv©e
:

1311 
KEY
 
m_key
;

1315 
	g‹m¶©e
 <
şass
 
	gBASE
, cÏs 
	gSCHEME_OPTIONS
, cÏs 
	gKEY
>

1316 
şass
 
CRYPTOPP_NO_VTABLE
 
	gDL_ObjeùIm¶
 : 
public
 
DL_ObjeùIm¶Ba£
<
BASE
, 
	gSCHEME_OPTIONS
, 
	gKEY
>

1318 
	gpublic
:

1319 
ty³Çme
 
	tKEY
::
	tEËm’t
 Element;

1321 
	g´Ùeùed
:

1322 cÚ¡ 
DL_Elgam®LikeSigÇtu»AlgÜ™hm
<
EËm’t
> & 
G‘SigÇtu»AlgÜ™hm
() const

1323 { 
SšgËtÚ
<
CPP_TYPENAME
 
SCHEME_OPTIONS
::
SigÇtu»AlgÜ™hm
>().
Ref
();}

1324 cÚ¡ 
	gDL_KeyAg»em’tAlgÜ™hm
<
	gEËm’t
> & 
G‘KeyAg»em’tAlgÜ™hm
() const

1325 { 
	gSšgËtÚ
<
CPP_TYPENAME
 
	gSCHEME_OPTIONS
::
KeyAg»em’tAlgÜ™hm
>().
Ref
();}

1326 cÚ¡ 
	gDL_KeyD”iv©iÚAlgÜ™hm
<
	gEËm’t
> & 
G‘KeyD”iv©iÚAlgÜ™hm
() const

1327 { 
	gSšgËtÚ
<
CPP_TYPENAME
 
	gSCHEME_OPTIONS
::
KeyD”iv©iÚAlgÜ™hm
>().
Ref
();}

1328 cÚ¡ 
	gDL_Symm‘ricEnüy±iÚAlgÜ™hm
 & 
G‘Symm‘ricEnüy±iÚAlgÜ™hm
() const

1329 { 
	gSšgËtÚ
<
CPP_TYPENAME
 
	gSCHEME_OPTIONS
::
Symm‘ricEnüy±iÚAlgÜ™hm
>().
Ref
();}

1330 
HashId’tif›r
 
G‘HashId’tif›r
() const

1331 { 
HashId’tif›r
();}

1332 cÚ¡ 
	gPK_SigÇtu»Mes§geEncodšgM‘hod
 & 
G‘Mes§geEncodšgIÁ”çû
() const

1333 { 
	gSšgËtÚ
<
CPP_TYPENAME
 
	gSCHEME_OPTIONS
::
Mes§geEncodšgM‘hod
>().
Ref
();}

1337 
	g‹m¶©e
 <
şass
 
	gSCHEME_OPTIONS
>

1338 
şass
 
	gDL_SigÃrIm¶
 : 
public
 
DL_ObjeùIm¶
<
DL_SigÃrBa£
<
ty³Çme
 
SCHEME_OPTIONS
::
EËm’t
>, 
	gSCHEME_OPTIONS
,y³ÇmSCHEME_OPTIONS::
Priv©eKey
>

1340 
public
:

1341 
PK_Mes§geAccumuÏtÜ
 * 
NewSigÇtu»AccumuÏtÜ
(
RªdomNumb”G’”©Ü
 &
ºg
) const

1343 
¡d
::
auto_±r
<
PK_Mes§geAccumuÏtÜBa£
> 
p
(
Ãw
 
PK_Mes§geAccumuÏtÜIm¶
<
CPP_TYPENAME
 
SCHEME_OPTIONS
::
HashFunùiÚ
>);

1344 
	gthis
->
Re¡¬tMes§geAccumuÏtÜ
(
ºg
, *
p
);

1345  
	gp
.
»Ëa£
();

1350 
	g‹m¶©e
 <
şass
 
	gSCHEME_OPTIONS
>

1351 
şass
 
	gDL_V”if›rIm¶
 : 
public
 
DL_ObjeùIm¶
<
DL_V”if›rBa£
<
ty³Çme
 
SCHEME_OPTIONS
::
EËm’t
>, 
	gSCHEME_OPTIONS
,y³ÇmSCHEME_OPTIONS::
PublicKey
>

1353 
public
:

1354 
PK_Mes§geAccumuÏtÜ
 * 
NewV”ifiÿtiÚAccumuÏtÜ
() const

1356  
Ãw
 
PK_Mes§geAccumuÏtÜIm¶
<
CPP_TYPENAME
 
SCHEME_OPTIONS
::
HashFunùiÚ
>;

1361 
	g‹m¶©e
 <
şass
 
	gSCHEME_OPTIONS
>

1362 
şass
 
	gDL_Enüy±ÜIm¶
 : 
public
 
DL_ObjeùIm¶
<
DL_Enüy±ÜBa£
<
ty³Çme
 
SCHEME_OPTIONS
::
EËm’t
>, 
	gSCHEME_OPTIONS
,y³ÇmSCHEME_OPTIONS::
PublicKey
>

1367 
	g‹m¶©e
 <
şass
 
	gSCHEME_OPTIONS
>

1368 
şass
 
	gDL_Deüy±ÜIm¶
 : 
public
 
DL_ObjeùIm¶
<
DL_Deüy±ÜBa£
<
ty³Çme
 
SCHEME_OPTIONS
::
EËm’t
>, 
	gSCHEME_OPTIONS
,y³ÇmSCHEME_OPTIONS::
Priv©eKey
>

1375 
	g‹m¶©e
 <
şass
 
	gT
>

1376 şas 
	cCRYPTOPP_NO_VTABLE
 
	mDL_Sim¶eKeyAg»em’tDomašBa£
 : 
public
 
Sim¶eKeyAg»em’tDomaš


1378 
public
:

1379 
T
 
	tEËm’t
;

1381 
	mCry±oP¬am‘”s
 & 
	$AcûssCry±oP¬am‘”s
(è{ 
	`AcûssAb¡¿ùGroupP¬am‘”s
();}

1382 
	$Ag»edV®ueL’gth
(ècÚ¡ { 
	`G‘Ab¡¿ùGroupP¬am‘”s
().
	`G‘EncodedEËm’tSize
(
çl£
);
	}
}

1383 
	$Priv©eKeyL’gth
(ècÚ¡ { 
	`G‘Ab¡¿ùGroupP¬am‘”s
().
	`G‘SubgroupOrd”
().
	`By‹CouÁ
();
	}
}

1384 
	$PublicKeyL’gth
(ècÚ¡ { 
	`G‘Ab¡¿ùGroupP¬am‘”s
().
	`G‘EncodedEËm’tSize
(
Œue
);
	}
}

1386 
	$G’”©ePriv©eKey
(
RªdomNumb”G’”©Ü
 &
ºg
, 
by‹
 *
´iv©eKey
) const

1388 
IÁeg”
 
	`x
(
ºg
, IÁeg”::
	`OÃ
(), 
	`G‘Ab¡¿ùGroupP¬am‘”s
().
	`G‘MaxExpÚ’t
());

1389 
x
.
	`Encode
(
´iv©eKey
, 
	`Priv©eKeyL’gth
());

1390 
	}
}

1392 
	$G’”©ePublicKey
(
RªdomNumb”G’”©Ü
 &
ºg
, cÚ¡ 
by‹
 *
´iv©eKey
, by‹ *
publicKey
) const

1394 cÚ¡ 
DL_GroupP¬am‘”s
<
T
> &
·¿ms
 = 
	`G‘Ab¡¿ùGroupP¬am‘”s
();

1395 
IÁeg”
 
	`x
(
´iv©eKey
, 
	`Priv©eKeyL’gth
());

1396 
EËm’t
 
y
 = 
·¿ms
.
	`ExpÚ’tŸ‹Ba£
(
x
);

1397 
·¿ms
.
	`EncodeEËm’t
(
Œue
, 
y
, 
publicKey
);

1398 
	}
}

1400 
boŞ
 
	$Ag»e
(
by‹
 *
ag»edV®ue
, cÚ¡ by‹ *
´iv©eKey
, cÚ¡ by‹ *
Ùh”PublicKey
, 
boŞ
 
v®id©eOth”PublicKey
=
Œue
) const

1402 
Œy


1404 cÚ¡ 
DL_GroupP¬am‘”s
<
T
> &
·¿ms
 = 
	`G‘Ab¡¿ùGroupP¬am‘”s
();

1405 
IÁeg”
 
	`x
(
´iv©eKey
, 
	`Priv©eKeyL’gth
());

1406 
EËm’t
 
w
 = 
·¿ms
.
	`DecodeEËm’t
(
Ùh”PublicKey
, 
v®id©eOth”PublicKey
);

1408 
EËm’t
 
z
 = 
	`G‘KeyAg»em’tAlgÜ™hm
().
	`Ag»eW™hSticPriv©eKey
(

1409 
	`G‘Ab¡¿ùGroupP¬am‘”s
(), 
w
, 
v®id©eOth”PublicKey
, 
x
);

1410 
·¿ms
.
	`EncodeEËm’t
(
çl£
, 
z
, 
ag»edV®ue
);

1412 
	`ÿtch
 (
DL_BadEËm’t
 &)

1414  
çl£
;

1416  
Œue
;

1417 
	}
}

1419 cÚ¡ 
	gEËm’t
 &
	$G‘G’”©Ü
(ècÚ¡ { 
	`G‘Ab¡¿ùGroupP¬am‘”s
().
	`G‘SubgroupG’”©Ü
();
	}
}

1421 
	g´Ùeùed
:

1422 
vœtu®
 cÚ¡ 
DL_KeyAg»em’tAlgÜ™hm
<
EËm’t
> & 
	$G‘KeyAg»em’tAlgÜ™hm
() const =0;

1423 
vœtu®
 
DL_GroupP¬am‘”s
<
EËm’t
> & 
	`AcûssAb¡¿ùGroupP¬am‘”s
() =0;

1424 cÚ¡ 
DL_GroupP¬am‘”s
<
EËm’t
> & 
	$G‘Ab¡¿ùGroupP¬am‘”s
(ècÚ¡ { 
cÚ¡_ÿ¡
<
DL_Sim¶eKeyAg»em’tDomašBa£
<
EËm’t
> *>(
this
)->
	`AcûssAb¡¿ùGroupP¬am‘”s
();
	}
}

1427 
	eCoçùÜMuÉliÿtiÚO±iÚ
 {
	mNO_COFACTOR_MULTIPLICTION
, 
	mCOMPATIBLE_COFACTOR_MULTIPLICTION
, 
	mINCOMPATIBLE_COFACTOR_MULTIPLICTION
};

1428 
	gEnumToTy³
<
	tCoçùÜMuÉliÿtiÚO±iÚ
, 
	tNO_COFACTOR_MULTIPLICTION
> 
	tNoCoçùÜMuÉliÿtiÚ
;

1429 
	gEnumToTy³
<
	tCoçùÜMuÉliÿtiÚO±iÚ
, 
	tCOMPATIBLE_COFACTOR_MULTIPLICTION
> 
	tCom·tibËCoçùÜMuÉliÿtiÚ
;

1430 
	gEnumToTy³
<
	tCoçùÜMuÉliÿtiÚO±iÚ
, 
	tINCOMPATIBLE_COFACTOR_MULTIPLICTION
> 
	tIncom·tibËCoçùÜMuÉliÿtiÚ
;

1433 
	g‹m¶©e
 <
şass
 
	gELEMENT
, cÏs 
	gCOFACTOR_OPTION
>

1434 
şass
 
	gDL_KeyAg»em’tAlgÜ™hm_DH
 : 
public
 
DL_KeyAg»em’tAlgÜ™hm
<
ELEMENT
>

1436 
public
:

1437 
ELEMENT
 
	tEËm’t
;

1439 cÚ¡ * 
CRYPTOPP_API
 
SticAlgÜ™hmName
()

1440 { 
	gCOFACTOR_OPTION
::
ToEnum
(è=ğ
INCOMPATIBLE_COFACTOR_MULTIPLICTION
 ? "DHC" : "DH";}

1442 
EËm’t
 
Ag»eW™hEphem”®Priv©eKey
(cÚ¡ 
DL_GroupP¬am‘”s
<EËm’t> &
·¿ms
, cÚ¡ 
DL_FixedBa£P»computiÚ
<EËm’t> &
publicP»computiÚ
, cÚ¡ 
IÁeg”
 &
´iv©eExpÚ’t
) const

1444  
	gpublicP»computiÚ
.
ExpÚ’tŸ‹
(
·¿ms
.
G‘GroupP»computiÚ
(),

1445 
COFACTOR_OPTION
::
ToEnum
(è=ğ
INCOMPATIBLE_COFACTOR_MULTIPLICTION
 ? 
´iv©eExpÚ’t
*
·¿ms
.
G‘CoçùÜ
() :…rivateExponent);

1448 
EËm’t
 
Ag»eW™hSticPriv©eKey
(cÚ¡ 
DL_GroupP¬am‘”s
<EËm’t> &
·¿ms
, cÚ¡ EËm’ˆ&
publicEËm’t
, 
boŞ
 
v®id©eOth”PublicKey
, cÚ¡ 
IÁeg”
 &
´iv©eExpÚ’t
) const

1450 ià(
	gCOFACTOR_OPTION
::
ToEnum
(è=ğ
COMPATIBLE_COFACTOR_MULTIPLICTION
)

1452 cÚ¡ 
IÁeg”
 &
k
 = 
·¿ms
.
G‘CoçùÜ
();

1453  
	g·¿ms
.
ExpÚ’tŸ‹EËm’t
(
publicEËm’t
,

1454 
ModuÏrAr™hm‘ic
(
·¿ms
.
G‘SubgroupOrd”
()).
Divide
(
´iv©eExpÚ’t
, 
k
)*k);

1456 ià(
	gCOFACTOR_OPTION
::
ToEnum
(è=ğ
INCOMPATIBLE_COFACTOR_MULTIPLICTION
)

1457  
·¿ms
.
ExpÚ’tŸ‹EËm’t
(
publicEËm’t
, 
´iv©eExpÚ’t
*·¿ms.
G‘CoçùÜ
());

1460 
as£¹
(
COFACTOR_OPTION
::
ToEnum
(è=ğ
NO_COFACTOR_MULTIPLICTION
);

1462 ià(!
	gv®id©eOth”PublicKey
)

1463  
	g·¿ms
.
ExpÚ’tŸ‹EËm’t
(
publicEËm’t
, 
´iv©eExpÚ’t
);

1465 ià(
	g·¿ms
.
Fa¡SubgroupCheckAvaabË
())

1467 ià(!
	g·¿ms
.
V®id©eEËm’t
(2, 
publicEËm’t
, 
NULL
))

1468 
throw
 
DL_BadEËm’t
();

1469  
	g·¿ms
.
ExpÚ’tŸ‹EËm’t
(
publicEËm’t
, 
´iv©eExpÚ’t
);

1473 cÚ¡ 
IÁeg”
 
	ge
[2] = {
·¿ms
.
G‘SubgroupOrd”
(), 
´iv©eExpÚ’t
};

1474 
EËm’t
 
	gr
[2];

1475 
	g·¿ms
.
SimuÉªeousExpÚ’tŸ‹
(
r
, 
publicEËm’t
, 
e
, 2);

1476 ià(!
	g·¿ms
.
IsId’t™y
(
r
[0]))

1477 
throw
 
DL_BadEËm’t
();

1478  
	gr
[1];

1487 
	g‹m¶©e
 <
şass
 
	gBASE
>

1488 şas 
	cCRYPTOPP_NO_VTABLE
 
	mPK_Fš®Tem¶©e
 : 
public
 
BASE


1490 
public
:

1491 
	$PK_Fš®Tem¶©e
() {}

1493 
	$PK_Fš®Tem¶©e
(cÚ¡ 
Cry±oM©”Ÿl
 &
key
)

1494 {
this
->
	`AcûssKey
().
	`AssignFrom
(
key
);
	}
}

1496 
	$PK_Fš®Tem¶©e
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
)

1497 {
this
->
	`AcûssKey
().
	`BERDecode
(
bt
);
	}
}

1499 
	$PK_Fš®Tem¶©e
(cÚ¡ 
Asymm‘ricAlgÜ™hm
 &
®gÜ™hm
)

1500 {
this
->
	`AcûssKey
().
	`AssignFrom
(
®gÜ™hm
.
	`G‘M©”Ÿl
());
	}
}

1502 
	$PK_Fš®Tem¶©e
(cÚ¡ 
IÁeg”
 &
v1
)

1503 {
this
->
	`AcûssKey
().
	`In™Ÿlize
(
v1
);
	}
}

1505 #ià(
defšed
(
_MSC_VER
) && _MSC_VER < 1300)

1507 
	g‹m¶©e
 <
şass
 
	gT1
, cÏs 
	gT2
>

1508 
	$PK_Fš®Tem¶©e
(
T1
 &
v1
, 
T2
 &
v2
)

1509 {
this
->
	`AcûssKey
().
	`In™Ÿlize
(
v1
, 
v2
);
	}
}

1511 
	g‹m¶©e
 <
şass
 
	gT1
, cÏs 
	gT2
, cÏs 
	gT3
>

1512 
	$PK_Fš®Tem¶©e
(
T1
 &
v1
, 
T2
 &
v2
, 
T3
 &
v3
)

1513 {
this
->
	`AcûssKey
().
	`In™Ÿlize
(
v1
, 
v2
, 
v3
);
	}
}

1515 
	g‹m¶©e
 <
şass
 
	gT1
, cÏs 
	gT2
, cÏs 
	gT3
, cÏs 
	gT4
>

1516 
	$PK_Fš®Tem¶©e
(
T1
 &
v1
, 
T2
 &
v2
, 
T3
 &
v3
, 
T4
 &
v4
)

1517 {
this
->
	`AcûssKey
().
	`In™Ÿlize
(
v1
, 
v2
, 
v3
, 
v4
);
	}
}

1519 
	g‹m¶©e
 <
şass
 
	gT1
, cÏs 
	gT2
, cÏs 
	gT3
, cÏs 
	gT4
, cÏs 
	gT5
>

1520 
	$PK_Fš®Tem¶©e
(
T1
 &
v1
, 
T2
 &
v2
, 
T3
 &
v3
, 
T4
 &
v4
, 
T5
 &
v5
)

1521 {
this
->
	`AcûssKey
().
	`In™Ÿlize
(
v1
, 
v2
, 
v3
, 
v4
, 
v5
);
	}
}

1523 
	g‹m¶©e
 <
şass
 
	gT1
, cÏs 
	gT2
, cÏs 
	gT3
, cÏs 
	gT4
, cÏs 
	gT5
, cÏs 
	gT6
>

1524 
	$PK_Fš®Tem¶©e
(
T1
 &
v1
, 
T2
 &
v2
, 
T3
 &
v3
, 
T4
 &
v4
, 
T5
 &
v5
, 
T6
 &
v6
)

1525 {
this
->
	`AcûssKey
().
	`In™Ÿlize
(
v1
, 
v2
, 
v3
, 
v4
, 
v5
, 
v6
);
	}
}

1527 
	g‹m¶©e
 <
şass
 
	gT1
, cÏs 
	gT2
, cÏs 
	gT3
, cÏs 
	gT4
, cÏs 
	gT5
, cÏs 
	gT6
, cÏs 
	gT7
>

1528 
	$PK_Fš®Tem¶©e
(
T1
 &
v1
, 
T2
 &
v2
, 
T3
 &
v3
, 
T4
 &
v4
, 
T5
 &
v5
, 
T6
 &
v6
, 
T7
 &
v7
)

1529 {
this
->
	`AcûssKey
().
	`In™Ÿlize
(
v1
, 
v2
, 
v3
, 
v4
, 
v5
, 
v6
, 
v7
);
	}
}

1531 
	g‹m¶©e
 <
şass
 
	gT1
, cÏs 
	gT2
, cÏs 
	gT3
, cÏs 
	gT4
, cÏs 
	gT5
, cÏs 
	gT6
, cÏs 
	gT7
, cÏs 
	gT8
>

1532 
	$PK_Fš®Tem¶©e
(
T1
 &
v1
, 
T2
 &
v2
, 
T3
 &
v3
, 
T4
 &
v4
, 
T5
 &
v5
, 
T6
 &
v6
, 
T7
 &
v7
, 
T8
 &
v8
)

1533 {
this
->
	`AcûssKey
().
	`In™Ÿlize
(
v1
, 
v2
, 
v3
, 
v4
, 
v5
, 
v6
, 
v7
, 
v8
);
	}
}

1537 
	g‹m¶©e
 <
şass
 
	gT1
, cÏs 
	gT2
>

1538 
	$PK_Fš®Tem¶©e
(cÚ¡ 
T1
 &
v1
, cÚ¡ 
T2
 &
v2
)

1539 {
this
->
	`AcûssKey
().
	`In™Ÿlize
(
v1
, 
v2
);
	}
}

1541 
	g‹m¶©e
 <
şass
 
	gT1
, cÏs 
	gT2
, cÏs 
	gT3
>

1542 
	$PK_Fš®Tem¶©e
(cÚ¡ 
T1
 &
v1
, cÚ¡ 
T2
 &
v2
, cÚ¡ 
T3
 &
v3
)

1543 {
this
->
	`AcûssKey
().
	`In™Ÿlize
(
v1
, 
v2
, 
v3
);
	}
}

1545 
	g‹m¶©e
 <
şass
 
	gT1
, cÏs 
	gT2
, cÏs 
	gT3
, cÏs 
	gT4
>

1546 
	$PK_Fš®Tem¶©e
(cÚ¡ 
T1
 &
v1
, cÚ¡ 
T2
 &
v2
, cÚ¡ 
T3
 &
v3
, cÚ¡ 
T4
 &
v4
)

1547 {
this
->
	`AcûssKey
().
	`In™Ÿlize
(
v1
, 
v2
, 
v3
, 
v4
);
	}
}

1549 
	g‹m¶©e
 <
şass
 
	gT1
, cÏs 
	gT2
, cÏs 
	gT3
, cÏs 
	gT4
, cÏs 
	gT5
>

1550 
	$PK_Fš®Tem¶©e
(cÚ¡ 
T1
 &
v1
, cÚ¡ 
T2
 &
v2
, cÚ¡ 
T3
 &
v3
, cÚ¡ 
T4
 &
v4
, cÚ¡ 
T5
 &
v5
)

1551 {
this
->
	`AcûssKey
().
	`In™Ÿlize
(
v1
, 
v2
, 
v3
, 
v4
, 
v5
);
	}
}

1553 
	g‹m¶©e
 <
şass
 
	gT1
, cÏs 
	gT2
, cÏs 
	gT3
, cÏs 
	gT4
, cÏs 
	gT5
, cÏs 
	gT6
>

1554 
	$PK_Fš®Tem¶©e
(cÚ¡ 
T1
 &
v1
, cÚ¡ 
T2
 &
v2
, cÚ¡ 
T3
 &
v3
, cÚ¡ 
T4
 &
v4
, cÚ¡ 
T5
 &
v5
, cÚ¡ 
T6
 &
v6
)

1555 {
this
->
	`AcûssKey
().
	`In™Ÿlize
(
v1
, 
v2
, 
v3
, 
v4
, 
v5
, 
v6
);
	}
}

1557 
	g‹m¶©e
 <
şass
 
	gT1
, cÏs 
	gT2
, cÏs 
	gT3
, cÏs 
	gT4
, cÏs 
	gT5
, cÏs 
	gT6
, cÏs 
	gT7
>

1558 
	$PK_Fš®Tem¶©e
(cÚ¡ 
T1
 &
v1
, cÚ¡ 
T2
 &
v2
, cÚ¡ 
T3
 &
v3
, cÚ¡ 
T4
 &
v4
, cÚ¡ 
T5
 &
v5
, cÚ¡ 
T6
 &
v6
, cÚ¡ 
T7
 &
v7
)

1559 {
this
->
	`AcûssKey
().
	`In™Ÿlize
(
v1
, 
v2
, 
v3
, 
v4
, 
v5
, 
v6
, 
v7
);
	}
}

1561 
	g‹m¶©e
 <
şass
 
	gT1
, cÏs 
	gT2
, cÏs 
	gT3
, cÏs 
	gT4
, cÏs 
	gT5
, cÏs 
	gT6
, cÏs 
	gT7
, cÏs 
	gT8
>

1562 
	$PK_Fš®Tem¶©e
(cÚ¡ 
T1
 &
v1
, cÚ¡ 
T2
 &
v2
, cÚ¡ 
T3
 &
v3
, cÚ¡ 
T4
 &
v4
, cÚ¡ 
T5
 &
v5
, cÚ¡ 
T6
 &
v6
, cÚ¡ 
T7
 &
v7
, cÚ¡ 
T8
 &
v8
)

1563 {
this
->
	`AcûssKey
().
	`In™Ÿlize
(
v1
, 
v2
, 
v3
, 
v4
, 
v5
, 
v6
, 
v7
, 
v8
);
	}
}

1565 
	g‹m¶©e
 <
şass
 
	gT1
, cÏs 
	gT2
>

1566 
	$PK_Fš®Tem¶©e
(
T1
 &
v1
, cÚ¡ 
T2
 &
v2
)

1567 {
this
->
	`AcûssKey
().
	`In™Ÿlize
(
v1
, 
v2
);
	}
}

1569 
	g‹m¶©e
 <
şass
 
	gT1
, cÏs 
	gT2
, cÏs 
	gT3
>

1570 
	$PK_Fš®Tem¶©e
(
T1
 &
v1
, cÚ¡ 
T2
 &
v2
, cÚ¡ 
T3
 &
v3
)

1571 {
this
->
	`AcûssKey
().
	`In™Ÿlize
(
v1
, 
v2
, 
v3
);
	}
}

1573 
	g‹m¶©e
 <
şass
 
	gT1
, cÏs 
	gT2
, cÏs 
	gT3
, cÏs 
	gT4
>

1574 
	$PK_Fš®Tem¶©e
(
T1
 &
v1
, cÚ¡ 
T2
 &
v2
, cÚ¡ 
T3
 &
v3
, cÚ¡ 
T4
 &
v4
)

1575 {
this
->
	`AcûssKey
().
	`In™Ÿlize
(
v1
, 
v2
, 
v3
, 
v4
);
	}
}

1577 
	g‹m¶©e
 <
şass
 
	gT1
, cÏs 
	gT2
, cÏs 
	gT3
, cÏs 
	gT4
, cÏs 
	gT5
>

1578 
	$PK_Fš®Tem¶©e
(
T1
 &
v1
, cÚ¡ 
T2
 &
v2
, cÚ¡ 
T3
 &
v3
, cÚ¡ 
T4
 &
v4
, cÚ¡ 
T5
 &
v5
)

1579 {
this
->
	`AcûssKey
().
	`In™Ÿlize
(
v1
, 
v2
, 
v3
, 
v4
, 
v5
);
	}
}

1581 
	g‹m¶©e
 <
şass
 
	gT1
, cÏs 
	gT2
, cÏs 
	gT3
, cÏs 
	gT4
, cÏs 
	gT5
, cÏs 
	gT6
>

1582 
	$PK_Fš®Tem¶©e
(
T1
 &
v1
, cÚ¡ 
T2
 &
v2
, cÚ¡ 
T3
 &
v3
, cÚ¡ 
T4
 &
v4
, cÚ¡ 
T5
 &
v5
, cÚ¡ 
T6
 &
v6
)

1583 {
this
->
	`AcûssKey
().
	`In™Ÿlize
(
v1
, 
v2
, 
v3
, 
v4
, 
v5
, 
v6
);
	}
}

1585 
	g‹m¶©e
 <
şass
 
	gT1
, cÏs 
	gT2
, cÏs 
	gT3
, cÏs 
	gT4
, cÏs 
	gT5
, cÏs 
	gT6
, cÏs 
	gT7
>

1586 
	$PK_Fš®Tem¶©e
(
T1
 &
v1
, cÚ¡ 
T2
 &
v2
, cÚ¡ 
T3
 &
v3
, cÚ¡ 
T4
 &
v4
, cÚ¡ 
T5
 &
v5
, cÚ¡ 
T6
 &
v6
, cÚ¡ 
T7
 &
v7
)

1587 {
this
->
	`AcûssKey
().
	`In™Ÿlize
(
v1
, 
v2
, 
v3
, 
v4
, 
v5
, 
v6
, 
v7
);
	}
}

1589 
	g‹m¶©e
 <
şass
 
	gT1
, cÏs 
	gT2
, cÏs 
	gT3
, cÏs 
	gT4
, cÏs 
	gT5
, cÏs 
	gT6
, cÏs 
	gT7
, cÏs 
	gT8
>

1590 
	$PK_Fš®Tem¶©e
(
T1
 &
v1
, cÚ¡ 
T2
 &
v2
, cÚ¡ 
T3
 &
v3
, cÚ¡ 
T4
 &
v4
, cÚ¡ 
T5
 &
v5
, cÚ¡ 
T6
 &
v6
, cÚ¡ 
T7
 &
v7
, cÚ¡ 
T8
 &
v8
)

1591 {
this
->
	`AcûssKey
().
	`In™Ÿlize
(
v1
, 
v2
, 
v3
, 
v4
, 
v5
, 
v6
, 
v7
, 
v8
);
	}
}

1597 
	sEnüy±iÚSnd¬d
 {};

1600 
	sSigÇtu»Snd¬d
 {};

1602 
	g‹m¶©e
 <
şass
 
	gSTANDARD
, cÏs 
	gKEYS
, cÏs 
	gALG_INFO
>

1603 
şass
 
	gTF_ES
;

1606 
	g‹m¶©e
 <
şass
 
	gSTANDARD
, cÏs 
	gKEYS
, cÏs 
	gALG_INFO
 = 
TF_ES
<
STANDARD
, KEYS, > >

1607 şas 
	cTF_ES
 : 
public
 
KEYS


1609 
ty³Çme
 
	tSTANDARD
::
	tEnüy±iÚMes§geEncodšgM‘hod
 
	tMes§geEncodšgM‘hod
;

1611 
	mpublic
:

1613 
STANDARD
 
	tSnd¬d
;

1614 
	mTF_Cry±oSchemeO±iÚs
<
	tALG_INFO
, 
	tKEYS
, 
	tMes§geEncodšgM‘hod
> 
	tSchemeO±iÚs
;

1616 
	m¡d
::
¡ršg
 
CRYPTOPP_API
 
	$SticAlgÜ™hmName
(è{ 
¡d
::
	`¡ršg
(
KEYS
::
	`SticAlgÜ™hmName
()è+ "/" + 
Mes§geEncodšgM‘hod
::StaticAlgorithmName();}

1619 
PK_Fš®Tem¶©e
<
	tTF_Deüy±ÜIm¶
<
	tSchemeO±iÚs
> > 
	tDeüy±Ü
;

1621 
PK_Fš®Tem¶©e
<
	tTF_Enüy±ÜIm¶
<
	tSchemeO±iÚs
> > 
	tEnüy±Ü
;

1622 
	}
};

1624 
	g‹m¶©e
 <
şass
 
	gSTANDARD
, cÏs 
	gH
, cÏs 
	gKEYS
, cÏs 
	gALG_INFO
>

1625 
şass
 
	gTF_SS
;

1628 
	g‹m¶©e
 <
şass
 
	gSTANDARD
, cÏs 
	gH
, cÏs 
	gKEYS
, cÏs 
	gALG_INFO
 = 
TF_SS
<
STANDARD
, H, KEYS, > >

1629 şas 
	cTF_SS
 : 
public
 
KEYS


1631 
public
:

1633 
STANDARD
 
	tSnd¬d
;

1634 
ty³Çme
 
	tSnd¬d
::
	tSigÇtu»Mes§geEncodšgM‘hod
 
	tMes§geEncodšgM‘hod
;

1635 
	mTF_SigÇtu»SchemeO±iÚs
<
	tALG_INFO
, 
	tKEYS
, 
	tMes§geEncodšgM‘hod
, 
	tH
> 
	tSchemeO±iÚs
;

1637 
	m¡d
::
¡ršg
 
CRYPTOPP_API
 
	$SticAlgÜ™hmName
(è{ 
¡d
::
	`¡ršg
(
KEYS
::
	`SticAlgÜ™hmName
()è+ "/" + 
Mes§geEncodšgM‘hod
::SticAlgÜ™hmName(è+ "(" + 
H
::StaticAlgorithmName() + ")";}

1640 
PK_Fš®Tem¶©e
<
	tTF_SigÃrIm¶
<
	tSchemeO±iÚs
> > 
	tSigÃr
;

1642 
PK_Fš®Tem¶©e
<
	tTF_V”if›rIm¶
<
	tSchemeO±iÚs
> > 
	tV”if›r
;

1643 
	}
};

1645 
	g‹m¶©e
 <
şass
 
	gKEYS
, cÏs 
	gSA
, cÏs 
	gMEM
, cÏs 
	gH
, cÏs 
	gALG_INFO
>

1646 
şass
 
	gDL_SS
;

1649 
	g‹m¶©e
 <
şass
 
	gKEYS
, cÏs 
	gSA
, cÏs 
	gMEM
, cÏs 
	gH
, cÏs 
	gALG_INFO
 = 
DL_SS
<
KEYS
, SA, MEM, H, > >

1650 şas 
	cDL_SS
 : 
public
 
KEYS


1652 
DL_SigÇtu»SchemeO±iÚs
<
	tALG_INFO
, 
	tKEYS
, 
	tSA
, 
	tMEM
, 
	tH
> 
	tSchemeO±iÚs
;

1654 
	mpublic
:

1655 
¡d
::
¡ršg
 
	$SticAlgÜ™hmName
(è{ 
SA
::
	`SticAlgÜ™hmName
(è+ 
¡d
::
	`¡ršg
("/EMSA1("è+ 
H
::StaticAlgorithmName() + ")";}

1658 
PK_Fš®Tem¶©e
<
	tDL_SigÃrIm¶
<
	tSchemeO±iÚs
> > 
	tSigÃr
;

1660 
PK_Fš®Tem¶©e
<
	tDL_V”if›rIm¶
<
	tSchemeO±iÚs
> > 
	tV”if›r
;

1661 
	}
};

1664 
	g‹m¶©e
 <
şass
 
	gKEYS
, cÏs 
	gAA
, cÏs 
	gDA
, cÏs 
	gEA
, cÏs 
	gALG_INFO
>

1665 şas 
	cDL_ES
 : 
public
 
KEYS


1667 
DL_Cry±oSchemeO±iÚs
<
	tALG_INFO
, 
	tKEYS
, 
	tAA
, 
	tDA
, 
	tEA
> 
	tSchemeO±iÚs
;

1669 
	mpublic
:

1671 
PK_Fš®Tem¶©e
<
	tDL_Deüy±ÜIm¶
<
	tSchemeO±iÚs
> > 
	tDeüy±Ü
;

1673 
	mPK_Fš®Tem¶©e
<
	tDL_Enüy±ÜIm¶
<
	tSchemeO±iÚs
> > 
	tEnüy±Ü
;

1676 
	gNAMESPACE_END


	@pwdbased.h

3 #iâdeà
CRYPTOPP_PWDBASED_H


4 
	#CRYPTOPP_PWDBASED_H


	)

6 
	~"üy±lib.h
"

7 
	~"hmac.h
"

8 
	~"h¹im”.h
"

9 
	~"š‹g”.h
"

11 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

14 şas 
	cPasswÜdBa£dKeyD”iv©iÚFunùiÚ


16 
public
:

17 
vœtu®
 
size_t
 
	$MaxD”ivedKeyL’gth
() const =0;

18 
vœtu®
 
boŞ
 
	$U£sPu½o£By‹
() const =0;

22 
vœtu®
 
	$D”iveKey
(
by‹
 *
d”ived
, 
size_t
 
d”ivedL’
, by‹ 
pu½o£
, cÚ¡ by‹ *
·sswÜd
, size_ˆ
·sswÜdL’
, cÚ¡ by‹ *
§É
, size_ˆ
§ÉL’
, 
™”©iÚs
, 
timeInSecÚds
=0) const =0;

26 
‹m¶©e
 <
şass
 
T
>

27 şas 
	cPKCS5_PBKDF1
 : 
public
 
PasswÜdBa£dKeyD”iv©iÚFunùiÚ


29 
public
:

30 
size_t
 
	$MaxD”ivedKeyL’gth
(ècÚ¡ { 
T
::
DIGESTSIZE
;}

31 
boŞ
 
	$U£sPu½o£By‹
(ècÚ¡ { 
çl£
;
	}
}

33 
	$D”iveKey
(
by‹
 *
d”ived
, 
size_t
 
d”ivedL’
, by‹ 
pu½o£
, cÚ¡ by‹ *
·sswÜd
, size_ˆ
·sswÜdL’
, cÚ¡ by‹ *
§É
, size_ˆ
§ÉL’
, 
™”©iÚs
, 
timeInSecÚds
=0) const;

34 
	}
};

37 
	g‹m¶©e
 <
şass
 
	gT
>

38 şas 
	cPKCS5_PBKDF2_HMAC
 : 
public
 
PasswÜdBa£dKeyD”iv©iÚFunùiÚ


40 
public
:

41 
size_t
 
	$MaxD”ivedKeyL’gth
() const { 0xffffffffU;}

42 
boŞ
 
	$U£sPu½o£By‹
(ècÚ¡ { 
çl£
;
	}
}

43 
	$D”iveKey
(
by‹
 *
d”ived
, 
size_t
 
d”ivedL’
, by‹ 
pu½o£
, cÚ¡ by‹ *
·sswÜd
, size_ˆ
·sswÜdL’
, cÚ¡ by‹ *
§É
, size_ˆ
§ÉL’
, 
™”©iÚs
, 
timeInSecÚds
=0) const;

44 
	}
};

56 
	g‹m¶©e
 <
şass
 
	gT
>

57 
	gPKCS5_PBKDF1
<
	gT
>::
	$D”iveKey
(
by‹
 *
d”ived
, 
size_t
 
d”ivedL’
, by‹ 
pu½o£
, cÚ¡ by‹ *
·sswÜd
, size_ˆ
·sswÜdL’
, cÚ¡ by‹ *
§É
, size_ˆ
§ÉL’
, 
™”©iÚs
, 
timeInSecÚds
) const

59 
	`as£¹
(
d”ivedL’
 <ğ
	`MaxD”ivedKeyL’gth
());

60 
	`as£¹
(
™”©iÚs
 > 0 || 
timeInSecÚds
 > 0);

62 ià(!
™”©iÚs
)

63 
™”©iÚs
 = 1;

65 
T
 
hash
;

66 
hash
.
	`Upd©e
(
·sswÜd
, 
·sswÜdL’
);

67 
hash
.
	`Upd©e
(
§É
, 
§ÉL’
);

69 
SecBy‹Block
 
	`bufãr
(
hash
.
	`Dige¡Size
());

70 
hash
.
	`Fš®
(
bufãr
);

72 
i
;

73 
Th»adU£rTim”
 
tim”
;

75 ià(
timeInSecÚds
)

76 
tim”
.
	`S¹Tim”
();

78 
i
=1; i<
™”©iÚs
 || (
timeInSecÚds
 && (i%128!=0 || 
tim”
.
	`EÏp£dTimeAsDoubË
() <imeInSeconds)); i++)

79 
hash
.
	`C®cuÏ‹Dige¡
(
bufãr
, bufãr, bufãr.
	`size
());

81 
	`memıy
(
d”ived
, 
bufãr
, 
d”ivedL’
);

82  
i
;

83 
	}
}

85 
	g‹m¶©e
 <
şass
 
	gT
>

86 
	gPKCS5_PBKDF2_HMAC
<
	gT
>::
	$D”iveKey
(
by‹
 *
d”ived
, 
size_t
 
d”ivedL’
, by‹ 
pu½o£
, cÚ¡ by‹ *
·sswÜd
, size_ˆ
·sswÜdL’
, cÚ¡ by‹ *
§É
, size_ˆ
§ÉL’
, 
™”©iÚs
, 
timeInSecÚds
) const

88 
	`as£¹
(
d”ivedL’
 <ğ
	`MaxD”ivedKeyL’gth
());

89 
	`as£¹
(
™”©iÚs
 > 0 || 
timeInSecÚds
 > 0);

91 ià(!
™”©iÚs
)

92 
™”©iÚs
 = 1;

94 
HMAC
<
T
> 
	`hmac
(
·sswÜd
, 
·sswÜdL’
);

95 
SecBy‹Block
 
	`bufãr
(
hmac
.
	`Dige¡Size
());

96 
Th»adU£rTim”
 
tim”
;

98 
i
=1;

99 
d”ivedL’
 > 0)

101 
hmac
.
	`Upd©e
(
§É
, 
§ÉL’
);

102 
j
;

103 
j
=0; j<4; j++)

105 
by‹
 
b
 = 
	`by‹
(
i
 >> ((3-
j
)*8));

106 
hmac
.
	`Upd©e
(&
b
, 1);

108 
hmac
.
	`Fš®
(
bufãr
);

110 
size_t
 
£gm’tL’
 = 
	`STDMIN
(
d”ivedL’
, 
bufãr
.
	`size
());

111 
	`memıy
(
d”ived
, 
bufãr
, 
£gm’tL’
);

113 ià(
timeInSecÚds
)

115 
timeInSecÚds
 =imeInSecÚd / ((
d”ivedL’
 + 
bufãr
.
	`size
() - 1) / buffer.size());

116 
tim”
.
	`S¹Tim”
();

119 
j
=1; j<
™”©iÚs
 || (
timeInSecÚds
 && (j%128!=0 || 
tim”
.
	`EÏp£dTimeAsDoubË
() <imeInSeconds)); j++)

121 
hmac
.
	`C®cuÏ‹Dige¡
(
bufãr
, bufãr, bufãr.
	`size
());

122 
	`xÜbuf
(
d”ived
, 
bufãr
, 
£gm’tL’
);

125 ià(
timeInSecÚds
)

127 
™”©iÚs
 = 
j
;

128 
timeInSecÚds
 = 0;

131 
d”ived
 +ğ
£gm’tL’
;

132 
d”ivedL’
 -ğ
£gm’tL’
;

133 
i
++;

136  
™”©iÚs
;

137 
	}
}

140 
	g‹m¶©e
 <
şass
 
	gT
>

141 şas 
	cPKCS12_PBKDF
 : 
public
 
PasswÜdBa£dKeyD”iv©iÚFunùiÚ


143 
public
:

144 
size_t
 
	$MaxD”ivedKeyL’gth
(ècÚ¡ { 
	`size_t
(0)-1;}

145 
boŞ
 
	$U£sPu½o£By‹
(ècÚ¡ { 
Œue
;
	}
}

146 
	$D”iveKey
(
by‹
 *
d”ived
, 
size_t
 
d”ivedL’
, by‹ 
pu½o£
, cÚ¡ by‹ *
·sswÜd
, size_ˆ
·sswÜdL’
, cÚ¡ by‹ *
§É
, size_ˆ
§ÉL’
, 
™”©iÚs
, 
timeInSecÚds
) const;

147 
	}
};

149 
	g‹m¶©e
 <
şass
 
	gT
>

150 
	gPKCS12_PBKDF
<
	gT
>::
	$D”iveKey
(
by‹
 *
d”ived
, 
size_t
 
d”ivedL’
, by‹ 
pu½o£
, cÚ¡ by‹ *
·sswÜd
, size_ˆ
·sswÜdL’
, cÚ¡ by‹ *
§É
, size_ˆ
§ÉL’
, 
™”©iÚs
, 
timeInSecÚds
) const

152 
	`as£¹
(
d”ivedL’
 <ğ
	`MaxD”ivedKeyL’gth
());

153 
	`as£¹
(
™”©iÚs
 > 0 || 
timeInSecÚds
 > 0);

155 ià(!
™”©iÚs
)

156 
™”©iÚs
 = 1;

158 cÚ¡ 
size_t
 
v
 = 
T
::
BLOCKSIZE
;

159 cÚ¡ 
size_t
 
DL’
 = 
v
, 
SL’
 = 
	`RoundUpToMuÉËOf
(
§ÉL’
, v);

160 cÚ¡ 
size_t
 
PL’
 = 
	`RoundUpToMuÉËOf
(
·sswÜdL’
, 
v
), 
IL’
 = 
SL’
 + PLen;

161 
SecBy‹Block
 
	`bufãr
(
DL’
 + 
SL’
 + 
PL’
);

162 
by‹
 *
D
 = 
bufãr
, *
S
 = bufãr+
DL’
, *
P
 = bufãr+DL’+
SL’
, *
I
 = S;

164 
	`mem£t
(
D
, 
pu½o£
, 
DL’
);

165 
size_t
 
i
;

166 
i
=0; i<
SL’
; i++)

167 
S
[
i
] = 
§É
[˜% 
§ÉL’
];

168 
i
=0; i<
PL’
; i++)

169 
P
[
i
] = 
·sswÜd
[˜% 
·sswÜdL’
];

172 
T
 
hash
;

173 
SecBy‹Block
 
	`Ai
(
T
::
DIGESTSIZE
), 
	`B
(
v
);

174 
Th»adU£rTim”
 
tim”
;

176 
d”ivedL’
 > 0)

178 
hash
.
	`C®cuÏ‹Dige¡
(
Ai
, 
bufãr
, bufãr.
	`size
());

180 ià(
timeInSecÚds
)

182 
timeInSecÚds
 =imeInSecÚd / ((
d”ivedL’
 + 
Ai
.
	`size
() - 1) / Ai.size());

183 
tim”
.
	`S¹Tim”
();

186 
i
=1; i<
™”©iÚs
 || (
timeInSecÚds
 && (i%128!=0 || 
tim”
.
	`EÏp£dTimeAsDoubË
() <imeInSeconds)); i++)

187 
hash
.
	`C®cuÏ‹Dige¡
(
Ai
, Ai, Ai.
	`size
());

189 ià(
timeInSecÚds
)

191 
™”©iÚs
 = ()
i
;

192 
timeInSecÚds
 = 0;

195 
i
=0; i<
B
.
	`size
(); i++)

196 
B
[
i
] = 
Ai
[˜% Ai.
	`size
()];

198 
IÁeg”
 
	`B1
(
B
, B.
	`size
());

199 ++
B1
;

200 
i
=0; i<
IL’
; i+=
v
)

201 (
	`IÁeg”
(
I
+
i
, 
v
è+ 
B1
).
	`Encode
(I+i, v);

203 
size_t
 
£gm’tL’
 = 
	`STDMIN
(
d”ivedL’
, 
Ai
.
	`size
());

204 
	`memıy
(
d”ived
, 
Ai
, 
£gm’tL’
);

205 
d”ived
 +ğ
£gm’tL’
;

206 
d”ivedL’
 -ğ
£gm’tL’
;

209  
™”©iÚs
;

210 
	}
}

212 
	gNAMESPACE_END


	@queue.cpp

3 
	~"pch.h
"

5 #iâdeà
CRYPTOPP_IMPORTS


7 
	~"queue.h
"

8 
	~"f‹rs.h
"

10 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

12 cÚ¡ 
s_maxAutoNodeSize
 = 16*1024;

15 şas 
	cBy‹QueueNode


17 
public
:

18 
	$By‹QueueNode
(
size_t
 
maxSize
)

19 : 
	$buf
(
maxSize
)

21 
m_h—d
 = 
m_
 = 0;

22 
Ãxt
 = 0;

25 
šlše
 
size_t
 
	$MaxSize
(ècÚ¡ { 
buf
.
	`size
();
	}
}

27 
šlše
 
size_t
 
	$Cu¼’tSize
() const

29  
m_
-
m_h—d
;

30 
	}
}

32 
šlše
 
boŞ
 
	$U£dUp
() const

34  (
m_h—d
==
	`MaxSize
());

35 
	}
}

37 
šlše
 
	$CË¬
()

39 
m_h—d
 = 
m_
 = 0;

40 
	}
}

42 
šlše
 
size_t
 
	$Put
(cÚ¡ 
by‹
 *
begš
, 
size_t
 
Ëngth
)

44 
size_t
 
l
 = 
	`STDMIN
(
Ëngth
, 
	`MaxSize
()-
m_
);

45 ià(
buf
+
m_
 !ğ
begš
)

46 
	`memıy
(
buf
+
m_
, 
begš
, 
l
);

47 
m_
 +ğ
l
;

48  
l
;

49 
	}
}

51 
šlše
 
size_t
 
	$P“k
(
by‹
 &
outBy‹
) const

53 ià(
m_
==
m_h—d
)

56 
outBy‹
=
buf
[
m_h—d
];

58 
	}
}

60 
šlše
 
size_t
 
	$P“k
(
by‹
 *
rg‘
, 
size_t
 
cİyMax
) const

62 
size_t
 
Ën
 = 
	`STDMIN
(
cİyMax
, 
m_
-
m_h—d
);

63 
	`memıy
(
rg‘
, 
buf
+
m_h—d
, 
Ën
);

64  
Ën
;

65 
	}
}

67 
šlše
 
size_t
 
	$CİyTo
(
Bufã»dT¿nsfÜm©iÚ
 &
rg‘
, cÚ¡ 
¡d
::
¡ršg
 &
chªÃl
=
DEFAULT_CHANNEL
) const

69 
size_t
 
Ën
 = 
m_
-
m_h—d
;

70 
rg‘
.
	`ChªÃlPut
(
chªÃl
, 
buf
+
m_h—d
, 
Ën
);

71  
Ën
;

72 
	}
}

74 
šlše
 
size_t
 
	$CİyTo
(
Bufã»dT¿nsfÜm©iÚ
 &
rg‘
, 
size_t
 
cİyMax
, cÚ¡ 
¡d
::
¡ršg
 &
chªÃl
=
DEFAULT_CHANNEL
) const

76 
size_t
 
Ën
 = 
	`STDMIN
(
cİyMax
, 
m_
-
m_h—d
);

77 
rg‘
.
	`ChªÃlPut
(
chªÃl
, 
buf
+
m_h—d
, 
Ën
);

78  
Ën
;

79 
	}
}

81 
šlše
 
size_t
 
	$G‘
(
by‹
 &
outBy‹
)

83 
size_t
 
Ën
 = 
	`P“k
(
outBy‹
);

84 
m_h—d
 +ğ
Ën
;

85  
Ën
;

86 
	}
}

88 
šlše
 
size_t
 
	$G‘
(
by‹
 *
outSŒšg
, 
size_t
 
g‘Max
)

90 
size_t
 
Ën
 = 
	`P“k
(
outSŒšg
, 
g‘Max
);

91 
m_h—d
 +ğ
Ën
;

92  
Ën
;

93 
	}
}

95 
šlše
 
size_t
 
	$T¿nsãrTo
(
Bufã»dT¿nsfÜm©iÚ
 &
rg‘
, cÚ¡ 
¡d
::
¡ršg
 &
chªÃl
=
DEFAULT_CHANNEL
)

97 
size_t
 
Ën
 = 
m_
-
m_h—d
;

98 
rg‘
.
	`ChªÃlPutModifŸbË
(
chªÃl
, 
buf
+
m_h—d
, 
Ën
);

99 
m_h—d
 = 
m_
;

100  
Ën
;

101 
	}
}

103 
šlše
 
size_t
 
	$T¿nsãrTo
(
Bufã»dT¿nsfÜm©iÚ
 &
rg‘
, 
lwÜd
 
ŒªsãrMax
, cÚ¡ 
¡d
::
¡ršg
 &
chªÃl
=
DEFAULT_CHANNEL
)

105 
size_t
 
Ën
 = 
	`UnsigÃdMš
(
m_
-
m_h—d
, 
ŒªsãrMax
);

106 
rg‘
.
	`ChªÃlPutModifŸbË
(
chªÃl
, 
buf
+
m_h—d
, 
Ën
);

107 
m_h—d
 +ğ
Ën
;

108  
Ën
;

109 
	}
}

111 
šlše
 
size_t
 
	$Sk
(
size_t
 
skMax
)

113 
size_t
 
Ën
 = 
	`STDMIN
(
skMax
, 
m_
-
m_h—d
);

114 
m_h—d
 +ğ
Ën
;

115  
Ën
;

116 
	}
}

118 
šlše
 
by‹
 
	gİ”©Ü
[](
size_t
 
	gi
) const

120  
	gbuf
[
m_h—d
+
i
];

123 
By‹QueueNode
 *
	gÃxt
;

125 
SecBy‹Block
 
	gbuf
;

126 
size_t
 
	gm_h—d
, 
	gm_
;

131 
	gBy‹Queue
::
	$By‹Queue
(
size_t
 
nodeSize
)

132 : 
	`m_ÏzySŒšg
(
NULL
), 
	$m_ÏzyL’gth
(0)

134 
	`S‘NodeSize
(
nodeSize
);

135 
m_h—d
 = 
m_
 = 
Ãw
 
	`By‹QueueNode
(
m_nodeSize
);

136 
	}
}

138 
	gBy‹Queue
::
	$S‘NodeSize
(
size_t
 
nodeSize
)

140 
m_autoNodeSize
 = !
nodeSize
;

141 
m_nodeSize
 = 
m_autoNodeSize
 ? 256 : 
nodeSize
;

142 
	}
}

144 
	gBy‹Queue
::
	$By‹Queue
(cÚ¡ 
By‹Queue
 &
cİy
)

145 : 
	$m_ÏzySŒšg
(
NULL
)

147 
	`CİyFrom
(
cİy
);

148 
	}
}

150 
	gBy‹Queue
::
	$CİyFrom
(cÚ¡ 
By‹Queue
 &
cİy
)

152 
m_ÏzyL’gth
 = 0;

153 
m_autoNodeSize
 = 
cİy
.m_autoNodeSize;

154 
m_nodeSize
 = 
cİy
.m_nodeSize;

155 
m_h—d
 = 
m_
 = 
Ãw
 
	`By‹QueueNode
(*
cİy
.m_head);

157 
By‹QueueNode
 *
cu¼’t
=
cİy
.
m_h—d
->
Ãxt
; current; current=current->next)

159 
m_
->
Ãxt
 = 
Ãw
 
	`By‹QueueNode
(*
cu¼’t
);

160 
m_
 = m_->
Ãxt
;

163 
m_
->
Ãxt
 = 
NULL
;

165 
	`Put
(
cİy
.
m_ÏzySŒšg
, cİy.
m_ÏzyL’gth
);

166 
	}
}

168 
	gBy‹Queue
::~
	$By‹Queue
()

170 
	`De¡roy
();

171 
	}
}

173 
	gBy‹Queue
::
	$De¡roy
()

175 
By‹QueueNode
 *
Ãxt
, *
cu¼’t
=
m_h—d
; current; current=next)

177 
Ãxt
=
cu¼’t
->next;

178 
d–‘e
 
cu¼’t
;

180 
	}
}

182 
	gBy‹Queue
::
	$IsŞ©edIn™Ÿlize
(cÚ¡ 
NameV®uePaœs
 &
·¿m‘”s
)

184 
m_nodeSize
 = 
·¿m‘”s
.
	`G‘IÁV®ueW™hDeçuÉ
("NodeSize", 256);

185 
	`CË¬
();

186 
	}
}

188 
lwÜd
 
	gBy‹Queue
::
	$Cu¼’tSize
() const

190 
lwÜd
 
size
=0;

192 
By‹QueueNode
 *
cu¼’t
=
m_h—d
; cu¼’t; cu¼’t=cu¼’t->
Ãxt
)

193 
size
 +ğ
cu¼’t
->
	`Cu¼’tSize
();

195  
size
 + 
m_ÏzyL’gth
;

196 
	}
}

198 
boŞ
 
	gBy‹Queue
::
	$IsEm±y
() const

200  
m_h—d
==
m_
 && m_h—d->
	`Cu¼’tSize
()==0 && 
m_ÏzyL’gth
==0;

201 
	}
}

203 
	gBy‹Queue
::
	$CË¬
()

205 
By‹QueueNode
 *
Ãxt
, *
cu¼’t
=
m_h—d
->next; current; current=next)

207 
Ãxt
=
cu¼’t
->next;

208 
d–‘e
 
cu¼’t
;

211 
m_
 = 
m_h—d
;

212 
m_h—d
->
	`CË¬
();

213 
m_h—d
->
Ãxt
 = 
NULL
;

214 
m_ÏzyL’gth
 = 0;

215 
	}
}

217 
size_t
 
	gBy‹Queue
::
	$Put2
(cÚ¡ 
by‹
 *
šSŒšg
, 
size_t
 
Ëngth
, 
mes§geEnd
, 
boŞ
 
blockšg
)

219 ià(
m_ÏzyL’gth
 > 0)

220 
	`Fš®izeLazyPut
();

222 
size_t
 
Ën
;

223 (
Ën
=
m_
->
	`Put
(
šSŒšg
, 
Ëngth
)) <†ength)

225 
šSŒšg
 +ğ
Ën
;

226 
Ëngth
 -ğ
Ën
;

227 ià(
m_autoNodeSize
 && 
m_nodeSize
 < 
s_maxAutoNodeSize
)

230 
m_nodeSize
 *= 2;

232 
m_nodeSize
 < 
Ëngth
 && m_nodeSiz< 
s_maxAutoNodeSize
);

233 
m_
->
Ãxt
 = 
Ãw
 
	`By‹QueueNode
(
	`STDMAX
(
m_nodeSize
, 
Ëngth
));

234 
m_
 = m_->
Ãxt
;

238 
	}
}

240 
	gBy‹Queue
::
	$CËªupU£dNodes
()

242 
m_h—d
 !ğ
m_
 && m_h—d->
	`U£dUp
())

244 
By‹QueueNode
 *
‹mp
=
m_h—d
;

245 
m_h—d
=m_h—d->
Ãxt
;

246 
d–‘e
 
‹mp
;

249 ià(
m_h—d
->
	`Cu¼’tSize
() == 0)

250 
m_h—d
->
	`CË¬
();

251 
	}
}

253 
	gBy‹Queue
::
	$LazyPut
(cÚ¡ 
by‹
 *
šSŒšg
, 
size_t
 
size
)

255 ià(
m_ÏzyL’gth
 > 0)

256 
	`Fš®izeLazyPut
();

258 ià(
šSŒšg
 =ğ
m_
->
buf
+m_tail->m_tail)

259 
	`Put
(
šSŒšg
, 
size
);

262 
m_ÏzySŒšg
 = 
cÚ¡_ÿ¡
<
by‹
 *>(
šSŒšg
);

263 
m_ÏzyL’gth
 = 
size
;

264 
m_ÏzySŒšgModifŸbË
 = 
çl£
;

266 
	}
}

268 
	gBy‹Queue
::
	$LazyPutModifŸbË
(
by‹
 *
šSŒšg
, 
size_t
 
size
)

270 ià(
m_ÏzyL’gth
 > 0)

271 
	`Fš®izeLazyPut
();

272 
m_ÏzySŒšg
 = 
šSŒšg
;

273 
m_ÏzyL’gth
 = 
size
;

274 
m_ÏzySŒšgModifŸbË
 = 
Œue
;

275 
	}
}

277 
	gBy‹Queue
::
	$UndoLazyPut
(
size_t
 
size
)

279 ià(
m_ÏzyL’gth
 < 
size
)

280 
throw
 
	`Inv®idArgum’t
("ByteQueue: size specified for UndoLazyPut isoo†arge");

282 
m_ÏzyL’gth
 -ğ
size
;

283 
	}
}

285 
	gBy‹Queue
::
	$Fš®izeLazyPut
()

287 
size_t
 
Ën
 = 
m_ÏzyL’gth
;

288 
m_ÏzyL’gth
 = 0;

289 ià(
Ën
)

290 
	`Put
(
m_ÏzySŒšg
, 
Ën
);

291 
	}
}

293 
size_t
 
	gBy‹Queue
::
	$G‘
(
by‹
 &
outBy‹
)

295 ià(
m_h—d
->
	`G‘
(
outBy‹
))

297 ià(
m_h—d
->
	`U£dUp
())

298 
	`CËªupU£dNodes
();

301 ià(
m_ÏzyL’gth
 > 0)

303 
outBy‹
 = *
m_ÏzySŒšg
++;

304 
m_ÏzyL’gth
--;

309 
	}
}

311 
size_t
 
	gBy‹Queue
::
	$G‘
(
by‹
 *
outSŒšg
, 
size_t
 
g‘Max
)

313 
A¼aySšk
 
	`sšk
(
outSŒšg
, 
g‘Max
);

314  (
size_t
)
	`T¿nsãrTo
(
sšk
, 
g‘Max
);

315 
	}
}

317 
size_t
 
	gBy‹Queue
::
	$P“k
(
by‹
 &
outBy‹
) const

319 ià(
m_h—d
->
	`P“k
(
outBy‹
))

321 ià(
m_ÏzyL’gth
 > 0)

323 
outBy‹
 = *
m_ÏzySŒšg
;

328 
	}
}

330 
size_t
 
	gBy‹Queue
::
	$P“k
(
by‹
 *
outSŒšg
, 
size_t
 
³ekMax
) const

332 
A¼aySšk
 
	`sšk
(
outSŒšg
, 
³ekMax
);

333  (
size_t
)
	`CİyTo
(
sšk
, 
³ekMax
);

334 
	}
}

336 
size_t
 
	gBy‹Queue
::
	$T¿nsãrTo2
(
Bufã»dT¿nsfÜm©iÚ
 &
rg‘
, 
lwÜd
 &
ŒªsãrBy‹s
, cÚ¡ 
¡d
::
¡ršg
 &
chªÃl
, 
boŞ
 
blockšg
)

338 ià(
blockšg
)

340 
lwÜd
 
by‹sLeá
 = 
ŒªsãrBy‹s
;

341 
By‹QueueNode
 *
cu¼’t
=
m_h—d
; 
by‹sLeá
 && cu¼’t; cu¼’t=cu¼’t->
Ãxt
)

342 
by‹sLeá
 -ğ
cu¼’t
->
	`T¿nsãrTo
(
rg‘
, by‹sLeá, 
chªÃl
);

343 
	`CËªupU£dNodes
();

345 
size_t
 
Ën
 = (size_t)
	`STDMIN
(
by‹sLeá
, (
lwÜd
)
m_ÏzyL’gth
);

346 ià(
Ën
)

348 ià(
m_ÏzySŒšgModifŸbË
)

349 
rg‘
.
	`ChªÃlPutModifŸbË
(
chªÃl
, 
m_ÏzySŒšg
, 
Ën
);

351 
rg‘
.
	`ChªÃlPut
(
chªÃl
, 
m_ÏzySŒšg
, 
Ën
);

352 
m_ÏzySŒšg
 +ğ
Ën
;

353 
m_ÏzyL’gth
 -ğ
Ën
;

354 
by‹sLeá
 -ğ
Ën
;

356 
ŒªsãrBy‹s
 -ğ
by‹sLeá
;

361 
W®k”
 
	`w®k”
(*
this
);

362 
size_t
 
blockedBy‹s
 = 
w®k”
.
	`T¿nsãrTo2
(
rg‘
, 
ŒªsãrBy‹s
, 
chªÃl
, 
blockšg
);

363 
	`Sk
(
ŒªsãrBy‹s
);

364  
blockedBy‹s
;

366 
	}
}

368 
size_t
 
	gBy‹Queue
::
	$CİyRªgeTo2
(
Bufã»dT¿nsfÜm©iÚ
 &
rg‘
, 
lwÜd
 &
begš
,†wÜd 
’d
, cÚ¡ 
¡d
::
¡ršg
 &
chªÃl
, 
boŞ
 
blockšg
) const

370 
W®k”
 
	`w®k”
(*
this
);

371 
w®k”
.
	`Sk
(
begš
);

372 
lwÜd
 
ŒªsãrBy‹s
 = 
’d
-
begš
;

373 
size_t
 
blockedBy‹s
 = 
w®k”
.
	`T¿nsãrTo2
(
rg‘
, 
ŒªsãrBy‹s
, 
chªÃl
, 
blockšg
);

374 
begš
 +ğ
ŒªsãrBy‹s
;

375  
blockedBy‹s
;

376 
	}
}

378 
	gBy‹Queue
::
	$Ung‘
(
by‹
 
šBy‹
)

380 
	`Ung‘
(&
šBy‹
, 1);

381 
	}
}

383 
	gBy‹Queue
::
	$Ung‘
(cÚ¡ 
by‹
 *
šSŒšg
, 
size_t
 
Ëngth
)

385 
size_t
 
Ën
 = 
	`STDMIN
(
Ëngth
, 
m_h—d
->m_head);

386 
Ëngth
 -ğ
Ën
;

387 
m_h—d
->m_h—d -ğ
Ën
;

388 
	`memıy
(
m_h—d
->
buf
 + m_h—d->m_h—d, 
šSŒšg
 + 
Ëngth
, 
Ën
);

390 ià(
Ëngth
 > 0)

392 
By‹QueueNode
 *
ÃwH—d
 = 
Ãw
 
	`By‹QueueNode
(
Ëngth
);

393 
ÃwH—d
->
Ãxt
 = 
m_h—d
;

394 
m_h—d
 = 
ÃwH—d
;

395 
m_h—d
->
	`Put
(
šSŒšg
, 
Ëngth
);

397 
	}
}

399 cÚ¡ 
by‹
 * 
	gBy‹Queue
::
	$Spy
(
size_t
 &
cÚtiguousSize
) const

401 
cÚtiguousSize
 = 
m_h—d
->
m_
 - m_head->m_head;

402 ià(
cÚtiguousSize
 =ğ0 && 
m_ÏzyL’gth
 > 0)

404 
cÚtiguousSize
 = 
m_ÏzyL’gth
;

405  
m_ÏzySŒšg
;

408  
m_h—d
->
buf
 + m_head->m_head;

409 
	}
}

411 
by‹
 * 
	gBy‹Queue
::
	$C»©ePutS·û
(
size_t
 &
size
)

413 ià(
m_ÏzyL’gth
 > 0)

414 
	`Fš®izeLazyPut
();

416 ià(
m_
->m_ =ğm_->
	`MaxSize
())

418 
m_
->
Ãxt
 = 
Ãw
 
	`By‹QueueNode
(
	`STDMAX
(
m_nodeSize
, 
size
));

419 
m_
 = m_->
Ãxt
;

422 
size
 = 
m_
->
	`MaxSize
() - m_tail->m_tail;

423  
m_
->
buf
 + m_tail->m_tail;

424 
	}
}

426 
	gBy‹Queue
 & By‹Queue::
İ”©Ü
=(cÚ¡ 
By‹Queue
 &
rhs
)

428 
De¡roy
();

429 
CİyFrom
(
rhs
);

430  *
	gthis
;

433 
boŞ
 
	gBy‹Queue
::
İ”©Ü
==(cÚ¡ 
By‹Queue
 &
rhs
) const

435 cÚ¡ 
lwÜd
 
cu¼’tSize
 = 
Cu¼’tSize
();

437 ià(
	gcu¼’tSize
 !ğ
rhs
.
Cu¼’tSize
())

438  
çl£
;

440 
W®k”
 
w®k”1
(*
this
), 
w®k”2
(
rhs
);

441 
by‹
 
	gb1
, 
	gb2
;

443 
	gw®k”1
.
G‘
(
b1
è&& 
	gw®k”2
.G‘(
b2
))

444 ià(
	gb1
 !ğ
b2
)

445  
çl£
;

447  
	gŒue
;

450 
by‹
 
	gBy‹Queue
::
İ”©Ü
[](
lwÜd
 
i
) const

452 
By‹QueueNode
 *
cu¼’t
=
m_h—d
; 
	gcu¼’t
; cu¼’t=cu¼’t->
Ãxt
)

454 ià(
i
 < 
cu¼’t
->
Cu¼’tSize
())

455  (*
cu¼’t
)[(
size_t
)
i
];

457 
	gi
 -ğ
cu¼’t
->
Cu¼’tSize
();

460 
as£¹
(
i
 < 
m_ÏzyL’gth
);

461  
	gm_ÏzySŒšg
[
i
];

464 
	gBy‹Queue
::
	$sw­
(
By‹Queue
 &
rhs
)

466 
¡d
::
	`sw­
(
m_autoNodeSize
, 
rhs
.m_autoNodeSize);

467 
¡d
::
	`sw­
(
m_nodeSize
, 
rhs
.m_nodeSize);

468 
¡d
::
	`sw­
(
m_h—d
, 
rhs
.m_head);

469 
¡d
::
	`sw­
(
m_
, 
rhs
.m_tail);

470 
¡d
::
	`sw­
(
m_ÏzySŒšg
, 
rhs
.m_lazyString);

471 
¡d
::
	`sw­
(
m_ÏzyL’gth
, 
rhs
.m_lazyLength);

472 
¡d
::
	`sw­
(
m_ÏzySŒšgModifŸbË
, 
rhs
.m_lazyStringModifiable);

473 
	}
}

477 
	gBy‹Queue
::
W®k”
::
	$IsŞ©edIn™Ÿlize
(cÚ¡ 
NameV®uePaœs
 &
·¿m‘”s
)

479 
m_node
 = 
m_queue
.
m_h—d
;

480 
m_pos™iÚ
 = 0;

481 
m_off£t
 = 0;

482 
m_ÏzySŒšg
 = 
m_queue
.m_lazyString;

483 
m_ÏzyL’gth
 = 
m_queue
.m_lazyLength;

484 
	}
}

486 
size_t
 
	gBy‹Queue
::
W®k”
::
	$G‘
(
by‹
 &
outBy‹
)

488 
A¼aySšk
 
	`sšk
(&
outBy‹
, 1);

489  (
size_t
)
	`T¿nsãrTo
(
sšk
, 1);

490 
	}
}

492 
size_t
 
	gBy‹Queue
::
W®k”
::
	$G‘
(
by‹
 *
outSŒšg
, 
size_t
 
g‘Max
)

494 
A¼aySšk
 
	`sšk
(
outSŒšg
, 
g‘Max
);

495  (
size_t
)
	`T¿nsãrTo
(
sšk
, 
g‘Max
);

496 
	}
}

498 
size_t
 
	gBy‹Queue
::
W®k”
::
	$P“k
(
by‹
 &
outBy‹
) const

500 
A¼aySšk
 
	`sšk
(&
outBy‹
, 1);

501  (
size_t
)
	`CİyTo
(
sšk
, 1);

502 
	}
}

504 
size_t
 
	gBy‹Queue
::
W®k”
::
	$P“k
(
by‹
 *
outSŒšg
, 
size_t
 
³ekMax
) const

506 
A¼aySšk
 
	`sšk
(
outSŒšg
, 
³ekMax
);

507  (
size_t
)
	`CİyTo
(
sšk
, 
³ekMax
);

508 
	}
}

510 
size_t
 
	gBy‹Queue
::
W®k”
::
	$T¿nsãrTo2
(
Bufã»dT¿nsfÜm©iÚ
 &
rg‘
, 
lwÜd
 &
ŒªsãrBy‹s
, cÚ¡ 
¡d
::
¡ršg
 &
chªÃl
, 
boŞ
 
blockšg
)

512 
lwÜd
 
by‹sLeá
 = 
ŒªsãrBy‹s
;

513 
size_t
 
blockedBy‹s
 = 0;

515 
m_node
)

517 
size_t
 
Ën
 = (size_t)
	`STDMIN
(
by‹sLeá
, (
lwÜd
)
m_node
->
	`Cu¼’tSize
()-
m_off£t
);

518 
blockedBy‹s
 = 
rg‘
.
	`ChªÃlPut2
(
chªÃl
, 
m_node
->
buf
+m_node->
m_h—d
+
m_off£t
, 
Ën
, 0, 
blockšg
);

520 ià(
blockedBy‹s
)

521 
dÚe
;

523 
m_pos™iÚ
 +ğ
Ën
;

524 
by‹sLeá
 -ğ
Ën
;

526 ià(!
by‹sLeá
)

528 
m_off£t
 +ğ
Ën
;

529 
dÚe
;

532 
m_node
 = m_node->
Ãxt
;

533 
m_off£t
 = 0;

536 ià(
by‹sLeá
 && 
m_ÏzyL’gth
)

538 
size_t
 
Ën
 = (size_t)
	`STDMIN
(
by‹sLeá
, (
lwÜd
)
m_ÏzyL’gth
);

539 
blockedBy‹s
 = 
rg‘
.
	`ChªÃlPut2
(
chªÃl
, 
m_ÏzySŒšg
, 
Ën
, 0, 
blockšg
);

540 ià(
blockedBy‹s
)

541 
dÚe
;

543 
m_ÏzySŒšg
 +ğ
Ën
;

544 
m_ÏzyL’gth
 -ğ
Ën
;

545 
by‹sLeá
 -ğ
Ën
;

548 
dÚe
:

549 
ŒªsãrBy‹s
 -ğ
by‹sLeá
;

550  
blockedBy‹s
;

551 
	}
}

553 
size_t
 
	gBy‹Queue
::
W®k”
::
	$CİyRªgeTo2
(
Bufã»dT¿nsfÜm©iÚ
 &
rg‘
, 
lwÜd
 &
begš
,†wÜd 
’d
, cÚ¡ 
¡d
::
¡ršg
 &
chªÃl
, 
boŞ
 
blockšg
) const

555 
W®k”
 
	`w®k”
(*
this
);

556 
w®k”
.
	`Sk
(
begš
);

557 
lwÜd
 
ŒªsãrBy‹s
 = 
’d
-
begš
;

558 
size_t
 
blockedBy‹s
 = 
w®k”
.
	`T¿nsãrTo2
(
rg‘
, 
ŒªsãrBy‹s
, 
chªÃl
, 
blockšg
);

559 
begš
 +ğ
ŒªsãrBy‹s
;

560  
blockedBy‹s
;

561 
	}
}

563 
	gNAMESPACE_END


	@queue.h

3 #iâdeà
CRYPTOPP_QUEUE_H


4 
	#CRYPTOPP_QUEUE_H


	)

6 
	~"sim¶e.h
"

9 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

13 
şass
 
By‹QueueNode
;

16 
şass
 
CRYPTOPP_DLL
 
By‹Queue
 : 
public
 
Bufã¾ess
<
Bufã»dT¿nsfÜm©iÚ
>

18 
public
:

19 
	`By‹Queue
(
size_t
 
nodeSize
=0);

20 
	`By‹Queue
(cÚ¡ 
By‹Queue
 &
cİy
);

21 ~
	`By‹Queue
();

23 
lwÜd
 
	`MaxR‘r›vabË
() const

24 { 
	`Cu¼’tSize
();}

25 
boŞ
 
	`AnyR‘r›vabË
() const

26 { !
	`IsEm±y
();}

28 
	`IsŞ©edIn™Ÿlize
(cÚ¡ 
NameV®uePaœs
 &
·¿m‘”s
);

29 
by‹
 * 
	`C»©ePutS·û
(
size_t
 &
size
);

30 
size_t
 
	`Put2
(cÚ¡ 
by‹
 *
šSŒšg
, size_ˆ
Ëngth
, 
mes§geEnd
, 
boŞ
 
blockšg
);

32 
size_t
 
	`G‘
(
by‹
 &
outBy‹
);

33 
size_t
 
	`G‘
(
by‹
 *
outSŒšg
, size_ˆ
g‘Max
);

35 
size_t
 
	`P“k
(
by‹
 &
outBy‹
) const;

36 
size_t
 
	`P“k
(
by‹
 *
outSŒšg
, size_ˆ
³ekMax
) const;

38 
size_t
 
	`T¿nsãrTo2
(
Bufã»dT¿nsfÜm©iÚ
 &
rg‘
, 
lwÜd
 &
ŒªsãrBy‹s
, cÚ¡ 
¡d
::
¡ršg
 &
chªÃl
=
DEFAULT_CHANNEL
, 
boŞ
 
blockšg
=
Œue
);

39 
size_t
 
	`CİyRªgeTo2
(
Bufã»dT¿nsfÜm©iÚ
 &
rg‘
, 
lwÜd
 &
begš
,†wÜd 
’d
=
LWORD_MAX
, cÚ¡ 
¡d
::
¡ršg
 &
chªÃl
=
DEFAULT_CHANNEL
, 
boŞ
 
blockšg
=
Œue
) const;

42 
	`S‘NodeSize
(
size_t
 
nodeSize
);

44 
lwÜd
 
	`Cu¼’tSize
() const;

45 
boŞ
 
	`IsEm±y
() const;

47 
	`CË¬
();

49 
	`Ung‘
(
by‹
 
šBy‹
);

50 
	`Ung‘
(cÚ¡ 
by‹
 *
šSŒšg
, 
size_t
 
Ëngth
);

52 cÚ¡ 
by‹
 * 
	`Spy
(
size_t
 &
cÚtiguousSize
) const;

54 
	`LazyPut
(cÚ¡ 
by‹
 *
šSŒšg
, 
size_t
 
size
);

55 
	`LazyPutModifŸbË
(
by‹
 *
šSŒšg
, 
size_t
 
size
);

56 
	`UndoLazyPut
(
size_t
 
size
);

57 
	`Fš®izeLazyPut
();

59 
By‹Queue
 & 
İ”©Ü
=(cÚ¡ By‹Queu&
rhs
);

60 
boŞ
 
İ”©Ü
==(cÚ¡ 
By‹Queue
 &
rhs
) const;

61 
boŞ
 
İ”©Ü
!=(cÚ¡ 
By‹Queue
 &
rhs
) const { !operator==(rhs);}

62 
by‹
 
İ”©Ü
[](
lwÜd
 
i
) const;

63 
	`sw­
(
By‹Queue
 &
rhs
);

65 
şass
 
W®k”
 : 
public
 
IÅutRejeùšg
<
Bufã»dT¿nsfÜm©iÚ
>

67 
public
:

68 
	`W®k”
(cÚ¡ 
By‹Queue
 &
queue
)

69 : 
	`m_queue
(
queue
è{
	`In™Ÿlize
();}

71 
lwÜd
 
	`G‘Cu¼’tPos™iÚ
(è{ 
m_pos™iÚ
;}

73 
lwÜd
 
	`MaxR‘r›vabË
() const

74 { 
m_queue
.
	`Cu¼’tSize
(è- 
m_pos™iÚ
;}

76 
	`IsŞ©edIn™Ÿlize
(cÚ¡ 
NameV®uePaœs
 &
·¿m‘”s
);

78 
size_t
 
	`G‘
(
by‹
 &
outBy‹
);

79 
size_t
 
	`G‘
(
by‹
 *
outSŒšg
, size_ˆ
g‘Max
);

81 
size_t
 
	`P“k
(
by‹
 &
outBy‹
) const;

82 
size_t
 
	`P“k
(
by‹
 *
outSŒšg
, size_ˆ
³ekMax
) const;

84 
size_t
 
	`T¿nsãrTo2
(
Bufã»dT¿nsfÜm©iÚ
 &
rg‘
, 
lwÜd
 &
ŒªsãrBy‹s
, cÚ¡ 
¡d
::
¡ršg
 &
chªÃl
=
DEFAULT_CHANNEL
, 
boŞ
 
blockšg
=
Œue
);

85 
size_t
 
	`CİyRªgeTo2
(
Bufã»dT¿nsfÜm©iÚ
 &
rg‘
, 
lwÜd
 &
begš
,†wÜd 
’d
=
LWORD_MAX
, cÚ¡ 
¡d
::
¡ršg
 &
chªÃl
=
DEFAULT_CHANNEL
, 
boŞ
 
blockšg
=
Œue
) const;

87 
´iv©e
:

88 cÚ¡ 
By‹Queue
 &
m_queue
;

89 cÚ¡ 
By‹QueueNode
 *
m_node
;

90 
lwÜd
 
m_pos™iÚ
;

91 
size_t
 
m_off£t
;

92 cÚ¡ 
by‹
 *
m_ÏzySŒšg
;

93 
size_t
 
m_ÏzyL’gth
;

96 
ä›nd
 
şass
 
W®k”
;

98 
´iv©e
:

99 
	`CËªupU£dNodes
();

100 
	`CİyFrom
(cÚ¡ 
By‹Queue
 &
cİy
);

101 
	`De¡roy
();

103 
boŞ
 
m_autoNodeSize
;

104 
size_t
 
m_nodeSize
;

105 
By‹QueueNode
 *
m_h—d
, *
m_
;

106 
by‹
 *
m_ÏzySŒšg
;

107 
size_t
 
m_ÏzyL’gth
;

108 
boŞ
 
m_ÏzySŒšgModifŸbË
;

109 
	}
};

112 şas 
	cCRYPTOPP_DLL
 
	mLazyPu‰”


114 
	mpublic
:

115 
	$LazyPu‰”
(
By‹Queue
 &
bq
, cÚ¡ 
by‹
 *
šSŒšg
, 
size_t
 
size
)

116 : 
	$m_bq
(
bq
è{bq.
	`LazyPut
(
šSŒšg
, 
size
);}

117 ~
	$LazyPu‰”
()

118 {
Œy
 {
m_bq
.
	`Fš®izeLazyPut
();} 
	`ÿtch
(...è{}
	}
}

119 
	g´Ùeùed
:

120 
	$LazyPu‰”
(
By‹Queue
 &
bq
è: 
	$m_bq
(
bq
è{
	}
}

121 
´iv©e
:

122 
By‹Queue
 &
m_bq
;

126 şas 
	cLazyPu‰”ModifŸbË
 : 
public
 
LazyPu‰”


128 
public
:

129 
	$LazyPu‰”ModifŸbË
(
By‹Queue
 &
bq
, 
by‹
 *
šSŒšg
, 
size_t
 
size
)

130 : 
	$LazyPu‰”
(
bq
è{bq.
	`LazyPutModifŸbË
(
šSŒšg
, 
size
);}

131 
	}
};

133 
	gNAMESPACE_END


135 #iâdeà
__BORLANDC__


136 
	$NAMESPACE_BEGIN
(
¡d
)

137 
‹m¶©e
<> 
šlše
 
	$sw­
(
Cry±oPP
::
By‹Queue
 &
a
, Cry±oPP::By‹Queu&
b
)

139 
a
.
	`sw­
(
b
);

140 
	}
}

141 
	gNAMESPACE_END


	@rabin.cpp

3 
	~"pch.h
"

4 
	~"¿bš.h
"

5 
	~"nbtheÜy.h
"

6 
	~"a¢.h
"

7 
	~"sha.h
"

8 
	~"mod¬™h.h
"

10 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

12 
RabšFunùiÚ
::
	$BERDecode
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
)

14 
BERSequ’ûDecod”
 
	`£q
(
bt
);

15 
m_n
.
	`BERDecode
(
£q
);

16 
m_r
.
	`BERDecode
(
£q
);

17 
m_s
.
	`BERDecode
(
£q
);

18 
£q
.
	`Mes§geEnd
();

19 
	}
}

21 
	gRabšFunùiÚ
::
	$DEREncode
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
) const

23 
DERSequ’ûEncod”
 
	`£q
(
bt
);

24 
m_n
.
	`DEREncode
(
£q
);

25 
m_r
.
	`DEREncode
(
£q
);

26 
m_s
.
	`DEREncode
(
£q
);

27 
£q
.
	`Mes§geEnd
();

28 
	}
}

30 
IÁeg”
 
	gRabšFunùiÚ
::
	$AµlyFunùiÚ
(cÚ¡ 
IÁeg”
 &
š
) const

32 
	`DoQuickSª™yCheck
();

34 
IÁeg”
 
out
 = 
š
.
	`Squ¬ed
()%
m_n
;

35 ià(
š
.
	`IsOdd
())

36 
out
 = out*
m_r
%
m_n
;

37 ià(
	`Jacobi
(
š
, 
m_n
)==-1)

38 
out
 = out*
m_s
%
m_n
;

39  
out
;

40 
	}
}

42 
boŞ
 
	gRabšFunùiÚ
::
	$V®id©e
(
RªdomNumb”G’”©Ü
 &
ºg
, 
Ëv–
) const

44 
boŞ
 
·ss
 = 
Œue
;

45 
·ss
 =…as && 
m_n
 > 
IÁeg”
::
	`OÃ
() && m_n%4 == 1;

46 
·ss
 =…as && 
m_r
 > 
IÁeg”
::
	`OÃ
(è&& m_¸< 
m_n
;

47 
·ss
 =…as && 
m_s
 > 
IÁeg”
::
	`OÃ
(è&& m_ < 
m_n
;

48 ià(
Ëv–
 >= 1)

49 
·ss
 =…as && 
	`Jacobi
(
m_r
, 
m_n
è=ğ-1 && Jacobi(
m_s
, m_n) == -1;

50  
·ss
;

51 
	}
}

53 
boŞ
 
	gRabšFunùiÚ
::
	$G‘VoidV®ue
(cÚ¡ *
Çme
, cÚ¡ 
¡d
::
ty³_šfo
 &
v®ueTy³
, *
pV®ue
) const

55  
	`G‘V®ueH–³r
(
this
, 
Çme
, 
v®ueTy³
, 
pV®ue
).
	`AssigÇbË
()

56 
	`CRYPTOPP_GET_FUNCTION_ENTRY
(
Modulus
)

57 
	`CRYPTOPP_GET_FUNCTION_ENTRY
(
Quad¿ticResidueModPrime1
)

58 
	`CRYPTOPP_GET_FUNCTION_ENTRY
(
Quad¿ticResidueModPrime2
)

60 
	}
}

62 
	gRabšFunùiÚ
::
	$AssignFrom
(cÚ¡ 
NameV®uePaœs
 &
sourû
)

64 
	`AssignFromH–³r
(
this
, 
sourû
)

65 
	`CRYPTOPP_SET_FUNCTION_ENTRY
(
Modulus
)

66 
	`CRYPTOPP_SET_FUNCTION_ENTRY
(
Quad¿ticResidueModPrime1
)

67 
	`CRYPTOPP_SET_FUNCTION_ENTRY
(
Quad¿ticResidueModPrime2
)

69 
	}
}

75 
	gInv”tibËRabšFunùiÚ
::
	$G’”©eRªdom
(
RªdomNumb”G’”©Ü
 &
ºg
, cÚ¡ 
NameV®uePaœs
 &
®g
)

77 
modulusSize
 = 2048;

78 
®g
.
	`G‘IÁV®ue
("ModulusSize", 
modulusSize
) ||‡lg.GetIntValue("KeySize", modulusSize);

80 ià(
modulusSize
 < 16)

81 
throw
 
	`Inv®idArgum’t
("InvertibleRabinFunction: specified modulus size isoo small");

84 
boŞ
 
rFound
=
çl£
, 
sFound
=false;

85 
IÁeg”
 
t
=2;

87 
AlgÜ™hmP¬am‘”s
 
´imeP¬am
 = 
	`MakeP¬am‘”sFÜTwoPrimesOfEqu®Size
(
modulusSize
)

89 
m_p
.
	`G’”©eRªdom
(
ºg
, 
´imeP¬am
);

90 
m_q
.
	`G’”©eRªdom
(
ºg
, 
´imeP¬am
);

92 !(
rFound
 && 
sFound
))

94 
jp
 = 
	`Jacobi
(
t
, 
m_p
);

95 
jq
 = 
	`Jacobi
(
t
, 
m_q
);

97 ià(!
rFound
 && 
jp
==1 && 
jq
==-1)

99 
m_r
 = 
t
;

100 
rFound
 = 
Œue
;

103 ià(!
sFound
 && 
jp
==-1 && 
jq
==1)

105 
m_s
 = 
t
;

106 
sFound
 = 
Œue
;

109 ++
t
;

112 
m_n
 = 
m_p
 * 
m_q
;

113 
m_u
 = 
m_q
.
	`Inv”£Mod
(
m_p
);

114 
	}
}

116 
	gInv”tibËRabšFunùiÚ
::
	$BERDecode
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
)

118 
BERSequ’ûDecod”
 
	`£q
(
bt
);

119 
m_n
.
	`BERDecode
(
£q
);

120 
m_r
.
	`BERDecode
(
£q
);

121 
m_s
.
	`BERDecode
(
£q
);

122 
m_p
.
	`BERDecode
(
£q
);

123 
m_q
.
	`BERDecode
(
£q
);

124 
m_u
.
	`BERDecode
(
£q
);

125 
£q
.
	`Mes§geEnd
();

126 
	}
}

128 
	gInv”tibËRabšFunùiÚ
::
	$DEREncode
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
) const

130 
DERSequ’ûEncod”
 
	`£q
(
bt
);

131 
m_n
.
	`DEREncode
(
£q
);

132 
m_r
.
	`DEREncode
(
£q
);

133 
m_s
.
	`DEREncode
(
£q
);

134 
m_p
.
	`DEREncode
(
£q
);

135 
m_q
.
	`DEREncode
(
£q
);

136 
m_u
.
	`DEREncode
(
£q
);

137 
£q
.
	`Mes§geEnd
();

138 
	}
}

140 
IÁeg”
 
	gInv”tibËRabšFunùiÚ
::
	$C®cuÏ‹Inv”£
(
RªdomNumb”G’”©Ü
 &
ºg
, cÚ¡ 
IÁeg”
 &
š
) const

142 
	`DoQuickSª™yCheck
();

144 
ModuÏrAr™hm‘ic
 
	`modn
(
m_n
);

145 
IÁeg”
 
	`r
(
ºg
, IÁeg”::
	`OÃ
(), 
m_n
 - Integer::One());

146 
r
 = 
modn
.
	`Squ¬e
(r);

147 
IÁeg”
 
r2
 = 
modn
.
	`Squ¬e
(
r
);

148 
IÁeg”
 
c
 = 
modn
.
	`MuÉly
(
š
, 
r2
);

150 
IÁeg”
 
ı
=
c
%
m_p
, 
cq
=c%
m_q
;

152 
jp
 = 
	`Jacobi
(
ı
, 
m_p
);

153 
jq
 = 
	`Jacobi
(
cq
, 
m_q
);

155 ià(
jq
==-1)

157 
ı
 = cp*
	`Euşid—nMuÉliÿtiveInv”£
(
m_r
, 
m_p
)%m_p;

158 
cq
 = cq*
	`Euşid—nMuÉliÿtiveInv”£
(
m_r
, 
m_q
)%m_q;

161 ià(
jp
==-1)

163 
ı
 = cp*
	`Euşid—nMuÉliÿtiveInv”£
(
m_s
, 
m_p
)%m_p;

164 
cq
 = cq*
	`Euşid—nMuÉliÿtiveInv”£
(
m_s
, 
m_q
)%m_q;

167 
ı
 = 
	`ModuÏrSqu¬eRoÙ
(ı, 
m_p
);

168 
cq
 = 
	`ModuÏrSqu¬eRoÙ
(cq, 
m_q
);

170 ià(
jp
==-1)

171 
ı
 = 
m_p
-cp;

173 
IÁeg”
 
out
 = 
	`CRT
(
cq
, 
m_q
, 
ı
, 
m_p
, 
m_u
);

175 
out
 = 
modn
.
	`Divide
(out, 
r
);

177 ià((
jq
==-1 && 
out
.
	`IsEv’
()è|| (jq==1 && out.
	`IsOdd
()))

178 
out
 = 
m_n
-out;

180  
out
;

181 
	}
}

183 
boŞ
 
	gInv”tibËRabšFunùiÚ
::
	$V®id©e
(
RªdomNumb”G’”©Ü
 &
ºg
, 
Ëv–
) const

185 
boŞ
 
·ss
 = 
RabšFunùiÚ
::
	`V®id©e
(
ºg
, 
Ëv–
);

186 
·ss
 =…as && 
m_p
 > 
IÁeg”
::
	`OÃ
(è&& m_p%4 =ğ3 && m_°< 
m_n
;

187 
·ss
 =…as && 
m_q
 > 
IÁeg”
::
	`OÃ
(è&& m_q%4 =ğ3 && m_q < 
m_n
;

188 
·ss
 =…as && 
m_u
.
	`IsPos™ive
(è&& m_u < 
m_p
;

189 ià(
Ëv–
 >= 1)

191 
·ss
 =…as && 
m_p
 * 
m_q
 =ğ
m_n
;

192 
·ss
 =…as && 
m_u
 * 
m_q
 % 
m_p
 == 1;

193 
·ss
 =…as && 
	`Jacobi
(
m_r
, 
m_p
) == 1;

194 
·ss
 =…as && 
	`Jacobi
(
m_r
, 
m_q
) == -1;

195 
·ss
 =…as && 
	`Jacobi
(
m_s
, 
m_p
) == -1;

196 
·ss
 =…as && 
	`Jacobi
(
m_s
, 
m_q
) == 1;

198 ià(
Ëv–
 >= 2)

199 
·ss
 =…as && 
	`V”ifyPrime
(
ºg
, 
m_p
, 
Ëv–
-2è&& V”ifyPrimeÔng, 
m_q
,†evel-2);

200  
·ss
;

201 
	}
}

203 
boŞ
 
	gInv”tibËRabšFunùiÚ
::
	$G‘VoidV®ue
(cÚ¡ *
Çme
, cÚ¡ 
¡d
::
ty³_šfo
 &
v®ueTy³
, *
pV®ue
) const

205  
G‘V®ueH–³r
<
RabšFunùiÚ
>(
this
, 
Çme
, 
v®ueTy³
, 
pV®ue
).
	`AssigÇbË
()

206 
	`CRYPTOPP_GET_FUNCTION_ENTRY
(
Prime1
)

207 
	`CRYPTOPP_GET_FUNCTION_ENTRY
(
Prime2
)

208 
	`CRYPTOPP_GET_FUNCTION_ENTRY
(
MuÉliÿtiveInv”£OfPrime2ModPrime1
)

210 
	}
}

212 
	gInv”tibËRabšFunùiÚ
::
	$AssignFrom
(cÚ¡ 
NameV®uePaœs
 &
sourû
)

214 
AssignFromH–³r
<
RabšFunùiÚ
>(
this
, 
sourû
)

215 
	`CRYPTOPP_SET_FUNCTION_ENTRY
(
Prime1
)

216 
	`CRYPTOPP_SET_FUNCTION_ENTRY
(
Prime2
)

217 
	`CRYPTOPP_SET_FUNCTION_ENTRY
(
MuÉliÿtiveInv”£OfPrime2ModPrime1
)

219 
	}
}

221 
	gNAMESPACE_END


	@rabin.h

1 #iâdeà
CRYPTOPP_RABIN_H


2 
	#CRYPTOPP_RABIN_H


	)

7 
	~"ß•.h
"

8 
	~"ps¤.h
"

9 
	~"š‹g”.h
"

11 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

14 
şass
 
RabšFunùiÚ
 : 
public
 
T¿pdoÜFunùiÚ
,…ubliø
PublicKey


16 
RabšFunùiÚ
 
	tThisCÏss
;

18 
public
:

19 
	`In™Ÿlize
(cÚ¡ 
IÁeg”
 &
n
, cÚ¡ IÁeg” &
r
, cÚ¡ IÁeg” &
s
)

20 {
m_n
 = 
n
; 
m_r
 = 
r
; 
m_s
 = 
s
;}

22 
	`BERDecode
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
);

23 
	`DEREncode
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
) const;

25 
IÁeg”
 
	`AµlyFunùiÚ
(cÚ¡ IÁeg” &
x
) const;

26 
IÁeg”
 
	`P»imageBound
(ècÚ¡ { 
m_n
;}

27 
IÁeg”
 
	`ImageBound
(ècÚ¡ { 
m_n
;}

29 
boŞ
 
	`V®id©e
(
RªdomNumb”G’”©Ü
 &
ºg
, 
Ëv–
) const;

30 
boŞ
 
	`G‘VoidV®ue
(cÚ¡ *
Çme
, cÚ¡ 
¡d
::
ty³_šfo
 &
v®ueTy³
, *
pV®ue
) const;

31 
	`AssignFrom
(cÚ¡ 
NameV®uePaœs
 &
sourû
);

33 cÚ¡ 
IÁeg”
& 
	`G‘Modulus
(ècÚ¡ { 
m_n
;}

34 cÚ¡ 
IÁeg”
& 
	`G‘Quad¿ticResidueModPrime1
(ècÚ¡ { 
m_r
;}

35 cÚ¡ 
IÁeg”
& 
	`G‘Quad¿ticResidueModPrime2
(ècÚ¡ { 
m_s
;}

37 
	`S‘Modulus
(cÚ¡ 
IÁeg”
 &
n
è{
m_n
 =‚;}

38 
	`S‘Quad¿ticResidueModPrime1
(cÚ¡ 
IÁeg”
 &
r
è{
m_r
 =„;}

39 
	`S‘Quad¿ticResidueModPrime2
(cÚ¡ 
IÁeg”
 &
s
è{
m_s
 = s;}

41 
´Ùeùed
:

42 
IÁeg”
 
m_n
, 
m_r
, 
m_s
;

43 
	}
};

46 
şass
 
	gInv”tibËRabšFunùiÚ
 : 
public
 
RabšFunùiÚ
,…ubliø
	gT¿pdoÜFunùiÚInv”£
,…ubliø
	gPriv©eKey


48 
Inv”tibËRabšFunùiÚ
 
	tThisCÏss
;

50 
	gpublic
:

51 
In™Ÿlize
(cÚ¡ 
IÁeg”
 &
n
, cÚ¡ IÁeg” &
r
, cÚ¡ IÁeg” &
s
,

52 cÚ¡ 
IÁeg”
 &
p
, cÚ¡ IÁeg” &
q
, cÚ¡ IÁeg” &
u
)

53 {
	gm_n
 = 
n
; 
	gm_r
 = 
r
; 
	gm_s
 = 
s
; 
	gm_p
 = 
p
; 
	gm_q
 = 
q
; 
	gm_u
 = 
u
;}

54 
In™Ÿlize
(
RªdomNumb”G’”©Ü
 &
ºg
, 
keyb™s
)

55 {
G’”©eRªdomW™hKeySize
(
ºg
, 
keyb™s
);}

57 
BERDecode
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
);

58 
DEREncode
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
) const;

60 
IÁeg”
 
C®cuÏ‹Inv”£
(
RªdomNumb”G’”©Ü
 &
ºg
, cÚ¡ IÁeg” &
x
) const;

62 
boŞ
 
V®id©e
(
RªdomNumb”G’”©Ü
 &
ºg
, 
Ëv–
) const;

63 
boŞ
 
G‘VoidV®ue
(cÚ¡ *
Çme
, cÚ¡ 
¡d
::
ty³_šfo
 &
v®ueTy³
, *
pV®ue
) const;

64 
AssignFrom
(cÚ¡ 
NameV®uePaœs
 &
sourû
);

66 
G’”©eRªdom
(
RªdomNumb”G’”©Ü
 &
ºg
, cÚ¡ 
NameV®uePaœs
 &
®g
);

68 cÚ¡ 
	gIÁeg”
& 
G‘Prime1
(ècÚ¡ { 
	gm_p
;}

69 cÚ¡ 
	gIÁeg”
& 
G‘Prime2
(ècÚ¡ { 
	gm_q
;}

70 cÚ¡ 
	gIÁeg”
& 
G‘MuÉliÿtiveInv”£OfPrime2ModPrime1
(ècÚ¡ { 
	gm_u
;}

72 
S‘Prime1
(cÚ¡ 
IÁeg”
 &
p
è{
	gm_p
 =…;}

73 
S‘Prime2
(cÚ¡ 
IÁeg”
 &
q
è{
	gm_q
 = q;}

74 
S‘MuÉliÿtiveInv”£OfPrime2ModPrime1
(cÚ¡ 
IÁeg”
 &
u
è{
	gm_u
 = u;}

76 
	g´Ùeùed
:

77 
IÁeg”
 
m_p
, 
	gm_q
, 
	gm_u
;

81 
	sRabš


83 
	m¡d
::
¡ršg
 
SticAlgÜ™hmName
() { "Rabin-Crypto++Variant";}

84 
RabšFunùiÚ
 
	tPublicKey
;

85 
Inv”tibËRabšFunùiÚ
 
	tPriv©eKey
;

89 
	g‹m¶©e
 <
şass
 
	gSTANDARD
>

90 
	gRabšES
 : 
public
 
TF_ES
<
STANDARD
, 
	gRabš
>

95 
	g‹m¶©e
 <
şass
 
	gSTANDARD
, cÏs 
	gH
>

96 
	gRabšSS
 : 
public
 
TF_SS
<
STANDARD
, 
	gH
, 
	gRabš
>

101 
şass
 
	gSHA1
;

102 
	gRabšES
<
	tOAEP
<
	tSHA1
> >::
	tDeüy±Ü
 
	tRabšDeüy±Ü
;

103 
	gRabšES
<
	tOAEP
<
	tSHA1
> >::
	tEnüy±Ü
 
	tRabšEnüy±Ü
;

105 
	gNAMESPACE_END


	@randpool.cpp

7 
	~"pch.h
"

9 #iâdeà
CRYPTOPP_IMPORTS


11 
	~"¿ndpoŞ.h
"

12 
	~"«s.h
"

13 
	~"sha.h
"

14 
	~"h¹im”.h
"

15 
	~<time.h
>

17 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

19 
RªdomPoŞ
::
	$RªdomPoŞ
()

20 : 
	`m_pCh”
(
Ãw
 
AES
::
Enüy±iÚ
), 
	$m_keyS‘
(
çl£
)

22 
	`mem£t
(
m_key
, 0, m_key.
	`SizeInBy‹s
());

23 
	`mem£t
(
m_£ed
, 0, m_£ed.
	`SizeInBy‹s
());

24 
	}
}

26 
	gRªdomPoŞ
::
	$IncÜpÜ©eEÁrİy
(cÚ¡ 
by‹
 *
šput
, 
size_t
 
Ëngth
)

28 
SHA256
 
hash
;

29 
hash
.
	`Upd©e
(
m_key
, 32);

30 
hash
.
	`Upd©e
(
šput
, 
Ëngth
);

31 
hash
.
	`Fš®
(
m_key
);

32 
m_keyS‘
 = 
çl£
;

33 
	}
}

35 
	gRªdomPoŞ
::
	$G’”©eIÁoBufã»dT¿nsfÜm©iÚ
(
Bufã»dT¿nsfÜm©iÚ
 &
rg‘
, cÚ¡ 
¡d
::
¡ršg
 &
chªÃl
, 
lwÜd
 
size
)

37 ià(
size
 > 0)

39 ià(!
m_keyS‘
)

40 
m_pCh”
->
	`S‘Key
(
m_key
, 32);

42 
Tim”
 
tim”
;

43 
Tim”WÜd
 
tw
 = 
tim”
.
	`G‘Cu¼’tTim”V®ue
();

44 
	`CRYPTOPP_COMPILE_ASSERT
((
tw
) <= 16);

45 *(
Tim”WÜd
 *)
m_£ed
.
	`d©a
(è+ğ
tw
;

47 
time_t
 
t
 = 
	`time
(
NULL
);

48 
	`CRYPTOPP_COMPILE_ASSERT
((
t
) <= 8);

49 *(
time_t
 *)(
m_£ed
.
	`d©a
()+8è+ğ
t
;

53 
m_pCh”
->
	`ProûssBlock
(
m_£ed
);

54 
size_t
 
Ën
 = 
	`UnsigÃdMš
(16, 
size
);

55 
rg‘
.
	`ChªÃlPut
(
chªÃl
, 
m_£ed
, 
Ën
);

56 
size
 -ğ
Ën
;

57 } 
size
 > 0);

59 
	}
}

61 
	gNAMESPACE_END


	@randpool.h

1 #iâdeà
CRYPTOPP_RANDPOOL_H


2 
	#CRYPTOPP_RANDPOOL_H


	)

4 
	~"üy±lib.h
"

5 
	~"f‹rs.h
"

7 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

12 
şass
 
CRYPTOPP_DLL
 
RªdomPoŞ
 : 
public
 
RªdomNumb”G’”©Ü
,…ubliø
NÙCİyabË


14 
public
:

15 
	`RªdomPoŞ
();

17 
boŞ
 
	`CªIncÜpÜ©eEÁrİy
(ècÚ¡ { 
Œue
;}

18 
	`IncÜpÜ©eEÁrİy
(cÚ¡ 
by‹
 *
šput
, 
size_t
 
Ëngth
);

19 
	`G’”©eIÁoBufã»dT¿nsfÜm©iÚ
(
Bufã»dT¿nsfÜm©iÚ
 &
rg‘
, cÚ¡ 
¡d
::
¡ršg
 &
chªÃl
, 
lwÜd
 
size
);

22 
	`Put
(cÚ¡ 
by‹
 *
šput
, 
size_t
 
Ëngth
è{
	`IncÜpÜ©eEÁrİy
(input,†ength);}

24 
´iv©e
:

25 
FixedSizeSecBlock
<
by‹
, 32> 
m_key
;

26 
FixedSizeSecBlock
<
by‹
, 16> 
m_£ed
;

27 
memb”_±r
<
BlockCh”
> 
m_pCh”
;

28 
boŞ
 
m_keyS‘
;

29 
	}
};

31 
	gNAMESPACE_END


	@rc2.cpp

3 
	~"pch.h
"

4 
	~"rc2.h
"

5 
	~"misc.h
"

6 
	~"¬gÇmes.h
"

8 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

10 
RC2
::
Ba£
::
	$UncheckedS‘Key
(cÚ¡ 
by‹
 *
key
, 
keyL’
, cÚ¡ 
NameV®uePaœs
 &
·¿ms
)

12 
	`As£¹V®idKeyL’gth
(
keyL’
);

14 
efãùiveL’
 = 
·¿ms
.
	`G‘IÁV®ueW™hDeçuÉ
(
Name
::
	`EfãùiveKeyL’gth
(), 
DEFAULT_EFFECTIVE_KEYLENGTH
);

15 ià(
efãùiveL’
 > 
MAX_EFFECTIVE_KEYLENGTH
)

16 
throw
 
	`Inv®idArgum’t
("RC2:ƒffective key†ength…arameterƒxceeds maximum");

18 cÚ¡ 
PITABLE
[256] = {

36 
SecBy‹Block
 
	`L
(128);

37 
	`memıy
(
L
, 
key
, 
keyL’
);

39 
i
;

40 
i
=
keyL’
; i<128; i++)

41 
L
[
i
] = 
PITABLE
[(L[i-1] + L[i-
keyL’
]) & 255];

43 
T8
 = (
efãùiveL’
+7) / 8;

44 
by‹
 
TM
 = 255 >> ((8-(
efãùiveL’
%8))%8);

45 
L
[128-
T8
] = 
PITABLE
[L[128-T8] & 
TM
];

47 
i
=127-
T8
; i>=0; i--)

48 
L
[
i
] = 
PITABLE
[L[i+1] ^ L[i+
T8
]];

50 
i
=0; i<64; i++)

51 
K
[
i
] = 
L
[2*i] + (L[2*i+1] << 8);

52 
	}
}

54 
	gBlockG‘AndPut
<
	twÜd16
, 
	tL™eEndŸn
> 
	tBlock
;

56 
	gRC2
::
Enc
::
	$ProûssAndXÜBlock
(cÚ¡ 
by‹
 *
šBlock
, cÚ¡ by‹ *
xÜBlock
, by‹ *
outBlock
) const

58 
wÜd16
 
R0
, 
R1
, 
R2
, 
R3
;

59 
Block
::
	`G‘
(
šBlock
)(
R0
)(
R1
)(
R2
)(
R3
);

61 
i
 = 0; i < 16; i++)

63 
R0
 +ğ(
R1
 & ~
R3
è+ (
R2
 & R3è+ 
K
[4*
i
+0];

64 
R0
 = 
	`rÙlFixed
(R0, 1);

66 
R1
 +ğ(
R2
 & ~
R0
è+ (
R3
 & R0è+ 
K
[4*
i
+1];

67 
R1
 = 
	`rÙlFixed
(R1, 2);

69 
R2
 +ğ(
R3
 & ~
R1
è+ (
R0
 & R1è+ 
K
[4*
i
+2];

70 
R2
 = 
	`rÙlFixed
(R2, 3);

72 
R3
 +ğ(
R0
 & ~
R2
è+ (
R1
 & R2è+ 
K
[4*
i
+3];

73 
R3
 = 
	`rÙlFixed
(R3, 5);

75 ià(
i
 == 4 || i == 10)

77 
R0
 +ğ
K
[
R3
 & 63];

78 
R1
 +ğ
K
[
R0
 & 63];

79 
R2
 +ğ
K
[
R1
 & 63];

80 
R3
 +ğ
K
[
R2
 & 63];

84 
Block
::
	`Put
(
xÜBlock
, 
outBlock
)(
R0
)(
R1
)(
R2
)(
R3
);

85 
	}
}

87 
	gRC2
::
Dec
::
	$ProûssAndXÜBlock
(cÚ¡ 
by‹
 *
šBlock
, cÚ¡ by‹ *
xÜBlock
, by‹ *
outBlock
) const

89 
wÜd16
 
R0
, 
R1
, 
R2
, 
R3
;

90 
Block
::
	`G‘
(
šBlock
)(
R0
)(
R1
)(
R2
)(
R3
);

92 
i
 = 15; i >= 0; i--)

94 ià(
i
 == 4 || i == 10)

96 
R3
 -ğ
K
[
R2
 & 63];

97 
R2
 -ğ
K
[
R1
 & 63];

98 
R1
 -ğ
K
[
R0
 & 63];

99 
R0
 -ğ
K
[
R3
 & 63];

102 
R3
 = 
	`rÙrFixed
(R3, 5);

103 
R3
 -ğ(
R0
 & ~
R2
è+ (
R1
 & R2è+ 
K
[4*
i
+3];

105 
R2
 = 
	`rÙrFixed
(R2, 3);

106 
R2
 -ğ(
R3
 & ~
R1
è+ (
R0
 & R1è+ 
K
[4*
i
+2];

108 
R1
 = 
	`rÙrFixed
(R1, 2);

109 
R1
 -ğ(
R2
 & ~
R0
è+ (
R3
 & R0è+ 
K
[4*
i
+1];

111 
R0
 = 
	`rÙrFixed
(R0, 1);

112 
R0
 -ğ(
R1
 & ~
R3
è+ (
R2
 & R3è+ 
K
[4*
i
+0];

115 
Block
::
	`Put
(
xÜBlock
, 
outBlock
)(
R0
)(
R1
)(
R2
)(
R3
);

116 
	}
}

118 
	gNAMESPACE_END


	@rc2.h

1 #iâdeà
CRYPTOPP_RC2_H


2 
	#CRYPTOPP_RC2_H


	)

7 
	~"£ckey.h
"

8 
	~"£cblock.h
"

9 
	~"®g·¿m.h
"

11 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

14 
RC2_Info
 : 
public
 
FixedBlockSize
<8>,…ubliø
V¬ŸbËKeyL’gth
<16, 1, 128>

16 
	`CRYPTOPP_CONSTANT
(
DEFAULT_EFFECTIVE_KEYLENGTH
 = 1024)

17 
	`CRYPTOPP_CONSTANT
(
MAX_EFFECTIVE_KEYLENGTH
 = 1024)

18 cÚ¡ *
	`SticAlgÜ™hmName
() { "RC2";}

19 
	}
};

22 
şass
 
	gRC2
 : 
public
 
RC2_Info
,…ubliø
	gBlockCh”Docum’tiÚ


24 
şass
 
CRYPTOPP_NO_VTABLE
 
	gBa£
 : 
public
 
BlockCh”Im¶
<
RC2_Info
>

26 
public
:

27 
UncheckedS‘Key
(cÚ¡ 
by‹
 *
u£rKey
, 
Ëngth
, cÚ¡ 
NameV®uePaœs
 &
·¿ms
);

28 
O±im®D©aAlignm’t
(ècÚ¡ { 
	gG‘Alignm’tOf
<
	gwÜd16
>();}

30 
	g´Ùeùed
:

31 
FixedSizeSecBlock
<
wÜd16
, 64> 
	gK
;

34 şas 
	cCRYPTOPP_NO_VTABLE
 
	gEnc
 : 
public
 
Ba£


36 
public
:

37 
ProûssAndXÜBlock
(cÚ¡ 
by‹
 *
šBlock
, cÚ¡ by‹ *
xÜBlock
, by‹ *
outBlock
) const;

40 şas 
	cCRYPTOPP_NO_VTABLE
 
	gDec
 : 
public
 
Ba£


42 
public
:

43 
ProûssAndXÜBlock
(cÚ¡ 
by‹
 *
šBlock
, cÚ¡ by‹ *
xÜBlock
, by‹ *
outBlock
) const;

46 
	gpublic
:

47 
şass
 
Enüy±iÚ
 : 
public
 
BlockCh”Fš®
<
ENCRYPTION
, 
	gEnc
>

49 
	gpublic
:

50 
Enüy±iÚ
() {}

51 
Enüy±iÚ
(cÚ¡ 
by‹
 *
key
, 
size_t
 
keyL’
=
DEFAULT_KEYLENGTH
)

52 {
S‘Key
(
key
, 
keyL’
);}

53 
Enüy±iÚ
(cÚ¡ 
by‹
 *
key
, 
size_t
 
keyL’
, 
efãùiveKeyL’
)

54 {
S‘Key
(
key
, 
keyL’
, 
MakeP¬am‘”s
("EfãùiveKeyL’gth", 
efãùiveKeyL’
));}

57 
şass
 
	gDeüy±iÚ
 : 
public
 
BlockCh”Fš®
<
DECRYPTION
, 
	gDec
>

59 
	gpublic
:

60 
Deüy±iÚ
() {}

61 
Deüy±iÚ
(cÚ¡ 
by‹
 *
key
, 
size_t
 
keyL’
=
DEFAULT_KEYLENGTH
)

62 {
S‘Key
(
key
, 
keyL’
);}

63 
Deüy±iÚ
(cÚ¡ 
by‹
 *
key
, 
size_t
 
keyL’
, 
efãùiveKeyL’
)

64 {
S‘Key
(
key
, 
keyL’
, 
MakeP¬am‘”s
("EfãùiveKeyL’gth", 
efãùiveKeyL’
));}

68 
	gRC2
::
	tEnüy±iÚ
 
	tRC2Enüy±iÚ
;

69 
	gRC2
::
	tDeüy±iÚ
 
	tRC2Deüy±iÚ
;

71 
	gNAMESPACE_END


	@rc5.cpp

3 
	~"pch.h
"

4 
	~"rc5.h
"

5 
	~"misc.h
"

7 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

9 
RC5
::
Ba£
::
	$UncheckedS‘Key
(cÚ¡ 
by‹
 *
k
, 
keyËn
, cÚ¡ 
NameV®uePaœs
 &
·¿ms
)

11 
	`As£¹V®idKeyL’gth
(
keyËn
);

13 
r
 = 
	`G‘RoundsAndThrowIfInv®id
(
·¿ms
, 
this
);

14 
sTabË
.
	`New
(2*(
r
+1));

16 cÚ¡ 
RC5_WORD
 
MAGIC_P
 = 0xb7e15163L;

17 cÚ¡ 
RC5_WORD
 
MAGIC_Q
 = 0x9e3779b9L;

18 cÚ¡ 
U
=(
RC5_WORD
);

20 cÚ¡ 
c
 = 
	`STDMAX
((
keyËn
+
U
-1)/U, 1U);

21 
SecBlock
<
RC5_WORD
> 
	`l
(
c
);

23 
	`G‘U£rKey
(
LITTLE_ENDIAN_ORDER
, 
l
.
	`begš
(), 
c
, 
k
, 
keyËn
);

25 
sTabË
[0] = 
MAGIC_P
;

26 
j
=1; j<
sTabË
.
	`size
();j++)

27 
sTabË
[
j
] = sTabË[j-1] + 
MAGIC_Q
;

29 
RC5_WORD
 
a
=0, 
b
=0;

30 cÚ¡ 
n
 = 3*
	`STDMAX
(()
sTabË
.
	`size
(), 
c
);

32 
h
=0; h < 
n
; h++)

34 
a
 = 
sTabË
[
h
 % sTabË.
	`size
()] = 
	`rÙlFixed
((sTabË[h % sTabË.size()] +‡ + 
b
), 3);

35 
b
 = 
l
[
h
 % 
c
] = 
	`rÙlMod
(Ö[h % c] + 
a
 + b), (a+b));

37 
	}
}

39 
	gBlockG‘AndPut
<
	tRC5
::
	tRC5_WORD
, 
	tL™eEndŸn
> 
	tBlock
;

41 
	gRC5
::
Enc
::
	$ProûssAndXÜBlock
(cÚ¡ 
by‹
 *
šBlock
, cÚ¡ by‹ *
xÜBlock
, by‹ *
outBlock
) const

43 cÚ¡ 
RC5_WORD
 *
¥Œ
 = 
sTabË
;

44 
RC5_WORD
 
a
, 
b
;

46 
Block
::
	`G‘
(
šBlock
)(
a
)(
b
);

47 
a
 +ğ
¥Œ
[0];

48 
b
 +ğ
¥Œ
[1];

49 
¥Œ
 += 2;

51 
i
=0; i<
r
; i++)

53 
a
 = 
	`rÙlMod
×^
b
,bè+ 
¥Œ
[2*
i
+0];

54 
b
 = 
	`rÙlMod
(
a
^b,aè+ 
¥Œ
[2*
i
+1];

57 
Block
::
	`Put
(
xÜBlock
, 
outBlock
)(
a
)(
b
);

58 
	}
}

60 
	gRC5
::
Dec
::
	$ProûssAndXÜBlock
(cÚ¡ 
by‹
 *
šBlock
, cÚ¡ by‹ *
xÜBlock
, by‹ *
outBlock
) const

62 cÚ¡ 
RC5_WORD
 *
¥Œ
 = 
sTabË
.
	`’d
();

63 
RC5_WORD
 
a
, 
b
;

65 
Block
::
	`G‘
(
šBlock
)(
a
)(
b
);

67 
i
=0; i<
r
; i++)

69 
¥Œ
-=2;

70 
b
 = 
	`rÙrMod
(b-
¥Œ
[1], 
a
) ^‡;

71 
a
 = 
	`rÙrMod
×-
¥Œ
[0], 
b
) ^ b;

73 
b
 -ğ
sTabË
[1];

74 
a
 -ğ
sTabË
[0];

76 
Block
::
	`Put
(
xÜBlock
, 
outBlock
)(
a
)(
b
);

77 
	}
}

79 
	gNAMESPACE_END


	@rc5.h

1 #iâdeà
CRYPTOPP_RC5_H


2 
	#CRYPTOPP_RC5_H


	)

7 
	~"£ckey.h
"

8 
	~"£cblock.h
"

10 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

13 
RC5_Info
 : 
public
 
FixedBlockSize
<8>,…ubliø
V¬ŸbËKeyL’gth
<16, 0, 255>,…ubliø
V¬ŸbËRounds
<16>

15 cÚ¡ *
	`SticAlgÜ™hmName
() { "RC5";}

16 
wÜd32
 
	tRC5_WORD
;

17 
	}
};

20 
şass
 
	gRC5
 : 
public
 
RC5_Info
,…ubliø
	gBlockCh”Docum’tiÚ


22 
şass
 
CRYPTOPP_NO_VTABLE
 
	gBa£
 : 
public
 
BlockCh”Im¶
<
RC5_Info
>

24 
public
:

25 
UncheckedS‘Key
(cÚ¡ 
by‹
 *
u£rKey
, 
Ëngth
, cÚ¡ 
NameV®uePaœs
 &
·¿ms
);

27 
	g´Ùeùed
:

28 
r
;

29 
	gSecBlock
<
	gRC5_WORD
> 
	gsTabË
;

32 şas 
	cCRYPTOPP_NO_VTABLE
 
	gEnc
 : 
public
 
Ba£


34 
public
:

35 
ProûssAndXÜBlock
(cÚ¡ 
by‹
 *
šBlock
, cÚ¡ by‹ *
xÜBlock
, by‹ *
outBlock
) const;

38 şas 
	cCRYPTOPP_NO_VTABLE
 
	gDec
 : 
public
 
Ba£


40 
public
:

41 
ProûssAndXÜBlock
(cÚ¡ 
by‹
 *
šBlock
, cÚ¡ by‹ *
xÜBlock
, by‹ *
outBlock
) const;

44 
	gpublic
:

45 
BlockCh”Fš®
<
	tENCRYPTION
, 
	tEnc
> 
	tEnüy±iÚ
;

46 
	gBlockCh”Fš®
<
	tDECRYPTION
, 
	tDec
> 
	tDeüy±iÚ
;

49 
	gRC5
::
	tEnüy±iÚ
 
	tRC5Enüy±iÚ
;

50 
	gRC5
::
	tDeüy±iÚ
 
	tRC5Deüy±iÚ
;

52 
	gNAMESPACE_END


	@rc6.cpp

4 
	~"pch.h
"

5 
	~"rc6.h
"

6 
	~"misc.h
"

8 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

10 
RC6
::
Ba£
::
	$UncheckedS‘Key
(cÚ¡ 
by‹
 *
k
, 
keyËn
, cÚ¡ 
NameV®uePaœs
 &
·¿ms
)

12 
	`As£¹V®idKeyL’gth
(
keyËn
);

14 
r
 = 
	`G‘RoundsAndThrowIfInv®id
(
·¿ms
, 
this
);

15 
sTabË
.
	`New
(2*(
r
+2));

17 cÚ¡ 
RC6_WORD
 
MAGIC_P
 = 0xb7e15163L;

18 cÚ¡ 
RC6_WORD
 
MAGIC_Q
 = 0x9e3779b9L;

19 cÚ¡ 
U
=(
RC6_WORD
);

21 cÚ¡ 
c
 = 
	`STDMAX
((
keyËn
+
U
-1)/U, 1U);

22 
SecBlock
<
RC6_WORD
> 
	`l
(
c
);

24 
	`G‘U£rKey
(
LITTLE_ENDIAN_ORDER
, 
l
.
	`begš
(), 
c
, 
k
, 
keyËn
);

26 
sTabË
[0] = 
MAGIC_P
;

27 
j
=1; j<
sTabË
.
	`size
();j++)

28 
sTabË
[
j
] = sTabË[j-1] + 
MAGIC_Q
;

30 
RC6_WORD
 
a
=0, 
b
=0;

31 cÚ¡ 
n
 = 3*
	`STDMAX
(()
sTabË
.
	`size
(), 
c
);

33 
h
=0; h < 
n
; h++)

35 
a
 = 
sTabË
[
h
 % sTabË.
	`size
()] = 
	`rÙlFixed
((sTabË[h % sTabË.size()] +‡ + 
b
), 3);

36 
b
 = 
l
[
h
 % 
c
] = 
	`rÙlMod
(Ö[h % c] + 
a
 + b), (a+b));

38 
	}
}

40 
	gBlockG‘AndPut
<
	tRC6
::
	tRC6_WORD
, 
	tL™eEndŸn
> 
	tBlock
;

42 
	gRC6
::
Enc
::
	$ProûssAndXÜBlock
(cÚ¡ 
by‹
 *
šBlock
, cÚ¡ by‹ *
xÜBlock
, by‹ *
outBlock
) const

44 cÚ¡ 
RC6_WORD
 *
¥Œ
 = 
sTabË
;

45 
RC6_WORD
 
a
, 
b
, 
c
, 
d
, 
t
, 
u
;

47 
Block
::
	`G‘
(
šBlock
)(
a
)(
b
)(
c
)(
d
);

48 
b
 +ğ
¥Œ
[0];

49 
d
 +ğ
¥Œ
[1];

50 
¥Œ
 += 2;

52 
i
=0; i<
r
; i++)

54 
t
 = 
	`rÙlFixed
(
b
*(2*b+1), 5);

55 
u
 = 
	`rÙlFixed
(
d
*(2*d+1), 5);

56 
a
 = 
	`rÙlMod
×^
t
,
u
è+ 
¥Œ
[0];

57 
c
 = 
	`rÙlMod
(c^
u
,
t
è+ 
¥Œ
[1];

58 
t
 = 
a
;‡ = 
b
; b = 
c
; c = 
d
; d =;

59 
¥Œ
 += 2;

62 
a
 +ğ
¥Œ
[0];

63 
c
 +ğ
¥Œ
[1];

65 
Block
::
	`Put
(
xÜBlock
, 
outBlock
)(
a
)(
b
)(
c
)(
d
);

66 
	}
}

68 
	gRC6
::
Dec
::
	$ProûssAndXÜBlock
(cÚ¡ 
by‹
 *
šBlock
, cÚ¡ by‹ *
xÜBlock
, by‹ *
outBlock
) const

70 cÚ¡ 
RC6_WORD
 *
¥Œ
 = 
sTabË
.
	`’d
();

71 
RC6_WORD
 
a
, 
b
, 
c
, 
d
, 
t
, 
u
;

73 
Block
::
	`G‘
(
šBlock
)(
a
)(
b
)(
c
)(
d
);

75 
¥Œ
 -= 2;

76 
c
 -ğ
¥Œ
[1];

77 
a
 -ğ
¥Œ
[0];

79 
i
=0; i < 
r
; i++)

81 
¥Œ
 -= 2;

82 
t
 = 
a
;‡ = 
d
; d = 
c
; c = 
b
; b =;

83 
u
 = 
	`rÙlFixed
(
d
*(2*d+1), 5);

84 
t
 = 
	`rÙlFixed
(
b
*(2*b+1), 5);

85 
c
 = 
	`rÙrMod
(c-
¥Œ
[1], 
t
è^ 
u
;

86 
a
 = 
	`rÙrMod
×-
¥Œ
[0], 
u
è^ 
t
;

89 
¥Œ
 -= 2;

90 
d
 -ğ
sTabË
[1];

91 
b
 -ğ
sTabË
[0];

93 
Block
::
	`Put
(
xÜBlock
, 
outBlock
)(
a
)(
b
)(
c
)(
d
);

94 
	}
}

96 
	gNAMESPACE_END


	@rc6.h

1 #iâdeà
CRYPTOPP_RC6_H


2 
	#CRYPTOPP_RC6_H


	)

7 
	~"£ckey.h
"

8 
	~"£cblock.h
"

10 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

13 
RC6_Info
 : 
public
 
FixedBlockSize
<16>,…ubliø
V¬ŸbËKeyL’gth
<16, 0, 255>,…ubliø
V¬ŸbËRounds
<20>

15 cÚ¡ *
	`SticAlgÜ™hmName
() { "RC6";}

16 
wÜd32
 
	tRC6_WORD
;

17 
	}
};

20 
şass
 
	gRC6
 : 
public
 
RC6_Info
,…ubliø
	gBlockCh”Docum’tiÚ


22 
şass
 
CRYPTOPP_NO_VTABLE
 
	gBa£
 : 
public
 
BlockCh”Im¶
<
RC6_Info
>

24 
public
:

25 
UncheckedS‘Key
(cÚ¡ 
by‹
 *
u£rKey
, 
Ëngth
, cÚ¡ 
NameV®uePaœs
 &
·¿ms
);

27 
	g´Ùeùed
:

28 
r
;

29 
	gSecBlock
<
	gRC6_WORD
> 
	gsTabË
;

32 şas 
	cCRYPTOPP_NO_VTABLE
 
	gEnc
 : 
public
 
Ba£


34 
public
:

35 
ProûssAndXÜBlock
(cÚ¡ 
by‹
 *
šBlock
, cÚ¡ by‹ *
xÜBlock
, by‹ *
outBlock
) const;

38 şas 
	cCRYPTOPP_NO_VTABLE
 
	gDec
 : 
public
 
Ba£


40 
public
:

41 
ProûssAndXÜBlock
(cÚ¡ 
by‹
 *
šBlock
, cÚ¡ by‹ *
xÜBlock
, by‹ *
outBlock
) const;

44 
	gpublic
:

45 
BlockCh”Fš®
<
	tENCRYPTION
, 
	tEnc
> 
	tEnüy±iÚ
;

46 
	gBlockCh”Fš®
<
	tDECRYPTION
, 
	tDec
> 
	tDeüy±iÚ
;

49 
	gRC6
::
	tEnüy±iÚ
 
	tRC6Enüy±iÚ
;

50 
	gRC6
::
	tDeüy±iÚ
 
	tRC6Deüy±iÚ
;

52 
	gNAMESPACE_END


	@rdtables.cpp

3 
	~"pch.h
"

5 #iâdeà
CRYPTOPP_IMPORTS


7 
	~"rijnd«l.h
"

12 
	$Rijnd«l_VC60WÜk¬ound
()

14 
	}
}

16 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

30 cÚ¡ 
by‹
 
Rijnd«l
::
Ba£
::
Se
[256] = {

95 
	}
};

97 cÚ¡ 
by‹
 
	gRijnd«l
::
Ba£
::
Sd
[256] = {

164 cÚ¡ 
wÜd32
 
	gRijnd«l
::
Ba£
::
rcÚ
[] = {

170 
	gNAMESPACE_END


	@regtest.cpp

1 
	~"çùÜy.h
"

3 
	#CRYPTOPP_ENABLE_NAMESPACE_WEAK
 1

	)

4 
	~"modes.h
"

5 
	~"dh.h
"

6 
	~"esign.h
"

7 
	~"md2.h
"

8 
	~"rw.h
"

9 
	~"md5.h
"

10 
	~"r§.h
"

11 
	~"remd.h
"

12 
	~"d§.h
"

13 
	~"£®.h
"

14 
	~"wh¾poŞ.h
"

15 
	~"‰mac.h
"

16 
	~"ÿm–lŸ.h
"

17 
	~"shaÿl2.h
"

18 
	~"‹a.h
"

19 
	~"·Çma.h
"

20 
	~"ps¤.h
"

21 
	~"«s.h
"

22 
	~"§l§.h
"

23 
	~"vmac.h
"

24 
	~"tig”.h
"

25 
	~"md5.h
"

26 
	~"so£mªuk.h
"

27 
	~"¬c4.h
"

28 
	~"ccm.h
"

29 
	~"gcm.h
"

30 
	~"—x.h
"

31 
	~"twofish.h
"

32 
	~"£½’t.h
"

33 
	~"ÿ¡.h
"

34 
	~"rc6.h
"

35 
	~"m¬s.h
"

36 
	~"des.h
"

37 
	~"id—.h
"

38 
	~"rc5.h
"

39 
	~"‹a.h
"

40 
	~"skjack.h
"

41 
	~"cmac.h
"

42 
	~"dmac.h
"

43 
	~"blowfish.h
"

44 
	~"£ed.h
"

45 
	~"wake.h
"

46 
	~"£®.h
"

47 
	~"üc.h
"

48 
	~"adËr32.h
"

49 
	~"sha3.h
"

51 
	$USING_NAMESPACE
(
Cry±oPP
)

53 
	$Regi¡”FaùÜ›s
()

55 
boŞ
 
s_»gi¡”ed
 = 
çl£
;

56 ià(
s_»gi¡”ed
)

59 
Regi¡”DeçuÉFaùÜyFÜ
<
Sim¶eKeyAg»em’tDomaš
, 
DH
>();

60 
Regi¡”DeçuÉFaùÜyFÜ
<
HashT¿nsfÜm©iÚ
, 
CRC32
>();

61 
Regi¡”DeçuÉFaùÜyFÜ
<
HashT¿nsfÜm©iÚ
, 
AdËr32
>();

62 
Regi¡”DeçuÉFaùÜyFÜ
<
HashT¿nsfÜm©iÚ
, 
W—k
::
MD5
>();

63 
Regi¡”DeçuÉFaùÜyFÜ
<
HashT¿nsfÜm©iÚ
, 
SHA1
>();

64 
Regi¡”DeçuÉFaùÜyFÜ
<
HashT¿nsfÜm©iÚ
, 
SHA224
>();

65 
Regi¡”DeçuÉFaùÜyFÜ
<
HashT¿nsfÜm©iÚ
, 
SHA256
>();

66 
Regi¡”DeçuÉFaùÜyFÜ
<
HashT¿nsfÜm©iÚ
, 
SHA384
>();

67 
Regi¡”DeçuÉFaùÜyFÜ
<
HashT¿nsfÜm©iÚ
, 
SHA512
>();

68 
Regi¡”DeçuÉFaùÜyFÜ
<
HashT¿nsfÜm©iÚ
, 
WhœÍoŞ
>();

69 
Regi¡”DeçuÉFaùÜyFÜ
<
HashT¿nsfÜm©iÚ
, 
Tig”
>();

70 
Regi¡”DeçuÉFaùÜyFÜ
<
HashT¿nsfÜm©iÚ
, 
RIPEMD160
>();

71 
Regi¡”DeçuÉFaùÜyFÜ
<
HashT¿nsfÜm©iÚ
, 
RIPEMD320
>();

72 
Regi¡”DeçuÉFaùÜyFÜ
<
HashT¿nsfÜm©iÚ
, 
RIPEMD128
>();

73 
Regi¡”DeçuÉFaùÜyFÜ
<
HashT¿nsfÜm©iÚ
, 
RIPEMD256
>();

74 
Regi¡”DeçuÉFaùÜyFÜ
<
HashT¿nsfÜm©iÚ
, 
W—k
::
PªamaHash
<
L™eEndŸn
> >();

75 
Regi¡”DeçuÉFaùÜyFÜ
<
HashT¿nsfÜm©iÚ
, 
W—k
::
PªamaHash
<
BigEndŸn
> >();

76 
Regi¡”DeçuÉFaùÜyFÜ
<
HashT¿nsfÜm©iÚ
, 
SHA3_224
>();

77 
Regi¡”DeçuÉFaùÜyFÜ
<
HashT¿nsfÜm©iÚ
, 
SHA3_256
>();

78 
Regi¡”DeçuÉFaùÜyFÜ
<
HashT¿nsfÜm©iÚ
, 
SHA3_384
>();

79 
Regi¡”DeçuÉFaùÜyFÜ
<
HashT¿nsfÜm©iÚ
, 
SHA3_512
>();

80 
Regi¡”DeçuÉFaùÜyFÜ
<
Mes§geAuth’tiÿtiÚCode
, 
HMAC
<
W—k
::
MD5
> >();

81 
Regi¡”DeçuÉFaùÜyFÜ
<
Mes§geAuth’tiÿtiÚCode
, 
HMAC
<
SHA1
> >();

82 
Regi¡”DeçuÉFaùÜyFÜ
<
Mes§geAuth’tiÿtiÚCode
, 
HMAC
<
RIPEMD160
> >();

83 
Regi¡”DeçuÉFaùÜyFÜ
<
Mes§geAuth’tiÿtiÚCode
, 
HMAC
<
SHA224
> >();

84 
Regi¡”DeçuÉFaùÜyFÜ
<
Mes§geAuth’tiÿtiÚCode
, 
HMAC
<
SHA256
> >();

85 
Regi¡”DeçuÉFaùÜyFÜ
<
Mes§geAuth’tiÿtiÚCode
, 
HMAC
<
SHA384
> >();

86 
Regi¡”DeçuÉFaùÜyFÜ
<
Mes§geAuth’tiÿtiÚCode
, 
HMAC
<
SHA512
> >();

87 
Regi¡”DeçuÉFaùÜyFÜ
<
Mes§geAuth’tiÿtiÚCode
, 
TTMAC
>();

88 
Regi¡”DeçuÉFaùÜyFÜ
<
Mes§geAuth’tiÿtiÚCode
, 
VMAC
<
AES
> >();

89 
Regi¡”DeçuÉFaùÜyFÜ
<
Mes§geAuth’tiÿtiÚCode
, 
VMAC
<
AES
, 64> >();

90 
Regi¡”DeçuÉFaùÜyFÜ
<
Mes§geAuth’tiÿtiÚCode
, 
W—k
::
PªamaMAC
<
L™eEndŸn
> >();

91 
Regi¡”DeçuÉFaùÜyFÜ
<
Mes§geAuth’tiÿtiÚCode
, 
W—k
::
PªamaMAC
<
BigEndŸn
> >();

92 
Regi¡”DeçuÉFaùÜyFÜ
<
Mes§geAuth’tiÿtiÚCode
, 
CMAC
<
AES
> >();

93 
Regi¡”DeçuÉFaùÜyFÜ
<
Mes§geAuth’tiÿtiÚCode
, 
DMAC
<
AES
> >();

94 
Regi¡”DeçuÉFaùÜyFÜ
<
Mes§geAuth’tiÿtiÚCode
, 
CMAC
<
DES_EDE3
> >();

95 
Regi¡”Asymm‘ricCh”DeçuÉFaùÜ›s
<
RSAES
<
OAEP
<
SHA1
> > >("RSA/OAEP-MGF1(SHA-1)");

96 
Regi¡”Asymm‘ricCh”DeçuÉFaùÜ›s
<
DLIES
<> >("DLIES(NoCofactorMultiplication, KDF2(SHA-1), XOR, HMAC(SHA-1), DHAES)");

97 
Regi¡”SigÇtu»SchemeDeçuÉFaùÜ›s
<
DSA
>();

98 
Regi¡”SigÇtu»SchemeDeçuÉFaùÜ›s
<
DSA2
<
SHA224
> >();

99 
Regi¡”SigÇtu»SchemeDeçuÉFaùÜ›s
<
DSA2
<
SHA256
> >();

100 
Regi¡”SigÇtu»SchemeDeçuÉFaùÜ›s
<
DSA2
<
SHA384
> >();

101 
Regi¡”SigÇtu»SchemeDeçuÉFaùÜ›s
<
DSA2
<
SHA512
> >();

102 
Regi¡”SigÇtu»SchemeDeçuÉFaùÜ›s
<
NR
<
SHA1
> >("NR(1363)/EMSA1(SHA-1)");

103 
Regi¡”SigÇtu»SchemeDeçuÉFaùÜ›s
<
GDSA
<
SHA1
> >("DSA-1363/EMSA1(SHA-1)");

104 
Regi¡”SigÇtu»SchemeDeçuÉFaùÜ›s
<
RSASS
<
PKCS1v15
, 
W—k
::
MD2
> >("RSA/PKCS1-1.5(MD2)");

105 
Regi¡”SigÇtu»SchemeDeçuÉFaùÜ›s
<
RSASS
<
PKCS1v15
, 
SHA1
> >("RSA/PKCS1-1.5(SHA-1)");

106 
Regi¡”SigÇtu»SchemeDeçuÉFaùÜ›s
<
ESIGN
<
SHA1
> >("ESIGN/EMSA5-MGF1(SHA-1)");

107 
Regi¡”SigÇtu»SchemeDeçuÉFaùÜ›s
<
RWSS
<
P1363_EMSA2
, 
SHA1
> >("RW/EMSA2(SHA-1)");

108 
Regi¡”SigÇtu»SchemeDeçuÉFaùÜ›s
<
RSASS
<
PSS
, 
SHA1
> >("RSA/PSS-MGF1(SHA-1)");

109 
Regi¡”Symm‘ricCh”DeçuÉFaùÜ›s
<
SEAL
<> >();

110 
Regi¡”Symm‘ricCh”DeçuÉFaùÜ›s
<
ECB_Mode
<
SHACAL2
> >();

111 
Regi¡”Symm‘ricCh”DeçuÉFaùÜ›s
<
ECB_Mode
<
Cam–lŸ
> >();

112 
Regi¡”Symm‘ricCh”DeçuÉFaùÜ›s
<
ECB_Mode
<
TEA
> >();

113 
Regi¡”Symm‘ricCh”DeçuÉFaùÜ›s
<
ECB_Mode
<
XTEA
> >();

114 
Regi¡”Symm‘ricCh”DeçuÉFaùÜ›s
<
PªamaCh”
<
L™eEndŸn
> >();

115 
Regi¡”Symm‘ricCh”DeçuÉFaùÜ›s
<
PªamaCh”
<
BigEndŸn
> >();

116 
Regi¡”Symm‘ricCh”DeçuÉFaùÜ›s
<
ECB_Mode
<
AES
> >();

117 
Regi¡”Symm‘ricCh”DeçuÉFaùÜ›s
<
CBC_Mode
<
AES
> >();

118 
Regi¡”Symm‘ricCh”DeçuÉFaùÜ›s
<
CFB_Mode
<
AES
> >();

119 
Regi¡”Symm‘ricCh”DeçuÉFaùÜ›s
<
OFB_Mode
<
AES
> >();

120 
Regi¡”Symm‘ricCh”DeçuÉFaùÜ›s
<
CTR_Mode
<
AES
> >();

121 
Regi¡”Symm‘ricCh”DeçuÉFaùÜ›s
<
S®§20
>();

122 
Regi¡”Symm‘ricCh”DeçuÉFaùÜ›s
<
XS®§20
>();

123 
Regi¡”Symm‘ricCh”DeçuÉFaùÜ›s
<
So£mªuk
>();

124 
Regi¡”Symm‘ricCh”DeçuÉFaùÜ›s
<
W—k
::
MARC4
>();

125 
Regi¡”Symm‘ricCh”DeçuÉFaùÜ›s
<
WAKE_OFB
<
L™eEndŸn
> >();

126 
Regi¡”Symm‘ricCh”DeçuÉFaùÜ›s
<
WAKE_OFB
<
BigEndŸn
> >();

127 
Regi¡”Symm‘ricCh”DeçuÉFaùÜ›s
<
SEAL
<
L™eEndŸn
> >();

128 
Regi¡”Auth’tiÿ‹dSymm‘ricCh”DeçuÉFaùÜ›s
<
CCM
<
AES
> >();

129 
Regi¡”Auth’tiÿ‹dSymm‘ricCh”DeçuÉFaùÜ›s
<
GCM
<
AES
> >();

130 
Regi¡”Auth’tiÿ‹dSymm‘ricCh”DeçuÉFaùÜ›s
<
EAX
<
AES
> >();

131 
Regi¡”Symm‘ricCh”DeçuÉFaùÜ›s
<
CTR_Mode
<
Cam–lŸ
> >();

132 
Regi¡”Symm‘ricCh”DeçuÉFaùÜ›s
<
CTR_Mode
<
Twofish
> >();

133 
Regi¡”Symm‘ricCh”DeçuÉFaùÜ›s
<
CTR_Mode
<
S”³Á
> >();

134 
Regi¡”Symm‘ricCh”DeçuÉFaùÜ›s
<
CTR_Mode
<
CAST256
> >();

135 
Regi¡”Symm‘ricCh”DeçuÉFaùÜ›s
<
CTR_Mode
<
RC6
> >();

136 
Regi¡”Symm‘ricCh”DeçuÉFaùÜ›s
<
ECB_Mode
<
MARS
> >();

137 
Regi¡”Symm‘ricCh”DeçuÉFaùÜ›s
<
CTR_Mode
<
MARS
> >();

138 
Regi¡”Symm‘ricCh”DeçuÉFaùÜ›s
<
CTR_Mode
<
SHACAL2
> >();

139 
Regi¡”Symm‘ricCh”DeçuÉFaùÜ›s
<
CTR_Mode
<
DES
> >();

140 
Regi¡”Symm‘ricCh”DeçuÉFaùÜ›s
<
CTR_Mode
<
DES_XEX3
> >();

141 
Regi¡”Symm‘ricCh”DeçuÉFaùÜ›s
<
CTR_Mode
<
DES_EDE3
> >();

142 
Regi¡”Symm‘ricCh”DeçuÉFaùÜ›s
<
CTR_Mode
<
IDEA
> >();

143 
Regi¡”Symm‘ricCh”DeçuÉFaùÜ›s
<
CTR_Mode
<
RC5
> >();

144 
Regi¡”Symm‘ricCh”DeçuÉFaùÜ›s
<
CTR_Mode
<
TEA
> >();

145 
Regi¡”Symm‘ricCh”DeçuÉFaùÜ›s
<
CTR_Mode
<
XTEA
> >();

146 
Regi¡”Symm‘ricCh”DeçuÉFaùÜ›s
<
CTR_Mode
<
CAST128
> >();

147 
Regi¡”Symm‘ricCh”DeçuÉFaùÜ›s
<
CTR_Mode
<
SKIPJACK
> >();

148 
Regi¡”Symm‘ricCh”DeçuÉFaùÜ›s
<
CTR_Mode
<
Blowfish
> >();

149 
Regi¡”Symm‘ricCh”DeçuÉFaùÜ›s
<
ECB_Mode
<
SEED
> >();

150 
Regi¡”Symm‘ricCh”DeçuÉFaùÜ›s
<
CTR_Mode
<
SEED
> >();

152 
s_»gi¡”ed
 = 
Œue
;

153 
	}
}

	@resource.h

8 #ifdeà
APSTUDIO_INVOKED


9 #iâdeà
APSTUDIO_READONLY_SYMBOLS


10 
	#_APS_NEXT_RESOURCE_VALUE
 101

	)

11 
	#_APS_NEXT_COMMAND_VALUE
 40001

	)

12 
	#_APS_NEXT_CONTROL_VALUE
 1000

	)

13 
	#_APS_NEXT_SYMED_VALUE
 101

	)

	@rijndael.cpp

67 
	~"pch.h
"

69 #iâdeà
CRYPTOPP_IMPORTS


70 #iâdeà
CRYPTOPP_GENERATE_X64_MASM


72 
	~"rijnd«l.h
"

73 
	~"misc.h
"

74 
	~"ıu.h
"

76 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

78 #ifdeà
CRYPTOPP_ALLOW_UNALIGNED_DATA_ACCESS


79 #ià
CRYPTOPP_BOOL_SSE2_ASM_AVAILABLE
 || 
	`defšed
(
CRYPTOPP_X64_MASM_AVAILABLE
)

80 
Çme¥aû
 
rdbË
 {
	`CRYPTOPP_ALIGN_DATA
(16è
wÜd64
 
Te
[256+2];
	}
}

81 
usšg
 
Çme¥aû
 
	grdbË
;

83 
wÜd64
 
	gTe
[256];

85 
wÜd64
 
	gTd
[256];

87 
wÜd32
 
	gTe
[256*4], 
	gTd
[256*4];

89 vŞ©
boŞ
 
	gs_TeFËd
 = 
çl£
, 
	gs_TdFËd
 = false;

93 
	#QUARTER_ROUND
(
L
, 
T
, 
t
, 
a
, 
b
, 
c
, 
d
) \

94 
a
 ^ğ
	`L
(
T
, 3, 
	`by‹
(
t
)); >>= 8;\

95 
b
 ^ğ
	`L
(
T
, 2, 
	`by‹
(
t
)); >>= 8;\

96 
c
 ^ğ
	`L
(
T
, 1, 
	`by‹
(
t
)); >>= 8;\

97 
d
 ^ğ
	`L
(
T
, 0, 
t
);

	)

99 
	#QUARTER_ROUND_LE
(
t
, 
a
, 
b
, 
c
, 
d
) \

100 
‹mpBlock
[
a
] = ((
by‹
 *)(
Te
+
	`by‹
(
t
)))[1]; >>= 8;\

101 
‹mpBlock
[
b
] = ((
by‹
 *)(
Te
+
	`by‹
(
t
)))[1]; >>= 8;\

102 
‹mpBlock
[
c
] = ((
by‹
 *)(
Te
+
	`by‹
(
t
)))[1]; >>= 8;\

103 
‹mpBlock
[
d
] = ((
by‹
 *)(
Te
+
t
))[1];

	)

105 #ifdeà
CRYPTOPP_ALLOW_UNALIGNED_DATA_ACCESS


106 
	#QUARTER_ROUND_LD
(
t
, 
a
, 
b
, 
c
, 
d
) \

107 
‹mpBlock
[
a
] = ((
by‹
 *)(
Td
+
	`by‹
(
t
)))[
	`G‘N©iveBy‹Ord”
()*7]; >>= 8;\

108 
‹mpBlock
[
b
] = ((
by‹
 *)(
Td
+
	`by‹
(
t
)))[
	`G‘N©iveBy‹Ord”
()*7]; >>= 8;\

109 
‹mpBlock
[
c
] = ((
by‹
 *)(
Td
+
	`by‹
(
t
)))[
	`G‘N©iveBy‹Ord”
()*7]; >>= 8;\

110 
‹mpBlock
[
d
] = ((
by‹
 *)(
Td
+
t
))[
	`G‘N©iveBy‹Ord”
()*7];

	)

112 
	#QUARTER_ROUND_LD
(
t
, 
a
, 
b
, 
c
, 
d
) \

113 
‹mpBlock
[
a
] = 
Sd
[
	`by‹
(
t
)]; >>= 8;\

114 
‹mpBlock
[
b
] = 
Sd
[
	`by‹
(
t
)]; >>= 8;\

115 
‹mpBlock
[
c
] = 
Sd
[
	`by‹
(
t
)]; >>= 8;\

116 
‹mpBlock
[
d
] = 
Sd
[
t
];

	)

119 
	#QUARTER_ROUND_E
(
t
, 
a
, 
b
, 
c
, 
d
è
	`QUARTER_ROUND
(
TL_M
, 
Te
,,‡, b, c, d)

	)

120 
	#QUARTER_ROUND_D
(
t
, 
a
, 
b
, 
c
, 
d
è
	`QUARTER_ROUND
(
TL_M
, 
Td
,,‡, b, c, d)

	)

122 #ifdeà
IS_LITTLE_ENDIAN


123 
	#QUARTER_ROUND_FE
(
t
, 
a
, 
b
, 
c
, 
d
è
	`QUARTER_ROUND
(
TL_F
, 
Te
,, d, c, b,‡)

	)

124 
	#QUARTER_ROUND_FD
(
t
, 
a
, 
b
, 
c
, 
d
è
	`QUARTER_ROUND
(
TL_F
, 
Td
,, d, c, b,‡)

	)

125 #ifdeà
CRYPTOPP_ALLOW_UNALIGNED_DATA_ACCESS


126 
	#TL_F
(
T
, 
i
, 
x
è(*(
wÜd32
 *)((
by‹
 *)T + x*8 + (6-i)%4+1))

	)

127 
	#TL_M
(
T
, 
i
, 
x
è(*(
wÜd32
 *)((
by‹
 *)T + x*8 + (i+3)%4+1))

	)

129 
	#TL_F
(
T
, 
i
, 
x
è
	`rÙrFixed
(T[x], (3-i)*8)

	)

130 
	#TL_M
(
T
, 
i
, 
x
èT[i*256 + x]

	)

133 
	#QUARTER_ROUND_FE
(
t
, 
a
, 
b
, 
c
, 
d
è
	`QUARTER_ROUND
(
TL_F
, 
Te
,,‡, b, c, d)

	)

134 
	#QUARTER_ROUND_FD
(
t
, 
a
, 
b
, 
c
, 
d
è
	`QUARTER_ROUND
(
TL_F
, 
Td
,,‡, b, c, d)

	)

135 #ifdeà
CRYPTOPP_ALLOW_UNALIGNED_DATA_ACCESS


136 
	#TL_F
(
T
, 
i
, 
x
è(*(
wÜd32
 *)((
by‹
 *)T + x*8 + (4-i)%4))

	)

137 
	#TL_M
 
TL_F


	)

139 
	#TL_F
(
T
, 
i
, 
x
è
	`rÙrFixed
(T[x], i*8)

	)

140 
	#TL_M
(
T
, 
i
, 
x
èT[i*256 + x]

	)

145 
	#f2
(
x
è((x<<1)^(((x>>7)&1)*0x11b))

	)

146 
	#f4
(
x
è((x<<2)^(((x>>6)&1)*0x11b)^(((x>>6)&2)*0x11b))

	)

147 
	#f8
(
x
è((x<<3)^(((x>>5)&1)*0x11b)^(((x>>5)&2)*0x11b)^(((x>>5)&4)*0x11b))

	)

149 
	#f3
(
x
è(
	`f2
(xè^ x)

	)

150 
	#f9
(
x
è(
	`f8
(xè^ x)

	)

151 
	#fb
(
x
è(
	`f8
(xè^ 
	`f2
(xè^ x)

	)

152 
	#fd
(
x
è(
	`f8
(xè^ 
	`f4
(xè^ x)

	)

153 
	#ã
(
x
è(
	`f8
(xè^ 
	`f4
(xè^ 
	`f2
(x))

	)

155 
	gRijnd«l
::
Ba£
::
	$FlEncTabË
()

157 
i
=0; i<256; i++)

159 
by‹
 
x
 = 
Se
[
i
];

160 #ifdeà
CRYPTOPP_ALLOW_UNALIGNED_DATA_ACCESS


161 
wÜd32
 
y
 = 
	`wÜd32
(
x
)<<8 | wÜd32(x)<<16 | wÜd32(
	`f2
(x))<<24;

162 
Te
[
i
] = 
	`wÜd64
(
y
 | 
	`f3
(
x
))<<32 | y;

164 
wÜd32
 
y
 = 
	`f3
(
x
è| 
	`wÜd32
(x)<<8 | wÜd32(x)<<16 | wÜd32(
	`f2
(x))<<24;

165 
j
=0; j<4; j++)

167 
Te
[
i
+
j
*256] = 
y
;

168 
y
 = 
	`rÙrFixed
(y, 8);

172 #ià
CRYPTOPP_BOOL_SSE2_ASM_AVAILABLE
 || 
	`defšed
(
CRYPTOPP_X64_MASM_AVAILABLE
)

173 
Te
[256] = Te[257] = 0;

175 
s_TeFËd
 = 
Œue
;

176 
	}
}

178 
	gRijnd«l
::
Ba£
::
	$FlDecTabË
()

180 
i
=0; i<256; i++)

182 
by‹
 
x
 = 
Sd
[
i
];

183 #ifdeà
CRYPTOPP_ALLOW_UNALIGNED_DATA_ACCESS


184 
wÜd32
 
y
 = 
	`wÜd32
(
	`fd
(
x
))<<8 | wÜd32(
	`f9
(x))<<16 | wÜd32(
	`ã
(x))<<24;

185 
Td
[
i
] = 
	`wÜd64
(
y
 | 
	`fb
(
x
))<<32 | y | x;

187 
wÜd32
 
y
 = 
	`fb
(
x
è| 
	`wÜd32
(
	`fd
(x))<<8 | wÜd32(
	`f9
(x))<<16 | wÜd32(
	`ã
(x))<<24;;

188 
j
=0; j<4; j++)

190 
Td
[
i
+
j
*256] = 
y
;

191 
y
 = 
	`rÙrFixed
(y, 8);

195 
s_TdFËd
 = 
Œue
;

196 
	}
}

198 
	gRijnd«l
::
Ba£
::
	$UncheckedS‘Key
(cÚ¡ 
by‹
 *
u£rKey
, 
keyËn
, cÚ¡ 
NameV®uePaœs
 &)

200 
	`As£¹V®idKeyL’gth
(
keyËn
);

202 
m_rounds
 = 
keyËn
/4 + 6;

203 
m_key
.
	`New
(4*(
m_rounds
+1));

205 
wÜd32
 *
rk
 = 
m_key
;

207 #ià
CRYPTOPP_BOOL_AESNI_INTRINSICS_AVAILABLE
 && (!
	`defšed
(
_MSC_VER
è|| _MSC_VER >ğ1600 || 
CRYPTOPP_BOOL_X86
)

209 ià(
	`HasAESNI
())

211 cÚ¡ 
wÜd32
 
rcLE
[] = {

216 cÚ¡ 
wÜd32
 *
rc
 = 
rcLE
;

218 
__m128i
 
‹mp
 = 
	`_mm_lßdu_si128
((__m128˜*)(
u£rKey
+
keyËn
-16));

219 
	`memıy
(
rk
, 
u£rKey
, 
keyËn
);

221 
Œue
)

223 
rk
[
keyËn
/4] =„k[0] ^ 
	`_mm_exŒaù_•i32
(
	`_mm_«skeyg’assi¡_si128
(
‹mp
, 0), 3è^ *(
rc
++);

224 
rk
[
keyËn
/4+1] =„k[1] ^„k[keylen/4];

225 
rk
[
keyËn
/4+2] =„k[2] ^„k[keylen/4+1];

226 
rk
[
keyËn
/4+3] =„k[3] ^„k[keylen/4+2];

228 ià(
rk
 + 
keyËn
/4 + 4 =ğ
m_key
.
	`’d
())

231 ià(
keyËn
 == 24)

233 
rk
[10] =„k[ 4] ^„k[ 9];

234 
rk
[11] =„k[ 5] ^„k[10];

235 
‹mp
 = 
	`_mm_š£¹_•i32
Ñemp, 
rk
[11], 3);

237 ià(
keyËn
 == 32)

239 
‹mp
 = 
	`_mm_š£¹_•i32
Ñemp, 
rk
[11], 3);

240 
rk
[12] =„k[ 4] ^ 
	`_mm_exŒaù_•i32
(
	`_mm_«skeyg’assi¡_si128
(
‹mp
, 0), 2);

241 
rk
[13] =„k[ 5] ^„k[12];

242 
rk
[14] =„k[ 6] ^„k[13];

243 
rk
[15] =„k[ 7] ^„k[14];

244 
‹mp
 = 
	`_mm_š£¹_•i32
Ñemp, 
rk
[15], 3);

247 
‹mp
 = 
	`_mm_š£¹_•i32
Ñemp, 
rk
[7], 3);

249 
rk
 +ğ
keyËn
/4;

252 ià(!
	`IsFÜw¬dT¿nsfÜm©iÚ
())

254 
rk
 = 
m_key
;

255 
i
, 
j
;

257 
¡d
::
	`sw­
(*(
__m128i
 *)(
rk
), *(__m128˜*)Ôk+4*
m_rounds
));

259 
i
 = 4, 
j
 = 4*
m_rounds
-4; i < j; i += 4, j -= 4)

261 
‹mp
 = 
	`_mm_«simc_si128
(*(
__m128i
 *)(
rk
+
i
));

262 *(
__m128i
 *)(
rk
+
i
èğ
	`_mm_«simc_si128
(*(__m128˜*)Ôk+
j
));

263 *(
__m128i
 *)(
rk
+
j
èğ
‹mp
;

266 *(
__m128i
 *)(
rk
+
i
èğ
	`_mm_«simc_si128
(*(__m128i *)(rk+i));

273 
	`G‘U£rKey
(
BIG_ENDIAN_ORDER
, 
rk
, 
keyËn
/4, 
u£rKey
, keylen);

274 cÚ¡ 
wÜd32
 *
rc
 = 
rcÚ
;

275 
wÜd32
 
‹mp
;

277 
Œue
)

279 
‹mp
 = 
rk
[
keyËn
/4-1];

280 
wÜd32
 
x
 = (
	`wÜd32
(
Se
[
	`GETBYTE
(
‹mp
, 2)]) << 24) ^ (word32(Se[GETBYTE(temp, 1)]) << 16) ^ (word32(Se[GETBYTE(temp, 0)]) << 8) ^ Se[GETBYTE(temp, 3)];

281 
rk
[
keyËn
/4] =„k[0] ^ 
x
 ^ *(
rc
++);

282 
rk
[
keyËn
/4+1] =„k[1] ^„k[keylen/4];

283 
rk
[
keyËn
/4+2] =„k[2] ^„k[keylen/4+1];

284 
rk
[
keyËn
/4+3] =„k[3] ^„k[keylen/4+2];

286 ià(
rk
 + 
keyËn
/4 + 4 =ğ
m_key
.
	`’d
())

289 ià(
keyËn
 == 24)

291 
rk
[10] =„k[ 4] ^„k[ 9];

292 
rk
[11] =„k[ 5] ^„k[10];

294 ià(
keyËn
 == 32)

296 
‹mp
 = 
rk
[11];

297 
rk
[12] =„k[ 4] ^ (
	`wÜd32
(
Se
[
	`GETBYTE
(
‹mp
, 3)]) << 24) ^ (word32(Se[GETBYTE(temp, 2)]) << 16) ^ (word32(Se[GETBYTE(temp, 1)]) << 8) ^ Se[GETBYTE(temp, 0)];

298 
rk
[13] =„k[ 5] ^„k[12];

299 
rk
[14] =„k[ 6] ^„k[13];

300 
rk
[15] =„k[ 7] ^„k[14];

302 
rk
 +ğ
keyËn
/4;

305 
rk
 = 
m_key
;

307 ià(
	`IsFÜw¬dT¿nsfÜm©iÚ
())

309 ià(!
s_TeFËd
)

310 
	`FlEncTabË
();

312 
	`CÚd™iÚ®By‹Rev”£
(
BIG_ENDIAN_ORDER
, 
rk
,„k, 16);

313 
	`CÚd™iÚ®By‹Rev”£
(
BIG_ENDIAN_ORDER
, 
rk
 + 
m_rounds
*4,„k + m_rounds*4, 16);

317 ià(!
s_TdFËd
)

318 
	`FlDecTabË
();

320 
i
, 
j
;

322 
	#Inv”£MixCŞumn
(
x
è
	`TL_M
(
Td
, 0, 
Se
[
	`GETBYTE
(x, 3)]è^ TL_M(Td, 1, Se[GETBYTE(x, 2)]è^ TL_M(Td, 2, Se[GETBYTE(x, 1)]è^ TL_M(Td, 3, Se[GETBYTE(x, 0)])

	)

324 
i
 = 4, 
j
 = 4*
m_rounds
-4; i < j; i += 4, j -= 4)

326 
‹mp
 = 
	`Inv”£MixCŞumn
(
rk
[
i
 ]);„k[˜] = Inv”£MixCŞumnÔk[
j
 ]);„k[j ] =emp;

327 
‹mp
 = 
	`Inv”£MixCŞumn
(
rk
[
i
 + 1]);„k[˜+ 1] = Inv”£MixCŞumnÔk[
j
 + 1]);„k[j + 1] =emp;

328 
‹mp
 = 
	`Inv”£MixCŞumn
(
rk
[
i
 + 2]);„k[˜+ 2] = Inv”£MixCŞumnÔk[
j
 + 2]);„k[j + 2] =emp;

329 
‹mp
 = 
	`Inv”£MixCŞumn
(
rk
[
i
 + 3]);„k[˜+ 3] = Inv”£MixCŞumnÔk[
j
 + 3]);„k[j + 3] =emp;

332 
rk
[
i
+0] = 
	`Inv”£MixCŞumn
(rk[i+0]);

333 
rk
[
i
+1] = 
	`Inv”£MixCŞumn
(rk[i+1]);

334 
rk
[
i
+2] = 
	`Inv”£MixCŞumn
(rk[i+2]);

335 
rk
[
i
+3] = 
	`Inv”£MixCŞumn
(rk[i+3]);

337 
‹mp
 = 
	`CÚd™iÚ®By‹Rev”£
(
BIG_ENDIAN_ORDER
, 
rk
[0]);„k[0] = CÚd™iÚ®By‹Rev”£(BIG_ENDIAN_ORDER,„k[4*
m_rounds
+0]);„k[4*m_rounds+0] =emp;

338 
‹mp
 = 
	`CÚd™iÚ®By‹Rev”£
(
BIG_ENDIAN_ORDER
, 
rk
[1]);„k[1] = CÚd™iÚ®By‹Rev”£(BIG_ENDIAN_ORDER,„k[4*
m_rounds
+1]);„k[4*m_rounds+1] =emp;

339 
‹mp
 = 
	`CÚd™iÚ®By‹Rev”£
(
BIG_ENDIAN_ORDER
, 
rk
[2]);„k[2] = CÚd™iÚ®By‹Rev”£(BIG_ENDIAN_ORDER,„k[4*
m_rounds
+2]);„k[4*m_rounds+2] =emp;

340 
‹mp
 = 
	`CÚd™iÚ®By‹Rev”£
(
BIG_ENDIAN_ORDER
, 
rk
[3]);„k[3] = CÚd™iÚ®By‹Rev”£(BIG_ENDIAN_ORDER,„k[4*
m_rounds
+3]);„k[4*m_rounds+3] =emp;

343 #ià
CRYPTOPP_BOOL_AESNI_INTRINSICS_AVAILABLE


344 ià(
	`HasAESNI
())

345 
	`CÚd™iÚ®By‹Rev”£
(
BIG_ENDIAN_ORDER
, 
rk
+4,„k+4, (
m_rounds
-1)*16);

347 
	}
}

349 
	gRijnd«l
::
Enc
::
	$ProûssAndXÜBlock
(cÚ¡ 
by‹
 *
šBlock
, cÚ¡ by‹ *
xÜBlock
, by‹ *
outBlock
) const

351 #ià
CRYPTOPP_BOOL_SSE2_ASM_AVAILABLE
 || 
	`defšed
(
CRYPTOPP_X64_MASM_AVAILABLE
è|| 
CRYPTOPP_BOOL_AESNI_INTRINSICS_AVAILABLE


352 #ià
CRYPTOPP_BOOL_SSE2_ASM_AVAILABLE
 || 
	`defšed
(
CRYPTOPP_X64_MASM_AVAILABLE
)

353 ià(
	`HasSSE2
())

355 ià(
	`HasAESNI
())

358 
Rijnd«l
::
Enc
::
	`AdvªûdProûssBlocks
(
šBlock
, 
xÜBlock
, 
outBlock
, 16, 0);

363 
BlockG‘AndPut
<
	twÜd32
, 
	tN©iveBy‹Ord”
> 
	tBlock
;

365 
wÜd32
 
s0
, 
s1
, 
s2
, 
s3
, 
t0
, 
t1
, 
t2
, 
t3
;

366 
Block
::
	`G‘
(
šBlock
)(
s0
)(
s1
)(
s2
)(
s3
);

368 cÚ¡ 
wÜd32
 *
rk
 = 
m_key
;

369 
s0
 ^ğ
rk
[0];

370 
s1
 ^ğ
rk
[1];

371 
s2
 ^ğ
rk
[2];

372 
s3
 ^ğ
rk
[3];

373 
t0
 = 
rk
[4];

374 
t1
 = 
rk
[5];

375 
t2
 = 
rk
[6];

376 
t3
 = 
rk
[7];

377 
rk
 += 8;

380 cÚ¡ 
ÿcheLšeSize
 = 
	`G‘CacheLšeSize
();

381 
i
;

382 
wÜd32
 
u
 = 0;

383 #ifdeà
CRYPTOPP_ALLOW_UNALIGNED_DATA_ACCESS


384 
i
=0; i<2048; i+=
ÿcheLšeSize
)

386 
i
=0; i<1024; i+=
ÿcheLšeSize
)

388 
u
 &ğ*(cÚ¡ 
wÜd32
 *)(((cÚ¡ 
by‹
 *)
Te
)+
i
);

389 
u
 &ğ
Te
[255];

390 
s0
 |ğ
u
; 
s1
 |ğu; 
s2
 |ğu; 
s3
 |= u;

392 
	`QUARTER_ROUND_FE
(
s3
, 
t0
, 
t1
, 
t2
, 
t3
)

393 
	`QUARTER_ROUND_FE
(
s2
, 
t3
, 
t0
, 
t1
, 
t2
)

394 
	`QUARTER_ROUND_FE
(
s1
, 
t2
, 
t3
, 
t0
, 
t1
)

395 
	`QUARTER_ROUND_FE
(
s0
, 
t1
, 
t2
, 
t3
, 
t0
)

398 
r
 = 
m_rounds
/2 - 1;

401 
s0
 = 
rk
[0]; 
s1
 =„k[1]; 
s2
 =„k[2]; 
s3
 =„k[3];

403 
	`QUARTER_ROUND_E
(
t3
, 
s0
, 
s1
, 
s2
, 
s3
)

404 
	`QUARTER_ROUND_E
(
t2
, 
s3
, 
s0
, 
s1
, 
s2
)

405 
	`QUARTER_ROUND_E
(
t1
, 
s2
, 
s3
, 
s0
, 
s1
)

406 
	`QUARTER_ROUND_E
(
t0
, 
s1
, 
s2
, 
s3
, 
s0
)

408 
t0
 = 
rk
[4]; 
t1
 =„k[5]; 
t2
 =„k[6]; 
t3
 =„k[7];

410 
	`QUARTER_ROUND_E
(
s3
, 
t0
, 
t1
, 
t2
, 
t3
)

411 
	`QUARTER_ROUND_E
(
s2
, 
t3
, 
t0
, 
t1
, 
t2
)

412 
	`QUARTER_ROUND_E
(
s1
, 
t2
, 
t3
, 
t0
, 
t1
)

413 
	`QUARTER_ROUND_E
(
s0
, 
t1
, 
t2
, 
t3
, 
t0
)

415 
rk
 += 8;

416 } --
r
);

418 
wÜd32
 
tbw
[4];

419 
by‹
 *cÚ¡ 
‹mpBlock
 = (by‹ *)
tbw
;

421 
	`QUARTER_ROUND_LE
(
t2
, 15, 2, 5, 8)

422 
	`QUARTER_ROUND_LE
(
t1
, 11, 14, 1, 4)

423 
	`QUARTER_ROUND_LE
(
t0
, 7, 10, 13, 0)

424 
	`QUARTER_ROUND_LE
(
t3
, 3, 6, 9, 12)

426 
Block
::
	`Put
(
xÜBlock
, 
outBlock
)(
tbw
[0]^
rk
[0])(tbw[1]^rk[1])(tbw[2]^rk[2])(tbw[3]^rk[3]);

427 
	}
}

429 
	gRijnd«l
::
Dec
::
	$ProûssAndXÜBlock
(cÚ¡ 
by‹
 *
šBlock
, cÚ¡ by‹ *
xÜBlock
, by‹ *
outBlock
) const

431 #ià
CRYPTOPP_BOOL_AESNI_INTRINSICS_AVAILABLE


432 ià(
	`HasAESNI
())

434 
Rijnd«l
::
Dec
::
	`AdvªûdProûssBlocks
(
šBlock
, 
xÜBlock
, 
outBlock
, 16, 0);

439 
BlockG‘AndPut
<
	twÜd32
, 
	tN©iveBy‹Ord”
> 
	tBlock
;

441 
wÜd32
 
s0
, 
s1
, 
s2
, 
s3
, 
t0
, 
t1
, 
t2
, 
t3
;

442 
Block
::
	`G‘
(
šBlock
)(
s0
)(
s1
)(
s2
)(
s3
);

444 cÚ¡ 
wÜd32
 *
rk
 = 
m_key
;

445 
s0
 ^ğ
rk
[0];

446 
s1
 ^ğ
rk
[1];

447 
s2
 ^ğ
rk
[2];

448 
s3
 ^ğ
rk
[3];

449 
t0
 = 
rk
[4];

450 
t1
 = 
rk
[5];

451 
t2
 = 
rk
[6];

452 
t3
 = 
rk
[7];

453 
rk
 += 8;

456 cÚ¡ 
ÿcheLšeSize
 = 
	`G‘CacheLšeSize
();

457 
i
;

458 
wÜd32
 
u
 = 0;

459 #ifdeà
CRYPTOPP_ALLOW_UNALIGNED_DATA_ACCESS


460 
i
=0; i<2048; i+=
ÿcheLšeSize
)

462 
i
=0; i<1024; i+=
ÿcheLšeSize
)

464 
u
 &ğ*(cÚ¡ 
wÜd32
 *)(((cÚ¡ 
by‹
 *)
Td
)+
i
);

465 
u
 &ğ
Td
[255];

466 
s0
 |ğ
u
; 
s1
 |ğu; 
s2
 |ğu; 
s3
 |= u;

468 
	`QUARTER_ROUND_FD
(
s3
, 
t2
, 
t1
, 
t0
, 
t3
)

469 
	`QUARTER_ROUND_FD
(
s2
, 
t1
, 
t0
, 
t3
, 
t2
)

470 
	`QUARTER_ROUND_FD
(
s1
, 
t0
, 
t3
, 
t2
, 
t1
)

471 
	`QUARTER_ROUND_FD
(
s0
, 
t3
, 
t2
, 
t1
, 
t0
)

474 
r
 = 
m_rounds
/2 - 1;

477 
s0
 = 
rk
[0]; 
s1
 =„k[1]; 
s2
 =„k[2]; 
s3
 =„k[3];

479 
	`QUARTER_ROUND_D
(
t3
, 
s2
, 
s1
, 
s0
, 
s3
)

480 
	`QUARTER_ROUND_D
(
t2
, 
s1
, 
s0
, 
s3
, 
s2
)

481 
	`QUARTER_ROUND_D
(
t1
, 
s0
, 
s3
, 
s2
, 
s1
)

482 
	`QUARTER_ROUND_D
(
t0
, 
s3
, 
s2
, 
s1
, 
s0
)

484 
t0
 = 
rk
[4]; 
t1
 =„k[5]; 
t2
 =„k[6]; 
t3
 =„k[7];

486 
	`QUARTER_ROUND_D
(
s3
, 
t2
, 
t1
, 
t0
, 
t3
)

487 
	`QUARTER_ROUND_D
(
s2
, 
t1
, 
t0
, 
t3
, 
t2
)

488 
	`QUARTER_ROUND_D
(
s1
, 
t0
, 
t3
, 
t2
, 
t1
)

489 
	`QUARTER_ROUND_D
(
s0
, 
t3
, 
t2
, 
t1
, 
t0
)

491 
rk
 += 8;

492 } --
r
);

494 #iâdeà
CRYPTOPP_ALLOW_UNALIGNED_DATA_ACCESS


498 
u
 = 0;

499 
i
=0; i<256; i+=
ÿcheLšeSize
)

500 
u
 &ğ*(cÚ¡ 
wÜd32
 *)(
Sd
+
i
);

501 
u
 &ğ*(cÚ¡ 
wÜd32
 *)(
Sd
+252);

502 
t0
 |ğ
u
; 
t1
 |ğu; 
t2
 |ğu; 
t3
 |= u;

505 
wÜd32
 
tbw
[4];

506 
by‹
 *cÚ¡ 
‹mpBlock
 = (by‹ *)
tbw
;

508 
	`QUARTER_ROUND_LD
(
t2
, 7, 2, 13, 8)

509 
	`QUARTER_ROUND_LD
(
t1
, 3, 14, 9, 4)

510 
	`QUARTER_ROUND_LD
(
t0
, 15, 10, 5, 0)

511 
	`QUARTER_ROUND_LD
(
t3
, 11, 6, 1, 12)

513 
Block
::
	`Put
(
xÜBlock
, 
outBlock
)(
tbw
[0]^
rk
[0])(tbw[1]^rk[1])(tbw[2]^rk[2])(tbw[3]^rk[3]);

514 
	}
}

518 #´agm¨
w¬nšg
(
di§bË
: 4731)

522 #ià
CRYPTOPP_BOOL_SSE2_ASM_AVAILABLE


524 
CRYPTOPP_NAKED
 
CRYPTOPP_FASTCALL
 
	$Rijnd«l_Enc_AdvªûdProûssBlocks
(*
loÿls
, cÚ¡ 
wÜd32
 *
k
)

526 #ià
CRYPTOPP_BOOL_X86


528 
	#L_REG
 
e¥


	)

529 
	#L_INDEX
(
i
è(
L_REG
+768+i)

	)

530 
	#L_INXORBLOCKS
 
L_INBLOCKS
+4

	)

531 
	#L_OUTXORBLOCKS
 
L_INBLOCKS
+8

	)

532 
	#L_OUTBLOCKS
 
L_INBLOCKS
+12

	)

533 
	#L_INCREMENTS
 
	`L_INDEX
(16*15)

	)

534 
	#L_SP
 
	`L_INDEX
(16*16)

	)

535 
	#L_LENGTH
 
	`L_INDEX
(16*16+4)

	)

536 
	#L_KEYS_BEGIN
 
	`L_INDEX
(16*16+8)

	)

538 
	#MOVD
 
movd


	)

539 
	#MM
(
i
è
mm
##
	)
i

541 
	#MXOR
(
a
,
b
,
c
) \

542 
	`AS2
Ğ
movzx
 
esi
, 
b
)\

543 
	`AS2
Ğ
movd
 
mm7
, 
DWORD
 
PTR
 [
AS_REG_7
+8*
	`WORD_REG
(
si
)+
	`MAP0TO4
(
c
)])\

544 
	`AS2
Ğ
pxÜ
 
	`MM
(
a
), 
mm7
)\

545 

	)

546 
	#MMOV
(
a
,
b
,
c
) \

547 
	`AS2
Ğ
movzx
 
esi
, 
b
)\

548 
	`AS2
Ğ
movd
 
	`MM
(
a
), 
DWORD
 
PTR
 [
AS_REG_7
+8*
	`WORD_REG
(
si
)+
	`MAP0TO4
(
c
)])\

549 

	)

552 
	#L_REG
 
r8


	)

553 
	#L_INDEX
(
i
è(
L_REG
+i)

	)

554 
	#L_INXORBLOCKS
 
L_INBLOCKS
+8

	)

555 
	#L_OUTXORBLOCKS
 
L_INBLOCKS
+16

	)

556 
	#L_OUTBLOCKS
 
L_INBLOCKS
+24

	)

557 
	#L_INCREMENTS
 
	`L_INDEX
(16*16)

	)

558 
	#L_LENGTH
 
	`L_INDEX
(16*18+8)

	)

559 
	#L_KEYS_BEGIN
 
	`L_INDEX
(16*19)

	)

561 
	#MOVD
 
mov


	)

562 
	#MM_0
 
r9d


	)

563 
	#MM_1
 
r12d


	)

564 #ifdeà
__GNUC__


565 
	#MM_2
 
r11d


	)

567 
	#MM_2
 
r10d


	)

569 
	#MM
(
i
è
MM_
##
	)
i

571 
	#MXOR
(
a
,
b
,
c
) \

572 
	`AS2
Ğ
movzx
 
esi
, 
b
)\

573 
	`AS2
Ğ
xÜ
 
	`MM
(
a
), 
DWORD
 
PTR
 [
AS_REG_7
+8*
	`WORD_REG
(
si
)+
	`MAP0TO4
(
c
)])\

574 

	)

575 
	#MMOV
(
a
,
b
,
c
) \

576 
	`AS2
Ğ
movzx
 
esi
, 
b
)\

577 
	`AS2
Ğ
mov
 
	`MM
(
a
), 
DWORD
 
PTR
 [
AS_REG_7
+8*
	`WORD_REG
(
si
)+
	`MAP0TO4
(
c
)])\

578 

	)

581 
	#L_SUBKEYS
 
	`L_INDEX
(0)

	)

582 
	#L_SAVED_X
 
L_SUBKEYS


	)

583 
	#L_KEY12
 
	`L_INDEX
(16*12)

	)

584 
	#L_LASTROUND
 
	`L_INDEX
(16*13)

	)

585 
	#L_INBLOCKS
 
	`L_INDEX
(16*14)

	)

586 
	#MAP0TO4
(
i
è(
	`ASM_MOD
(i+3,4)+1)

	)

588 
	#XOR
(
a
,
b
,
c
) \

589 
	`AS2
Ğ
movzx
 
esi
, 
b
)\

590 
	`AS2
Ğ
xÜ
 
a
, 
DWORD
 
PTR
 [
AS_REG_7
+8*
	`WORD_REG
(
si
)+
	`MAP0TO4
(
c
)])\

591 

	)

592 
	#MOV
(
a
,
b
,
c
) \

593 
	`AS2
Ğ
movzx
 
esi
, 
b
)\

594 
	`AS2
Ğ
mov
 
a
, 
DWORD
 
PTR
 [
AS_REG_7
+8*
	`WORD_REG
(
si
)+
	`MAP0TO4
(
c
)])\

595 

	)

596 #ifdeà
CRYPTOPP_GENERATE_X64_MASM


597 
ALIGN
 8

598 
Rijnd«l_Enc_AdvªûdProûssBlocks
 
PROC
 
FRAME


599 
»x_push_»g
 
rsi


600 
push_»g
 
rdi


601 
push_»g
 
rbx


602 
push_»g
 
r12


603 .
’d´Şog


604 
mov
 
L_REG
, 
rcx


605 
mov
 
AS_REG_7
, ?
Te
@
rdbË
@
Cry±oPP
@@3
PA_KA


606 
mov
 
edi
, 
DWORD
 
PTR
 [?
g_ÿcheLšeSize
@
Cry±oPP
@@3
IA
]

607 #–ià
	`defšed
(
__GNUC__
)

608 
__asm__
 
__vŞ©e__


611 #ià
CRYPTOPP_BOOL_X64


612 
	`AS2
Ğ
mov
 
L_REG
, 
rcx
)

614 
	`AS_PUSH_IF86
(
bx
)

615 
	`AS_PUSH_IF86
(
bp
)

616 
	`AS2
Ğ
mov
 
AS_REG_7
, 
	`WORD_REG
(
si
))

618 
	`AS_PUSH_IF86
(
si
)

619 
	`AS_PUSH_IF86
(
di
)

620 
	`AS_PUSH_IF86
(
bx
)

621 
	`AS_PUSH_IF86
(
bp
)

622 
	`AS2
Ğ
Ëa
 
AS_REG_7
, [
Te
])

623 
	`AS2
Ğ
mov
 
edi
, [
g_ÿcheLšeSize
])

626 #ià
CRYPTOPP_BOOL_X86


627 
	`AS2
Ğ
mov
 [
ecx
+16*12+16*4], 
e¥
)

628 
	`AS2
Ğ
Ëa
 
e¥
, [
ecx
-768])

632 
	`AS2
Ğ
mov
 
	`WORD_REG
(
si
), [
L_KEYS_BEGIN
])

633 
	`AS2
Ğ
mov
 
	`WORD_REG
(
ax
), 16)

634 
	`AS2
Ğ
ªd
 
	`WORD_REG
(
ax
), WORD_REG(
si
))

635 
	`AS2
Ğ
movdqa
 
xmm3
, 
XMMWORD_PTR
 [
	`WORD_REG
(
dx
)+16+WORD_REG(
ax
)])

636 
	`AS2
Ğ
movdqa
 [
L_KEY12
], 
xmm3
)

637 
	`AS2
Ğ
Ëa
 
	`WORD_REG
(
ax
), [WORD_REG(
dx
)+WORD_REG(ax)+2*16])

638 
	`AS2
Ğ
sub
 
	`WORD_REG
(
ax
), WORD_REG(
si
))

639 
	`ASL
(0)

640 
	`AS2
Ğ
movdqa
 
xmm0
, [
	`WORD_REG
(
ax
)+WORD_REG(
si
)])

641 
	`AS2
Ğ
movdqa
 
XMMWORD_PTR
 [
L_SUBKEYS
+
	`WORD_REG
(
si
)], 
xmm0
)

642 
	`AS2
Ğ
add
 
	`WORD_REG
(
si
), 16)

643 
	`AS2
Ğ
cmp
 
	`WORD_REG
(
si
), 16*12)

644 
	`ASJ
Ğ
jl
, 0, 
b
)

647 
	`AS2
Ğ
movdqa
 
xmm4
, [
	`WORD_REG
(
ax
)+WORD_REG(
si
)])

648 
	`AS2
Ğ
movdqa
 
xmm1
, [
	`WORD_REG
(
dx
)])

649 
	`AS2
Ğ
MOVD
 
	`MM
(1), [
	`WORD_REG
(
dx
)+4*4])

650 
	`AS2
Ğ
mov
 
ebx
, [
	`WORD_REG
(
dx
)+5*4])

651 
	`AS2
Ğ
mov
 
ecx
, [
	`WORD_REG
(
dx
)+6*4])

652 
	`AS2
Ğ
mov
 
edx
, [
	`WORD_REG
(
dx
)+7*4])

655 
	`AS2
Ğ
xÜ
 
	`WORD_REG
(
ax
), WORD_REG(ax))

656 
	`ASL
(9)

657 
	`AS2
Ğ
mov
 
esi
, [
AS_REG_7
+
	`WORD_REG
(
ax
)])

658 
	`AS2
Ğ
add
 
	`WORD_REG
(
ax
), WORD_REG(
di
))

659 
	`AS2
Ğ
mov
 
esi
, [
AS_REG_7
+
	`WORD_REG
(
ax
)])

660 
	`AS2
Ğ
add
 
	`WORD_REG
(
ax
), WORD_REG(
di
))

661 
	`AS2
Ğ
mov
 
esi
, [
AS_REG_7
+
	`WORD_REG
(
ax
)])

662 
	`AS2
Ğ
add
 
	`WORD_REG
(
ax
), WORD_REG(
di
))

663 
	`AS2
Ğ
mov
 
esi
, [
AS_REG_7
+
	`WORD_REG
(
ax
)])

664 
	`AS2
Ğ
add
 
	`WORD_REG
(
ax
), WORD_REG(
di
))

665 
	`AS2
Ğ
cmp
 
	`WORD_REG
(
ax
), 2048)

666 
	`ASJ
Ğ
jl
, 9, 
b
)

667 
	`AS1
Ğ
lãnû
)

669 
	`AS2
Ğ
‹¡
 
DWORD
 
PTR
 [
L_LENGTH
], 1)

670 
	`ASJ
Ğ
jz
, 8, 
f
)

673 
	`AS2
Ğ
mov
 
	`WORD_REG
(
si
), [
L_INBLOCKS
])

674 
	`AS2
Ğ
movdqu
 
xmm2
, [
	`WORD_REG
(
si
)])

675 
	`AS2
Ğ
pxÜ
 
xmm2
, 
xmm1
)

676 
	`AS2
Ğ
p¤ldq
 
xmm1
, 14)

677 
	`AS2
Ğ
movd
 
—x
, 
xmm1
)

678 
	`AS2
Ğ
mov
 
®
, 
BYTE
 
PTR
 [
	`WORD_REG
(
si
)+15])

679 
	`AS2
Ğ
MOVD
 
	`MM
(2), 
—x
)

680 #ià
CRYPTOPP_BOOL_X86


681 
	`AS2
Ğ
mov
 
—x
, 1)

682 
	`AS2
Ğ
movd
 
mm3
, 
—x
)

686 
	`AS2
Ğ
movd
 
—x
, 
xmm2
)

687 
	`AS2
Ğ
p¤ldq
 
xmm2
, 4)

688 
	`AS2
Ğ
movd
 
edi
, 
xmm2
)

689 
	`AS2
Ğ
p¤ldq
 
xmm2
, 4)

690 
	`MXOR
Ğ1, 
®
, 0)

691 
	`XOR
Ğ
edx
, 
ah
, 1)

692 
	`AS2
Ğ
shr
 
—x
, 16)

693 
	`XOR
Ğ
ecx
, 
®
, 2)

694 
	`XOR
Ğ
ebx
, 
ah
, 3)

695 
	`AS2
Ğ
mov
 
—x
, 
edi
)

696 
	`AS2
Ğ
movd
 
edi
, 
xmm2
)

697 
	`AS2
Ğ
p¤ldq
 
xmm2
, 4)

698 
	`XOR
Ğ
ebx
, 
®
, 0)

699 
	`MXOR
Ğ1, 
ah
, 1)

700 
	`AS2
Ğ
shr
 
—x
, 16)

701 
	`XOR
Ğ
edx
, 
®
, 2)

702 
	`XOR
Ğ
ecx
, 
ah
, 3)

703 
	`AS2
Ğ
mov
 
—x
, 
edi
)

704 
	`AS2
Ğ
movd
 
edi
, 
xmm2
)

705 
	`XOR
Ğ
ecx
, 
®
, 0)

706 
	`XOR
Ğ
ebx
, 
ah
, 1)

707 
	`AS2
Ğ
shr
 
—x
, 16)

708 
	`MXOR
Ğ1, 
®
, 2)

709 
	`XOR
Ğ
edx
, 
ah
, 3)

710 
	`AS2
Ğ
mov
 
—x
, 
edi
)

711 
	`XOR
Ğ
edx
, 
®
, 0)

712 
	`XOR
Ğ
ecx
, 
ah
, 1)

713 
	`AS2
Ğ
shr
 
—x
, 16)

714 
	`XOR
Ğ
ebx
, 
®
, 2)

715 
	`AS2
Ğ
p¤ldq
 
xmm2
, 3)

718 
	`AS2
Ğ
mov
 
—x
, [
L_KEY12
+0*4])

719 
	`AS2
Ğ
mov
 
edi
, [
L_KEY12
+2*4])

720 
	`AS2
Ğ
MOVD
 
	`MM
(0), [
L_KEY12
+3*4])

721 
	`MXOR
Ğ0, 
ş
, 3)

722 
	`XOR
Ğ
edi
, 
bl
, 3)

723 
	`MXOR
Ğ0, 
bh
, 2)

724 
	`AS2
Ğ
shr
 
ebx
, 16)

725 
	`XOR
Ğ
—x
, 
bl
, 1)

726 
	`MOV
Ğ
ebx
, 
bh
, 0)

727 
	`AS2
Ğ
xÜ
 
ebx
, [
L_KEY12
+1*4])

728 
	`XOR
Ğ
—x
, 
ch
, 2)

729 
	`AS2
Ğ
shr
 
ecx
, 16)

730 
	`XOR
Ğ
—x
, 
dl
, 3)

731 
	`XOR
Ğ
ebx
, 
dh
, 2)

732 
	`AS2
Ğ
shr
 
edx
, 16)

733 
	`XOR
Ğ
edi
, 
ch
, 0)

734 
	`XOR
Ğ
ebx
, 
ş
, 1)

735 
	`XOR
Ğ
edi
, 
dl
, 1)

736 
	`MXOR
Ğ0, 
dh
, 0)

738 
	`AS2
Ğ
movd
 
ecx
, 
xmm2
)

739 
	`AS2
Ğ
MOVD
 
edx
, 
	`MM
(1))

740 
	`AS2
Ğ
MOVD
 [
L_SAVED_X
+3*4], 
	`MM
(0))

741 
	`AS2
Ğ
mov
 [
L_SAVED_X
+0*4], 
—x
)

742 
	`AS2
Ğ
mov
 [
L_SAVED_X
+1*4], 
ebx
)

743 
	`AS2
Ğ
mov
 [
L_SAVED_X
+2*4], 
edi
)

744 
	`ASJ
Ğ
jmp
, 5, 
f
)

746 
	`ASL
(3)

748 
	`AS2
Ğ
MOVD
 
	`MM
(1), [
L_KEY12
+0*4])

749 
	`AS2
Ğ
mov
 
ebx
, [
L_KEY12
+1*4])

750 
	`AS2
Ğ
mov
 
ecx
, [
L_KEY12
+2*4])

751 
	`AS2
Ğ
mov
 
edx
, [
L_KEY12
+3*4])

752 
	`ASL
(8)

753 
	`AS2
Ğ
mov
 
	`WORD_REG
(
ax
), [
L_INBLOCKS
])

754 
	`AS2
Ğ
movdqu
 
xmm2
, [
	`WORD_REG
(
ax
)])

755 
	`AS2
Ğ
mov
 
	`WORD_REG
(
si
), [
L_INXORBLOCKS
])

756 
	`AS2
Ğ
movdqu
 
xmm5
, [
	`WORD_REG
(
si
)])

757 
	`AS2
Ğ
pxÜ
 
xmm2
, 
xmm1
)

758 
	`AS2
Ğ
pxÜ
 
xmm2
, 
xmm5
)

761 
	`AS2
Ğ
movd
 
—x
, 
xmm2
)

762 
	`AS2
Ğ
p¤ldq
 
xmm2
, 4)

763 
	`AS2
Ğ
movd
 
edi
, 
xmm2
)

764 
	`AS2
Ğ
p¤ldq
 
xmm2
, 4)

765 
	`MXOR
Ğ1, 
®
, 0)

766 
	`XOR
Ğ
edx
, 
ah
, 1)

767 
	`AS2
Ğ
shr
 
—x
, 16)

768 
	`XOR
Ğ
ecx
, 
®
, 2)

769 
	`XOR
Ğ
ebx
, 
ah
, 3)

770 
	`AS2
Ğ
mov
 
—x
, 
edi
)

771 
	`AS2
Ğ
movd
 
edi
, 
xmm2
)

772 
	`AS2
Ğ
p¤ldq
 
xmm2
, 4)

773 
	`XOR
Ğ
ebx
, 
®
, 0)

774 
	`MXOR
Ğ1, 
ah
, 1)

775 
	`AS2
Ğ
shr
 
—x
, 16)

776 
	`XOR
Ğ
edx
, 
®
, 2)

777 
	`XOR
Ğ
ecx
, 
ah
, 3)

778 
	`AS2
Ğ
mov
 
—x
, 
edi
)

779 
	`AS2
Ğ
movd
 
edi
, 
xmm2
)

780 
	`XOR
Ğ
ecx
, 
®
, 0)

781 
	`XOR
Ğ
ebx
, 
ah
, 1)

782 
	`AS2
Ğ
shr
 
—x
, 16)

783 
	`MXOR
Ğ1, 
®
, 2)

784 
	`XOR
Ğ
edx
, 
ah
, 3)

785 
	`AS2
Ğ
mov
 
—x
, 
edi
)

786 
	`XOR
Ğ
edx
, 
®
, 0)

787 
	`XOR
Ğ
ecx
, 
ah
, 1)

788 
	`AS2
Ğ
shr
 
—x
, 16)

789 
	`XOR
Ğ
ebx
, 
®
, 2)

790 
	`MXOR
Ğ1, 
ah
, 3)

791 
	`AS2
Ğ
MOVD
 
—x
, 
	`MM
(1))

793 
	`AS2
Ğ
add
 
L_REG
, [
L_KEYS_BEGIN
])

794 
	`AS2
Ğ
add
 
L_REG
, 4*16)

795 
	`ASJ
Ğ
jmp
, 2, 
f
)

797 
	`ASL
(1)

799 
	`AS2
Ğ
MOVD
 
ecx
, 
	`MM
(2))

800 
	`AS2
Ğ
MOVD
 
edx
, 
	`MM
(1))

801 
	`AS2
Ğ
mov
 
—x
, [
L_SAVED_X
+0*4])

802 
	`AS2
Ğ
mov
 
ebx
, [
L_SAVED_X
+1*4])

803 
	`AS2
Ğ
xÜ
 
ş
, 
ch
)

804 
	`AS2
Ğ
ªd
 
	`WORD_REG
(
cx
), 255)

805 
	`ASL
(5)

806 #ià
CRYPTOPP_BOOL_X86


807 
	`AS2
Ğ
·ddb
 
	`MM
(2), 
mm3
)

809 
	`AS2
Ğ
add
 
	`MM
(2), 1)

812 
	`AS2
Ğ
xÜ
 
edx
, 
DWORD
 
PTR
 [
AS_REG_7
+
	`WORD_REG
(
cx
)*8+3])

813 
	`XOR
Ğ
ebx
, 
dl
, 3)

814 
	`MOV
Ğ
ecx
, 
dh
, 2)

815 
	`AS2
Ğ
shr
 
edx
, 16)

816 
	`AS2
Ğ
xÜ
 
ecx
, [
L_SAVED_X
+2*4])

817 
	`XOR
Ğ
—x
, 
dh
, 0)

818 
	`MOV
Ğ
edx
, 
dl
, 1)

819 
	`AS2
Ğ
xÜ
 
edx
, [
L_SAVED_X
+3*4])

821 
	`AS2
Ğ
add
 
L_REG
, [
L_KEYS_BEGIN
])

822 
	`AS2
Ğ
add
 
L_REG
, 3*16)

823 
	`ASJ
Ğ
jmp
, 4, 
f
)

827 
	#ROUND
() \

828 
	`MXOR
Ğ0, 
ş
, 3) \

829 
	`AS2
Ğ
mov
 
ş
, 
®
) \

830 
	`XOR
Ğ
edi
, 
ah
, 2) \

831 
	`AS2
Ğ
shr
 
—x
, 16) \

832 
	`XOR
Ğ
edi
, 
bl
, 3) \

833 
	`MXOR
Ğ0, 
bh
, 2) \

834 
	`AS2
Ğ
shr
 
ebx
, 16) \

835 
	`MXOR
Ğ0, 
®
, 1) \

836 
	`MOV
Ğ
—x
, 
ah
, 0) \

837 
	`XOR
Ğ
—x
, 
bl
, 1) \

838 
	`MOV
Ğ
ebx
, 
bh
, 0) \

839 
	`XOR
Ğ
—x
, 
ch
, 2) \

840 
	`XOR
Ğ
ebx
, 
ş
, 3) \

841 
	`AS2
Ğ
shr
 
ecx
, 16) \

842 
	`XOR
Ğ
—x
, 
dl
, 3) \

843 
	`XOR
Ğ
ebx
, 
dh
, 2) \

844 
	`AS2
Ğ
shr
 
edx
, 16) \

845 
	`XOR
Ğ
edi
, 
ch
, 0) \

846 
	`XOR
Ğ
ebx
, 
ş
, 1) \

847 
	`XOR
Ğ
edi
, 
dl
, 1) \

848 
	`MXOR
Ğ0, 
dh
, 0) \

849 

	)

850 
	`ASL
(2)

851 
	`AS2
Ğ
MOVD
 
	`MM
(0), [
L_SUBKEYS
-4*16+3*4])

852 
	`AS2
Ğ
mov
 
edi
, [
L_SUBKEYS
-4*16+2*4])

853 
	`ROUND
()

854 
	`AS2
Ğ
mov
 
ecx
, 
edi
)

855 
	`AS2
Ğ
xÜ
 
—x
, [
L_SUBKEYS
-4*16+0*4])

856 
	`AS2
Ğ
xÜ
 
ebx
, [
L_SUBKEYS
-4*16+1*4])

857 
	`AS2
Ğ
MOVD
 
edx
, 
	`MM
(0))

859 
	`ASL
(4)

860 
	`AS2
Ğ
MOVD
 
	`MM
(0), [
L_SUBKEYS
-4*16+7*4])

861 
	`AS2
Ğ
mov
 
edi
, [
L_SUBKEYS
-4*16+6*4])

862 
	`ROUND
()

863 
	`AS2
Ğ
mov
 
ecx
, 
edi
)

864 
	`AS2
Ğ
xÜ
 
—x
, [
L_SUBKEYS
-4*16+4*4])

865 
	`AS2
Ğ
xÜ
 
ebx
, [
L_SUBKEYS
-4*16+5*4])

866 
	`AS2
Ğ
MOVD
 
edx
, 
	`MM
(0))

868 
	`AS2
Ğ
add
 
L_REG
, 32)

869 
	`AS2
Ğ
‹¡
 
L_REG
, 255)

870 
	`ASJ
Ğ
jnz
, 2, 
b
)

871 
	`AS2
Ğ
sub
 
L_REG
, 16*16)

873 
	#LAST
(
a
, 
b
, 
c
) \

874 
	`AS2
Ğ
movzx
 
esi
, 
a
 )\

875 
	`AS2
Ğ
movzx
 
edi
, 
BYTE
 
PTR
 [
AS_REG_7
+
	`WORD_REG
(
si
)*8+1] )\

876 
	`AS2
Ğ
movzx
 
esi
, 
b
 )\

877 
	`AS2
Ğ
xÜ
 
edi
, 
DWORD
 
PTR
 [
AS_REG_7
+
	`WORD_REG
(
si
)*8+0] )\

878 
	`AS2
Ğ
mov
 
WORD
 
PTR
 [
L_LASTROUND
+
c
], 
di
 )\

879 

	)

881 
	`LAST
(
ch
, 
dl
, 2)

882 
	`LAST
(
dh
, 
®
, 6)

883 
	`AS2
Ğ
shr
 
edx
, 16)

884 
	`LAST
(
ah
, 
bl
, 10)

885 
	`AS2
Ğ
shr
 
—x
, 16)

886 
	`LAST
(
bh
, 
ş
, 14)

887 
	`AS2
Ğ
shr
 
ebx
, 16)

888 
	`LAST
(
dh
, 
®
, 12)

889 
	`AS2
Ğ
shr
 
ecx
, 16)

890 
	`LAST
(
ah
, 
bl
, 0)

891 
	`LAST
(
bh
, 
ş
, 4)

892 
	`LAST
(
ch
, 
dl
, 8)

894 
	`AS2
Ğ
mov
 
	`WORD_REG
(
ax
), [
L_OUTXORBLOCKS
])

895 
	`AS2
Ğ
mov
 
	`WORD_REG
(
bx
), [
L_OUTBLOCKS
])

897 
	`AS2
Ğ
mov
 
	`WORD_REG
(
cx
), [
L_LENGTH
])

898 
	`AS2
Ğ
sub
 
	`WORD_REG
(
cx
), 16)

900 
	`AS2
Ğ
movdqu
 
xmm2
, [
	`WORD_REG
(
ax
)])

901 
	`AS2
Ğ
pxÜ
 
xmm2
, 
xmm4
)

903 #ià
CRYPTOPP_BOOL_X86


904 
	`AS2
Ğ
movdqa
 
xmm0
, [
L_INCREMENTS
])

905 
	`AS2
Ğ
·ddd
 
xmm0
, [
L_INBLOCKS
])

906 
	`AS2
Ğ
movdqa
 [
L_INBLOCKS
], 
xmm0
)

908 
	`AS2
Ğ
movdqa
 
xmm0
, [
L_INCREMENTS
+16])

909 
	`AS2
Ğ
·ddq
 
xmm0
, [
L_INBLOCKS
+16])

910 
	`AS2
Ğ
movdqa
 [
L_INBLOCKS
+16], 
xmm0
)

913 
	`AS2
Ğ
pxÜ
 
xmm2
, [
L_LASTROUND
])

914 
	`AS2
Ğ
movdqu
 [
	`WORD_REG
(
bx
)], 
xmm2
)

916 
	`ASJ
Ğ
jË
, 7, 
f
)

917 
	`AS2
Ğ
mov
 [
L_LENGTH
], 
	`WORD_REG
(
cx
))

918 
	`AS2
Ğ
‹¡
 
	`WORD_REG
(
cx
), 1)

919 
	`ASJ
Ğ
jnz
, 1, 
b
)

920 #ià
CRYPTOPP_BOOL_X64


921 
	`AS2
Ğ
movdqa
 
xmm0
, [
L_INCREMENTS
])

922 
	`AS2
Ğ
·ddq
 
xmm0
, [
L_INBLOCKS
])

923 
	`AS2
Ğ
movdqa
 [
L_INBLOCKS
], 
xmm0
)

925 
	`ASJ
Ğ
jmp
, 3, 
b
)

927 
	`ASL
(7)

929 
	`AS2
Ğ
xÜps
 
xmm0
, xmm0)

930 
	`AS2
Ğ
Ëa
 
	`WORD_REG
(
ax
), [
L_SUBKEYS
+7*16])

931 
	`AS2
Ğ
mov­s
 [
	`WORD_REG
(
ax
)-7*16], 
xmm0
)

932 
	`AS2
Ğ
mov­s
 [
	`WORD_REG
(
ax
)-6*16], 
xmm0
)

933 
	`AS2
Ğ
mov­s
 [
	`WORD_REG
(
ax
)-5*16], 
xmm0
)

934 
	`AS2
Ğ
mov­s
 [
	`WORD_REG
(
ax
)-4*16], 
xmm0
)

935 
	`AS2
Ğ
mov­s
 [
	`WORD_REG
(
ax
)-3*16], 
xmm0
)

936 
	`AS2
Ğ
mov­s
 [
	`WORD_REG
(
ax
)-2*16], 
xmm0
)

937 
	`AS2
Ğ
mov­s
 [
	`WORD_REG
(
ax
)-1*16], 
xmm0
)

938 
	`AS2
Ğ
mov­s
 [
	`WORD_REG
(
ax
)+0*16], 
xmm0
)

939 
	`AS2
Ğ
mov­s
 [
	`WORD_REG
(
ax
)+1*16], 
xmm0
)

940 
	`AS2
Ğ
mov­s
 [
	`WORD_REG
(
ax
)+2*16], 
xmm0
)

941 
	`AS2
Ğ
mov­s
 [
	`WORD_REG
(
ax
)+3*16], 
xmm0
)

942 
	`AS2
Ğ
mov­s
 [
	`WORD_REG
(
ax
)+4*16], 
xmm0
)

943 
	`AS2
Ğ
mov­s
 [
	`WORD_REG
(
ax
)+5*16], 
xmm0
)

944 
	`AS2
Ğ
mov­s
 [
	`WORD_REG
(
ax
)+6*16], 
xmm0
)

945 #ià
CRYPTOPP_BOOL_X86


946 
	`AS2
Ğ
mov
 
e¥
, [
L_SP
])

947 
	`AS1
Ğ
emms
)

949 
	`AS_POP_IF86
(
bp
)

950 
	`AS_POP_IF86
(
bx
)

951 #ià
	`defšed
(
_MSC_VER
è&& 
CRYPTOPP_BOOL_X86


952 
	`AS_POP_IF86
(
di
)

953 
	`AS_POP_IF86
(
si
)

954 
	`AS1
(
»t
)

956 #ifdeà
CRYPTOPP_GENERATE_X64_MASM


957 
pİ
 
r12


958 
pİ
 
rbx


959 
pİ
 
rdi


960 
pİ
 
rsi


961 
»t


962 
Rijnd«l_Enc_AdvªûdProûssBlocks
 
ENDP


964 #ifdeà
__GNUC__


967 : "c" (
loÿls
), "d" (
k
), "S" (
Te
), "D" (
g_ÿcheLšeSize
)

969 #ià
CRYPTOPP_BOOL_X64


974 
	}
}

978 #iâdeà
CRYPTOPP_GENERATE_X64_MASM


980 #ifdeà
CRYPTOPP_X64_MASM_AVAILABLE


982 
Rijnd«l_Enc_AdvªûdProûssBlocks
(*
loÿls
, cÚ¡ 
wÜd32
 *
k
);

986 #ià
CRYPTOPP_BOOL_X64
 || 
CRYPTOPP_BOOL_X86


988 
šlše
 
boŞ
 
	$AlŸ£dW™hTabË
(cÚ¡ 
by‹
 *
begš
, cÚ¡ by‹ *
’d
)

990 
size_t
 
s0
 = 
	`size_t
(
begš
)%4096, 
s1
 = size_t(
’d
)%4096;

991 
size_t
 
t0
 = 
	`size_t
(
Te
)%4096, 
t1
 = (size_t(Te)+(Te))%4096;

992 ià(
t1
 > 
t0
)

993  (
s0
 >ğ
t0
 && s0 < 
t1
è|| (
s1
 >0 && s1 <=1);

995  (
s0
 < 
t1
 || 
s1
 <ğt1è|| (s0 >ğ
t0
 || s1 >0);

996 
	}
}

998 #ià
CRYPTOPP_BOOL_AESNI_INTRINSICS_AVAILABLE


1000 
šlše
 
	$AESNI_Enc_Block
(
__m128i
 &
block
, cÚ¡ __m128˜*
subkeys
, 
rounds
)

1002 
block
 = 
	`_mm_xÜ_si128
(block, 
subkeys
[0]);

1003 
i
=1; i<
rounds
-1; i+=2)

1005 
block
 = 
	`_mm_«£nc_si128
(block, 
subkeys
[
i
]);

1006 
block
 = 
	`_mm_«£nc_si128
(block, 
subkeys
[
i
+1]);

1008 
block
 = 
	`_mm_«£nc_si128
(block, 
subkeys
[
rounds
-1]);

1009 
block
 = 
	`_mm_«£nşa¡_si128
(block, 
subkeys
[
rounds
]);

1010 
	}
}

1012 
šlše
 
	$AESNI_Enc_4_Blocks
(
__m128i
 &
block0
, __m128˜&
block1
, __m128˜&
block2
, __m128˜&
block3
, cÚ¡ __m128˜*
subkeys
, 
rounds
)

1014 
__m128i
 
rk
 = 
subkeys
[0];

1015 
block0
 = 
	`_mm_xÜ_si128
(block0, 
rk
);

1016 
block1
 = 
	`_mm_xÜ_si128
(block1, 
rk
);

1017 
block2
 = 
	`_mm_xÜ_si128
(block2, 
rk
);

1018 
block3
 = 
	`_mm_xÜ_si128
(block3, 
rk
);

1019 
i
=1; i<
rounds
; i++)

1021 
rk
 = 
subkeys
[
i
];

1022 
block0
 = 
	`_mm_«£nc_si128
(block0, 
rk
);

1023 
block1
 = 
	`_mm_«£nc_si128
(block1, 
rk
);

1024 
block2
 = 
	`_mm_«£nc_si128
(block2, 
rk
);

1025 
block3
 = 
	`_mm_«£nc_si128
(block3, 
rk
);

1027 
rk
 = 
subkeys
[
rounds
];

1028 
block0
 = 
	`_mm_«£nşa¡_si128
(block0, 
rk
);

1029 
block1
 = 
	`_mm_«£nşa¡_si128
(block1, 
rk
);

1030 
block2
 = 
	`_mm_«£nşa¡_si128
(block2, 
rk
);

1031 
block3
 = 
	`_mm_«£nşa¡_si128
(block3, 
rk
);

1032 
	}
}

1034 
šlše
 
	$AESNI_Dec_Block
(
__m128i
 &
block
, cÚ¡ __m128˜*
subkeys
, 
rounds
)

1036 
block
 = 
	`_mm_xÜ_si128
(block, 
subkeys
[0]);

1037 
i
=1; i<
rounds
-1; i+=2)

1039 
block
 = 
	`_mm_«sdec_si128
(block, 
subkeys
[
i
]);

1040 
block
 = 
	`_mm_«sdec_si128
(block, 
subkeys
[
i
+1]);

1042 
block
 = 
	`_mm_«sdec_si128
(block, 
subkeys
[
rounds
-1]);

1043 
block
 = 
	`_mm_«sdeşa¡_si128
(block, 
subkeys
[
rounds
]);

1044 
	}
}

1046 
šlše
 
	$AESNI_Dec_4_Blocks
(
__m128i
 &
block0
, __m128˜&
block1
, __m128˜&
block2
, __m128˜&
block3
, cÚ¡ __m128˜*
subkeys
, 
rounds
)

1048 
__m128i
 
rk
 = 
subkeys
[0];

1049 
block0
 = 
	`_mm_xÜ_si128
(block0, 
rk
);

1050 
block1
 = 
	`_mm_xÜ_si128
(block1, 
rk
);

1051 
block2
 = 
	`_mm_xÜ_si128
(block2, 
rk
);

1052 
block3
 = 
	`_mm_xÜ_si128
(block3, 
rk
);

1053 
i
=1; i<
rounds
; i++)

1055 
rk
 = 
subkeys
[
i
];

1056 
block0
 = 
	`_mm_«sdec_si128
(block0, 
rk
);

1057 
block1
 = 
	`_mm_«sdec_si128
(block1, 
rk
);

1058 
block2
 = 
	`_mm_«sdec_si128
(block2, 
rk
);

1059 
block3
 = 
	`_mm_«sdec_si128
(block3, 
rk
);

1061 
rk
 = 
subkeys
[
rounds
];

1062 
block0
 = 
	`_mm_«sdeşa¡_si128
(block0, 
rk
);

1063 
block1
 = 
	`_mm_«sdeşa¡_si128
(block1, 
rk
);

1064 
block2
 = 
	`_mm_«sdeşa¡_si128
(block2, 
rk
);

1065 
block3
 = 
	`_mm_«sdeşa¡_si128
(block3, 
rk
);

1066 
	}
}

1068 
	$CRYPTOPP_ALIGN_DATA
(16ècÚ¡ 
wÜd32
 
s_Úe
[] = {0, 0, 0, 1<<24
	}
};

1070 
	g‹m¶©e
 <
ty³Çme
 
	gF1
,y³Çm
	gF4
>

1071 
šlše
 
size_t
 
	$AESNI_AdvªûdProûssBlocks
(
F1
 
func1
, 
F4
 
func4
, cÚ¡ 
__m128i
 *
subkeys
, 
rounds
, cÚ¡ 
by‹
 *
šBlocks
, cÚ¡ by‹ *
xÜBlocks
, by‹ *
outBlocks
, 
size_t
 
Ëngth
, 
wÜd32
 
æags
)

1073 
size_t
 
blockSize
 = 16;

1074 
size_t
 
šInüem’t
 = (
æags
 & (
BlockT¿nsfÜm©iÚ
::
BT_InBlockIsCouÁ”
|BlockT¿nsfÜm©iÚ::
BT_DÚtInüem’tInOutPoš‹rs
)è? 0 : 
blockSize
;

1075 
size_t
 
xÜInüem’t
 = 
xÜBlocks
 ? 
blockSize
 : 0;

1076 
size_t
 
outInüem’t
 = (
æags
 & 
BlockT¿nsfÜm©iÚ
::
BT_DÚtInüem’tInOutPoš‹rs
è? 0 : 
blockSize
;

1078 ià(
æags
 & 
BlockT¿nsfÜm©iÚ
::
BT_Rev”£DœeùiÚ
)

1080 
	`as£¹
(
Ëngth
 % 
blockSize
 == 0);

1081 
šBlocks
 +ğ
Ëngth
 - 
blockSize
;

1082 
xÜBlocks
 +ğ
Ëngth
 - 
blockSize
;

1083 
outBlocks
 +ğ
Ëngth
 - 
blockSize
;

1084 
šInüem’t
 = 0-inIncrement;

1085 
xÜInüem’t
 = 0-xorIncrement;

1086 
outInüem’t
 = 0-outIncrement;

1089 ià(
æags
 & 
BlockT¿nsfÜm©iÚ
::
BT_AÎowP¬®Ël
)

1091 
Ëngth
 >ğ4*
blockSize
)

1093 
__m128i
 
block0
 = 
	`_mm_lßdu_si128
((cÚ¡ __m128˜*)
šBlocks
), 
block1
, 
block2
, 
block3
;

1094 ià(
æags
 & 
BlockT¿nsfÜm©iÚ
::
BT_InBlockIsCouÁ”
)

1096 cÚ¡ 
__m128i
 
be1
 = *(cÚ¡ __m128˜*)
s_Úe
;

1097 
block1
 = 
	`_mm_add_•i32
(
block0
, 
be1
);

1098 
block2
 = 
	`_mm_add_•i32
(
block1
, 
be1
);

1099 
block3
 = 
	`_mm_add_•i32
(
block2
, 
be1
);

1100 
	`_mm_¡Üeu_si128
((
__m128i
 *)
šBlocks
, 
	`_mm_add_•i32
(
block3
, 
be1
));

1104 
šBlocks
 +ğ
šInüem’t
;

1105 
block1
 = 
	`_mm_lßdu_si128
((cÚ¡ 
__m128i
 *)
šBlocks
);

1106 
šBlocks
 +ğ
šInüem’t
;

1107 
block2
 = 
	`_mm_lßdu_si128
((cÚ¡ 
__m128i
 *)
šBlocks
);

1108 
šBlocks
 +ğ
šInüem’t
;

1109 
block3
 = 
	`_mm_lßdu_si128
((cÚ¡ 
__m128i
 *)
šBlocks
);

1110 
šBlocks
 +ğ
šInüem’t
;

1113 ià(
æags
 & 
BlockT¿nsfÜm©iÚ
::
BT_XÜIÅut
)

1115 
block0
 = 
	`_mm_xÜ_si128
(block0, 
	`_mm_lßdu_si128
((cÚ¡ 
__m128i
 *)
xÜBlocks
));

1116 
xÜBlocks
 +ğ
xÜInüem’t
;

1117 
block1
 = 
	`_mm_xÜ_si128
(block1, 
	`_mm_lßdu_si128
((cÚ¡ 
__m128i
 *)
xÜBlocks
));

1118 
xÜBlocks
 +ğ
xÜInüem’t
;

1119 
block2
 = 
	`_mm_xÜ_si128
(block2, 
	`_mm_lßdu_si128
((cÚ¡ 
__m128i
 *)
xÜBlocks
));

1120 
xÜBlocks
 +ğ
xÜInüem’t
;

1121 
block3
 = 
	`_mm_xÜ_si128
(block3, 
	`_mm_lßdu_si128
((cÚ¡ 
__m128i
 *)
xÜBlocks
));

1122 
xÜBlocks
 +ğ
xÜInüem’t
;

1125 
	`func4
(
block0
, 
block1
, 
block2
, 
block3
, 
subkeys
, 
rounds
);

1127 ià(
xÜBlocks
 && !(
æags
 & 
BlockT¿nsfÜm©iÚ
::
BT_XÜIÅut
))

1129 
block0
 = 
	`_mm_xÜ_si128
(block0, 
	`_mm_lßdu_si128
((cÚ¡ 
__m128i
 *)
xÜBlocks
));

1130 
xÜBlocks
 +ğ
xÜInüem’t
;

1131 
block1
 = 
	`_mm_xÜ_si128
(block1, 
	`_mm_lßdu_si128
((cÚ¡ 
__m128i
 *)
xÜBlocks
));

1132 
xÜBlocks
 +ğ
xÜInüem’t
;

1133 
block2
 = 
	`_mm_xÜ_si128
(block2, 
	`_mm_lßdu_si128
((cÚ¡ 
__m128i
 *)
xÜBlocks
));

1134 
xÜBlocks
 +ğ
xÜInüem’t
;

1135 
block3
 = 
	`_mm_xÜ_si128
(block3, 
	`_mm_lßdu_si128
((cÚ¡ 
__m128i
 *)
xÜBlocks
));

1136 
xÜBlocks
 +ğ
xÜInüem’t
;

1139 
	`_mm_¡Üeu_si128
((
__m128i
 *)
outBlocks
, 
block0
);

1140 
outBlocks
 +ğ
outInüem’t
;

1141 
	`_mm_¡Üeu_si128
((
__m128i
 *)
outBlocks
, 
block1
);

1142 
outBlocks
 +ğ
outInüem’t
;

1143 
	`_mm_¡Üeu_si128
((
__m128i
 *)
outBlocks
, 
block2
);

1144 
outBlocks
 +ğ
outInüem’t
;

1145 
	`_mm_¡Üeu_si128
((
__m128i
 *)
outBlocks
, 
block3
);

1146 
outBlocks
 +ğ
outInüem’t
;

1148 
Ëngth
 -ğ4*
blockSize
;

1152 
Ëngth
 >ğ
blockSize
)

1154 
__m128i
 
block
 = 
	`_mm_lßdu_si128
((cÚ¡ __m128˜*)
šBlocks
);

1156 ià(
æags
 & 
BlockT¿nsfÜm©iÚ
::
BT_XÜIÅut
)

1157 
block
 = 
	`_mm_xÜ_si128
(block, 
	`_mm_lßdu_si128
((cÚ¡ 
__m128i
 *)
xÜBlocks
));

1159 ià(
æags
 & 
BlockT¿nsfÜm©iÚ
::
BT_InBlockIsCouÁ”
)

1160 
cÚ¡_ÿ¡
<
by‹
 *>(
šBlocks
)[15]++;

1162 
	`func1
(
block
, 
subkeys
, 
rounds
);

1164 ià(
xÜBlocks
 && !(
æags
 & 
BlockT¿nsfÜm©iÚ
::
BT_XÜIÅut
))

1165 
block
 = 
	`_mm_xÜ_si128
(block, 
	`_mm_lßdu_si128
((cÚ¡ 
__m128i
 *)
xÜBlocks
));

1167 
	`_mm_¡Üeu_si128
((
__m128i
 *)
outBlocks
, 
block
);

1169 
šBlocks
 +ğ
šInüem’t
;

1170 
outBlocks
 +ğ
outInüem’t
;

1171 
xÜBlocks
 +ğ
xÜInüem’t
;

1172 
Ëngth
 -ğ
blockSize
;

1175  
Ëngth
;

1176 
	}
}

1179 
size_t
 
	gRijnd«l
::
Enc
::
	$AdvªûdProûssBlocks
(cÚ¡ 
by‹
 *
šBlocks
, cÚ¡ by‹ *
xÜBlocks
, by‹ *
outBlocks
, 
size_t
 
Ëngth
, 
wÜd32
 
æags
) const

1181 #ià
CRYPTOPP_BOOL_AESNI_INTRINSICS_AVAILABLE


1182 ià(
	`HasAESNI
())

1183  
	`AESNI_AdvªûdProûssBlocks
(
AESNI_Enc_Block
, 
AESNI_Enc_4_Blocks
, (cÚ¡ 
__m128i
 *)
m_key
.
	`begš
(), 
m_rounds
, 
šBlocks
, 
xÜBlocks
, 
outBlocks
, 
Ëngth
, 
æags
);

1186 #ià
CRYPTOPP_BOOL_SSE2_ASM_AVAILABLE
 || 
	`defšed
(
CRYPTOPP_X64_MASM_AVAILABLE
)

1187 ià(
	`HasSSE2
())

1189 ià(
Ëngth
 < 
BLOCKSIZE
)

1190  
Ëngth
;

1192 
	sLoÿls


1194 
wÜd32
 
subkeys
[4*12], 
wÜk¥aû
[8];

1195 cÚ¡ 
by‹
 *
šBlocks
, *
šXÜBlocks
, *
outXÜBlocks
;

1196 
by‹
 *
outBlocks
;

1197 
size_t
 
šInüem’t
, 
šXÜInüem’t
, 
outXÜInüem’t
, 
outInüem’t
;

1198 
size_t
 
»gSpl
, 
ËngthAndCouÁ”FÏg
, 
keysBegš
;

1201 
size_t
 
šüem’t
 = 
BLOCKSIZE
;

1202 cÚ¡ 
by‹
* 
z”os
 = (by‹ *)(
Te
+256);

1203 
by‹
 *
¥aû
;

1206 
¥aû
 = (
by‹
 *)
	`®loÿ
(255+(
Loÿls
));

1207 
¥aû
 +ğ(256-(
size_t
)space%256)%256;

1209 
	`AlŸ£dW™hTabË
(
¥aû
, s·û+(
Loÿls
)));

1211 ià(
æags
 & 
BT_Rev”£DœeùiÚ
)

1213 
	`as£¹
(
Ëngth
 % 
BLOCKSIZE
 == 0);

1214 
šBlocks
 +ğ
Ëngth
 - 
BLOCKSIZE
;

1215 
xÜBlocks
 +ğ
Ëngth
 - 
BLOCKSIZE
;

1216 
outBlocks
 +ğ
Ëngth
 - 
BLOCKSIZE
;

1217 
šüem’t
 = 0-increment;

1220 
Loÿls
 &
loÿls
 = *(Loÿl *)
¥aû
;

1222 
loÿls
.
šBlocks
 = inBlocks;

1223 
loÿls
.
šXÜBlocks
 = (
æags
 & 
BT_XÜIÅut
è&& 
xÜBlocks
 ? xÜBlock : 
z”os
;

1224 
loÿls
.
outXÜBlocks
 = (
æags
 & 
BT_XÜIÅut
è|| !
xÜBlocks
 ? 
z”os
 : xorBlocks;

1225 
loÿls
.
outBlocks
 = outBlocks;

1227 
loÿls
.
šInüem’t
 = (
æags
 & 
BT_DÚtInüem’tInOutPoš‹rs
è? 0 : 
šüem’t
;

1228 
loÿls
.
šXÜInüem’t
 = (
æags
 & 
BT_XÜIÅut
è&& 
xÜBlocks
 ? 
šüem’t
 : 0;

1229 
loÿls
.
outXÜInüem’t
 = (
æags
 & 
BT_XÜIÅut
è|| !
xÜBlocks
 ? 0 : 
šüem’t
;

1230 
loÿls
.
outInüem’t
 = (
æags
 & 
BT_DÚtInüem’tInOutPoš‹rs
è? 0 : 
šüem’t
;

1232 
loÿls
.
ËngthAndCouÁ”FÏg
 = 
Ëngth
 - (Ëngth%16è- 
	`boŞ
(
æags
 & 
BT_InBlockIsCouÁ”
);

1233 
keysToCİy
 = 
m_rounds
 - (
æags
 & 
BT_InBlockIsCouÁ”
 ? 3 : 2);

1234 
loÿls
.
keysBegš
 = (12-
keysToCİy
)*16;

1236 
	`Rijnd«l_Enc_AdvªûdProûssBlocks
(&
loÿls
, 
m_key
);

1237  
Ëngth
 % 
BLOCKSIZE
;

1241  
BlockT¿nsfÜm©iÚ
::
	`AdvªûdProûssBlocks
(
šBlocks
, 
xÜBlocks
, 
outBlocks
, 
Ëngth
, 
æags
);

1242 
	}
}

1246 #ià
CRYPTOPP_BOOL_AESNI_INTRINSICS_AVAILABLE


1248 
size_t
 
	gRijnd«l
::
Dec
::
	$AdvªûdProûssBlocks
(cÚ¡ 
by‹
 *
šBlocks
, cÚ¡ by‹ *
xÜBlocks
, by‹ *
outBlocks
, 
size_t
 
Ëngth
, 
wÜd32
 
æags
) const

1250 ià(
	`HasAESNI
())

1251  
	`AESNI_AdvªûdProûssBlocks
(
AESNI_Dec_Block
, 
AESNI_Dec_4_Blocks
, (cÚ¡ 
__m128i
 *)
m_key
.
	`begš
(), 
m_rounds
, 
šBlocks
, 
xÜBlocks
, 
outBlocks
, 
Ëngth
, 
æags
);

1253  
BlockT¿nsfÜm©iÚ
::
	`AdvªûdProûssBlocks
(
šBlocks
, 
xÜBlocks
, 
outBlocks
, 
Ëngth
, 
æags
);

1254 
	}
}

1258 
	gNAMESPACE_END


	@rijndael.h

1 #iâdeà
CRYPTOPP_RIJNDAEL_H


2 
	#CRYPTOPP_RIJNDAEL_H


	)

7 
	~"£ckey.h
"

8 
	~"£cblock.h
"

10 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

13 
Rijnd«l_Info
 : 
public
 
FixedBlockSize
<16>,…ubliø
V¬ŸbËKeyL’gth
<16, 16, 32, 8>

15 
CRYPTOPP_DLL
 cÚ¡ * 
CRYPTOPP_API
 
	`SticAlgÜ™hmName
(è{ 
CRYPTOPP_RIJNDAEL_NAME
;}

16 
	}
};

19 
şass
 
CRYPTOPP_DLL
 
	gRijnd«l
 : 
public
 
Rijnd«l_Info
,…ubliø
	gBlockCh”Docum’tiÚ


21 
şass
 
CRYPTOPP_DLL
 
CRYPTOPP_NO_VTABLE
 
	gBa£
 : 
public
 
BlockCh”Im¶
<
Rijnd«l_Info
>

23 
public
:

24 
UncheckedS‘Key
(cÚ¡ 
by‹
 *
u£rKey
, 
Ëngth
, cÚ¡ 
NameV®uePaœs
 &
·¿ms
);

26 
	g´Ùeùed
:

27 
FlEncTabË
();

28 
FlDecTabË
();

31 cÚ¡ 
by‹
 
	gSe
[256];

32 cÚ¡ 
by‹
 
	gSd
[256];

34 cÚ¡ 
wÜd32
 
	grcÚ
[];

36 
	gm_rounds
;

37 
	gFixedSizeAligÃdSecBlock
<
	gwÜd32
, 4*15> 
	gm_key
;

40 şas 
	cCRYPTOPP_DLL
 
CRYPTOPP_NO_VTABLE
 
	gEnc
 : 
public
 
Ba£


42 
public
:

43 
ProûssAndXÜBlock
(cÚ¡ 
by‹
 *
šBlock
, cÚ¡ by‹ *
xÜBlock
, by‹ *
outBlock
) const;

44 #ià
CRYPTOPP_BOOL_X64
 || 
CRYPTOPP_BOOL_X86


45 
size_t
 
AdvªûdProûssBlocks
(cÚ¡ 
by‹
 *
šBlocks
, cÚ¡ by‹ *
xÜBlocks
, by‹ *
outBlocks
, size_ˆ
Ëngth
, 
wÜd32
 
æags
) const;

49 şas 
	cCRYPTOPP_DLL
 
CRYPTOPP_NO_VTABLE
 
	gDec
 : 
public
 
Ba£


51 
public
:

52 
ProûssAndXÜBlock
(cÚ¡ 
by‹
 *
šBlock
, cÚ¡ by‹ *
xÜBlock
, by‹ *
outBlock
) const;

53 #ià
CRYPTOPP_BOOL_AESNI_INTRINSICS_AVAILABLE


54 
size_t
 
AdvªûdProûssBlocks
(cÚ¡ 
by‹
 *
šBlocks
, cÚ¡ by‹ *
xÜBlocks
, by‹ *
outBlocks
, size_ˆ
Ëngth
, 
wÜd32
 
æags
) const;

58 
	gpublic
:

59 
BlockCh”Fš®
<
	tENCRYPTION
, 
	tEnc
> 
	tEnüy±iÚ
;

60 
	gBlockCh”Fš®
<
	tDECRYPTION
, 
	tDec
> 
	tDeüy±iÚ
;

63 
	gRijnd«l
::
	tEnüy±iÚ
 
	tRijnd«lEnüy±iÚ
;

64 
	gRijnd«l
::
	tDeüy±iÚ
 
	tRijnd«lDeüy±iÚ
;

66 
	gNAMESPACE_END


	@ripemd.cpp

6 
	~"pch.h
"

7 
	~"remd.h
"

8 
	~"misc.h
"

10 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

12 
	#F
(
x
, 
y
, 
z
è(x ^ y ^ z)

	)

13 
	#G
(
x
, 
y
, 
z
è(z ^ (x & (y^z)))

	)

14 
	#H
(
x
, 
y
, 
z
è(z ^ (x | ~y))

	)

15 
	#I
(
x
, 
y
, 
z
è(y ^ (z & (x^y)))

	)

16 
	#J
(
x
, 
y
, 
z
è(x ^ (y | ~z))

	)

18 
	#k0
 0

	)

19 
	#k1
 0x5a827999UL

	)

20 
	#k2
 0x6ed9eba1UL

	)

21 
	#k3
 0x8f1bbcdcUL

	)

22 
	#k4
 0xa953fd4eUL

	)

23 
	#k5
 0x50a28be6UL

	)

24 
	#k6
 0x5c4dd124UL

	)

25 
	#k7
 0x6d703ef3UL

	)

26 
	#k8
 0x7a6d76e9UL

	)

27 
	#k9
 0

	)

32 
	#Subround
(
f
, 
a
, 
b
, 
c
, 
d
, 
e
, 
x
, 
s
, 
k
) \

33 
a
 +ğ
	`f
(
b
, 
c
, 
d
è+ 
x
 + 
k
;\

34 
a
 = 
	`rÙlFixed
((
wÜd32
ï, 
s
è+ 
e
;\

35 
c
 = 
	`rÙlFixed
((
wÜd32
)c, 10U)

	)

37 
RIPEMD160
::
	$In™S‹
(
HashWÜdTy³
 *
¡©e
)

39 
¡©e
[0] = 0x67452301L;

40 
¡©e
[1] = 0xefcdab89L;

41 
¡©e
[2] = 0x98badcfeL;

42 
¡©e
[3] = 0x10325476L;

43 
¡©e
[4] = 0xc3d2e1f0L;

44 
	}
}

46 
	gRIPEMD160
::
	$T¿nsfÜm
 (
wÜd32
 *
dige¡
, cÚ¡ wÜd32 *
X
)

48 
a1
, 
b1
, 
c1
, 
d1
, 
e1
, 
a2
, 
b2
, 
c2
, 
d2
, 
e2
;

49 
a1
 = 
a2
 = 
dige¡
[0];

50 
b1
 = 
b2
 = 
dige¡
[1];

51 
c1
 = 
c2
 = 
dige¡
[2];

52 
d1
 = 
d2
 = 
dige¡
[3];

53 
e1
 = 
e2
 = 
dige¡
[4];

55 
	`Subround
(
F
, 
a1
, 
b1
, 
c1
, 
d1
, 
e1
, 
X
[ 0], 11, 
k0
);

56 
	`Subround
(
F
, 
e1
, 
a1
, 
b1
, 
c1
, 
d1
, 
X
[ 1], 14, 
k0
);

57 
	`Subround
(
F
, 
d1
, 
e1
, 
a1
, 
b1
, 
c1
, 
X
[ 2], 15, 
k0
);

58 
	`Subround
(
F
, 
c1
, 
d1
, 
e1
, 
a1
, 
b1
, 
X
[ 3], 12, 
k0
);

59 
	`Subround
(
F
, 
b1
, 
c1
, 
d1
, 
e1
, 
a1
, 
X
[ 4], 5, 
k0
);

60 
	`Subround
(
F
, 
a1
, 
b1
, 
c1
, 
d1
, 
e1
, 
X
[ 5], 8, 
k0
);

61 
	`Subround
(
F
, 
e1
, 
a1
, 
b1
, 
c1
, 
d1
, 
X
[ 6], 7, 
k0
);

62 
	`Subround
(
F
, 
d1
, 
e1
, 
a1
, 
b1
, 
c1
, 
X
[ 7], 9, 
k0
);

63 
	`Subround
(
F
, 
c1
, 
d1
, 
e1
, 
a1
, 
b1
, 
X
[ 8], 11, 
k0
);

64 
	`Subround
(
F
, 
b1
, 
c1
, 
d1
, 
e1
, 
a1
, 
X
[ 9], 13, 
k0
);

65 
	`Subround
(
F
, 
a1
, 
b1
, 
c1
, 
d1
, 
e1
, 
X
[10], 14, 
k0
);

66 
	`Subround
(
F
, 
e1
, 
a1
, 
b1
, 
c1
, 
d1
, 
X
[11], 15, 
k0
);

67 
	`Subround
(
F
, 
d1
, 
e1
, 
a1
, 
b1
, 
c1
, 
X
[12], 6, 
k0
);

68 
	`Subround
(
F
, 
c1
, 
d1
, 
e1
, 
a1
, 
b1
, 
X
[13], 7, 
k0
);

69 
	`Subround
(
F
, 
b1
, 
c1
, 
d1
, 
e1
, 
a1
, 
X
[14], 9, 
k0
);

70 
	`Subround
(
F
, 
a1
, 
b1
, 
c1
, 
d1
, 
e1
, 
X
[15], 8, 
k0
);

72 
	`Subround
(
G
, 
e1
, 
a1
, 
b1
, 
c1
, 
d1
, 
X
[ 7], 7, 
k1
);

73 
	`Subround
(
G
, 
d1
, 
e1
, 
a1
, 
b1
, 
c1
, 
X
[ 4], 6, 
k1
);

74 
	`Subround
(
G
, 
c1
, 
d1
, 
e1
, 
a1
, 
b1
, 
X
[13], 8, 
k1
);

75 
	`Subround
(
G
, 
b1
, 
c1
, 
d1
, 
e1
, 
a1
, 
X
[ 1], 13, 
k1
);

76 
	`Subround
(
G
, 
a1
, 
b1
, 
c1
, 
d1
, 
e1
, 
X
[10], 11, 
k1
);

77 
	`Subround
(
G
, 
e1
, 
a1
, 
b1
, 
c1
, 
d1
, 
X
[ 6], 9, 
k1
);

78 
	`Subround
(
G
, 
d1
, 
e1
, 
a1
, 
b1
, 
c1
, 
X
[15], 7, 
k1
);

79 
	`Subround
(
G
, 
c1
, 
d1
, 
e1
, 
a1
, 
b1
, 
X
[ 3], 15, 
k1
);

80 
	`Subround
(
G
, 
b1
, 
c1
, 
d1
, 
e1
, 
a1
, 
X
[12], 7, 
k1
);

81 
	`Subround
(
G
, 
a1
, 
b1
, 
c1
, 
d1
, 
e1
, 
X
[ 0], 12, 
k1
);

82 
	`Subround
(
G
, 
e1
, 
a1
, 
b1
, 
c1
, 
d1
, 
X
[ 9], 15, 
k1
);

83 
	`Subround
(
G
, 
d1
, 
e1
, 
a1
, 
b1
, 
c1
, 
X
[ 5], 9, 
k1
);

84 
	`Subround
(
G
, 
c1
, 
d1
, 
e1
, 
a1
, 
b1
, 
X
[ 2], 11, 
k1
);

85 
	`Subround
(
G
, 
b1
, 
c1
, 
d1
, 
e1
, 
a1
, 
X
[14], 7, 
k1
);

86 
	`Subround
(
G
, 
a1
, 
b1
, 
c1
, 
d1
, 
e1
, 
X
[11], 13, 
k1
);

87 
	`Subround
(
G
, 
e1
, 
a1
, 
b1
, 
c1
, 
d1
, 
X
[ 8], 12, 
k1
);

89 
	`Subround
(
H
, 
d1
, 
e1
, 
a1
, 
b1
, 
c1
, 
X
[ 3], 11, 
k2
);

90 
	`Subround
(
H
, 
c1
, 
d1
, 
e1
, 
a1
, 
b1
, 
X
[10], 13, 
k2
);

91 
	`Subround
(
H
, 
b1
, 
c1
, 
d1
, 
e1
, 
a1
, 
X
[14], 6, 
k2
);

92 
	`Subround
(
H
, 
a1
, 
b1
, 
c1
, 
d1
, 
e1
, 
X
[ 4], 7, 
k2
);

93 
	`Subround
(
H
, 
e1
, 
a1
, 
b1
, 
c1
, 
d1
, 
X
[ 9], 14, 
k2
);

94 
	`Subround
(
H
, 
d1
, 
e1
, 
a1
, 
b1
, 
c1
, 
X
[15], 9, 
k2
);

95 
	`Subround
(
H
, 
c1
, 
d1
, 
e1
, 
a1
, 
b1
, 
X
[ 8], 13, 
k2
);

96 
	`Subround
(
H
, 
b1
, 
c1
, 
d1
, 
e1
, 
a1
, 
X
[ 1], 15, 
k2
);

97 
	`Subround
(
H
, 
a1
, 
b1
, 
c1
, 
d1
, 
e1
, 
X
[ 2], 14, 
k2
);

98 
	`Subround
(
H
, 
e1
, 
a1
, 
b1
, 
c1
, 
d1
, 
X
[ 7], 8, 
k2
);

99 
	`Subround
(
H
, 
d1
, 
e1
, 
a1
, 
b1
, 
c1
, 
X
[ 0], 13, 
k2
);

100 
	`Subround
(
H
, 
c1
, 
d1
, 
e1
, 
a1
, 
b1
, 
X
[ 6], 6, 
k2
);

101 
	`Subround
(
H
, 
b1
, 
c1
, 
d1
, 
e1
, 
a1
, 
X
[13], 5, 
k2
);

102 
	`Subround
(
H
, 
a1
, 
b1
, 
c1
, 
d1
, 
e1
, 
X
[11], 12, 
k2
);

103 
	`Subround
(
H
, 
e1
, 
a1
, 
b1
, 
c1
, 
d1
, 
X
[ 5], 7, 
k2
);

104 
	`Subround
(
H
, 
d1
, 
e1
, 
a1
, 
b1
, 
c1
, 
X
[12], 5, 
k2
);

106 
	`Subround
(
I
, 
c1
, 
d1
, 
e1
, 
a1
, 
b1
, 
X
[ 1], 11, 
k3
);

107 
	`Subround
(
I
, 
b1
, 
c1
, 
d1
, 
e1
, 
a1
, 
X
[ 9], 12, 
k3
);

108 
	`Subround
(
I
, 
a1
, 
b1
, 
c1
, 
d1
, 
e1
, 
X
[11], 14, 
k3
);

109 
	`Subround
(
I
, 
e1
, 
a1
, 
b1
, 
c1
, 
d1
, 
X
[10], 15, 
k3
);

110 
	`Subround
(
I
, 
d1
, 
e1
, 
a1
, 
b1
, 
c1
, 
X
[ 0], 14, 
k3
);

111 
	`Subround
(
I
, 
c1
, 
d1
, 
e1
, 
a1
, 
b1
, 
X
[ 8], 15, 
k3
);

112 
	`Subround
(
I
, 
b1
, 
c1
, 
d1
, 
e1
, 
a1
, 
X
[12], 9, 
k3
);

113 
	`Subround
(
I
, 
a1
, 
b1
, 
c1
, 
d1
, 
e1
, 
X
[ 4], 8, 
k3
);

114 
	`Subround
(
I
, 
e1
, 
a1
, 
b1
, 
c1
, 
d1
, 
X
[13], 9, 
k3
);

115 
	`Subround
(
I
, 
d1
, 
e1
, 
a1
, 
b1
, 
c1
, 
X
[ 3], 14, 
k3
);

116 
	`Subround
(
I
, 
c1
, 
d1
, 
e1
, 
a1
, 
b1
, 
X
[ 7], 5, 
k3
);

117 
	`Subround
(
I
, 
b1
, 
c1
, 
d1
, 
e1
, 
a1
, 
X
[15], 6, 
k3
);

118 
	`Subround
(
I
, 
a1
, 
b1
, 
c1
, 
d1
, 
e1
, 
X
[14], 8, 
k3
);

119 
	`Subround
(
I
, 
e1
, 
a1
, 
b1
, 
c1
, 
d1
, 
X
[ 5], 6, 
k3
);

120 
	`Subround
(
I
, 
d1
, 
e1
, 
a1
, 
b1
, 
c1
, 
X
[ 6], 5, 
k3
);

121 
	`Subround
(
I
, 
c1
, 
d1
, 
e1
, 
a1
, 
b1
, 
X
[ 2], 12, 
k3
);

123 
	`Subround
(
J
, 
b1
, 
c1
, 
d1
, 
e1
, 
a1
, 
X
[ 4], 9, 
k4
);

124 
	`Subround
(
J
, 
a1
, 
b1
, 
c1
, 
d1
, 
e1
, 
X
[ 0], 15, 
k4
);

125 
	`Subround
(
J
, 
e1
, 
a1
, 
b1
, 
c1
, 
d1
, 
X
[ 5], 5, 
k4
);

126 
	`Subround
(
J
, 
d1
, 
e1
, 
a1
, 
b1
, 
c1
, 
X
[ 9], 11, 
k4
);

127 
	`Subround
(
J
, 
c1
, 
d1
, 
e1
, 
a1
, 
b1
, 
X
[ 7], 6, 
k4
);

128 
	`Subround
(
J
, 
b1
, 
c1
, 
d1
, 
e1
, 
a1
, 
X
[12], 8, 
k4
);

129 
	`Subround
(
J
, 
a1
, 
b1
, 
c1
, 
d1
, 
e1
, 
X
[ 2], 13, 
k4
);

130 
	`Subround
(
J
, 
e1
, 
a1
, 
b1
, 
c1
, 
d1
, 
X
[10], 12, 
k4
);

131 
	`Subround
(
J
, 
d1
, 
e1
, 
a1
, 
b1
, 
c1
, 
X
[14], 5, 
k4
);

132 
	`Subround
(
J
, 
c1
, 
d1
, 
e1
, 
a1
, 
b1
, 
X
[ 1], 12, 
k4
);

133 
	`Subround
(
J
, 
b1
, 
c1
, 
d1
, 
e1
, 
a1
, 
X
[ 3], 13, 
k4
);

134 
	`Subround
(
J
, 
a1
, 
b1
, 
c1
, 
d1
, 
e1
, 
X
[ 8], 14, 
k4
);

135 
	`Subround
(
J
, 
e1
, 
a1
, 
b1
, 
c1
, 
d1
, 
X
[11], 11, 
k4
);

136 
	`Subround
(
J
, 
d1
, 
e1
, 
a1
, 
b1
, 
c1
, 
X
[ 6], 8, 
k4
);

137 
	`Subround
(
J
, 
c1
, 
d1
, 
e1
, 
a1
, 
b1
, 
X
[15], 5, 
k4
);

138 
	`Subround
(
J
, 
b1
, 
c1
, 
d1
, 
e1
, 
a1
, 
X
[13], 6, 
k4
);

140 
	`Subround
(
J
, 
a2
, 
b2
, 
c2
, 
d2
, 
e2
, 
X
[ 5], 8, 
k5
);

141 
	`Subround
(
J
, 
e2
, 
a2
, 
b2
, 
c2
, 
d2
, 
X
[14], 9, 
k5
);

142 
	`Subround
(
J
, 
d2
, 
e2
, 
a2
, 
b2
, 
c2
, 
X
[ 7], 9, 
k5
);

143 
	`Subround
(
J
, 
c2
, 
d2
, 
e2
, 
a2
, 
b2
, 
X
[ 0], 11, 
k5
);

144 
	`Subround
(
J
, 
b2
, 
c2
, 
d2
, 
e2
, 
a2
, 
X
[ 9], 13, 
k5
);

145 
	`Subround
(
J
, 
a2
, 
b2
, 
c2
, 
d2
, 
e2
, 
X
[ 2], 15, 
k5
);

146 
	`Subround
(
J
, 
e2
, 
a2
, 
b2
, 
c2
, 
d2
, 
X
[11], 15, 
k5
);

147 
	`Subround
(
J
, 
d2
, 
e2
, 
a2
, 
b2
, 
c2
, 
X
[ 4], 5, 
k5
);

148 
	`Subround
(
J
, 
c2
, 
d2
, 
e2
, 
a2
, 
b2
, 
X
[13], 7, 
k5
);

149 
	`Subround
(
J
, 
b2
, 
c2
, 
d2
, 
e2
, 
a2
, 
X
[ 6], 7, 
k5
);

150 
	`Subround
(
J
, 
a2
, 
b2
, 
c2
, 
d2
, 
e2
, 
X
[15], 8, 
k5
);

151 
	`Subround
(
J
, 
e2
, 
a2
, 
b2
, 
c2
, 
d2
, 
X
[ 8], 11, 
k5
);

152 
	`Subround
(
J
, 
d2
, 
e2
, 
a2
, 
b2
, 
c2
, 
X
[ 1], 14, 
k5
);

153 
	`Subround
(
J
, 
c2
, 
d2
, 
e2
, 
a2
, 
b2
, 
X
[10], 14, 
k5
);

154 
	`Subround
(
J
, 
b2
, 
c2
, 
d2
, 
e2
, 
a2
, 
X
[ 3], 12, 
k5
);

155 
	`Subround
(
J
, 
a2
, 
b2
, 
c2
, 
d2
, 
e2
, 
X
[12], 6, 
k5
);

157 
	`Subround
(
I
, 
e2
, 
a2
, 
b2
, 
c2
, 
d2
, 
X
[ 6], 9, 
k6
);

158 
	`Subround
(
I
, 
d2
, 
e2
, 
a2
, 
b2
, 
c2
, 
X
[11], 13, 
k6
);

159 
	`Subround
(
I
, 
c2
, 
d2
, 
e2
, 
a2
, 
b2
, 
X
[ 3], 15, 
k6
);

160 
	`Subround
(
I
, 
b2
, 
c2
, 
d2
, 
e2
, 
a2
, 
X
[ 7], 7, 
k6
);

161 
	`Subround
(
I
, 
a2
, 
b2
, 
c2
, 
d2
, 
e2
, 
X
[ 0], 12, 
k6
);

162 
	`Subround
(
I
, 
e2
, 
a2
, 
b2
, 
c2
, 
d2
, 
X
[13], 8, 
k6
);

163 
	`Subround
(
I
, 
d2
, 
e2
, 
a2
, 
b2
, 
c2
, 
X
[ 5], 9, 
k6
);

164 
	`Subround
(
I
, 
c2
, 
d2
, 
e2
, 
a2
, 
b2
, 
X
[10], 11, 
k6
);

165 
	`Subround
(
I
, 
b2
, 
c2
, 
d2
, 
e2
, 
a2
, 
X
[14], 7, 
k6
);

166 
	`Subround
(
I
, 
a2
, 
b2
, 
c2
, 
d2
, 
e2
, 
X
[15], 7, 
k6
);

167 
	`Subround
(
I
, 
e2
, 
a2
, 
b2
, 
c2
, 
d2
, 
X
[ 8], 12, 
k6
);

168 
	`Subround
(
I
, 
d2
, 
e2
, 
a2
, 
b2
, 
c2
, 
X
[12], 7, 
k6
);

169 
	`Subround
(
I
, 
c2
, 
d2
, 
e2
, 
a2
, 
b2
, 
X
[ 4], 6, 
k6
);

170 
	`Subround
(
I
, 
b2
, 
c2
, 
d2
, 
e2
, 
a2
, 
X
[ 9], 15, 
k6
);

171 
	`Subround
(
I
, 
a2
, 
b2
, 
c2
, 
d2
, 
e2
, 
X
[ 1], 13, 
k6
);

172 
	`Subround
(
I
, 
e2
, 
a2
, 
b2
, 
c2
, 
d2
, 
X
[ 2], 11, 
k6
);

174 
	`Subround
(
H
, 
d2
, 
e2
, 
a2
, 
b2
, 
c2
, 
X
[15], 9, 
k7
);

175 
	`Subround
(
H
, 
c2
, 
d2
, 
e2
, 
a2
, 
b2
, 
X
[ 5], 7, 
k7
);

176 
	`Subround
(
H
, 
b2
, 
c2
, 
d2
, 
e2
, 
a2
, 
X
[ 1], 15, 
k7
);

177 
	`Subround
(
H
, 
a2
, 
b2
, 
c2
, 
d2
, 
e2
, 
X
[ 3], 11, 
k7
);

178 
	`Subround
(
H
, 
e2
, 
a2
, 
b2
, 
c2
, 
d2
, 
X
[ 7], 8, 
k7
);

179 
	`Subround
(
H
, 
d2
, 
e2
, 
a2
, 
b2
, 
c2
, 
X
[14], 6, 
k7
);

180 
	`Subround
(
H
, 
c2
, 
d2
, 
e2
, 
a2
, 
b2
, 
X
[ 6], 6, 
k7
);

181 
	`Subround
(
H
, 
b2
, 
c2
, 
d2
, 
e2
, 
a2
, 
X
[ 9], 14, 
k7
);

182 
	`Subround
(
H
, 
a2
, 
b2
, 
c2
, 
d2
, 
e2
, 
X
[11], 12, 
k7
);

183 
	`Subround
(
H
, 
e2
, 
a2
, 
b2
, 
c2
, 
d2
, 
X
[ 8], 13, 
k7
);

184 
	`Subround
(
H
, 
d2
, 
e2
, 
a2
, 
b2
, 
c2
, 
X
[12], 5, 
k7
);

185 
	`Subround
(
H
, 
c2
, 
d2
, 
e2
, 
a2
, 
b2
, 
X
[ 2], 14, 
k7
);

186 
	`Subround
(
H
, 
b2
, 
c2
, 
d2
, 
e2
, 
a2
, 
X
[10], 13, 
k7
);

187 
	`Subround
(
H
, 
a2
, 
b2
, 
c2
, 
d2
, 
e2
, 
X
[ 0], 13, 
k7
);

188 
	`Subround
(
H
, 
e2
, 
a2
, 
b2
, 
c2
, 
d2
, 
X
[ 4], 7, 
k7
);

189 
	`Subround
(
H
, 
d2
, 
e2
, 
a2
, 
b2
, 
c2
, 
X
[13], 5, 
k7
);

191 
	`Subround
(
G
, 
c2
, 
d2
, 
e2
, 
a2
, 
b2
, 
X
[ 8], 15, 
k8
);

192 
	`Subround
(
G
, 
b2
, 
c2
, 
d2
, 
e2
, 
a2
, 
X
[ 6], 5, 
k8
);

193 
	`Subround
(
G
, 
a2
, 
b2
, 
c2
, 
d2
, 
e2
, 
X
[ 4], 8, 
k8
);

194 
	`Subround
(
G
, 
e2
, 
a2
, 
b2
, 
c2
, 
d2
, 
X
[ 1], 11, 
k8
);

195 
	`Subround
(
G
, 
d2
, 
e2
, 
a2
, 
b2
, 
c2
, 
X
[ 3], 14, 
k8
);

196 
	`Subround
(
G
, 
c2
, 
d2
, 
e2
, 
a2
, 
b2
, 
X
[11], 14, 
k8
);

197 
	`Subround
(
G
, 
b2
, 
c2
, 
d2
, 
e2
, 
a2
, 
X
[15], 6, 
k8
);

198 
	`Subround
(
G
, 
a2
, 
b2
, 
c2
, 
d2
, 
e2
, 
X
[ 0], 14, 
k8
);

199 
	`Subround
(
G
, 
e2
, 
a2
, 
b2
, 
c2
, 
d2
, 
X
[ 5], 6, 
k8
);

200 
	`Subround
(
G
, 
d2
, 
e2
, 
a2
, 
b2
, 
c2
, 
X
[12], 9, 
k8
);

201 
	`Subround
(
G
, 
c2
, 
d2
, 
e2
, 
a2
, 
b2
, 
X
[ 2], 12, 
k8
);

202 
	`Subround
(
G
, 
b2
, 
c2
, 
d2
, 
e2
, 
a2
, 
X
[13], 9, 
k8
);

203 
	`Subround
(
G
, 
a2
, 
b2
, 
c2
, 
d2
, 
e2
, 
X
[ 9], 12, 
k8
);

204 
	`Subround
(
G
, 
e2
, 
a2
, 
b2
, 
c2
, 
d2
, 
X
[ 7], 5, 
k8
);

205 
	`Subround
(
G
, 
d2
, 
e2
, 
a2
, 
b2
, 
c2
, 
X
[10], 15, 
k8
);

206 
	`Subround
(
G
, 
c2
, 
d2
, 
e2
, 
a2
, 
b2
, 
X
[14], 8, 
k8
);

208 
	`Subround
(
F
, 
b2
, 
c2
, 
d2
, 
e2
, 
a2
, 
X
[12], 8, 
k9
);

209 
	`Subround
(
F
, 
a2
, 
b2
, 
c2
, 
d2
, 
e2
, 
X
[15], 5, 
k9
);

210 
	`Subround
(
F
, 
e2
, 
a2
, 
b2
, 
c2
, 
d2
, 
X
[10], 12, 
k9
);

211 
	`Subround
(
F
, 
d2
, 
e2
, 
a2
, 
b2
, 
c2
, 
X
[ 4], 9, 
k9
);

212 
	`Subround
(
F
, 
c2
, 
d2
, 
e2
, 
a2
, 
b2
, 
X
[ 1], 12, 
k9
);

213 
	`Subround
(
F
, 
b2
, 
c2
, 
d2
, 
e2
, 
a2
, 
X
[ 5], 5, 
k9
);

214 
	`Subround
(
F
, 
a2
, 
b2
, 
c2
, 
d2
, 
e2
, 
X
[ 8], 14, 
k9
);

215 
	`Subround
(
F
, 
e2
, 
a2
, 
b2
, 
c2
, 
d2
, 
X
[ 7], 6, 
k9
);

216 
	`Subround
(
F
, 
d2
, 
e2
, 
a2
, 
b2
, 
c2
, 
X
[ 6], 8, 
k9
);

217 
	`Subround
(
F
, 
c2
, 
d2
, 
e2
, 
a2
, 
b2
, 
X
[ 2], 13, 
k9
);

218 
	`Subround
(
F
, 
b2
, 
c2
, 
d2
, 
e2
, 
a2
, 
X
[13], 6, 
k9
);

219 
	`Subround
(
F
, 
a2
, 
b2
, 
c2
, 
d2
, 
e2
, 
X
[14], 5, 
k9
);

220 
	`Subround
(
F
, 
e2
, 
a2
, 
b2
, 
c2
, 
d2
, 
X
[ 0], 15, 
k9
);

221 
	`Subround
(
F
, 
d2
, 
e2
, 
a2
, 
b2
, 
c2
, 
X
[ 3], 13, 
k9
);

222 
	`Subround
(
F
, 
c2
, 
d2
, 
e2
, 
a2
, 
b2
, 
X
[ 9], 11, 
k9
);

223 
	`Subround
(
F
, 
b2
, 
c2
, 
d2
, 
e2
, 
a2
, 
X
[11], 11, 
k9
);

225 
c1
 = 
dige¡
[1] + c1 + 
d2
;

226 
dige¡
[1] = dige¡[2] + 
d1
 + 
e2
;

227 
dige¡
[2] = dige¡[3] + 
e1
 + 
a2
;

228 
dige¡
[3] = dige¡[4] + 
a1
 + 
b2
;

229 
dige¡
[4] = dige¡[0] + 
b1
 + 
c2
;

230 
dige¡
[0] = 
c1
;

231 
	}
}

235 
	gRIPEMD320
::
	$In™S‹
(
HashWÜdTy³
 *
¡©e
)

237 
¡©e
[0] = 0x67452301L;

238 
¡©e
[1] = 0xefcdab89L;

239 
¡©e
[2] = 0x98badcfeL;

240 
¡©e
[3] = 0x10325476L;

241 
¡©e
[4] = 0xc3d2e1f0L;

242 
¡©e
[5] = 0x76543210L;

243 
¡©e
[6] = 0xfedcba98L;

244 
¡©e
[7] = 0x89abcdefL;

245 
¡©e
[8] = 0x01234567L;

246 
¡©e
[9] = 0x3c2d1e0fL;

247 
	}
}

249 
	gRIPEMD320
::
	$T¿nsfÜm
 (
wÜd32
 *
dige¡
, cÚ¡ wÜd32 *
X
)

251 
a1
, 
b1
, 
c1
, 
d1
, 
e1
, 
a2
, 
b2
, 
c2
, 
d2
, 
e2
, 
t
;

252 
a1
 = 
dige¡
[0];

253 
b1
 = 
dige¡
[1];

254 
c1
 = 
dige¡
[2];

255 
d1
 = 
dige¡
[3];

256 
e1
 = 
dige¡
[4];

257 
a2
 = 
dige¡
[5];

258 
b2
 = 
dige¡
[6];

259 
c2
 = 
dige¡
[7];

260 
d2
 = 
dige¡
[8];

261 
e2
 = 
dige¡
[9];

263 
	`Subround
(
F
, 
a1
, 
b1
, 
c1
, 
d1
, 
e1
, 
X
[ 0], 11, 
k0
);

264 
	`Subround
(
F
, 
e1
, 
a1
, 
b1
, 
c1
, 
d1
, 
X
[ 1], 14, 
k0
);

265 
	`Subround
(
F
, 
d1
, 
e1
, 
a1
, 
b1
, 
c1
, 
X
[ 2], 15, 
k0
);

266 
	`Subround
(
F
, 
c1
, 
d1
, 
e1
, 
a1
, 
b1
, 
X
[ 3], 12, 
k0
);

267 
	`Subround
(
F
, 
b1
, 
c1
, 
d1
, 
e1
, 
a1
, 
X
[ 4], 5, 
k0
);

268 
	`Subround
(
F
, 
a1
, 
b1
, 
c1
, 
d1
, 
e1
, 
X
[ 5], 8, 
k0
);

269 
	`Subround
(
F
, 
e1
, 
a1
, 
b1
, 
c1
, 
d1
, 
X
[ 6], 7, 
k0
);

270 
	`Subround
(
F
, 
d1
, 
e1
, 
a1
, 
b1
, 
c1
, 
X
[ 7], 9, 
k0
);

271 
	`Subround
(
F
, 
c1
, 
d1
, 
e1
, 
a1
, 
b1
, 
X
[ 8], 11, 
k0
);

272 
	`Subround
(
F
, 
b1
, 
c1
, 
d1
, 
e1
, 
a1
, 
X
[ 9], 13, 
k0
);

273 
	`Subround
(
F
, 
a1
, 
b1
, 
c1
, 
d1
, 
e1
, 
X
[10], 14, 
k0
);

274 
	`Subround
(
F
, 
e1
, 
a1
, 
b1
, 
c1
, 
d1
, 
X
[11], 15, 
k0
);

275 
	`Subround
(
F
, 
d1
, 
e1
, 
a1
, 
b1
, 
c1
, 
X
[12], 6, 
k0
);

276 
	`Subround
(
F
, 
c1
, 
d1
, 
e1
, 
a1
, 
b1
, 
X
[13], 7, 
k0
);

277 
	`Subround
(
F
, 
b1
, 
c1
, 
d1
, 
e1
, 
a1
, 
X
[14], 9, 
k0
);

278 
	`Subround
(
F
, 
a1
, 
b1
, 
c1
, 
d1
, 
e1
, 
X
[15], 8, 
k0
);

280 
	`Subround
(
J
, 
a2
, 
b2
, 
c2
, 
d2
, 
e2
, 
X
[ 5], 8, 
k5
);

281 
	`Subround
(
J
, 
e2
, 
a2
, 
b2
, 
c2
, 
d2
, 
X
[14], 9, 
k5
);

282 
	`Subround
(
J
, 
d2
, 
e2
, 
a2
, 
b2
, 
c2
, 
X
[ 7], 9, 
k5
);

283 
	`Subround
(
J
, 
c2
, 
d2
, 
e2
, 
a2
, 
b2
, 
X
[ 0], 11, 
k5
);

284 
	`Subround
(
J
, 
b2
, 
c2
, 
d2
, 
e2
, 
a2
, 
X
[ 9], 13, 
k5
);

285 
	`Subround
(
J
, 
a2
, 
b2
, 
c2
, 
d2
, 
e2
, 
X
[ 2], 15, 
k5
);

286 
	`Subround
(
J
, 
e2
, 
a2
, 
b2
, 
c2
, 
d2
, 
X
[11], 15, 
k5
);

287 
	`Subround
(
J
, 
d2
, 
e2
, 
a2
, 
b2
, 
c2
, 
X
[ 4], 5, 
k5
);

288 
	`Subround
(
J
, 
c2
, 
d2
, 
e2
, 
a2
, 
b2
, 
X
[13], 7, 
k5
);

289 
	`Subround
(
J
, 
b2
, 
c2
, 
d2
, 
e2
, 
a2
, 
X
[ 6], 7, 
k5
);

290 
	`Subround
(
J
, 
a2
, 
b2
, 
c2
, 
d2
, 
e2
, 
X
[15], 8, 
k5
);

291 
	`Subround
(
J
, 
e2
, 
a2
, 
b2
, 
c2
, 
d2
, 
X
[ 8], 11, 
k5
);

292 
	`Subround
(
J
, 
d2
, 
e2
, 
a2
, 
b2
, 
c2
, 
X
[ 1], 14, 
k5
);

293 
	`Subround
(
J
, 
c2
, 
d2
, 
e2
, 
a2
, 
b2
, 
X
[10], 14, 
k5
);

294 
	`Subround
(
J
, 
b2
, 
c2
, 
d2
, 
e2
, 
a2
, 
X
[ 3], 12, 
k5
);

295 
	`Subround
(
J
, 
a2
, 
b2
, 
c2
, 
d2
, 
e2
, 
X
[12], 6, 
k5
);

297 
t
 = 
a1
;‡1 = 
a2
;‡2 =;

299 
	`Subround
(
G
, 
e1
, 
a1
, 
b1
, 
c1
, 
d1
, 
X
[ 7], 7, 
k1
);

300 
	`Subround
(
G
, 
d1
, 
e1
, 
a1
, 
b1
, 
c1
, 
X
[ 4], 6, 
k1
);

301 
	`Subround
(
G
, 
c1
, 
d1
, 
e1
, 
a1
, 
b1
, 
X
[13], 8, 
k1
);

302 
	`Subround
(
G
, 
b1
, 
c1
, 
d1
, 
e1
, 
a1
, 
X
[ 1], 13, 
k1
);

303 
	`Subround
(
G
, 
a1
, 
b1
, 
c1
, 
d1
, 
e1
, 
X
[10], 11, 
k1
);

304 
	`Subround
(
G
, 
e1
, 
a1
, 
b1
, 
c1
, 
d1
, 
X
[ 6], 9, 
k1
);

305 
	`Subround
(
G
, 
d1
, 
e1
, 
a1
, 
b1
, 
c1
, 
X
[15], 7, 
k1
);

306 
	`Subround
(
G
, 
c1
, 
d1
, 
e1
, 
a1
, 
b1
, 
X
[ 3], 15, 
k1
);

307 
	`Subround
(
G
, 
b1
, 
c1
, 
d1
, 
e1
, 
a1
, 
X
[12], 7, 
k1
);

308 
	`Subround
(
G
, 
a1
, 
b1
, 
c1
, 
d1
, 
e1
, 
X
[ 0], 12, 
k1
);

309 
	`Subround
(
G
, 
e1
, 
a1
, 
b1
, 
c1
, 
d1
, 
X
[ 9], 15, 
k1
);

310 
	`Subround
(
G
, 
d1
, 
e1
, 
a1
, 
b1
, 
c1
, 
X
[ 5], 9, 
k1
);

311 
	`Subround
(
G
, 
c1
, 
d1
, 
e1
, 
a1
, 
b1
, 
X
[ 2], 11, 
k1
);

312 
	`Subround
(
G
, 
b1
, 
c1
, 
d1
, 
e1
, 
a1
, 
X
[14], 7, 
k1
);

313 
	`Subround
(
G
, 
a1
, 
b1
, 
c1
, 
d1
, 
e1
, 
X
[11], 13, 
k1
);

314 
	`Subround
(
G
, 
e1
, 
a1
, 
b1
, 
c1
, 
d1
, 
X
[ 8], 12, 
k1
);

316 
	`Subround
(
I
, 
e2
, 
a2
, 
b2
, 
c2
, 
d2
, 
X
[ 6], 9, 
k6
);

317 
	`Subround
(
I
, 
d2
, 
e2
, 
a2
, 
b2
, 
c2
, 
X
[11], 13, 
k6
);

318 
	`Subround
(
I
, 
c2
, 
d2
, 
e2
, 
a2
, 
b2
, 
X
[ 3], 15, 
k6
);

319 
	`Subround
(
I
, 
b2
, 
c2
, 
d2
, 
e2
, 
a2
, 
X
[ 7], 7, 
k6
);

320 
	`Subround
(
I
, 
a2
, 
b2
, 
c2
, 
d2
, 
e2
, 
X
[ 0], 12, 
k6
);

321 
	`Subround
(
I
, 
e2
, 
a2
, 
b2
, 
c2
, 
d2
, 
X
[13], 8, 
k6
);

322 
	`Subround
(
I
, 
d2
, 
e2
, 
a2
, 
b2
, 
c2
, 
X
[ 5], 9, 
k6
);

323 
	`Subround
(
I
, 
c2
, 
d2
, 
e2
, 
a2
, 
b2
, 
X
[10], 11, 
k6
);

324 
	`Subround
(
I
, 
b2
, 
c2
, 
d2
, 
e2
, 
a2
, 
X
[14], 7, 
k6
);

325 
	`Subround
(
I
, 
a2
, 
b2
, 
c2
, 
d2
, 
e2
, 
X
[15], 7, 
k6
);

326 
	`Subround
(
I
, 
e2
, 
a2
, 
b2
, 
c2
, 
d2
, 
X
[ 8], 12, 
k6
);

327 
	`Subround
(
I
, 
d2
, 
e2
, 
a2
, 
b2
, 
c2
, 
X
[12], 7, 
k6
);

328 
	`Subround
(
I
, 
c2
, 
d2
, 
e2
, 
a2
, 
b2
, 
X
[ 4], 6, 
k6
);

329 
	`Subround
(
I
, 
b2
, 
c2
, 
d2
, 
e2
, 
a2
, 
X
[ 9], 15, 
k6
);

330 
	`Subround
(
I
, 
a2
, 
b2
, 
c2
, 
d2
, 
e2
, 
X
[ 1], 13, 
k6
);

331 
	`Subround
(
I
, 
e2
, 
a2
, 
b2
, 
c2
, 
d2
, 
X
[ 2], 11, 
k6
);

333 
t
 = 
b1
; b1 = 
b2
; b2 =;

335 
	`Subround
(
H
, 
d1
, 
e1
, 
a1
, 
b1
, 
c1
, 
X
[ 3], 11, 
k2
);

336 
	`Subround
(
H
, 
c1
, 
d1
, 
e1
, 
a1
, 
b1
, 
X
[10], 13, 
k2
);

337 
	`Subround
(
H
, 
b1
, 
c1
, 
d1
, 
e1
, 
a1
, 
X
[14], 6, 
k2
);

338 
	`Subround
(
H
, 
a1
, 
b1
, 
c1
, 
d1
, 
e1
, 
X
[ 4], 7, 
k2
);

339 
	`Subround
(
H
, 
e1
, 
a1
, 
b1
, 
c1
, 
d1
, 
X
[ 9], 14, 
k2
);

340 
	`Subround
(
H
, 
d1
, 
e1
, 
a1
, 
b1
, 
c1
, 
X
[15], 9, 
k2
);

341 
	`Subround
(
H
, 
c1
, 
d1
, 
e1
, 
a1
, 
b1
, 
X
[ 8], 13, 
k2
);

342 
	`Subround
(
H
, 
b1
, 
c1
, 
d1
, 
e1
, 
a1
, 
X
[ 1], 15, 
k2
);

343 
	`Subround
(
H
, 
a1
, 
b1
, 
c1
, 
d1
, 
e1
, 
X
[ 2], 14, 
k2
);

344 
	`Subround
(
H
, 
e1
, 
a1
, 
b1
, 
c1
, 
d1
, 
X
[ 7], 8, 
k2
);

345 
	`Subround
(
H
, 
d1
, 
e1
, 
a1
, 
b1
, 
c1
, 
X
[ 0], 13, 
k2
);

346 
	`Subround
(
H
, 
c1
, 
d1
, 
e1
, 
a1
, 
b1
, 
X
[ 6], 6, 
k2
);

347 
	`Subround
(
H
, 
b1
, 
c1
, 
d1
, 
e1
, 
a1
, 
X
[13], 5, 
k2
);

348 
	`Subround
(
H
, 
a1
, 
b1
, 
c1
, 
d1
, 
e1
, 
X
[11], 12, 
k2
);

349 
	`Subround
(
H
, 
e1
, 
a1
, 
b1
, 
c1
, 
d1
, 
X
[ 5], 7, 
k2
);

350 
	`Subround
(
H
, 
d1
, 
e1
, 
a1
, 
b1
, 
c1
, 
X
[12], 5, 
k2
);

352 
	`Subround
(
H
, 
d2
, 
e2
, 
a2
, 
b2
, 
c2
, 
X
[15], 9, 
k7
);

353 
	`Subround
(
H
, 
c2
, 
d2
, 
e2
, 
a2
, 
b2
, 
X
[ 5], 7, 
k7
);

354 
	`Subround
(
H
, 
b2
, 
c2
, 
d2
, 
e2
, 
a2
, 
X
[ 1], 15, 
k7
);

355 
	`Subround
(
H
, 
a2
, 
b2
, 
c2
, 
d2
, 
e2
, 
X
[ 3], 11, 
k7
);

356 
	`Subround
(
H
, 
e2
, 
a2
, 
b2
, 
c2
, 
d2
, 
X
[ 7], 8, 
k7
);

357 
	`Subround
(
H
, 
d2
, 
e2
, 
a2
, 
b2
, 
c2
, 
X
[14], 6, 
k7
);

358 
	`Subround
(
H
, 
c2
, 
d2
, 
e2
, 
a2
, 
b2
, 
X
[ 6], 6, 
k7
);

359 
	`Subround
(
H
, 
b2
, 
c2
, 
d2
, 
e2
, 
a2
, 
X
[ 9], 14, 
k7
);

360 
	`Subround
(
H
, 
a2
, 
b2
, 
c2
, 
d2
, 
e2
, 
X
[11], 12, 
k7
);

361 
	`Subround
(
H
, 
e2
, 
a2
, 
b2
, 
c2
, 
d2
, 
X
[ 8], 13, 
k7
);

362 
	`Subround
(
H
, 
d2
, 
e2
, 
a2
, 
b2
, 
c2
, 
X
[12], 5, 
k7
);

363 
	`Subround
(
H
, 
c2
, 
d2
, 
e2
, 
a2
, 
b2
, 
X
[ 2], 14, 
k7
);

364 
	`Subround
(
H
, 
b2
, 
c2
, 
d2
, 
e2
, 
a2
, 
X
[10], 13, 
k7
);

365 
	`Subround
(
H
, 
a2
, 
b2
, 
c2
, 
d2
, 
e2
, 
X
[ 0], 13, 
k7
);

366 
	`Subround
(
H
, 
e2
, 
a2
, 
b2
, 
c2
, 
d2
, 
X
[ 4], 7, 
k7
);

367 
	`Subround
(
H
, 
d2
, 
e2
, 
a2
, 
b2
, 
c2
, 
X
[13], 5, 
k7
);

369 
t
 = 
c1
; c1 = 
c2
; c2 =;

371 
	`Subround
(
I
, 
c1
, 
d1
, 
e1
, 
a1
, 
b1
, 
X
[ 1], 11, 
k3
);

372 
	`Subround
(
I
, 
b1
, 
c1
, 
d1
, 
e1
, 
a1
, 
X
[ 9], 12, 
k3
);

373 
	`Subround
(
I
, 
a1
, 
b1
, 
c1
, 
d1
, 
e1
, 
X
[11], 14, 
k3
);

374 
	`Subround
(
I
, 
e1
, 
a1
, 
b1
, 
c1
, 
d1
, 
X
[10], 15, 
k3
);

375 
	`Subround
(
I
, 
d1
, 
e1
, 
a1
, 
b1
, 
c1
, 
X
[ 0], 14, 
k3
);

376 
	`Subround
(
I
, 
c1
, 
d1
, 
e1
, 
a1
, 
b1
, 
X
[ 8], 15, 
k3
);

377 
	`Subround
(
I
, 
b1
, 
c1
, 
d1
, 
e1
, 
a1
, 
X
[12], 9, 
k3
);

378 
	`Subround
(
I
, 
a1
, 
b1
, 
c1
, 
d1
, 
e1
, 
X
[ 4], 8, 
k3
);

379 
	`Subround
(
I
, 
e1
, 
a1
, 
b1
, 
c1
, 
d1
, 
X
[13], 9, 
k3
);

380 
	`Subround
(
I
, 
d1
, 
e1
, 
a1
, 
b1
, 
c1
, 
X
[ 3], 14, 
k3
);

381 
	`Subround
(
I
, 
c1
, 
d1
, 
e1
, 
a1
, 
b1
, 
X
[ 7], 5, 
k3
);

382 
	`Subround
(
I
, 
b1
, 
c1
, 
d1
, 
e1
, 
a1
, 
X
[15], 6, 
k3
);

383 
	`Subround
(
I
, 
a1
, 
b1
, 
c1
, 
d1
, 
e1
, 
X
[14], 8, 
k3
);

384 
	`Subround
(
I
, 
e1
, 
a1
, 
b1
, 
c1
, 
d1
, 
X
[ 5], 6, 
k3
);

385 
	`Subround
(
I
, 
d1
, 
e1
, 
a1
, 
b1
, 
c1
, 
X
[ 6], 5, 
k3
);

386 
	`Subround
(
I
, 
c1
, 
d1
, 
e1
, 
a1
, 
b1
, 
X
[ 2], 12, 
k3
);

388 
	`Subround
(
G
, 
c2
, 
d2
, 
e2
, 
a2
, 
b2
, 
X
[ 8], 15, 
k8
);

389 
	`Subround
(
G
, 
b2
, 
c2
, 
d2
, 
e2
, 
a2
, 
X
[ 6], 5, 
k8
);

390 
	`Subround
(
G
, 
a2
, 
b2
, 
c2
, 
d2
, 
e2
, 
X
[ 4], 8, 
k8
);

391 
	`Subround
(
G
, 
e2
, 
a2
, 
b2
, 
c2
, 
d2
, 
X
[ 1], 11, 
k8
);

392 
	`Subround
(
G
, 
d2
, 
e2
, 
a2
, 
b2
, 
c2
, 
X
[ 3], 14, 
k8
);

393 
	`Subround
(
G
, 
c2
, 
d2
, 
e2
, 
a2
, 
b2
, 
X
[11], 14, 
k8
);

394 
	`Subround
(
G
, 
b2
, 
c2
, 
d2
, 
e2
, 
a2
, 
X
[15], 6, 
k8
);

395 
	`Subround
(
G
, 
a2
, 
b2
, 
c2
, 
d2
, 
e2
, 
X
[ 0], 14, 
k8
);

396 
	`Subround
(
G
, 
e2
, 
a2
, 
b2
, 
c2
, 
d2
, 
X
[ 5], 6, 
k8
);

397 
	`Subround
(
G
, 
d2
, 
e2
, 
a2
, 
b2
, 
c2
, 
X
[12], 9, 
k8
);

398 
	`Subround
(
G
, 
c2
, 
d2
, 
e2
, 
a2
, 
b2
, 
X
[ 2], 12, 
k8
);

399 
	`Subround
(
G
, 
b2
, 
c2
, 
d2
, 
e2
, 
a2
, 
X
[13], 9, 
k8
);

400 
	`Subround
(
G
, 
a2
, 
b2
, 
c2
, 
d2
, 
e2
, 
X
[ 9], 12, 
k8
);

401 
	`Subround
(
G
, 
e2
, 
a2
, 
b2
, 
c2
, 
d2
, 
X
[ 7], 5, 
k8
);

402 
	`Subround
(
G
, 
d2
, 
e2
, 
a2
, 
b2
, 
c2
, 
X
[10], 15, 
k8
);

403 
	`Subround
(
G
, 
c2
, 
d2
, 
e2
, 
a2
, 
b2
, 
X
[14], 8, 
k8
);

405 
t
 = 
d1
; d1 = 
d2
; d2 =;

407 
	`Subround
(
J
, 
b1
, 
c1
, 
d1
, 
e1
, 
a1
, 
X
[ 4], 9, 
k4
);

408 
	`Subround
(
J
, 
a1
, 
b1
, 
c1
, 
d1
, 
e1
, 
X
[ 0], 15, 
k4
);

409 
	`Subround
(
J
, 
e1
, 
a1
, 
b1
, 
c1
, 
d1
, 
X
[ 5], 5, 
k4
);

410 
	`Subround
(
J
, 
d1
, 
e1
, 
a1
, 
b1
, 
c1
, 
X
[ 9], 11, 
k4
);

411 
	`Subround
(
J
, 
c1
, 
d1
, 
e1
, 
a1
, 
b1
, 
X
[ 7], 6, 
k4
);

412 
	`Subround
(
J
, 
b1
, 
c1
, 
d1
, 
e1
, 
a1
, 
X
[12], 8, 
k4
);

413 
	`Subround
(
J
, 
a1
, 
b1
, 
c1
, 
d1
, 
e1
, 
X
[ 2], 13, 
k4
);

414 
	`Subround
(
J
, 
e1
, 
a1
, 
b1
, 
c1
, 
d1
, 
X
[10], 12, 
k4
);

415 
	`Subround
(
J
, 
d1
, 
e1
, 
a1
, 
b1
, 
c1
, 
X
[14], 5, 
k4
);

416 
	`Subround
(
J
, 
c1
, 
d1
, 
e1
, 
a1
, 
b1
, 
X
[ 1], 12, 
k4
);

417 
	`Subround
(
J
, 
b1
, 
c1
, 
d1
, 
e1
, 
a1
, 
X
[ 3], 13, 
k4
);

418 
	`Subround
(
J
, 
a1
, 
b1
, 
c1
, 
d1
, 
e1
, 
X
[ 8], 14, 
k4
);

419 
	`Subround
(
J
, 
e1
, 
a1
, 
b1
, 
c1
, 
d1
, 
X
[11], 11, 
k4
);

420 
	`Subround
(
J
, 
d1
, 
e1
, 
a1
, 
b1
, 
c1
, 
X
[ 6], 8, 
k4
);

421 
	`Subround
(
J
, 
c1
, 
d1
, 
e1
, 
a1
, 
b1
, 
X
[15], 5, 
k4
);

422 
	`Subround
(
J
, 
b1
, 
c1
, 
d1
, 
e1
, 
a1
, 
X
[13], 6, 
k4
);

424 
	`Subround
(
F
, 
b2
, 
c2
, 
d2
, 
e2
, 
a2
, 
X
[12], 8, 
k9
);

425 
	`Subround
(
F
, 
a2
, 
b2
, 
c2
, 
d2
, 
e2
, 
X
[15], 5, 
k9
);

426 
	`Subround
(
F
, 
e2
, 
a2
, 
b2
, 
c2
, 
d2
, 
X
[10], 12, 
k9
);

427 
	`Subround
(
F
, 
d2
, 
e2
, 
a2
, 
b2
, 
c2
, 
X
[ 4], 9, 
k9
);

428 
	`Subround
(
F
, 
c2
, 
d2
, 
e2
, 
a2
, 
b2
, 
X
[ 1], 12, 
k9
);

429 
	`Subround
(
F
, 
b2
, 
c2
, 
d2
, 
e2
, 
a2
, 
X
[ 5], 5, 
k9
);

430 
	`Subround
(
F
, 
a2
, 
b2
, 
c2
, 
d2
, 
e2
, 
X
[ 8], 14, 
k9
);

431 
	`Subround
(
F
, 
e2
, 
a2
, 
b2
, 
c2
, 
d2
, 
X
[ 7], 6, 
k9
);

432 
	`Subround
(
F
, 
d2
, 
e2
, 
a2
, 
b2
, 
c2
, 
X
[ 6], 8, 
k9
);

433 
	`Subround
(
F
, 
c2
, 
d2
, 
e2
, 
a2
, 
b2
, 
X
[ 2], 13, 
k9
);

434 
	`Subround
(
F
, 
b2
, 
c2
, 
d2
, 
e2
, 
a2
, 
X
[13], 6, 
k9
);

435 
	`Subround
(
F
, 
a2
, 
b2
, 
c2
, 
d2
, 
e2
, 
X
[14], 5, 
k9
);

436 
	`Subround
(
F
, 
e2
, 
a2
, 
b2
, 
c2
, 
d2
, 
X
[ 0], 15, 
k9
);

437 
	`Subround
(
F
, 
d2
, 
e2
, 
a2
, 
b2
, 
c2
, 
X
[ 3], 13, 
k9
);

438 
	`Subround
(
F
, 
c2
, 
d2
, 
e2
, 
a2
, 
b2
, 
X
[ 9], 11, 
k9
);

439 
	`Subround
(
F
, 
b2
, 
c2
, 
d2
, 
e2
, 
a2
, 
X
[11], 11, 
k9
);

441 
t
 = 
e1
;ƒ1 = 
e2
;ƒ2 =;

443 
dige¡
[0] +ğ
a1
;

444 
dige¡
[1] +ğ
b1
;

445 
dige¡
[2] +ğ
c1
;

446 
dige¡
[3] +ğ
d1
;

447 
dige¡
[4] +ğ
e1
;

448 
dige¡
[5] +ğ
a2
;

449 
dige¡
[6] +ğ
b2
;

450 
dige¡
[7] +ğ
c2
;

451 
dige¡
[8] +ğ
d2
;

452 
dige¡
[9] +ğ
e2
;

453 
	}
}

455 #undeà
Subround


460 
	#Subround
(
f
, 
a
, 
b
, 
c
, 
d
, 
x
, 
s
, 
k
) \

461 
a
 +ğ
	`f
(
b
, 
c
, 
d
è+ 
x
 + 
k
;\

462 
a
 = 
	`rÙlFixed
((
wÜd32
ï, 
s
);

	)

464 
	gRIPEMD128
::
	$In™S‹
(
HashWÜdTy³
 *
¡©e
)

466 
¡©e
[0] = 0x67452301L;

467 
¡©e
[1] = 0xefcdab89L;

468 
¡©e
[2] = 0x98badcfeL;

469 
¡©e
[3] = 0x10325476L;

470 
	}
}

472 
	gRIPEMD128
::
	$T¿nsfÜm
 (
wÜd32
 *
dige¡
, cÚ¡ wÜd32 *
X
)

474 
a1
, 
b1
, 
c1
, 
d1
, 
a2
, 
b2
, 
c2
, 
d2
;

475 
a1
 = 
a2
 = 
dige¡
[0];

476 
b1
 = 
b2
 = 
dige¡
[1];

477 
c1
 = 
c2
 = 
dige¡
[2];

478 
d1
 = 
d2
 = 
dige¡
[3];

480 
	`Subround
(
F
, 
a1
, 
b1
, 
c1
, 
d1
, 
X
[ 0], 11, 
k0
);

481 
	`Subround
(
F
, 
d1
, 
a1
, 
b1
, 
c1
, 
X
[ 1], 14, 
k0
);

482 
	`Subround
(
F
, 
c1
, 
d1
, 
a1
, 
b1
, 
X
[ 2], 15, 
k0
);

483 
	`Subround
(
F
, 
b1
, 
c1
, 
d1
, 
a1
, 
X
[ 3], 12, 
k0
);

484 
	`Subround
(
F
, 
a1
, 
b1
, 
c1
, 
d1
, 
X
[ 4], 5, 
k0
);

485 
	`Subround
(
F
, 
d1
, 
a1
, 
b1
, 
c1
, 
X
[ 5], 8, 
k0
);

486 
	`Subround
(
F
, 
c1
, 
d1
, 
a1
, 
b1
, 
X
[ 6], 7, 
k0
);

487 
	`Subround
(
F
, 
b1
, 
c1
, 
d1
, 
a1
, 
X
[ 7], 9, 
k0
);

488 
	`Subround
(
F
, 
a1
, 
b1
, 
c1
, 
d1
, 
X
[ 8], 11, 
k0
);

489 
	`Subround
(
F
, 
d1
, 
a1
, 
b1
, 
c1
, 
X
[ 9], 13, 
k0
);

490 
	`Subround
(
F
, 
c1
, 
d1
, 
a1
, 
b1
, 
X
[10], 14, 
k0
);

491 
	`Subround
(
F
, 
b1
, 
c1
, 
d1
, 
a1
, 
X
[11], 15, 
k0
);

492 
	`Subround
(
F
, 
a1
, 
b1
, 
c1
, 
d1
, 
X
[12], 6, 
k0
);

493 
	`Subround
(
F
, 
d1
, 
a1
, 
b1
, 
c1
, 
X
[13], 7, 
k0
);

494 
	`Subround
(
F
, 
c1
, 
d1
, 
a1
, 
b1
, 
X
[14], 9, 
k0
);

495 
	`Subround
(
F
, 
b1
, 
c1
, 
d1
, 
a1
, 
X
[15], 8, 
k0
);

497 
	`Subround
(
G
, 
a1
, 
b1
, 
c1
, 
d1
, 
X
[ 7], 7, 
k1
);

498 
	`Subround
(
G
, 
d1
, 
a1
, 
b1
, 
c1
, 
X
[ 4], 6, 
k1
);

499 
	`Subround
(
G
, 
c1
, 
d1
, 
a1
, 
b1
, 
X
[13], 8, 
k1
);

500 
	`Subround
(
G
, 
b1
, 
c1
, 
d1
, 
a1
, 
X
[ 1], 13, 
k1
);

501 
	`Subround
(
G
, 
a1
, 
b1
, 
c1
, 
d1
, 
X
[10], 11, 
k1
);

502 
	`Subround
(
G
, 
d1
, 
a1
, 
b1
, 
c1
, 
X
[ 6], 9, 
k1
);

503 
	`Subround
(
G
, 
c1
, 
d1
, 
a1
, 
b1
, 
X
[15], 7, 
k1
);

504 
	`Subround
(
G
, 
b1
, 
c1
, 
d1
, 
a1
, 
X
[ 3], 15, 
k1
);

505 
	`Subround
(
G
, 
a1
, 
b1
, 
c1
, 
d1
, 
X
[12], 7, 
k1
);

506 
	`Subround
(
G
, 
d1
, 
a1
, 
b1
, 
c1
, 
X
[ 0], 12, 
k1
);

507 
	`Subround
(
G
, 
c1
, 
d1
, 
a1
, 
b1
, 
X
[ 9], 15, 
k1
);

508 
	`Subround
(
G
, 
b1
, 
c1
, 
d1
, 
a1
, 
X
[ 5], 9, 
k1
);

509 
	`Subround
(
G
, 
a1
, 
b1
, 
c1
, 
d1
, 
X
[ 2], 11, 
k1
);

510 
	`Subround
(
G
, 
d1
, 
a1
, 
b1
, 
c1
, 
X
[14], 7, 
k1
);

511 
	`Subround
(
G
, 
c1
, 
d1
, 
a1
, 
b1
, 
X
[11], 13, 
k1
);

512 
	`Subround
(
G
, 
b1
, 
c1
, 
d1
, 
a1
, 
X
[ 8], 12, 
k1
);

514 
	`Subround
(
H
, 
a1
, 
b1
, 
c1
, 
d1
, 
X
[ 3], 11, 
k2
);

515 
	`Subround
(
H
, 
d1
, 
a1
, 
b1
, 
c1
, 
X
[10], 13, 
k2
);

516 
	`Subround
(
H
, 
c1
, 
d1
, 
a1
, 
b1
, 
X
[14], 6, 
k2
);

517 
	`Subround
(
H
, 
b1
, 
c1
, 
d1
, 
a1
, 
X
[ 4], 7, 
k2
);

518 
	`Subround
(
H
, 
a1
, 
b1
, 
c1
, 
d1
, 
X
[ 9], 14, 
k2
);

519 
	`Subround
(
H
, 
d1
, 
a1
, 
b1
, 
c1
, 
X
[15], 9, 
k2
);

520 
	`Subround
(
H
, 
c1
, 
d1
, 
a1
, 
b1
, 
X
[ 8], 13, 
k2
);

521 
	`Subround
(
H
, 
b1
, 
c1
, 
d1
, 
a1
, 
X
[ 1], 15, 
k2
);

522 
	`Subround
(
H
, 
a1
, 
b1
, 
c1
, 
d1
, 
X
[ 2], 14, 
k2
);

523 
	`Subround
(
H
, 
d1
, 
a1
, 
b1
, 
c1
, 
X
[ 7], 8, 
k2
);

524 
	`Subround
(
H
, 
c1
, 
d1
, 
a1
, 
b1
, 
X
[ 0], 13, 
k2
);

525 
	`Subround
(
H
, 
b1
, 
c1
, 
d1
, 
a1
, 
X
[ 6], 6, 
k2
);

526 
	`Subround
(
H
, 
a1
, 
b1
, 
c1
, 
d1
, 
X
[13], 5, 
k2
);

527 
	`Subround
(
H
, 
d1
, 
a1
, 
b1
, 
c1
, 
X
[11], 12, 
k2
);

528 
	`Subround
(
H
, 
c1
, 
d1
, 
a1
, 
b1
, 
X
[ 5], 7, 
k2
);

529 
	`Subround
(
H
, 
b1
, 
c1
, 
d1
, 
a1
, 
X
[12], 5, 
k2
);

531 
	`Subround
(
I
, 
a1
, 
b1
, 
c1
, 
d1
, 
X
[ 1], 11, 
k3
);

532 
	`Subround
(
I
, 
d1
, 
a1
, 
b1
, 
c1
, 
X
[ 9], 12, 
k3
);

533 
	`Subround
(
I
, 
c1
, 
d1
, 
a1
, 
b1
, 
X
[11], 14, 
k3
);

534 
	`Subround
(
I
, 
b1
, 
c1
, 
d1
, 
a1
, 
X
[10], 15, 
k3
);

535 
	`Subround
(
I
, 
a1
, 
b1
, 
c1
, 
d1
, 
X
[ 0], 14, 
k3
);

536 
	`Subround
(
I
, 
d1
, 
a1
, 
b1
, 
c1
, 
X
[ 8], 15, 
k3
);

537 
	`Subround
(
I
, 
c1
, 
d1
, 
a1
, 
b1
, 
X
[12], 9, 
k3
);

538 
	`Subround
(
I
, 
b1
, 
c1
, 
d1
, 
a1
, 
X
[ 4], 8, 
k3
);

539 
	`Subround
(
I
, 
a1
, 
b1
, 
c1
, 
d1
, 
X
[13], 9, 
k3
);

540 
	`Subround
(
I
, 
d1
, 
a1
, 
b1
, 
c1
, 
X
[ 3], 14, 
k3
);

541 
	`Subround
(
I
, 
c1
, 
d1
, 
a1
, 
b1
, 
X
[ 7], 5, 
k3
);

542 
	`Subround
(
I
, 
b1
, 
c1
, 
d1
, 
a1
, 
X
[15], 6, 
k3
);

543 
	`Subround
(
I
, 
a1
, 
b1
, 
c1
, 
d1
, 
X
[14], 8, 
k3
);

544 
	`Subround
(
I
, 
d1
, 
a1
, 
b1
, 
c1
, 
X
[ 5], 6, 
k3
);

545 
	`Subround
(
I
, 
c1
, 
d1
, 
a1
, 
b1
, 
X
[ 6], 5, 
k3
);

546 
	`Subround
(
I
, 
b1
, 
c1
, 
d1
, 
a1
, 
X
[ 2], 12, 
k3
);

548 
	`Subround
(
I
, 
a2
, 
b2
, 
c2
, 
d2
, 
X
[ 5], 8, 
k5
);

549 
	`Subround
(
I
, 
d2
, 
a2
, 
b2
, 
c2
, 
X
[14], 9, 
k5
);

550 
	`Subround
(
I
, 
c2
, 
d2
, 
a2
, 
b2
, 
X
[ 7], 9, 
k5
);

551 
	`Subround
(
I
, 
b2
, 
c2
, 
d2
, 
a2
, 
X
[ 0], 11, 
k5
);

552 
	`Subround
(
I
, 
a2
, 
b2
, 
c2
, 
d2
, 
X
[ 9], 13, 
k5
);

553 
	`Subround
(
I
, 
d2
, 
a2
, 
b2
, 
c2
, 
X
[ 2], 15, 
k5
);

554 
	`Subround
(
I
, 
c2
, 
d2
, 
a2
, 
b2
, 
X
[11], 15, 
k5
);

555 
	`Subround
(
I
, 
b2
, 
c2
, 
d2
, 
a2
, 
X
[ 4], 5, 
k5
);

556 
	`Subround
(
I
, 
a2
, 
b2
, 
c2
, 
d2
, 
X
[13], 7, 
k5
);

557 
	`Subround
(
I
, 
d2
, 
a2
, 
b2
, 
c2
, 
X
[ 6], 7, 
k5
);

558 
	`Subround
(
I
, 
c2
, 
d2
, 
a2
, 
b2
, 
X
[15], 8, 
k5
);

559 
	`Subround
(
I
, 
b2
, 
c2
, 
d2
, 
a2
, 
X
[ 8], 11, 
k5
);

560 
	`Subround
(
I
, 
a2
, 
b2
, 
c2
, 
d2
, 
X
[ 1], 14, 
k5
);

561 
	`Subround
(
I
, 
d2
, 
a2
, 
b2
, 
c2
, 
X
[10], 14, 
k5
);

562 
	`Subround
(
I
, 
c2
, 
d2
, 
a2
, 
b2
, 
X
[ 3], 12, 
k5
);

563 
	`Subround
(
I
, 
b2
, 
c2
, 
d2
, 
a2
, 
X
[12], 6, 
k5
);

565 
	`Subround
(
H
, 
a2
, 
b2
, 
c2
, 
d2
, 
X
[ 6], 9, 
k6
);

566 
	`Subround
(
H
, 
d2
, 
a2
, 
b2
, 
c2
, 
X
[11], 13, 
k6
);

567 
	`Subround
(
H
, 
c2
, 
d2
, 
a2
, 
b2
, 
X
[ 3], 15, 
k6
);

568 
	`Subround
(
H
, 
b2
, 
c2
, 
d2
, 
a2
, 
X
[ 7], 7, 
k6
);

569 
	`Subround
(
H
, 
a2
, 
b2
, 
c2
, 
d2
, 
X
[ 0], 12, 
k6
);

570 
	`Subround
(
H
, 
d2
, 
a2
, 
b2
, 
c2
, 
X
[13], 8, 
k6
);

571 
	`Subround
(
H
, 
c2
, 
d2
, 
a2
, 
b2
, 
X
[ 5], 9, 
k6
);

572 
	`Subround
(
H
, 
b2
, 
c2
, 
d2
, 
a2
, 
X
[10], 11, 
k6
);

573 
	`Subround
(
H
, 
a2
, 
b2
, 
c2
, 
d2
, 
X
[14], 7, 
k6
);

574 
	`Subround
(
H
, 
d2
, 
a2
, 
b2
, 
c2
, 
X
[15], 7, 
k6
);

575 
	`Subround
(
H
, 
c2
, 
d2
, 
a2
, 
b2
, 
X
[ 8], 12, 
k6
);

576 
	`Subround
(
H
, 
b2
, 
c2
, 
d2
, 
a2
, 
X
[12], 7, 
k6
);

577 
	`Subround
(
H
, 
a2
, 
b2
, 
c2
, 
d2
, 
X
[ 4], 6, 
k6
);

578 
	`Subround
(
H
, 
d2
, 
a2
, 
b2
, 
c2
, 
X
[ 9], 15, 
k6
);

579 
	`Subround
(
H
, 
c2
, 
d2
, 
a2
, 
b2
, 
X
[ 1], 13, 
k6
);

580 
	`Subround
(
H
, 
b2
, 
c2
, 
d2
, 
a2
, 
X
[ 2], 11, 
k6
);

582 
	`Subround
(
G
, 
a2
, 
b2
, 
c2
, 
d2
, 
X
[15], 9, 
k7
);

583 
	`Subround
(
G
, 
d2
, 
a2
, 
b2
, 
c2
, 
X
[ 5], 7, 
k7
);

584 
	`Subround
(
G
, 
c2
, 
d2
, 
a2
, 
b2
, 
X
[ 1], 15, 
k7
);

585 
	`Subround
(
G
, 
b2
, 
c2
, 
d2
, 
a2
, 
X
[ 3], 11, 
k7
);

586 
	`Subround
(
G
, 
a2
, 
b2
, 
c2
, 
d2
, 
X
[ 7], 8, 
k7
);

587 
	`Subround
(
G
, 
d2
, 
a2
, 
b2
, 
c2
, 
X
[14], 6, 
k7
);

588 
	`Subround
(
G
, 
c2
, 
d2
, 
a2
, 
b2
, 
X
[ 6], 6, 
k7
);

589 
	`Subround
(
G
, 
b2
, 
c2
, 
d2
, 
a2
, 
X
[ 9], 14, 
k7
);

590 
	`Subround
(
G
, 
a2
, 
b2
, 
c2
, 
d2
, 
X
[11], 12, 
k7
);

591 
	`Subround
(
G
, 
d2
, 
a2
, 
b2
, 
c2
, 
X
[ 8], 13, 
k7
);

592 
	`Subround
(
G
, 
c2
, 
d2
, 
a2
, 
b2
, 
X
[12], 5, 
k7
);

593 
	`Subround
(
G
, 
b2
, 
c2
, 
d2
, 
a2
, 
X
[ 2], 14, 
k7
);

594 
	`Subround
(
G
, 
a2
, 
b2
, 
c2
, 
d2
, 
X
[10], 13, 
k7
);

595 
	`Subround
(
G
, 
d2
, 
a2
, 
b2
, 
c2
, 
X
[ 0], 13, 
k7
);

596 
	`Subround
(
G
, 
c2
, 
d2
, 
a2
, 
b2
, 
X
[ 4], 7, 
k7
);

597 
	`Subround
(
G
, 
b2
, 
c2
, 
d2
, 
a2
, 
X
[13], 5, 
k7
);

599 
	`Subround
(
F
, 
a2
, 
b2
, 
c2
, 
d2
, 
X
[ 8], 15, 
k9
);

600 
	`Subround
(
F
, 
d2
, 
a2
, 
b2
, 
c2
, 
X
[ 6], 5, 
k9
);

601 
	`Subround
(
F
, 
c2
, 
d2
, 
a2
, 
b2
, 
X
[ 4], 8, 
k9
);

602 
	`Subround
(
F
, 
b2
, 
c2
, 
d2
, 
a2
, 
X
[ 1], 11, 
k9
);

603 
	`Subround
(
F
, 
a2
, 
b2
, 
c2
, 
d2
, 
X
[ 3], 14, 
k9
);

604 
	`Subround
(
F
, 
d2
, 
a2
, 
b2
, 
c2
, 
X
[11], 14, 
k9
);

605 
	`Subround
(
F
, 
c2
, 
d2
, 
a2
, 
b2
, 
X
[15], 6, 
k9
);

606 
	`Subround
(
F
, 
b2
, 
c2
, 
d2
, 
a2
, 
X
[ 0], 14, 
k9
);

607 
	`Subround
(
F
, 
a2
, 
b2
, 
c2
, 
d2
, 
X
[ 5], 6, 
k9
);

608 
	`Subround
(
F
, 
d2
, 
a2
, 
b2
, 
c2
, 
X
[12], 9, 
k9
);

609 
	`Subround
(
F
, 
c2
, 
d2
, 
a2
, 
b2
, 
X
[ 2], 12, 
k9
);

610 
	`Subround
(
F
, 
b2
, 
c2
, 
d2
, 
a2
, 
X
[13], 9, 
k9
);

611 
	`Subround
(
F
, 
a2
, 
b2
, 
c2
, 
d2
, 
X
[ 9], 12, 
k9
);

612 
	`Subround
(
F
, 
d2
, 
a2
, 
b2
, 
c2
, 
X
[ 7], 5, 
k9
);

613 
	`Subround
(
F
, 
c2
, 
d2
, 
a2
, 
b2
, 
X
[10], 15, 
k9
);

614 
	`Subround
(
F
, 
b2
, 
c2
, 
d2
, 
a2
, 
X
[14], 8, 
k9
);

616 
c1
 = 
dige¡
[1] + c1 + 
d2
;

617 
dige¡
[1] = dige¡[2] + 
d1
 + 
a2
;

618 
dige¡
[2] = dige¡[3] + 
a1
 + 
b2
;

619 
dige¡
[3] = dige¡[0] + 
b1
 + 
c2
;

620 
dige¡
[0] = 
c1
;

621 
	}
}

625 
	gRIPEMD256
::
	$In™S‹
(
HashWÜdTy³
 *
¡©e
)

627 
¡©e
[0] = 0x67452301L;

628 
¡©e
[1] = 0xefcdab89L;

629 
¡©e
[2] = 0x98badcfeL;

630 
¡©e
[3] = 0x10325476L;

631 
¡©e
[4] = 0x76543210L;

632 
¡©e
[5] = 0xfedcba98L;

633 
¡©e
[6] = 0x89abcdefL;

634 
¡©e
[7] = 0x01234567L;

635 
	}
}

637 
	gRIPEMD256
::
	$T¿nsfÜm
 (
wÜd32
 *
dige¡
, cÚ¡ wÜd32 *
X
)

639 
a1
, 
b1
, 
c1
, 
d1
, 
a2
, 
b2
, 
c2
, 
d2
, 
t
;

640 
a1
 = 
dige¡
[0];

641 
b1
 = 
dige¡
[1];

642 
c1
 = 
dige¡
[2];

643 
d1
 = 
dige¡
[3];

644 
a2
 = 
dige¡
[4];

645 
b2
 = 
dige¡
[5];

646 
c2
 = 
dige¡
[6];

647 
d2
 = 
dige¡
[7];

649 
	`Subround
(
F
, 
a1
, 
b1
, 
c1
, 
d1
, 
X
[ 0], 11, 
k0
);

650 
	`Subround
(
F
, 
d1
, 
a1
, 
b1
, 
c1
, 
X
[ 1], 14, 
k0
);

651 
	`Subround
(
F
, 
c1
, 
d1
, 
a1
, 
b1
, 
X
[ 2], 15, 
k0
);

652 
	`Subround
(
F
, 
b1
, 
c1
, 
d1
, 
a1
, 
X
[ 3], 12, 
k0
);

653 
	`Subround
(
F
, 
a1
, 
b1
, 
c1
, 
d1
, 
X
[ 4], 5, 
k0
);

654 
	`Subround
(
F
, 
d1
, 
a1
, 
b1
, 
c1
, 
X
[ 5], 8, 
k0
);

655 
	`Subround
(
F
, 
c1
, 
d1
, 
a1
, 
b1
, 
X
[ 6], 7, 
k0
);

656 
	`Subround
(
F
, 
b1
, 
c1
, 
d1
, 
a1
, 
X
[ 7], 9, 
k0
);

657 
	`Subround
(
F
, 
a1
, 
b1
, 
c1
, 
d1
, 
X
[ 8], 11, 
k0
);

658 
	`Subround
(
F
, 
d1
, 
a1
, 
b1
, 
c1
, 
X
[ 9], 13, 
k0
);

659 
	`Subround
(
F
, 
c1
, 
d1
, 
a1
, 
b1
, 
X
[10], 14, 
k0
);

660 
	`Subround
(
F
, 
b1
, 
c1
, 
d1
, 
a1
, 
X
[11], 15, 
k0
);

661 
	`Subround
(
F
, 
a1
, 
b1
, 
c1
, 
d1
, 
X
[12], 6, 
k0
);

662 
	`Subround
(
F
, 
d1
, 
a1
, 
b1
, 
c1
, 
X
[13], 7, 
k0
);

663 
	`Subround
(
F
, 
c1
, 
d1
, 
a1
, 
b1
, 
X
[14], 9, 
k0
);

664 
	`Subround
(
F
, 
b1
, 
c1
, 
d1
, 
a1
, 
X
[15], 8, 
k0
);

666 
	`Subround
(
I
, 
a2
, 
b2
, 
c2
, 
d2
, 
X
[ 5], 8, 
k5
);

667 
	`Subround
(
I
, 
d2
, 
a2
, 
b2
, 
c2
, 
X
[14], 9, 
k5
);

668 
	`Subround
(
I
, 
c2
, 
d2
, 
a2
, 
b2
, 
X
[ 7], 9, 
k5
);

669 
	`Subround
(
I
, 
b2
, 
c2
, 
d2
, 
a2
, 
X
[ 0], 11, 
k5
);

670 
	`Subround
(
I
, 
a2
, 
b2
, 
c2
, 
d2
, 
X
[ 9], 13, 
k5
);

671 
	`Subround
(
I
, 
d2
, 
a2
, 
b2
, 
c2
, 
X
[ 2], 15, 
k5
);

672 
	`Subround
(
I
, 
c2
, 
d2
, 
a2
, 
b2
, 
X
[11], 15, 
k5
);

673 
	`Subround
(
I
, 
b2
, 
c2
, 
d2
, 
a2
, 
X
[ 4], 5, 
k5
);

674 
	`Subround
(
I
, 
a2
, 
b2
, 
c2
, 
d2
, 
X
[13], 7, 
k5
);

675 
	`Subround
(
I
, 
d2
, 
a2
, 
b2
, 
c2
, 
X
[ 6], 7, 
k5
);

676 
	`Subround
(
I
, 
c2
, 
d2
, 
a2
, 
b2
, 
X
[15], 8, 
k5
);

677 
	`Subround
(
I
, 
b2
, 
c2
, 
d2
, 
a2
, 
X
[ 8], 11, 
k5
);

678 
	`Subround
(
I
, 
a2
, 
b2
, 
c2
, 
d2
, 
X
[ 1], 14, 
k5
);

679 
	`Subround
(
I
, 
d2
, 
a2
, 
b2
, 
c2
, 
X
[10], 14, 
k5
);

680 
	`Subround
(
I
, 
c2
, 
d2
, 
a2
, 
b2
, 
X
[ 3], 12, 
k5
);

681 
	`Subround
(
I
, 
b2
, 
c2
, 
d2
, 
a2
, 
X
[12], 6, 
k5
);

683 
t
 = 
a1
;‡1 = 
a2
;‡2 =;

685 
	`Subround
(
G
, 
a1
, 
b1
, 
c1
, 
d1
, 
X
[ 7], 7, 
k1
);

686 
	`Subround
(
G
, 
d1
, 
a1
, 
b1
, 
c1
, 
X
[ 4], 6, 
k1
);

687 
	`Subround
(
G
, 
c1
, 
d1
, 
a1
, 
b1
, 
X
[13], 8, 
k1
);

688 
	`Subround
(
G
, 
b1
, 
c1
, 
d1
, 
a1
, 
X
[ 1], 13, 
k1
);

689 
	`Subround
(
G
, 
a1
, 
b1
, 
c1
, 
d1
, 
X
[10], 11, 
k1
);

690 
	`Subround
(
G
, 
d1
, 
a1
, 
b1
, 
c1
, 
X
[ 6], 9, 
k1
);

691 
	`Subround
(
G
, 
c1
, 
d1
, 
a1
, 
b1
, 
X
[15], 7, 
k1
);

692 
	`Subround
(
G
, 
b1
, 
c1
, 
d1
, 
a1
, 
X
[ 3], 15, 
k1
);

693 
	`Subround
(
G
, 
a1
, 
b1
, 
c1
, 
d1
, 
X
[12], 7, 
k1
);

694 
	`Subround
(
G
, 
d1
, 
a1
, 
b1
, 
c1
, 
X
[ 0], 12, 
k1
);

695 
	`Subround
(
G
, 
c1
, 
d1
, 
a1
, 
b1
, 
X
[ 9], 15, 
k1
);

696 
	`Subround
(
G
, 
b1
, 
c1
, 
d1
, 
a1
, 
X
[ 5], 9, 
k1
);

697 
	`Subround
(
G
, 
a1
, 
b1
, 
c1
, 
d1
, 
X
[ 2], 11, 
k1
);

698 
	`Subround
(
G
, 
d1
, 
a1
, 
b1
, 
c1
, 
X
[14], 7, 
k1
);

699 
	`Subround
(
G
, 
c1
, 
d1
, 
a1
, 
b1
, 
X
[11], 13, 
k1
);

700 
	`Subround
(
G
, 
b1
, 
c1
, 
d1
, 
a1
, 
X
[ 8], 12, 
k1
);

702 
	`Subround
(
H
, 
a2
, 
b2
, 
c2
, 
d2
, 
X
[ 6], 9, 
k6
);

703 
	`Subround
(
H
, 
d2
, 
a2
, 
b2
, 
c2
, 
X
[11], 13, 
k6
);

704 
	`Subround
(
H
, 
c2
, 
d2
, 
a2
, 
b2
, 
X
[ 3], 15, 
k6
);

705 
	`Subround
(
H
, 
b2
, 
c2
, 
d2
, 
a2
, 
X
[ 7], 7, 
k6
);

706 
	`Subround
(
H
, 
a2
, 
b2
, 
c2
, 
d2
, 
X
[ 0], 12, 
k6
);

707 
	`Subround
(
H
, 
d2
, 
a2
, 
b2
, 
c2
, 
X
[13], 8, 
k6
);

708 
	`Subround
(
H
, 
c2
, 
d2
, 
a2
, 
b2
, 
X
[ 5], 9, 
k6
);

709 
	`Subround
(
H
, 
b2
, 
c2
, 
d2
, 
a2
, 
X
[10], 11, 
k6
);

710 
	`Subround
(
H
, 
a2
, 
b2
, 
c2
, 
d2
, 
X
[14], 7, 
k6
);

711 
	`Subround
(
H
, 
d2
, 
a2
, 
b2
, 
c2
, 
X
[15], 7, 
k6
);

712 
	`Subround
(
H
, 
c2
, 
d2
, 
a2
, 
b2
, 
X
[ 8], 12, 
k6
);

713 
	`Subround
(
H
, 
b2
, 
c2
, 
d2
, 
a2
, 
X
[12], 7, 
k6
);

714 
	`Subround
(
H
, 
a2
, 
b2
, 
c2
, 
d2
, 
X
[ 4], 6, 
k6
);

715 
	`Subround
(
H
, 
d2
, 
a2
, 
b2
, 
c2
, 
X
[ 9], 15, 
k6
);

716 
	`Subround
(
H
, 
c2
, 
d2
, 
a2
, 
b2
, 
X
[ 1], 13, 
k6
);

717 
	`Subround
(
H
, 
b2
, 
c2
, 
d2
, 
a2
, 
X
[ 2], 11, 
k6
);

719 
t
 = 
b1
; b1 = 
b2
; b2 =;

721 
	`Subround
(
H
, 
a1
, 
b1
, 
c1
, 
d1
, 
X
[ 3], 11, 
k2
);

722 
	`Subround
(
H
, 
d1
, 
a1
, 
b1
, 
c1
, 
X
[10], 13, 
k2
);

723 
	`Subround
(
H
, 
c1
, 
d1
, 
a1
, 
b1
, 
X
[14], 6, 
k2
);

724 
	`Subround
(
H
, 
b1
, 
c1
, 
d1
, 
a1
, 
X
[ 4], 7, 
k2
);

725 
	`Subround
(
H
, 
a1
, 
b1
, 
c1
, 
d1
, 
X
[ 9], 14, 
k2
);

726 
	`Subround
(
H
, 
d1
, 
a1
, 
b1
, 
c1
, 
X
[15], 9, 
k2
);

727 
	`Subround
(
H
, 
c1
, 
d1
, 
a1
, 
b1
, 
X
[ 8], 13, 
k2
);

728 
	`Subround
(
H
, 
b1
, 
c1
, 
d1
, 
a1
, 
X
[ 1], 15, 
k2
);

729 
	`Subround
(
H
, 
a1
, 
b1
, 
c1
, 
d1
, 
X
[ 2], 14, 
k2
);

730 
	`Subround
(
H
, 
d1
, 
a1
, 
b1
, 
c1
, 
X
[ 7], 8, 
k2
);

731 
	`Subround
(
H
, 
c1
, 
d1
, 
a1
, 
b1
, 
X
[ 0], 13, 
k2
);

732 
	`Subround
(
H
, 
b1
, 
c1
, 
d1
, 
a1
, 
X
[ 6], 6, 
k2
);

733 
	`Subround
(
H
, 
a1
, 
b1
, 
c1
, 
d1
, 
X
[13], 5, 
k2
);

734 
	`Subround
(
H
, 
d1
, 
a1
, 
b1
, 
c1
, 
X
[11], 12, 
k2
);

735 
	`Subround
(
H
, 
c1
, 
d1
, 
a1
, 
b1
, 
X
[ 5], 7, 
k2
);

736 
	`Subround
(
H
, 
b1
, 
c1
, 
d1
, 
a1
, 
X
[12], 5, 
k2
);

738 
	`Subround
(
G
, 
a2
, 
b2
, 
c2
, 
d2
, 
X
[15], 9, 
k7
);

739 
	`Subround
(
G
, 
d2
, 
a2
, 
b2
, 
c2
, 
X
[ 5], 7, 
k7
);

740 
	`Subround
(
G
, 
c2
, 
d2
, 
a2
, 
b2
, 
X
[ 1], 15, 
k7
);

741 
	`Subround
(
G
, 
b2
, 
c2
, 
d2
, 
a2
, 
X
[ 3], 11, 
k7
);

742 
	`Subround
(
G
, 
a2
, 
b2
, 
c2
, 
d2
, 
X
[ 7], 8, 
k7
);

743 
	`Subround
(
G
, 
d2
, 
a2
, 
b2
, 
c2
, 
X
[14], 6, 
k7
);

744 
	`Subround
(
G
, 
c2
, 
d2
, 
a2
, 
b2
, 
X
[ 6], 6, 
k7
);

745 
	`Subround
(
G
, 
b2
, 
c2
, 
d2
, 
a2
, 
X
[ 9], 14, 
k7
);

746 
	`Subround
(
G
, 
a2
, 
b2
, 
c2
, 
d2
, 
X
[11], 12, 
k7
);

747 
	`Subround
(
G
, 
d2
, 
a2
, 
b2
, 
c2
, 
X
[ 8], 13, 
k7
);

748 
	`Subround
(
G
, 
c2
, 
d2
, 
a2
, 
b2
, 
X
[12], 5, 
k7
);

749 
	`Subround
(
G
, 
b2
, 
c2
, 
d2
, 
a2
, 
X
[ 2], 14, 
k7
);

750 
	`Subround
(
G
, 
a2
, 
b2
, 
c2
, 
d2
, 
X
[10], 13, 
k7
);

751 
	`Subround
(
G
, 
d2
, 
a2
, 
b2
, 
c2
, 
X
[ 0], 13, 
k7
);

752 
	`Subround
(
G
, 
c2
, 
d2
, 
a2
, 
b2
, 
X
[ 4], 7, 
k7
);

753 
	`Subround
(
G
, 
b2
, 
c2
, 
d2
, 
a2
, 
X
[13], 5, 
k7
);

755 
t
 = 
c1
; c1 = 
c2
; c2 =;

757 
	`Subround
(
I
, 
a1
, 
b1
, 
c1
, 
d1
, 
X
[ 1], 11, 
k3
);

758 
	`Subround
(
I
, 
d1
, 
a1
, 
b1
, 
c1
, 
X
[ 9], 12, 
k3
);

759 
	`Subround
(
I
, 
c1
, 
d1
, 
a1
, 
b1
, 
X
[11], 14, 
k3
);

760 
	`Subround
(
I
, 
b1
, 
c1
, 
d1
, 
a1
, 
X
[10], 15, 
k3
);

761 
	`Subround
(
I
, 
a1
, 
b1
, 
c1
, 
d1
, 
X
[ 0], 14, 
k3
);

762 
	`Subround
(
I
, 
d1
, 
a1
, 
b1
, 
c1
, 
X
[ 8], 15, 
k3
);

763 
	`Subround
(
I
, 
c1
, 
d1
, 
a1
, 
b1
, 
X
[12], 9, 
k3
);

764 
	`Subround
(
I
, 
b1
, 
c1
, 
d1
, 
a1
, 
X
[ 4], 8, 
k3
);

765 
	`Subround
(
I
, 
a1
, 
b1
, 
c1
, 
d1
, 
X
[13], 9, 
k3
);

766 
	`Subround
(
I
, 
d1
, 
a1
, 
b1
, 
c1
, 
X
[ 3], 14, 
k3
);

767 
	`Subround
(
I
, 
c1
, 
d1
, 
a1
, 
b1
, 
X
[ 7], 5, 
k3
);

768 
	`Subround
(
I
, 
b1
, 
c1
, 
d1
, 
a1
, 
X
[15], 6, 
k3
);

769 
	`Subround
(
I
, 
a1
, 
b1
, 
c1
, 
d1
, 
X
[14], 8, 
k3
);

770 
	`Subround
(
I
, 
d1
, 
a1
, 
b1
, 
c1
, 
X
[ 5], 6, 
k3
);

771 
	`Subround
(
I
, 
c1
, 
d1
, 
a1
, 
b1
, 
X
[ 6], 5, 
k3
);

772 
	`Subround
(
I
, 
b1
, 
c1
, 
d1
, 
a1
, 
X
[ 2], 12, 
k3
);

774 
	`Subround
(
F
, 
a2
, 
b2
, 
c2
, 
d2
, 
X
[ 8], 15, 
k9
);

775 
	`Subround
(
F
, 
d2
, 
a2
, 
b2
, 
c2
, 
X
[ 6], 5, 
k9
);

776 
	`Subround
(
F
, 
c2
, 
d2
, 
a2
, 
b2
, 
X
[ 4], 8, 
k9
);

777 
	`Subround
(
F
, 
b2
, 
c2
, 
d2
, 
a2
, 
X
[ 1], 11, 
k9
);

778 
	`Subround
(
F
, 
a2
, 
b2
, 
c2
, 
d2
, 
X
[ 3], 14, 
k9
);

779 
	`Subround
(
F
, 
d2
, 
a2
, 
b2
, 
c2
, 
X
[11], 14, 
k9
);

780 
	`Subround
(
F
, 
c2
, 
d2
, 
a2
, 
b2
, 
X
[15], 6, 
k9
);

781 
	`Subround
(
F
, 
b2
, 
c2
, 
d2
, 
a2
, 
X
[ 0], 14, 
k9
);

782 
	`Subround
(
F
, 
a2
, 
b2
, 
c2
, 
d2
, 
X
[ 5], 6, 
k9
);

783 
	`Subround
(
F
, 
d2
, 
a2
, 
b2
, 
c2
, 
X
[12], 9, 
k9
);

784 
	`Subround
(
F
, 
c2
, 
d2
, 
a2
, 
b2
, 
X
[ 2], 12, 
k9
);

785 
	`Subround
(
F
, 
b2
, 
c2
, 
d2
, 
a2
, 
X
[13], 9, 
k9
);

786 
	`Subround
(
F
, 
a2
, 
b2
, 
c2
, 
d2
, 
X
[ 9], 12, 
k9
);

787 
	`Subround
(
F
, 
d2
, 
a2
, 
b2
, 
c2
, 
X
[ 7], 5, 
k9
);

788 
	`Subround
(
F
, 
c2
, 
d2
, 
a2
, 
b2
, 
X
[10], 15, 
k9
);

789 
	`Subround
(
F
, 
b2
, 
c2
, 
d2
, 
a2
, 
X
[14], 8, 
k9
);

791 
t
 = 
d1
; d1 = 
d2
; d2 =;

793 
dige¡
[0] +ğ
a1
;

794 
dige¡
[1] +ğ
b1
;

795 
dige¡
[2] +ğ
c1
;

796 
dige¡
[3] +ğ
d1
;

797 
dige¡
[4] +ğ
a2
;

798 
dige¡
[5] +ğ
b2
;

799 
dige¡
[6] +ğ
c2
;

800 
dige¡
[7] +ğ
d2
;

801 
	}
}

803 
	gNAMESPACE_END


	@ripemd.h

1 #iâdeà
CRYPTOPP_RIPEMD_H


2 
	#CRYPTOPP_RIPEMD_H


	)

4 
	~"™”hash.h
"

6 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

10 
şass
 
RIPEMD160
 : 
public
 
I‹¿‹dHashW™hSticT¿nsfÜm
<
wÜd32
, 
L™eEndŸn
, 64, 20, RIPEMD160>

12 
public
:

13 
	`In™S‹
(
HashWÜdTy³
 *
¡©e
);

14 
	`T¿nsfÜm
(
wÜd32
 *
dige¡
, cÚ¡ wÜd32 *
d©a
);

15 cÚ¡ * 
	`SticAlgÜ™hmName
() { "RIPEMD-160";}

16 
	}
};

19 
şass
 
	gRIPEMD320
 : 
public
 
I‹¿‹dHashW™hSticT¿nsfÜm
<
wÜd32
, 
	gL™eEndŸn
, 64, 40, RIPEMD320>

21 
	gpublic
:

22 
In™S‹
(
HashWÜdTy³
 *
¡©e
);

23 
T¿nsfÜm
(
wÜd32
 *
dige¡
, cÚ¡ wÜd32 *
d©a
);

24 cÚ¡ * 
SticAlgÜ™hmName
() { "RIPEMD-320";}

29 
şass
 
	gRIPEMD128
 : 
public
 
I‹¿‹dHashW™hSticT¿nsfÜm
<
wÜd32
, 
	gL™eEndŸn
, 64, 16, RIPEMD128>

31 
	gpublic
:

32 
In™S‹
(
HashWÜdTy³
 *
¡©e
);

33 
T¿nsfÜm
(
wÜd32
 *
dige¡
, cÚ¡ wÜd32 *
d©a
);

34 cÚ¡ * 
SticAlgÜ™hmName
() { "RIPEMD-128";}

39 
şass
 
	gRIPEMD256
 : 
public
 
I‹¿‹dHashW™hSticT¿nsfÜm
<
wÜd32
, 
	gL™eEndŸn
, 64, 32, RIPEMD256>

41 
	gpublic
:

42 
In™S‹
(
HashWÜdTy³
 *
¡©e
);

43 
T¿nsfÜm
(
wÜd32
 *
dige¡
, cÚ¡ wÜd32 *
d©a
);

44 cÚ¡ * 
SticAlgÜ™hmName
() { "RIPEMD-256";}

47 
	gNAMESPACE_END


	@rng.cpp

3 
	~"pch.h
"

5 
	~"ºg.h
"

6 
	~"fs140.h
"

8 
	~<time.h
>

9 
	~<m©h.h
>

11 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

25 #iâdeà
LCRNG_ORIGINAL_NUMBERS


26 cÚ¡ 
wÜd32
 
LC_RNG
::
m
=2147483647L;

27 cÚ¡ 
wÜd32
 
LC_RNG
::
q
=44488L;

29 cÚ¡ 
wÜd16
 
LC_RNG
::
a
=()48271L;

30 cÚ¡ 
wÜd16
 
LC_RNG
::
r
=3399;

32 cÚ¡ 
wÜd32
 
LC_RNG
::
m
=2147483647L;

33 cÚ¡ 
wÜd32
 
LC_RNG
::
q
=127773L;

35 cÚ¡ 
wÜd16
 
LC_RNG
::
a
=16807;

36 cÚ¡ 
wÜd16
 
LC_RNG
::
r
=2836;

39 
LC_RNG
::
	$G’”©eBlock
(
by‹
 *
ouut
, 
size_t
 
size
)

41 
size
--)

43 
wÜd32
 
hi
 = 
£ed
/
q
;

44 
wÜd32
 
lo
 = 
£ed
%
q
;

46 
‹¡
 = 
a
*
lo
 - 
r
*
hi
;

48 ià(
‹¡
 > 0)

49 
£ed
 = 
‹¡
;

51 
£ed
 = 
‹¡
+ 
m
;

53 *
ouut
++ = (
	`GETBYTE
(
£ed
, 0) ^ GETBYTE(seed, 1) ^ GETBYTE(seed, 2) ^ GETBYTE(seed, 3));

55 
	}
}

59 #iâdeà
CRYPTOPP_IMPORTS


61 
	gX917RNG
::
	$X917RNG
(
BlockT¿nsfÜm©iÚ
 *
c
, cÚ¡ 
by‹
 *
£ed
, cÚ¡ by‹ *
d‘”mši¡icTimeVeùÜ
)

62 : 
	`ch”
(
c
),

63 
	`S
(
ch”
->
	`BlockSize
()),

64 
	`dtbuf
(
S
),

65 
	`¿nd£ed
(
£ed
, 
S
),

66 
	`m_Ï¡Block
(
S
),

67 
	`m_d‘”mši¡icTimeVeùÜ
(
d‘”mši¡icTimeVeùÜ
, d‘”mši¡icTimeVeùÜ ? 
S
 : 0)

69 ià(!
d‘”mši¡icTimeVeùÜ
)

71 
time_t
 
t¡amp1
 = 
	`time
(0);

72 
	`xÜbuf
(
dtbuf
, (
by‹
 *)&
t¡amp1
, 
	`UnsigÃdMš
(Ñ¡amp1), 
S
));

73 
ch”
->
	`ProûssBlock
(
dtbuf
);

74 
şock_t
 
t¡amp2
 = 
	`şock
();

75 
	`xÜbuf
(
dtbuf
, (
by‹
 *)&
t¡amp2
, 
	`UnsigÃdMš
(Ñ¡amp2), 
S
));

76 
ch”
->
	`ProûssBlock
(
dtbuf
);

80 
	`G’”©eBlock
(
m_Ï¡Block
, 
S
);

81 
	}
}

83 
	gX917RNG
::
	$G’”©eIÁoBufã»dT¿nsfÜm©iÚ
(
Bufã»dT¿nsfÜm©iÚ
 &
rg‘
, cÚ¡ 
¡d
::
¡ršg
 &
chªÃl
, 
lwÜd
 
size
)

85 
size
 > 0)

88 ià(
m_d‘”mši¡icTimeVeùÜ
.
	`size
())

90 
ch”
->
	`ProûssBlock
(
m_d‘”mši¡icTimeVeùÜ
, 
dtbuf
);

91 
	`Inüem’tCouÁ”ByOÃ
(
m_d‘”mši¡icTimeVeùÜ
, 
S
);

95 
şock_t
 
c
 = 
	`şock
();

96 
	`xÜbuf
(
dtbuf
, (
by‹
 *)&
c
, 
	`UnsigÃdMš
((c), 
S
));

97 
time_t
 
t
 = 
	`time
(
NULL
);

98 
	`xÜbuf
(
dtbuf
+
S
-
	`UnsigÃdMš
((
t
), S), (
by‹
 *)&t, UnsignedMin((t), S));

99 
ch”
->
	`ProûssBlock
(
dtbuf
);

103 
	`xÜbuf
(
¿nd£ed
, 
dtbuf
, 
S
);

106 
ch”
->
	`ProûssBlock
(
¿nd£ed
);

107 ià(
	`memcmp
(
m_Ï¡Block
, 
¿nd£ed
, 
S
) == 0)

108 
throw
 
	`S–fTe¡Fau»
("X917RNG: Continuous„andom‚umber generatorest failed.");

111 
size_t
 
Ën
 = 
	`UnsigÃdMš
(
S
, 
size
);

112 
rg‘
.
	`ChªÃlPut
(
chªÃl
, 
¿nd£ed
, 
Ën
);

113 
size
 -ğ
Ën
;

116 
	`memıy
(
m_Ï¡Block
, 
¿nd£ed
, 
S
);

117 
	`xÜbuf
(
¿nd£ed
, 
dtbuf
, 
S
);

118 
ch”
->
	`ProûssBlock
(
¿nd£ed
);

120 
	}
}

124 
	gMau»rRªdomÃssTe¡
::
	$Mau»rRªdomÃssTe¡
()

125 : 
	`sum
(0.0), 
	$n
(0)

127 
i
=0; i<
V
; i++)

128 
b
[
i
] = 0;

129 
	}
}

131 
size_t
 
	gMau»rRªdomÃssTe¡
::
	$Put2
(cÚ¡ 
by‹
 *
šSŒšg
, 
size_t
 
Ëngth
, 
mes§geEnd
, 
boŞ
 
blockšg
)

133 
Ëngth
--)

135 
by‹
 
šBy‹
 = *
šSŒšg
++;

136 ià(
n
 >ğ
Q
)

137 
sum
 +ğ
	`log
((
n
 - 
b
[
šBy‹
]));

138 
b
[
šBy‹
] = 
n
;

139 
n
++;

142 
	}
}

144 
	gMau»rRªdomÃssTe¡
::
	$G‘Te¡V®ue
() const

146 ià(
	`By‹sN“ded
() > 0)

147 
throw
 
	`Exû±iÚ
(
Exû±iÚ
::
OTHER_ERROR
, "Mau»rRªdomÃssTe¡: " + 
	`IÁToSŒšg
(
	`By‹sN“ded
()) + " more bytes of input‚eeded");

149 
fTu
 = (
sum
/(
n
-
Q
))/
	`log
(2.0);

151 
v®ue
 = 
fTu
 * 0.1392;

152  
v®ue
 > 1.0 ? 1.0 : value;

153 
	}
}

155 
	gNAMESPACE_END


	@rng.h

3 #iâdeà
CRYPTOPP_RNG_H


4 
	#CRYPTOPP_RNG_H


	)

6 
	~"üy±lib.h
"

7 
	~"f‹rs.h
"

9 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

13 şas 
	cLC_RNG
 : 
public
 
RªdomNumb”G’”©Ü


15 
public
:

16 
	$LC_RNG
(
wÜd32
 
š™_£ed
)

17 : 
	$£ed
(
š™_£ed
) {}

19 
	`G’”©eBlock
(
by‹
 *
ouut
, 
size_t
 
size
);

21 
wÜd32
 
	$G‘S“d
(è{ 
£ed
;
	}
}

23 
	g´iv©e
:

24 
wÜd32
 
£ed
;

26 cÚ¡ 
wÜd32
 
	gm
;

27 cÚ¡ 
wÜd32
 
	gq
;

28 cÚ¡ 
wÜd16
 
	ga
;

29 cÚ¡ 
wÜd16
 
	gr
;

34 
şass
 
CRYPTOPP_DLL
 
	gX917RNG
 : 
public
 
RªdomNumb”G’”©Ü
,…ubliø
	gNÙCİyabË


36 
	gpublic
:

38 
X917RNG
(
BlockT¿nsfÜm©iÚ
 *
ch”
, cÚ¡ 
by‹
 *
£ed
, cÚ¡ by‹ *
d‘”mši¡icTimeVeùÜ
 = 0);

40 
G’”©eIÁoBufã»dT¿nsfÜm©iÚ
(
Bufã»dT¿nsfÜm©iÚ
 &
rg‘
, cÚ¡ 
¡d
::
¡ršg
 &
chªÃl
, 
lwÜd
 
size
);

42 
	g´iv©e
:

43 
memb”_±r
<
BlockT¿nsfÜm©iÚ
> 
ch”
;

44 
	gS
;

45 
SecBy‹Block
 
	gdtbuf
;

46 
SecBy‹Block
 
	g¿nd£ed
, 
	gm_Ï¡Block
, 
	gm_d‘”mši¡icTimeVeùÜ
;

53 
şass
 
	gMau»rRªdomÃssTe¡
 : 
public
 
Bufã¾ess
<
Sšk
>

55 
public
:

56 
Mau»rRªdomÃssTe¡
();

58 
size_t
 
Put2
(cÚ¡ 
by‹
 *
šSŒšg
, size_ˆ
Ëngth
, 
mes§geEnd
, 
boŞ
 
blockšg
);

62 
By‹sN“ded
(ècÚ¡ { 
	gn
 >ğ(
Q
+
K
è? 0 : Q+K-
n
;}

66 
G‘Te¡V®ue
() const;

68 
	g´iv©e
:

69 ’um {
L
=8, 
	gV
=256, 
	gQ
=2000, 
	gK
=2000};

70 
	gsum
;

71 
	gn
;

72 
	gb
[
V
];

75 
	gNAMESPACE_END


	@rsa.cpp

3 
	~"pch.h
"

4 
	~"r§.h
"

5 
	~"a¢.h
"

6 
	~"oids.h
"

7 
	~"mod¬™h.h
"

8 
	~"nbtheÜy.h
"

9 
	~"sha.h
"

10 
	~"®g·¿m.h
"

11 
	~"fs140.h
"

13 #ià!
defšed
(
NDEBUG
è&& !defšed(
CRYPTOPP_IS_DLL
)

14 
	~"ps¤.h
"

15 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

16 
	$RSA_Te¡In¡ªtŸtiÚs
()

18 
RSASS
<
PKCS1v15
, 
SHA
>::
V”if›r
 
	`x1
(1, 1);

19 
RSASS
<
PKCS1v15
, 
SHA
>::
SigÃr
 
	`x2
(
	`NuÎRNG
(), 1);

20 
RSASS
<
PKCS1v15
, 
SHA
>::
V”if›r
 
	`x3
(
x2
);

21 
RSASS
<
PKCS1v15
, 
SHA
>::
V”if›r
 
	`x4
(
x2
.
	`G‘Key
());

22 
RSASS
<
PSS
, 
SHA
>::
V”if›r
 
	`x5
(
x3
);

23 #iâdeà
__MWERKS__


24 
RSASS
<
PSSR
, 
SHA
>::
SigÃr
 
x6
 = 
x2
;

25 
x3
 = 
x2
;

26 
x6
 = 
x2
;

28 
RSAES
<
PKCS1v15
>::
Enüy±Ü
 
	`x7
(
x2
);

29 #iâdeà
__GNUC__


30 
RSAES
<
PKCS1v15
>::
Enüy±Ü
 
	`x8
(
x3
);

32 
RSAES
<
OAEP
<
SHA
> >::
Enüy±Ü
 
	`x9
(
x2
);

34 
x4
 = 
x2
.
	`G‘Key
();

35 
	}
}

36 
	gNAMESPACE_END


39 #iâdeà
CRYPTOPP_IMPORTS


41 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

43 
OID
 
RSAFunùiÚ
::
	$G‘AlgÜ™hmID
() const

45  
ASN1
::
	`r§Enüy±iÚ
();

46 
	}
}

48 
	gRSAFunùiÚ
::
	$BERDecodePublicKey
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
, 
boŞ
, 
size_t
)

50 
BERSequ’ûDecod”
 
	`£q
(
bt
);

51 
m_n
.
	`BERDecode
(
£q
);

52 
m_e
.
	`BERDecode
(
£q
);

53 
£q
.
	`Mes§geEnd
();

54 
	}
}

56 
	gRSAFunùiÚ
::
	$DEREncodePublicKey
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
) const

58 
DERSequ’ûEncod”
 
	`£q
(
bt
);

59 
m_n
.
	`DEREncode
(
£q
);

60 
m_e
.
	`DEREncode
(
£q
);

61 
£q
.
	`Mes§geEnd
();

62 
	}
}

64 
IÁeg”
 
	gRSAFunùiÚ
::
	$AµlyFunùiÚ
(cÚ¡ 
IÁeg”
 &
x
) const

66 
	`DoQuickSª™yCheck
();

67  
	`a_exp_b_mod_c
(
x
, 
m_e
, 
m_n
);

68 
	}
}

70 
boŞ
 
	gRSAFunùiÚ
::
	$V®id©e
(
RªdomNumb”G’”©Ü
 &
ºg
, 
Ëv–
) const

72 
boŞ
 
·ss
 = 
Œue
;

73 
·ss
 =…as && 
m_n
 > 
IÁeg”
::
	`OÃ
(è&& m_n.
	`IsOdd
();

74 
·ss
 =…as && 
m_e
 > 
IÁeg”
::
	`OÃ
(è&& m_e.
	`IsOdd
(è&& m_< 
m_n
;

75  
·ss
;

76 
	}
}

78 
boŞ
 
	gRSAFunùiÚ
::
	$G‘VoidV®ue
(cÚ¡ *
Çme
, cÚ¡ 
¡d
::
ty³_šfo
 &
v®ueTy³
, *
pV®ue
) const

80  
	`G‘V®ueH–³r
(
this
, 
Çme
, 
v®ueTy³
, 
pV®ue
).
	`AssigÇbË
()

81 
	`CRYPTOPP_GET_FUNCTION_ENTRY
(
Modulus
)

82 
	`CRYPTOPP_GET_FUNCTION_ENTRY
(
PublicExpÚ’t
)

84 
	}
}

86 
	gRSAFunùiÚ
::
	$AssignFrom
(cÚ¡ 
NameV®uePaœs
 &
sourû
)

88 
	`AssignFromH–³r
(
this
, 
sourû
)

89 
	`CRYPTOPP_SET_FUNCTION_ENTRY
(
Modulus
)

90 
	`CRYPTOPP_SET_FUNCTION_ENTRY
(
PublicExpÚ’t
)

92 
	}
}

96 şas 
	cRSAPrimeS–eùÜ
 : 
public
 
PrimeS–eùÜ


98 
public
:

99 
	$RSAPrimeS–eùÜ
(cÚ¡ 
IÁeg”
 &
e
è: 
	$m_e
(
e
) {}

100 
boŞ
 
	$IsAcû±abË
(cÚ¡ 
IÁeg”
 &
ÿndid©e
ècÚ¡ { 
	`R–©iv–yPrime
(
m_e
, cªdid©e-IÁeg”::
	`OÃ
());
	}
}

101 
IÁeg”
 
	gm_e
;

104 
	gInv”tibËRSAFunùiÚ
::
	$G’”©eRªdom
(
RªdomNumb”G’”©Ü
 &
ºg
, cÚ¡ 
NameV®uePaœs
 &
®g
)

106 
modulusSize
 = 2048;

107 
®g
.
	`G‘IÁV®ue
(
Name
::
	`ModulusSize
(), 
modulusSize
è||‡lg.G‘IÁV®ue(Name::
	`KeySize
(), modulusSize);

109 ià(
modulusSize
 < 16)

110 
throw
 
	`Inv®idArgum’t
("InvertibleRSAFunction: specified modulus size isoo small");

112 
m_e
 = 
®g
.
	`G‘V®ueW™hDeçuÉ
(
Name
::
	`PublicExpÚ’t
(), 
	`IÁeg”
(17));

114 ià(
m_e
 < 3 || m_e.
	`IsEv’
())

115 
throw
 
	`Inv®idArgum’t
("InvertibleRSAFunction: invalid…ublicƒxponent");

117 
RSAPrimeS–eùÜ
 
	`£ËùÜ
(
m_e
);

118 
AlgÜ™hmP¬am‘”s
 
´imeP¬am
 = 
	`MakeP¬am‘”sFÜTwoPrimesOfEqu®Size
(
modulusSize
)

119 (
Name
::
	`Poš‹rToPrimeS–eùÜ
(), 
£ËùÜ
.
	`G‘S–eùÜPoš‹r
());

120 
m_p
.
	`G’”©eRªdom
(
ºg
, 
´imeP¬am
);

121 
m_q
.
	`G’”©eRªdom
(
ºg
, 
´imeP¬am
);

123 
m_d
 = 
m_e
.
	`Inv”£Mod
(
	`LCM
(
m_p
-1, 
m_q
-1));

124 
	`as£¹
(
m_d
.
	`IsPos™ive
());

126 
m_dp
 = 
m_d
 % (
m_p
-1);

127 
m_dq
 = 
m_d
 % (
m_q
-1);

128 
m_n
 = 
m_p
 * 
m_q
;

129 
m_u
 = 
m_q
.
	`Inv”£Mod
(
m_p
);

131 ià(
	`FIPS_140_2_Com¶ŸnûEÇbËd
())

133 
RSASS
<
PKCS1v15
, 
SHA
>::
SigÃr
 
	`sigÃr
(*
this
);

134 
RSASS
<
PKCS1v15
, 
SHA
>::
V”if›r
 
	`v”if›r
(
sigÃr
);

135 
	`SigÇtu»Paœwi£CÚsi¡’cyTe¡_FIPS_140_OÆy
(
sigÃr
, 
v”if›r
);

137 
RSAES
<
OAEP
<
SHA
> >::
Deüy±Ü
 
	`deüy±Ü
(*
this
);

138 
RSAES
<
OAEP
<
SHA
> >::
Enüy±Ü
 
	`’üy±Ü
(
deüy±Ü
);

139 
	`Enüy±iÚPaœwi£CÚsi¡’cyTe¡_FIPS_140_OÆy
(
’üy±Ü
, 
deüy±Ü
);

141 
	}
}

143 
	gInv”tibËRSAFunùiÚ
::
	$In™Ÿlize
(
RªdomNumb”G’”©Ü
 &
ºg
, 
keyb™s
, cÚ¡ 
IÁeg”
 &
e
)

145 
	`G’”©eRªdom
(
ºg
, 
	`MakeP¬am‘”s
(
Name
::
	`ModulusSize
(), ()
keyb™s
)(Name::
	`PublicExpÚ’t
(), 
e
+e.
	`IsEv’
()));

146 
	}
}

148 
	gInv”tibËRSAFunùiÚ
::
	$In™Ÿlize
(cÚ¡ 
IÁeg”
 &
n
, cÚ¡ IÁeg” &
e
, cÚ¡ IÁeg” &
d
)

150 ià(
n
.
	`IsEv’
(è|| 
e
.IsEv’(è| 
d
.IsEven())

151 
throw
 
	`Inv®idArgum’t
("InvertibleRSAFunction: input is‚ot‡ valid RSA…rivate key");

153 
m_n
 = 
n
;

154 
m_e
 = 
e
;

155 
m_d
 = 
d
;

157 
IÁeg”
 
r
 = --(
d
*
e
);

158 
s
 = 0;

159 
r
.
	`IsEv’
())

161 
r
 >>= 1;

162 
s
++;

165 
ModuÏrAr™hm‘ic
 
	`modn
(
n
);

166 
IÁeg”
 
i
 = 2; ; ++i)

168 
IÁeg”
 
a
 = 
modn
.
	`ExpÚ’tŸ‹
(
i
, 
r
);

169 ià(
a
 == 1)

171 
IÁeg”
 
b
;

172 
j
 = 0;

173 
a
 !ğ
n
-1)

175 
b
 = 
modn
.
	`Squ¬e
(
a
);

176 ià(
b
 == 1)

178 
m_p
 = 
	`GCD
(
a
-1, 
n
);

179 
m_q
 = 
n
/
m_p
;

180 
m_dp
 = 
m_d
 % (
m_p
-1);

181 
m_dq
 = 
m_d
 % (
m_q
-1);

182 
m_u
 = 
m_q
.
	`Inv”£Mod
(
m_p
);

185 ià(++
j
 =ğ
s
)

186 
throw
 
	`Inv®idArgum’t
("InvertibleRSAFunction: input is‚ot‡ valid RSA…rivate key");

187 
a
 = 
b
;

190 
	}
}

192 
	gInv”tibËRSAFunùiÚ
::
	$BERDecodePriv©eKey
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
, 
boŞ
, 
size_t
)

194 
BERSequ’ûDecod”
 
	`´iv©eKey
(
bt
);

195 
wÜd32
 
v”siÚ
;

196 
BERDecodeUnsigÃd
<
wÜd32
>(
´iv©eKey
, 
v”siÚ
, 
INTEGER
, 0, 0);

197 
m_n
.
	`BERDecode
(
´iv©eKey
);

198 
m_e
.
	`BERDecode
(
´iv©eKey
);

199 
m_d
.
	`BERDecode
(
´iv©eKey
);

200 
m_p
.
	`BERDecode
(
´iv©eKey
);

201 
m_q
.
	`BERDecode
(
´iv©eKey
);

202 
m_dp
.
	`BERDecode
(
´iv©eKey
);

203 
m_dq
.
	`BERDecode
(
´iv©eKey
);

204 
m_u
.
	`BERDecode
(
´iv©eKey
);

205 
´iv©eKey
.
	`Mes§geEnd
();

206 
	}
}

208 
	gInv”tibËRSAFunùiÚ
::
	$DEREncodePriv©eKey
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
) const

210 
DERSequ’ûEncod”
 
	`´iv©eKey
(
bt
);

211 
DEREncodeUnsigÃd
<
wÜd32
>(
´iv©eKey
, 0);

212 
m_n
.
	`DEREncode
(
´iv©eKey
);

213 
m_e
.
	`DEREncode
(
´iv©eKey
);

214 
m_d
.
	`DEREncode
(
´iv©eKey
);

215 
m_p
.
	`DEREncode
(
´iv©eKey
);

216 
m_q
.
	`DEREncode
(
´iv©eKey
);

217 
m_dp
.
	`DEREncode
(
´iv©eKey
);

218 
m_dq
.
	`DEREncode
(
´iv©eKey
);

219 
m_u
.
	`DEREncode
(
´iv©eKey
);

220 
´iv©eKey
.
	`Mes§geEnd
();

221 
	}
}

223 
IÁeg”
 
	gInv”tibËRSAFunùiÚ
::
	$C®cuÏ‹Inv”£
(
RªdomNumb”G’”©Ü
 &
ºg
, cÚ¡ 
IÁeg”
 &
x
) const

225 
	`DoQuickSª™yCheck
();

226 
ModuÏrAr™hm‘ic
 
	`modn
(
m_n
);

227 
IÁeg”
 
r
, 
rInv
;

229 
r
.
	`Rªdomize
(
ºg
, 
IÁeg”
::
	`OÃ
(), 
m_n
 - Integer::One());

230 
rInv
 = 
modn
.
	`MuÉliÿtiveInv”£
(
r
);

231 } 
rInv
.
	`IsZ”o
());

232 
IÁeg”
 
»
 = 
modn
.
	`ExpÚ’tŸ‹
(
r
, 
m_e
);

233 
»
 = 
modn
.
	`MuÉly
Ôe, 
x
);

236 
IÁeg”
 
y
 = 
	`ModuÏrRoÙ
(
»
, 
m_dq
, 
m_dp
, 
m_q
, 
m_p
, 
m_u
);

237 
y
 = 
modn
.
	`MuÉly
(y, 
rInv
);

238 ià(
modn
.
	`ExpÚ’tŸ‹
(
y
, 
m_e
è!ğ
x
)

239 
throw
 
	`Exû±iÚ
(
Exû±iÚ
::
OTHER_ERROR
, "InvertibleRSAFunction: computationalƒrror during…rivate key operation");

240  
y
;

241 
	}
}

243 
boŞ
 
	gInv”tibËRSAFunùiÚ
::
	$V®id©e
(
RªdomNumb”G’”©Ü
 &
ºg
, 
Ëv–
) const

245 
boŞ
 
·ss
 = 
RSAFunùiÚ
::
	`V®id©e
(
ºg
, 
Ëv–
);

246 
·ss
 =…as && 
m_p
 > 
IÁeg”
::
	`OÃ
(è&& m_p.
	`IsOdd
(è&& m_°< 
m_n
;

247 
·ss
 =…as && 
m_q
 > 
IÁeg”
::
	`OÃ
(è&& m_q.
	`IsOdd
(è&& m_q < 
m_n
;

248 
·ss
 =…as && 
m_d
 > 
IÁeg”
::
	`OÃ
(è&& m_d.
	`IsOdd
(è&& m_d < 
m_n
;

249 
·ss
 =…as && 
m_dp
 > 
IÁeg”
::
	`OÃ
(è&& m_dp.
	`IsOdd
(è&& m_d°< 
m_p
;

250 
·ss
 =…as && 
m_dq
 > 
IÁeg”
::
	`OÃ
(è&& m_dq.
	`IsOdd
(è&& m_dq < 
m_q
;

251 
·ss
 =…as && 
m_u
.
	`IsPos™ive
(è&& m_u < 
m_p
;

252 ià(
Ëv–
 >= 1)

254 
·ss
 =…as && 
m_p
 * 
m_q
 =ğ
m_n
;

255 
·ss
 =…as && 
m_e
*
m_d
 % 
	`LCM
(
m_p
-1, 
m_q
-1) == 1;

256 
·ss
 =…as && 
m_dp
 =ğ
m_d
%(
m_p
-1è&& 
m_dq
 =ğm_d%(
m_q
-1);

257 
·ss
 =…as && 
m_u
 * 
m_q
 % 
m_p
 == 1;

259 ià(
Ëv–
 >= 2)

260 
·ss
 =…as && 
	`V”ifyPrime
(
ºg
, 
m_p
, 
Ëv–
-2è&& V”ifyPrimeÔng, 
m_q
,†evel-2);

261  
·ss
;

262 
	}
}

264 
boŞ
 
	gInv”tibËRSAFunùiÚ
::
	$G‘VoidV®ue
(cÚ¡ *
Çme
, cÚ¡ 
¡d
::
ty³_šfo
 &
v®ueTy³
, *
pV®ue
) const

266  
G‘V®ueH–³r
<
RSAFunùiÚ
>(
this
, 
Çme
, 
v®ueTy³
, 
pV®ue
).
	`AssigÇbË
()

267 
	`CRYPTOPP_GET_FUNCTION_ENTRY
(
Prime1
)

268 
	`CRYPTOPP_GET_FUNCTION_ENTRY
(
Prime2
)

269 
	`CRYPTOPP_GET_FUNCTION_ENTRY
(
Priv©eExpÚ’t
)

270 
	`CRYPTOPP_GET_FUNCTION_ENTRY
(
ModPrime1Priv©eExpÚ’t
)

271 
	`CRYPTOPP_GET_FUNCTION_ENTRY
(
ModPrime2Priv©eExpÚ’t
)

272 
	`CRYPTOPP_GET_FUNCTION_ENTRY
(
MuÉliÿtiveInv”£OfPrime2ModPrime1
)

274 
	}
}

276 
	gInv”tibËRSAFunùiÚ
::
	$AssignFrom
(cÚ¡ 
NameV®uePaœs
 &
sourû
)

278 
AssignFromH–³r
<
RSAFunùiÚ
>(
this
, 
sourû
)

279 
	`CRYPTOPP_SET_FUNCTION_ENTRY
(
Prime1
)

280 
	`CRYPTOPP_SET_FUNCTION_ENTRY
(
Prime2
)

281 
	`CRYPTOPP_SET_FUNCTION_ENTRY
(
Priv©eExpÚ’t
)

282 
	`CRYPTOPP_SET_FUNCTION_ENTRY
(
ModPrime1Priv©eExpÚ’t
)

283 
	`CRYPTOPP_SET_FUNCTION_ENTRY
(
ModPrime2Priv©eExpÚ’t
)

284 
	`CRYPTOPP_SET_FUNCTION_ENTRY
(
MuÉliÿtiveInv”£OfPrime2ModPrime1
)

286 
	}
}

290 
IÁeg”
 
	gRSAFunùiÚ_ISO
::
	$AµlyFunùiÚ
(cÚ¡ 
IÁeg”
 &
x
) const

292 
IÁeg”
 
t
 = 
RSAFunùiÚ
::
	`AµlyFunùiÚ
(
x
);

293  
t
 % 16 =ğ12 ? : 
m_n
 -;

294 
	}
}

296 
IÁeg”
 
	gInv”tibËRSAFunùiÚ_ISO
::
	$C®cuÏ‹Inv”£
(
RªdomNumb”G’”©Ü
 &
ºg
, cÚ¡ 
IÁeg”
 &
x
) const

298 
IÁeg”
 
t
 = 
Inv”tibËRSAFunùiÚ
::
	`C®cuÏ‹Inv”£
(
ºg
, 
x
);

299  
	`STDMIN
(
t
, 
m_n
-t);

300 
	}
}

302 
	gNAMESPACE_END


	@rsa.h

1 #iâdeà
CRYPTOPP_RSA_H


2 
	#CRYPTOPP_RSA_H


	)

9 
	~"pubkey.h
"

10 
	~"a¢.h
"

11 
	~"pkc¥ad.h
"

12 
	~"ß•.h
"

13 
	~"em§2.h
"

15 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

18 
şass
 
CRYPTOPP_DLL
 
RSAFunùiÚ
 : 
public
 
T¿pdoÜFunùiÚ
,…ubliø
X509PublicKey


20 
RSAFunùiÚ
 
	tThisCÏss
;

22 
public
:

23 
	`In™Ÿlize
(cÚ¡ 
IÁeg”
 &
n
, cÚ¡ IÁeg” &
e
)

24 {
m_n
 = 
n
; 
m_e
 = 
e
;}

27 
OID
 
	`G‘AlgÜ™hmID
() const;

28 
	`BERDecodePublicKey
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
, 
boŞ
 
·¿m‘”sP»£Á
, 
size_t
 
size
);

29 
	`DEREncodePublicKey
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
) const;

32 
boŞ
 
	`V®id©e
(
RªdomNumb”G’”©Ü
 &
ºg
, 
Ëv–
) const;

33 
boŞ
 
	`G‘VoidV®ue
(cÚ¡ *
Çme
, cÚ¡ 
¡d
::
ty³_šfo
 &
v®ueTy³
, *
pV®ue
) const;

34 
	`AssignFrom
(cÚ¡ 
NameV®uePaœs
 &
sourû
);

37 
IÁeg”
 
	`AµlyFunùiÚ
(cÚ¡ IÁeg” &
x
) const;

38 
IÁeg”
 
	`P»imageBound
(ècÚ¡ { 
m_n
;}

39 
IÁeg”
 
	`ImageBound
(ècÚ¡ { 
m_n
;}

42 cÚ¡ 
IÁeg”
 & 
	`G‘Modulus
(ècÚ¡ { 
m_n
;}

43 cÚ¡ 
IÁeg”
 & 
	`G‘PublicExpÚ’t
(ècÚ¡ { 
m_e
;}

45 
	`S‘Modulus
(cÚ¡ 
IÁeg”
 &
n
è{
m_n
 =‚;}

46 
	`S‘PublicExpÚ’t
(cÚ¡ 
IÁeg”
 &
e
è{
m_e
 =ƒ;}

48 
´Ùeùed
:

49 
IÁeg”
 
m_n
, 
m_e
;

50 
	}
};

53 
şass
 
CRYPTOPP_DLL
 
	gInv”tibËRSAFunùiÚ
 : 
public
 
RSAFunùiÚ
,…ubliø
	gT¿pdoÜFunùiÚInv”£
,…ubliø
	gPKCS8Priv©eKey


55 
Inv”tibËRSAFunùiÚ
 
	tThisCÏss
;

57 
	gpublic
:

58 
In™Ÿlize
(
RªdomNumb”G’”©Ü
 &
ºg
, 
modulusB™s
, cÚ¡ 
IÁeg”
 &
e
 = 17);

59 
In™Ÿlize
(cÚ¡ 
IÁeg”
 &
n
, cÚ¡ IÁeg” &
e
, cÚ¡ IÁeg” &
d
, cÚ¡ IÁeg” &
p
, cÚ¡ IÁeg” &
q
, cÚ¡ IÁeg” &
dp
, cÚ¡ IÁeg” &
dq
, cÚ¡ IÁeg” &
u
)

60 {
	gm_n
 = 
n
; 
	gm_e
 = 
e
; 
	gm_d
 = 
d
; 
	gm_p
 = 
p
; 
	gm_q
 = 
q
; 
	gm_dp
 = 
dp
; 
	gm_dq
 = 
dq
; 
	gm_u
 = 
u
;}

62 
In™Ÿlize
(cÚ¡ 
IÁeg”
 &
n
, cÚ¡ IÁeg” &
e
, cÚ¡ IÁeg” &
d
);

65 
BERDecode
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
)

66 {
	gPKCS8Priv©eKey
::
BERDecode
(
bt
);}

67 
DEREncode
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
) const

68 {
	gPKCS8Priv©eKey
::
DEREncode
(
bt
);}

69 
Lßd
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
)

70 {
	gPKCS8Priv©eKey
::
BERDecode
(
bt
);}

71 
Save
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
) const

72 {
	gPKCS8Priv©eKey
::
DEREncode
(
bt
);}

73 
OID
 
G‘AlgÜ™hmID
(ècÚ¡ { 
	gRSAFunùiÚ
::GetAlgorithmID();}

74 
BERDecodePriv©eKey
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
, 
boŞ
 
·¿m‘”sP»£Á
, 
size_t
 
size
);

75 
DEREncodePriv©eKey
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
) const;

78 
IÁeg”
 
C®cuÏ‹Inv”£
(
RªdomNumb”G’”©Ü
 &
ºg
, cÚ¡ IÁeg” &
x
) const;

81 
boŞ
 
V®id©e
(
RªdomNumb”G’”©Ü
 &
ºg
, 
Ëv–
) const;

83 
G’”©eRªdom
(
RªdomNumb”G’”©Ü
 &
ºg
, cÚ¡ 
NameV®uePaœs
 &
®g
);

84 
boŞ
 
G‘VoidV®ue
(cÚ¡ *
Çme
, cÚ¡ 
¡d
::
ty³_šfo
 &
v®ueTy³
, *
pV®ue
) const;

85 
AssignFrom
(cÚ¡ 
NameV®uePaœs
 &
sourû
);

88 cÚ¡ 
	gIÁeg”
& 
G‘Prime1
(ècÚ¡ { 
	gm_p
;}

89 cÚ¡ 
	gIÁeg”
& 
G‘Prime2
(ècÚ¡ { 
	gm_q
;}

90 cÚ¡ 
	gIÁeg”
& 
G‘Priv©eExpÚ’t
(ècÚ¡ { 
	gm_d
;}

91 cÚ¡ 
	gIÁeg”
& 
G‘ModPrime1Priv©eExpÚ’t
(ècÚ¡ { 
	gm_dp
;}

92 cÚ¡ 
	gIÁeg”
& 
G‘ModPrime2Priv©eExpÚ’t
(ècÚ¡ { 
	gm_dq
;}

93 cÚ¡ 
	gIÁeg”
& 
G‘MuÉliÿtiveInv”£OfPrime2ModPrime1
(ècÚ¡ { 
	gm_u
;}

95 
S‘Prime1
(cÚ¡ 
IÁeg”
 &
p
è{
	gm_p
 =…;}

96 
S‘Prime2
(cÚ¡ 
IÁeg”
 &
q
è{
	gm_q
 = q;}

97 
S‘Priv©eExpÚ’t
(cÚ¡ 
IÁeg”
 &
d
è{
	gm_d
 = d;}

98 
S‘ModPrime1Priv©eExpÚ’t
(cÚ¡ 
IÁeg”
 &
dp
è{
	gm_dp
 = dp;}

99 
S‘ModPrime2Priv©eExpÚ’t
(cÚ¡ 
IÁeg”
 &
dq
è{
	gm_dq
 = dq;}

100 
S‘MuÉliÿtiveInv”£OfPrime2ModPrime1
(cÚ¡ 
IÁeg”
 &
u
è{
	gm_u
 = u;}

102 
	g´Ùeùed
:

103 
IÁeg”
 
m_d
, 
	gm_p
, 
	gm_q
, 
	gm_dp
, 
	gm_dq
, 
	gm_u
;

106 şas 
	cCRYPTOPP_DLL
 
	mRSAFunùiÚ_ISO
 : 
public
 
RSAFunùiÚ


108 
public
:

109 
IÁeg”
 
	$AµlyFunùiÚ
(cÚ¡ 
IÁeg”
 &
x
) const;

110 
IÁeg”
 
	$P»imageBound
(ècÚ¡ { ++(
m_n
>>1);}

111 
	}
};

113 şas 
	cCRYPTOPP_DLL
 
	mInv”tibËRSAFunùiÚ_ISO
 : 
public
 
Inv”tibËRSAFunùiÚ


115 
public
:

116 
IÁeg”
 
	$C®cuÏ‹Inv”£
(
RªdomNumb”G’”©Ü
 &
ºg
, cÚ¡ 
IÁeg”
 &
x
) const;

117 
IÁeg”
 
	$P»imageBound
(ècÚ¡ { ++(
m_n
>>1);}

118 
	}
};

121 
CRYPTOPP_DLL
 
	gRSA


123 cÚ¡ * 
CRYPTOPP_API
 
SticAlgÜ™hmName
() { "RSA";}

124 
RSAFunùiÚ
 
	tPublicKey
;

125 
Inv”tibËRSAFunùiÚ
 
	tPriv©eKey
;

129 
	g‹m¶©e
 <
şass
 
	gSTANDARD
>

130 
	gRSAES
 : 
public
 
TF_ES
<
STANDARD
, 
	gRSA
>

136 
	g‹m¶©e
 <
şass
 
	gSTANDARD
, cÏs 
	gH
>

137 
	gRSASS
 : 
public
 
TF_SS
<
STANDARD
, 
	gH
, 
	gRSA
>

141 
CRYPTOPP_DLL
 
	gRSA_ISO


143 cÚ¡ * 
CRYPTOPP_API
 
SticAlgÜ™hmName
() { "RSA-ISO";}

144 
RSAFunùiÚ_ISO
 
	tPublicKey
;

145 
Inv”tibËRSAFunùiÚ_ISO
 
	tPriv©eKey
;

148 
	g‹m¶©e
 <
şass
 
	gH
>

149 
	gRSASS_ISO
 : 
public
 
TF_SS
<
P1363_EMSA2
, 
	gH
, 
	gRSA_ISO
>

154 
	gRSAES
<
	tPKCS1v15
>::
	tDeüy±Ü
 
	tRSAES_PKCS1v15_Deüy±Ü
;

155 
	gRSAES
<
	tPKCS1v15
>::
	tEnüy±Ü
 
	tRSAES_PKCS1v15_Enüy±Ü
;

157 
	gRSAES
<
	tOAEP
<
	tSHA
> >::
	tDeüy±Ü
 
	tRSAES_OAEP_SHA_Deüy±Ü
;

158 
	gRSAES
<
	tOAEP
<
	tSHA
> >::
	tEnüy±Ü
 
	tRSAES_OAEP_SHA_Enüy±Ü
;

161 
	gRSASS
<
	tPKCS1v15
, 
	tSHA
>::
	tSigÃr
 
	tRSASSA_PKCS1v15_SHA_SigÃr
;

162 
	gRSASS
<
	tPKCS1v15
, 
	tSHA
>::
	tV”if›r
 
	tRSASSA_PKCS1v15_SHA_V”if›r
;

164 
Çme¥aû
 
	gW—k
 {

165 
	gRSASS
<
	tPKCS1v15
, 
	tW—k1
::
	tMD2
>::
	tSigÃr
 
	tRSASSA_PKCS1v15_MD2_SigÃr
;

166 
	gRSASS
<
	tPKCS1v15
, 
	tW—k1
::
	tMD2
>::
	tV”if›r
 
	tRSASSA_PKCS1v15_MD2_V”if›r
;

168 
	gRSASS
<
	tPKCS1v15
, 
	tW—k1
::
	tMD5
>::
	tSigÃr
 
	tRSASSA_PKCS1v15_MD5_SigÃr
;

169 
	gRSASS
<
	tPKCS1v15
, 
	tW—k1
::
	tMD5
>::
	tV”if›r
 
	tRSASSA_PKCS1v15_MD5_V”if›r
;

172 
	gNAMESPACE_END


	@rw.cpp

3 
	~"pch.h
"

4 
	~"rw.h
"

5 
	~"nbtheÜy.h
"

6 
	~"a¢.h
"

8 #iâdeà
CRYPTOPP_IMPORTS


10 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

12 
RWFunùiÚ
::
	$BERDecode
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
)

14 
BERSequ’ûDecod”
 
	`£q
(
bt
);

15 
m_n
.
	`BERDecode
(
£q
);

16 
£q
.
	`Mes§geEnd
();

17 
	}
}

19 
	gRWFunùiÚ
::
	$DEREncode
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
) const

21 
DERSequ’ûEncod”
 
	`£q
(
bt
);

22 
m_n
.
	`DEREncode
(
£q
);

23 
£q
.
	`Mes§geEnd
();

24 
	}
}

26 
IÁeg”
 
	gRWFunùiÚ
::
	$AµlyFunùiÚ
(cÚ¡ 
IÁeg”
 &
š
) const

28 
	`DoQuickSª™yCheck
();

30 
IÁeg”
 
out
 = 
š
.
	`Squ¬ed
()%
m_n
;

31 cÚ¡ 
wÜd
 
r
 = 12;

34 cÚ¡ 
wÜd
 
r2
 = 
r
/2;

35 cÚ¡ 
wÜd
 
r3a
 = (16 + 5 - 
r
) % 16;

36 cÚ¡ 
wÜd
 
r3b
 = (16 + 13 - 
r
) % 16;

37 cÚ¡ 
wÜd
 
r4
 = (8 + 5 - 
r
/2) % 8;

38 
out
 % 16)

40 
r
:

42 
r2
:

43 
r2
+8:

44 
out
 <<= 1;

46 
r3a
:

47 
r3b
:

48 
out
.
	`Neg©e
();

49 
out
 +ğ
m_n
;

51 
r4
:

52 
r4
+8:

53 
out
.
	`Neg©e
();

54 
out
 +ğ
m_n
;

55 
out
 <<= 1;

58 
out
 = 
IÁeg”
::
	`Z”o
();

60  
out
;

61 
	}
}

63 
boŞ
 
	gRWFunùiÚ
::
	$V®id©e
(
RªdomNumb”G’”©Ü
 &
ºg
, 
Ëv–
) const

65 
boŞ
 
·ss
 = 
Œue
;

66 
·ss
 =…as && 
m_n
 > 
IÁeg”
::
	`OÃ
() && m_n%8 == 5;

67  
·ss
;

68 
	}
}

70 
boŞ
 
	gRWFunùiÚ
::
	$G‘VoidV®ue
(cÚ¡ *
Çme
, cÚ¡ 
¡d
::
ty³_šfo
 &
v®ueTy³
, *
pV®ue
) const

72  
	`G‘V®ueH–³r
(
this
, 
Çme
, 
v®ueTy³
, 
pV®ue
).
	`AssigÇbË
()

73 
	`CRYPTOPP_GET_FUNCTION_ENTRY
(
Modulus
)

75 
	}
}

77 
	gRWFunùiÚ
::
	$AssignFrom
(cÚ¡ 
NameV®uePaœs
 &
sourû
)

79 
	`AssignFromH–³r
(
this
, 
sourû
)

80 
	`CRYPTOPP_SET_FUNCTION_ENTRY
(
Modulus
)

82 
	}
}

88 
	gInv”tibËRWFunùiÚ
::
	$G’”©eRªdom
(
RªdomNumb”G’”©Ü
 &
ºg
, cÚ¡ 
NameV®uePaœs
 &
®g
)

90 
modulusSize
 = 2048;

91 
®g
.
	`G‘IÁV®ue
("ModulusSize", 
modulusSize
) ||‡lg.GetIntValue("KeySize", modulusSize);

93 ià(
modulusSize
 < 16)

94 
throw
 
	`Inv®idArgum’t
("InvertibleRWFunction: specified modulus†ength isoo small");

96 
AlgÜ™hmP¬am‘”s
 
´imeP¬am
 = 
	`MakeP¬am‘”sFÜTwoPrimesOfEqu®Size
(
modulusSize
);

97 
m_p
.
	`G’”©eRªdom
(
ºg
, 
	`CombšedNameV®uePaœs
(
´imeP¬am
, 
	`MakeP¬am‘”s
("EquivalentTo", 3)("Mod", 8)));

98 
m_q
.
	`G’”©eRªdom
(
ºg
, 
	`CombšedNameV®uePaœs
(
´imeP¬am
, 
	`MakeP¬am‘”s
("EquivalentTo", 7)("Mod", 8)));

100 
m_n
 = 
m_p
 * 
m_q
;

101 
m_u
 = 
m_q
.
	`Inv”£Mod
(
m_p
);

102 
	}
}

104 
	gInv”tibËRWFunùiÚ
::
	$BERDecode
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
)

106 
BERSequ’ûDecod”
 
	`£q
(
bt
);

107 
m_n
.
	`BERDecode
(
£q
);

108 
m_p
.
	`BERDecode
(
£q
);

109 
m_q
.
	`BERDecode
(
£q
);

110 
m_u
.
	`BERDecode
(
£q
);

111 
£q
.
	`Mes§geEnd
();

112 
	}
}

114 
	gInv”tibËRWFunùiÚ
::
	$DEREncode
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
) const

116 
DERSequ’ûEncod”
 
	`£q
(
bt
);

117 
m_n
.
	`DEREncode
(
£q
);

118 
m_p
.
	`DEREncode
(
£q
);

119 
m_q
.
	`DEREncode
(
£q
);

120 
m_u
.
	`DEREncode
(
£q
);

121 
£q
.
	`Mes§geEnd
();

122 
	}
}

124 
IÁeg”
 
	gInv”tibËRWFunùiÚ
::
	$C®cuÏ‹Inv”£
(
RªdomNumb”G’”©Ü
 &
ºg
, cÚ¡ 
IÁeg”
 &
x
) const

126 
	`DoQuickSª™yCheck
();

127 
ModuÏrAr™hm‘ic
 
	`modn
(
m_n
);

128 
IÁeg”
 
r
, 
rInv
;

130 
r
.
	`Rªdomize
(
ºg
, 
IÁeg”
::
	`OÃ
(), 
m_n
 - Integer::One());

131 
rInv
 = 
modn
.
	`MuÉliÿtiveInv”£
(
r
);

132 } 
rInv
.
	`IsZ”o
());

133 
IÁeg”
 
»
 = 
modn
.
	`Squ¬e
(
r
);

134 
»
 = 
modn
.
	`MuÉly
Ôe, 
x
);

136 
IÁeg”
 
ı
=
»
%
m_p
, 
cq
ôe%
m_q
;

137 ià(
	`Jacobi
(
ı
, 
m_p
è* Jacobi(
cq
, 
m_q
) != 1)

139 
ı
 = cp.
	`IsOdd
(è? (ı+
m_p
) >> 1 : cp >> 1;

140 
cq
 = cq.
	`IsOdd
(è? (cq+
m_q
) >> 1 : cq >> 1;

143 #´agm¨
omp
 
·¿Î–


144 #´agm¨
omp
 
£ùiÚs


146 #´agm¨
omp
 
£ùiÚ


147 
ı
 = 
	`ModuÏrSqu¬eRoÙ
(ı, 
m_p
);

148 #´agm¨
omp
 
£ùiÚ


149 
cq
 = 
	`ModuÏrSqu¬eRoÙ
(cq, 
m_q
);

152 
IÁeg”
 
y
 = 
	`CRT
(
cq
, 
m_q
, 
ı
, 
m_p
, 
m_u
);

153 
y
 = 
modn
.
	`MuÉly
(y, 
rInv
);

154 
y
 = 
	`STDMIN
(y, 
m_n
-y);

155 ià(
	`AµlyFunùiÚ
(
y
è!ğ
x
)

156 
throw
 
	`Exû±iÚ
(
Exû±iÚ
::
OTHER_ERROR
, "InvertibleRWFunction: computationalƒrror during…rivate key operation");

157  
y
;

158 
	}
}

160 
boŞ
 
	gInv”tibËRWFunùiÚ
::
	$V®id©e
(
RªdomNumb”G’”©Ü
 &
ºg
, 
Ëv–
) const

162 
boŞ
 
·ss
 = 
RWFunùiÚ
::
	`V®id©e
(
ºg
, 
Ëv–
);

163 
·ss
 =…as && 
m_p
 > 
IÁeg”
::
	`OÃ
(è&& m_p%8 =ğ3 && m_°< 
m_n
;

164 
·ss
 =…as && 
m_q
 > 
IÁeg”
::
	`OÃ
(è&& m_q%8 =ğ7 && m_q < 
m_n
;

165 
·ss
 =…as && 
m_u
.
	`IsPos™ive
(è&& m_u < 
m_p
;

166 ià(
Ëv–
 >= 1)

168 
·ss
 =…as && 
m_p
 * 
m_q
 =ğ
m_n
;

169 
·ss
 =…as && 
m_u
 * 
m_q
 % 
m_p
 == 1;

171 ià(
Ëv–
 >= 2)

172 
·ss
 =…as && 
	`V”ifyPrime
(
ºg
, 
m_p
, 
Ëv–
-2è&& V”ifyPrimeÔng, 
m_q
,†evel-2);

173  
·ss
;

174 
	}
}

176 
boŞ
 
	gInv”tibËRWFunùiÚ
::
	$G‘VoidV®ue
(cÚ¡ *
Çme
, cÚ¡ 
¡d
::
ty³_šfo
 &
v®ueTy³
, *
pV®ue
) const

178  
G‘V®ueH–³r
<
RWFunùiÚ
>(
this
, 
Çme
, 
v®ueTy³
, 
pV®ue
).
	`AssigÇbË
()

179 
	`CRYPTOPP_GET_FUNCTION_ENTRY
(
Prime1
)

180 
	`CRYPTOPP_GET_FUNCTION_ENTRY
(
Prime2
)

181 
	`CRYPTOPP_GET_FUNCTION_ENTRY
(
MuÉliÿtiveInv”£OfPrime2ModPrime1
)

183 
	}
}

185 
	gInv”tibËRWFunùiÚ
::
	$AssignFrom
(cÚ¡ 
NameV®uePaœs
 &
sourû
)

187 
AssignFromH–³r
<
RWFunùiÚ
>(
this
, 
sourû
)

188 
	`CRYPTOPP_SET_FUNCTION_ENTRY
(
Prime1
)

189 
	`CRYPTOPP_SET_FUNCTION_ENTRY
(
Prime2
)

190 
	`CRYPTOPP_SET_FUNCTION_ENTRY
(
MuÉliÿtiveInv”£OfPrime2ModPrime1
)

192 
	}
}

194 
	gNAMESPACE_END


	@rw.h

1 #iâdeà
CRYPTOPP_RW_H


2 
	#CRYPTOPP_RW_H


	)

9 
	~"pubkey.h
"

11 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

14 
şass
 
CRYPTOPP_DLL
 
RWFunùiÚ
 : 
public
 
T¿pdoÜFunùiÚ
,…ubliø
PublicKey


16 
RWFunùiÚ
 
	tThisCÏss
;

18 
public
:

19 
	`In™Ÿlize
(cÚ¡ 
IÁeg”
 &
n
)

20 {
m_n
 = 
n
;}

22 
	`BERDecode
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
);

23 
	`DEREncode
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
) const;

25 
	`Save
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
) const

26 {
	`DEREncode
(
bt
);}

27 
	`Lßd
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
)

28 {
	`BERDecode
(
bt
);}

30 
IÁeg”
 
	`AµlyFunùiÚ
(cÚ¡ IÁeg” &
x
) const;

31 
IÁeg”
 
	`P»imageBound
(ècÚ¡ { ++(
m_n
>>1);}

32 
IÁeg”
 
	`ImageBound
(ècÚ¡ { 
m_n
;}

34 
boŞ
 
	`V®id©e
(
RªdomNumb”G’”©Ü
 &
ºg
, 
Ëv–
) const;

35 
boŞ
 
	`G‘VoidV®ue
(cÚ¡ *
Çme
, cÚ¡ 
¡d
::
ty³_šfo
 &
v®ueTy³
, *
pV®ue
) const;

36 
	`AssignFrom
(cÚ¡ 
NameV®uePaœs
 &
sourû
);

38 cÚ¡ 
IÁeg”
& 
	`G‘Modulus
(ècÚ¡ { 
m_n
;}

39 
	`S‘Modulus
(cÚ¡ 
IÁeg”
 &
n
è{
m_n
 =‚;}

41 
´Ùeùed
:

42 
IÁeg”
 
m_n
;

43 
	}
};

46 
şass
 
CRYPTOPP_DLL
 
	gInv”tibËRWFunùiÚ
 : 
public
 
RWFunùiÚ
,…ubliø
	gT¿pdoÜFunùiÚInv”£
,…ubliø
	gPriv©eKey


48 
Inv”tibËRWFunùiÚ
 
	tThisCÏss
;

50 
	gpublic
:

51 
In™Ÿlize
(cÚ¡ 
IÁeg”
 &
n
, cÚ¡ IÁeg” &
p
, cÚ¡ IÁeg” &
q
, cÚ¡ IÁeg” &
u
)

52 {
	gm_n
 = 
n
; 
	gm_p
 = 
p
; 
	gm_q
 = 
q
; 
	gm_u
 = 
u
;}

54 
In™Ÿlize
(
RªdomNumb”G’”©Ü
 &
ºg
, 
modulusB™s
)

55 {
G’”©eRªdomW™hKeySize
(
ºg
, 
modulusB™s
);}

57 
BERDecode
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
);

58 
DEREncode
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
) const;

60 
Save
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
) const

61 {
DEREncode
(
bt
);}

62 
Lßd
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
)

63 {
BERDecode
(
bt
);}

65 
IÁeg”
 
C®cuÏ‹Inv”£
(
RªdomNumb”G’”©Ü
 &
ºg
, cÚ¡ IÁeg” &
x
) const;

68 
boŞ
 
V®id©e
(
RªdomNumb”G’”©Ü
 &
ºg
, 
Ëv–
) const;

69 
boŞ
 
G‘VoidV®ue
(cÚ¡ *
Çme
, cÚ¡ 
¡d
::
ty³_šfo
 &
v®ueTy³
, *
pV®ue
) const;

70 
AssignFrom
(cÚ¡ 
NameV®uePaœs
 &
sourû
);

72 
G’”©eRªdom
(
RªdomNumb”G’”©Ü
 &
ºg
, cÚ¡ 
NameV®uePaœs
 &
®g
);

74 cÚ¡ 
	gIÁeg”
& 
G‘Prime1
(ècÚ¡ { 
	gm_p
;}

75 cÚ¡ 
	gIÁeg”
& 
G‘Prime2
(ècÚ¡ { 
	gm_q
;}

76 cÚ¡ 
	gIÁeg”
& 
G‘MuÉliÿtiveInv”£OfPrime2ModPrime1
(ècÚ¡ { 
	gm_u
;}

78 
S‘Prime1
(cÚ¡ 
IÁeg”
 &
p
è{
	gm_p
 =…;}

79 
S‘Prime2
(cÚ¡ 
IÁeg”
 &
q
è{
	gm_q
 = q;}

80 
S‘MuÉliÿtiveInv”£OfPrime2ModPrime1
(cÚ¡ 
IÁeg”
 &
u
è{
	gm_u
 = u;}

82 
	g´Ùeùed
:

83 
IÁeg”
 
m_p
, 
	gm_q
, 
	gm_u
;

87 
	sRW


89 
	m¡d
::
¡ršg
 
SticAlgÜ™hmName
() { "RW";}

90 
RWFunùiÚ
 
	tPublicKey
;

91 
Inv”tibËRWFunùiÚ
 
	tPriv©eKey
;

95 
	g‹m¶©e
 <
şass
 
	gSTANDARD
, cÏs 
	gH
>

96 
	gRWSS
 : 
public
 
TF_SS
<
STANDARD
, 
	gH
, 
	gRW
>

100 
	gNAMESPACE_END


	@safer.cpp

3 
	~"pch.h
"

4 
	~"§ãr.h
"

5 
	~"misc.h
"

6 
	~"¬gÇmes.h
"

8 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

10 cÚ¡ 
by‹
 
SAFER
::
Ba£
::
exp_b
[256] =

26 225, 102, 221, 179, 88, 105, 99, 86, 15, 161, 49, 149, 23, 7, 58, 40
	}
};

28 cÚ¡ 
by‹
 
	gSAFER
::
Ba£
::
log_b
[256] =

46 
	#EXP
(
x
è
exp_b
[(x)]

	)

47 
	#LOG
(
x
è
log_b
[(x)]

	)

48 
	#PHT
(
x
, 
y
è{ y +ğx; x +ğy; }

	)

49 
	#IPHT
(
x
, 
y
è{ x -ğy; y -ğx; }

	)

51 cÚ¡ 
	gBLOCKSIZE
 = 8;

52 cÚ¡ 
	gMAX_ROUNDS
 = 13;

54 
	gSAFER
::
Ba£
::
	$UncheckedS‘Key
(cÚ¡ 
by‹
 *
u£rkey_1
, 
Ëngth
, cÚ¡ 
NameV®uePaœs
 &
·¿ms
)

56 
boŞ
 
¡»ngth’ed
 = 
	`SŒ’gth’ed
();

57 
nof_rounds
 = 
·¿ms
.
	`G‘IÁV®ueW™hDeçuÉ
(
Name
::
	`Rounds
(), 
Ëngth
 =ğ8 ? (
¡»ngth’ed
 ? 8 : 6) : 10);

59 cÚ¡ 
by‹
 *
u£rkey_2
 = 
Ëngth
 =ğ8 ? 
u£rkey_1
 : userkey_1 + 8;

60 
keyScheduË
.
	`New
(1 + 
BLOCKSIZE
 * (1 + 2 * 
nof_rounds
));

62 
i
, 
j
;

63 
by‹
 *
key
 = 
keyScheduË
;

64 
SecBy‹Block
 
	`ka
(
BLOCKSIZE
 + 1), 
	`kb
(BLOCKSIZE + 1);

66 ià(
MAX_ROUNDS
 < 
nof_rounds
)

67 
nof_rounds
 = 
MAX_ROUNDS
;

68 *
key
++ = ()
nof_rounds
;

69 
ka
[
BLOCKSIZE
] = 0;

70 
kb
[
BLOCKSIZE
] = 0;

71 
j
 = 0; j < 
BLOCKSIZE
; j++)

73 
ka
[
BLOCKSIZE
] ^ğka[
j
] = 
	`rÙlFixed
(
u£rkey_1
[j], 5U);

74 
kb
[
BLOCKSIZE
] ^ğkb[
j
] = *
key
++ = 
u£rkey_2
[j];

77 
i
 = 1; i <ğ
nof_rounds
; i++)

79 
j
 = 0; j < 
BLOCKSIZE
 + 1; j++)

81 
ka
[
j
] = 
	`rÙlFixed
(ka[j], 6U);

82 
kb
[
j
] = 
	`rÙlFixed
(kb[j], 6U);

84 
j
 = 0; j < 
BLOCKSIZE
; j++)

85 ià(
¡»ngth’ed
)

86 *
key
++ = (
ka
[(
j
 + 2 * 
i
 - 1è% (
BLOCKSIZE
 + 1)]

87 + 
exp_b
[exp_b[18 * 
i
 + 
j
 + 1]]) & 0xFF;

89 *
key
++ = (
ka
[
j
] + 
exp_b
[exp_b[18 * 
i
 + j + 1]]) & 0xFF;

90 
j
 = 0; j < 
BLOCKSIZE
; j++)

91 ià(
¡»ngth’ed
)

92 *
key
++ = (
kb
[(
j
 + 2 * 
i
è% (
BLOCKSIZE
 + 1)]

93 + 
exp_b
[exp_b[18 * 
i
 + 
j
 + 10]]) & 0xFF;

95 *
key
++ = (
kb
[
j
] + 
exp_b
[exp_b[18 * 
i
 + j + 10]]) & 0xFF;

97 
	}
}

99 
	gBlockG‘AndPut
<
	tby‹
, 
	tBigEndŸn
> 
	tBlock
;

101 
	gSAFER
::
Enc
::
	$ProûssAndXÜBlock
(cÚ¡ 
by‹
 *
šBlock
, cÚ¡ by‹ *
xÜBlock
, by‹ *
outBlock
) const

103 
by‹
 
a
, 
b
, 
c
, 
d
, 
e
, 
f
, 
g
, 
h
, 
t
;

104 cÚ¡ 
by‹
 *
key
 = 
keyScheduË
+1;

105 
round
 = 
keyScheduË
[0];

107 
Block
::
	`G‘
(
šBlock
)(
a
)(
b
)(
c
)(
d
)(
e
)(
f
)(
g
)(
h
);

108 
round
--)

110 
a
 ^ğ
key
[0]; 
b
 +ğkey[1]; 
c
 +ğkey[2]; 
d
 ^= key[3];

111 
e
 ^ğ
key
[4]; 
f
 +ğkey[5]; 
g
 +ğkey[6]; 
h
 ^= key[7];

112 
a
 = 
	`EXP
×è+ 
key
[ 8]; 
b
 = 
	`LOG
(b) ^ key[ 9];

113 
c
 = 
	`LOG
(cè^ 
key
[10]; 
d
 = 
	`EXP
(d) + key[11];

114 
e
 = 
	`EXP
Óè+ 
key
[12]; 
f
 = 
	`LOG
(f) ^ key[13];

115 
g
 = 
	`LOG
(gè^ 
key
[14]; 
h
 = 
	`EXP
(h) + key[15];

116 
key
 += 16;

117 
	`PHT
(
a
, 
b
); PHT(
c
, 
d
); PHT(
e
, 
f
); PHT(
g
, 
h
);

118 
	`PHT
(
a
, 
c
); PHT(
e
, 
g
); PHT(
b
, 
d
); PHT(
f
, 
h
);

119 
	`PHT
(
a
, 
e
); PHT(
b
, 
f
); PHT(
c
, 
g
); PHT(
d
, 
h
);

120 
t
 = 
b
; b = 
e
;ƒ = 
c
; c =; = 
d
; d = 
f
; f = 
g
; g =;

122 
a
 ^ğ
key
[0]; 
b
 +ğkey[1]; 
c
 +ğkey[2]; 
d
 ^= key[3];

123 
e
 ^ğ
key
[4]; 
f
 +ğkey[5]; 
g
 +ğkey[6]; 
h
 ^= key[7];

124 
Block
::
	`Put
(
xÜBlock
, 
outBlock
)(
a
)(
b
)(
c
)(
d
)(
e
)(
f
)(
g
)(
h
);

125 
	}
}

127 
	gSAFER
::
Dec
::
	$ProûssAndXÜBlock
(cÚ¡ 
by‹
 *
šBlock
, cÚ¡ by‹ *
xÜBlock
, by‹ *
outBlock
) const

129 
by‹
 
a
, 
b
, 
c
, 
d
, 
e
, 
f
, 
g
, 
h
, 
t
;

130 
round
 = 
keyScheduË
[0];

131 cÚ¡ 
by‹
 *
key
 = 
keyScheduË
 + 
BLOCKSIZE
 * (1 + 2 * 
round
) - 7;

133 
Block
::
	`G‘
(
šBlock
)(
a
)(
b
)(
c
)(
d
)(
e
)(
f
)(
g
)(
h
);

134 
h
 ^ğ
key
[7]; 
g
 -ğkey[6]; 
f
 -ğkey[5]; 
e
 ^= key[4];

135 
d
 ^ğ
key
[3]; 
c
 -ğkey[2]; 
b
 -ğkey[1]; 
a
 ^= key[0];

136 
round
--)

138 
key
 -= 16;

139 
t
 = 
e
;ƒ = 
b
; b = 
c
; c =; = 
f
; f = 
d
; d = 
g
; g =;

140 
	`IPHT
(
a
, 
e
); IPHT(
b
, 
f
); IPHT(
c
, 
g
); IPHT(
d
, 
h
);

141 
	`IPHT
(
a
, 
c
); IPHT(
e
, 
g
); IPHT(
b
, 
d
); IPHT(
f
, 
h
);

142 
	`IPHT
(
a
, 
b
); IPHT(
c
, 
d
); IPHT(
e
, 
f
); IPHT(
g
, 
h
);

143 
h
 -ğ
key
[15]; 
g
 ^ğkey[14]; 
f
 ^ğkey[13]; 
e
 -= key[12];

144 
d
 -ğ
key
[11]; 
c
 ^ğkey[10]; 
b
 ^ğkey[9]; 
a
 -= key[8];

145 
h
 = 
	`LOG
(hè^ 
key
[7]; 
g
 = 
	`EXP
(g) - key[6];

146 
f
 = 
	`EXP
(fè- 
key
[5]; 
e
 = 
	`LOG
(e) ^ key[4];

147 
d
 = 
	`LOG
(dè^ 
key
[3]; 
c
 = 
	`EXP
(c) - key[2];

148 
b
 = 
	`EXP
(bè- 
key
[1]; 
a
 = 
	`LOG
(a) ^ key[0];

150 
Block
::
	`Put
(
xÜBlock
, 
outBlock
)(
a
)(
b
)(
c
)(
d
)(
e
)(
f
)(
g
)(
h
);

151 
	}
}

153 
	gNAMESPACE_END


	@safer.h

1 #iâdeà
CRYPTOPP_SAFER_H


2 
	#CRYPTOPP_SAFER_H


	)

7 
	~"£ckey.h
"

8 
	~"£cblock.h
"

10 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

13 şas 
	cSAFER


15 
public
:

16 şas 
	cCRYPTOPP_NO_VTABLE
 
Ba£
 : 
public
 
BlockCh”


18 
public
:

19 
	`O±im®D©aAlignm’t
() const { 1;}

20 
	`UncheckedS‘Key
(cÚ¡ 
by‹
 *
u£rkey
, 
Ëngth
, cÚ¡ 
NameV®uePaœs
 &
·¿ms
);

22 
´Ùeùed
:

23 
vœtu®
 
boŞ
 
	`SŒ’gth’ed
() const =0;

25 
SecBy‹Block
 
keyScheduË
;

26 cÚ¡ 
by‹
 
exp_b
[256];

27 cÚ¡ 
by‹
 
log_b
[256];

30 şas 
	cCRYPTOPP_NO_VTABLE
 
Enc
 : 
public
 
Ba£


32 
public
:

33 
	`ProûssAndXÜBlock
(cÚ¡ 
by‹
 *
šBlock
, cÚ¡ by‹ *
xÜBlock
, by‹ *
outBlock
) const;

34 
	}
};

36 şas 
	cCRYPTOPP_NO_VTABLE
 
	gDec
 : 
public
 
Ba£


38 
public
:

39 
ProûssAndXÜBlock
(cÚ¡ 
by‹
 *
šBlock
, cÚ¡ by‹ *
xÜBlock
, by‹ *
outBlock
) const;

43 
	g‹m¶©e
 <
şass
 
	gBASE
, cÏs 
	gINFO
, 
boŞ
 
	gSTR
>

44 
şass
 
CRYPTOPP_NO_VTABLE
 
	gSAFER_Im¶
 : 
public
 
BlockCh”Im¶
<
INFO
, 
	gBASE
>

46 
	g´Ùeùed
:

47 
boŞ
 
SŒ’gth’ed
(ècÚ¡ { 
STR
;}

51 
	gSAFER_K_Info
 : 
public
 
FixedBlockSize
<8>,…ubliø
	gV¬ŸbËKeyL’gth
<16, 8, 16, 8>,…ubliø
	gV¬ŸbËRounds
<10, 1, 13>

53 cÚ¡ *
SticAlgÜ™hmName
() { "SAFER-K";}

57 
şass
 
	gSAFER_K
 : 
public
 
SAFER_K_Info
,…ubliø
	gSAFER
,…ubliø
	gBlockCh”Docum’tiÚ


59 
	gpublic
:

60 
BlockCh”Fš®
<
	tENCRYPTION
, 
	tSAFER_Im¶
<
	tEnc
, 
	tSAFER_K_Info
, 
	tçl£
> > 
	tEnüy±iÚ
;

61 
	gBlockCh”Fš®
<
	tDECRYPTION
, 
	tSAFER_Im¶
<
	tDec
, 
	tSAFER_K_Info
, 
	tçl£
> > 
	tDeüy±iÚ
;

65 
	gSAFER_SK_Info
 : 
public
 
FixedBlockSize
<8>,…ubliø
	gV¬ŸbËKeyL’gth
<16, 8, 16, 8>,…ubliø
	gV¬ŸbËRounds
<10, 1, 13>

67 cÚ¡ *
SticAlgÜ™hmName
() { "SAFER-SK";}

71 
şass
 
	gSAFER_SK
 : 
public
 
SAFER_SK_Info
,…ubliø
	gSAFER
,…ubliø
	gBlockCh”Docum’tiÚ


73 
	gpublic
:

74 
BlockCh”Fš®
<
	tENCRYPTION
, 
	tSAFER_Im¶
<
	tEnc
, 
	tSAFER_SK_Info
, 
	tŒue
> > 
	tEnüy±iÚ
;

75 
	gBlockCh”Fš®
<
	tDECRYPTION
, 
	tSAFER_Im¶
<
	tDec
, 
	tSAFER_SK_Info
, 
	tŒue
> > 
	tDeüy±iÚ
;

78 
	gSAFER_K
::
	tEnüy±iÚ
 
	tSAFER_K_Enüy±iÚ
;

79 
	gSAFER_K
::
	tDeüy±iÚ
 
	tSAFER_K_Deüy±iÚ
;

81 
	gSAFER_SK
::
	tEnüy±iÚ
 
	tSAFER_SK_Enüy±iÚ
;

82 
	gSAFER_SK
::
	tDeüy±iÚ
 
	tSAFER_SK_Deüy±iÚ
;

84 
	gNAMESPACE_END


	@salsa.cpp

5 
	~"pch.h
"

7 #iâdeà
CRYPTOPP_GENERATE_X64_MASM


9 
	~"§l§.h
"

10 
	~"misc.h
"

11 
	~"¬gÇmes.h
"

12 
	~"ıu.h
"

14 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

16 
	$S®§20_Te¡In¡ªtŸtiÚs
()

18 
S®§20
::
Enüy±iÚ
 
x
;

19 
	}
}

21 
	gS®§20_PŞicy
::
	$Ch”S‘Key
(cÚ¡ 
NameV®uePaœs
 &
·¿ms
, cÚ¡ 
by‹
 *
key
, 
size_t
 
Ëngth
)

23 
m_rounds
 = 
·¿ms
.
	`G‘IÁV®ueW™hDeçuÉ
(
Name
::
	`Rounds
(), 20);

25 ià(!(
m_rounds
 == 8 || m_rounds == 12 || m_rounds == 20))

26 
throw
 
	`Inv®idRounds
(
S®§20
::
	`SticAlgÜ™hmName
(), 
m_rounds
);

29 
G‘Block
<
wÜd32
, 
L™eEndŸn
> 
	`g‘1
(
key
);

30 
	`g‘1
(
m_¡©e
[13])(m_state[10])(m_state[7])(m_state[4]);

31 
G‘Block
<
wÜd32
, 
L™eEndŸn
> 
	`g‘2
(
key
 + 
Ëngth
 - 16);

32 
	`g‘2
(
m_¡©e
[15])(m_state[12])(m_state[9])(m_state[6]);

35 
m_¡©e
[0] = 0x61707865;

36 
m_¡©e
[1] = (
Ëngth
 == 16) ? 0x3120646e : 0x3320646e;

37 
m_¡©e
[2] = (
Ëngth
 == 16) ? 0x79622d36 : 0x79622d32;

38 
m_¡©e
[3] = 0x6b206574;

39 
	}
}

41 
	gS®§20_PŞicy
::
	$Ch”ResynchrÚize
(
by‹
 *
key¡»amBufãr
, cÚ¡ by‹ *
IV
, 
size_t
 
Ëngth
)

43 
	`as£¹
(
Ëngth
==8);

44 
G‘Block
<
wÜd32
, 
L™eEndŸn
> 
	`g‘
(
IV
);

45 
	`g‘
(
m_¡©e
[14])(m_state[11]);

46 
m_¡©e
[8] = m_state[5] = 0;

47 
	}
}

49 
	gS®§20_PŞicy
::
	$S“kToI‹¿tiÚ
(
lwÜd
 
™”©iÚCouÁ
)

51 
m_¡©e
[8] = (
wÜd32
)
™”©iÚCouÁ
;

52 
m_¡©e
[5] = (
wÜd32
)
SaãRightShiá
<32>(
™”©iÚCouÁ
);

53 
	}
}

55 #ià
CRYPTOPP_BOOL_X86
 || 
CRYPTOPP_BOOL_X64


56 
	gS®§20_PŞicy
::
	$G‘Alignm’t
() const

58 #ià
CRYPTOPP_BOOL_SSE2_ASM_AVAILABLE


59 ià(
	`HasSSE2
())

63  
G‘Alignm’tOf
<
wÜd32
>();

64 
	}
}

66 
	gS®§20_PŞicy
::
	$G‘O±im®BlockSize
() const

68 #ià
CRYPTOPP_BOOL_SSE2_ASM_AVAILABLE


69 ià(
	`HasSSE2
())

70  4*
BYTES_PER_ITERATION
;

73  
BYTES_PER_ITERATION
;

74 
	}
}

77 #ifdeà
CRYPTOPP_X64_MASM_AVAILABLE


79 
S®§20_O³¿‹Key¡»am
(
by‹
 *
ouut
, cÚ¡ by‹ *
šput
, 
size_t
 
™”©iÚCouÁ
, 
rounds
, *
¡©e
);

83 #´agm¨
w¬nšg
(
di§bË
: 4731)

85 
S®§20_PŞicy
::
	$O³¿‹Key¡»am
(
Key¡»amO³¿tiÚ
 
İ”©iÚ
, 
by‹
 *
ouut
, cÚ¡ by‹ *
šput
, 
size_t
 
™”©iÚCouÁ
)

89 #ifdeà
CRYPTOPP_X64_MASM_AVAILABLE


90 
	`S®§20_O³¿‹Key¡»am
(
ouut
, 
šput
, 
™”©iÚCouÁ
, 
m_rounds
, 
m_¡©e
.
	`d©a
());

94 #ià
CRYPTOPP_BOOL_SSE2_ASM_AVAILABLE


95 #ifdeà
CRYPTOPP_GENERATE_X64_MASM


96 
ALIGN
 8

97 
S®§20_O³¿‹Key¡»am
 
PROC
 
FRAME


98 
mov
 
r10
, [
r¥
 + 5*8] ; 
¡©e


99 
	`®loc_¡ack
(10*16 + 32*16 + 8)

100 
§ve_xmm128
 
xmm6
, 0200
h


101 
§ve_xmm128
 
xmm7
, 0210
h


102 
§ve_xmm128
 
xmm8
, 0220
h


103 
§ve_xmm128
 
xmm9
, 0230
h


104 
§ve_xmm128
 
xmm10
, 0240
h


105 
§ve_xmm128
 
xmm11
, 0250
h


106 
§ve_xmm128
 
xmm12
, 0260
h


107 
§ve_xmm128
 
xmm13
, 0270
h


108 
§ve_xmm128
 
xmm14
, 0280
h


109 
§ve_xmm128
 
xmm15
, 0290
h


110 .
’d´Şog


112 
	#REG_ouut
 
rcx


	)

113 
	#REG_šput
 
rdx


	)

114 
	#REG_™”©iÚCouÁ
 
r8


	)

115 
	#REG_¡©e
 
r10


	)

116 
	#REG_rounds
 
e9d


	)

117 
	#REG_roundsLeá
 
—x


	)

118 
	#REG_‹mp32
 
r11d


	)

119 
	#REG_‹mp
 
r11


	)

120 
	#SSE2_WORKSPACE
 
r¥


	)

122 ià(
	$HasSSE2
())

124 #ià
CRYPTOPP_BOOL_X64


125 
	#REG_ouut
 %1

	)

126 
	#REG_šput
 %0

	)

127 
	#REG_™”©iÚCouÁ
 %2

	)

128 
	#REG_¡©e
 %4

	)

129 
	#REG_rounds
 %3

	)

130 
	#REG_roundsLeá
 
—x


	)

131 
	#REG_‹mp32
 
edx


	)

132 
	#REG_‹mp
 
rdx


	)

133 
	#SSE2_WORKSPACE
 %5

	)

135 
	`CRYPTOPP_ALIGN_DATA
(16è
by‹
 
wÜk¥aû
[16*32];

137 
	#REG_ouut
 
edi


	)

138 
	#REG_šput
 
—x


	)

139 
	#REG_™”©iÚCouÁ
 
ecx


	)

140 
	#REG_¡©e
 
esi


	)

141 
	#REG_rounds
 
edx


	)

142 
	#REG_roundsLeá
 
ebx


	)

143 
	#REG_‹mp32
 
ebp


	)

144 
	#REG_‹mp
 
ebp


	)

145 
	#SSE2_WORKSPACE
 
e¥
 + 
WORD_SZ


	)

148 #ifdeà
__GNUC__


149 
__asm__
 
__vŞ©e__


152 
	`AS_PUSH_IF86
Ğ
bx
)

154 *
s
 = 
m_¡©e
.
	`d©a
();

155 
wÜd32
 
r
 = 
m_rounds
;

157 
	`AS2
Ğ
mov
 
REG_™”©iÚCouÁ
, 
™”©iÚCouÁ
)

158 
	`AS2
Ğ
mov
 
REG_šput
, 
šput
)

159 
	`AS2
Ğ
mov
 
REG_ouut
, 
ouut
)

160 
	`AS2
Ğ
mov
 
REG_¡©e
, 
s
)

161 
	`AS2
Ğ
mov
 
REG_rounds
, 
r
)

165 
	`AS_PUSH_IF86
Ğ
bp
)

166 
	`AS2
Ğ
cmp
 
REG_™”©iÚCouÁ
, 4)

167 
	`ASJ
Ğ
jl
, 5, 
f
)

169 #ià
CRYPTOPP_BOOL_X86


170 
	`AS2
Ğ
mov
 
ebx
, 
e¥
)

171 
	`AS2
Ğ
ªd
 
e¥
, -16)

172 
	`AS2
Ğ
sub
 
e¥
, 32*16)

173 
	`AS1
Ğ
push
 
ebx
)

176 
	#SSE2_EXPAND_S
(
i
, 
j
) \

177 
	`ASS
Ğ
pshufd
 
xmm4
, 
xmm
##
i
, 
j
, j, j, j) \

178 
	`AS2
Ğ
movdqa
 [
SSE2_WORKSPACE
 + (
i
*4+
j
)*16 + 256], 
xmm4
)

	)

180 
	`AS2
Ğ
movdqa
 
xmm0
, [
REG_¡©e
 + 0*16])

181 
	`AS2
Ğ
movdqa
 
xmm1
, [
REG_¡©e
 + 1*16])

182 
	`AS2
Ğ
movdqa
 
xmm2
, [
REG_¡©e
 + 2*16])

183 
	`AS2
Ğ
movdqa
 
xmm3
, [
REG_¡©e
 + 3*16])

184 
	`SSE2_EXPAND_S
(0, 0)

185 
	`SSE2_EXPAND_S
(0, 1)

186 
	`SSE2_EXPAND_S
(0, 2)

187 
	`SSE2_EXPAND_S
(0, 3)

188 
	`SSE2_EXPAND_S
(1, 0)

189 
	`SSE2_EXPAND_S
(1, 2)

190 
	`SSE2_EXPAND_S
(1, 3)

191 
	`SSE2_EXPAND_S
(2, 1)

192 
	`SSE2_EXPAND_S
(2, 2)

193 
	`SSE2_EXPAND_S
(2, 3)

194 
	`SSE2_EXPAND_S
(3, 0)

195 
	`SSE2_EXPAND_S
(3, 1)

196 
	`SSE2_EXPAND_S
(3, 2)

197 
	`SSE2_EXPAND_S
(3, 3)

199 
	#SSE2_EXPAND_S85
(
i
) \

200 
	`AS2
Ğ
mov
 
dwÜd
 
±r
 [
SSE2_WORKSPACE
 + 8*16 + 
i
*4 + 256], 
REG_roundsLeá
) \

201 
	`AS2
Ğ
mov
 
dwÜd
 
±r
 [
SSE2_WORKSPACE
 + 5*16 + 
i
*4 + 256], 
REG_‹mp32
) \

202 
	`AS2
Ğ
add
 
REG_roundsLeá
, 1) \

203 
	`AS2
Ğ
adc
 
REG_‹mp32
, 0)

	)

205 
	`ASL
(1)

206 
	`AS2
Ğ
mov
 
REG_roundsLeá
, 
dwÜd
 
±r
 [
REG_¡©e
 + 8*4])

207 
	`AS2
Ğ
mov
 
REG_‹mp32
, 
dwÜd
 
±r
 [
REG_¡©e
 + 5*4])

208 
	`SSE2_EXPAND_S85
(0)

209 
	`SSE2_EXPAND_S85
(1)

210 
	`SSE2_EXPAND_S85
(2)

211 
	`SSE2_EXPAND_S85
(3)

212 
	`AS2
Ğ
mov
 
dwÜd
 
±r
 [
REG_¡©e
 + 8*4], 
REG_roundsLeá
)

213 
	`AS2
Ğ
mov
 
dwÜd
 
±r
 [
REG_¡©e
 + 5*4], 
REG_‹mp32
)

215 
	#SSE2_QUARTER_ROUND
(
a
, 
b
, 
d
, 
i
) \

216 
	`AS2
Ğ
movdqa
 
xmm4
, 
xmm
##
d
) \

217 
	`AS2
Ğ
·ddd
 
xmm4
, 
xmm
##
a
) \

218 
	`AS2
Ğ
movdqa
 
xmm5
, 
xmm4
) \

219 
	`AS2
Ğ
p¦ld
 
xmm4
, 
i
) \

220 
	`AS2
Ğ
p¤ld
 
xmm5
, 32-
i
) \

221 
	`AS2
Ğ
pxÜ
 
xmm
##
b
, 
xmm4
) \

222 
	`AS2
Ğ
pxÜ
 
xmm
##
b
, 
xmm5
)

	)

224 
	#L01
(
A
,
B
,
C
,
D
,
a
,
b
,
c
,
d
,
i
è
	`AS2
Ğ
movdqa
 
xmm
##A, [
SSE2_WORKSPACE
 + d*16 + i*256]è

	)

225 
	#L02
(
A
,
B
,
C
,
D
,
a
,
b
,
c
,
d
,
i
è
	`AS2
Ğ
movdqa
 
xmm
##C, [
SSE2_WORKSPACE
 +‡*16 + i*256]è

	)

226 
	#L03
(
A
,
B
,
C
,
D
,
a
,
b
,
c
,
d
,
i
è
	`AS2
Ğ
·ddd
 
xmm
##A, xmm##Cè

	)

227 
	#L04
(
A
,
B
,
C
,
D
,
a
,
b
,
c
,
d
,
i
è
	`AS2
Ğ
movdqa
 
xmm
##B, xmm##A)

	)

228 
	#L05
(
A
,
B
,
C
,
D
,
a
,
b
,
c
,
d
,
i
è
	`AS2
Ğ
p¦ld
 
xmm
##A, 7)

	)

229 
	#L06
(
A
,
B
,
C
,
D
,
a
,
b
,
c
,
d
,
i
è
	`AS2
Ğ
p¤ld
 
xmm
##B, 32-7)

	)

230 
	#L07
(
A
,
B
,
C
,
D
,
a
,
b
,
c
,
d
,
i
è
	`AS2
Ğ
pxÜ
 
xmm
##A, [
SSE2_WORKSPACE
 + b*16 + i*256])

	)

231 
	#L08
(
A
,
B
,
C
,
D
,
a
,
b
,
c
,
d
,
i
è
	`AS2
Ğ
pxÜ
 
xmm
##A, xmm##Bè

	)

232 
	#L09
(
A
,
B
,
C
,
D
,
a
,
b
,
c
,
d
,
i
è
	`AS2
Ğ
movdqa
 [
SSE2_WORKSPACE
 + b*16], 
xmm
##A)

	)

233 
	#L10
(
A
,
B
,
C
,
D
,
a
,
b
,
c
,
d
,
i
è
	`AS2
Ğ
movdqa
 
xmm
##B, xmm##A)

	)

234 
	#L11
(
A
,
B
,
C
,
D
,
a
,
b
,
c
,
d
,
i
è
	`AS2
Ğ
·ddd
 
xmm
##A, xmm##Cè

	)

235 
	#L12
(
A
,
B
,
C
,
D
,
a
,
b
,
c
,
d
,
i
è
	`AS2
Ğ
movdqa
 
xmm
##D, xmm##A)

	)

236 
	#L13
(
A
,
B
,
C
,
D
,
a
,
b
,
c
,
d
,
i
è
	`AS2
Ğ
p¦ld
 
xmm
##A, 9)

	)

237 
	#L14
(
A
,
B
,
C
,
D
,
a
,
b
,
c
,
d
,
i
è
	`AS2
Ğ
p¤ld
 
xmm
##D, 32-9)

	)

238 
	#L15
(
A
,
B
,
C
,
D
,
a
,
b
,
c
,
d
,
i
è
	`AS2
Ğ
pxÜ
 
xmm
##A, [
SSE2_WORKSPACE
 + c*16 + i*256])

	)

239 
	#L16
(
A
,
B
,
C
,
D
,
a
,
b
,
c
,
d
,
i
è
	`AS2
Ğ
pxÜ
 
xmm
##A, xmm##Dè

	)

240 
	#L17
(
A
,
B
,
C
,
D
,
a
,
b
,
c
,
d
,
i
è
	`AS2
Ğ
movdqa
 [
SSE2_WORKSPACE
 + c*16], 
xmm
##A)

	)

241 
	#L18
(
A
,
B
,
C
,
D
,
a
,
b
,
c
,
d
,
i
è
	`AS2
Ğ
movdqa
 
xmm
##D, xmm##A)

	)

242 
	#L19
(
A
,
B
,
C
,
D
,
a
,
b
,
c
,
d
,
i
è
	`AS2
Ğ
·ddd
 
xmm
##A, xmm##Bè

	)

243 
	#L20
(
A
,
B
,
C
,
D
,
a
,
b
,
c
,
d
,
i
è
	`AS2
Ğ
movdqa
 
xmm
##B, xmm##A)

	)

244 
	#L21
(
A
,
B
,
C
,
D
,
a
,
b
,
c
,
d
,
i
è
	`AS2
Ğ
p¦ld
 
xmm
##A, 13)

	)

245 
	#L22
(
A
,
B
,
C
,
D
,
a
,
b
,
c
,
d
,
i
è
	`AS2
Ğ
p¤ld
 
xmm
##B, 32-13)

	)

246 
	#L23
(
A
,
B
,
C
,
D
,
a
,
b
,
c
,
d
,
i
è
	`AS2
Ğ
pxÜ
 
xmm
##A, [
SSE2_WORKSPACE
 + d*16 + i*256])

	)

247 
	#L24
(
A
,
B
,
C
,
D
,
a
,
b
,
c
,
d
,
i
è
	`AS2
Ğ
pxÜ
 
xmm
##A, xmm##Bè

	)

248 
	#L25
(
A
,
B
,
C
,
D
,
a
,
b
,
c
,
d
,
i
è
	`AS2
Ğ
movdqa
 [
SSE2_WORKSPACE
 + d*16], 
xmm
##A)

	)

249 
	#L26
(
A
,
B
,
C
,
D
,
a
,
b
,
c
,
d
,
i
è
	`AS2
Ğ
·ddd
 
xmm
##A, xmm##Dè

	)

250 
	#L27
(
A
,
B
,
C
,
D
,
a
,
b
,
c
,
d
,
i
è
	`AS2
Ğ
movdqa
 
xmm
##D, xmm##A)

	)

251 
	#L28
(
A
,
B
,
C
,
D
,
a
,
b
,
c
,
d
,
i
è
	`AS2
Ğ
p¦ld
 
xmm
##A, 18)

	)

252 
	#L29
(
A
,
B
,
C
,
D
,
a
,
b
,
c
,
d
,
i
è
	`AS2
Ğ
p¤ld
 
xmm
##D, 32-18)

	)

253 
	#L30
(
A
,
B
,
C
,
D
,
a
,
b
,
c
,
d
,
i
è
	`AS2
Ğ
pxÜ
 
xmm
##A, xmm##Cè

	)

254 
	#L31
(
A
,
B
,
C
,
D
,
a
,
b
,
c
,
d
,
i
è
	`AS2
Ğ
pxÜ
 
xmm
##A, xmm##Dè

	)

255 
	#L32
(
A
,
B
,
C
,
D
,
a
,
b
,
c
,
d
,
i
è
	`AS2
Ğ
movdqa
 [
SSE2_WORKSPACE
 +‡*16], 
xmm
##A)

	)

257 
	#SSE2_QUARTER_ROUND_X8
(
i
, 
a
, 
b
, 
c
, 
d
, 
e
, 
f
, 
g
, 
h
) \

258 
	`L01
(0,1,2,3, 
a
,
b
,
c
,
d
, 
i
èL01(4,5,6,7, 
e
,
f
,
g
,
h
, i) \

259 
	`L02
(0,1,2,3, 
a
,
b
,
c
,
d
, 
i
èL02(4,5,6,7, 
e
,
f
,
g
,
h
, i) \

260 
	`L03
(0,1,2,3, 
a
,
b
,
c
,
d
, 
i
èL03(4,5,6,7, 
e
,
f
,
g
,
h
, i) \

261 
	`L04
(0,1,2,3, 
a
,
b
,
c
,
d
, 
i
èL04(4,5,6,7, 
e
,
f
,
g
,
h
, i) \

262 
	`L05
(0,1,2,3, 
a
,
b
,
c
,
d
, 
i
èL05(4,5,6,7, 
e
,
f
,
g
,
h
, i) \

263 
	`L06
(0,1,2,3, 
a
,
b
,
c
,
d
, 
i
èL06(4,5,6,7, 
e
,
f
,
g
,
h
, i) \

264 
	`L07
(0,1,2,3, 
a
,
b
,
c
,
d
, 
i
èL07(4,5,6,7, 
e
,
f
,
g
,
h
, i) \

265 
	`L08
(0,1,2,3, 
a
,
b
,
c
,
d
, 
i
èL08(4,5,6,7, 
e
,
f
,
g
,
h
, i) \

266 
	`L09
(0,1,2,3, 
a
,
b
,
c
,
d
, 
i
èL09(4,5,6,7, 
e
,
f
,
g
,
h
, i) \

267 
	`L10
(0,1,2,3, 
a
,
b
,
c
,
d
, 
i
èL10(4,5,6,7, 
e
,
f
,
g
,
h
, i) \

268 
	`L11
(0,1,2,3, 
a
,
b
,
c
,
d
, 
i
èL11(4,5,6,7, 
e
,
f
,
g
,
h
, i) \

269 
	`L12
(0,1,2,3, 
a
,
b
,
c
,
d
, 
i
èL12(4,5,6,7, 
e
,
f
,
g
,
h
, i) \

270 
	`L13
(0,1,2,3, 
a
,
b
,
c
,
d
, 
i
èL13(4,5,6,7, 
e
,
f
,
g
,
h
, i) \

271 
	`L14
(0,1,2,3, 
a
,
b
,
c
,
d
, 
i
èL14(4,5,6,7, 
e
,
f
,
g
,
h
, i) \

272 
	`L15
(0,1,2,3, 
a
,
b
,
c
,
d
, 
i
èL15(4,5,6,7, 
e
,
f
,
g
,
h
, i) \

273 
	`L16
(0,1,2,3, 
a
,
b
,
c
,
d
, 
i
èL16(4,5,6,7, 
e
,
f
,
g
,
h
, i) \

274 
	`L17
(0,1,2,3, 
a
,
b
,
c
,
d
, 
i
èL17(4,5,6,7, 
e
,
f
,
g
,
h
, i) \

275 
	`L18
(0,1,2,3, 
a
,
b
,
c
,
d
, 
i
èL18(4,5,6,7, 
e
,
f
,
g
,
h
, i) \

276 
	`L19
(0,1,2,3, 
a
,
b
,
c
,
d
, 
i
èL19(4,5,6,7, 
e
,
f
,
g
,
h
, i) \

277 
	`L20
(0,1,2,3, 
a
,
b
,
c
,
d
, 
i
èL20(4,5,6,7, 
e
,
f
,
g
,
h
, i) \

278 
	`L21
(0,1,2,3, 
a
,
b
,
c
,
d
, 
i
èL21(4,5,6,7, 
e
,
f
,
g
,
h
, i) \

279 
	`L22
(0,1,2,3, 
a
,
b
,
c
,
d
, 
i
èL22(4,5,6,7, 
e
,
f
,
g
,
h
, i) \

280 
	`L23
(0,1,2,3, 
a
,
b
,
c
,
d
, 
i
èL23(4,5,6,7, 
e
,
f
,
g
,
h
, i) \

281 
	`L24
(0,1,2,3, 
a
,
b
,
c
,
d
, 
i
èL24(4,5,6,7, 
e
,
f
,
g
,
h
, i) \

282 
	`L25
(0,1,2,3, 
a
,
b
,
c
,
d
, 
i
èL25(4,5,6,7, 
e
,
f
,
g
,
h
, i) \

283 
	`L26
(0,1,2,3, 
a
,
b
,
c
,
d
, 
i
èL26(4,5,6,7, 
e
,
f
,
g
,
h
, i) \

284 
	`L27
(0,1,2,3, 
a
,
b
,
c
,
d
, 
i
èL27(4,5,6,7, 
e
,
f
,
g
,
h
, i) \

285 
	`L28
(0,1,2,3, 
a
,
b
,
c
,
d
, 
i
èL28(4,5,6,7, 
e
,
f
,
g
,
h
, i) \

286 
	`L29
(0,1,2,3, 
a
,
b
,
c
,
d
, 
i
èL29(4,5,6,7, 
e
,
f
,
g
,
h
, i) \

287 
	`L30
(0,1,2,3, 
a
,
b
,
c
,
d
, 
i
èL30(4,5,6,7, 
e
,
f
,
g
,
h
, i) \

288 
	`L31
(0,1,2,3, 
a
,
b
,
c
,
d
, 
i
èL31(4,5,6,7, 
e
,
f
,
g
,
h
, i) \

289 
	`L32
(0,1,2,3, 
a
,
b
,
c
,
d
, 
i
èL32(4,5,6,7, 
e
,
f
,
g
,
h
, i)

	)

291 
	#SSE2_QUARTER_ROUND_X16
(
i
, 
a
, 
b
, 
c
, 
d
, 
e
, 
f
, 
g
, 
h
, 
A
, 
B
, 
C
, 
D
, 
E
, 
F
, 
G
, 
H
) \

292 
	`L01
(0,1,2,3, 
a
,
b
,
c
,
d
, 
i
èL01(4,5,6,7, 
e
,
f
,
g
,
h
, ièL01(8,9,10,11, 
A
,
B
,
C
,
D
, ièL01(12,13,14,15, 
E
,
F
,
G
,
H
, i) \

293 
	`L02
(0,1,2,3, 
a
,
b
,
c
,
d
, 
i
èL02(4,5,6,7, 
e
,
f
,
g
,
h
, ièL02(8,9,10,11, 
A
,
B
,
C
,
D
, ièL02(12,13,14,15, 
E
,
F
,
G
,
H
, i) \

294 
	`L03
(0,1,2,3, 
a
,
b
,
c
,
d
, 
i
èL03(4,5,6,7, 
e
,
f
,
g
,
h
, ièL03(8,9,10,11, 
A
,
B
,
C
,
D
, ièL03(12,13,14,15, 
E
,
F
,
G
,
H
, i) \

295 
	`L04
(0,1,2,3, 
a
,
b
,
c
,
d
, 
i
èL04(4,5,6,7, 
e
,
f
,
g
,
h
, ièL04(8,9,10,11, 
A
,
B
,
C
,
D
, ièL04(12,13,14,15, 
E
,
F
,
G
,
H
, i) \

296 
	`L05
(0,1,2,3, 
a
,
b
,
c
,
d
, 
i
èL05(4,5,6,7, 
e
,
f
,
g
,
h
, ièL05(8,9,10,11, 
A
,
B
,
C
,
D
, ièL05(12,13,14,15, 
E
,
F
,
G
,
H
, i) \

297 
	`L06
(0,1,2,3, 
a
,
b
,
c
,
d
, 
i
èL06(4,5,6,7, 
e
,
f
,
g
,
h
, ièL06(8,9,10,11, 
A
,
B
,
C
,
D
, ièL06(12,13,14,15, 
E
,
F
,
G
,
H
, i) \

298 
	`L07
(0,1,2,3, 
a
,
b
,
c
,
d
, 
i
èL07(4,5,6,7, 
e
,
f
,
g
,
h
, ièL07(8,9,10,11, 
A
,
B
,
C
,
D
, ièL07(12,13,14,15, 
E
,
F
,
G
,
H
, i) \

299 
	`L08
(0,1,2,3, 
a
,
b
,
c
,
d
, 
i
èL08(4,5,6,7, 
e
,
f
,
g
,
h
, ièL08(8,9,10,11, 
A
,
B
,
C
,
D
, ièL08(12,13,14,15, 
E
,
F
,
G
,
H
, i) \

300 
	`L09
(0,1,2,3, 
a
,
b
,
c
,
d
, 
i
èL09(4,5,6,7, 
e
,
f
,
g
,
h
, ièL09(8,9,10,11, 
A
,
B
,
C
,
D
, ièL09(12,13,14,15, 
E
,
F
,
G
,
H
, i) \

301 
	`L10
(0,1,2,3, 
a
,
b
,
c
,
d
, 
i
èL10(4,5,6,7, 
e
,
f
,
g
,
h
, ièL10(8,9,10,11, 
A
,
B
,
C
,
D
, ièL10(12,13,14,15, 
E
,
F
,
G
,
H
, i) \

302 
	`L11
(0,1,2,3, 
a
,
b
,
c
,
d
, 
i
èL11(4,5,6,7, 
e
,
f
,
g
,
h
, ièL11(8,9,10,11, 
A
,
B
,
C
,
D
, ièL11(12,13,14,15, 
E
,
F
,
G
,
H
, i) \

303 
	`L12
(0,1,2,3, 
a
,
b
,
c
,
d
, 
i
èL12(4,5,6,7, 
e
,
f
,
g
,
h
, ièL12(8,9,10,11, 
A
,
B
,
C
,
D
, ièL12(12,13,14,15, 
E
,
F
,
G
,
H
, i) \

304 
	`L13
(0,1,2,3, 
a
,
b
,
c
,
d
, 
i
èL13(4,5,6,7, 
e
,
f
,
g
,
h
, ièL13(8,9,10,11, 
A
,
B
,
C
,
D
, ièL13(12,13,14,15, 
E
,
F
,
G
,
H
, i) \

305 
	`L14
(0,1,2,3, 
a
,
b
,
c
,
d
, 
i
èL14(4,5,6,7, 
e
,
f
,
g
,
h
, ièL14(8,9,10,11, 
A
,
B
,
C
,
D
, ièL14(12,13,14,15, 
E
,
F
,
G
,
H
, i) \

306 
	`L15
(0,1,2,3, 
a
,
b
,
c
,
d
, 
i
èL15(4,5,6,7, 
e
,
f
,
g
,
h
, ièL15(8,9,10,11, 
A
,
B
,
C
,
D
, ièL15(12,13,14,15, 
E
,
F
,
G
,
H
, i) \

307 
	`L16
(0,1,2,3, 
a
,
b
,
c
,
d
, 
i
èL16(4,5,6,7, 
e
,
f
,
g
,
h
, ièL16(8,9,10,11, 
A
,
B
,
C
,
D
, ièL16(12,13,14,15, 
E
,
F
,
G
,
H
, i) \

308 
	`L17
(0,1,2,3, 
a
,
b
,
c
,
d
, 
i
èL17(4,5,6,7, 
e
,
f
,
g
,
h
, ièL17(8,9,10,11, 
A
,
B
,
C
,
D
, ièL17(12,13,14,15, 
E
,
F
,
G
,
H
, i) \

309 
	`L18
(0,1,2,3, 
a
,
b
,
c
,
d
, 
i
èL18(4,5,6,7, 
e
,
f
,
g
,
h
, ièL18(8,9,10,11, 
A
,
B
,
C
,
D
, ièL18(12,13,14,15, 
E
,
F
,
G
,
H
, i) \

310 
	`L19
(0,1,2,3, 
a
,
b
,
c
,
d
, 
i
èL19(4,5,6,7, 
e
,
f
,
g
,
h
, ièL19(8,9,10,11, 
A
,
B
,
C
,
D
, ièL19(12,13,14,15, 
E
,
F
,
G
,
H
, i) \

311 
	`L20
(0,1,2,3, 
a
,
b
,
c
,
d
, 
i
èL20(4,5,6,7, 
e
,
f
,
g
,
h
, ièL20(8,9,10,11, 
A
,
B
,
C
,
D
, ièL20(12,13,14,15, 
E
,
F
,
G
,
H
, i) \

312 
	`L21
(0,1,2,3, 
a
,
b
,
c
,
d
, 
i
èL21(4,5,6,7, 
e
,
f
,
g
,
h
, ièL21(8,9,10,11, 
A
,
B
,
C
,
D
, ièL21(12,13,14,15, 
E
,
F
,
G
,
H
, i) \

313 
	`L22
(0,1,2,3, 
a
,
b
,
c
,
d
, 
i
èL22(4,5,6,7, 
e
,
f
,
g
,
h
, ièL22(8,9,10,11, 
A
,
B
,
C
,
D
, ièL22(12,13,14,15, 
E
,
F
,
G
,
H
, i) \

314 
	`L23
(0,1,2,3, 
a
,
b
,
c
,
d
, 
i
èL23(4,5,6,7, 
e
,
f
,
g
,
h
, ièL23(8,9,10,11, 
A
,
B
,
C
,
D
, ièL23(12,13,14,15, 
E
,
F
,
G
,
H
, i) \

315 
	`L24
(0,1,2,3, 
a
,
b
,
c
,
d
, 
i
èL24(4,5,6,7, 
e
,
f
,
g
,
h
, ièL24(8,9,10,11, 
A
,
B
,
C
,
D
, ièL24(12,13,14,15, 
E
,
F
,
G
,
H
, i) \

316 
	`L25
(0,1,2,3, 
a
,
b
,
c
,
d
, 
i
èL25(4,5,6,7, 
e
,
f
,
g
,
h
, ièL25(8,9,10,11, 
A
,
B
,
C
,
D
, ièL25(12,13,14,15, 
E
,
F
,
G
,
H
, i) \

317 
	`L26
(0,1,2,3, 
a
,
b
,
c
,
d
, 
i
èL26(4,5,6,7, 
e
,
f
,
g
,
h
, ièL26(8,9,10,11, 
A
,
B
,
C
,
D
, ièL26(12,13,14,15, 
E
,
F
,
G
,
H
, i) \

318 
	`L27
(0,1,2,3, 
a
,
b
,
c
,
d
, 
i
èL27(4,5,6,7, 
e
,
f
,
g
,
h
, ièL27(8,9,10,11, 
A
,
B
,
C
,
D
, ièL27(12,13,14,15, 
E
,
F
,
G
,
H
, i) \

319 
	`L28
(0,1,2,3, 
a
,
b
,
c
,
d
, 
i
èL28(4,5,6,7, 
e
,
f
,
g
,
h
, ièL28(8,9,10,11, 
A
,
B
,
C
,
D
, ièL28(12,13,14,15, 
E
,
F
,
G
,
H
, i) \

320 
	`L29
(0,1,2,3, 
a
,
b
,
c
,
d
, 
i
èL29(4,5,6,7, 
e
,
f
,
g
,
h
, ièL29(8,9,10,11, 
A
,
B
,
C
,
D
, ièL29(12,13,14,15, 
E
,
F
,
G
,
H
, i) \

321 
	`L30
(0,1,2,3, 
a
,
b
,
c
,
d
, 
i
èL30(4,5,6,7, 
e
,
f
,
g
,
h
, ièL30(8,9,10,11, 
A
,
B
,
C
,
D
, ièL30(12,13,14,15, 
E
,
F
,
G
,
H
, i) \

322 
	`L31
(0,1,2,3, 
a
,
b
,
c
,
d
, 
i
èL31(4,5,6,7, 
e
,
f
,
g
,
h
, ièL31(8,9,10,11, 
A
,
B
,
C
,
D
, ièL31(12,13,14,15, 
E
,
F
,
G
,
H
, i) \

323 
	`L32
(0,1,2,3, 
a
,
b
,
c
,
d
, 
i
èL32(4,5,6,7, 
e
,
f
,
g
,
h
, ièL32(8,9,10,11, 
A
,
B
,
C
,
D
, ièL32(12,13,14,15, 
E
,
F
,
G
,
H
, i)

	)

325 #ià
CRYPTOPP_BOOL_X64


326 
	`SSE2_QUARTER_ROUND_X16
(1, 0, 4, 8, 12, 1, 5, 9, 13, 2, 6, 10, 14, 3, 7, 11, 15)

328 
	`SSE2_QUARTER_ROUND_X8
(1, 2, 6, 10, 14, 3, 7, 11, 15)

329 
	`SSE2_QUARTER_ROUND_X8
(1, 0, 4, 8, 12, 1, 5, 9, 13)

331 
	`AS2
Ğ
mov
 
REG_roundsLeá
, 
REG_rounds
)

332 
	`ASJ
Ğ
jmp
, 2, 
f
)

334 
	`ASL
(
SSE2_S®§_Ouut
)

335 
	`AS2
Ğ
movdqa
 
xmm0
, 
xmm4
)

336 
	`AS2
Ğ
puÅckldq
 
xmm4
, 
xmm5
)

337 
	`AS2
Ğ
movdqa
 
xmm1
, 
xmm6
)

338 
	`AS2
Ğ
puÅckldq
 
xmm6
, 
xmm7
)

339 
	`AS2
Ğ
movdqa
 
xmm2
, 
xmm4
)

340 
	`AS2
Ğ
puÅcklqdq
 
xmm4
, 
xmm6
)

341 
	`AS2
Ğ
puÅckhqdq
 
xmm2
, 
xmm6
)

342 
	`AS2
Ğ
puÅckhdq
 
xmm0
, 
xmm5
)

343 
	`AS2
Ğ
puÅckhdq
 
xmm1
, 
xmm7
)

344 
	`AS2
Ğ
movdqa
 
xmm6
, 
xmm0
)

345 
	`AS2
Ğ
puÅcklqdq
 
xmm0
, 
xmm1
)

346 
	`AS2
Ğ
puÅckhqdq
 
xmm6
, 
xmm1
)

347 
	`AS_XMM_OUTPUT4
(
SSE2_S®§_Ouut_A
, 
REG_šput
, 
REG_ouut
, 4, 2, 0, 6, 1, 0, 4, 8, 12, 1)

348 
	`AS1
Ğ
»t
)

350 
	`ASL
(6)

351 #ià
CRYPTOPP_BOOL_X64


352 
	`SSE2_QUARTER_ROUND_X16
(0, 0, 4, 8, 12, 1, 5, 9, 13, 2, 6, 10, 14, 3, 7, 11, 15)

353 
	`ASL
(2)

354 
	`SSE2_QUARTER_ROUND_X16
(0, 0, 13, 10, 7, 1, 14, 11, 4, 2, 15, 8, 5, 3, 12, 9, 6)

356 
	`SSE2_QUARTER_ROUND_X8
(0, 2, 6, 10, 14, 3, 7, 11, 15)

357 
	`SSE2_QUARTER_ROUND_X8
(0, 0, 4, 8, 12, 1, 5, 9, 13)

358 
	`ASL
(2)

359 
	`SSE2_QUARTER_ROUND_X8
(0, 2, 15, 8, 5, 3, 12, 9, 6)

360 
	`SSE2_QUARTER_ROUND_X8
(0, 0, 13, 10, 7, 1, 14, 11, 4)

362 
	`AS2
Ğ
sub
 
REG_roundsLeá
, 2)

363 
	`ASJ
Ğ
jnz
, 6, 
b
)

365 
	#SSE2_OUTPUT_4
(
a
, 
b
, 
c
, 
d
) \

366 
	`AS2
Ğ
movdqa
 
xmm4
, [
SSE2_WORKSPACE
 + 
a
*16 + 256])\

367 
	`AS2
Ğ
·ddd
 
xmm4
, [
SSE2_WORKSPACE
 + 
a
*16])\

368 
	`AS2
Ğ
movdqa
 
xmm5
, [
SSE2_WORKSPACE
 + 
b
*16 + 256])\

369 
	`AS2
Ğ
·ddd
 
xmm5
, [
SSE2_WORKSPACE
 + 
b
*16])\

370 
	`AS2
Ğ
movdqa
 
xmm6
, [
SSE2_WORKSPACE
 + 
c
*16 + 256])\

371 
	`AS2
Ğ
·ddd
 
xmm6
, [
SSE2_WORKSPACE
 + 
c
*16])\

372 
	`AS2
Ğ
movdqa
 
xmm7
, [
SSE2_WORKSPACE
 + 
d
*16 + 256])\

373 
	`AS2
Ğ
·ddd
 
xmm7
, [
SSE2_WORKSPACE
 + 
d
*16])\

374 
	`ASC
Ğ
ÿÎ
, 
SSE2_S®§_Ouut
)

	)

376 
	`SSE2_OUTPUT_4
(0, 13, 10, 7)

377 
	`SSE2_OUTPUT_4
(4, 1, 14, 11)

378 
	`SSE2_OUTPUT_4
(8, 5, 2, 15)

379 
	`SSE2_OUTPUT_4
(12, 9, 6, 3)

380 
	`AS2
Ğ
‹¡
 
REG_šput
, REG_input)

381 
	`ASJ
Ğ
jz
, 9, 
f
)

382 
	`AS2
Ğ
add
 
REG_šput
, 12*16)

383 
	`ASL
(9)

384 
	`AS2
Ğ
add
 
REG_ouut
, 12*16)

385 
	`AS2
Ğ
sub
 
REG_™”©iÚCouÁ
, 4)

386 
	`AS2
Ğ
cmp
 
REG_™”©iÚCouÁ
, 4)

387 
	`ASJ
Ğ
jge
, 1, 
b
)

388 
	`AS_POP_IF86
Ğ
¥
)

390 
	`ASL
(5)

391 
	`AS2
Ğ
sub
 
REG_™”©iÚCouÁ
, 1)

392 
	`ASJ
Ğ
jl
, 4, 
f
)

393 
	`AS2
Ğ
movdqa
 
xmm0
, [
REG_¡©e
 + 0*16])

394 
	`AS2
Ğ
movdqa
 
xmm1
, [
REG_¡©e
 + 1*16])

395 
	`AS2
Ğ
movdqa
 
xmm2
, [
REG_¡©e
 + 2*16])

396 
	`AS2
Ğ
movdqa
 
xmm3
, [
REG_¡©e
 + 3*16])

397 
	`AS2
Ğ
mov
 
REG_roundsLeá
, 
REG_rounds
)

399 
	`ASL
(0)

400 
	`SSE2_QUARTER_ROUND
(0, 1, 3, 7)

401 
	`SSE2_QUARTER_ROUND
(1, 2, 0, 9)

402 
	`SSE2_QUARTER_ROUND
(2, 3, 1, 13)

403 
	`SSE2_QUARTER_ROUND
(3, 0, 2, 18)

404 
	`ASS
Ğ
pshufd
 
xmm1
, xmm1, 2, 1, 0, 3)

405 
	`ASS
Ğ
pshufd
 
xmm2
, xmm2, 1, 0, 3, 2)

406 
	`ASS
Ğ
pshufd
 
xmm3
, xmm3, 0, 3, 2, 1)

407 
	`SSE2_QUARTER_ROUND
(0, 3, 1, 7)

408 
	`SSE2_QUARTER_ROUND
(3, 2, 0, 9)

409 
	`SSE2_QUARTER_ROUND
(2, 1, 3, 13)

410 
	`SSE2_QUARTER_ROUND
(1, 0, 2, 18)

411 
	`ASS
Ğ
pshufd
 
xmm1
, xmm1, 0, 3, 2, 1)

412 
	`ASS
Ğ
pshufd
 
xmm2
, xmm2, 1, 0, 3, 2)

413 
	`ASS
Ğ
pshufd
 
xmm3
, xmm3, 2, 1, 0, 3)

414 
	`AS2
Ğ
sub
 
REG_roundsLeá
, 2)

415 
	`ASJ
Ğ
jnz
, 0, 
b
)

417 
	`AS2
Ğ
·ddd
 
xmm0
, [
REG_¡©e
 + 0*16])

418 
	`AS2
Ğ
·ddd
 
xmm1
, [
REG_¡©e
 + 1*16])

419 
	`AS2
Ğ
·ddd
 
xmm2
, [
REG_¡©e
 + 2*16])

420 
	`AS2
Ğ
·ddd
 
xmm3
, [
REG_¡©e
 + 3*16])

422 
	`AS2
Ğ
add
 
dwÜd
 
±r
 [
REG_¡©e
 + 8*4], 1)

423 
	`AS2
Ğ
adc
 
dwÜd
 
±r
 [
REG_¡©e
 + 5*4], 0)

425 
	`AS2
Ğ
pcm³qb
 
xmm6
, xmm6)

426 
	`AS2
Ğ
p¤lq
 
xmm6
, 32)

427 
	`ASS
Ğ
pshufd
 
xmm7
, 
xmm6
, 0, 1, 2, 3)

428 
	`AS2
Ğ
movdqa
 
xmm4
, 
xmm0
)

429 
	`AS2
Ğ
movdqa
 
xmm5
, 
xmm3
)

430 
	`AS2
Ğ
·nd
 
xmm0
, 
xmm7
)

431 
	`AS2
Ğ
·nd
 
xmm4
, 
xmm6
)

432 
	`AS2
Ğ
·nd
 
xmm3
, 
xmm6
)

433 
	`AS2
Ğ
·nd
 
xmm5
, 
xmm7
)

434 
	`AS2
Ğ
pÜ
 
xmm4
, 
xmm5
)

435 
	`AS2
Ğ
movdqa
 
xmm5
, 
xmm1
)

436 
	`AS2
Ğ
·nd
 
xmm1
, 
xmm7
)

437 
	`AS2
Ğ
·nd
 
xmm5
, 
xmm6
)

438 
	`AS2
Ğ
pÜ
 
xmm0
, 
xmm5
)

439 
	`AS2
Ğ
·nd
 
xmm6
, 
xmm2
)

440 
	`AS2
Ğ
·nd
 
xmm2
, 
xmm7
)

441 
	`AS2
Ğ
pÜ
 
xmm1
, 
xmm6
)

442 
	`AS2
Ğ
pÜ
 
xmm2
, 
xmm3
)

444 
	`AS2
Ğ
movdqa
 
xmm5
, 
xmm4
)

445 
	`AS2
Ğ
movdqa
 
xmm6
, 
xmm0
)

446 
	`AS3
Ğ
shuåd
 
xmm4
, 
xmm1
, 2)

447 
	`AS3
Ğ
shuåd
 
xmm0
, 
xmm2
, 2)

448 
	`AS3
Ğ
shuåd
 
xmm1
, 
xmm5
, 2)

449 
	`AS3
Ğ
shuåd
 
xmm2
, 
xmm6
, 2)

452 
	`AS_XMM_OUTPUT4
(
SSE2_S®§_Ouut_B
, 
REG_šput
, 
REG_ouut
, 4, 0, 1, 2, 3, 0, 1, 2, 3, 4)

453 
	`ASJ
Ğ
jmp
, 5, 
b
)

454 
	`ASL
(4)

456 
	`AS_POP_IF86
Ğ
bp
)

457 #ifdeà
__GNUC__


458 
	`AS_POP_IF86
Ğ
bx
)

460 #ià
CRYPTOPP_BOOL_X64


461 : "+r" (
šput
), "+r" (
ouut
), "+r" (
™”©iÚCouÁ
)

462 : "r" (
m_rounds
), "r" (
m_¡©e
.
m_±r
), "r" (
wÜk¥aû
)

465 : "+a" (
šput
), "+D" (
ouut
), "+c" (
™”©iÚCouÁ
)

466 : "d" (
m_rounds
), "S" (
m_¡©e
.
m_±r
)

471 #ifdeà
CRYPTOPP_GENERATE_X64_MASM


472 
movdqa
 
xmm6
, [
r¥
 + 0200
h
]

473 
movdqa
 
xmm7
, [
r¥
 + 0210
h
]

474 
movdqa
 
xmm8
, [
r¥
 + 0220
h
]

475 
movdqa
 
xmm9
, [
r¥
 + 0230
h
]

476 
movdqa
 
xmm10
, [
r¥
 + 0240
h
]

477 
movdqa
 
xmm11
, [
r¥
 + 0250
h
]

478 
movdqa
 
xmm12
, [
r¥
 + 0260
h
]

479 
movdqa
 
xmm13
, [
r¥
 + 0270
h
]

480 
movdqa
 
xmm14
, [
r¥
 + 0280
h
]

481 
movdqa
 
xmm15
, [
r¥
 + 0290
h
]

482 
add
 
r¥
, 10*16 + 32*16 + 8

483 
»t


484 
S®§20_O³¿‹Key¡»am
 
ENDP


486 
	}
}

490 #iâdeà
CRYPTOPP_GENERATE_X64_MASM


492 
wÜd32
 
	gx0
, 
	gx1
, 
	gx2
, 
	gx3
, 
	gx4
, 
	gx5
, 
	gx6
, 
	gx7
, 
	gx8
, 
	gx9
, 
	gx10
, 
	gx11
, 
	gx12
, 
	gx13
, 
	gx14
, 
	gx15
;

494 
	g™”©iÚCouÁ
--)

496 
	gx0
 = 
m_¡©e
[0]; 
	gx1
 = m_¡©e[1]; 
	gx2
 = m_¡©e[2]; 
	gx3
 = m_state[3];

497 
	gx4
 = 
m_¡©e
[4]; 
	gx5
 = m_¡©e[5]; 
	gx6
 = m_¡©e[6]; 
	gx7
 = m_state[7];

498 
	gx8
 = 
m_¡©e
[8]; 
	gx9
 = m_¡©e[9]; 
	gx10
 = m_¡©e[10]; 
	gx11
 = m_state[11];

499 
	gx12
 = 
m_¡©e
[12]; 
	gx13
 = m_¡©e[13]; 
	gx14
 = m_¡©e[14]; 
	gx15
 = m_state[15];

501 
	gi
=
m_rounds
; i>0; i-=2)

503 
	#QUARTER_ROUND
(
a
, 
b
, 
c
, 
d
) \

504 
b
 = b ^ 
	`rÙlFixed
(
a
 + 
d
, 7); \

505 
c
 = c ^ 
	`rÙlFixed
(
b
 + 
a
, 9); \

506 
d
 = d ^ 
	`rÙlFixed
(
c
 + 
b
, 13); \

507 
a
 =‡ ^ 
	`rÙlFixed
(
d
 + 
c
, 18);

	)

509 
QUARTER_ROUND
(
x0
, 
x4
, 
x8
, 
x12
)

510 
QUARTER_ROUND
(
x1
, 
x5
, 
x9
, 
x13
)

511 
QUARTER_ROUND
(
x2
, 
x6
, 
x10
, 
x14
)

512 
QUARTER_ROUND
(
x3
, 
x7
, 
x11
, 
x15
)

514 
QUARTER_ROUND
(
x0
, 
x13
, 
x10
, 
x7
)

515 
QUARTER_ROUND
(
x1
, 
x14
, 
x11
, 
x4
)

516 
QUARTER_ROUND
(
x2
, 
x15
, 
x8
, 
x5
)

517 
QUARTER_ROUND
(
x3
, 
x12
, 
x9
, 
x6
)

520 
	#SALSA_OUTPUT
(
x
) {\

521 
	`CRYPTOPP_KEYSTREAM_OUTPUT_WORD
(
x
, 
LITTLE_ENDIAN_ORDER
, 0, 
x0
 + 
m_¡©e
[0]);\

522 
	`CRYPTOPP_KEYSTREAM_OUTPUT_WORD
(
x
, 
LITTLE_ENDIAN_ORDER
, 1, 
x13
 + 
m_¡©e
[13]);\

523 
	`CRYPTOPP_KEYSTREAM_OUTPUT_WORD
(
x
, 
LITTLE_ENDIAN_ORDER
, 2, 
x10
 + 
m_¡©e
[10]);\

524 
	`CRYPTOPP_KEYSTREAM_OUTPUT_WORD
(
x
, 
LITTLE_ENDIAN_ORDER
, 3, 
x7
 + 
m_¡©e
[7]);\

525 
	`CRYPTOPP_KEYSTREAM_OUTPUT_WORD
(
x
, 
LITTLE_ENDIAN_ORDER
, 4, 
x4
 + 
m_¡©e
[4]);\

526 
	`CRYPTOPP_KEYSTREAM_OUTPUT_WORD
(
x
, 
LITTLE_ENDIAN_ORDER
, 5, 
x1
 + 
m_¡©e
[1]);\

527 
	`CRYPTOPP_KEYSTREAM_OUTPUT_WORD
(
x
, 
LITTLE_ENDIAN_ORDER
, 6, 
x14
 + 
m_¡©e
[14]);\

528 
	`CRYPTOPP_KEYSTREAM_OUTPUT_WORD
(
x
, 
LITTLE_ENDIAN_ORDER
, 7, 
x11
 + 
m_¡©e
[11]);\

529 
	`CRYPTOPP_KEYSTREAM_OUTPUT_WORD
(
x
, 
LITTLE_ENDIAN_ORDER
, 8, 
x8
 + 
m_¡©e
[8]);\

530 
	`CRYPTOPP_KEYSTREAM_OUTPUT_WORD
(
x
, 
LITTLE_ENDIAN_ORDER
, 9, 
x5
 + 
m_¡©e
[5]);\

531 
	`CRYPTOPP_KEYSTREAM_OUTPUT_WORD
(
x
, 
LITTLE_ENDIAN_ORDER
, 10, 
x2
 + 
m_¡©e
[2]);\

532 
	`CRYPTOPP_KEYSTREAM_OUTPUT_WORD
(
x
, 
LITTLE_ENDIAN_ORDER
, 11, 
x15
 + 
m_¡©e
[15]);\

533 
	`CRYPTOPP_KEYSTREAM_OUTPUT_WORD
(
x
, 
LITTLE_ENDIAN_ORDER
, 12, 
x12
 + 
m_¡©e
[12]);\

534 
	`CRYPTOPP_KEYSTREAM_OUTPUT_WORD
(
x
, 
LITTLE_ENDIAN_ORDER
, 13, 
x9
 + 
m_¡©e
[9]);\

535 
	`CRYPTOPP_KEYSTREAM_OUTPUT_WORD
(
x
, 
LITTLE_ENDIAN_ORDER
, 14, 
x6
 + 
m_¡©e
[6]);\

536 
	`CRYPTOPP_KEYSTREAM_OUTPUT_WORD
(
x
, 
LITTLE_ENDIAN_ORDER
, 15, 
x3
 + 
m_¡©e
[3]);}

	)

538 #iâdeà
CRYPTOPP_DOXYGEN_PROCESSING


539 
CRYPTOPP_KEYSTREAM_OUTPUT_SWITCH
(
SALSA_OUTPUT
, 
BYTES_PER_ITERATION
);

542 ià(++
	gm_¡©e
[8] == 0)

543 ++
m_¡©e
[5];

548 
	gXS®§20_PŞicy
::
	$Ch”S‘Key
(cÚ¡ 
NameV®uePaœs
 &
·¿ms
, cÚ¡ 
by‹
 *
key
, 
size_t
 
Ëngth
)

550 
m_rounds
 = 
·¿ms
.
	`G‘IÁV®ueW™hDeçuÉ
(
Name
::
	`Rounds
(), 20);

552 ià(!(
m_rounds
 == 8 || m_rounds == 12 || m_rounds == 20))

553 
throw
 
	`Inv®idRounds
(
XS®§20
::
	`SticAlgÜ™hmName
(), 
m_rounds
);

555 
	`G‘U£rKey
(
LITTLE_ENDIAN_ORDER
, 
m_key
.
	`begš
(), m_key.
	`size
(), 
key
, 
Ëngth
);

556 ià(
Ëngth
 == 16)

557 
	`memıy
(
m_key
.
	`begš
()+4, m_key.begin(), 16);

560 
m_¡©e
[0] = 0x61707865;

561 
m_¡©e
[1] = 0x3320646e;

562 
m_¡©e
[2] = 0x79622d32;

563 
m_¡©e
[3] = 0x6b206574;

564 
	}
}

566 
	gXS®§20_PŞicy
::
	$Ch”ResynchrÚize
(
by‹
 *
key¡»amBufãr
, cÚ¡ by‹ *
IV
, 
size_t
 
Ëngth
)

568 
	`as£¹
(
Ëngth
==24);

570 
wÜd32
 
x0
, 
x1
, 
x2
, 
x3
, 
x4
, 
x5
, 
x6
, 
x7
, 
x8
, 
x9
, 
x10
, 
x11
, 
x12
, 
x13
, 
x14
, 
x15
;

572 
G‘Block
<
wÜd32
, 
L™eEndŸn
> 
	`g‘
(
IV
);

573 
	`g‘
(
x14
)(
x11
)(
x8
)(
x5
)(
m_¡©e
[14])(m_state[11]);

575 
x13
 = 
m_key
[0]; 
x10
 = m_key[1]; 
x7
 = m_key[2]; 
x4
 = m_key[3];

576 
x15
 = 
m_key
[4]; 
x12
 = m_key[5]; 
x9
 = m_key[6]; 
x6
 = m_key[7];

577 
x0
 = 
m_¡©e
[0]; 
x1
 = m_¡©e[1]; 
x2
 = m_¡©e[2]; 
x3
 = m_state[3];

579 
i
=
m_rounds
; i>0; i-=2)

581 
	`QUARTER_ROUND
(
x0
, 
x4
, 
x8
, 
x12
)

582 
	`QUARTER_ROUND
(
x1
, 
x5
, 
x9
, 
x13
)

583 
	`QUARTER_ROUND
(
x2
, 
x6
, 
x10
, 
x14
)

584 
	`QUARTER_ROUND
(
x3
, 
x7
, 
x11
, 
x15
)

586 
	`QUARTER_ROUND
(
x0
, 
x13
, 
x10
, 
x7
)

587 
	`QUARTER_ROUND
(
x1
, 
x14
, 
x11
, 
x4
)

588 
	`QUARTER_ROUND
(
x2
, 
x15
, 
x8
, 
x5
)

589 
	`QUARTER_ROUND
(
x3
, 
x12
, 
x9
, 
x6
)

592 
m_¡©e
[13] = 
x0
; m_¡©e[10] = 
x1
; m_¡©e[7] = 
x2
; m_¡©e[4] = 
x3
;

593 
m_¡©e
[15] = 
x14
; m_¡©e[12] = 
x11
; m_¡©e[9] = 
x8
; m_¡©e[6] = 
x5
;

594 
m_¡©e
[8] = m_state[5] = 0;

595 
	}
}

597 
	gNAMESPACE_END


	@salsa.h

3 #iâdeà
CRYPTOPP_SALSA_H


4 
	#CRYPTOPP_SALSA_H


	)

6 
	~"¡rchr.h
"

8 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

11 
S®§20_Info
 : 
public
 
V¬ŸbËKeyL’gth
<32, 16, 32, 16, 
Sim¶eKeyšgIÁ”çû
::
UNIQUE_IV
, 8>

13 cÚ¡ *
	`SticAlgÜ™hmName
() { "Salsa20";}

14 
	}
};

16 
şass
 
CRYPTOPP_NO_VTABLE
 
	gS®§20_PŞicy
 : 
public
 
Add™iveCh”CÚü‘ePŞicy
<
wÜd32
, 16>

18 
	g´Ùeùed
:

19 
Ch”S‘Key
(cÚ¡ 
NameV®uePaœs
 &
·¿ms
, cÚ¡ 
by‹
 *
key
, 
size_t
 
Ëngth
);

20 
O³¿‹Key¡»am
(
Key¡»amO³¿tiÚ
 
İ”©iÚ
, 
by‹
 *
ouut
, cÚ¡ by‹ *
šput
, 
size_t
 
™”©iÚCouÁ
);

21 
Ch”ResynchrÚize
(
by‹
 *
key¡»amBufãr
, cÚ¡ by‹ *
IV
, 
size_t
 
Ëngth
);

22 
boŞ
 
Ch”IsRªdomAcûss
(ècÚ¡ { 
	gŒue
;}

23 
S“kToI‹¿tiÚ
(
lwÜd
 
™”©iÚCouÁ
);

24 #ià
CRYPTOPP_BOOL_X86
 || 
CRYPTOPP_BOOL_X64


25 
G‘Alignm’t
() const;

26 
G‘O±im®BlockSize
() const;

29 
	gFixedSizeAligÃdSecBlock
<
	gwÜd32
, 16> 
	gm_¡©e
;

30 
	gm_rounds
;

34 
	gS®§20
 : 
public
 
S®§20_Info
,…ubliø
	gSymm‘ricCh”Docum’tiÚ


36 
	gSymm‘ricCh”Fš®
<
	tCÚü‘ePŞicyHŞd”
<
	tS®§20_PŞicy
, 
	tAdd™iveCh”Tem¶©e
<> >, 
	tS®§20_Info
> 
	tEnüy±iÚ
;

37 
Enüy±iÚ
 
	tDeüy±iÚ
;

41 
	gXS®§20_Info
 : 
public
 
FixedKeyL’gth
<32, 
	gSim¶eKeyšgIÁ”çû
::
UNIQUE_IV
, 24>

43 cÚ¡ *
SticAlgÜ™hmName
() { "XSalsa20";}

46 şas 
	cCRYPTOPP_NO_VTABLE
 
	mXS®§20_PŞicy
 : 
public
 
S®§20_PŞicy


48 
public
:

49 
Ch”S‘Key
(cÚ¡ 
NameV®uePaœs
 &
·¿ms
, cÚ¡ 
by‹
 *
key
, 
size_t
 
Ëngth
);

50 
Ch”ResynchrÚize
(
by‹
 *
key¡»amBufãr
, cÚ¡ by‹ *
IV
, 
size_t
 
Ëngth
);

52 
	m´Ùeùed
:

53 
FixedSizeSecBlock
<
wÜd32
, 8> 
	mm_key
;

57 
	gXS®§20
 : 
public
 
XS®§20_Info
,…ubliø
	gSymm‘ricCh”Docum’tiÚ


59 
	gSymm‘ricCh”Fš®
<
	tCÚü‘ePŞicyHŞd”
<
	tXS®§20_PŞicy
, 
	tAdd™iveCh”Tem¶©e
<> >, 
	tXS®§20_Info
> 
	tEnüy±iÚ
;

60 
Enüy±iÚ
 
	tDeüy±iÚ
;

63 
	gNAMESPACE_END


	@seal.cpp

4 
	~"pch.h
"

6 
	~"£®.h
"

7 
	~"sha.h
"

8 
	~"misc.h
"

10 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

12 
	$SEAL_Te¡In¡ªtŸtiÚs
()

14 
SEAL
<>::
Enüy±iÚ
 
x
;

15 
	}
}

17 
	sSEAL_Gamma


19 
SEAL_Gamma
(cÚ¡ 
by‹
 *
key
)

20 : 
H
(5), 
Z
(5), 
D
(16), 
Ï¡Index
(0xffffffff)

22 
G‘U£rKey
(
BIG_ENDIAN_ORDER
, 
H
.
begš
(), 5, 
key
, 20);

23 
mem£t
(
D
, 0, 64);

26 
wÜd32
 
Aµly
(wÜd32 
i
);

28 
	mSecBlock
<
	mwÜd32
> 
	mH
, 
	mZ
, 
	mD
;

29 
wÜd32
 
	mÏ¡Index
;

32 
wÜd32
 
	gSEAL_Gamma
::
	$Aµly
(
wÜd32
 
i
)

34 
wÜd32
 
shaIndex
 = 
i
/5;

35 ià(
shaIndex
 !ğ
Ï¡Index
)

37 
	`memıy
(
Z
, 
H
, 20);

38 
D
[0] = 
shaIndex
;

39 
SHA
::
	`T¿nsfÜm
(
Z
, 
D
);

40 
Ï¡Index
 = 
shaIndex
;

42  
Z
[
i
%5];

43 
	}
}

45 
	g‹m¶©e
 <
şass
 
	gB
>

46 
	gSEAL_PŞicy
<
	gB
>::
	$Ch”S‘Key
(cÚ¡ 
NameV®uePaœs
 &
·¿ms
, cÚ¡ 
by‹
 *
key
, 
size_t
 
Ëngth
)

48 
m_šsideCouÁ”
 = 
m_outsideCouÁ”
 = 
m_¡¬tCouÁ
 = 0;

50 
L
 = 
·¿ms
.
	`G‘IÁV®ueW™hDeçuÉ
("NumberOfOutputBitsPerPositionIndex", 32*1024);

51 
m_™”©iÚsP”CouÁ
 = 
L
 / 8192;

53 
SEAL_Gamma
 
	`gamma
(
key
);

54 
i
;

56 
i
=0; i<512; i++)

57 
m_T
[
i
] = 
gamma
.
	`Aµly
(i);

59 
i
=0; i<256; i++)

60 
m_S
[
i
] = 
gamma
.
	`Aµly
(0x1000+i);

62 
m_R
.
	`New
(4*(
L
/8192));

64 
i
=0; i<
m_R
.
	`size
(); i++)

65 
m_R
[
i
] = 
gamma
.
	`Aµly
(0x2000+i);

66 
	}
}

68 
	g‹m¶©e
 <
şass
 
	gB
>

69 
	gSEAL_PŞicy
<
	gB
>::
	$Ch”ResynchrÚize
(
by‹
 *
key¡»amBufãr
, cÚ¡ by‹ *
IV
, 
size_t
 
Ëngth
)

71 
	`as£¹
(
Ëngth
==4);

72 
m_outsideCouÁ”
 = 
IV
 ? 
G‘WÜd
<
wÜd32
>(
çl£
, 
BIG_ENDIAN_ORDER
, IV) : 0;

73 
m_¡¬tCouÁ
 = 
m_outsideCouÁ”
;

74 
m_šsideCouÁ”
 = 0;

75 
	}
}

77 
	g‹m¶©e
 <
şass
 
	gB
>

78 
	gSEAL_PŞicy
<
	gB
>::
	$S“kToI‹¿tiÚ
(
lwÜd
 
™”©iÚCouÁ
)

80 
m_outsideCouÁ”
 = 
m_¡¬tCouÁ
 + ()(
™”©iÚCouÁ
 / 
m_™”©iÚsP”CouÁ
);

81 
m_šsideCouÁ”
 = ()(
™”©iÚCouÁ
 % 
m_™”©iÚsP”CouÁ
);

82 
	}
}

84 
	g‹m¶©e
 <
şass
 
	gB
>

85 
	gSEAL_PŞicy
<
	gB
>::
	$O³¿‹Key¡»am
(
Key¡»amO³¿tiÚ
 
İ”©iÚ
, 
by‹
 *
ouut
, cÚ¡ by‹ *
šput
, 
size_t
 
™”©iÚCouÁ
)

87 
wÜd32
 
a
, 
b
, 
c
, 
d
, 
n1
, 
n2
, 
n3
, 
n4
;

88 
p
, 
q
;

90 
size_t
 
™”©iÚ
 = 0; i‹¿tiÚ < 
™”©iÚCouÁ
; ++iteration)

92 
	#Tb
(
x
è*(
wÜd32
 *)((
by‹
 *)
m_T
.
	`begš
()+x)

	)

94 
a
 = 
m_outsideCouÁ”
 ^ 
m_R
[4*
m_šsideCouÁ”
];

95 
b
 = 
	`rÙrFixed
(
m_outsideCouÁ”
, 8Uè^ 
m_R
[4*
m_šsideCouÁ”
+1];

96 
c
 = 
	`rÙrFixed
(
m_outsideCouÁ”
, 16Uè^ 
m_R
[4*
m_šsideCouÁ”
+2];

97 
d
 = 
	`rÙrFixed
(
m_outsideCouÁ”
, 24Uè^ 
m_R
[4*
m_šsideCouÁ”
+3];

99 
j
=0; j<2; j++)

101 
p
 = 
a
 & 0x7fc;

102 
b
 +ğ
	`Tb
(
p
);

103 
a
 = 
	`rÙrFixed
(a, 9U);

105 
p
 = 
b
 & 0x7fc;

106 
c
 +ğ
	`Tb
(
p
);

107 
b
 = 
	`rÙrFixed
(b, 9U);

109 
p
 = 
c
 & 0x7fc;

110 
d
 +ğ
	`Tb
(
p
);

111 
c
 = 
	`rÙrFixed
(c, 9U);

113 
p
 = 
d
 & 0x7fc;

114 
a
 +ğ
	`Tb
(
p
);

115 
d
 = 
	`rÙrFixed
(d, 9U);

118 
n1
 = 
d
, 
n2
 = 
b
, 
n3
 = 
a
, 
n4
 = 
c
;

120 
p
 = 
a
 & 0x7fc;

121 
b
 +ğ
	`Tb
(
p
);

122 
a
 = 
	`rÙrFixed
(a, 9U);

124 
p
 = 
b
 & 0x7fc;

125 
c
 +ğ
	`Tb
(
p
);

126 
b
 = 
	`rÙrFixed
(b, 9U);

128 
p
 = 
c
 & 0x7fc;

129 
d
 +ğ
	`Tb
(
p
);

130 
c
 = 
	`rÙrFixed
(c, 9U);

132 
p
 = 
d
 & 0x7fc;

133 
a
 +ğ
	`Tb
(
p
);

134 
d
 = 
	`rÙrFixed
(d, 9U);

137 
i
=0; i<64; i++)

139 
p
 = 
a
 & 0x7fc;

140 
a
 = 
	`rÙrFixed
(a, 9U);

141 
b
 +ğ
	`Tb
(
p
);

142 
b
 ^ğ
a
;

144 
q
 = 
b
 & 0x7fc;

145 
b
 = 
	`rÙrFixed
(b, 9U);

146 
c
 ^ğ
	`Tb
(
q
);

147 
c
 +ğ
b
;

149 
p
 = (p+
c
) & 0x7fc;

150 
c
 = 
	`rÙrFixed
(c, 9U);

151 
d
 +ğ
	`Tb
(
p
);

152 
d
 ^ğ
c
;

154 
q
 = (q+
d
) & 0x7fc;

155 
d
 = 
	`rÙrFixed
(d, 9U);

156 
a
 ^ğ
	`Tb
(
q
);

157 
a
 +ğ
d
;

159 
p
 = (p+
a
) & 0x7fc;

160 
b
 ^ğ
	`Tb
(
p
);

161 
a
 = 
	`rÙrFixed
(a, 9U);

163 
q
 = (q+
b
) & 0x7fc;

164 
c
 +ğ
	`Tb
(
q
);

165 
b
 = 
	`rÙrFixed
(b, 9U);

167 
p
 = (p+
c
) & 0x7fc;

168 
d
 ^ğ
	`Tb
(
p
);

169 
c
 = 
	`rÙrFixed
(c, 9U);

171 
q
 = (q+
d
) & 0x7fc;

172 
d
 = 
	`rÙrFixed
(d, 9U);

173 
a
 +ğ
	`Tb
(
q
);

175 
	#SEAL_OUTPUT
(
x
) \

176 
	`CRYPTOPP_KEYSTREAM_OUTPUT_WORD
(
x
, 
B
::
	`ToEnum
(), 0, 
b
 + 
m_S
[4*
i
+0]);\

177 
	`CRYPTOPP_KEYSTREAM_OUTPUT_WORD
(
x
, 
B
::
	`ToEnum
(), 1, 
c
 ^ 
m_S
[4*
i
+1]);\

178 
	`CRYPTOPP_KEYSTREAM_OUTPUT_WORD
(
x
, 
B
::
	`ToEnum
(), 2, 
d
 + 
m_S
[4*
i
+2]);\

179 
	`CRYPTOPP_KEYSTREAM_OUTPUT_WORD
(
x
, 
B
::
	`ToEnum
(), 3, 
a
 ^ 
m_S
[4*
i
+3]);

	)

181 
	`CRYPTOPP_KEYSTREAM_OUTPUT_SWITCH
(
SEAL_OUTPUT
, 4*4);

183 ià(
i
 & 1)

185 
a
 +ğ
n3
;

186 
b
 +ğ
n4
;

187 
c
 ^ğ
n3
;

188 
d
 ^ğ
n4
;

192 
a
 +ğ
n1
;

193 
b
 +ğ
n2
;

194 
c
 ^ğ
n1
;

195 
d
 ^ğ
n2
;

199 ià(++
m_šsideCouÁ”
 =ğ
m_™”©iÚsP”CouÁ
)

201 ++
m_outsideCouÁ”
;

202 
m_šsideCouÁ”
 = 0;

206 
a
 = 
b
 = 
c
 = 
d
 = 
n1
 = 
n2
 = 
n3
 = 
n4
 = 0;

207 
p
 = 
q
 = 0;

208 
	}
}

210 
‹m¶©e
 
şass
 
	gSEAL_PŞicy
<
	gBigEndŸn
>;

211 
‹m¶©e
 
şass
 
	gSEAL_PŞicy
<
	gL™eEndŸn
>;

213 
	gNAMESPACE_END


	@seal.h

1 #iâdeà
CRYPTOPP_SEAL_H


2 
	#CRYPTOPP_SEAL_H


	)

4 
	~"¡rchr.h
"

6 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

9 
‹m¶©e
 <
şass
 
B
 = 
BigEndŸn
>

10 
SEAL_Info
 : 
public
 
FixedKeyL’gth
<20, 
Sim¶eKeyšgIÁ”çû
::
INTERNALLY_GENERATED_IV
, 4>

12 cÚ¡ *
	`SticAlgÜ™hmName
(è{ 
B
::
	`ToEnum
(è=ğ
LITTLE_ENDIAN_ORDER
 ? "SEAL-3.0-LE" : "SEAL-3.0-BE";}

13 
	}
};

15 
	g‹m¶©e
 <
şass
 
	gB
 = 
BigEndŸn
>

16 
şass
 
CRYPTOPP_NO_VTABLE
 
SEAL_PŞicy
 : 
public
 
Add™iveCh”CÚü‘ePŞicy
<
wÜd32
, 256>,…ubliø
	gSEAL_Info
<
	gB
>

18 
	g´Ùeùed
:

19 
Ch”S‘Key
(cÚ¡ 
NameV®uePaœs
 &
·¿ms
, cÚ¡ 
by‹
 *
key
, 
size_t
 
Ëngth
);

20 
O³¿‹Key¡»am
(
Key¡»amO³¿tiÚ
 
İ”©iÚ
, 
by‹
 *
ouut
, cÚ¡ by‹ *
šput
, 
size_t
 
™”©iÚCouÁ
);

21 
Ch”ResynchrÚize
(
by‹
 *
key¡»amBufãr
, cÚ¡ by‹ *
IV
, 
size_t
 
Ëngth
);

22 
boŞ
 
Ch”IsRªdomAcûss
(ècÚ¡ { 
	gŒue
;}

23 
S“kToI‹¿tiÚ
(
lwÜd
 
™”©iÚCouÁ
);

25 
	g´iv©e
:

26 
FixedSizeSecBlock
<
wÜd32
, 512> 
	gm_T
;

27 
	gFixedSizeSecBlock
<
	gwÜd32
, 256> 
	gm_S
;

28 
	gSecBlock
<
	gwÜd32
> 
	gm_R
;

30 
wÜd32
 
	gm_¡¬tCouÁ
, 
	gm_™”©iÚsP”CouÁ
;

31 
wÜd32
 
	gm_outsideCouÁ”
, 
	gm_šsideCouÁ”
;

35 
	g‹m¶©e
 <
şass
 
	gB
 = 
BigEndŸn
>

36 
SEAL
 : 
public
 
SEAL_Info
<
B
>,…ubliø
	gSymm‘ricCh”Docum’tiÚ


38 
	gSymm‘ricCh”Fš®
<
	tCÚü‘ePŞicyHŞd”
<
	tSEAL_PŞicy
<
	tB
>, 
	tAdd™iveCh”Tem¶©e
<> >, 
	tSEAL_Info
<B> > 
	tEnüy±iÚ
;

39 
Enüy±iÚ
 
	tDeüy±iÚ
;

42 
	gNAMESPACE_END


	@secblock.h

3 #iâdeà
CRYPTOPP_SECBLOCK_H


4 
	#CRYPTOPP_SECBLOCK_H


	)

6 
	~"cÚfig.h
"

7 
	~"misc.h
"

8 
	~<as£¹.h
>

10 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

14 
‹m¶©e
<
şass
 
T
>

15 şas 
	cAÎoÿtÜBa£


17 
public
:

18 
T
 
	tv®ue_ty³
;

19 
size_t
 
	tsize_ty³
;

20 #ifdeà
CRYPTOPP_MSVCRT6


21 
±rdiff_t
 
	tdifã»nû_ty³
;

23 
¡d
::
	t±rdiff_t
 
	tdifã»nû_ty³
;

25 
T
 * 
	tpoš‹r
;

26 cÚ¡ 
	tT
 * 
	tcÚ¡_poš‹r
;

27 
T
 & 
	t»ã»nû
;

28 cÚ¡ 
	tT
 & 
	tcÚ¡_»ã»nû
;

30 
poš‹r
 
	$add»ss
(
»ã»nû
 
r
) const { (&r);}

31 
cÚ¡_poš‹r
 
	$add»ss
(
cÚ¡_»ã»nû
 
r
ècÚ¡ { (&r); 
	}
}

32 
	$cÚ¡ruù
(
poš‹r
 
p
, cÚ¡ 
T
& 
v®
è{
	`Ãw
 (pè
	`T
(v®);
	}
}

33 
	$de¡roy
(
poš‹r
 
p
è{p->~
	`T
();
	}
}

34 
size_ty³
 
	$max_size
(ècÚ¡ { ~
	`size_ty³
(0)/(
T
);
	}
}

36 
	g´Ùeùed
:

37 
	$CheckSize
(
size_t
 
n
)

39 ià(
n
 > ~
	`size_t
(0è/ (
T
))

40 
throw
 
	`Inv®idArgum’t
("AllocatorBase:„equested size would cause integer overflow");

41 
	}
}

44 
	#CRYPTOPP_INHERIT_ALLOCATOR_TYPES
 \

45 
ty³Çme
 
	tAÎoÿtÜBa£
<
	tT
>::
	tv®ue_ty³
 value_type;\

46 
ty³Çme
 
	tAÎoÿtÜBa£
<
	tT
>::
	tsize_ty³
 size_type;\

47 
ty³Çme
 
	tAÎoÿtÜBa£
<
	tT
>::
	tdifã»nû_ty³
 difference_type;\

48 
ty³Çme
 
	tAÎoÿtÜBa£
<
	tT
>::
	tpoš‹r
…ointer;\

49 
ty³Çme
 
	tAÎoÿtÜBa£
<
	tT
>::
	tcÚ¡_poš‹r
 const_pointer;\

50 
ty³Çme
 
	tAÎoÿtÜBa£
<
	tT
>::
	t»ã»nû
„eference;\

51 
ty³Çme
 
	tAÎoÿtÜBa£
<
	tT
>::
	tcÚ¡_»ã»nû
 cÚ¡_»ã»nû;

	)

53 #ià
defšed
(
_MSC_VER
) && (_MSC_VER < 1300)

55 #´agm¨
w¬nšg
(
push
)

56 #´agm¨
w¬nšg
(
di§bË
: 4700)

59 
	g‹m¶©e
 <
şass
 
	gT
, cÏs 
	gA
>

60 
ty³Çme
 
	gA
::
poš‹r
 
	$Snd¬dR—Îoÿ‹
(
A
& 
a
, 
T
 *
p
, 
ty³Çme
 A::
size_ty³
 
ŞdSize
,y³ÇmA::size_ty³ 
ÃwSize
, 
boŞ
 
´e£rve
)

62 ià(
ŞdSize
 =ğ
ÃwSize
)

63  
p
;

65 ià(
´e£rve
)

67 
ty³Çme
 
A
::
poš‹r
 
ÃwPoš‹r
 = 
a
.
	`®loÿ‹
(
ÃwSize
, 
NULL
);

68 
	`memıy_s
(
ÃwPoš‹r
, (
T
)*
ÃwSize
, 
p
, (T)*
	`STDMIN
(
ŞdSize
,‚ewSize));

69 
a
.
	`d—Îoÿ‹
(
p
, 
ŞdSize
);

70  
ÃwPoš‹r
;

74 
a
.
	`d—Îoÿ‹
(
p
, 
ŞdSize
);

75  
a
.
	`®loÿ‹
(
ÃwSize
, 
NULL
);

77 
	}
}

79 #ià
defšed
(
_MSC_VER
) && (_MSC_VER < 1300)

80 #´agm¨
w¬nšg
(
pİ
)

83 
	g‹m¶©e
 <
şass
 
	gT
, 
boŞ
 
	gT_Align16
 = 
çl£
>

84 
şass
 
AÎoÿtÜW™hCËªup
 : 
public
 
AÎoÿtÜBa£
<
T
>

86 
public
:

87 
CRYPTOPP_INHERIT_ALLOCATOR_TYPES


89 
poš‹r
 
®loÿ‹
(
size_ty³
 
n
, cÚ¡ * = 
NULL
)

91 
this
->
CheckSize
(
n
);

92 ià(
	gn
 == 0)

93  
NULL
;

95 #ià
CRYPTOPP_BOOL_ALIGN16_ENABLED


96 ià(
	gT_Align16
 && 
n
*(
	gT
) >= 16)

97  (
poš‹r
)
AligÃdAÎoÿ‹
(
n
*(
T
));

100  (
	gpoš‹r
)
UÇligÃdAÎoÿ‹
(
n
*(
T
));

103 
d—Îoÿ‹
(*
p
, 
size_ty³
 
n
)

105 
Secu»WeA¼ay
((
poš‹r
)
p
, 
n
);

107 #ià
CRYPTOPP_BOOL_ALIGN16_ENABLED


108 ià(
	gT_Align16
 && 
n
*(
	gT
) >= 16)

109  
AligÃdD—Îoÿ‹
(
p
);

112 
UÇligÃdD—Îoÿ‹
(
p
);

115 
poš‹r
 
»®loÿ‹
(
T
 *
p
, 
size_ty³
 
ŞdSize
, size_ty³ 
ÃwSize
, 
boŞ
 
´e£rve
)

117  
Snd¬dR—Îoÿ‹
(*
this
, 
p
, 
ŞdSize
, 
ÃwSize
, 
´e£rve
);

122 
	g‹m¶©e
 <
şass
 
	gU
> 
	s»bšd
 { 
	gAÎoÿtÜW™hCËªup
<
	tU
, 
	tT_Align16
> 
	tÙh”
; };

123 #ià
_MSC_VER
 >= 1500

124 
AÎoÿtÜW™hCËªup
() {}

125 
	g‹m¶©e
 <
şass
 
	gU
, 
boŞ
 
	gA
> 
AÎoÿtÜW™hCËªup
(cÚ¡ AÎoÿtÜW™hCËªup<
U
, 
A
> &) {}

129 
CRYPTOPP_DLL_TEMPLATE_CLASS
 
	gAÎoÿtÜW™hCËªup
<
	gby‹
>;

130 
CRYPTOPP_DLL_TEMPLATE_CLASS
 
	gAÎoÿtÜW™hCËªup
<
	gwÜd16
>;

131 
CRYPTOPP_DLL_TEMPLATE_CLASS
 
	gAÎoÿtÜW™hCËªup
<
	gwÜd32
>;

132 
CRYPTOPP_DLL_TEMPLATE_CLASS
 
	gAÎoÿtÜW™hCËªup
<
	gwÜd64
>;

133 #ià
CRYPTOPP_BOOL_X86


134 
CRYPTOPP_DLL_TEMPLATE_CLASS
 
	gAÎoÿtÜW™hCËªup
<
	gwÜd
, 
	gŒue
>;

137 
	g‹m¶©e
 <
şass
 
	gT
>

138 
şass
 
	gNuÎAÎoÿtÜ
 : 
public
 
AÎoÿtÜBa£
<
T
>

140 
public
:

141 
CRYPTOPP_INHERIT_ALLOCATOR_TYPES


143 
poš‹r
 
®loÿ‹
(
size_ty³
 
n
, cÚ¡ * = 
NULL
)

145 
as£¹
(
çl£
);

146  
	gNULL
;

149 
d—Îoÿ‹
(*
p
, 
size_ty³
 
n
)

151 
as£¹
(
çl£
);

154 
size_ty³
 
max_size
() const { 0;}

160 
	g‹m¶©e
 <
şass
 
	gT
, 
size_t
 
	gS
, cÏs 
	gA
 = 
NuÎAÎoÿtÜ
<
T
>, 
boŞ
 
	gT_Align16
 = 
çl£
>

161 
şass
 
FixedSizeAÎoÿtÜW™hCËªup
 : 
public
 
AÎoÿtÜBa£
<
T
>

163 
public
:

164 
CRYPTOPP_INHERIT_ALLOCATOR_TYPES


166 
FixedSizeAÎoÿtÜW™hCËªup
(è: 
m_®loÿ‹d
(
çl£
) {}

168 
poš‹r
 
®loÿ‹
(
size_ty³
 
n
)

170 
as£¹
(
IsAligÃdOn
(
m_¬¿y
, 8));

172 ià(
	gn
 <ğ
S
 && !
m_®loÿ‹d
)

174 
m_®loÿ‹d
 = 
Œue
;

175  
G‘AligÃdA¼ay
();

178  
	gm_çÎbackAÎoÿtÜ
.
®loÿ‹
(
n
);

181 
poš‹r
 
®loÿ‹
(
size_ty³
 
n
, cÚ¡ *
hšt
)

183 ià(
	gn
 <ğ
S
 && !
m_®loÿ‹d
)

185 
m_®loÿ‹d
 = 
Œue
;

186  
G‘AligÃdA¼ay
();

189  
	gm_çÎbackAÎoÿtÜ
.
®loÿ‹
(
n
, 
hšt
);

192 
d—Îoÿ‹
(*
p
, 
size_ty³
 
n
)

194 ià(
	gp
 =ğ
G‘AligÃdA¼ay
())

196 
as£¹
(
n
 <ğ
S
);

197 
as£¹
(
m_®loÿ‹d
);

198 
	gm_®loÿ‹d
 = 
çl£
;

199 
Secu»WeA¼ay
((
poš‹r
)
p
, 
n
);

202 
	gm_çÎbackAÎoÿtÜ
.
d—Îoÿ‹
(
p
, 
n
);

205 
poš‹r
 
»®loÿ‹
Õoš‹¸
p
, 
size_ty³
 
ŞdSize
, size_ty³ 
ÃwSize
, 
boŞ
 
´e£rve
)

207 ià(
	gp
 =ğ
G‘AligÃdA¼ay
(è&& 
ÃwSize
 <ğ
S
)

209 
as£¹
(
ŞdSize
 <ğ
S
);

210 ià(
	gŞdSize
 > 
	gÃwSize
)

211 
Secu»WeA¼ay
(
p
+
ÃwSize
, 
ŞdSize
-newSize);

212  
	gp
;

215 
poš‹r
 
	gÃwPoš‹r
 = 
®loÿ‹
(
ÃwSize
, 
NULL
);

216 ià(
	g´e£rve
)

217 
memıy
(
ÃwPoš‹r
, 
p
, (
T
)*
STDMIN
(
ŞdSize
, 
ÃwSize
));

218 
d—Îoÿ‹
(
p
, 
ŞdSize
);

219  
	gÃwPoš‹r
;

222 
size_ty³
 
max_size
(ècÚ¡ { 
STDMAX
(
m_çÎbackAÎoÿtÜ
.max_size(), 
S
);}

224 
	g´iv©e
:

225 #ifdeà
__BORLANDC__


226 
T
* 
G‘AligÃdA¼ay
(è{ 
m_¬¿y
;}

227 
T
 
	gm_¬¿y
[
S
];

229 
T
* 
G‘AligÃdA¼ay
(è{ (
	gCRYPTOPP_BOOL_ALIGN16_ENABLED
 && 
	gT_Align16
è? (
	gT
*)(((
	gby‹
 *)
	gm_¬¿y
è+ (0-(
	gsize_t
)m_¬¿y)%16è: 
m_¬¿y
;}

230 
CRYPTOPP_ALIGN_DATA
(8è
T
 
	gm_¬¿y
[(
CRYPTOPP_BOOL_ALIGN16_ENABLED
 && 
T_Align16
è? 
S
+8/(T) : S];

232 
A
 
	gm_çÎbackAÎoÿtÜ
;

233 
boŞ
 
	gm_®loÿ‹d
;

237 
	g‹m¶©e
 <
şass
 
	gT
, cÏs 
	gA
 = 
AÎoÿtÜW™hCËªup
<
T
> >

238 şas 
	cSecBlock


240 
public
:

241 
ty³Çme
 
	tA
::
	tv®ue_ty³
 value_type;

242 
ty³Çme
 
	tA
::
	tpoš‹r
 
	t™”©Ü
;

243 
ty³Çme
 
	tA
::
	tcÚ¡_poš‹r
 
	tcÚ¡_™”©Ü
;

244 
ty³Çme
 
	tA
::
	tsize_ty³
 size_type;

246 
ex¶ic™
 
	$SecBlock
(
size_ty³
 
size
=0)

247 : 
	$m_size
(
size
è{
m_±r
 = 
m_®loc
.
	`®loÿ‹
(size, 
NULL
);}

248 
	`SecBlock
(cÚ¡ 
SecBlock
<
T
, 
A
> &
t
)

249 : 
	$m_size
(
t
.
m_size
è{
m_±r
 = 
m_®loc
.
	`®loÿ‹
(m_size, 
NULL
); 
	`memıy_s
(m_±r, m_size*(
T
),.m_±r, m_size*(T));
	}
}

250 
	$SecBlock
(cÚ¡ 
T
 *
t
, 
size_ty³
 
Ën
)

251 : 
	$m_size
(
Ën
)

253 
m_±r
 = 
m_®loc
.
	`®loÿ‹
(
Ën
, 
NULL
);

254 ià(
t
 =ğ
NULL
)

255 
	`mem£t_z
(
m_±r
, 0, 
Ën
*(
T
));

257 
	`memıy
(
m_±r
, 
t
, 
Ën
*(
T
));

258 
	}
}

260 ~
	$SecBlock
()

261 {
m_®loc
.
	`d—Îoÿ‹
(
m_±r
, 
m_size
);
	}
}

263 #ifdeà
__BORLANDC__


264 
İ”©Ü
 
	gT
 *() const

265 { (
	gT
*)
	gm_±r
;}

267 
İ”©Ü
 const *() const

268 { 
	gm_±r
;}

269 
İ”©Ü
 *()

270 { 
	gm_±r
;}

272 
İ”©Ü
 cÚ¡ 
	gT
 *() const

273 { 
	gm_±r
;}

274 
İ”©Ü
 
	gT
 *()

275 { 
	gm_±r
;}

290 
™”©Ü
 
	$begš
()

291 { 
m_±r
;
	}
}

292 
cÚ¡_™”©Ü
 
	$begš
() const

293 { 
m_±r
;
	}
}

294 
™”©Ü
 
	$’d
()

295 { 
m_±r
+
m_size
;
	}
}

296 
cÚ¡_™”©Ü
 
	$’d
() const

297 { 
m_±r
+
m_size
;
	}
}

299 
ty³Çme
 
	gA
::
poš‹r
 
	$d©a
(è{ 
m_±r
;
	}
}

300 
ty³Çme
 
	gA
::
cÚ¡_poš‹r
 
	$d©a
(ècÚ¡ { 
m_±r
;
	}
}

302 
size_ty³
 
	$size
(ècÚ¡ { 
m_size
;
	}
}

303 
boŞ
 
	$em±y
(ècÚ¡ { 
m_size
 =ğ0;
	}
}

305 
by‹
 * 
	$By‹PŒ
(è{ (
by‹
 *)
m_±r
;
	}
}

306 cÚ¡ 
by‹
 * 
	$By‹PŒ
(ècÚ¡ { (cÚ¡ 
by‹
 *)
m_±r
;
	}
}

307 
size_ty³
 
	$SizeInBy‹s
(ècÚ¡ { 
m_size
*(
T
);
	}
}

310 
	$Assign
(cÚ¡ 
T
 *
t
, 
size_ty³
 
Ën
)

312 
	`New
(
Ën
);

313 
	`memıy_s
(
m_±r
, 
m_size
*(
T
), 
t
, 
Ën
*(T));

314 
	}
}

317 
Assign
(cÚ¡ 
SecBlock
<
T
, 
A
> &
t
)

319 ià(
	gthis
 !ğ&
t
)

321 
New
(
t
.
m_size
);

322 
memıy_s
(
m_±r
, 
m_size
*(
T
), 
t
.m_ptr, m_size*(T));

326 
	gSecBlock
<
	gT
, 
	gA
>& 
	gİ”©Ü
=(cÚ¡ 
SecBlock
<
T
, A> &
	gt
)

328 
Assign
(
t
);

329  *
	gthis
;

333 
	gSecBlock
<
	gT
, 
	gA
>& 
	gİ”©Ü
+=(cÚ¡ 
SecBlock
<
T
, A> &
	gt
)

335 
size_ty³
 
	gŞdSize
 = 
m_size
;

336 
Grow
(
m_size
+
t
.m_size);

337 
memıy_s
(
m_±r
+
ŞdSize
, 
m_size
*(
T
), 
t
.m_ptr,.m_size*(T));

338  *
	gthis
;

342 
	gSecBlock
<
	gT
, 
	gA
> 
	gİ”©Ü
+(cÚ¡ SecBlock<T, A> &
	gt
)

344 
	gSecBlock
<
	gT
, 
	gA
> 
»suÉ
(
m_size
+
t
.m_size);

345 
memıy_s
(
»suÉ
.
m_±r
,„esuÉ.
m_size
*(
T
), m_ptr, m_size*(T));

346 
memıy_s
(
»suÉ
.
m_±r
+
m_size
, 
t
.m_size*(
T
),.m_ptr,.m_size*(T));

347  
	g»suÉ
;

350 
boŞ
 
	gİ”©Ü
==(cÚ¡ 
SecBlock
<
T
, 
	gA
> &
	gt
) const

352  
	gm_size
 =ğ
t
.
m_size
 && 
V”ifyBufsEqu®
(
m_±r
,.m_±r, m_size*(
T
));

355 
boŞ
 
	gİ”©Ü
!=(cÚ¡ 
SecBlock
<
T
, 
	gA
> &
	gt
) const

357  !
	gİ”©Ü
==(
t
);

361 
	$New
(
size_ty³
 
ÃwSize
)

363 
m_±r
 = 
m_®loc
.
	`»®loÿ‹
(m_±r, 
m_size
, 
ÃwSize
, 
çl£
);

364 
m_size
 = 
ÃwSize
;

365 
	}
}

368 
	$CËªNew
(
size_ty³
 
ÃwSize
)

370 
	`New
(
ÃwSize
);

371 
	`mem£t_z
(
m_±r
, 0, 
m_size
*(
T
));

372 
	}
}

375 
	$Grow
(
size_ty³
 
ÃwSize
)

377 ià(
ÃwSize
 > 
m_size
)

379 
m_±r
 = 
m_®loc
.
	`»®loÿ‹
(m_±r, 
m_size
, 
ÃwSize
, 
Œue
);

380 
m_size
 = 
ÃwSize
;

382 
	}
}

385 
	$CËªGrow
(
size_ty³
 
ÃwSize
)

387 ià(
ÃwSize
 > 
m_size
)

389 
m_±r
 = 
m_®loc
.
	`»®loÿ‹
(m_±r, 
m_size
, 
ÃwSize
, 
Œue
);

390 
	`mem£t
(
m_±r
+
m_size
, 0, (
ÃwSize
-m_size)*(
T
));

391 
m_size
 = 
ÃwSize
;

393 
	}
}

396 
	$»size
(
size_ty³
 
ÃwSize
)

398 
m_±r
 = 
m_®loc
.
	`»®loÿ‹
(m_±r, 
m_size
, 
ÃwSize
, 
Œue
);

399 
m_size
 = 
ÃwSize
;

400 
	}
}

403 
sw­
(
SecBlock
<
T
, 
A
> &
b
)

405 
	g¡d
::
sw­
(
m_®loc
, 
b
.m_alloc);

406 
	g¡d
::
sw­
(
m_size
, 
b
.m_size);

407 
	g¡d
::
sw­
(
m_±r
, 
b
.m_ptr);

411 
A
 
	gm_®loc
;

412 
size_ty³
 
	gm_size
;

413 
T
 *
	gm_±r
;

416 
	gSecBlock
<
	tby‹
> 
	tSecBy‹Block
;

417 
	gSecBlock
<
	tby‹
, 
	tAÎoÿtÜW™hCËªup
<by‹, 
	tŒue
> > 
	tAligÃdSecBy‹Block
;

418 
	gSecBlock
<
	twÜd
> 
	tSecWÜdBlock
;

421 
	g‹m¶©e
 <
şass
 
	gT
, 
	gS
, cÏs 
	gA
 = 
FixedSizeAÎoÿtÜW™hCËªup
<
T
, S> >

422 
şass
 
	gFixedSizeSecBlock
 : 
public
 
SecBlock
<
T
, 
	gA
>

424 
	gpublic
:

425 
ex¶ic™
 
FixedSizeSecBlock
(è: 
SecBlock
<
T
, 
	gA
>(
	gS
) {}

428 
	g‹m¶©e
 <
şass
 
	gT
, 
	gS
, 
boŞ
 
	gT_Align16
 = 
Œue
>

429 
şass
 
FixedSizeAligÃdSecBlock
 : 
public
 
FixedSizeSecBlock
<
T
, 
	gS
, 
	gFixedSizeAÎoÿtÜW™hCËªup
<
	gT
, S, 
	gNuÎAÎoÿtÜ
<T>, 
	gT_Align16
> >

434 
	g‹m¶©e
 <
şass
 
	gT
, 
	gS
, cÏs 
	gA
 = 
FixedSizeAÎoÿtÜW™hCËªup
<
T
, S, 
	gAÎoÿtÜW™hCËªup
<T> > >

435 
şass
 
	gSecBlockW™hHšt
 : 
public
 
SecBlock
<
T
, 
	gA
>

437 
	gpublic
:

438 
ex¶ic™
 
SecBlockW™hHšt
(
size_t
 
size
è: 
SecBlock
<
T
, 
	gA
>(
	gsize
) {}

441 
	g‹m¶©e
<
şass
 
	gT
, 
boŞ
 
	gA
, cÏs 
	gU
, boŞ 
	gB
>

442 
šlše
 
boŞ
 
	gİ”©Ü
==(cÚ¡ 
Cry±oPP
::
AÎoÿtÜW™hCËªup
<
T
, 
	gA
>&, cÚ¡ 
	gCry±oPP
::AÎoÿtÜW™hCËªup<
U
, 
	gB
>&è{ (
	gŒue
);}

443 
	g‹m¶©e
<
şass
 
	gT
, 
boŞ
 
	gA
, cÏs 
	gU
, boŞ 
	gB
>

444 
šlše
 
boŞ
 
	gİ”©Ü
!=(cÚ¡ 
Cry±oPP
::
AÎoÿtÜW™hCËªup
<
T
, 
	gA
>&, cÚ¡ 
	gCry±oPP
::AÎoÿtÜW™hCËªup<
U
, 
	gB
>&è{ (
	gçl£
);}

446 
NAMESPACE_END


448 
	$NAMESPACE_BEGIN
(
¡d
)

449 
‹m¶©e
 <
şass
 
T
, cÏs 
A
>

450 
šlše
 
	`sw­
(
Cry±oPP
::
SecBlock
<
T
, 
A
> &
a
, Cry±oPP::SecBlock<T, A> &
b
)

452 
a
.
	`sw­
(
b
);

453 
	}
}

455 #ià
defšed
(
_STLP_DONT_SUPPORT_REBIND_MEMBER_TEMPLATE
è|| (defšed(
_STLPORT_VERSION
è&& !defšed(
_STLP_MEMBER_TEMPLATE_CLASSES
))

457 
	g‹m¶©e
 <
şass
 
	g_Tp1
, cÏs 
	g_Tp2
>

458 
šlše
 
	gCry±oPP
::
AÎoÿtÜW™hCËªup
<
_Tp2
>&

459 
__¡l_®loc_»bšd
(
Cry±oPP
::
AÎoÿtÜW™hCËªup
<
_Tp1
>& 
__a
, cÚ¡ 
_Tp2
*)

461  (
	gCry±oPP
::
AÎoÿtÜW™hCËªup
<
_Tp2
>&)(
__a
);

465 
	gNAMESPACE_END


	@seckey.h

5 #iâdeà
CRYPTOPP_SECKEY_H


6 
	#CRYPTOPP_SECKEY_H


	)

8 
	~"üy±lib.h
"

9 
	~"misc.h
"

10 
	~"sim¶e.h
"

12 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

14 
šlše
 
Ch”Dœ
 
	$Rev”£Ch”Dœ
(
Ch”Dœ
 
dœ
)

16  (
dœ
 =ğ
ENCRYPTION
è? 
DECRYPTION
 : ENCRYPTION;

17 
	}
}

20 
	g‹m¶©e
 <
	gN
>

21 şas 
	cFixedBlockSize


23 
	mpublic
:

24 
CRYPTOPP_CONSTANT
(
BLOCKSIZE
 = 
N
)

30 
	g‹m¶©e
 <
	gR
>

31 şas 
	cFixedRounds


33 
	mpublic
:

34 
CRYPTOPP_CONSTANT
(
ROUNDS
 = 
R
)

38 
	g‹m¶©e
 <
	gD
, 
	gN
=1, 
	gM
=
INT_MAX
>

39 şas 
	cV¬ŸbËRounds


41 
public
:

42 
	$CRYPTOPP_CONSTANT
(
DEFAULT_ROUNDS
 = 
D
)

43 
	$CRYPTOPP_CONSTANT
(
MIN_ROUNDS
 = 
N
)

44 
	$CRYPTOPP_CONSTANT
(
MAX_ROUNDS
 = 
M
)

45 
	$SticG‘DeçuÉRounds
(
size_t
 
keyËngth
è{ 
DEFAULT_ROUNDS
;}

47 
´Ùeùed
:

48 
šlše
 
	$ThrowIfInv®idRounds
(
rounds
, cÚ¡ 
AlgÜ™hm
 *
®g
)

50 ià(
rounds
 < 
MIN_ROUNDS
 ||„ound > 
MAX_ROUNDS
)

51 
throw
 
	`Inv®idRounds
(
®g
->
	`AlgÜ™hmName
(), 
rounds
);

52 
	}
}

54 
šlše
 
	$G‘RoundsAndThrowIfInv®id
(cÚ¡ 
NameV®uePaœs
 &
·¿m
, cÚ¡ 
AlgÜ™hm
 *
®g
)

56 
rounds
 = 
·¿m
.
	`G‘IÁV®ueW™hDeçuÉ
("Rounds", 
DEFAULT_ROUNDS
);

57 
	`ThrowIfInv®idRounds
(
rounds
, 
®g
);

58  ()
rounds
;

59 
	}
}

65 
	g‹m¶©e
 <
	gN
, 
	gIV_REQ
 = 
Sim¶eKeyšgIÁ”çû
::
NOT_RESYNCHRONIZABLE
, 
	gIV_L
 = 0>

66 şas 
	cFixedKeyL’gth


68 
public
:

69 
	$CRYPTOPP_CONSTANT
(
KEYLENGTH
=
N
)

70 
	$CRYPTOPP_CONSTANT
(
MIN_KEYLENGTH
=
N
)

71 
	$CRYPTOPP_CONSTANT
(
MAX_KEYLENGTH
=
N
)

72 
	$CRYPTOPP_CONSTANT
(
DEFAULT_KEYLENGTH
=
N
)

73 
	$CRYPTOPP_CONSTANT
(
IV_REQUIREMENT
 = 
IV_REQ
)

74 
	$CRYPTOPP_CONSTANT
(
IV_LENGTH
 = 
IV_L
)

75 
size_t
 
CRYPTOPP_API
 
	$SticG‘V®idKeyL’gth
(
size_t
è{ 
KEYLENGTH
;}

76 
	}
};

79 
	g‹m¶©e
 <
	gD
, 
	gN
, 
	gM
, 
	gQ
 = 1, 
	gIV_REQ
 = 
Sim¶eKeyšgIÁ”çû
::
NOT_RESYNCHRONIZABLE
, 
	gIV_L
 = 0>

80 şas 
	cV¬ŸbËKeyL’gth


83 
CRYPTOPP_COMPILE_ASSERT
(
Q
 > 0);

84 
CRYPTOPP_COMPILE_ASSERT
(
N
 % 
Q
 == 0);

85 
CRYPTOPP_COMPILE_ASSERT
(
M
 % 
Q
 == 0);

86 
CRYPTOPP_COMPILE_ASSERT
(
N
 < 
M
);

87 
CRYPTOPP_COMPILE_ASSERT
(
D
 >ğ
N
);

88 
CRYPTOPP_COMPILE_ASSERT
(
M
 >ğ
D
);

90 
	mpublic
:

91 
	$CRYPTOPP_CONSTANT
(
MIN_KEYLENGTH
=
N
)

92 
	$CRYPTOPP_CONSTANT
(
MAX_KEYLENGTH
=
M
)

93 
	$CRYPTOPP_CONSTANT
(
DEFAULT_KEYLENGTH
=
D
)

94 
	$CRYPTOPP_CONSTANT
(
KEYLENGTH_MULTIPLE
=
Q
)

95 
	$CRYPTOPP_CONSTANT
(
IV_REQUIREMENT
=
IV_REQ
)

96 
	$CRYPTOPP_CONSTANT
(
IV_LENGTH
=
IV_L
)

98 
size_t
 
CRYPTOPP_API
 
	$SticG‘V®idKeyL’gth
(
size_t
 
n
)

100 ià(
n
 < (
size_t
)
MIN_KEYLENGTH
)

101  
MIN_KEYLENGTH
;

102 ià(
n
 > (
size_t
)
MAX_KEYLENGTH
)

103  (
size_t
)
MAX_KEYLENGTH
;

106 
n
 +ğ
KEYLENGTH_MULTIPLE
-1;

107  
n
 -‚%
KEYLENGTH_MULTIPLE
;

110 
	}
};

113 
	g‹m¶©e
 <
şass
 
	gT
, 
	gIV_REQ
 = 
Sim¶eKeyšgIÁ”çû
::
NOT_RESYNCHRONIZABLE
, 
	gIV_L
 = 0>

114 şas 
	cSameKeyL’gthAs


116 
public
:

117 
	$CRYPTOPP_CONSTANT
(
MIN_KEYLENGTH
=
T
::MIN_KEYLENGTH)

118 
	$CRYPTOPP_CONSTANT
(
MAX_KEYLENGTH
=
T
::MAX_KEYLENGTH)

119 
	$CRYPTOPP_CONSTANT
(
DEFAULT_KEYLENGTH
=
T
::DEFAULT_KEYLENGTH)

120 
	$CRYPTOPP_CONSTANT
(
IV_REQUIREMENT
=
IV_REQ
)

121 
	$CRYPTOPP_CONSTANT
(
IV_LENGTH
=
IV_L
)

123 
size_t
 
CRYPTOPP_API
 
	$SticG‘V®idKeyL’gth
(
size_t
 
keyËngth
)

124 { 
T
::
	`SticG‘V®idKeyL’gth
(
keyËngth
);}

125 
	}
};

130 
	g‹m¶©e
 <
şass
 
	gBASE
, cÏs 
	gINFO
 = 
BASE
>

131 şas 
	cCRYPTOPP_NO_VTABLE
 
Sim¶eKeyšgIÁ”çûIm¶
 : 
public
 
BASE


133 
public
:

134 
size_t
 
	$MšKeyL’gth
(ècÚ¡ { 
INFO
::
MIN_KEYLENGTH
;}

135 
size_t
 
	$MaxKeyL’gth
(ècÚ¡ { (
size_t
)
INFO
::
MAX_KEYLENGTH
;
	}
}

136 
size_t
 
	$DeçuÉKeyL’gth
(ècÚ¡ { 
INFO
::
DEFAULT_KEYLENGTH
;
	}
}

137 
size_t
 
	$G‘V®idKeyL’gth
(
size_t
 
n
ècÚ¡ { 
INFO
::
	`SticG‘V®idKeyL’gth
Ò);
	}
}

138 
	gSim¶eKeyšgIÁ”çû
::
IV_Requœem’t
 
	$IVRequœem’t
(ècÚ¡ { (
Sim¶eKeyšgIÁ”çû
::
IV_Requœem’t
)
INFO
::
IV_REQUIREMENT
;
	}
}

139 
	$IVSize
(ècÚ¡ { 
INFO
::
IV_LENGTH
;
	}
}

142 
	g‹m¶©e
 <
şass
 
	gINFO
, cÏs 
	gBASE
 = 
BlockCh”
>

143 
şass
 
CRYPTOPP_NO_VTABLE
 
BlockCh”Im¶
 : 
public
 
AlgÜ™hmIm¶
<
Sim¶eKeyšgIÁ”çûIm¶
<
TwoBa£s
<
BASE
, 
	gINFO
> > >

145 
	gpublic
:

146 
BlockSize
(ècÚ¡ { 
this
->
BLOCKSIZE
;}

150 
	g‹m¶©e
 <
Ch”Dœ
 
	gDIR
, 
şass
 
	gBASE
>

151 
şass
 
	gBlockCh”Fš®
 : 
public
 
ClÚabËIm¶
<
BlockCh”Fš®
<
DIR
, 
	gBASE
>, BASE>

153 
	gpublic
:

154 
BlockCh”Fš®
() {}

155 
BlockCh”Fš®
(cÚ¡ 
by‹
 *
key
)

156 {
this
->
S‘Key
(
key
,his->
DEFAULT_KEYLENGTH
);}

157 
BlockCh”Fš®
(cÚ¡ 
by‹
 *
key
, 
size_t
 
Ëngth
)

158 {
	gthis
->
S‘Key
(
key
, 
Ëngth
);}

159 
BlockCh”Fš®
(cÚ¡ 
by‹
 *
key
, 
size_t
 
Ëngth
, 
rounds
)

160 {
	gthis
->
S‘KeyW™hRounds
(
key
, 
Ëngth
, 
rounds
);}

162 
boŞ
 
IsFÜw¬dT¿nsfÜm©iÚ
(ècÚ¡ { 
	gDIR
 =ğ
ENCRYPTION
;}

166 
	g‹m¶©e
 <
şass
 
	gBASE
, cÏs 
	gINFO
 = 
BASE
>

167 
şass
 
Mes§geAuth’tiÿtiÚCodeIm¶
 : 
public
 
AlgÜ™hmIm¶
<
Sim¶eKeyšgIÁ”çûIm¶
<
BASE
, 
	gINFO
>, INFO>

172 
	g‹m¶©e
 <
şass
 
	gBASE
>

173 
şass
 
	gMes§geAuth’tiÿtiÚCodeFš®
 : 
public
 
ClÚabËIm¶
<
Mes§geAuth’tiÿtiÚCodeFš®
<
BASE
>, 
	gMes§geAuth’tiÿtiÚCodeIm¶
<
	gBASE
> >

175 
	gpublic
:

176 
Mes§geAuth’tiÿtiÚCodeFš®
() {}

177 
Mes§geAuth’tiÿtiÚCodeFš®
(cÚ¡ 
by‹
 *
key
)

178 {
this
->
S‘Key
(
key
,his->
DEFAULT_KEYLENGTH
);}

179 
Mes§geAuth’tiÿtiÚCodeFš®
(cÚ¡ 
by‹
 *
key
, 
size_t
 
Ëngth
)

180 {
	gthis
->
S‘Key
(
key
, 
Ëngth
);}

188 
	sBlockCh”Docum’tiÚ


191 
BlockCh”
 
	tEnüy±iÚ
;

193 
BlockCh”
 
	tDeüy±iÚ
;

201 
	sSymm‘ricCh”Docum’tiÚ


204 
Symm‘ricCh”
 
	tEnüy±iÚ
;

206 
Symm‘ricCh”
 
	tDeüy±iÚ
;

211 
	sAuth’tiÿ‹dSymm‘ricCh”Docum’tiÚ


214 
Auth’tiÿ‹dSymm‘ricCh”
 
	tEnüy±iÚ
;

216 
Auth’tiÿ‹dSymm‘ricCh”
 
	tDeüy±iÚ
;

219 
	gNAMESPACE_END


	@seed.cpp

3 
	~"pch.h
"

4 
	~"£ed.h
"

5 
	~"misc.h
"

7 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

9 cÚ¡ 
wÜd32
 
s_kc
[16] = {

11 0x3779b99e, 0x6ef3733c, 0xdde6e678, 0xbbcdccf1, 0x779b99e3, 0xef3733c6, 0xde6e678d, 0xbcdccf1b
	}
};

13 cÚ¡ 
by‹
 
	gs_s0
[256] = {

31 cÚ¡ 
by‹
 
	gs_s1
[256] = {

49 
	#SS0
(
x
è((
s_s0
[x]*0x01010101ULè& 0x3FCFF3FC)

	)

50 
	#SS1
(
x
è((
s_s1
[x]*0x01010101ULè& 0xFC3FCFF3)

	)

51 
	#SS2
(
x
è((
s_s0
[x]*0x01010101ULè& 0xF3FC3FCF)

	)

52 
	#SS3
(
x
è((
s_s1
[x]*0x01010101ULè& 0xCFF3FC3F)

	)

53 
	#G
(
x
è(
	`SS0
(
	`GETBYTE
(x, 0)è^ 
	`SS1
(GETBYTE(x, 1)è^ 
	`SS2
(GETBYTE(x, 2)è^ 
	`SS3
(GETBYTE(x, 3)))

	)

55 
	gSEED
::
Ba£
::
	$UncheckedS‘Key
(cÚ¡ 
by‹
 *
u£rKey
, 
Ëngth
, cÚ¡ 
NameV®uePaœs
 &
·¿ms
)

57 
	`As£¹V®idKeyL’gth
(
Ëngth
);

59 
wÜd64
 
key01
, 
key23
;

60 
G‘Block
<
wÜd64
, 
BigEndŸn
> 
	`g‘
(
u£rKey
);

61 
	`g‘
(
key01
)(
key23
);

62 
wÜd32
 *
k
 = 
m_k
;

63 
size_t
 
kInc
 = 2;

64 ià(!
	`IsFÜw¬dT¿nsfÜm©iÚ
())

66 
k
 = k+30;

67 
kInc
 = 0-kInc;

70 
i
=0; i<
ROUNDS
; i++)

72 
wÜd32
 
t0
 = 
	`wÜd32
(
key01
>>32è+ wÜd32(
key23
>>32è- 
s_kc
[
i
];

73 
wÜd32
 
t1
 = 
	`wÜd32
(
key01
è- wÜd32(
key23
è+ 
s_kc
[
i
];

74 
k
[0] = 
	`G
(
t0
);

75 
k
[1] = 
	`G
(
t1
);

76 
k
+=
kInc
;

77 ià(
i
&1)

78 
key23
 = 
rÙlFixed
<
wÜd64
>(key23, 8);

80 
key01
 = 
rÙrFixed
<
wÜd64
>(key01, 8);

82 
	}
}

84 
	gSEED
::
Ba£
::
	$ProûssAndXÜBlock
(cÚ¡ 
by‹
 *
šBlock
, cÚ¡ by‹ *
xÜBlock
, by‹ *
outBlock
) const

86 
BlockG‘AndPut
<
	twÜd32
, 
	tBigEndŸn
> 
	tBlock
;

87 
wÜd32
 
a0
, 
a1
, 
b0
, 
b1
, 
t0
, 
t1
;

88 
Block
::
	`G‘
(
šBlock
)(
a0
)(
a1
)(
b0
)(
b1
);

90 
i
=0; i<
ROUNDS
; i+=2)

92 
t0
 = 
b0
 ^ 
m_k
[2*
i
+0]; 
t1
 = 
b1
 ^ m_k[2*i+1] ^0;

93 
t1
 = 
	`G
Ñ1); 
t0
 +=1;0 = G(t0);1 +=0;1 = G(t1);

94 
a0
 ^ğ
t0
 + 
t1
; 
a1
 ^=1;

96 
t0
 = 
a0
 ^ 
m_k
[2*
i
+2]; 
t1
 = 
a1
 ^ m_k[2*i+3] ^0;

97 
t1
 = 
	`G
Ñ1); 
t0
 +=1;0 = G(t0);1 +=0;1 = G(t1);

98 
b0
 ^ğ
t0
 + 
t1
; 
b1
 ^=1;

101 
Block
::
	`Put
(
xÜBlock
, 
outBlock
)(
b0
)(
b1
)(
a0
)(
a1
);

102 
	}
}

104 
	gNAMESPACE_END


	@seed.h

1 #iâdeà
CRYPTOPP_SEED_H


2 
	#CRYPTOPP_SEED_H


	)

7 
	~"£ckey.h
"

8 
	~"£cblock.h
"

10 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

13 
SEED_Info
 : 
public
 
FixedBlockSize
<16>,…ubliø
FixedKeyL’gth
<16>,…ubliø
FixedRounds
<16>

15 cÚ¡ *
	`SticAlgÜ™hmName
() { "SEED";}

16 
	}
};

19 
şass
 
	gSEED
 : 
public
 
SEED_Info
,…ubliø
	gBlockCh”Docum’tiÚ


21 
şass
 
CRYPTOPP_NO_VTABLE
 
	gBa£
 : 
public
 
BlockCh”Im¶
<
SEED_Info
>

23 
public
:

24 
UncheckedS‘Key
(cÚ¡ 
by‹
 *
key
, 
Ëngth
, cÚ¡ 
NameV®uePaœs
 &
·¿ms
);

25 
ProûssAndXÜBlock
(cÚ¡ 
by‹
 *
šBlock
, cÚ¡ by‹ *
xÜBlock
, by‹ *
outBlock
) const;

27 
	g´Ùeùed
:

28 
FixedSizeSecBlock
<
wÜd32
, 32> 
	gm_k
;

31 
	gpublic
:

32 
BlockCh”Fš®
<
	tENCRYPTION
, 
	tBa£
> 
	tEnüy±iÚ
;

33 
	gBlockCh”Fš®
<
	tDECRYPTION
, 
	tBa£
> 
	tDeüy±iÚ
;

36 
	gNAMESPACE_END


	@serpent.cpp

3 
	~"pch.h
"

4 
	~"£½’t.h
"

5 
	~"misc.h
"

7 
	~"£½’.h
"

9 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

11 
	$S”³Á_KeyScheduË
(
wÜd32
 *
k
, 
rounds
, cÚ¡ 
by‹
 *
u£rKey
, 
size_t
 
keyËn
)

13 
FixedSizeSecBlock
<
wÜd32
, 8> 
k0
;

14 
	`G‘U£rKey
(
LITTLE_ENDIAN_ORDER
, 
k0
.
	`begš
(), 8, 
u£rKey
, 
keyËn
);

15 ià(
keyËn
 < 32)

16 
k0
[
keyËn
/4] |ğ
	`wÜd32
(1) << ((keylen%4)*8);

18 
wÜd32
 
t
 = 
k0
[7];

19 
i
;

20 
i
 = 0; i < 8; ++i)

21 
k
[
i
] = 
k0
[i] = 
t
 = 
	`rÙlFixed
(k0[i] ^ k0[(i+3)%8] ^ k0[(i+5)%8] ^ ^ 0x9e3779b9 ^ i, 11);

22 
i
 = 8; i < 4*(
rounds
+1); ++i)

23 
k
[
i
] = 
t
 = 
	`rÙlFixed
(k[i-8] ^ k[i-5] ^ k[i-3] ^ ^ 0x9e3779b9 ^ i, 11);

24 
k
 -= 20;

26 
wÜd32
 
a
,
b
,
c
,
d
,
e
;

27 
i
=0; i<
rounds
/8; i++)

29 
	`aá”S2
(
LK
);‡á”S2(
S3
); 
	`aá”S3
(
SK
);

30 
	`aá”S1
(
LK
);‡á”S1(
S2
); 
	`aá”S2
(
SK
);

31 
	`aá”S0
(
LK
);‡á”S0(
S1
); 
	`aá”S1
(
SK
);

32 
	`befÜeS0
(
LK
); befÜeS0(
S0
); 
	`aá”S0
(
SK
);

33 
k
 += 8*4;

34 
	`aá”S6
(
LK
);‡á”S6(
S7
); 
	`aá”S7
(
SK
);

35 
	`aá”S5
(
LK
);‡á”S5(
S6
); 
	`aá”S6
(
SK
);

36 
	`aá”S4
(
LK
);‡á”S4(
S5
); 
	`aá”S5
(
SK
);

37 
	`aá”S3
(
LK
);‡á”S3(
S4
); 
	`aá”S4
(
SK
);

39 
	`aá”S2
(
LK
);‡á”S2(
S3
); 
	`aá”S3
(
SK
);

40 
	}
}

42 
	gS”³Á
::
Ba£
::
	$UncheckedS‘Key
(cÚ¡ 
by‹
 *
u£rKey
, 
keyËn
, cÚ¡ 
NameV®uePaœs
 &)

44 
	`As£¹V®idKeyL’gth
(
keyËn
);

45 
	`S”³Á_KeyScheduË
(
m_key
, 32, 
u£rKey
, 
keyËn
);

46 
	}
}

48 
	gBlockG‘AndPut
<
	twÜd32
, 
	tL™eEndŸn
> 
	tBlock
;

50 
	gS”³Á
::
Enc
::
	$ProûssAndXÜBlock
(cÚ¡ 
by‹
 *
šBlock
, cÚ¡ by‹ *
xÜBlock
, by‹ *
outBlock
) const

52 
wÜd32
 
a
, 
b
, 
c
, 
d
, 
e
;

54 
Block
::
	`G‘
(
šBlock
)(
a
)(
b
)(
c
)(
d
);

56 cÚ¡ 
wÜd32
 *
k
 = 
m_key
;

57 
i
=1;

61 
	`befÜeS0
(
KX
); befÜeS0(
S0
); 
	`aá”S0
(
LT
);

62 
	`aá”S0
(
KX
);‡á”S0(
S1
); 
	`aá”S1
(
LT
);

63 
	`aá”S1
(
KX
);‡á”S1(
S2
); 
	`aá”S2
(
LT
);

64 
	`aá”S2
(
KX
);‡á”S2(
S3
); 
	`aá”S3
(
LT
);

65 
	`aá”S3
(
KX
);‡á”S3(
S4
); 
	`aá”S4
(
LT
);

66 
	`aá”S4
(
KX
);‡á”S4(
S5
); 
	`aá”S5
(
LT
);

67 
	`aá”S5
(
KX
);‡á”S5(
S6
); 
	`aá”S6
(
LT
);

68 
	`aá”S6
(
KX
);‡á”S6(
S7
);

70 ià(
i
 == 4)

73 ++
i
;

74 
c
 = 
b
;

75 
b
 = 
e
;

76 
e
 = 
d
;

77 
d
 = 
a
;

78 
a
 = 
e
;

79 
k
 += 32;

80 
	`befÜeS0
(
LT
);

82 
Œue
);

84 
	`aá”S7
(
KX
);

86 
Block
::
	`Put
(
xÜBlock
, 
outBlock
)(
d
)(
e
)(
b
)(
a
);

87 
	}
}

89 
	gS”³Á
::
Dec
::
	$ProûssAndXÜBlock
(cÚ¡ 
by‹
 *
šBlock
, cÚ¡ by‹ *
xÜBlock
, by‹ *
outBlock
) const

91 
wÜd32
 
a
, 
b
, 
c
, 
d
, 
e
;

93 
Block
::
	`G‘
(
šBlock
)(
a
)(
b
)(
c
)(
d
);

95 cÚ¡ 
wÜd32
 *
k
 = 
m_key
 + 96;

96 
i
=4;

98 
	`befÜeI7
(
KX
);

99 
¡¬t
;

103 
c
 = 
b
;

104 
b
 = 
d
;

105 
d
 = 
e
;

106 
k
 -= 32;

107 
	`befÜeI7
(
ILT
);

108 
¡¬t
:

109 
	`befÜeI7
(
I7
); 
	`aá”I7
(
KX
);

110 
	`aá”I7
(
ILT
);‡á”I7(
I6
); 
	`aá”I6
(
KX
);

111 
	`aá”I6
(
ILT
);‡á”I6(
I5
); 
	`aá”I5
(
KX
);

112 
	`aá”I5
(
ILT
);‡á”I5(
I4
); 
	`aá”I4
(
KX
);

113 
	`aá”I4
(
ILT
);‡á”I4(
I3
); 
	`aá”I3
(
KX
);

114 
	`aá”I3
(
ILT
);‡á”I3(
I2
); 
	`aá”I2
(
KX
);

115 
	`aá”I2
(
ILT
);‡á”I2(
I1
); 
	`aá”I1
(
KX
);

116 
	`aá”I1
(
ILT
);‡á”I1(
I0
); 
	`aá”I0
(
KX
);

118 --
i
 != 0);

120 
Block
::
	`Put
(
xÜBlock
, 
outBlock
)(
a
)(
d
)(
b
)(
e
);

121 
	}
}

123 
	gNAMESPACE_END


	@serpent.h

1 #iâdeà
CRYPTOPP_SERPENT_H


2 
	#CRYPTOPP_SERPENT_H


	)

7 
	~"£ckey.h
"

8 
	~"£cblock.h
"

10 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

13 
S”³Á_Info
 : 
public
 
FixedBlockSize
<16>,…ubliø
V¬ŸbËKeyL’gth
<16, 0, 32>,…ubliø
FixedRounds
<32>

15 cÚ¡ *
	`SticAlgÜ™hmName
() { "Serpent";}

16 
	}
};

19 
şass
 
	gS”³Á
 : 
public
 
S”³Á_Info
,…ubliø
	gBlockCh”Docum’tiÚ


21 
şass
 
CRYPTOPP_NO_VTABLE
 
	gBa£
 : 
public
 
BlockCh”Im¶
<
S”³Á_Info
>

23 
public
:

24 
UncheckedS‘Key
(cÚ¡ 
by‹
 *
u£rKey
, 
Ëngth
, cÚ¡ 
NameV®uePaœs
 &
·¿ms
);

26 
	g´Ùeùed
:

27 
FixedSizeSecBlock
<
wÜd32
, 33*4> 
	gm_key
;

30 şas 
	cCRYPTOPP_NO_VTABLE
 
	gEnc
 : 
public
 
Ba£


32 
public
:

33 
ProûssAndXÜBlock
(cÚ¡ 
by‹
 *
šBlock
, cÚ¡ by‹ *
xÜBlock
, by‹ *
outBlock
) const;

36 şas 
	cCRYPTOPP_NO_VTABLE
 
	gDec
 : 
public
 
Ba£


38 
public
:

39 
ProûssAndXÜBlock
(cÚ¡ 
by‹
 *
šBlock
, cÚ¡ by‹ *
xÜBlock
, by‹ *
outBlock
) const;

42 
	gpublic
:

43 
BlockCh”Fš®
<
	tENCRYPTION
, 
	tEnc
> 
	tEnüy±iÚ
;

44 
	gBlockCh”Fš®
<
	tDECRYPTION
, 
	tDec
> 
	tDeüy±iÚ
;

47 
	gS”³Á
::
	tEnüy±iÚ
 
	tS”³ÁEnüy±iÚ
;

48 
	gS”³Á
::
	tDeüy±iÚ
 
	tS”³ÁDeüy±iÚ
;

50 
	gNAMESPACE_END


	@serpentp.h

3 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

6 
	#LT
(
i
,
a
,
b
,
c
,
d
,
e
) {\

7 
a
 = 
	`rÙlFixed
(a, 13); \

8 
c
 = 
	`rÙlFixed
(c, 3); \

9 
d
 = 
	`rÙlFixed
(d ^ 
c
 ^ (
a
 << 3), 7); \

10 
b
 = 
	`rÙlFixed
(b ^ 
a
 ^ 
c
, 1); \

11 
a
 = 
	`rÙlFixed
× ^ 
b
 ^ 
d
, 5); \

12 
c
 = 
	`rÙlFixed
(ø^ 
d
 ^ (
b
 << 7), 22);
	}

	)
}

15 
	#ILT
(
i
,
a
,
b
,
c
,
d
,
e
) {\

16 
c
 = 
	`rÙrFixed
(c, 22); \

17 
a
 = 
	`rÙrFixed
(a, 5); \

18 
c
 ^ğ
d
 ^ (
b
 << 7); \

19 
a
 ^ğ
b
 ^ 
d
; \

20 
b
 = 
	`rÙrFixed
(b, 1); \

21 
d
 = 
	`rÙrFixed
(d, 7è^ 
c
 ^ (
a
 << 3); \

22 
b
 ^ğ
a
 ^ 
c
; \

23 
c
 = 
	`rÙrFixed
(c, 3); \

24 
a
 = 
	`rÙrFixed
×, 13);}

	)

27 
	#befÜeS0
(
f
è
	`f
(0,
a
,
b
,
c
,
d
,
e
)

	)

28 
	#aá”S0
(
f
è
	`f
(1,
b
,
e
,
c
,
a
,
d
)

	)

29 
	#aá”S1
(
f
è
	`f
(2,
c
,
b
,
a
,
e
,
d
)

	)

30 
	#aá”S2
(
f
è
	`f
(3,
a
,
e
,
b
,
d
,
c
)

	)

31 
	#aá”S3
(
f
è
	`f
(4,
e
,
b
,
d
,
c
,
a
)

	)

32 
	#aá”S4
(
f
è
	`f
(5,
b
,
a
,
e
,
c
,
d
)

	)

33 
	#aá”S5
(
f
è
	`f
(6,
a
,
c
,
b
,
e
,
d
)

	)

34 
	#aá”S6
(
f
è
	`f
(7,
a
,
c
,
d
,
b
,
e
)

	)

35 
	#aá”S7
(
f
è
	`f
(8,
d
,
e
,
b
,
a
,
c
)

	)

38 
	#befÜeI7
(
f
è
	`f
(8,
a
,
b
,
c
,
d
,
e
)

	)

39 
	#aá”I7
(
f
è
	`f
(7,
d
,
a
,
b
,
e
,
c
)

	)

40 
	#aá”I6
(
f
è
	`f
(6,
a
,
b
,
c
,
e
,
d
)

	)

41 
	#aá”I5
(
f
è
	`f
(5,
b
,
d
,
e
,
c
,
a
)

	)

42 
	#aá”I4
(
f
è
	`f
(4,
b
,
c
,
e
,
a
,
d
)

	)

43 
	#aá”I3
(
f
è
	`f
(3,
a
,
b
,
e
,
c
,
d
)

	)

44 
	#aá”I2
(
f
è
	`f
(2,
b
,
d
,
e
,
c
,
a
)

	)

45 
	#aá”I1
(
f
è
	`f
(1,
a
,
b
,
c
,
e
,
d
)

	)

46 
	#aá”I0
(
f
è
	`f
(0,
a
,
d
,
b
,
e
,
c
)

	)

51 
	#S0
(
i
, 
r0
, 
r1
, 
r2
, 
r3
, 
r4
) \

53 
r3
 ^ğ
r0
; \

54 
r4
 = 
r1
; \

55 
r1
 &ğ
r3
; \

56 
r4
 ^ğ
r2
; \

57 
r1
 ^ğ
r0
; \

58 
r0
 |ğ
r3
; \

59 
r0
 ^ğ
r4
; \

60 
r4
 ^ğ
r3
; \

61 
r3
 ^ğ
r2
; \

62 
r2
 |ğ
r1
; \

63 
r2
 ^ğ
r4
; \

64 
r4
 = ~r4; \

65 
r4
 |ğ
r1
; \

66 
r1
 ^ğ
r3
; \

67 
r1
 ^ğ
r4
; \

68 
r3
 |ğ
r0
; \

69 
r1
 ^ğ
r3
; \

70 
r4
 ^ğ
r3
; \

71 }

	)

73 
	#I0
(
i
, 
r0
, 
r1
, 
r2
, 
r3
, 
r4
) \

75 
r2
 = ~r2; \

76 
r4
 = 
r1
; \

77 
r1
 |ğ
r0
; \

78 
r4
 = ~r4; \

79 
r1
 ^ğ
r2
; \

80 
r2
 |ğ
r4
; \

81 
r1
 ^ğ
r3
; \

82 
r0
 ^ğ
r4
; \

83 
r2
 ^ğ
r0
; \

84 
r0
 &ğ
r3
; \

85 
r4
 ^ğ
r0
; \

86 
r0
 |ğ
r1
; \

87 
r0
 ^ğ
r2
; \

88 
r3
 ^ğ
r4
; \

89 
r2
 ^ğ
r1
; \

90 
r3
 ^ğ
r0
; \

91 
r3
 ^ğ
r1
; \

92 
r2
 &ğ
r3
; \

93 
r4
 ^ğ
r2
; \

94 }

	)

96 
	#S1
(
i
, 
r0
, 
r1
, 
r2
, 
r3
, 
r4
) \

98 
r0
 = ~r0; \

99 
r2
 = ~r2; \

100 
r4
 = 
r0
; \

101 
r0
 &ğ
r1
; \

102 
r2
 ^ğ
r0
; \

103 
r0
 |ğ
r3
; \

104 
r3
 ^ğ
r2
; \

105 
r1
 ^ğ
r0
; \

106 
r0
 ^ğ
r4
; \

107 
r4
 |ğ
r1
; \

108 
r1
 ^ğ
r3
; \

109 
r2
 |ğ
r0
; \

110 
r2
 &ğ
r4
; \

111 
r0
 ^ğ
r1
; \

112 
r1
 &ğ
r2
; \

113 
r1
 ^ğ
r0
; \

114 
r0
 &ğ
r2
; \

115 
r0
 ^ğ
r4
; \

116 }

	)

118 
	#I1
(
i
, 
r0
, 
r1
, 
r2
, 
r3
, 
r4
) \

120 
r4
 = 
r1
; \

121 
r1
 ^ğ
r3
; \

122 
r3
 &ğ
r1
; \

123 
r4
 ^ğ
r2
; \

124 
r3
 ^ğ
r0
; \

125 
r0
 |ğ
r1
; \

126 
r2
 ^ğ
r3
; \

127 
r0
 ^ğ
r4
; \

128 
r0
 |ğ
r2
; \

129 
r1
 ^ğ
r3
; \

130 
r0
 ^ğ
r1
; \

131 
r1
 |ğ
r3
; \

132 
r1
 ^ğ
r0
; \

133 
r4
 = ~r4; \

134 
r4
 ^ğ
r1
; \

135 
r1
 |ğ
r0
; \

136 
r1
 ^ğ
r0
; \

137 
r1
 |ğ
r4
; \

138 
r3
 ^ğ
r1
; \

139 }

	)

141 
	#S2
(
i
, 
r0
, 
r1
, 
r2
, 
r3
, 
r4
) \

143 
r4
 = 
r0
; \

144 
r0
 &ğ
r2
; \

145 
r0
 ^ğ
r3
; \

146 
r2
 ^ğ
r1
; \

147 
r2
 ^ğ
r0
; \

148 
r3
 |ğ
r4
; \

149 
r3
 ^ğ
r1
; \

150 
r4
 ^ğ
r2
; \

151 
r1
 = 
r3
; \

152 
r3
 |ğ
r4
; \

153 
r3
 ^ğ
r0
; \

154 
r0
 &ğ
r1
; \

155 
r4
 ^ğ
r0
; \

156 
r1
 ^ğ
r3
; \

157 
r1
 ^ğ
r4
; \

158 
r4
 = ~r4; \

159 }

	)

161 
	#I2
(
i
, 
r0
, 
r1
, 
r2
, 
r3
, 
r4
) \

163 
r2
 ^ğ
r3
; \

164 
r3
 ^ğ
r0
; \

165 
r4
 = 
r3
; \

166 
r3
 &ğ
r2
; \

167 
r3
 ^ğ
r1
; \

168 
r1
 |ğ
r2
; \

169 
r1
 ^ğ
r4
; \

170 
r4
 &ğ
r3
; \

171 
r2
 ^ğ
r3
; \

172 
r4
 &ğ
r0
; \

173 
r4
 ^ğ
r2
; \

174 
r2
 &ğ
r1
; \

175 
r2
 |ğ
r0
; \

176 
r3
 = ~r3; \

177 
r2
 ^ğ
r3
; \

178 
r0
 ^ğ
r3
; \

179 
r0
 &ğ
r1
; \

180 
r3
 ^ğ
r4
; \

181 
r3
 ^ğ
r0
; \

182 }

	)

184 
	#S3
(
i
, 
r0
, 
r1
, 
r2
, 
r3
, 
r4
) \

186 
r4
 = 
r0
; \

187 
r0
 |ğ
r3
; \

188 
r3
 ^ğ
r1
; \

189 
r1
 &ğ
r4
; \

190 
r4
 ^ğ
r2
; \

191 
r2
 ^ğ
r3
; \

192 
r3
 &ğ
r0
; \

193 
r4
 |ğ
r1
; \

194 
r3
 ^ğ
r4
; \

195 
r0
 ^ğ
r1
; \

196 
r4
 &ğ
r0
; \

197 
r1
 ^ğ
r3
; \

198 
r4
 ^ğ
r2
; \

199 
r1
 |ğ
r0
; \

200 
r1
 ^ğ
r2
; \

201 
r0
 ^ğ
r3
; \

202 
r2
 = 
r1
; \

203 
r1
 |ğ
r3
; \

204 
r1
 ^ğ
r0
; \

205 }

	)

207 
	#I3
(
i
, 
r0
, 
r1
, 
r2
, 
r3
, 
r4
) \

209 
r4
 = 
r2
; \

210 
r2
 ^ğ
r1
; \

211 
r1
 &ğ
r2
; \

212 
r1
 ^ğ
r0
; \

213 
r0
 &ğ
r4
; \

214 
r4
 ^ğ
r3
; \

215 
r3
 |ğ
r1
; \

216 
r3
 ^ğ
r2
; \

217 
r0
 ^ğ
r4
; \

218 
r2
 ^ğ
r0
; \

219 
r0
 |ğ
r3
; \

220 
r0
 ^ğ
r1
; \

221 
r4
 ^ğ
r2
; \

222 
r2
 &ğ
r3
; \

223 
r1
 |ğ
r3
; \

224 
r1
 ^ğ
r2
; \

225 
r4
 ^ğ
r0
; \

226 
r2
 ^ğ
r4
; \

227 }

	)

229 
	#S4
(
i
, 
r0
, 
r1
, 
r2
, 
r3
, 
r4
) \

231 
r1
 ^ğ
r3
; \

232 
r3
 = ~r3; \

233 
r2
 ^ğ
r3
; \

234 
r3
 ^ğ
r0
; \

235 
r4
 = 
r1
; \

236 
r1
 &ğ
r3
; \

237 
r1
 ^ğ
r2
; \

238 
r4
 ^ğ
r3
; \

239 
r0
 ^ğ
r4
; \

240 
r2
 &ğ
r4
; \

241 
r2
 ^ğ
r0
; \

242 
r0
 &ğ
r1
; \

243 
r3
 ^ğ
r0
; \

244 
r4
 |ğ
r1
; \

245 
r4
 ^ğ
r0
; \

246 
r0
 |ğ
r3
; \

247 
r0
 ^ğ
r2
; \

248 
r2
 &ğ
r3
; \

249 
r0
 = ~r0; \

250 
r4
 ^ğ
r2
; \

251 }

	)

253 
	#I4
(
i
, 
r0
, 
r1
, 
r2
, 
r3
, 
r4
) \

255 
r4
 = 
r2
; \

256 
r2
 &ğ
r3
; \

257 
r2
 ^ğ
r1
; \

258 
r1
 |ğ
r3
; \

259 
r1
 &ğ
r0
; \

260 
r4
 ^ğ
r2
; \

261 
r4
 ^ğ
r1
; \

262 
r1
 &ğ
r2
; \

263 
r0
 = ~r0; \

264 
r3
 ^ğ
r4
; \

265 
r1
 ^ğ
r3
; \

266 
r3
 &ğ
r0
; \

267 
r3
 ^ğ
r2
; \

268 
r0
 ^ğ
r1
; \

269 
r2
 &ğ
r0
; \

270 
r3
 ^ğ
r0
; \

271 
r2
 ^ğ
r4
; \

272 
r2
 |ğ
r3
; \

273 
r3
 ^ğ
r0
; \

274 
r2
 ^ğ
r1
; \

275 }

	)

277 
	#S5
(
i
, 
r0
, 
r1
, 
r2
, 
r3
, 
r4
) \

279 
r0
 ^ğ
r1
; \

280 
r1
 ^ğ
r3
; \

281 
r3
 = ~r3; \

282 
r4
 = 
r1
; \

283 
r1
 &ğ
r0
; \

284 
r2
 ^ğ
r3
; \

285 
r1
 ^ğ
r2
; \

286 
r2
 |ğ
r4
; \

287 
r4
 ^ğ
r3
; \

288 
r3
 &ğ
r1
; \

289 
r3
 ^ğ
r0
; \

290 
r4
 ^ğ
r1
; \

291 
r4
 ^ğ
r2
; \

292 
r2
 ^ğ
r0
; \

293 
r0
 &ğ
r3
; \

294 
r2
 = ~r2; \

295 
r0
 ^ğ
r4
; \

296 
r4
 |ğ
r3
; \

297 
r2
 ^ğ
r4
; \

298 }

	)

300 
	#I5
(
i
, 
r0
, 
r1
, 
r2
, 
r3
, 
r4
) \

302 
r1
 = ~r1; \

303 
r4
 = 
r3
; \

304 
r2
 ^ğ
r1
; \

305 
r3
 |ğ
r0
; \

306 
r3
 ^ğ
r2
; \

307 
r2
 |ğ
r1
; \

308 
r2
 &ğ
r0
; \

309 
r4
 ^ğ
r3
; \

310 
r2
 ^ğ
r4
; \

311 
r4
 |ğ
r0
; \

312 
r4
 ^ğ
r1
; \

313 
r1
 &ğ
r2
; \

314 
r1
 ^ğ
r3
; \

315 
r4
 ^ğ
r2
; \

316 
r3
 &ğ
r4
; \

317 
r4
 ^ğ
r1
; \

318 
r3
 ^ğ
r0
; \

319 
r3
 ^ğ
r4
; \

320 
r4
 = ~r4; \

321 }

	)

323 
	#S6
(
i
, 
r0
, 
r1
, 
r2
, 
r3
, 
r4
) \

325 
r2
 = ~r2; \

326 
r4
 = 
r3
; \

327 
r3
 &ğ
r0
; \

328 
r0
 ^ğ
r4
; \

329 
r3
 ^ğ
r2
; \

330 
r2
 |ğ
r4
; \

331 
r1
 ^ğ
r3
; \

332 
r2
 ^ğ
r0
; \

333 
r0
 |ğ
r1
; \

334 
r2
 ^ğ
r1
; \

335 
r4
 ^ğ
r0
; \

336 
r0
 |ğ
r3
; \

337 
r0
 ^ğ
r2
; \

338 
r4
 ^ğ
r3
; \

339 
r4
 ^ğ
r0
; \

340 
r3
 = ~r3; \

341 
r2
 &ğ
r4
; \

342 
r2
 ^ğ
r3
; \

343 }

	)

345 
	#I6
(
i
, 
r0
, 
r1
, 
r2
, 
r3
, 
r4
) \

347 
r0
 ^ğ
r2
; \

348 
r4
 = 
r2
; \

349 
r2
 &ğ
r0
; \

350 
r4
 ^ğ
r3
; \

351 
r2
 = ~r2; \

352 
r3
 ^ğ
r1
; \

353 
r2
 ^ğ
r3
; \

354 
r4
 |ğ
r0
; \

355 
r0
 ^ğ
r2
; \

356 
r3
 ^ğ
r4
; \

357 
r4
 ^ğ
r1
; \

358 
r1
 &ğ
r3
; \

359 
r1
 ^ğ
r0
; \

360 
r0
 ^ğ
r3
; \

361 
r0
 |ğ
r2
; \

362 
r3
 ^ğ
r1
; \

363 
r4
 ^ğ
r0
; \

364 }

	)

366 
	#S7
(
i
, 
r0
, 
r1
, 
r2
, 
r3
, 
r4
) \

368 
r4
 = 
r2
; \

369 
r2
 &ğ
r1
; \

370 
r2
 ^ğ
r3
; \

371 
r3
 &ğ
r1
; \

372 
r4
 ^ğ
r2
; \

373 
r2
 ^ğ
r1
; \

374 
r1
 ^ğ
r0
; \

375 
r0
 |ğ
r4
; \

376 
r0
 ^ğ
r2
; \

377 
r3
 ^ğ
r1
; \

378 
r2
 ^ğ
r3
; \

379 
r3
 &ğ
r0
; \

380 
r3
 ^ğ
r4
; \

381 
r4
 ^ğ
r2
; \

382 
r2
 &ğ
r0
; \

383 
r4
 = ~r4; \

384 
r2
 ^ğ
r4
; \

385 
r4
 &ğ
r0
; \

386 
r1
 ^ğ
r3
; \

387 
r4
 ^ğ
r1
; \

388 }

	)

390 
	#I7
(
i
, 
r0
, 
r1
, 
r2
, 
r3
, 
r4
) \

392 
r4
 = 
r2
; \

393 
r2
 ^ğ
r0
; \

394 
r0
 &ğ
r3
; \

395 
r2
 = ~r2; \

396 
r4
 |ğ
r3
; \

397 
r3
 ^ğ
r1
; \

398 
r1
 |ğ
r0
; \

399 
r0
 ^ğ
r2
; \

400 
r2
 &ğ
r4
; \

401 
r1
 ^ğ
r2
; \

402 
r2
 ^ğ
r0
; \

403 
r0
 |ğ
r2
; \

404 
r3
 &ğ
r4
; \

405 
r0
 ^ğ
r3
; \

406 
r4
 ^ğ
r1
; \

407 
r3
 ^ğ
r4
; \

408 
r4
 |ğ
r0
; \

409 
r3
 ^ğ
r2
; \

410 
r4
 ^ğ
r2
; \

411 }

	)

414 
	#KX
(
r
, 
a
, 
b
, 
c
, 
d
, 
e
) {\

415 
a
 ^ğ
k
[4 * 
r
 + 0]; \

416 
b
 ^ğ
k
[4 * 
r
 + 1]; \

417 
c
 ^ğ
k
[4 * 
r
 + 2]; \

418 
d
 ^ğ
k
[4 * 
r
 + 3];}

	)

420 
	#LK
(
r
, 
a
, 
b
, 
c
, 
d
, 
e
) {\

421 
a
 = 
k
[(8-
r
)*4 + 0]; \

422 
b
 = 
k
[(8-
r
)*4 + 1]; \

423 
c
 = 
k
[(8-
r
)*4 + 2]; \

424 
d
 = 
k
[(8-
r
)*4 + 3];}

	)

426 
	#SK
(
r
, 
a
, 
b
, 
c
, 
d
, 
e
) {\

427 
k
[(8-
r
)*4 + 4] = 
a
; \

428 
k
[(8-
r
)*4 + 5] = 
b
; \

429 
k
[(8-
r
)*4 + 6] = 
c
; \

430 
k
[(8-
r
)*4 + 7] = 
d
;}

	)

432 
S”³Á_KeyScheduË
(
wÜd32
 *
k
, 
rounds
, cÚ¡ 
by‹
 *
u£rKey
, 
size_t
 
keyËn
);

434 
	gNAMESPACE_END


	@sha.cpp

8 
	~"pch.h
"

10 #iâdeà
CRYPTOPP_IMPORTS


11 #iâdeà
CRYPTOPP_GENERATE_X64_MASM


13 
	~"sha.h
"

14 
	~"misc.h
"

15 
	~"ıu.h
"

17 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

21 
	#blk0
(
i
è(
W
[i] = 
d©a
[i])

	)

22 
	#blk1
(
i
è(
W
[i&15] = 
	`rÙlFixed
(W[(i+13)&15]^W[(i+8)&15]^W[(i+2)&15]^W[i&15],1))

	)

24 
SHA1
::
	$In™S‹
(
HashWÜdTy³
 *
¡©e
)

26 
¡©e
[0] = 0x67452301L;

27 
¡©e
[1] = 0xEFCDAB89L;

28 
¡©e
[2] = 0x98BADCFEL;

29 
¡©e
[3] = 0x10325476L;

30 
¡©e
[4] = 0xC3D2E1F0L;

31 
	}
}

33 
	#f1
(
x
,
y
,
z
è(z^(x&(y^z)))

	)

34 
	#f2
(
x
,
y
,
z
è(x^y^z)

	)

35 
	#f3
(
x
,
y
,
z
è((x&y)|(z&(x|y)))

	)

36 
	#f4
(
x
,
y
,
z
è(x^y^z)

	)

39 
	#R0
(
v
,
w
,
x
,
y
,
z
,
i
èz+=
	`f1
(w,x,y)+
	`blk0
(i)+0x5A827999+
	`rÙlFixed
(v,5);wôÙlFixed(w,30);

	)

40 
	#R1
(
v
,
w
,
x
,
y
,
z
,
i
èz+=
	`f1
(w,x,y)+
	`blk1
(i)+0x5A827999+
	`rÙlFixed
(v,5);wôÙlFixed(w,30);

	)

41 
	#R2
(
v
,
w
,
x
,
y
,
z
,
i
èz+=
	`f2
(w,x,y)+
	`blk1
(i)+0x6ED9EBA1+
	`rÙlFixed
(v,5);wôÙlFixed(w,30);

	)

42 
	#R3
(
v
,
w
,
x
,
y
,
z
,
i
èz+=
	`f3
(w,x,y)+
	`blk1
(i)+0x8F1BBCDC+
	`rÙlFixed
(v,5);wôÙlFixed(w,30);

	)

43 
	#R4
(
v
,
w
,
x
,
y
,
z
,
i
èz+=
	`f4
(w,x,y)+
	`blk1
(i)+0xCA62C1D6+
	`rÙlFixed
(v,5);wôÙlFixed(w,30);

	)

45 
	gSHA1
::
	$T¿nsfÜm
(
wÜd32
 *
¡©e
, cÚ¡ wÜd32 *
d©a
)

47 
wÜd32
 
W
[16];

49 
wÜd32
 
a
 = 
¡©e
[0];

50 
wÜd32
 
b
 = 
¡©e
[1];

51 
wÜd32
 
c
 = 
¡©e
[2];

52 
wÜd32
 
d
 = 
¡©e
[3];

53 
wÜd32
 
e
 = 
¡©e
[4];

55 
	`R0
(
a
,
b
,
c
,
d
,
e
, 0); R0(e,a,b,c,d, 1); R0(d,e,a,b,c, 2); R0(c,d,e,a,b, 3);

56 
	`R0
(
b
,
c
,
d
,
e
,
a
, 4); R0(a,b,c,d,e, 5); R0(e,a,b,c,d, 6); R0(d,e,a,b,c, 7);

57 
	`R0
(
c
,
d
,
e
,
a
,
b
, 8); R0(b,c,d,e,a, 9); R0(a,b,c,d,e,10); R0(e,a,b,c,d,11);

58 
	`R0
(
d
,
e
,
a
,
b
,
c
,12); R0(c,d,e,a,b,13); R0(b,c,d,e,a,14); R0(a,b,c,d,e,15);

59 
	`R1
(
e
,
a
,
b
,
c
,
d
,16); R1(d,e,a,b,c,17); R1(c,d,e,a,b,18); R1(b,c,d,e,a,19);

60 
	`R2
(
a
,
b
,
c
,
d
,
e
,20); R2(e,a,b,c,d,21); R2(d,e,a,b,c,22); R2(c,d,e,a,b,23);

61 
	`R2
(
b
,
c
,
d
,
e
,
a
,24); R2(a,b,c,d,e,25); R2(e,a,b,c,d,26); R2(d,e,a,b,c,27);

62 
	`R2
(
c
,
d
,
e
,
a
,
b
,28); R2(b,c,d,e,a,29); R2(a,b,c,d,e,30); R2(e,a,b,c,d,31);

63 
	`R2
(
d
,
e
,
a
,
b
,
c
,32); R2(c,d,e,a,b,33); R2(b,c,d,e,a,34); R2(a,b,c,d,e,35);

64 
	`R2
(
e
,
a
,
b
,
c
,
d
,36); R2(d,e,a,b,c,37); R2(c,d,e,a,b,38); R2(b,c,d,e,a,39);

65 
	`R3
(
a
,
b
,
c
,
d
,
e
,40); R3(e,a,b,c,d,41); R3(d,e,a,b,c,42); R3(c,d,e,a,b,43);

66 
	`R3
(
b
,
c
,
d
,
e
,
a
,44); R3(a,b,c,d,e,45); R3(e,a,b,c,d,46); R3(d,e,a,b,c,47);

67 
	`R3
(
c
,
d
,
e
,
a
,
b
,48); R3(b,c,d,e,a,49); R3(a,b,c,d,e,50); R3(e,a,b,c,d,51);

68 
	`R3
(
d
,
e
,
a
,
b
,
c
,52); R3(c,d,e,a,b,53); R3(b,c,d,e,a,54); R3(a,b,c,d,e,55);

69 
	`R3
(
e
,
a
,
b
,
c
,
d
,56); R3(d,e,a,b,c,57); R3(c,d,e,a,b,58); R3(b,c,d,e,a,59);

70 
	`R4
(
a
,
b
,
c
,
d
,
e
,60); R4(e,a,b,c,d,61); R4(d,e,a,b,c,62); R4(c,d,e,a,b,63);

71 
	`R4
(
b
,
c
,
d
,
e
,
a
,64); R4(a,b,c,d,e,65); R4(e,a,b,c,d,66); R4(d,e,a,b,c,67);

72 
	`R4
(
c
,
d
,
e
,
a
,
b
,68); R4(b,c,d,e,a,69); R4(a,b,c,d,e,70); R4(e,a,b,c,d,71);

73 
	`R4
(
d
,
e
,
a
,
b
,
c
,72); R4(c,d,e,a,b,73); R4(b,c,d,e,a,74); R4(a,b,c,d,e,75);

74 
	`R4
(
e
,
a
,
b
,
c
,
d
,76); R4(d,e,a,b,c,77); R4(c,d,e,a,b,78); R4(b,c,d,e,a,79);

76 
¡©e
[0] +ğ
a
;

77 
¡©e
[1] +ğ
b
;

78 
¡©e
[2] +ğ
c
;

79 
¡©e
[3] +ğ
d
;

80 
¡©e
[4] +ğ
e
;

81 
	}
}

87 
	gSHA224
::
	$In™S‹
(
HashWÜdTy³
 *
¡©e
)

89 cÚ¡ 
wÜd32
 
s
[8] = {0xc1059ed8, 0x367cd507, 0x3070dd17, 0xf70e5939, 0xffc00b31, 0x68581511, 0x64f98fa7, 0xbefa4fa4};

90 
	`memıy
(
¡©e
, 
s
, (s));

91 
	}
}

93 
	gSHA256
::
	$In™S‹
(
HashWÜdTy³
 *
¡©e
)

95 cÚ¡ 
wÜd32
 
s
[8] = {0x6a09e667, 0xbb67ae85, 0x3c6ef372, 0xa54ff53a, 0x510e527f, 0x9b05688c, 0x1f83d9ab, 0x5be0cd19};

96 
	`memıy
(
¡©e
, 
s
, (s));

97 
	}
}

99 #ià
CRYPTOPP_BOOL_SSE2_ASM_AVAILABLE


100 
	$CRYPTOPP_ALIGN_DATA
(16ècÚ¡ 
wÜd32
 
SHA256_K
[64] 
CRYPTOPP_SECTION_ALIGN16
 = {

102 cÚ¡ 
wÜd32
 
SHA256_K
[64] = {

120 
	}
};

124 #ià
defšed
(
CRYPTOPP_X86_ASM_AVAILABLE
è|| defšed(
CRYPTOPP_GENERATE_X64_MASM
)

126 #´agm¨
w¬nšg
(
di§bË
: 4731)

128 
CRYPTOPP_FASTCALL
 
X86_SHA256_HashBlocks
(
wÜd32
 *
¡©e
, cÚ¡ wÜd32 *
d©a
, 
size_t
 
Ën


129 #ià
defšed
(
_MSC_VER
) && (_MSC_VER == 1200)

134 #ià
defšed
(
_MSC_VER
) && (_MSC_VER == 1200)

135 
AS2
(
mov
 
ecx
, [
¡©e
])

136 
AS2
(
mov
 
edx
, [
d©a
])

139 
	#LOCALS_SIZE
 8*4 + 16*4 + 4*
WORD_SZ


	)

140 
	#H
(
i
è[
BASE
+
	`ASM_MOD
(1024+7-(i),8)*4]

	)

141 
	#G
(
i
è
	`H
(i+1)

	)

142 
	#F
(
i
è
	`H
(i+2)

	)

143 
	#E
(
i
è
	`H
(i+3)

	)

144 
	#D
(
i
è
	`H
(i+4)

	)

145 
	#C
(
i
è
	`H
(i+5)

	)

146 
	#B
(
i
è
	`H
(i+6)

	)

147 
	#A
(
i
è
	`H
(i+7)

	)

148 
	#Wt
(
i
è
BASE
+8*4+
	`ASM_MOD
(1024+15-(i),16)*4

	)

149 
	#Wt_2
(
i
è
	`Wt
((i)-2)

	)

150 
	#Wt_15
(
i
è
	`Wt
((i)-15)

	)

151 
	#Wt_7
(
i
è
	`Wt
((i)-7)

	)

152 
	#K_END
 [
BASE
+8*4+16*4+0*
WORD_SZ
]

	)

153 
	#STATE_SAVE
 [
BASE
+8*4+16*4+1*
WORD_SZ
]

	)

154 
	#DATA_SAVE
 [
BASE
+8*4+16*4+2*
WORD_SZ
]

	)

155 
	#DATA_END
 [
BASE
+8*4+16*4+3*
WORD_SZ
]

	)

156 
	#Kt
(
i
è
	`WORD_REG
(
si
)+(i)*4

	)

157 #ià
CRYPTOPP_BOOL_X86


158 
	#BASE
 
e¥
+4

	)

159 #–ià
defšed
(
__GNUC__
)

160 
	#BASE
 
r8


	)

162 
	#BASE
 
r¥


	)

165 
	#RA0
(
i
, 
edx
, 
edi
) \

166 
	`AS2
Ğ
add
 
edx
, [
	`Kt
(
i
)] )\

167 
	`AS2
Ğ
add
 
edx
, [
	`Wt
(
i
)] )\

168 
	`AS2
Ğ
add
 
edx
, 
	`H
(
i
) )\

169 

	)

170 
	#RA1
(
i
, 
edx
, 
edi
)

	)

172 
	#RB0
(
i
, 
edx
, 
edi
)

	)

174 
	#RB1
(
i
, 
edx
, 
edi
) \

175 
	`AS2
Ğ
mov
 
AS_REG_7d
, [
	`Wt_2
(
i
)] )\

176 
	`AS2
Ğ
mov
 
edi
, [
	`Wt_15
(
i
)])\

177 
	`AS2
Ğ
mov
 
ebx
, 
AS_REG_7d
 )\

178 
	`AS2
Ğ
shr
 
AS_REG_7d
, 10 )\

179 
	`AS2
Ğ
rÜ
 
ebx
, 17 )\

180 
	`AS2
Ğ
xÜ
 
AS_REG_7d
, 
ebx
 )\

181 
	`AS2
Ğ
rÜ
 
ebx
, 2 )\

182 
	`AS2
Ğ
xÜ
 
ebx
, 
AS_REG_7d
 ) \

183 
	`AS2
Ğ
add
 
ebx
, [
	`Wt_7
(
i
)])\

184 
	`AS2
Ğ
mov
 
AS_REG_7d
, 
edi
 )\

185 
	`AS2
Ğ
shr
 
AS_REG_7d
, 3 )\

186 
	`AS2
Ğ
rÜ
 
edi
, 7 )\

187 
	`AS2
Ğ
add
 
ebx
, [
	`Wt
(
i
)]) \

188 
	`AS2
Ğ
xÜ
 
AS_REG_7d
, 
edi
 )\

189 
	`AS2
Ğ
add
 
edx
, [
	`Kt
(
i
)])\

190 
	`AS2
Ğ
rÜ
 
edi
, 11 )\

191 
	`AS2
Ğ
add
 
edx
, 
	`H
(
i
) )\

192 
	`AS2
Ğ
xÜ
 
AS_REG_7d
, 
edi
 ) \

193 
	`AS2
Ğ
add
 
AS_REG_7d
, 
ebx
 ) \

194 
	`AS2
Ğ
mov
 [
	`Wt
(
i
)], 
AS_REG_7d
)\

195 
	`AS2
Ğ
add
 
edx
, 
AS_REG_7d
 )\

196 

	)

197 
	#ROUND
(
i
, 
r
, 
—x
, 
ecx
, 
edi
, 
edx
)\

200 
	`AS2
Ğ
mov
 
edx
, 
	`F
(
i
) )\

201 
	`AS2
Ğ
xÜ
 
edx
, 
	`G
(
i
) )\

202 
	`AS2
Ğ
ªd
 
edx
, 
edi
 )\

203 
	`AS2
Ğ
xÜ
 
edx
, 
	`G
(
i
) ) \

204 
	`AS2
Ğ
mov
 
AS_REG_7d
, 
edi
 )\

205 
	`AS2
Ğ
rÜ
 
edi
, 6 )\

206 
	`AS2
Ğ
rÜ
 
AS_REG_7d
, 25 )\

207 
RA
##
	`r
(
i
, 
edx
, 
edi
 ) \

208 
	`AS2
Ğ
xÜ
 
AS_REG_7d
, 
edi
 )\

209 
	`AS2
Ğ
rÜ
 
edi
, 5 )\

210 
	`AS2
Ğ
xÜ
 
AS_REG_7d
, 
edi
 ) \

211 
	`AS2
Ğ
add
 
edx
, 
AS_REG_7d
 ) \

212 
RB
##
	`r
(
i
, 
edx
, 
edi
 ) \

215 
	`AS2
Ğ
mov
 
ebx
, 
ecx
 )\

216 
	`AS2
Ğ
xÜ
 
ecx
, 
	`B
(
i
) ) \

217 
	`AS2
Ğ
ªd
 
—x
, 
ecx
 )\

218 
	`AS2
Ğ
xÜ
 
—x
, 
	`B
(
i
) ) \

219 
	`AS2
Ğ
mov
 
AS_REG_7d
, 
ebx
 )\

220 
	`AS2
Ğ
rÜ
 
ebx
, 2 )\

221 
	`AS2
Ğ
add
 
—x
, 
edx
 ) \

222 
	`AS2
Ğ
add
 
edx
, 
	`D
(
i
) )\

223 
	`AS2
Ğ
mov
 
	`D
(
i
), 
edx
 )\

224 
	`AS2
Ğ
rÜ
 
AS_REG_7d
, 22 )\

225 
	`AS2
Ğ
xÜ
 
AS_REG_7d
, 
ebx
 )\

226 
	`AS2
Ğ
rÜ
 
ebx
, 11 )\

227 
	`AS2
Ğ
xÜ
 
AS_REG_7d
, 
ebx
 )\

228 
	`AS2
Ğ
add
 
—x
, 
AS_REG_7d
 ) \

229 
	`AS2
Ğ
mov
 
	`H
(
i
), 
—x
 )\

230 

	)

231 
	#SWAP_COPY
(
i
) \

232 
	`AS2
Ğ
mov
 
	`WORD_REG
(
bx
), [WORD_REG(
dx
)+
i
*
WORD_SZ
])\

233 
	`AS1
Ğ
bsw­
 
	`WORD_REG
(
bx
))\

234 
	`AS2
Ğ
mov
 [
	`Wt
(
i
*(1+
CRYPTOPP_BOOL_X64
)+CRYPTOPP_BOOL_X64)], 
	`WORD_REG
(
bx
))

	)

236 #ià
defšed
(
__GNUC__
)

237 #ià
CRYPTOPP_BOOL_X64


238 
	gFixedSizeAligÃdSecBlock
<
	gby‹
, 
	gLOCALS_SIZE
> 
	gwÜk¥aû
;

240 
__asm__
 
	g__vŞ©e__


242 #ià
CRYPTOPP_BOOL_X64


246 #–ià
defšed
(
CRYPTOPP_GENERATE_X64_MASM
)

247 
	gALIGN
 8

248 
X86_SHA256_HashBlocks
 
PROC
 
FRAME


249 
»x_push_»g
 
rsi


250 
push_»g
 
rdi


251 
push_»g
 
rbx


252 
push_»g
 
rbp


253 
®loc_¡ack
(
LOCALS_SIZE
+8)

254 .
’d´Şog


255 
mov
 
	grdi
, 
r8


256 
Ëa
 
	grsi
, [?
SHA256_K
@
Cry±oPP
@@3
QBIB
 + 48*4]

259 #ià
CRYPTOPP_BOOL_X86


260 #iâdeà
__GNUC__


261 
AS2
Ğ
mov
 
edi
, [
Ën
])

262 
AS2
Ğ
Ëa
 
WORD_REG
(
si
), [
SHA256_K
+48*4])

264 #ià!
defšed
(
_MSC_VER
) || (_MSC_VER < 1400)

265 
AS_PUSH_IF86
(
bx
)

268 
AS_PUSH_IF86
(
bp
)

269 
AS2
Ğ
mov
 
ebx
, 
e¥
)

270 
AS2
Ğ
ªd
 
e¥
, -16)

271 
AS2
Ğ
sub
 
WORD_REG
(
¥
), 
LOCALS_SIZE
)

272 
AS_PUSH_IF86
(
bx
)

274 
AS2
Ğ
mov
 
STATE_SAVE
, 
WORD_REG
(
cx
))

275 
AS2
Ğ
mov
 
DATA_SAVE
, 
WORD_REG
(
dx
))

276 
AS2
Ğ
Ëa
 
WORD_REG
(
ax
), [WORD_REG(
di
è+ WORD_REG(
dx
)])

277 
AS2
Ğ
mov
 
DATA_END
, 
WORD_REG
(
ax
))

278 
AS2
Ğ
mov
 
K_END
, 
WORD_REG
(
si
))

280 #ià
CRYPTOPP_BOOL_SSE2_ASM_AVAILABLE


281 #ià
CRYPTOPP_BOOL_X86


282 
AS2
Ğ
‹¡
 
edi
, 1)

283 
ASJ
Ğ
jnz
, 2, 
f
)

284 
AS1
Ğ
dec
 
DWORD
 
PTR
 
K_END
)

286 
AS2
Ğ
movdqa
 
xmm0
, 
XMMWORD_PTR
 [
WORD_REG
(
cx
)+0*16])

287 
AS2
Ğ
movdqa
 
xmm1
, 
XMMWORD_PTR
 [
WORD_REG
(
cx
)+1*16])

290 #ià
CRYPTOPP_BOOL_X86


291 #ià
CRYPTOPP_BOOL_SSE2_ASM_AVAILABLE


292 
ASJ
Ğ
jmp
, 0, 
f
)

294 
ASL
(2)

295 
AS2
Ğ
mov
 
esi
, 
ecx
)

296 
AS2
Ğ
Ëa
 
edi
, 
A
(0))

297 
AS2
Ğ
mov
 
ecx
, 8)

298 
AS1
Ğ
»p
 
movsd
)

299 
AS2
Ğ
mov
 
esi
, 
K_END
)

300 
ASJ
Ğ
jmp
, 3, 
f
)

303 #ià
CRYPTOPP_BOOL_SSE2_ASM_AVAILABLE


304 
ASL
(0)

305 
AS2
Ğ
movdqa
 
E
(0), 
xmm1
)

306 
AS2
Ğ
movdqa
 
A
(0), 
xmm0
)

308 #ià
CRYPTOPP_BOOL_X86


309 
ASL
(3)

311 
AS2
Ğ
sub
 
WORD_REG
(
si
), 48*4)

312 
SWAP_COPY
(0) SWAP_COPY(1) SWAP_COPY(2) SWAP_COPY(3)

313 
SWAP_COPY
(4) SWAP_COPY(5) SWAP_COPY(6) SWAP_COPY(7)

314 #ià
CRYPTOPP_BOOL_X86


315 
SWAP_COPY
(8) SWAP_COPY(9) SWAP_COPY(10) SWAP_COPY(11)

316 
SWAP_COPY
(12) SWAP_COPY(13) SWAP_COPY(14) SWAP_COPY(15)

318 
AS2
Ğ
mov
 
edi
, 
E
(0))

319 
AS2
Ğ
mov
 
—x
, 
B
(0))

320 
AS2
Ğ
xÜ
 
—x
, 
C
(0))

321 
AS2
Ğ
mov
 
ecx
, 
A
(0))

323 
ROUND
(0, 0, 
—x
, 
ecx
, 
edi
, 
edx
)

324 
ROUND
(1, 0, 
ecx
, 
—x
, 
edx
, 
edi
)

325 
ROUND
(2, 0, 
—x
, 
ecx
, 
edi
, 
edx
)

326 
ROUND
(3, 0, 
ecx
, 
—x
, 
edx
, 
edi
)

327 
ROUND
(4, 0, 
—x
, 
ecx
, 
edi
, 
edx
)

328 
ROUND
(5, 0, 
ecx
, 
—x
, 
edx
, 
edi
)

329 
ROUND
(6, 0, 
—x
, 
ecx
, 
edi
, 
edx
)

330 
ROUND
(7, 0, 
ecx
, 
—x
, 
edx
, 
edi
)

331 
ROUND
(8, 0, 
—x
, 
ecx
, 
edi
, 
edx
)

332 
ROUND
(9, 0, 
ecx
, 
—x
, 
edx
, 
edi
)

333 
ROUND
(10, 0, 
—x
, 
ecx
, 
edi
, 
edx
)

334 
ROUND
(11, 0, 
ecx
, 
—x
, 
edx
, 
edi
)

335 
ROUND
(12, 0, 
—x
, 
ecx
, 
edi
, 
edx
)

336 
ROUND
(13, 0, 
ecx
, 
—x
, 
edx
, 
edi
)

337 
ROUND
(14, 0, 
—x
, 
ecx
, 
edi
, 
edx
)

338 
ROUND
(15, 0, 
ecx
, 
—x
, 
edx
, 
edi
)

340 
ASL
(1)

341 
AS2
(
add
 
WORD_REG
(
si
), 4*16)

342 
ROUND
(0, 1, 
—x
, 
ecx
, 
edi
, 
edx
)

343 
ROUND
(1, 1, 
ecx
, 
—x
, 
edx
, 
edi
)

344 
ROUND
(2, 1, 
—x
, 
ecx
, 
edi
, 
edx
)

345 
ROUND
(3, 1, 
ecx
, 
—x
, 
edx
, 
edi
)

346 
ROUND
(4, 1, 
—x
, 
ecx
, 
edi
, 
edx
)

347 
ROUND
(5, 1, 
ecx
, 
—x
, 
edx
, 
edi
)

348 
ROUND
(6, 1, 
—x
, 
ecx
, 
edi
, 
edx
)

349 
ROUND
(7, 1, 
ecx
, 
—x
, 
edx
, 
edi
)

350 
ROUND
(8, 1, 
—x
, 
ecx
, 
edi
, 
edx
)

351 
ROUND
(9, 1, 
ecx
, 
—x
, 
edx
, 
edi
)

352 
ROUND
(10, 1, 
—x
, 
ecx
, 
edi
, 
edx
)

353 
ROUND
(11, 1, 
ecx
, 
—x
, 
edx
, 
edi
)

354 
ROUND
(12, 1, 
—x
, 
ecx
, 
edi
, 
edx
)

355 
ROUND
(13, 1, 
ecx
, 
—x
, 
edx
, 
edi
)

356 
ROUND
(14, 1, 
—x
, 
ecx
, 
edi
, 
edx
)

357 
ROUND
(15, 1, 
ecx
, 
—x
, 
edx
, 
edi
)

358 
AS2
Ğ
cmp
 
WORD_REG
(
si
), 
K_END
)

359 
ASJ
Ğ
jb
, 1, 
b
)

361 
AS2
Ğ
mov
 
WORD_REG
(
dx
), 
DATA_SAVE
)

362 
AS2
Ğ
add
 
WORD_REG
(
dx
), 64)

363 
AS2
Ğ
mov
 
AS_REG_7
, 
STATE_SAVE
)

364 
AS2
Ğ
mov
 
DATA_SAVE
, 
WORD_REG
(
dx
))

366 #ià
CRYPTOPP_BOOL_SSE2_ASM_AVAILABLE


367 #ià
CRYPTOPP_BOOL_X86


368 
AS2
Ğ
‹¡
 
DWORD
 
PTR
 
K_END
, 1)

369 
ASJ
Ğ
jz
, 4, 
f
)

371 
AS2
Ğ
movdqa
 
xmm1
, 
XMMWORD_PTR
 [
AS_REG_7
+1*16])

372 
AS2
Ğ
movdqa
 
xmm0
, 
XMMWORD_PTR
 [
AS_REG_7
+0*16])

373 
AS2
Ğ
·ddd
 
xmm1
, 
E
(0))

374 
AS2
Ğ
·ddd
 
xmm0
, 
A
(0))

375 
AS2
Ğ
movdqa
 [
AS_REG_7
+1*16], 
xmm1
)

376 
AS2
Ğ
movdqa
 [
AS_REG_7
+0*16], 
xmm0
)

377 
AS2
Ğ
cmp
 
WORD_REG
(
dx
), 
DATA_END
)

378 
ASJ
Ğ
jb
, 0, 
b
)

381 #ià
CRYPTOPP_BOOL_X86


382 #ià
CRYPTOPP_BOOL_SSE2_ASM_AVAILABLE


383 
ASJ
Ğ
jmp
, 5, 
f
)

384 
ASL
(4)

386 
AS2
Ğ
add
 [
AS_REG_7
+0*4], 
ecx
)

387 
AS2
Ğ
add
 [
AS_REG_7
+4*4], 
edi
)

388 
AS2
Ğ
mov
 
—x
, 
B
(0))

389 
AS2
Ğ
mov
 
ebx
, 
C
(0))

390 
AS2
Ğ
mov
 
ecx
, 
D
(0))

391 
AS2
Ğ
add
 [
AS_REG_7
+1*4], 
—x
)

392 
AS2
Ğ
add
 [
AS_REG_7
+2*4], 
ebx
)

393 
AS2
Ğ
add
 [
AS_REG_7
+3*4], 
ecx
)

394 
AS2
Ğ
mov
 
—x
, 
F
(0))

395 
AS2
Ğ
mov
 
ebx
, 
G
(0))

396 
AS2
Ğ
mov
 
ecx
, 
H
(0))

397 
AS2
Ğ
add
 [
AS_REG_7
+5*4], 
—x
)

398 
AS2
Ğ
add
 [
AS_REG_7
+6*4], 
ebx
)

399 
AS2
Ğ
add
 [
AS_REG_7
+7*4], 
ecx
)

400 
AS2
Ğ
mov
 
ecx
, 
AS_REG_7d
)

401 
AS2
Ğ
cmp
 
WORD_REG
(
dx
), 
DATA_END
)

402 
ASJ
Ğ
jb
, 2, 
b
)

403 #ià
CRYPTOPP_BOOL_SSE2_ASM_AVAILABLE


404 
ASL
(5)

408 
AS_POP_IF86
(
¥
)

409 
AS_POP_IF86
(
bp
)

410 #ià!
defšed
(
_MSC_VER
) || (_MSC_VER < 1400)

411 
AS_POP_IF86
(
bx
)

414 #ifdeà
CRYPTOPP_GENERATE_X64_MASM


415 
add
 
	gr¥
, 
	gLOCALS_SIZE
+8

416 
pİ
 
rbp


417 
pİ
 
rbx


418 
pİ
 
rdi


419 
pİ
 
rsi


420 
»t


421 
X86_SHA256_HashBlocks
 
	gENDP


424 #ifdeà
__GNUC__


427 : "c" (
¡©e
), "d" (
	gd©a
), "S" (
	gSHA256_K
+48), "D" (
	gËn
)

428 #ià
CRYPTOPP_BOOL_X64


429 , "m" (
	gwÜk¥aû
[0])

432 #ià
CRYPTOPP_BOOL_X64


441 #iâdeà
CRYPTOPP_GENERATE_X64_MASM


443 #ifdeà
CRYPTOPP_X64_MASM_AVAILABLE


445 
CRYPTOPP_FASTCALL
 
X86_SHA256_HashBlocks
(
wÜd32
 *
¡©e
, cÚ¡ wÜd32 *
d©a
, 
size_t
 
Ën
);

449 #ià
defšed
(
CRYPTOPP_X86_ASM_AVAILABLE
è|| defšed(
CRYPTOPP_X64_MASM_AVAILABLE
)

451 
size_t
 
SHA256
::
	$HashMuÉËBlocks
(cÚ¡ 
wÜd32
 *
šput
, 
size_t
 
Ëngth
)

453 
	`X86_SHA256_HashBlocks
(
m_¡©e
, 
šput
, (
Ëngth
&(
	`size_t
(0)-
BLOCKSIZE
)è- !
	`HasSSE2
());

454  
Ëngth
 % 
BLOCKSIZE
;

455 
	}
}

457 
size_t
 
SHA224
::
	$HashMuÉËBlocks
(cÚ¡ 
wÜd32
 *
šput
, 
size_t
 
Ëngth
)

459 
	`X86_SHA256_HashBlocks
(
m_¡©e
, 
šput
, (
Ëngth
&(
	`size_t
(0)-
BLOCKSIZE
)è- !
	`HasSSE2
());

460  
Ëngth
 % 
BLOCKSIZE
;

461 
	}
}

465 
	#blk2
(
i
è(
W
[i&15]+=
	`s1
(W[(i-2)&15])+W[(i-7)&15]+
	`s0
(W[(i-15)&15]))

	)

467 
	#Ch
(
x
,
y
,
z
è(z^(x&(y^z)))

	)

468 
	#Maj
(
x
,
y
,
z
è(y^((x^y)&(y^z)))

	)

470 
	#a
(
i
è
T
[(0-i)&7]

	)

471 
	#b
(
i
è
T
[(1-i)&7]

	)

472 
	#c
(
i
è
T
[(2-i)&7]

	)

473 
	#d
(
i
è
T
[(3-i)&7]

	)

474 
	#e
(
i
è
T
[(4-i)&7]

	)

475 
	#f
(
i
è
T
[(5-i)&7]

	)

476 
	#g
(
i
è
T
[(6-i)&7]

	)

477 
	#h
(
i
è
T
[(7-i)&7]

	)

479 
	#R
(
i
è
	`h
(i)+=
	`S1
(
	`e
(i))+
	`Ch
Ó(i),
	`f
(i),
	`g
(i))+
SHA256_K
[i+
j
]+(j?
	`blk2
(i):
	`blk0
(i));\

480 
	`d
(
i
)+=
	`h
(i);h(i)+=
	`S0
(
	`a
(i))+
	`Maj
×(i),
	`b
(i),
	`c
(i))

	)

483 
	#S0
(
x
è(
	`rÙrFixed
(x,2)^rÙrFixed(x,13)^rÙrFixed(x,22))

	)

484 
	#S1
(
x
è(
	`rÙrFixed
(x,6)^rÙrFixed(x,11)^rÙrFixed(x,25))

	)

485 
	#s0
(
x
è(
	`rÙrFixed
(x,7)^rÙrFixed(x,18)^(x>>3))

	)

486 
	#s1
(
x
è(
	`rÙrFixed
(x,17)^rÙrFixed(x,19)^(x>>10))

	)

488 
	gSHA256
::
	$T¿nsfÜm
(
wÜd32
 *
¡©e
, cÚ¡ wÜd32 *
d©a
)

490 
wÜd32
 
W
[16];

491 #ià
	`defšed
(
CRYPTOPP_X86_ASM_AVAILABLE
è|| defšed(
CRYPTOPP_X64_MASM_AVAILABLE
)

493 
	`By‹Rev”£
(
W
, 
d©a
, 
BLOCKSIZE
);

494 
	`X86_SHA256_HashBlocks
(
¡©e
, 
W
, 
BLOCKSIZE
 - !
	`HasSSE2
());

496 
wÜd32
 
T
[8];

498 
	`memıy
(
T
, 
¡©e
, (T));

500 
j
=0; j<64; j+=16)

502 
	`R
( 0); R( 1); R( 2); R( 3);

503 
	`R
( 4); R( 5); R( 6); R( 7);

504 
	`R
( 8); R( 9); R(10); R(11);

505 
	`R
(12); R(13); R(14); R(15);

508 
¡©e
[0] +ğ
	`a
(0);

509 
¡©e
[1] +ğ
	`b
(0);

510 
¡©e
[2] +ğ
	`c
(0);

511 
¡©e
[3] +ğ
	`d
(0);

512 
¡©e
[4] +ğ
	`e
(0);

513 
¡©e
[5] +ğ
	`f
(0);

514 
¡©e
[6] +ğ
	`g
(0);

515 
¡©e
[7] +ğ
	`h
(0);

517 
	}
}

594 #undeà
S0


595 #undeà
S1


596 #undeà
s0


597 #undeà
s1


598 #undeà
R


602 
	gSHA384
::
	$In™S‹
(
HashWÜdTy³
 *
¡©e
)

604 cÚ¡ 
wÜd64
 
s
[8] = {

605 
	`W64LIT
(0xcbbb9d5dc1059ed8), W64LIT(0x629a292a367cd507),

606 
	`W64LIT
(0x9159015a3070dd17), W64LIT(0x152fecd8f70e5939),

607 
	`W64LIT
(0x67332667ffc00b31), W64LIT(0x8eb44a8768581511),

608 
	`W64LIT
(0xdb0c2e0d64f98fa7), W64LIT(0x47b5481dbefa4fa4)};

609 
	`memıy
(
¡©e
, 
s
, (s));

610 
	}
}

612 
	gSHA512
::
	$In™S‹
(
HashWÜdTy³
 *
¡©e
)

614 cÚ¡ 
wÜd64
 
s
[8] = {

615 
	`W64LIT
(0x6a09e667f3bcc908), W64LIT(0xbb67ae8584caa73b),

616 
	`W64LIT
(0x3c6ef372fe94f82b), W64LIT(0xa54ff53a5f1d36f1),

617 
	`W64LIT
(0x510e527fade682d1), W64LIT(0x9b05688c2b3e6c1f),

618 
	`W64LIT
(0x1f83d9abfb41bd6b), W64LIT(0x5be0cd19137e2179)};

619 
	`memıy
(
¡©e
, 
s
, (s));

620 
	}
}

622 #ià
CRYPTOPP_BOOL_SSE2_ASM_AVAILABLE
 && 
CRYPTOPP_BOOL_X86


623 
	$CRYPTOPP_ALIGN_DATA
(16ècÚ¡ 
wÜd64
 
SHA512_K
[80] 
CRYPTOPP_SECTION_ALIGN16
 = {

625 cÚ¡ 
wÜd64
 
SHA512_K
[80] = {

627 
	`W64LIT
(0x428a2f98d728ae22), W64LIT(0x7137449123ef65cd),

628 
	`W64LIT
(0xb5c0fbcfec4d3b2f), W64LIT(0xe9b5dba58189dbbc),

629 
	`W64LIT
(0x3956c25bf348b538), W64LIT(0x59f111f1b605d019),

630 
	`W64LIT
(0x923f82a4af194f9b), W64LIT(0xab1c5ed5da6d8118),

631 
	`W64LIT
(0xd807aa98a3030242), W64LIT(0x12835b0145706fbe),

632 
	`W64LIT
(0x243185be4ee4b28c), W64LIT(0x550c7dc3d5ffb4e2),

633 
	`W64LIT
(0x72be5d74f27b896f), W64LIT(0x80deb1fe3b1696b1),

634 
	`W64LIT
(0x9bdc06a725c71235), W64LIT(0xc19bf174cf692694),

635 
	`W64LIT
(0xe49b69c19ef14ad2), W64LIT(0xefbe4786384f25e3),

636 
	`W64LIT
(0x0fc19dc68b8cd5b5), W64LIT(0x240ca1cc77ac9c65),

637 
	`W64LIT
(0x2de92c6f592b0275), W64LIT(0x4a7484aa6ea6e483),

638 
	`W64LIT
(0x5cb0a9dcbd41fbd4), W64LIT(0x76f988da831153b5),

639 
	`W64LIT
(0x983e5152ee66dfab), W64LIT(0xa831c66d2db43210),

640 
	`W64LIT
(0xb00327c898fb213f), W64LIT(0xbf597fc7beef0ee4),

641 
	`W64LIT
(0xc6e00bf33da88fc2), W64LIT(0xd5a79147930aa725),

642 
	`W64LIT
(0x06ca6351e003826f), W64LIT(0x142929670a0e6e70),

643 
	`W64LIT
(0x27b70a8546d22ffc), W64LIT(0x2e1b21385c26c926),

644 
	`W64LIT
(0x4d2c6dfc5ac42aed), W64LIT(0x53380d139d95b3df),

645 
	`W64LIT
(0x650a73548baf63de), W64LIT(0x766a0abb3c77b2a8),

646 
	`W64LIT
(0x81c2c92e47edaee6), W64LIT(0x92722c851482353b),

647 
	`W64LIT
(0xa2bfe8a14cf10364), W64LIT(0xa81a664bbc423001),

648 
	`W64LIT
(0xc24b8b70d0f89791), W64LIT(0xc76c51a30654be30),

649 
	`W64LIT
(0xd192e819d6ef5218), W64LIT(0xd69906245565a910),

650 
	`W64LIT
(0xf40e35855771202a), W64LIT(0x106aa07032bbd1b8),

651 
	`W64LIT
(0x19a4c116b8d2d0c8), W64LIT(0x1e376c085141ab53),

652 
	`W64LIT
(0x2748774cdf8eeb99), W64LIT(0x34b0bcb5e19b48a8),

653 
	`W64LIT
(0x391c0cb3c5c95a63), W64LIT(0x4ed8aa4ae3418acb),

654 
	`W64LIT
(0x5b9cca4f7763e373), W64LIT(0x682e6ff3d6b2b8a3),

655 
	`W64LIT
(0x748f82ee5defb2fc), W64LIT(0x78a5636f43172f60),

656 
	`W64LIT
(0x84c87814a1f0ab72), W64LIT(0x8cc702081a6439ec),

657 
	`W64LIT
(0x90befffa23631e28), W64LIT(0xa4506cebde82bde9),

658 
	`W64LIT
(0xbef9a3f7b2c67915), W64LIT(0xc67178f2e372532b),

659 
	`W64LIT
(0xca273eceea26619c), W64LIT(0xd186b8c721c0c207),

660 
	`W64LIT
(0xeada7dd6cde0eb1e), W64LIT(0xf57d4f7fee6ed178),

661 
	`W64LIT
(0x06f067aa72176fba), W64LIT(0x0a637dc5a2c898a6),

662 
	`W64LIT
(0x113f9804bef90dae), W64LIT(0x1b710b35131c471b),

663 
	`W64LIT
(0x28db77f523047d84), W64LIT(0x32caab7b40c72493),

664 
	`W64LIT
(0x3c9ebe0a15c9bebc), W64LIT(0x431d67c49c100d4c),

665 
	`W64LIT
(0x4cc5d4becb3e42b6), W64LIT(0x597f299cfc657e2a),

666 
	`W64LIT
(0x5fcb6fab3ad6faec), W64LIT(0x6c44198c4a475817)

667 
	}
};

669 #ià
CRYPTOPP_BOOL_SSE2_ASM_AVAILABLE
 && 
CRYPTOPP_BOOL_X86


671 
CRYPTOPP_NAKED
 
CRYPTOPP_FASTCALL
 
	$SHA512_SSE2_T¿nsfÜm
(
wÜd64
 *
¡©e
, cÚ¡ wÜd64 *
d©a
)

673 #ifdeà
__GNUC__


674 
__asm__
 
__vŞ©e__


677 
	`AS1
Ğ
push
 
ebx
)

678 
	`AS2
Ğ
mov
 
ebx
, 
—x
)

680 
	`AS1
Ğ
push
 
ebx
)

681 
	`AS1
Ğ
push
 
esi
)

682 
	`AS1
Ğ
push
 
edi
)

683 
	`AS2
Ğ
Ëa
 
ebx
, 
SHA512_K
)

686 
	`AS2
Ğ
mov
 
—x
, 
e¥
)

687 
	`AS2
Ğ
ªd
 
e¥
, 0xfffffff0)

688 
	`AS2
Ğ
sub
 
e¥
, 27*16)

689 
	`AS1
Ğ
push
 
—x
)

690 
	`AS2
Ğ
xÜ
 
—x
,ƒax)

691 
	`AS2
Ğ
Ëa
 
edi
, [
e¥
+4+8*8])

692 
	`AS2
Ğ
Ëa
 
esi
, [
e¥
+4+20*8+8])

694 
	`AS2
Ğ
movdqa
 
xmm0
, [
ecx
+0*16])

695 
	`AS2
Ğ
movdq2q
 
mm4
, 
xmm0
)

696 
	`AS2
Ğ
movdqa
 [
edi
+0*16], 
xmm0
)

697 
	`AS2
Ğ
movdqa
 
xmm0
, [
ecx
+1*16])

698 
	`AS2
Ğ
movdqa
 [
edi
+1*16], 
xmm0
)

699 
	`AS2
Ğ
movdqa
 
xmm0
, [
ecx
+2*16])

700 
	`AS2
Ğ
movdq2q
 
mm5
, 
xmm0
)

701 
	`AS2
Ğ
movdqa
 [
edi
+2*16], 
xmm0
)

702 
	`AS2
Ğ
movdqa
 
xmm0
, [
ecx
+3*16])

703 
	`AS2
Ğ
movdqa
 [
edi
+3*16], 
xmm0
)

704 
	`ASJ
Ğ
jmp
, 0, 
f
)

706 
	#SSE2_S0_S1
(
r
, 
a
, 
b
, 
c
) \

707 
	`AS2
Ğ
movq
 
mm6
, 
r
)\

708 
	`AS2
Ğ
p¤lq
 
r
, 
a
)\

709 
	`AS2
Ğ
movq
 
mm7
, 
r
)\

710 
	`AS2
Ğ
p¦lq
 
mm6
, 64-
c
)\

711 
	`AS2
Ğ
pxÜ
 
mm7
, 
mm6
)\

712 
	`AS2
Ğ
p¤lq
 
r
, 
b
-
a
)\

713 
	`AS2
Ğ
pxÜ
 
mm7
, 
r
)\

714 
	`AS2
Ğ
p¦lq
 
mm6
, 
c
-
b
)\

715 
	`AS2
Ğ
pxÜ
 
mm7
, 
mm6
)\

716 
	`AS2
Ğ
p¤lq
 
r
, 
c
-
b
)\

717 
	`AS2
Ğ
pxÜ
 
r
, 
mm7
)\

718 
	`AS2
Ğ
p¦lq
 
mm6
, 
b
-
a
)\

719 
	`AS2
Ğ
pxÜ
 
r
, 
mm6
)

	)

721 
	#SSE2_s0
(
r
, 
a
, 
b
, 
c
) \

722 
	`AS2
Ğ
movdqa
 
xmm6
, 
r
)\

723 
	`AS2
Ğ
p¤lq
 
r
, 
a
)\

724 
	`AS2
Ğ
movdqa
 
xmm7
, 
r
)\

725 
	`AS2
Ğ
p¦lq
 
xmm6
, 64-
c
)\

726 
	`AS2
Ğ
pxÜ
 
xmm7
, 
xmm6
)\

727 
	`AS2
Ğ
p¤lq
 
r
, 
b
-
a
)\

728 
	`AS2
Ğ
pxÜ
 
xmm7
, 
r
)\

729 
	`AS2
Ğ
p¤lq
 
r
, 
c
-
b
)\

730 
	`AS2
Ğ
pxÜ
 
r
, 
xmm7
)\

731 
	`AS2
Ğ
p¦lq
 
xmm6
, 
c
-
a
)\

732 
	`AS2
Ğ
pxÜ
 
r
, 
xmm6
)

	)

734 
	#SSE2_s1
(
r
, 
a
, 
b
, 
c
) \

735 
	`AS2
Ğ
movdqa
 
xmm6
, 
r
)\

736 
	`AS2
Ğ
p¤lq
 
r
, 
a
)\

737 
	`AS2
Ğ
movdqa
 
xmm7
, 
r
)\

738 
	`AS2
Ğ
p¦lq
 
xmm6
, 64-
c
)\

739 
	`AS2
Ğ
pxÜ
 
xmm7
, 
xmm6
)\

740 
	`AS2
Ğ
p¤lq
 
r
, 
b
-
a
)\

741 
	`AS2
Ğ
pxÜ
 
xmm7
, 
r
)\

742 
	`AS2
Ğ
p¦lq
 
xmm6
, 
c
-
b
)\

743 
	`AS2
Ğ
pxÜ
 
xmm7
, 
xmm6
)\

744 
	`AS2
Ğ
p¤lq
 
r
, 
c
-
b
)\

745 
	`AS2
Ğ
pxÜ
 
r
, 
xmm7
)

	)

747 
	`ASL
(
SHA512_Round
)

749 
	`AS2
Ğ
·ddq
 
mm0
, [
edi
+7*8])

750 
	`AS2
Ğ
movq
 
mm2
, [
edi
+5*8])

751 
	`AS2
Ğ
movq
 
mm3
, [
edi
+6*8])

752 
	`AS2
Ğ
pxÜ
 
mm2
, 
mm3
)

753 
	`AS2
Ğ
·nd
 
mm2
, 
mm5
)

754 
	`SSE2_S0_S1
(
mm5
,14,18,41)

755 
	`AS2
Ğ
pxÜ
 
mm2
, 
mm3
)

756 
	`AS2
Ğ
·ddq
 
mm0
, 
mm2
)

757 
	`AS2
Ğ
·ddq
 
mm5
, 
mm0
)

758 
	`AS2
Ğ
movq
 
mm2
, [
edi
+1*8])

759 
	`AS2
Ğ
movq
 
mm1
, 
mm2
)

760 
	`AS2
Ğ
pÜ
 
mm2
, 
mm4
)

761 
	`AS2
Ğ
·nd
 
mm2
, [
edi
+2*8])

762 
	`AS2
Ğ
·nd
 
mm1
, 
mm4
)

763 
	`AS2
Ğ
pÜ
 
mm1
, 
mm2
)

764 
	`AS2
Ğ
·ddq
 
mm1
, 
mm5
)

765 
	`AS2
Ğ
·ddq
 
mm5
, [
edi
+3*8])

766 
	`AS2
Ğ
movq
 [
edi
+3*8], 
mm5
)

767 
	`AS2
Ğ
movq
 [
edi
+11*8], 
mm5
)

768 
	`SSE2_S0_S1
(
mm4
,28,34,39)

769 
	`AS2
Ğ
·ddq
 
mm4
, 
mm1
)

770 
	`AS2
Ğ
movq
 [
edi
-8], 
mm4
)

771 
	`AS2
Ğ
movq
 [
edi
+7*8], 
mm4
)

772 
	`AS1
Ğ
»t
)

775 
	`ASL
(0)

776 
	`AS2
Ğ
movq
 
mm0
, [
edx
+
—x
*8])

777 
	`AS2
Ğ
movq
 [
esi
+
—x
*8], 
mm0
)

778 
	`AS2
Ğ
movq
 [
esi
+
—x
*8+16*8], 
mm0
)

779 
	`AS2
Ğ
·ddq
 
mm0
, [
ebx
+
—x
*8])

780 
	`ASC
Ğ
ÿÎ
, 
SHA512_Round
)

781 
	`AS1
Ğ
šc
 
—x
)

782 
	`AS2
Ğ
sub
 
edi
, 8)

783 
	`AS2
Ğ
‹¡
 
—x
, 7)

784 
	`ASJ
Ğ
jnz
, 0, 
b
)

785 
	`AS2
Ğ
add
 
edi
, 8*8)

786 
	`AS2
Ğ
cmp
 
—x
, 16)

787 
	`ASJ
Ğ
jÃ
, 0, 
b
)

790 
	`AS2
Ğ
movdqu
 
xmm0
, [
esi
+(16-2)*8])

791 
	`ASL
(1)

793 
	`AS2
Ğ
movdqu
 
xmm3
, [
esi
])

794 
	`AS2
Ğ
·ddq
 
xmm3
, [
esi
+(16-7)*8])

795 
	`AS2
Ğ
movdqa
 
xmm2
, [
esi
+(16-15)*8])

796 
	`SSE2_s1
(
xmm0
, 6, 19, 61)

797 
	`AS2
Ğ
·ddq
 
xmm0
, 
xmm3
)

798 
	`SSE2_s0
(
xmm2
, 1, 7, 8)

799 
	`AS2
Ğ
·ddq
 
xmm0
, 
xmm2
)

800 
	`AS2
Ğ
movdq2q
 
mm0
, 
xmm0
)

801 
	`AS2
Ğ
movhÍs
 
xmm1
, 
xmm0
)

802 
	`AS2
Ğ
·ddq
 
mm0
, [
ebx
+
—x
*8])

803 
	`AS2
Ğ
movÍs
 [
esi
], 
xmm0
)

804 
	`AS2
Ğ
movÍs
 [
esi
+8], 
xmm1
)

805 
	`AS2
Ğ
movÍs
 [
esi
+8*16], 
xmm0
)

806 
	`AS2
Ğ
movÍs
 [
esi
+8*17], 
xmm1
)

808 
	`ASC
Ğ
ÿÎ
, 
SHA512_Round
)

809 
	`AS2
Ğ
sub
 
edi
, 8)

810 
	`AS2
Ğ
movdq2q
 
mm0
, 
xmm1
)

811 
	`AS2
Ğ
·ddq
 
mm0
, [
ebx
+
—x
*8+8])

812 
	`ASC
Ğ
ÿÎ
, 
SHA512_Round
)

814 
	`AS2
Ğ
add
 
esi
, 16)

815 
	`AS2
Ğ
add
 
—x
, 2)

816 
	`AS2
Ğ
sub
 
edi
, 8)

817 
	`AS2
Ğ
‹¡
 
—x
, 7)

818 
	`ASJ
Ğ
jnz
, 1, 
b
)

820 
	`AS2
Ğ
mov
 
esi
, 0xf)

821 
	`AS2
Ğ
ªd
 
esi
, 
—x
)

822 
	`AS2
Ğ
Ëa
 
esi
, [
e¥
+4+20*8+8+esi*8])

823 
	`AS2
Ğ
add
 
edi
, 8*8)

824 
	`AS2
Ğ
cmp
 
—x
, 80)

825 
	`ASJ
Ğ
jÃ
, 1, 
b
)

827 
	#SSE2_CombšeS‹
(
i
) \

828 
	`AS2
Ğ
movdqa
 
xmm0
, [
edi
+
i
*16])\

829 
	`AS2
Ğ
·ddq
 
xmm0
, [
ecx
+
i
*16])\

830 
	`AS2
Ğ
movdqa
 [
ecx
+
i
*16], 
xmm0
)

	)

832 
	`SSE2_CombšeS‹
(0)

833 
	`SSE2_CombšeS‹
(1)

834 
	`SSE2_CombšeS‹
(2)

835 
	`SSE2_CombšeS‹
(3)

837 
	`AS1
Ğ
pİ
 
e¥
)

838 
	`AS1
Ğ
emms
)

840 #ià
	`defšed
(
__GNUC__
)

841 
	`AS1
Ğ
pİ
 
ebx
)

844 : "a" (
SHA512_K
), "c" (
¡©e
), "d" (
d©a
)

848 
	`AS1
Ğ
pİ
 
edi
)

849 
	`AS1
Ğ
pİ
 
esi
)

850 
	`AS1
Ğ
pİ
 
ebx
)

851 
	`AS1
Ğ
»t
)

853 
	}
}

856 
	gSHA512
::
	$T¿nsfÜm
(
wÜd64
 *
¡©e
, cÚ¡ wÜd64 *
d©a
)

858 #ià
CRYPTOPP_BOOL_SSE2_ASM_AVAILABLE
 && 
CRYPTOPP_BOOL_X86


859 ià(
	`HasSSE2
())

861 
	`SHA512_SSE2_T¿nsfÜm
(
¡©e
, 
d©a
);

866 
	#S0
(
x
è(
	`rÙrFixed
(x,28)^rÙrFixed(x,34)^rÙrFixed(x,39))

	)

867 
	#S1
(
x
è(
	`rÙrFixed
(x,14)^rÙrFixed(x,18)^rÙrFixed(x,41))

	)

868 
	#s0
(
x
è(
	`rÙrFixed
(x,1)^rÙrFixed(x,8)^(x>>7))

	)

869 
	#s1
(
x
è(
	`rÙrFixed
(x,19)^rÙrFixed(x,61)^(x>>6))

	)

871 
	#R
(
i
è
	`h
(i)+=
	`S1
(
	`e
(i))+
	`Ch
Ó(i),
	`f
(i),
	`g
(i))+
SHA512_K
[i+
j
]+(j?
	`blk2
(i):
	`blk0
(i));\

872 
	`d
(
i
)+=
	`h
(i);h(i)+=
	`S0
(
	`a
(i))+
	`Maj
×(i),
	`b
(i),
	`c
(i))

	)

874 
wÜd64
 
W
[16];

875 
wÜd64
 
T
[8];

877 
	`memıy
(
T
, 
¡©e
, (T));

879 
j
=0; j<80; j+=16)

881 
	`R
( 0); R( 1); R( 2); R( 3);

882 
	`R
( 4); R( 5); R( 6); R( 7);

883 
	`R
( 8); R( 9); R(10); R(11);

884 
	`R
(12); R(13); R(14); R(15);

887 
¡©e
[0] +ğ
	`a
(0);

888 
¡©e
[1] +ğ
	`b
(0);

889 
¡©e
[2] +ğ
	`c
(0);

890 
¡©e
[3] +ğ
	`d
(0);

891 
¡©e
[4] +ğ
	`e
(0);

892 
¡©e
[5] +ğ
	`f
(0);

893 
¡©e
[6] +ğ
	`g
(0);

894 
¡©e
[7] +ğ
	`h
(0);

895 
	}
}

897 
	gNAMESPACE_END


	@sha.h

1 #iâdeà
CRYPTOPP_SHA_H


2 
	#CRYPTOPP_SHA_H


	)

4 
	~"™”hash.h
"

6 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

9 
şass
 
CRYPTOPP_DLL
 
SHA1
 : 
public
 
I‹¿‹dHashW™hSticT¿nsfÜm
<
wÜd32
, 
BigEndŸn
, 64, 20, SHA1>

11 
public
:

12 
CRYPTOPP_API
 
	`In™S‹
(
HashWÜdTy³
 *
¡©e
);

13 
CRYPTOPP_API
 
	`T¿nsfÜm
(
wÜd32
 *
dige¡
, cÚ¡ wÜd32 *
d©a
);

14 cÚ¡ * 
CRYPTOPP_API
 
	`SticAlgÜ™hmName
() { "SHA-1";}

15 
	}
};

17 
SHA1
 
	tSHA
;

20 
şass
 
CRYPTOPP_DLL
 
	gSHA256
 : 
public
 
I‹¿‹dHashW™hSticT¿nsfÜm
<
wÜd32
, 
	gBigEndŸn
, 64, 32, SHA256, 32, 
	gŒue
>

22 
	gpublic
:

23 #ià
defšed
(
CRYPTOPP_X86_ASM_AVAILABLE
è|| defšed(
CRYPTOPP_X64_MASM_AVAILABLE
)

24 
size_t
 
HashMuÉËBlocks
(cÚ¡ 
wÜd32
 *
šput
, size_ˆ
Ëngth
);

26 
CRYPTOPP_API
 
In™S‹
(
HashWÜdTy³
 *
¡©e
);

27 
CRYPTOPP_API
 
T¿nsfÜm
(
wÜd32
 *
dige¡
, cÚ¡ wÜd32 *
d©a
);

28 cÚ¡ * 
CRYPTOPP_API
 
SticAlgÜ™hmName
() { "SHA-256";}

32 
şass
 
CRYPTOPP_DLL
 
	gSHA224
 : 
public
 
I‹¿‹dHashW™hSticT¿nsfÜm
<
wÜd32
, 
	gBigEndŸn
, 64, 32, SHA224, 28, 
	gŒue
>

34 
	gpublic
:

35 #ià
defšed
(
CRYPTOPP_X86_ASM_AVAILABLE
è|| defšed(
CRYPTOPP_X64_MASM_AVAILABLE
)

36 
size_t
 
HashMuÉËBlocks
(cÚ¡ 
wÜd32
 *
šput
, size_ˆ
Ëngth
);

38 
CRYPTOPP_API
 
In™S‹
(
HashWÜdTy³
 *
¡©e
);

39 
CRYPTOPP_API
 
T¿nsfÜm
(
wÜd32
 *
dige¡
, cÚ¡ wÜd32 *
d©a
è{
	gSHA256
::Transform(digest, data);}

40 cÚ¡ * 
CRYPTOPP_API
 
SticAlgÜ™hmName
() { "SHA-224";}

44 
şass
 
CRYPTOPP_DLL
 
	gSHA512
 : 
public
 
I‹¿‹dHashW™hSticT¿nsfÜm
<
wÜd64
, 
	gBigEndŸn
, 128, 64, SHA512, 64, 
	gCRYPTOPP_BOOL_X86
>

46 
	gpublic
:

47 
CRYPTOPP_API
 
In™S‹
(
HashWÜdTy³
 *
¡©e
);

48 
CRYPTOPP_API
 
T¿nsfÜm
(
wÜd64
 *
dige¡
, cÚ¡ wÜd64 *
d©a
);

49 cÚ¡ * 
CRYPTOPP_API
 
SticAlgÜ™hmName
() { "SHA-512";}

53 
şass
 
CRYPTOPP_DLL
 
	gSHA384
 : 
public
 
I‹¿‹dHashW™hSticT¿nsfÜm
<
wÜd64
, 
	gBigEndŸn
, 128, 64, SHA384, 48, 
	gCRYPTOPP_BOOL_X86
>

55 
	gpublic
:

56 
CRYPTOPP_API
 
In™S‹
(
HashWÜdTy³
 *
¡©e
);

57 
CRYPTOPP_API
 
T¿nsfÜm
(
wÜd64
 *
dige¡
, cÚ¡ wÜd64 *
d©a
è{
	gSHA512
::Transform(digest, data);}

58 cÚ¡ * 
CRYPTOPP_API
 
SticAlgÜ™hmName
() { "SHA-384";}

61 
	gNAMESPACE_END


	@sha3.cpp

17 
	~"pch.h
"

18 
	~"sha3.h
"

20 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

22 cÚ¡ 
wÜd64
 
KecÿkF_RoundCÚ¡ªts
[24] =

24 
	`W64LIT
(0x0000000000000001), W64LIT(0x0000000000008082), W64LIT(0x800000000000808a),

25 
	`W64LIT
(0x8000000080008000), W64LIT(0x000000000000808b), W64LIT(0x0000000080000001),

26 
	`W64LIT
(0x8000000080008081), W64LIT(0x8000000000008009), W64LIT(0x000000000000008a),

27 
	`W64LIT
(0x0000000000000088), W64LIT(0x0000000080008009), W64LIT(0x000000008000000a),

28 
	`W64LIT
(0x000000008000808b), W64LIT(0x800000000000008b), W64LIT(0x8000000000008089),

29 
	`W64LIT
(0x8000000000008003), W64LIT(0x8000000000008002), W64LIT(0x8000000000000080),

30 
	`W64LIT
(0x000000000000800a), W64LIT(0x800000008000000a), W64LIT(0x8000000080008081),

31 
	`W64LIT
(0x8000000000008080), W64LIT(0x0000000080000001), W64LIT(0x8000000080008008)

32 
	}
};

34 
	$KecÿkF1600
(
wÜd64
 *
¡©e
)

37 
wÜd64
 
Aba
, 
Abe
, 
Abi
, 
Abo
, 
Abu
;

38 
wÜd64
 
Aga
, 
Age
, 
Agi
, 
Ago
, 
Agu
;

39 
wÜd64
 
Aka
, 
Ake
, 
Aki
, 
Ako
, 
Aku
;

40 
wÜd64
 
Ama
, 
Ame
, 
Ami
, 
Amo
, 
Amu
;

41 
wÜd64
 
A§
, 
A£
, 
Asi
, 
Aso
, 
Asu
;

42 
wÜd64
 
BCa
, 
BCe
, 
BCi
, 
BCo
, 
BCu
;

43 
wÜd64
 
Da
, 
De
, 
Di
, 
Do
, 
Du
;

44 
wÜd64
 
Eba
, 
Ebe
, 
Ebi
, 
Ebo
, 
Ebu
;

45 
wÜd64
 
Ega
, 
Ege
, 
Egi
, 
Ego
, 
Egu
;

46 
wÜd64
 
Eka
, 
Eke
, 
Eki
, 
Eko
, 
Eku
;

47 
wÜd64
 
Ema
, 
Eme
, 
Emi
, 
Emo
, 
Emu
;

48 
wÜd64
 
E§
, 
E£
, 
Esi
, 
Eso
, 
Esu
;

51 
BlockG‘AndPut
<
	twÜd64
, 
	tL™eEndŸn
, 
	tŒue
,rue> 
	tBlock
;

52 
Block
::
	`G‘
(
¡©e
)(
Aba
)(
Abe
)(
Abi
)(
Abo
)(
Abu
)(
Aga
)(
Age
)(
Agi
)(
Ago
)(
Agu
)(
Aka
)(
Ake
)(
Aki
)(
Ako
)(
Aku
)(
Ama
)(
Ame
)(
Ami
)(
Amo
)(
Amu
)(
A§
)(
A£
)(
Asi
)(
Aso
)(
Asu
);

54  
round
 = 0;„ound < 24;„ound += 2 )

57 
BCa
 = 
Aba
^
Aga
^
Aka
^
Ama
^
A§
;

58 
BCe
 = 
Abe
^
Age
^
Ake
^
Ame
^
A£
;

59 
BCi
 = 
Abi
^
Agi
^
Aki
^
Ami
^
Asi
;

60 
BCo
 = 
Abo
^
Ago
^
Ako
^
Amo
^
Aso
;

61 
BCu
 = 
Abu
^
Agu
^
Aku
^
Amu
^
Asu
;

64 
Da
 = 
BCu
^
	`rÙlFixed
(
BCe
, 1);

65 
De
 = 
BCa
^
	`rÙlFixed
(
BCi
, 1);

66 
Di
 = 
BCe
^
	`rÙlFixed
(
BCo
, 1);

67 
Do
 = 
BCi
^
	`rÙlFixed
(
BCu
, 1);

68 
Du
 = 
BCo
^
	`rÙlFixed
(
BCa
, 1);

70 
Aba
 ^ğ
Da
;

71 
BCa
 = 
Aba
;

72 
Age
 ^ğ
De
;

73 
BCe
 = 
	`rÙlFixed
(
Age
, 44);

74 
Aki
 ^ğ
Di
;

75 
BCi
 = 
	`rÙlFixed
(
Aki
, 43);

76 
Amo
 ^ğ
Do
;

77 
BCo
 = 
	`rÙlFixed
(
Amo
, 21);

78 
Asu
 ^ğ
Du
;

79 
BCu
 = 
	`rÙlFixed
(
Asu
, 14);

80 
Eba
 = 
BCa
 ^((~
BCe
)& 
BCi
 );

81 
Eba
 ^ğ(
wÜd64
)
KecÿkF_RoundCÚ¡ªts
[
round
];

82 
Ebe
 = 
BCe
 ^((~
BCi
)& 
BCo
 );

83 
Ebi
 = 
BCi
 ^((~
BCo
)& 
BCu
 );

84 
Ebo
 = 
BCo
 ^((~
BCu
)& 
BCa
 );

85 
Ebu
 = 
BCu
 ^((~
BCa
)& 
BCe
 );

87 
Abo
 ^ğ
Do
;

88 
BCa
 = 
	`rÙlFixed
(
Abo
, 28);

89 
Agu
 ^ğ
Du
;

90 
BCe
 = 
	`rÙlFixed
(
Agu
, 20);

91 
Aka
 ^ğ
Da
;

92 
BCi
 = 
	`rÙlFixed
(
Aka
, 3);

93 
Ame
 ^ğ
De
;

94 
BCo
 = 
	`rÙlFixed
(
Ame
, 45);

95 
Asi
 ^ğ
Di
;

96 
BCu
 = 
	`rÙlFixed
(
Asi
, 61);

97 
Ega
 = 
BCa
 ^((~
BCe
)& 
BCi
 );

98 
Ege
 = 
BCe
 ^((~
BCi
)& 
BCo
 );

99 
Egi
 = 
BCi
 ^((~
BCo
)& 
BCu
 );

100 
Ego
 = 
BCo
 ^((~
BCu
)& 
BCa
 );

101 
Egu
 = 
BCu
 ^((~
BCa
)& 
BCe
 );

103 
Abe
 ^ğ
De
;

104 
BCa
 = 
	`rÙlFixed
(
Abe
, 1);

105 
Agi
 ^ğ
Di
;

106 
BCe
 = 
	`rÙlFixed
(
Agi
, 6);

107 
Ako
 ^ğ
Do
;

108 
BCi
 = 
	`rÙlFixed
(
Ako
, 25);

109 
Amu
 ^ğ
Du
;

110 
BCo
 = 
	`rÙlFixed
(
Amu
, 8);

111 
A§
 ^ğ
Da
;

112 
BCu
 = 
	`rÙlFixed
(
A§
, 18);

113 
Eka
 = 
BCa
 ^((~
BCe
)& 
BCi
 );

114 
Eke
 = 
BCe
 ^((~
BCi
)& 
BCo
 );

115 
Eki
 = 
BCi
 ^((~
BCo
)& 
BCu
 );

116 
Eko
 = 
BCo
 ^((~
BCu
)& 
BCa
 );

117 
Eku
 = 
BCu
 ^((~
BCa
)& 
BCe
 );

119 
Abu
 ^ğ
Du
;

120 
BCa
 = 
	`rÙlFixed
(
Abu
, 27);

121 
Aga
 ^ğ
Da
;

122 
BCe
 = 
	`rÙlFixed
(
Aga
, 36);

123 
Ake
 ^ğ
De
;

124 
BCi
 = 
	`rÙlFixed
(
Ake
, 10);

125 
Ami
 ^ğ
Di
;

126 
BCo
 = 
	`rÙlFixed
(
Ami
, 15);

127 
Aso
 ^ğ
Do
;

128 
BCu
 = 
	`rÙlFixed
(
Aso
, 56);

129 
Ema
 = 
BCa
 ^((~
BCe
)& 
BCi
 );

130 
Eme
 = 
BCe
 ^((~
BCi
)& 
BCo
 );

131 
Emi
 = 
BCi
 ^((~
BCo
)& 
BCu
 );

132 
Emo
 = 
BCo
 ^((~
BCu
)& 
BCa
 );

133 
Emu
 = 
BCu
 ^((~
BCa
)& 
BCe
 );

135 
Abi
 ^ğ
Di
;

136 
BCa
 = 
	`rÙlFixed
(
Abi
, 62);

137 
Ago
 ^ğ
Do
;

138 
BCe
 = 
	`rÙlFixed
(
Ago
, 55);

139 
Aku
 ^ğ
Du
;

140 
BCi
 = 
	`rÙlFixed
(
Aku
, 39);

141 
Ama
 ^ğ
Da
;

142 
BCo
 = 
	`rÙlFixed
(
Ama
, 41);

143 
A£
 ^ğ
De
;

144 
BCu
 = 
	`rÙlFixed
(
A£
, 2);

145 
E§
 = 
BCa
 ^((~
BCe
)& 
BCi
 );

146 
E£
 = 
BCe
 ^((~
BCi
)& 
BCo
 );

147 
Esi
 = 
BCi
 ^((~
BCo
)& 
BCu
 );

148 
Eso
 = 
BCo
 ^((~
BCu
)& 
BCa
 );

149 
Esu
 = 
BCu
 ^((~
BCa
)& 
BCe
 );

152 
BCa
 = 
Eba
^
Ega
^
Eka
^
Ema
^
E§
;

153 
BCe
 = 
Ebe
^
Ege
^
Eke
^
Eme
^
E£
;

154 
BCi
 = 
Ebi
^
Egi
^
Eki
^
Emi
^
Esi
;

155 
BCo
 = 
Ebo
^
Ego
^
Eko
^
Emo
^
Eso
;

156 
BCu
 = 
Ebu
^
Egu
^
Eku
^
Emu
^
Esu
;

159 
Da
 = 
BCu
^
	`rÙlFixed
(
BCe
, 1);

160 
De
 = 
BCa
^
	`rÙlFixed
(
BCi
, 1);

161 
Di
 = 
BCe
^
	`rÙlFixed
(
BCo
, 1);

162 
Do
 = 
BCi
^
	`rÙlFixed
(
BCu
, 1);

163 
Du
 = 
BCo
^
	`rÙlFixed
(
BCa
, 1);

165 
Eba
 ^ğ
Da
;

166 
BCa
 = 
Eba
;

167 
Ege
 ^ğ
De
;

168 
BCe
 = 
	`rÙlFixed
(
Ege
, 44);

169 
Eki
 ^ğ
Di
;

170 
BCi
 = 
	`rÙlFixed
(
Eki
, 43);

171 
Emo
 ^ğ
Do
;

172 
BCo
 = 
	`rÙlFixed
(
Emo
, 21);

173 
Esu
 ^ğ
Du
;

174 
BCu
 = 
	`rÙlFixed
(
Esu
, 14);

175 
Aba
 = 
BCa
 ^((~
BCe
)& 
BCi
 );

176 
Aba
 ^ğ(
wÜd64
)
KecÿkF_RoundCÚ¡ªts
[
round
+1];

177 
Abe
 = 
BCe
 ^((~
BCi
)& 
BCo
 );

178 
Abi
 = 
BCi
 ^((~
BCo
)& 
BCu
 );

179 
Abo
 = 
BCo
 ^((~
BCu
)& 
BCa
 );

180 
Abu
 = 
BCu
 ^((~
BCa
)& 
BCe
 );

182 
Ebo
 ^ğ
Do
;

183 
BCa
 = 
	`rÙlFixed
(
Ebo
, 28);

184 
Egu
 ^ğ
Du
;

185 
BCe
 = 
	`rÙlFixed
(
Egu
, 20);

186 
Eka
 ^ğ
Da
;

187 
BCi
 = 
	`rÙlFixed
(
Eka
, 3);

188 
Eme
 ^ğ
De
;

189 
BCo
 = 
	`rÙlFixed
(
Eme
, 45);

190 
Esi
 ^ğ
Di
;

191 
BCu
 = 
	`rÙlFixed
(
Esi
, 61);

192 
Aga
 = 
BCa
 ^((~
BCe
)& 
BCi
 );

193 
Age
 = 
BCe
 ^((~
BCi
)& 
BCo
 );

194 
Agi
 = 
BCi
 ^((~
BCo
)& 
BCu
 );

195 
Ago
 = 
BCo
 ^((~
BCu
)& 
BCa
 );

196 
Agu
 = 
BCu
 ^((~
BCa
)& 
BCe
 );

198 
Ebe
 ^ğ
De
;

199 
BCa
 = 
	`rÙlFixed
(
Ebe
, 1);

200 
Egi
 ^ğ
Di
;

201 
BCe
 = 
	`rÙlFixed
(
Egi
, 6);

202 
Eko
 ^ğ
Do
;

203 
BCi
 = 
	`rÙlFixed
(
Eko
, 25);

204 
Emu
 ^ğ
Du
;

205 
BCo
 = 
	`rÙlFixed
(
Emu
, 8);

206 
E§
 ^ğ
Da
;

207 
BCu
 = 
	`rÙlFixed
(
E§
, 18);

208 
Aka
 = 
BCa
 ^((~
BCe
)& 
BCi
 );

209 
Ake
 = 
BCe
 ^((~
BCi
)& 
BCo
 );

210 
Aki
 = 
BCi
 ^((~
BCo
)& 
BCu
 );

211 
Ako
 = 
BCo
 ^((~
BCu
)& 
BCa
 );

212 
Aku
 = 
BCu
 ^((~
BCa
)& 
BCe
 );

214 
Ebu
 ^ğ
Du
;

215 
BCa
 = 
	`rÙlFixed
(
Ebu
, 27);

216 
Ega
 ^ğ
Da
;

217 
BCe
 = 
	`rÙlFixed
(
Ega
, 36);

218 
Eke
 ^ğ
De
;

219 
BCi
 = 
	`rÙlFixed
(
Eke
, 10);

220 
Emi
 ^ğ
Di
;

221 
BCo
 = 
	`rÙlFixed
(
Emi
, 15);

222 
Eso
 ^ğ
Do
;

223 
BCu
 = 
	`rÙlFixed
(
Eso
, 56);

224 
Ama
 = 
BCa
 ^((~
BCe
)& 
BCi
 );

225 
Ame
 = 
BCe
 ^((~
BCi
)& 
BCo
 );

226 
Ami
 = 
BCi
 ^((~
BCo
)& 
BCu
 );

227 
Amo
 = 
BCo
 ^((~
BCu
)& 
BCa
 );

228 
Amu
 = 
BCu
 ^((~
BCa
)& 
BCe
 );

230 
Ebi
 ^ğ
Di
;

231 
BCa
 = 
	`rÙlFixed
(
Ebi
, 62);

232 
Ego
 ^ğ
Do
;

233 
BCe
 = 
	`rÙlFixed
(
Ego
, 55);

234 
Eku
 ^ğ
Du
;

235 
BCi
 = 
	`rÙlFixed
(
Eku
, 39);

236 
Ema
 ^ğ
Da
;

237 
BCo
 = 
	`rÙlFixed
(
Ema
, 41);

238 
E£
 ^ğ
De
;

239 
BCu
 = 
	`rÙlFixed
(
E£
, 2);

240 
A§
 = 
BCa
 ^((~
BCe
)& 
BCi
 );

241 
A£
 = 
BCe
 ^((~
BCi
)& 
BCo
 );

242 
Asi
 = 
BCi
 ^((~
BCo
)& 
BCu
 );

243 
Aso
 = 
BCo
 ^((~
BCu
)& 
BCa
 );

244 
Asu
 = 
BCu
 ^((~
BCa
)& 
BCe
 );

248 
Block
::
	`Put
(
NULL
, 
¡©e
)(
Aba
)(
Abe
)(
Abi
)(
Abo
)(
Abu
)(
Aga
)(
Age
)(
Agi
)(
Ago
)(
Agu
)(
Aka
)(
Ake
)(
Aki
)(
Ako
)(
Aku
)(
Ama
)(
Ame
)(
Ami
)(
Amo
)(
Amu
)(
A§
)(
A£
)(
Asi
)(
Aso
)(
Asu
);

250 
	}
}

252 
	gSHA3
::
	$Upd©e
(cÚ¡ 
by‹
 *
šput
, 
size_t
 
Ëngth
)

254 
size_t
 
¥aûLeá
;

255 
Ëngth
 >ğ(
¥aûLeá
 = 
	`r
(è- 
m_couÁ”
))

257 
	`xÜbuf
(
m_¡©e
.
	`By‹PŒ
(è+ 
m_couÁ”
, 
šput
, 
¥aûLeá
);

258 
	`KecÿkF1600
(
m_¡©e
);

259 
šput
 +ğ
¥aûLeá
;

260 
Ëngth
 -ğ
¥aûLeá
;

261 
m_couÁ”
 = 0;

264 
	`xÜbuf
(
m_¡©e
.
	`By‹PŒ
(è+ 
m_couÁ”
, 
šput
, 
Ëngth
);

265 
m_couÁ”
 +ğ()
Ëngth
;

266 
	}
}

268 
	gSHA3
::
	$Re¡¬t
()

270 
	`mem£t
(
m_¡©e
, 0, m_¡©e.
	`SizeInBy‹s
());

271 
m_couÁ”
 = 0;

272 
	}
}

274 
	gSHA3
::
	$Trunÿ‹dFš®
(
by‹
 *
hash
, 
size_t
 
size
)

276 
	`ThrowIfInv®idTrunÿ‹dSize
(
size
);

277 
m_¡©e
.
	`By‹PŒ
()[
m_couÁ”
] ^= 1;

278 
m_¡©e
.
	`By‹PŒ
()[
	`r
()-1] ^= 0x80;

279 
	`KecÿkF1600
(
m_¡©e
);

280 
	`memıy
(
hash
, 
m_¡©e
, 
size
);

281 
	`Re¡¬t
();

282 
	}
}

284 
	gNAMESPACE_END


	@sha3.h

3 #iâdeà
CRYPTOPP_SHA3_H


4 
	#CRYPTOPP_SHA3_H


	)

6 
	~"üy±lib.h
"

7 
	~"£cblock.h
"

9 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

12 şas 
	cSHA3
 : 
public
 
HashT¿nsfÜm©iÚ


14 
public
:

15 
	$SHA3
(
dige¡Size
è: 
	$m_dige¡Size
(
dige¡Size
è{
	`Re¡¬t
();}

16 
	$Dige¡Size
(ècÚ¡ { 
m_dige¡Size
;
	}
}

17 
	g¡d
::
¡ršg
 
	$AlgÜ™hmName
(ècÚ¡ { "SHA-3-" + 
	`IÁToSŒšg
(
m_dige¡Size
*8);
	}
}

18 
	$O±im®D©aAlignm’t
(ècÚ¡ { 
G‘Alignm’tOf
<
wÜd64
>();
	}
}

20 
Upd©e
(cÚ¡ 
by‹
 *
šput
, 
size_t
 
Ëngth
);

21 
Re¡¬t
();

22 
Trunÿ‹dFš®
(
by‹
 *
hash
, 
size_t
 
size
);

24 
	g´Ùeùed
:

25 
šlše
 
	$r
(ècÚ¡ { 200 - 2 * 
m_dige¡Size
;
	}
}

27 
	gFixedSizeSecBlock
<
	gwÜd64
, 25> 
	gm_¡©e
;

28 
	gm_dige¡Size
, 
	gm_couÁ”
;

31 şas 
	cSHA3_224
 : 
public
 
SHA3


33 
public
:

34 
	$CRYPTOPP_CONSTANT
(
DIGESTSIZE
 = 28)

35 
	$SHA3_224
(è: 
	$SHA3
(
DIGESTSIZE
) {}

36 cÚ¡ * 
	$SticAlgÜ™hmName
(è{ "SHA-3-224";
	}
}

39 şas 
	cSHA3_256
 : 
public
 
SHA3


41 
public
:

42 
	$CRYPTOPP_CONSTANT
(
DIGESTSIZE
 = 32)

43 
	$SHA3_256
(è: 
	$SHA3
(
DIGESTSIZE
) {}

44 cÚ¡ * 
	$SticAlgÜ™hmName
(è{ "SHA-3-256";
	}
}

47 şas 
	cSHA3_384
 : 
public
 
SHA3


49 
public
:

50 
	$CRYPTOPP_CONSTANT
(
DIGESTSIZE
 = 48)

51 
	$SHA3_384
(è: 
	$SHA3
(
DIGESTSIZE
) {}

52 cÚ¡ * 
	$SticAlgÜ™hmName
(è{ "SHA-3-384";
	}
}

55 şas 
	cSHA3_512
 : 
public
 
SHA3


57 
public
:

58 
	$CRYPTOPP_CONSTANT
(
DIGESTSIZE
 = 64)

59 
	$SHA3_512
(è: 
	$SHA3
(
DIGESTSIZE
) {}

60 cÚ¡ * 
	$SticAlgÜ™hmName
(è{ "SHA-3-512";
	}
}

63 
	gNAMESPACE_END


	@shacal2.cpp

8 
	~"pch.h
"

9 
	~"shaÿl2.h
"

10 
	~"misc.h
"

12 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

16 
	#S0
(
x
è(
	`rÙrFixed
(x,2)^rÙrFixed(x,13)^rÙrFixed(x,22))

	)

17 
	#S1
(
x
è(
	`rÙrFixed
(x,6)^rÙrFixed(x,11)^rÙrFixed(x,25))

	)

18 
	#s0
(
x
è(
	`rÙrFixed
(x,7)^rÙrFixed(x,18)^(x>>3))

	)

19 
	#s1
(
x
è(
	`rÙrFixed
(x,17)^rÙrFixed(x,19)^(x>>10))

	)

21 
	#Ch
(
x
,
y
,
z
è(z^(x&(y^z)))

	)

22 
	#Maj
(
x
,
y
,
z
è((x&y)|(z&(x|y)))

	)

26 
	#R
(
a
,
b
,
c
,
d
,
e
,
f
,
g
,
h
,
k
) \

27 
h
+=
	`S1
(
e
)+
	`Ch
Ó,
f
,
g
)+*
k
++;
d
+=h;h+=
	`S0
(
a
)+
	`Maj
×,
b
,
c
);

	)

31 
	#P
(
a
,
b
,
c
,
d
,
e
,
f
,
g
,
h
,
k
) \

32 
h
-=
	`S0
(
a
)+
	`Maj
×,
b
,
c
);
d
-=h;h-=
	`S1
(
e
)+
	`Ch
Ó,
f
,
g
)+*--
k
;

	)

34 
SHACAL2
::
Ba£
::
	$UncheckedS‘Key
(cÚ¡ 
by‹
 *
u£rKey
, 
keyËn
, cÚ¡ 
NameV®uePaœs
 &)

36 
	`As£¹V®idKeyL’gth
(
keyËn
);

38 
wÜd32
 *
rk
 = 
m_key
;

39 
i
;

41 
	`G‘U£rKey
(
BIG_ENDIAN_ORDER
, 
rk
, 
m_key
.
	`size
(), 
u£rKey
, 
keyËn
);

42 
i
 = 0; i < 48; i++, 
rk
++)

44 
rk
[16] =„k[0] + 
	`s0
Ôk[1]è+„k[9] + 
	`s1
(rk[14]);

45 
rk
[0] +ğ
K
[
i
];

47 
i
 = 48; i < 64; i++, 
rk
++)

49 
rk
[0] +ğ
K
[
i
];

51 
	}
}

53 
	gBlockG‘AndPut
<
	twÜd32
, 
	tBigEndŸn
> 
	tBlock
;

55 
	gSHACAL2
::
Enc
::
	$ProûssAndXÜBlock
(cÚ¡ 
by‹
 *
šBlock
, cÚ¡ by‹ *
xÜBlock
, by‹ *
outBlock
) const

57 
wÜd32
 
a
, 
b
, 
c
, 
d
, 
e
, 
f
, 
g
, 
h
;

58 cÚ¡ 
wÜd32
 *
rk
 = 
m_key
;

63 
Block
::
	`G‘
(
šBlock
)(
a
)(
b
)(
c
)(
d
)(
e
)(
f
)(
g
)(
h
);

68 
j
=0; j<64; j+=8)

70 
	`R
(
a
,
b
,
c
,
d
,
e
,
f
,
g
,
h
,
rk
);

71 
	`R
(
h
,
a
,
b
,
c
,
d
,
e
,
f
,
g
,
rk
);

72 
	`R
(
g
,
h
,
a
,
b
,
c
,
d
,
e
,
f
,
rk
);

73 
	`R
(
f
,
g
,
h
,
a
,
b
,
c
,
d
,
e
,
rk
);

74 
	`R
(
e
,
f
,
g
,
h
,
a
,
b
,
c
,
d
,
rk
);

75 
	`R
(
d
,
e
,
f
,
g
,
h
,
a
,
b
,
c
,
rk
);

76 
	`R
(
c
,
d
,
e
,
f
,
g
,
h
,
a
,
b
,
rk
);

77 
	`R
(
b
,
c
,
d
,
e
,
f
,
g
,
h
,
a
,
rk
);

84 
Block
::
	`Put
(
xÜBlock
, 
outBlock
)(
a
)(
b
)(
c
)(
d
)(
e
)(
f
)(
g
)(
h
);

85 
	}
}

87 
	gSHACAL2
::
Dec
::
	$ProûssAndXÜBlock
(cÚ¡ 
by‹
 *
šBlock
, cÚ¡ by‹ *
xÜBlock
, by‹ *
outBlock
) const

89 
wÜd32
 
a
, 
b
, 
c
, 
d
, 
e
, 
f
, 
g
, 
h
;

90 cÚ¡ 
wÜd32
 *
rk
 = 
m_key
 + 64;

95 
Block
::
	`G‘
(
šBlock
)(
a
)(
b
)(
c
)(
d
)(
e
)(
f
)(
g
)(
h
);

100 
j
=0; j<64; j+=8)

102 
	`P
(
b
,
c
,
d
,
e
,
f
,
g
,
h
,
a
,
rk
);

103 
	`P
(
c
,
d
,
e
,
f
,
g
,
h
,
a
,
b
,
rk
);

104 
	`P
(
d
,
e
,
f
,
g
,
h
,
a
,
b
,
c
,
rk
);

105 
	`P
(
e
,
f
,
g
,
h
,
a
,
b
,
c
,
d
,
rk
);

106 
	`P
(
f
,
g
,
h
,
a
,
b
,
c
,
d
,
e
,
rk
);

107 
	`P
(
g
,
h
,
a
,
b
,
c
,
d
,
e
,
f
,
rk
);

108 
	`P
(
h
,
a
,
b
,
c
,
d
,
e
,
f
,
g
,
rk
);

109 
	`P
(
a
,
b
,
c
,
d
,
e
,
f
,
g
,
h
,
rk
);

116 
Block
::
	`Put
(
xÜBlock
, 
outBlock
)(
a
)(
b
)(
c
)(
d
)(
e
)(
f
)(
g
)(
h
);

117 
	}
}

120 cÚ¡ 
wÜd32
 
	gSHACAL2
::
Ba£
::
K
[64] =

140 
	gNAMESPACE_END


	@shacal2.h

1 #iâdeà
CRYPTOPP_SHACAL2_H


2 
	#CRYPTOPP_SHACAL2_H


	)

7 
	~"£ckey.h
"

8 
	~"£cblock.h
"

10 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

13 
SHACAL2_Info
 : 
public
 
FixedBlockSize
<32>,…ubliø
V¬ŸbËKeyL’gth
<16, 16, 64>

15 cÚ¡ *
	`SticAlgÜ™hmName
() { "SHACAL-2";}

16 
	}
};

19 
şass
 
	gSHACAL2
 : 
public
 
SHACAL2_Info
,…ubliø
	gBlockCh”Docum’tiÚ


21 
şass
 
CRYPTOPP_NO_VTABLE
 
	gBa£
 : 
public
 
BlockCh”Im¶
<
SHACAL2_Info
>

23 
public
:

24 
UncheckedS‘Key
(cÚ¡ 
by‹
 *
u£rKey
, 
Ëngth
, cÚ¡ 
NameV®uePaœs
 &
·¿ms
);

26 
	g´Ùeùed
:

27 
FixedSizeSecBlock
<
wÜd32
, 64> 
	gm_key
;

29 cÚ¡ 
wÜd32
 
	gK
[64];

32 şas 
	cCRYPTOPP_NO_VTABLE
 
	gEnc
 : 
public
 
Ba£


34 
public
:

35 
ProûssAndXÜBlock
(cÚ¡ 
by‹
 *
šBlock
, cÚ¡ by‹ *
xÜBlock
, by‹ *
outBlock
) const;

38 şas 
	cCRYPTOPP_NO_VTABLE
 
	gDec
 : 
public
 
Ba£


40 
public
:

41 
ProûssAndXÜBlock
(cÚ¡ 
by‹
 *
šBlock
, cÚ¡ by‹ *
xÜBlock
, by‹ *
outBlock
) const;

44 
	gpublic
:

45 
BlockCh”Fš®
<
	tENCRYPTION
, 
	tEnc
> 
	tEnüy±iÚ
;

46 
	gBlockCh”Fš®
<
	tDECRYPTION
, 
	tDec
> 
	tDeüy±iÚ
;

49 
	gSHACAL2
::
	tEnüy±iÚ
 
	tSHACAL2Enüy±iÚ
;

50 
	gSHACAL2
::
	tDeüy±iÚ
 
	tSHACAL2Deüy±iÚ
;

52 
	gNAMESPACE_END


	@shark.cpp

3 
	~"pch.h
"

4 
	~"sh¬k.h
"

5 
	~"misc.h
"

6 
	~"modes.h
"

7 
	~"gf256.h
"

9 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

11 
wÜd64
 
	$SHARKT¿nsfÜm
(
wÜd64
 
a
)

13 cÚ¡ 
by‹
 
iG
[8][8] = {

24 
wÜd64
 
»suÉ
=0;

25 
GF256
 
	`gf256
(0xf5);

26 
i
=0; i<8; i++)

27 
j
=0; j<8; j++)

28 
»suÉ
 ^ğ
	`wÜd64
(
gf256
.
	`MuÉly
(
iG
[
i
][
j
], 
GF256
::
	`EËm’t
(
a
>>(56-8*j)))) << (56-8*i);

29  
»suÉ
;

30 
	}
}

32 
	gSHARK
::
Ba£
::
	$UncheckedS‘Key
(cÚ¡ 
by‹
 *
key
, 
keyL’
, cÚ¡ 
NameV®uePaœs
 &
·¿ms
)

34 
	`As£¹V®idKeyL’gth
(
keyL’
);

36 
m_rounds
 = 
	`G‘RoundsAndThrowIfInv®id
(
·¿ms
, 
this
);

37 
m_roundKeys
.
	`New
(
m_rounds
+1);

40 
i
=0; i<(
m_rounds
+1)*8; i++)

41 ((
by‹
 *)
m_roundKeys
.
	`begš
())[
i
] = 
key
[i%
keyL’
];

43 
SHARK
::
Enüy±iÚ
 
e
;

44 
e
.
	`In™FÜKeyS‘up
();

45 
by‹
 
IV
[8] = {0,0,0,0,0,0,0,0};

46 
CFB_Mode_Ex‹º®Ch”
::
Enüy±iÚ
 
	`cfb
(
e
, 
IV
);

48 
cfb
.
	`ProûssSŒšg
((
by‹
 *)
m_roundKeys
.
	`begš
(), (
m_rounds
+1)*8);

50 
	`CÚd™iÚ®By‹Rev”£
(
BIG_ENDIAN_ORDER
, 
m_roundKeys
.
	`begš
(), m_roundKeys.begš(), (
m_rounds
+1)*8);

52 
m_roundKeys
[
m_rounds
] = 
	`SHARKT¿nsfÜm
(m_roundKeys[m_rounds]);

54 ià(!
	`IsFÜw¬dT¿nsfÜm©iÚ
())

56 
i
;

59 
i
=0; i<
m_rounds
/2; i++)

60 
¡d
::
	`sw­
(
m_roundKeys
[
i
], m_roundKeys[
m_rounds
-i]);

62 
i
=1; i<
m_rounds
; i++)

63 
m_roundKeys
[
i
] = 
	`SHARKT¿nsfÜm
(m_roundKeys[i]);

66 #ifdeà
IS_LITTLE_ENDIAN


67 
m_roundKeys
[0] = 
	`By‹Rev”£
(m_roundKeys[0]);

68 
m_roundKeys
[
m_rounds
] = 
	`By‹Rev”£
(m_roundKeys[m_rounds]);

70 
	}
}

73 
	gSHARK
::
Enc
::
	$In™FÜKeyS‘up
()

75 
m_rounds
 = 
DEFAULT_ROUNDS
;

76 
m_roundKeys
.
	`New
(
DEFAULT_ROUNDS
+1);

78 
i
=0; i<
DEFAULT_ROUNDS
; i++)

79 
m_roundKeys
[
i
] = 
cbox
[0][i];

81 
m_roundKeys
[
DEFAULT_ROUNDS
] = 
	`SHARKT¿nsfÜm
(
cbox
[0][DEFAULT_ROUNDS]);

83 #ifdeà
IS_LITTLE_ENDIAN


84 
m_roundKeys
[0] = 
	`By‹Rev”£
(m_roundKeys[0]);

85 
m_roundKeys
[
m_rounds
] = 
	`By‹Rev”£
(m_roundKeys[m_rounds]);

87 
	}
}

89 
wÜd64
 
	tA¼ayOf256WÜd64s
[256];

91 
	g‹m¶©e
 <cÚ¡ 
by‹
 *
	gsbox
, cÚ¡ 
A¼ayOf256WÜd64s
 *
	gcbox
>

92 
	sSh¬kProûssAndXÜBlock
{

93 
šlše
 
Sh¬kProûssAndXÜBlock
(cÚ¡ 
wÜd64
 *
roundKeys
, 
rounds
, cÚ¡ 
by‹
 *
šBlock
, cÚ¡ by‹ *
xÜBlock
, by‹ *
outBlock
)

95 
wÜd64
 
	mtmp
 = *(wÜd64 *)
šBlock
 ^ 
roundKeys
[0];

97 
By‹Ord”
 
	mÜd”
 = 
G‘N©iveBy‹Ord”
();

98 
	mtmp
 = 
cbox
[0][
G‘By‹
(
Üd”
, 
tmp
, 0)] ^ 
	mcbox
[1][GetByte(order,mp, 1)]

99 ^ 
	mcbox
[2][
G‘By‹
(
Üd”
, 
tmp
, 2)] ^ cbox[3][GetByte(order,mp, 3)]

100 ^ 
	mcbox
[4][
G‘By‹
(
Üd”
, 
tmp
, 4)] ^ cbox[5][GetByte(order,mp, 5)]

101 ^ 
	mcbox
[6][
G‘By‹
(
Üd”
, 
tmp
, 6)] ^ cbox[7][GetByte(order,mp, 7)]

102 ^ 
	mroundKeys
[1];

104 
	mi
=2; i<
	mrounds
; i++)

106 
	mtmp
 = 
cbox
[0][
GETBYTE
(
tmp
, 7)] ^ 
	mcbox
[1][GETBYTE(tmp, 6)]

107 ^ 
	mcbox
[2][
GETBYTE
(
tmp
, 5)] ^ cbox[3][GETBYTE(tmp, 4)]

108 ^ 
	mcbox
[4][
GETBYTE
(
tmp
, 3)] ^ cbox[5][GETBYTE(tmp, 2)]

109 ^ 
	mcbox
[6][
GETBYTE
(
tmp
, 1)] ^ cbox[7][GETBYTE(tmp, 0)]

110 ^ 
	mroundKeys
[
i
];

113 
	mPutBlock
<
	mby‹
, 
	mBigEndŸn
>(
	mxÜBlock
, 
	moutBlock
)

114 (
	msbox
[
GETBYTE
(
tmp
, 7)])

115 (
	msbox
[
GETBYTE
(
tmp
, 6)])

116 (
	msbox
[
GETBYTE
(
tmp
, 5)])

117 (
	msbox
[
GETBYTE
(
tmp
, 4)])

118 (
	msbox
[
GETBYTE
(
tmp
, 3)])

119 (
	msbox
[
GETBYTE
(
tmp
, 2)])

120 (
	msbox
[
GETBYTE
(
tmp
, 1)])

121 (
	msbox
[
GETBYTE
(
tmp
, 0)]);

123 *(
	mwÜd64
 *)
	moutBlock
 ^ğ
roundKeys
[
rounds
];

126 
	gSHARK
::
Enc
::
	$ProûssAndXÜBlock
(cÚ¡ 
by‹
 *
šBlock
, cÚ¡ by‹ *
xÜBlock
, by‹ *
outBlock
) const

128 
Sh¬kProûssAndXÜBlock
<
sbox
, 
cbox
>(
m_roundKeys
, 
m_rounds
, 
šBlock
, 
xÜBlock
, 
outBlock
);

129 
	}
}

131 
	gSHARK
::
Dec
::
	$ProûssAndXÜBlock
(cÚ¡ 
by‹
 *
šBlock
, cÚ¡ by‹ *
xÜBlock
, by‹ *
outBlock
) const

133 
Sh¬kProûssAndXÜBlock
<
sbox
, 
cbox
>(
m_roundKeys
, 
m_rounds
, 
šBlock
, 
xÜBlock
, 
outBlock
);

134 
	}
}

136 
	gNAMESPACE_END


	@shark.h

1 #iâdeà
CRYPTOPP_SHARK_H


2 
	#CRYPTOPP_SHARK_H


	)

7 
	~"cÚfig.h
"

8 
	~"£ckey.h
"

9 
	~"£cblock.h
"

11 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

14 
SHARK_Info
 : 
public
 
FixedBlockSize
<8>,…ubliø
V¬ŸbËKeyL’gth
<16, 1, 16>,…ubliø
V¬ŸbËRounds
<6, 2>

16 cÚ¡ *
	`SticAlgÜ™hmName
() { "SHARK-E";}

17 
	}
};

20 
şass
 
	gSHARK
 : 
public
 
SHARK_Info
,…ubliø
	gBlockCh”Docum’tiÚ


22 
şass
 
CRYPTOPP_NO_VTABLE
 
	gBa£
 : 
public
 
BlockCh”Im¶
<
SHARK_Info
>

24 
public
:

25 
UncheckedS‘Key
(cÚ¡ 
by‹
 *
key
, 
Ëngth
, cÚ¡ 
NameV®uePaœs
 &
·¿m
);

27 
	g´Ùeùed
:

28 
m_rounds
;

29 
	gSecBlock
<
	gwÜd64
> 
	gm_roundKeys
;

32 şas 
	cCRYPTOPP_NO_VTABLE
 
	gEnc
 : 
public
 
Ba£


34 
public
:

35 
ProûssAndXÜBlock
(cÚ¡ 
by‹
 *
šBlock
, cÚ¡ by‹ *
xÜBlock
, by‹ *
outBlock
) const;

38 
In™FÜKeyS‘up
();

40 
	g´iv©e
:

41 cÚ¡ 
by‹
 
sbox
[256];

42 cÚ¡ 
wÜd64
 
	gcbox
[8][256];

45 şas 
	cCRYPTOPP_NO_VTABLE
 
	gDec
 : 
public
 
Ba£


47 
public
:

48 
ProûssAndXÜBlock
(cÚ¡ 
by‹
 *
šBlock
, cÚ¡ by‹ *
xÜBlock
, by‹ *
outBlock
) const;

50 
	g´iv©e
:

51 cÚ¡ 
by‹
 
sbox
[256];

52 cÚ¡ 
wÜd64
 
	gcbox
[8][256];

55 
	gpublic
:

56 
BlockCh”Fš®
<
	tENCRYPTION
, 
	tEnc
> 
	tEnüy±iÚ
;

57 
	gBlockCh”Fš®
<
	tDECRYPTION
, 
	tDec
> 
	tDeüy±iÚ
;

60 
	gSHARK
::
	tEnüy±iÚ
 
	tSHARKEnüy±iÚ
;

61 
	gSHARK
::
	tDeüy±iÚ
 
	tSHARKDeüy±iÚ
;

63 
	gNAMESPACE_END


	@sharkbox.cpp

1 
	~"pch.h
"

2 
	~"sh¬k.h
"

4 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

6 cÚ¡ 
by‹
 
SHARK
::
Enc
::
sbox
[256] = {

23 
	}
};

25 cÚ¡ 
by‹
 
	gSHARK
::
Dec
::
sbox
[256] = {

44 cÚ¡ 
wÜd64
 
	gSHARK
::
Enc
::
cbox
[8][256] = {

46 
W64LIT
(0x060d838f16f3a365),

47 
W64LIT
(0xa68857ee5cae56f6),

48 
W64LIT
(0xebf516353c2c4d89),

49 
W64LIT
(0x652174be88e85bdc),

50 
W64LIT
(0x0d4e9a8086c17921),

51 
W64LIT
(0x27ba7d33cffa58a1),

52 
W64LIT
(0x88d9e104a237b530),

53 
W64LIT
(0x693b8755a4fbe816),

54 
W64LIT
(0xdac9591826b254a0),

55 
W64LIT
(0x45c2e369fb336af3),

56 
W64LIT
(0xa96e1fb87b3e4ef4),

57 
W64LIT
(0xb7578f1435eb7ef0),

58 
W64LIT
(0x839af80b32056f74),

59 
W64LIT
(0xae37f55cc71f277a),

60 
W64LIT
(0xa4208538fdff37d5),

61 
W64LIT
(0x35991e74ad3cdb6f),

62 
W64LIT
(0xba191594b32a07d1),

63 
W64LIT
(0x5344d1772e572b7b),

64 
W64LIT
(0xe7efe5de103ffe43),

65 
W64LIT
(0xa3796fdc41de5e5b),

66 
W64LIT
(0x2cf9643c5fc882e5),

67 
W64LIT
(0xffdbf6fd48196d22),

68 
W64LIT
(0x33949dfbbbcf780a),

69 
W64LIT
(0x7d15679dd0cec8bd),

70 
W64LIT
(0x5f5e229c024498b1),

71 
W64LIT
(0x1223634762c683ce),

72 
W64LIT
(0xdcc4da973041f7c5),

73 
W64LIT
(0x0b43190f9032da44),

74 
W64LIT
(0xc05598eddfc5a6e2),

75 
W64LIT
(0x9e5fd31a7753f4b8),

76 
W64LIT
(0x9afa8243c0f136fe),

77 
W64LIT
(0xcc4f6b06f3d61528),

78 
W64LIT
(0xdf38612a3bc25c0d),

79 
W64LIT
(0x43cf60e6edc0c996),

80 
W64LIT
(0xcfb3d0bbf855bee0),

81 
W64LIT
(0x96e071a8ece28534),

82 
W64LIT
(0x21b7febcd909fbc4),

83 
W64LIT
(0x8ed4628bb4c41655),

84 
W64LIT
(0x30682646b04cd3c2),

85 
W64LIT
(0xb5ff5dc294ba1fd3),

86 
W64LIT
(0x75aac52f4b7fb931),

87 
W64LIT
(0xe809ad8837afe641),

88 
W64LIT
(0x0eb2213d8d42d2e9),

89 
W64LIT
(0x9852509561a057dd),

90 
W64LIT
(0xaa92a40570bde53c),

91 
W64LIT
(0x7b18e412c63d6bd8),

92 
W64LIT
(0xa7dc3e85f67c9c1d),

93 
W64LIT
(0xd8618bce87e33583),

94 
W64LIT
(0xe34ab487a79d3c05),

95 
W64LIT
(0x20e397d773db312f),

96 
W64LIT
(0x05f138321d7008ad),

97 
W64LIT
(0x17d25b757fb68b63),

98 
W64LIT
(0x8a7133d20366d413),

99 
W64LIT
(0x0000000000000000),

100 
W64LIT
(0xeaa17f5e96fe8762),

101 
W64LIT
(0xc101f18675176c09),

102 
W64LIT
(0xbebc44cd0488c597),

103 
W64LIT
(0xdb9d30738c609e4b),

104 
W64LIT
(0xabc6cd6eda6f2fd7),

105 
W64LIT
(0x5aaf1aae1f34901c),

106 
W64LIT
(0xb00e65f089ca177e),

107 
W64LIT
(0xd47b7825abf08649),

108 
W64LIT
(0x924520f15b404772),

109 
W64LIT
(0x1686321ed5644188),

110 
W64LIT
(0x618425e73f4a999a),

111 
W64LIT
(0xe21eddec0d4ff6ee),

112 
W64LIT
(0xd787c398a0732d81),

113 
W64LIT
(0x1f6df9c7e407faef),

114 
W64LIT
(0x79b036c4676c0afb),

115 
W64LIT
(0x0fe6485627901802),

116 
W64LIT
(0x9cf701ccd602959b),

117 
W64LIT
(0xbfe82da6ae5a0f7c),

118 
W64LIT
(0x990639fecb729d36),

119 
W64LIT
(0xca42e889e525b64d),

120 
W64LIT
(0xb3f2de4d8249bcb6),

121 
W64LIT
(0x4033db5be643625e),

122 
W64LIT
(0x4167b2304c91a8b5),

123 
W64LIT
(0x108bb191c397e2ed),

124 
W64LIT
(0x1834132358269361),

125 
W64LIT
(0x541d3b93927642f5),

126 
W64LIT
(0x90edf227fa112651),

127 
W64LIT
(0x1dc52b1145569bcc),

128 
W64LIT
(0xe6bb8cb5baed34a8),

129 
W64LIT
(0xd276fbaabd03252c),

130 
W64LIT
(0x313c4f2d1a9e1929),

131 
W64LIT
(0xfd73242be9480c01),

132 
W64LIT
(0x9baeeb286a23fc15),

133 
W64LIT
(0xc9be5334eea61d85),

134 
W64LIT
(0xc70c720963e4cf6c),

135 
W64LIT
(0x3eda077b3d0e012b),

136 
W64LIT
(0x97b418c346304fdf),

137 
W64LIT
(0x32c0f490111db2e1),

138 
W64LIT
(0x2ba08ed8e3e9eb6b),

139 
W64LIT
(0x8b255ab9a9b41ef8),

140 
W64LIT
(0x91b99b4c50c3ecba),

141 
W64LIT
(0xfe8f9f96e2cba7c9),

142 
W64LIT
(0x3a7f56228aacc36d),

143 
W64LIT
(0xb15a0c9b2318dd95),

144 
W64LIT
(0x5953a11314b73bd4),

145 
W64LIT
(0xf3c10516640adee8),

146 
W64LIT
(0xedf895ba2adfeeec),

147 
W64LIT
(0xadcb4ee1cc9c8cb2),

148 
W64LIT
(0xde6c0841911096e6),

149 
W64LIT
(0x84c312ef8e2406fa),

150 
W64LIT
(0xa83a76d3d1ec841f),

151 
W64LIT
(0x1c91427aef845127),

152 
W64LIT
(0x3665a5c9a6bf70a7),

153 
W64LIT
(0xf6303d24797ad645),

154 
W64LIT
(0xcd1b026d5904dfc3),

155 
W64LIT
(0x1bc8a89e53a538a9),

156 
W64LIT
(0x7ee9dc20db4d6375),

157 
W64LIT
(0x51ec03a18f064a58),

158 
W64LIT
(0xc4f0c9b4686764a4),

159 
W64LIT
(0xdd90b3fc9a933d2e),

160 
W64LIT
(0x7a4c8d796cefa133),

161 
W64LIT
(0x73a746a05d8c1a54),

162 
W64LIT
(0x0759eae4bc21698e),

163 
W64LIT
(0xc8ea3a5f4474d76e),

164 
W64LIT
(0x38d784f42bfda24e),

165 
W64LIT
(0x231f2c6a78589ae7),

166 
W64LIT
(0xc3a92350d4460d2a),

167 
W64LIT
(0x72f32fcbf75ed0bf),

168 
W64LIT
(0xbd40ff700f0b6e5f),

169 
W64LIT
(0x157a89a3dee7ea40),

170 
W64LIT
(0x873fa95285a7ad32),

171 
W64LIT
(0x4d7d41db60821b7f),

172 
W64LIT
(0x1e3990ac4ed53004),

173 
W64LIT
(0x0a1770643ae010af),

174 
W64LIT
(0x9311499af1928d99),

175 
W64LIT
(0x64751dd5223a9137),

176 
W64LIT
(0xfa2acecf5569658f),

177 
W64LIT
(0x7c410ef67a1c0256),

178 
W64LIT
(0x56b5e945332723d6),

179 
W64LIT
(0x6f3604dab2084b73),

180 
W64LIT
(0xe95dc4e39d7d2caa),

181 
W64LIT
(0x13770a2cc8144925),

182 
W64LIT
(0xbc14961ba5d9a4b4),

183 
W64LIT
(0xb9e5ae29b8a9ac19),

184 
W64LIT
(0xf169d7c0c55bbfcb),

185 
W64LIT
(0x2446c68ec479f369),

186 
W64LIT
(0x806643b63986c4bc),

187 
W64LIT
(0x7fbdb54b719fa99e),

188 
W64LIT
(0x04a55159b7a2c246),

189 
W64LIT
(0xee042e07215c4524),

190 
W64LIT
(0x5bfb73c5b5e65af7),

191 
W64LIT
(0x0c1af3eb2c13b3ca),

192 
W64LIT
(0xa22d06b7eb0c94b0),

193 
W64LIT
(0xb8b1c742127b66f2),

194 
W64LIT
(0x285c3565e86a40a3),

195 
W64LIT
(0x3b2b3f49207e0986),

196 
W64LIT
(0x3c72d5ad9c5f6008),

197 
W64LIT
(0x770217f9ea2ed812),

198 
W64LIT
(0xfc274d40439ac6ea),

199 
W64LIT
(0x4fd5930dc1d37a5c),

200 
W64LIT
(0x2e51b6eafe99e3c6),

201 
W64LIT
(0x6b93558305aa8935),

202 
W64LIT
(0x19607a48f2f4598a),

203 
W64LIT
(0x08bfa2b29bb1718c),

204 
W64LIT
(0x3f8e6e1097dccbc0),

205 
W64LIT
(0x3983ed9f812f68a5),

206 
W64LIT
(0xac9f278a664e4659),

207 
W64LIT
(0x82ce916098d7a59f),

208 
W64LIT
(0xc2fd4a3b7e94c7c1),

209 
W64LIT
(0x66ddcf03836bf014),

210 
W64LIT
(0xe1e2665106cc5d26),

211 
W64LIT
(0x74feac44e1ad73da),

212 
W64LIT
(0x8d28d936bf47bd9d),

213 
W64LIT
(0x62789e5a34c93252),

214 
W64LIT
(0x81322add93540e57),

215 
W64LIT
(0xcb1681e24ff77ca6),

216 
W64LIT
(0x2512afe56eab3982),

217 
W64LIT
(0xd18a4017b6808ee4),

218 
W64LIT
(0x705bfd1d560fb19c),

219 
W64LIT
(0x4b70c2547671b81a),

220 
W64LIT
(0x49d81082d720d939),

221 
W64LIT
(0xe0b60f3aac1e97cd),

222 
W64LIT
(0x4e81fa666b01b0b7),

223 
W64LIT
(0x951cca15e7612efc),

224 
W64LIT
(0x463e58d4f0b0c13b),

225 
W64LIT
(0x632cf7319e1bf8b9),

226 
W64LIT
(0x5ca2992109c73379),

227 
W64LIT
(0xf764544fd3a81cae),

228 
W64LIT
(0x6ac73ce8af7843de),

229 
W64LIT
(0x9f0bba71dd813e53),

230 
W64LIT
(0x85977b8424f6cc11),

231 
W64LIT
(0x5807c878be65f13f),

232 
W64LIT
(0x686fee3e0e2922fd),

233 
W64LIT
(0x78e45fafcdbec010),

234 
W64LIT
(0x6ccabf67b98be0bb),

235 
W64LIT
(0x11dfd8fa69452806),

236 
W64LIT
(0xcee7b9d05287740b),

237 
W64LIT
(0x50b86aca25d480b3),

238 
W64LIT
(0x5df6f04aa315f992),

239 
W64LIT
(0x5e0a4bf7a896525a),

240 
W64LIT
(0x03fcbbbd0b83abc8),

241 
W64LIT
(0x8f800be01e16dcbe),

242 
W64LIT
(0xd32292c117d1efc7),

243 
W64LIT
(0xe5473708b16e9f60),

244 
W64LIT
(0x224b4501d28a500c),

245 
W64LIT
(0xfb7ea7a4ffbbaf64),

246 
W64LIT
(0x3d26bcc6368daae3),

247 
W64LIT
(0x866bc0392f7567d9),

248 
W64LIT
(0x3731cca20c6dba4c),

249 
W64LIT
(0xb603e67f9f39b41b),

250 
W64LIT
(0xa1d1bd0ae08f3f78),

251 
W64LIT
(0xd935e2a52d31ff68),

252 
W64LIT
(0xaf639c376dcded91),

253 
W64LIT
(0x0154696baad2caeb),

254 
W64LIT
(0xecacfcd1800d2407),

255 
W64LIT
(0xf03dbeab6f897520),

256 
W64LIT
(0x02a8d2d6a1516123),

257 
W64LIT
(0xf498eff2d82bb766),

258 
W64LIT
(0x710f9476fcdd7b77),

259 
W64LIT
(0xf8821c19f43804ac),

260 
W64LIT
(0xf9d675725eeace47),

261 
W64LIT
(0x1a9cc1f5f977f242),

262 
W64LIT
(0x5210b81c8485e190),

263 
W64LIT
(0x6d9ed60c13592a50),

264 
W64LIT
(0xf2956c7dced81403),

265 
W64LIT
(0xbb4d7cff19f8cd3a),

266 
W64LIT
(0x4c2928b0ca50d194),

267 
W64LIT
(0x6e626db118da8198),

268 
W64LIT
(0xe4135e631bbc558b),

269 
W64LIT
(0x9da368a77cd05f70),

270 
W64LIT
(0xa574ec53572dfd3e),

271 
W64LIT
(0x09ebcbd93163bb67),

272 
W64LIT
(0x4a24ab3fdca372f1),

273 
W64LIT
(0x429b098d4712037d),

274 
W64LIT
(0x57e1802e99f5e93d),

275 
W64LIT
(0xef50476c8b8e8fcf),

276 
W64LIT
(0xa085d4614a5df593),

277 
W64LIT
(0x34cd771f07ee1184),

278 
W64LIT
(0xc6581b62c9360587),

279 
W64LIT
(0x2dad0d57f51a480e),

280 
W64LIT
(0x898d886f08e57fdb),

281 
W64LIT
(0xd6d3aaf30aa1e76a),

282 
W64LIT
(0x76567e9240fc12f9),

283 
W64LIT
(0xb4ab34a93e68d538),

284 
W64LIT
(0xb2a6b726289b765d),

285 
W64LIT
(0x8c7cb05d15957776),

286 
W64LIT
(0x554952f838a4881e),

287 
W64LIT
(0xd52f114e01224ca2),

288 
W64LIT
(0x60d04c8c95985371),

289 
W64LIT
(0x6789a66829b93aff),

290 
W64LIT
(0x2f05df81544b292d),

291 
W64LIT
(0x476a31bf5a620bd0),

292 
W64LIT
(0xf5cc869972f97d8d),

293 
W64LIT
(0x488c79e97df213d2),

294 
W64LIT
(0x44968a0251e1a018),

295 
W64LIT
(0x26ee14586528924a),

296 
W64LIT
(0xd0de297c1c52440f),

297 
W64LIT
(0xc5a4a0dfc2b5ae4f),

298 
W64LIT
(0x29085c0e42b88a48),

299 
W64LIT
(0x142ee0c8743520ab),

300 
W64LIT
(0x2af4e7b3493b2180),

301 
W64LIT
(0x9448a37e4db3e417),

303 
W64LIT
(0xe2795ba105ba30ce),

304 
W64LIT
(0x65b5d634f5e0fbdd),

305 
W64LIT
(0x2d7d7f1464dd8c55),

306 
W64LIT
(0xeefbf778add1c20b),

307 
W64LIT
(0x1eb0fbd1f11968e7),

308 
W64LIT
(0xe6073f45ce30cd8d),

309 
W64LIT
(0x21ffd3cdccb67e90),

310 
W64LIT
(0xdf0941cfa750a262),

311 
W64LIT
(0xc61df5b1b75ef18a),

312 
W64LIT
(0xc5c7defa9dc337c6),

313 
W64LIT
(0x2581b729073c83d3),

314 
W64LIT
(0xa5e97513167173cf),

315 
W64LIT
(0xdd3673bd381526b9),

316 
W64LIT
(0xe8baa1eef91ebb93),

317 
W64LIT
(0x3b314cf8f625eb34),

318 
W64LIT
(0x579d4bc8d5fc5df8),

319 
W64LIT
(0xbb598ec2e7681b28),

320 
W64LIT
(0xc8a06b1a80708794),

321 
W64LIT
(0x1c8fc9a36e5cec3c),

322 
W64LIT
(0xf60a5a3f0807d374),

323 
W64LIT
(0x1ace9f353a9395a4),

324 
W64LIT
(0x7e9e50387aab2cee),

325 
W64LIT
(0xb5e41069d0466d36),

326 
W64LIT
(0x8cea6ee3b92602d9),

327 
W64LIT
(0xf952ddad8af1e7fd),

328 
W64LIT
(0xb19a748d1bcc9075),

329 
W64LIT
(0x2464ae10b2e4c144),

330 
W64LIT
(0xfcc9a070f4a35829),

331 
W64LIT
(0xfa88f6e6a06c21b1),

332 
W64LIT
(0x2c98662dd105cec2),

333 
W64LIT
(0x9065a740d77aeee5),

334 
W64LIT
(0xcb7a4051aaed41d8),

335 
W64LIT
(0x55a279ba4ab9d923),

336 
W64LIT
(0x27be855b98790708),

337 
W64LIT
(0xbabc97fb52b059bf),

338 
W64LIT
(0xa19711f7ddfb8e8c),

339 
W64LIT
(0x047e64e4cb8afd43),

340 
W64LIT
(0xc386886cc90c4e5e),

341 
W64LIT
(0xc422c7c3281b7551),

342 
W64LIT
(0xfb6defdf15b46326),

343 
W64LIT
(0x01e51939b5d84297),

344 
W64LIT
(0x5cbba8be9c809432),

345 
W64LIT
(0x6f762c7b09447080),

346 
W64LIT
(0xcee13d8cd4bffe0c),

347 
W64LIT
(0x54476083ff619bb4),

348 
W64LIT
(0x6e933542bc9c3217),

349 
W64LIT
(0x4af79b520e78f353),

350 
W64LIT
(0x98996f7db49be163),

351 
W64LIT
(0xa07208ce6823cc1b),

352 
W64LIT
(0x2b3c29823012f5cd),

353 
W64LIT
(0x93bf8c0bfde728a9),

354 
W64LIT
(0x2225f886e62bb8dc),

355 
W64LIT
(0x7f7b4901cf736e79),

356 
W64LIT
(0x0000000000000000),

357 
W64LIT
(0x023f32729f4584db),

358 
W64LIT
(0xd5cabb805bf4293f),

359 
W64LIT
(0x07a44fafe1173b0f),

360 
W64LIT
(0xe95fb8d74cc6f904),

361 
W64LIT
(0x7b052de504f9933a),

362 
W64LIT
(0x6aed51a67716cf54),

363 
W64LIT
(0x68d263d4e8534b8f),

364 
W64LIT
(0xa96bd9cabe1a810a),

365 
W64LIT
(0x1d6ad09adb84aeab),

366 
W64LIT
(0x0d67b5e01db3b052),

367 
W64LIT
(0x52063615abaee22c),

368 
W64LIT
(0x8f3045a893bbc495),

369 
W64LIT
(0xd8ad0e604647996d),

370 
W64LIT
(0xaf2a8f5cead5f892),

371 
W64LIT
(0x3017af8ebf5922fe),

372 
W64LIT
(0x4034611df2dc780e),

373 
W64LIT
(0x721cfce1d2c0de2b),

374 
W64LIT
(0x28e602c91a8f3381),

375 
W64LIT
(0xe1a370ea2f27f682),

376 
W64LIT
(0x29031bf0af577116),

377 
W64LIT
(0x1914b47e100e53e8),

378 
W64LIT
(0x567852f160241f6f),

379 
W64LIT
(0x793a1f979bbc17e1),

380 
W64LIT
(0xef1eee411809809c),

381 
W64LIT
(0x6211999b14f7c0d2),

382 
W64LIT
(0x059b7ddd7e52bfd4),

383 
W64LIT
(0x43ee4a56d841be42),

384 
W64LIT
(0xf1ae1590e910e87b),

385 
W64LIT
(0x33cd84c595c4e4b2),

386 
W64LIT
(0x4b12826bbba0b1c4),

387 
W64LIT
(0xeb608aa5d3837ddf),

388 
W64LIT
(0x201acaf4796e3c07),

389 
W64LIT
(0xbf27ea262ce2e66b),

390 
W64LIT
(0x58c5cc5a570a6971),

391 
W64LIT
(0x37b3e0215e4e19f1),

392 
W64LIT
(0xab54ebb8215f05d1),

393 
W64LIT
(0x8ed55c9126638602),

394 
W64LIT
(0x9aa65d0f2bde65b8),

395 
W64LIT
(0xd7f589f2c4b1ade4),

396 
W64LIT
(0x5039046734eb66f7),

397 
W64LIT
(0x6cac073023d9b6cc),

398 
W64LIT
(0x51dc1d5e81332460),

399 
W64LIT
(0x17a92ad5272025f6),

400 
W64LIT
(0x47902eb213cb4301),

401 
W64LIT
(0x1b2b860c8f4bd733),

402 
W64LIT
(0x4f6ce68f702a4c87),

403 
W64LIT
(0xcf0424b56167bc9b),

404 
W64LIT
(0x997c76440143a3f4),

405 
W64LIT
(0x7ae034dcb121d1ad),

406 
W64LIT
(0x100d657ac6371ef9),

407 
W64LIT
(0x0ac3fa4ffca48b5d),

408 
W64LIT
(0xdeec58f61288e0f5),

409 
W64LIT
(0x265b9c622da1459f),

410 
W64LIT
(0xdcd36a848dcd642e),

411 
W64LIT
(0xe4380d3751754956),

412 
W64LIT
(0x13d74e31ecaad8b5),

413 
W64LIT
(0xfd2cb949417b1abe),

414 
W64LIT
(0x9624f1d683b5977d),

415 
W64LIT
(0x4675378ba6130196),

416 
W64LIT
(0x0b26e376497cc9ca),

417 
W64LIT
(0x41d1782447043a99),

418 
W64LIT
(0xe39c4298b0627259),

419 
W64LIT
(0xcd3b16c7fe223840),

420 
W64LIT
(0x7787813cac9261ff),

421 
W64LIT
(0x492db01924e5351f),

422 
W64LIT
(0x5afafe28c84fedaa),

423 
W64LIT
(0x8b4e214c583139d6),

424 
W64LIT
(0xccde0ffe4bfa7ad7),

425 
W64LIT
(0x76629805194a2368),

426 
W64LIT
(0x7ca1624ae5eea835),

427 
W64LIT
(0x61cbb2d03e6a069e),

428 
W64LIT
(0x48c8a920913d7788),

429 
W64LIT
(0x8068c23a114df01c),

430 
W64LIT
(0xd38bed160f3b50a7),

431 
W64LIT
(0x32289dfc201ca625),

432 
W64LIT
(0xc1b9ba1e5649ca85),

433 
W64LIT
(0xed21dc33874c0447),

434 
W64LIT
(0xa3a8238542be0a57),

435 
W64LIT
(0x5b1fe7117d97af3d),

436 
W64LIT
(0x3d701a6ea2ea92ac),

437 
W64LIT
(0x73f9e5d867189cbc),

438 
W64LIT
(0x9ed839ebe05498fb),

439 
W64LIT
(0x5920d563e2d22be6),

440 
W64LIT
(0xca9f59681f35034f),

441 
W64LIT
(0x11e87c4373ef5c6e),

442 
W64LIT
(0x97c1e8ef366dd5ea),

443 
W64LIT
(0xacf0a417c0483ede),

444 
W64LIT
(0xd26ef42fbae31230),

445 
W64LIT
(0xbcfdc16d067f2027),

446 
W64LIT
(0xbec2f31f993aa4fc),

447 
W64LIT
(0x45af1cc08c8ec7da),

448 
W64LIT
(0x31f2b6b70a816069),

449 
W64LIT
(0xd9481759f39fdbfa),

450 
W64LIT
(0xe5dd140ee4ad0bc1),

451 
W64LIT
(0xa6335e583cecb583),

452 
W64LIT
(0x38eb67b3dcb82d78),

453 
W64LIT
(0xf5d07174229a1538),

454 
W64LIT
(0x5f6183f5b61d527e),

455 
W64LIT
(0x0f58879282f63489),

456 
W64LIT
(0x164c33ec92f86761),

457 
W64LIT
(0x444a05f93956854d),

458 
W64LIT
(0x818ddb03a495b28b),

459 
W64LIT
(0x4d53d4fdef6fc85c),

460 
W64LIT
(0x8d0f77da0cfe404e),

461 
W64LIT
(0x8416a6dedac70d5f),

462 
W64LIT
(0x666ffd7fdf7d3d91),

463 
W64LIT
(0xb63e3b22fadbab7a),

464 
W64LIT
(0xf2743edbc38d2e37),

465 
W64LIT
(0xa40c6c2aa3a93158),

466 
W64LIT
(0x9f3d20d2558cda6c),

467 
W64LIT
(0xfef692026be6dcf2),

468 
W64LIT
(0x2ea7545f4e404a19),

469 
W64LIT
(0xb2405fc631515639),

470 
W64LIT
(0x23c0e1bf53f3fa4b),

471 
W64LIT
(0x83b2e9713bd03650),

472 
W64LIT
(0x0641569654cf7998),

473 
W64LIT
(0xb883a589cdf5dd64),

474 
W64LIT
(0x3ad455c143fda9a3),

475 
W64LIT
(0x925a9532483f6a3e),

476 
W64LIT
(0xaab1f28194874746),

477 
W64LIT
(0xf435684d974257af),

478 
W64LIT
(0xd1b4df64907ed47c),

479 
W64LIT
(0x390e7e8a69606fef),

480 
W64LIT
(0xd051c65d25a696eb),

481 
W64LIT
(0xb4010950659e2fa1),

482 
W64LIT
(0x0c82acd9a86bf2c5),

483 
W64LIT
(0x88940a0772acff9a),

484 
W64LIT
(0xf39127e276556ca0),

485 
W64LIT
(0xaecf96655f0dba05),

486 
W64LIT
(0x03da2b4b2a9dc64c),

487 
W64LIT
(0x3f4f281c3daf1677),

488 
W64LIT
(0x3469cb6a74d3dfbd),

489 
W64LIT
(0xf04b0ca95cc8aaec),

490 
W64LIT
(0x1f55e2e844c12a70),

491 
W64LIT
(0x4cb6cdc45ab78acb),

492 
W64LIT
(0xc05ca327e3918812),

493 
W64LIT
(0x95feda9da9285131),

494 
W64LIT
(0xb966bcb0782d9ff3),

495 
W64LIT
(0xa7d647618934f714),

496 
W64LIT
(0xd61090cb7169ef73),

497 
W64LIT
(0x71c6d7aaf85d1867),

498 
W64LIT
(0xecc4c50a329446d0),

499 
W64LIT
(0x6450cf0d4038b94a),

500 
W64LIT
(0x420b536f6d99fcd5),

501 
W64LIT
(0x75b8b34e33d7e524),

502 
W64LIT
(0xc26391557cd40cc9),

503 
W64LIT
(0xda923c12d9021db6),

504 
W64LIT
(0x4e89ffb6c5f20e10),

505 
W64LIT
(0x0919d104d6394d11),

506 
W64LIT
(0x8aab3875ede97b41),

507 
W64LIT
(0xa88ec0f30bc2c39d),

508 
W64LIT
(0xb7db221b4f03e9ed),

509 
W64LIT
(0xc7f8ec880286b31d),

510 
W64LIT
(0x2f424d66fb98088e),

511 
W64LIT
(0xe04669d39affb415),

512 
W64LIT
(0x3eaa3125887754e0),

513 
W64LIT
(0x5e849acc03c510e9),

514 
W64LIT
(0x8257f0488e0874c7),

515 
W64LIT
(0xbd18d854b3a762b0),

516 
W64LIT
(0xb3a546ff848914ae),

517 
W64LIT
(0x9ce70b997f111c20),

518 
W64LIT
(0x3c9503571732d03b),

519 
W64LIT
(0xe7e2267c7be88f1a),

520 
W64LIT
(0x63f480a2a12f8245),

521 
W64LIT
(0x602eabe98bb24409),

522 
W64LIT
(0x941bc3a41cf013a6),

523 
W64LIT
(0x678ae4466aa57f06),

524 
W64LIT
(0x1232570859729a22),

525 
W64LIT
(0x6d491e099601f45b),

526 
W64LIT
(0x5d5eb1872958d6a5),

527 
W64LIT
(0x1473019e0dbde3ba),

528 
W64LIT
(0xa24d3abcf76648c0),

529 
W64LIT
(0x85f3bfe76f1f4fc8),

530 
W64LIT
(0x08fcc83d63e10f86),

531 
W64LIT
(0x745daa77860fa7b3),

532 
W64LIT
(0x9180be7962a2ac72),

533 
W64LIT
(0x87cc8d95f05acb13),

534 
W64LIT
(0x78df06ae2e645576),

535 
W64LIT
(0x18f1ad47a5d6117f),

536 
W64LIT
(0x358cd253c10b9d2a),

537 
W64LIT
(0x0ebd9eab372e761e),

538 
W64LIT
(0xf7ef4306bddf91e3),

539 
W64LIT
(0x7023ce934d855af0),

540 
W64LIT
(0xd42fa2b9ee2c6ba8),

541 
W64LIT
(0x3656f918eb965b66),

542 
W64LIT
(0x9d0212a0cac95eb7),

543 
W64LIT
(0x2ad930bb85cab75a),

544 
W64LIT
(0x862994ac45828984),

545 
W64LIT
(0x7d447b735036eaa2),

546 
W64LIT
(0xb07f6db4ae14d2e2),

547 
W64LIT
(0x6b08489fc2ce8dc3),

548 
W64LIT
(0x9b4344369e06272f),

549 
W64LIT
(0xad15bd2e75907c49),

550 
W64LIT
(0xdb77252b6cda5f21),

551 
W64LIT
(0xea85939c665b3f48),

552 
W64LIT
(0xc945722335a8c503),

553 
W64LIT
(0x159618a7b865a12d),

554 
W64LIT
(0x69377aed5d8b0918),

555 
W64LIT
(0x8971133ec774bd0d),

556 
W64LIT
(0x53e32f2c1e76a0bb),

557 
W64LIT
(0xf8b7c4943f29a56a),

558 
W64LIT
(0xff138b3bde3e9e65),

560 
W64LIT
(0x7c6a2eb5fdabecc6),

561 
W64LIT
(0x401cda0a752bbea0),

562 
W64LIT
(0x1925217156dc57c4),

563 
W64LIT
(0x56dec6d301d70787),

564 
W64LIT
(0x41c751ff73c6ac58),

565 
W64LIT
(0xc9067697a92cb5f9),

566 
W64LIT
(0x3391c917aaa0bc85),

567 
W64LIT
(0xae0a9a4c0e742afe),

568 
W64LIT
(0xaa8ca972162a62f4),

569 
W64LIT
(0x5aa193912935df99),

570 
W64LIT
(0x86fd9135fe27e5ba),

571 
W64LIT
(0xffca074b1d3f538e),

572 
W64LIT
(0x0e3cb65d24cdfc1b),

573 
W64LIT
(0x4384b2e07fe9885d),

574 
W64LIT
(0xc73ac0ca8de149e2),

575 
W64LIT
(0x48e5bc7645972eb4),

576 
W64LIT
(0xbe0d56b46ef9ffd6),

577 
W64LIT
(0x200e6d05c0ef5f50),

578 
W64LIT
(0xe1f17dee597f7abd),

579 
W64LIT
(0x0243e31f0c2f2405),

580 
W64LIT
(0xf4ab09dd2741f567),

581 
W64LIT
(0xe4acc52547cc204f),

582 
W64LIT
(0x348f92c3b83cc272),

583 
W64LIT
(0x53837e181f645d75),

584 
W64LIT
(0xd8da319acf4c7229),

585 
W64LIT
(0x81e3cae1ecbb9b4d),

586 
W64LIT
(0xd6e687c7eb818e32),

587 
W64LIT
(0x3dad7f4a8e6d409e),

588 
W64LIT
(0x28f70b79f053cf44),

589 
W64LIT
(0x493e3783437a3c4c),

590 
W64LIT
(0xb27203f6461b27c8),

591 
W64LIT
(0xd02357e6fff0e23d),

592 
W64LIT
(0xe8d390676f2ef851),

593 
W64LIT
(0x26cbbd24d49e335f),

594 
W64LIT
(0xee1640467b5f945e),

595 
W64LIT
(0x4aa65f6949b80ab1),

596 
W64LIT
(0xb56c58225487593f),

597 
W64LIT
(0x4ffbe7a2570b5043),

598 
W64LIT
(0x0aba85633c93b411),

599 
W64LIT
(0x78ec1d8be5f5a4cc),

600 
W64LIT
(0x501b16f215a66b88),

601 
W64LIT
(0x271036d1d27321a7),

602 
W64LIT
(0x7ff2465ff769da3b),

603 
W64LIT
(0x35541936bed1d08a),

604 
W64LIT
(0xb8c886957a8893d9),

605 
W64LIT
(0x2fe950ade2cfb1b3),

606 
W64LIT
(0xf90fd76a094e3f81),

607 
W64LIT
(0x2daab3b2eee095b6),

608 
W64LIT
(0x1abd499b5c1e6139),

609 
W64LIT
(0x0c7f554228e2d81e),

610 
W64LIT
(0x425f391579049aa5),

611 
W64LIT
(0xc3bcf3f495bf01e8),

612 
W64LIT
(0xb4b7d3d7526a4bc7),

613 
W64LIT
(0x0000000000000000),

614 
W64LIT
(0xa0362c112ab9d6e5),

615 
W64LIT
(0x91e406198c364e65),

616 
W64LIT
(0x454162c16b98e452),

617 
W64LIT
(0x139fa4126a4fe3d5),

618 
W64LIT
(0x01db8bf506ed12f8),

619 
W64LIT
(0x9a85088fb648e88c),

620 
W64LIT
(0x3ab3249e9cf13e69),

621 
W64LIT
(0xd57eef2de143b8cf),

622 
W64LIT
(0xb1ea6b1c4cd91135),

623 
W64LIT
(0x7aaffe94e9da80c9),

624 
W64LIT
(0xad92f2a604b61c03),

625 
W64LIT
(0xa3ae44fb207be018),

626 
W64LIT
(0xeb4bf88d65ecceac),

627 
W64LIT
(0xc0249b1e9f7d3715),

628 
W64LIT
(0xa8cf4a6d1a0546f1),

629 
W64LIT
(0xc6e14b3f8b0c5b1a),

630 
W64LIT
(0xce182d43bbb0cb0e),

631 
W64LIT
(0xfc526fa117fd6573),

632 
W64LIT
(0x8c471456c2b451ab),

633 
W64LIT
(0xac497953025b0efb),

634 
W64LIT
(0x0486333e185e480a),

635 
W64LIT
(0x18feaa845031453c),

636 
W64LIT
(0xa1eda7e42c54c41d),

637 
W64LIT
(0x06c5d02114716c0f),

638 
W64LIT
(0x055db8cb1eb35af2),

639 
W64LIT
(0xe5774ed0412132b7),

640 
W64LIT
(0x36cc71dcb413e677),

641 
W64LIT
(0x470281de67b7c057),

642 
W64LIT
(0x58e2708e251afb9c),

643 
W64LIT
(0xa914c1981ce85409),

644 
W64LIT
(0xb3a9880340f63530),

645 
W64LIT
(0x638adfe5bf06d70d),

646 
W64LIT
(0x0b610e963a7ea6e9),

647 
W64LIT
(0x927c6ef386f47898),

648 
W64LIT
(0xed8e28ac719da2a3),

649 
W64LIT
(0x7548c33ccbfa6e2a),

650 
W64LIT
(0xf3b5520935dd8b90),

651 
W64LIT
(0x8d9c9fa3c4594353),

652 
W64LIT
(0x31d22a08a68f9880),

653 
W64LIT
(0x0da4deb72e0fcae6),

654 
W64LIT
(0x8fdf7cbcc8766756),

655 
W64LIT
(0x5dbfc8453ba9a16e),

656 
W64LIT
(0x8e04f749ce9b75ae),

657 
W64LIT
(0x83a029fee094bf48),

658 
W64LIT
(0xa4b01f2f32e79eef),

659 
W64LIT
(0x1c7899ba486f0d36),

660 
W64LIT
(0x654f0fc4ab77bb02),

661 
W64LIT
(0x7db1a540fb46fe3e),

662 
W64LIT
(0x51c09d07134b7970),

663 
W64LIT
(0xcb459588a50391fc),

664 
W64LIT
(0x3fee9c558242649b),

665 
W64LIT
(0xfe118cbe1bd24176),

666 
W64LIT
(0x76d0abd6c13858d7),

667 
W64LIT
(0x5e27a0af316b9793),

668 
W64LIT
(0x69305a868395631c),

669 
W64LIT
(0x3b68af6b9a1c2c91),

670 
W64LIT
(0x6db669b89bcb2b16),

671 
W64LIT
(0xa72877c53825a812),

672 
W64LIT
(0xd3bb3f0cf532d4c0),

673 
W64LIT
(0x6ff58aa797e40f13),

674 
W64LIT
(0x96fa5dcd9eaa3092),

675 
W64LIT
(0x2c713847e80d874e),

676 
W64LIT
(0xc57923d581ce6de7),

677 
W64LIT
(0x2b6f6393fa91f9b9),

678 
W64LIT
(0x0922ed89365182ec),

679 
W64LIT
(0x324a42e2ac4dae7d),

680 
W64LIT
(0x16c21cd974fcb927),

681 
W64LIT
(0x956235279468066f),

682 
W64LIT
(0x7b747561ef379231),

683 
W64LIT
(0x449ae9346d75f6aa),

684 
W64LIT
(0xf570822821ace79f),

685 
W64LIT
(0x5939fb7b23f7e964),

686 
W64LIT
(0x7937967ee318b634),

687 
W64LIT
(0x84be722af208c1bf),

688 
W64LIT
(0x08f9667c30bc9014),

689 
W64LIT
(0xefcdcbb37db286a6),

690 
W64LIT
(0xa6f3fc303ec8baea),

691 
W64LIT
(0xea9073786301dc54),

692 
W64LIT
(0x62515410b9ebc5f5),

693 
W64LIT
(0xd260b4f9f3dfc638),

694 
W64LIT
(0x9e033bb1ae16a086),

695 
W64LIT
(0x38f0c78190de1a6c),

696 
W64LIT
(0xc267780193521310),

697 
W64LIT
(0x80384114ea5689b5),

698 
W64LIT
(0x9b5e837ab0a5fa74),

699 
W64LIT
(0xf73361372d83c39a),

700 
W64LIT
(0x3009a1fda0628a78),

701 
W64LIT
(0xd4a564d8e7aeaa37),

702 
W64LIT
(0xfb4c347505611b84),

703 
W64LIT
(0x5b7a18642fd8cd61),

704 
W64LIT
(0x239605efca2d69ad),

705 
W64LIT
(0xf8d45c9f0fa32d79),

706 
W64LIT
(0xbb50ee7f704aa524),

707 
W64LIT
(0x392b4c7496330894),

708 
W64LIT
(0x0fe73da82220eee3),

709 
W64LIT
(0x3717fa29b2fef48f),

710 
W64LIT
(0xf26ed9fc33309968),

711 
W64LIT
(0xd73d0c32ed6c9cca),

712 
W64LIT
(0xda99d285c363562c),

713 
W64LIT
(0xde1fe1bbdb3d1e26),

714 
W64LIT
(0x738d131ddf8b0225),

715 
W64LIT
(0x292c808cf6beddbc),

716 
W64LIT
(0xbc4eb5ab62d6dbd3),

717 
W64LIT
(0x039868ea0ac236fd),

718 
W64LIT
(0xcc5bce5cb79fef0b),

719 
W64LIT
(0xb031e0e94a3403cd),

720 
W64LIT
(0xc4a2a82087237f1f),

721 
W64LIT
(0xb72fbb3d58a87d3a),

722 
W64LIT
(0xafd111b908993806),

723 
W64LIT
(0x68ebd173857871e4),

724 
W64LIT
(0x9d9b535ba4d4967b),

725 
W64LIT
(0xe9081b9269c3eaa9),

726 
W64LIT
(0x71cef002d3a42620),

727 
W64LIT
(0x93a7e50680196a60),

728 
W64LIT
(0x891aac9ddc070b59),

729 
W64LIT
(0x155a74337e3e8fda),

730 
W64LIT
(0x4e206c5751e642bb),

731 
W64LIT
(0x9721d6389847226a),

732 
W64LIT
(0x12442fe76ca2f12d),

733 
W64LIT
(0x2553d5cede5c05a2),

734 
W64LIT
(0xa275cf0e2696f2e0),

735 
W64LIT
(0x24885e3bd8b1175a),

736 
W64LIT
(0x670cecdba7589f07),

737 
W64LIT
(0x749348c9cd177cd2),

738 
W64LIT
(0x64948431ad9aa9fa),

739 
W64LIT
(0x2ab4e866fc7ceb41),

740 
W64LIT
(0xe6ef263a4be3044a),

741 
W64LIT
(0xe734adcf4d0e16b2),

742 
W64LIT
(0x903f8dec8adb5c9d),

743 
W64LIT
(0xf02d3ae33f1fbd6d),

744 
W64LIT
(0x725698e8d96610dd),

745 
W64LIT
(0x1da3124f4e821fce),

746 
W64LIT
(0x1719972c7211abdf),

747 
W64LIT
(0x11dc470d6660c7d0),

748 
W64LIT
(0xec55a3597770b05b),

749 
W64LIT
(0xbfd6dd416814ed2e),

750 
W64LIT
(0x57054d26073a157f),

751 
W64LIT
(0x1e3b7aa544402933),

752 
W64LIT
(0x5ffc2b5a3786856b),

753 
W64LIT
(0x61c93cfab329f308),

754 
W64LIT
(0x3e3517a084af7663),

755 
W64LIT
(0xf6e8eac22b6ed162),

756 
W64LIT
(0x1007ccf8608dd528),

757 
W64LIT
(0x66d7672ea1b58dff),

758 
W64LIT
(0x8b594f82d0282f5c),

759 
W64LIT
(0x1fe0f15042ad3bcb),

760 
W64LIT
(0x4b7dd49c4f551849),

761 
W64LIT
(0x4c638f485dc966be),

762 
W64LIT
(0xcfc3a6b6bd5dd9f6),

763 
W64LIT
(0x46d90a2b615ad2af),

764 
W64LIT
(0x8565f9dff4e5d347),

765 
W64LIT
(0x94b9bed292851497),

766 
W64LIT
(0xfa97bf80038c097c),

767 
W64LIT
(0xb9130d607c658121),

768 
W64LIT
(0xdc5c02a4d7123a23),

769 
W64LIT
(0x224d8e1accc07b55),

770 
W64LIT
(0x87261ac0f8caf742),

771 
W64LIT
(0xd901ba6fc9a160d1),

772 
W64LIT
(0xab57228710c7700c),

773 
W64LIT
(0x21d5e6f0c6024da8),

774 
W64LIT
(0x98c6eb90ba67cc89),

775 
W64LIT
(0x827ba20be679adb0),

776 
W64LIT
(0x991d6065bc8ade71),

777 
W64LIT
(0x5546ae390b15317a),

778 
W64LIT
(0xa56b94da340a8c17),

779 
W64LIT
(0x071e5bd4129c7ef7),

780 
W64LIT
(0xe02af61b5f926845),

781 
W64LIT
(0x6b73b9998fba4719),

782 
W64LIT
(0xdfc46a4eddd00cde),

783 
W64LIT
(0x770b2023c7d54a2f),

784 
W64LIT
(0x7e29cdaaf184c8c3),

785 
W64LIT
(0xba8b658a76a7b7dc),

786 
W64LIT
(0x9c40d8aea2398483),

787 
W64LIT
(0x9fd8b044a8fbb27e),

788 
W64LIT
(0xdb425970c58e44d4),

789 
W64LIT
(0xe269150453bd4c40),

790 
W64LIT
(0x3c76f4bf88805266),

791 
W64LIT
(0xf1f6b11639f2af95),

792 
W64LIT
(0x549d25cc0df82382),

793 
W64LIT
(0x4db804bd5b247446),

794 
W64LIT
(0x8a82c477d6c53da4),

795 
W64LIT
(0x5258f5ed19894f8d),

796 
W64LIT
(0x6e2e015291091deb),

797 
W64LIT
(0xc1ff10eb999025ed),

798 
W64LIT
(0xbd953e5e643bc92b),

799 
W64LIT
(0xc8ddfd62afc1a701),

800 
W64LIT
(0x5c6443b03d44b396),

801 
W64LIT
(0x6c6de24d9d2639ee),

802 
W64LIT
(0x1481ffc678d39d22),

803 
W64LIT
(0xd1f8dc13f91df0c5),

804 
W64LIT
(0xca9e1e7da3ee8304),

805 
W64LIT
(0xdd878951d1ff28db),

806 
W64LIT
(0x6012b70fb5c4e1f0),

807 
W64LIT
(0x1b66c26e5af373c1),

808 
W64LIT
(0xe3b29ef155505eb8),

809 
W64LIT
(0x70157bf7d54934d8),

810 
W64LIT
(0x2e32db58e422a34b),

811 
W64LIT
(0x6aa8326c895755e1),

812 
W64LIT
(0xb6f430c85e456fc2),

813 
W64LIT
(0xfd89e4541110778b),

814 
W64LIT
(0x88c12768daea19a1),

815 
W64LIT
(0xcd8045a9b172fdf3),

817 
W64LIT
(0x99183e616655b742),

818 
W64LIT
(0xb2872032a50d6860),

819 
W64LIT
(0x0946f63b060528ef),

820 
W64LIT
(0x36612b9a141ef07d),

821 
W64LIT
(0x0634da84dd49579b),

822 
W64LIT
(0xfc9c9e9b486c8a57),

823 
W64LIT
(0xa63fe3c0744e6fd0),

824 
W64LIT
(0xf1515758d8b46bf9),

825 
W64LIT
(0x3e82559fcd5197ff),

826 
W64LIT
(0x92e12d262bc40177),

827 
W64LIT
(0xc3bb433a5a7752c5),

828 
W64LIT
(0x21c3852a5183267a),

829 
W64LIT
(0x39130725cf528f09),

830 
W64LIT
(0x9ba7db1d2dc12998),

831 
W64LIT
(0xc58f99be873e055e),

832 
W64LIT
(0xd9d424498f32656c),

833 
W64LIT
(0x27f75fae8cca71e1),

834 
W64LIT
(0x59b91019a8fc3430),

835 
W64LIT
(0xce768af9caafb36b),

836 
W64LIT
(0x9d930199f0887e03),

837 
W64LIT
(0x63b07a7ef3706a8e),

838 
W64LIT
(0xb5167288a70e7096),

839 
W64LIT
(0x40cc1a28e967d22e),

840 
W64LIT
(0x4d01d3eb79bf3380),

841 
W64LIT
(0x9e896cdb6456afb4),

842 
W64LIT
(0x2548bad2c75eef3b),

843 
W64LIT
(0xa79a6bfeab0420bd),

844 
W64LIT
(0x9f2ce4e5bb1ce0d9),

845 
W64LIT
(0x32ea146282c3393c),

846 
W64LIT
(0x6d67defff7765a97),

847 
W64LIT
(0x83775912b31080eb),

848 
W64LIT
(0xf5da68a04e69a2b8),

849 
W64LIT
(0x1196743498d4819c),

850 
W64LIT
(0x0bf913474d91b635),

851 
W64LIT
(0x43d6776a7db90399),

852 
W64LIT
(0x444725d07fba1b6f),

853 
W64LIT
(0x6584a0fa2e393d15),

854 
W64LIT
(0x3f27dda1121bd892),

855 
W64LIT
(0xf6c005e2dab7730f),

856 
W64LIT
(0x56cb3ca673b04b44),

857 
W64LIT
(0x642128c4f1737278),

858 
W64LIT
(0xbf4ae9f135d589ce),

859 
W64LIT
(0xb038c54eee99f6ba),

860 
W64LIT
(0xf47fe09e9123edd5),

861 
W64LIT
(0x75b75cf069a7f3e4),

862 
W64LIT
(0xd419ed8a1fea84c2),

863 
W64LIT
(0x73838674b4eea47f),

864 
W64LIT
(0x498aec13ef62fac1),

865 
W64LIT
(0x20660d148ec96917),

866 
W64LIT
(0xa48006bc3fdaf10a),

867 
W64LIT
(0x2f1421ab55851663),

868 
W64LIT
(0x0a5c9b7992dbf958),

869 
W64LIT
(0xd1375a4c567d02ee),

870 
W64LIT
(0x0000000000000000),

871 
W64LIT
(0xc842507d17e6e4f0),

872 
W64LIT
(0xf3eeb2249320f523),

873 
W64LIT
(0xc9e7d843c8acab9d),

874 
W64LIT
(0xff86f3d9dcb25be0),

875 
W64LIT
(0xb4b3fab678443ffb),

876 
W64LIT
(0xb19d4d7031d3b9d7),

877 
W64LIT
(0x79df1d0d26355d27),

878 
W64LIT
(0x8eba90d123c86145),

879 
W64LIT
(0xaa57a23d3bdcc113),

880 
W64LIT
(0xcb583d3f83383547),

881 
W64LIT
(0xd871ac7750782a01),

882 
W64LIT
(0xe162ab529f2aa508),

883 
W64LIT
(0x38b68f1b1018c064),

884 
W64LIT
(0x237c60561a17b8a0),

885 
W64LIT
(0xa31154063dd9e9fc),

886 
W64LIT
(0x713c6308ff7a3aa5),

887 
W64LIT
(0x1a6f6773d54537a9),

888 
W64LIT
(0x08e37e05d94f6782),

889 
W64LIT
(0x357b46d880c021ca),

890 
W64LIT
(0x6cc256c1283c15fa),

891 
W64LIT
(0xcfd302c715e5fc06),

892 
W64LIT
(0xbdf50c8d7e411714),

893 
W64LIT
(0x7cf1aacb6fa2db0b),

894 
W64LIT
(0x5240035ee56d8205),

895 
W64LIT
(0x7b60f8716da1c3fd),

896 
W64LIT
(0x01a5883edf4a4f6d),

897 
W64LIT
(0xdd5f1bb119efac2d),

898 
W64LIT
(0x5474d9da3824d59e),

899 
W64LIT
(0x0f722cbfdb4c7f74),

900 
W64LIT
(0x17a2aeb0459dd607),

901 
W64LIT
(0x37c4a3a4cb54bf10),

902 
W64LIT
(0xc21ecb04853d1da8),

903 
W64LIT
(0x4273ff54a2f34cf4),

904 
W64LIT
(0xdace490b1becb4db),

905 
W64LIT
(0x6af68c45f5754261),

906 
W64LIT
(0x46f8c0ac342e85b5),

907 
W64LIT
(0x854383966e59d770),

908 
W64LIT
(0x81c8bc6ef8841e31),

909 
W64LIT
(0x3bace25984c611d3),

910 
W64LIT
(0x1033fc0a479ecef1),

911 
W64LIT
(0x1c5bbdf7080c6032),

912 
W64LIT
(0x7412d4ceb6edbc89),

913 
W64LIT
(0xa8e8474170485fc9),

914 
W64LIT
(0xb8dbbb4b37d69138),

915 
W64LIT
(0x079152ba020318f6),

916 
W64LIT
(0x72260e4a6ba4eb12),

917 
W64LIT
(0x905ec85a60509fad),

918 
W64LIT
(0x2dabc4d71e1188b9),

919 
W64LIT
(0xd092d27289374d83),

920 
W64LIT
(0x610f9f02b8e4f454),

921 
W64LIT
(0x02bfe57c4b949eda),

922 
W64LIT
(0x95707f9c29c71981),

923 
W64LIT
(0x6fd83b83bce2c44d),

924 
W64LIT
(0x5d322fe13e21fd71),

925 
W64LIT
(0x34decee65f8a6ea7),

926 
W64LIT
(0xcd6ce7bb5e7162dc),

927 
W64LIT
(0xfb0dcc214a6f92a1),

928 
W64LIT
(0x2eb1a9958acf590e),

929 
W64LIT
(0xdcfa938fc6a5e340),

930 
W64LIT
(0x669ecdb8bae7eca2),

931 
W64LIT
(0x151d4bcc0e0948dd),

932 
W64LIT
(0xfd3916a59726c53a),

933 
W64LIT
(0x581c982777b67b5d),

934 
W64LIT
(0x1bcaef4d0a0f78c4),

935 
W64LIT
(0xdfe0fecd527b32f7),

936 
W64LIT
(0x128c19760c0a502b),

937 
W64LIT
(0x84e60ba8b113981d),

938 
W64LIT
(0x3c3db0e386c50925),

939 
W64LIT
(0x7febc789fb7c0abc),

940 
W64LIT
(0x7d5422f5b0e89466),

941 
W64LIT
(0xd70380c88b345575),

942 
W64LIT
(0xbbc1d609a308408f),

943 
W64LIT
(0xe278c6100bf474bf),

944 
W64LIT
(0x5e2842a3aaff2cc6),

945 
W64LIT
(0x6b53047b2a3f0d0c),

946 
W64LIT
(0xf7658ddc05fd3c62),

947 
W64LIT
(0x9a025323f28b66f5),

948 
W64LIT
(0x8c0575ad685cff9f),

949 
W64LIT
(0x76ad31b2fd792253),

950 
W64LIT
(0x68496939bee1dcbb),

951 
W64LIT
(0x7e4e4fb7243645d1),

952 
W64LIT
(0xe44c1c94d6bd2324),

953 
W64LIT
(0xbeef61cfea9fc6a3),

954 
W64LIT
(0x91fb4064bf1ad0c0),

955 
W64LIT
(0x052eb7c64997862c),

956 
W64LIT
(0x4a9081517bbc2b76),

957 
W64LIT
(0x8f1f18effc822e28),

958 
W64LIT
(0x3a096a675b8c5ebe),

959 
W64LIT
(0xee1087ed4466da7c),

960 
W64LIT
(0x2652d79053803e8c),

961 
W64LIT
(0x7099eb36203075c8),

962 
W64LIT
(0xc7307cc2ccaa9b84),

963 
W64LIT
(0x5c97a7dfe16bb21c),

964 
W64LIT
(0x50ffe622aef91cdf),

965 
W64LIT
(0x8da0fd93b716b0f2),

966 
W64LIT
(0x69ece10761ab93d6),

967 
W64LIT
(0x31f07920161de88b),

968 
W64LIT
(0x13299148d3401f46),

969 
W64LIT
(0x031a6d4294ded1b7),

970 
W64LIT
(0xccc96f85813b2db1),

971 
W64LIT
(0x14b8c3f2d14307b0),

972 
W64LIT
(0x8659eed4fa8706c7),

973 
W64LIT
(0xba645e377c420fe2),

974 
W64LIT
(0x2920fb2f88cc41f8),

975 
W64LIT
(0x87fc66ea25cd49aa),

976 
W64LIT
(0x1ee4588b4398fee8),

977 
W64LIT
(0xecaf62910ff244a6),

978 
W64LIT
(0xf817a163deb14316),

979 
W64LIT
(0x45e2adeea0f05402),

980 
W64LIT
(0x806d345027ce515c),

981 
W64LIT
(0x576eb498acfa0429),

982 
W64LIT
(0xa5258e82e090be67),

983 
W64LIT
(0x892bc26b21cb79b3),

984 
W64LIT
(0x6e7db3bd63a88b20),

985 
W64LIT
(0x4e1bbea9ed61e237),

986 
W64LIT
(0xadc6f08739dfd9e5),

987 
W64LIT
(0x8b9427176a5fe769),

988 
W64LIT
(0xa1aeb17a764d7726),

989 
W64LIT
(0x4b35096fa4f6641b),

990 
W64LIT
(0x22d9e868c55df7cd),

991 
W64LIT
(0x55d151e4e76e9af3),

992 
W64LIT
(0x966a12debd19c836),

993 
W64LIT
(0x0dcdc9c390d8e1ae),

994 
W64LIT
(0xf24b3a1a4c6aba4e),

995 
W64LIT
(0x24ed32ec1814a056),

996 
W64LIT
(0xaf7915fb724b473f),

997 
W64LIT
(0x2885731157860e95),

998 
W64LIT
(0x9c3689a72fc2316e),

999 
W64LIT
(0x475d4892eb64cad8),

1000 
W64LIT
(0xac6378b9e6959688),

1001 
W64LIT
(0xa00b3944a907384b),

1002 
W64LIT
(0xc695f4fc13e0d4e9),

1003 
W64LIT
(0x3055f11ec957a7e6),

1004 
W64LIT
(0x6215f2402c3a25e3),

1005 
W64LIT
(0xde4576f38d317d9a),

1006 
W64LIT
(0x9344a518f48e4e1a),

1007 
W64LIT
(0x82d2d12c6c5acf86),

1008 
W64LIT
(0xefb50fd39b2c9511),

1009 
W64LIT
(0xe981d5574665c28a),

1010 
W64LIT
(0x5f8dca9d75b563ab),

1011 
W64LIT
(0xb60c1fca33d0a121),

1012 
W64LIT
(0xfe237be703f8148d),

1013 
W64LIT
(0xd6a608f6547e1a18),

1014 
W64LIT
(0xb97e3375e89cde55),

1015 
W64LIT
(0xd388bf301de99c34),

1016 
W64LIT
(0x5b06f565e368aaea),

1017 
W64LIT
(0xf0f4df6607fe2494),

1018 
W64LIT
(0x1607268e9ad7996a),

1019 
W64LIT
(0xaedc9dc5ad010852),

1020 
W64LIT
(0xe0c7236c4060ea65),

1021 
W64LIT
(0xea9bb815d2bb133d),

1022 
W64LIT
(0x888e4a55fe8136de),

1023 
W64LIT
(0x5aa37d5b3c22e587),

1024 
W64LIT
(0xc104a64611e3cc1f),

1025 
W64LIT
(0x515a6e1c71b353b2),

1026 
W64LIT
(0xc42a118058744a33),

1027 
W64LIT
(0x7708b98c22336d3e),

1028 
W64LIT
(0x2a3a966d1c12904f),

1029 
W64LIT
(0x8a31af29b515a804),

1030 
W64LIT
(0xed0aeaafd0b80bcb),

1031 
W64LIT
(0x2c0e4ce9c15bc7d4),

1032 
W64LIT
(0x0c6841fd4f92aec3),

1033 
W64LIT
(0x98bdb65fb91ff82f),

1034 
W64LIT
(0x1f41d0b59cd2b185),

1035 
W64LIT
(0xb322a80c7a47270d),

1036 
W64LIT
(0xe6f3f9e89d29bdfe),

1037 
W64LIT
(0x7ac5704fb2eb8c90),

1038 
W64LIT
(0xa94dcf7faf0210a4),

1039 
W64LIT
(0x787a9533f97f124a),

1040 
W64LIT
(0xdb6bc135c4a6fbb6),

1041 
W64LIT
(0x048b3ff896ddc941),

1042 
W64LIT
(0xe8245d69992f8de7),

1043 
W64LIT
(0xe3dd4e2ed4be3bd2),

1044 
W64LIT
(0xcafdb5015c727a2a),

1045 
W64LIT
(0xb7a997f4ec9aee4c),

1046 
W64LIT
(0xe75671d64263f293),

1047 
W64LIT
(0x2b9f1e53c358df22),

1048 
W64LIT
(0x18d0820f9ed1a973),

1049 
W64LIT
(0xabf22a03e4968e7e),

1050 
W64LIT
(0xa2b4dc38e293a691),

1051 
W64LIT
(0x673b458665ada3cf),

1052 
W64LIT
(0xf9b2295d01fb0c7b),

1053 
W64LIT
(0xd22d370ec2a3d359),

1054 
W64LIT
(0x97cf9ae06253875b),

1055 
W64LIT
(0x0ed7a48104063019),

1056 
W64LIT
(0x482f642d3028b5ac),

1057 
W64LIT
(0xc0a12e78cea98372),

1058 
W64LIT
(0x4fbe3697322bad5a),

1059 
W64LIT
(0x19750a31419be61e),

1060 
W64LIT
(0x41699216362d9d43),

1061 
W64LIT
(0xd5bc65b4c0a0cbaf),

1062 
W64LIT
(0xe5e994aa09f76c49),

1063 
W64LIT
(0xeb3e302b0df15c50),

1064 
W64LIT
(0x94d5f7a2f68d56ec),

1065 
W64LIT
(0x53e58b603a27cd68),

1066 
W64LIT
(0x3d9838dd598f4648),

1067 
W64LIT
(0x60aa173c67aebb39),

1068 
W64LIT
(0x1dfe35c9d7462f5f),

1069 
W64LIT
(0x4ca45bd5a6f57ced),

1070 
W64LIT
(0xbc5084b3a10b5879),

1071 
W64LIT
(0xfaa8441f9525ddcc),

1072 
W64LIT
(0x334f9c5c5d897651),

1074 
W64LIT
(0xda1687a883adf27e),

1075 
W64LIT
(0xe35c9378578d9f22),

1076 
W64LIT
(0x303ca4531637fa40),

1077 
W64LIT
(0xa088321f74b20375),

1078 
W64LIT
(0xc9863f3a9acb95e9),

1079 
W64LIT
(0x5fcf47c57d0b0ed4),

1080 
W64LIT
(0x4aa211e4e1280b4b),

1081 
W64LIT
(0xe1a4c9ba871d1289),

1082 
W64LIT
(0x4926664759f03a4f),

1083 
W64LIT
(0xadfb36ede3707bca),

1084 
W64LIT
(0xcf7bd1891f8ef7e1),

1085 
W64LIT
(0x9735559e8f882792),

1086 
W64LIT
(0x5932a976f84e6cdc),

1087 
W64LIT
(0x9dc792bef547818a),

1088 
W64LIT
(0x06fdeeb385456208),

1089 
W64LIT
(0x46ad38771ea2cf5b),

1090 
W64LIT
(0x5eb36aa41543b27b),

1091 
W64LIT
(0x8b2eb33cd1bcb511),

1092 
W64LIT
(0x71105ff6e598ebbc),

1093 
W64LIT
(0x5441ad846f8c1463),

1094 
W64LIT
(0x4c5fff57646d6943),

1095 
W64LIT
(0xf3485c49f633c9b1),

1096 
W64LIT
(0x9cbbbfdf9d0f3d25),

1097 
W64LIT
(0x22d031a067192178),

1098 
W64LIT
(0xca0248992213a4ed),

1099 
W64LIT
(0x19627fb263a9c18f),

1100 
W64LIT
(0x9330e1efda5dc831),

1101 
W64LIT
(0x1390b89219666797),

1102 
W64LIT
(0x2edf18339893e568),

1103 
W64LIT
(0x6c779435d3e4c590),

1104 
W64LIT
(0x53c06e568281cac4),

1105 
W64LIT
(0x6ff3e3966b3cf494),

1106 
W64LIT
(0xfe3b58bb61f1b10e),

1107 
W64LIT
(0x77edb14560dd89b4),

1108 
W64LIT
(0x02f85ac2d0908dab),

1109 
W64LIT
(0x12ec95f3712edb38),

1110 
W64LIT
(0x85d9c06dfea6fcaa),

1111 
W64LIT
(0x90b4964c6285f935),

1112 
W64LIT
(0xf1b0068b26a3441a),

1113 
W64LIT
(0x729428555d40dab8),

1114 
W64LIT
(0x5c4b3066c5d33fd0),

1115 
W64LIT
(0x5d371d07ad9b837f),

1116 
W64LIT
(0xa48d866e2167ecd6),

1117 
W64LIT
(0xb661139d504937ee),

1118 
W64LIT
(0xa27068dda4228ede),

1119 
W64LIT
(0xf8c6b608e4b4d306),

1120 
W64LIT
(0x6bf657e73ee91b37),

1121 
W64LIT
(0xac871b8c8b38c765),

1122 
W64LIT
(0x4ea7a595b4fde4e8),

1123 
W64LIT
(0x0d7304f297c278bf),

1124 
W64LIT
(0xb71d3efc38018b41),

1125 
W64LIT
(0xae7f414e5ba84ace),

1126 
W64LIT
(0xaf036c2f33e0f661),

1127 
W64LIT
(0x0000000000000000),

1128 
W64LIT
(0xb89660cc7f537e55),

1129 
W64LIT
(0xa675dcacf1f7617d),

1130 
W64LIT
(0x610490c74426bd2f),

1131 
W64LIT
(0xc18ca2d83094be5a),

1132 
W64LIT
(0x2adaac42cd460acb),

1133 
W64LIT
(0x7d1f76651a122fac),

1134 
W64LIT
(0xc58916a9654151f9),

1135 
W64LIT
(0xedabe0297897d699),

1136 
W64LIT
(0x2d5b6f90204bd46c),

1137 
W64LIT
(0x26d585d132cccedb),

1138 
W64LIT
(0x9f3fc87c25d70c21),

1139 
W64LIT
(0xc60d610add9960fd),

1140 
W64LIT
(0x80a0597dc33bafa6),

1141 
W64LIT
(0xd0e44088f9625466),

1142 
W64LIT
(0x1d67cbc3367c2e2c),

1143 
W64LIT
(0x2c2742f1480368c3),

1144 
W64LIT
(0x89d6e9fe012c38ba),

1145 
W64LIT
(0xe9ae54582d42393a),

1146 
W64LIT
(0x3ecbd702392db3fb),

1147 
W64LIT
(0xb5e5643ee89106ea),

1148 
W64LIT
(0xa882affddeed28c6),

1149 
W64LIT
(0x1ae60811db71f08b),

1150 
W64LIT
(0x924ccc8eb215749e),

1151 
W64LIT
(0xfcc30279b1613ca5),

1152 
W64LIT
(0x825803bf13ab220d),

1153 
W64LIT
(0xd992f00b3b75c37a),

1154 
W64LIT
(0xc8fa125bf2832946),

1155 
W64LIT
(0x35453d432baaa94c),

1156 
W64LIT
(0xf9ba9b698cfc6fa9),

1157 
W64LIT
(0x37bd6781fb3a24e7),

1158 
W64LIT
(0x791ac2144fc7c00f),

1159 
W64LIT
(0x16e9218224fb349b),

1160 
W64LIT
(0xdb6aaac9ebe54ed1),

1161 
W64LIT
(0xd8eedd6a533d7fd5),

1162 
W64LIT
(0x7c635b04725a9303),

1163 
W64LIT
(0x553d80e507c4a8cc),

1164 
W64LIT
(0x9a46516c184a5f2d),

1165 
W64LIT
(0x14117b40f46bb930),

1166 
W64LIT
(0x1ee3bc608ea41f28),

1167 
W64LIT
(0x27a9a8b05a847274),

1168 
W64LIT
(0x4050d6c49be7ad53),

1169 
W64LIT
(0x7be298d69f574da4),

1170 
W64LIT
(0x6a8a7a8656a1a798),

1171 
W64LIT
(0x4d23d2360c25d5ec),

1172 
W64LIT
(0x1014cf31a1be5693),

1173 
W64LIT
(0xb264a7ec059cd84d),

1174 
W64LIT
(0xea2a23fb959a083e),

1175 
W64LIT
(0xf0cc2bea4eebf8b5),

1176 
W64LIT
(0x76919c240895351b),

1177 
W64LIT
(0x0b8eea4112871ab7),

1178 
W64LIT
(0x47d1151676ea73f4),

1179 
W64LIT
(0xbdeff9dc42ce2d59),

1180 
W64LIT
(0x2ba68123a50eb664),

1181 
W64LIT
(0x057999103d9d530c),

1182 
W64LIT
(0xe759270902587081),

1183 
W64LIT
(0xef53baeba8075b32),

1184 
W64LIT
(0x4fdb88f4dcb55847),

1185 
W64LIT
(0x6e8fcef70374483b),

1186 
W64LIT
(0x1168e250c9f6ea3c),

1187 
W64LIT
(0x1b9a2570b3394c24),

1188 
W64LIT
(0x706c72978dd05713),

1189 
W64LIT
(0x865db7ce467ecdae),

1190 
W64LIT
(0x52bc4337eac9766b),

1191 
W64LIT
(0x504419f53a59fbc0),

1192 
W64LIT
(0x8f2b074d84695ab2),

1193 
W64LIT
(0x6078bda62c6e0180),

1194 
W64LIT
(0x43d4a167233f9c57),

1195 
W64LIT
(0x0ef773512f1a49bb),

1196 
W64LIT
(0x0c0f2993ff8ac410),

1197 
W64LIT
(0x4bde3c858960b7e4),

1198 
W64LIT
(0x66855315a92b6388),

1199 
W64LIT
(0xd360372b41ba6562),

1200 
W64LIT
(0x584e84179006d073),

1201 
W64LIT
(0x9b3a7c0d7002e382),

1202 
W64LIT
(0xa5f1ab0f492f5079),

1203 
W64LIT
(0x2822f6801dd68760),

1204 
W64LIT
(0x445562b5ce3242f0),

1205 
W64LIT
(0xaa7af53f0e7da56d),

1206 
W64LIT
(0x3c338dc0e9bd3e50),

1207 
W64LIT
(0x3bb24e1204b0e0f7),

1208 
W64LIT
(0xd59dd998c4ff076a),

1209 
W64LIT
(0x91c8bb2d0acd459a),

1210 
W64LIT
(0x84a5ed0c96ee4005),

1211 
W64LIT
(0x33b8d3f0aeefcb44),

1212 
W64LIT
(0x57c5da27d7542567),

1213 
W64LIT
(0x32c4fe91c6a777eb),

1214 
W64LIT
(0x3439102243e215e3),

1215 
W64LIT
(0xc7714c6bb5d1dc52),

1216 
W64LIT
(0x3fb7fa6351650f54),

1217 
W64LIT
(0x87219aaf2e367101),

1218 
W64LIT
(0xf5b5b2fa7376abb9),

1219 
W64LIT
(0x412cfba5f3af11fc),

1220 
W64LIT
(0xdceb691b06e89076),

1221 
W64LIT
(0xbb12176fc78b4f51),

1222 
W64LIT
(0x73e8053435086617),

1223 
W64LIT
(0xe220be193fc5238d),

1224 
W64LIT
(0xb09cfd2ed50c55e6),

1225 
W64LIT
(0xb9ea4dad171bc2fa),

1226 
W64LIT
(0x9e43e51d4d9fb08e),

1227 
W64LIT
(0x36c14ae093729848),

1228 
W64LIT
(0xa9fe829cb6a59469),

1229 
W64LIT
(0x0405b47155d5efa3),

1230 
W64LIT
(0x0af2c7207acfa618),

1231 
W64LIT
(0x7e9b01c6a2ca1ea8),

1232 
W64LIT
(0xdd97447a6ea02cd9),

1233 
W64LIT
(0x0781c3d2ed0ddea7),

1234 
W64LIT
(0x7866ef75278f7ca0),

1235 
W64LIT
(0xd1986de9912ae8c9),

1236 
W64LIT
(0xcb7e65f84a5b1842),

1237 
W64LIT
(0xcd838b4bcf1e7a4a),

1238 
W64LIT
(0xab06d85e663519c2),

1239 
W64LIT
(0xd4e1f4f9acb7bbc5),

1240 
W64LIT
(0xfdbf2f18d929800a),

1241 
W64LIT
(0xf23471289e7b751e),

1242 
W64LIT
(0xbc93d4bd2a8691f6),

1243 
W64LIT
(0x3d4fa0a181f582ff),

1244 
W64LIT
(0xba6e3a0eafc3f3fe),

1245 
W64LIT
(0x5ab6ded540965dd8),

1246 
W64LIT
(0xeb560e9afdd2b491),

1247 
W64LIT
(0x0976b083c217971c),

1248 
W64LIT
(0xecd7cd4810df6a36),

1249 
W64LIT
(0x23ac1cc10f519dd7),

1250 
W64LIT
(0xbe6b8e7ffa161c5d),

1251 
W64LIT
(0x7fe72ca7ca82a207),

1252 
W64LIT
(0xc0f08fb958dc02f5),

1253 
W64LIT
(0x7a9eb5b7f71ff10b),

1254 
W64LIT
(0xa709f1cd99bfddd2),

1255 
W64LIT
(0x8dd35d8f54f9d719),

1256 
W64LIT
(0x8caf70ee3cb16bb6),

1257 
W64LIT
(0xe4dd50aaba804185),

1258 
W64LIT
(0x83242ede7be39ea2),

1259 
W64LIT
(0x98be0baec8dad286),

1260 
W64LIT
(0x690e0d25ee79969c),

1261 
W64LIT
(0x95cd0f5c5f18aa39),

1262 
W64LIT
(0x56b9f746bf1c99c8),

1263 
W64LIT
(0x7469c6e6d805b8b0),

1264 
W64LIT
(0x8a529e5db9f409be),

1265 
W64LIT
(0xe6250a686a10cc2e),

1266 
W64LIT
(0x2fa33552f0db59c7),

1267 
W64LIT
(0x42a88c064b7720f8),

1268 
W64LIT
(0x6d0bb954bbac793f),

1269 
W64LIT
(0x181e52d30be17d20),

1270 
W64LIT
(0xbf17a31e925ea0f2),

1271 
W64LIT
(0x94b1223d37501696),

1272 
W64LIT
(0xe8d27939450a8595),

1273 
W64LIT
(0xccffa62aa756c6e5),

1274 
W64LIT
(0x383639b1bc68d1f3),

1275 
W64LIT
(0xee2f978ac04fe79d),

1276 
W64LIT
(0xa30c45bccc6a3271),

1277 
W64LIT
(0x1f9f9101e6eca387),

1278 
W64LIT
(0xb1e0d04fbd44e949),

1279 
W64LIT
(0x242ddf13e25c4370),

1280 
W64LIT
(0x156d56219c23059f),

1281 
W64LIT
(0x88aac49f69648415),

1282 
W64LIT
(0x6280e764fcfe8c2b),

1283 
W64LIT
(0xdf6f1eb8be30a172),

1284 
W64LIT
(0xe5a17dcbd2c8fd2a),

1285 
W64LIT
(0xe0d8e4dbef55ae26),

1286 
W64LIT
(0x63fcca0594b63084),

1287 
W64LIT
(0xa1f41f7e1cfabfda),

1288 
W64LIT
(0x295edbe1759e3bcf),

1289 
W64LIT
(0x67f97e74c163df27),

1290 
W64LIT
(0x038477a3b8d83104),

1291 
W64LIT
(0xde1333d9d6781ddd),

1292 
W64LIT
(0x3ace63736cf85c58),

1293 
W64LIT
(0xd619ae3b7c27366e),

1294 
W64LIT
(0x5bcaf3b428dee177),

1295 
W64LIT
(0xb3188a8d6dd464e2),

1296 
W64LIT
(0x1c1be6a25e349283),

1297 
W64LIT
(0x017c2d616848bcaf),

1298 
W64LIT
(0x8e572a2cec21e61d),

1299 
W64LIT
(0xf631c559cbae9abd),

1300 
W64LIT
(0x81dc741cab731309),

1301 
W64LIT
(0xff4775da09b90da1),

1302 
W64LIT
(0xb499495f80d9ba45),

1303 
W64LIT
(0x0f8b5e304752f514),

1304 
W64LIT
(0x394a14d0d4206d5c),

1305 
W64LIT
(0xce07fce877c64b4e),

1306 
W64LIT
(0xf4c99f9b1b3e1716),

1307 
W64LIT
(0xc4f53bc80d09ed56),

1308 
W64LIT
(0xc208d57b884c8f5e),

1309 
W64LIT
(0x080a9de2aa5f2bb3),

1310 
W64LIT
(0x314089327e7f46ef),

1311 
W64LIT
(0xfa3eecca34245ead),

1312 
W64LIT
(0x20286b62b789acd3),

1313 
W64LIT
(0x7515eb87b04d041f),

1314 
W64LIT
(0x513834945211476f),

1315 
W64LIT
(0x650124b611f3528c),

1316 
W64LIT
(0x17950ce34cb38834),

1317 
W64LIT
(0x45294fd4a67afe5f),

1318 
W64LIT
(0x21544603dfc1107c),

1319 
W64LIT
(0x485a4b2631b886e0),

1320 
W64LIT
(0x6872204486312a33),

1321 
W64LIT
(0x647d09d779bbee23),

1322 
W64LIT
(0x2551f2728a14ffdf),

1323 
W64LIT
(0xd765835a146f8ac1),

1324 
W64LIT
(0xd21c1a4a29f2d9cd),

1325 
W64LIT
(0x99c226cfa0926e29),

1326 
W64LIT
(0xfb42c1ab5c6ce202),

1327 
W64LIT
(0xc374f81ae00433f1),

1328 
W64LIT
(0x964978ffe7c09b3d),

1329 
W64LIT
(0xf74de838a3e62612),

1331 
W64LIT
(0x74b87b36b0592c6a),

1332 
W64LIT
(0x3d82d75dffb4b81c),

1333 
W64LIT
(0x8884246715267825),

1334 
W64LIT
(0xdaf2d8a77ed4e5de),

1335 
W64LIT
(0xfeb118650e53f9c7),

1336 
W64LIT
(0xbd2d1aea59226b06),

1337 
W64LIT
(0x26ce87f6dbabb191),

1338 
W64LIT
(0x32772ecbeb66bd0a),

1339 
W64LIT
(0xd4bbf82bc5104c8c),

1340 
W64LIT
(0x055357720c4e03a1),

1341 
W64LIT
(0xef5be62a32d0f6fd),

1342 
W64LIT
(0xbe1c84c45d186aca),

1343 
W64LIT
(0xacc7e4a565a1643c),

1344 
W64LIT
(0x8dd7731519687b84),

1345 
W64LIT
(0x11eafe4f3c830f3a),

1346 
W64LIT
(0x04ef8e68a358afe5),

1347 
W64LIT
(0x40ad9ca1534b930d),

1348 
W64LIT
(0xe44191d4855a5c0e),

1349 
W64LIT
(0x6001d20b809420f1),

1350 
W64LIT
(0x73666b70173b8243),

1351 
W64LIT
(0x372479b9e728beab),

1352 
W64LIT
(0x45fecbd35f0590ac),

1353 
W64LIT
(0x7057f55e1301838f),

1354 
W64LIT
(0xff0dc17fa1455583),

1355 
W64LIT
(0x0cc467b810e804da),

1356 
W64LIT
(0xb9c29482fa7ac4e3),

1357 
W64LIT
(0xa003831d754960e6),

1358 
W64LIT
(0x8a096353be0ad5ad),

1359 
W64LIT
(0xdd2cc8e1d9b64bf7),

1360 
W64LIT
(0xc7dc415052bfee3e),

1361 
W64LIT
(0x9f0c137421d17572),

1362 
W64LIT
(0x35a93e8d4c041323),

1363 
W64LIT
(0x9a5f44062d9f76d3),

1364 
W64LIT
(0x71eb2c44bc172fcb),

1365 
W64LIT
(0x0ff5f99614d20516),

1366 
W64LIT
(0x7789e518b4632da6),

1367 
W64LIT
(0xc99561dce97b476c),

1368 
W64LIT
(0x5276fcc06bf29dfb),

1369 
W64LIT
(0x4a0b32454bd795ba),

1370 
W64LIT
(0x9274add69e2fddec),

1371 
W64LIT
(0x4f5865374799961b),

1372 
W64LIT
(0xb2d8e37c4df06e10),

1373 
W64LIT
(0xc4eddf7e5685eff2),

1374 
W64LIT
(0xb3643a66e2e6c254),

1375 
W64LIT
(0xd50721316a06e0c8),

1376 
W64LIT
(0x8bb5ba49111c79e9),

1377 
W64LIT
(0x2bb639546455190f),

1378 
W64LIT
(0xf8d3d1390627fbaa),

1379 
W64LIT
(0x38d1802ff3fabbbd),

1380 
W64LIT
(0xdfa18fd5729ae67f),

1381 
W64LIT
(0x4ee4bc2de88f3a5f),

1382 
W64LIT
(0xf72628af12f5febc),

1383 
W64LIT
(0x0aa6aee4189c06b7),

1384 
W64LIT
(0x0000000000000000),

1385 
W64LIT
(0x9eb0ca6e8ec7d936),

1386 
W64LIT
(0xcb1826e84257eae4),

1387 
W64LIT
(0x187dce8520250841),

1388 
W64LIT
(0xc28f16225ef1ed9f),

1389 
W64LIT
(0xc333cf38f1e741db),

1390 
W64LIT
(0x4220db95f8673e85),

1391 
W64LIT
(0xdc9011fb76a0e7b3),

1392 
W64LIT
(0x105627559395a37e),

1393 
W64LIT
(0x2f59b73cc70db6ea),

1394 
W64LIT
(0xe112c6a689145faf),

1395 
W64LIT
(0x82228a830dba7e92),

1396 
W64LIT
(0x2ee56e26681b1aae),

1397 
W64LIT
(0x2a0ae04ecb43b54b),

1398 
W64LIT
(0x47738ce7f4293d24),

1399 
W64LIT
(0xa7dd935bd22bcecf),

1400 
W64LIT
(0xd2d93177cd644ee1),

1401 
W64LIT
(0xebb4684291885918),

1402 
W64LIT
(0x0e49208cbbc4a952),

1403 
W64LIT
(0xa550d46f79076347),

1404 
W64LIT
(0x411145bbfc5d3f49),

1405 
W64LIT
(0xe6ccd6e02e76f186),

1406 
W64LIT
(0x4bb7eb5fe4c139fe),

1407 
W64LIT
(0x5d8305567f2098ed),

1408 
W64LIT
(0x95aabd90394d73c5),

1409 
W64LIT
(0x25ff19d8df91b05d),

1410 
W64LIT
(0x86cd04ebaee2d177),

1411 
W64LIT
(0x03319e2e043a01cc),

1412 
W64LIT
(0x6b1ba5f5371e8a02),

1413 
W64LIT
(0x76353c021b7581e2),

1414 
W64LIT
(0x64ee5c6323cc8f14),

1415 
W64LIT
(0x5c3fdc4cd03634a9),

1416 
W64LIT
(0x6996e2c19c32278a),

1417 
W64LIT
(0x8938fd7dba30d461),

1418 
W64LIT
(0x7b4d82a0a48b297c),

1419 
W64LIT
(0xbfa05ddef20ec68e),

1420 
W64LIT
(0x8ee6ed3b1d527a48),

1421 
W64LIT
(0x61bd0b112f828cb5),

1422 
W64LIT
(0x66631b5788e0229c),

1423 
W64LIT
(0x55a8ec86cc9033d2),

1424 
W64LIT
(0x1c9240ed837da7a4),

1425 
W64LIT
(0x150570279fdba0df),

1426 
W64LIT
(0x53ca25dac4e431bf),

1427 
W64LIT
(0xd636bf1f6e3ce104),

1428 
W64LIT
(0xcaa4fff2ed4146a0),

1429 
W64LIT
(0x787c1c8ea0b128b0),

1430 
W64LIT
(0xad7b3dbfcab7c878),

1431 
W64LIT
(0xfc3c5f51a57f544f),

1432 
W64LIT
(0xb78bb40e41be6db1),

1433 
W64LIT
(0x8c6baa0fb67ed7c0),

1434 
W64LIT
(0xce4b719a4e19e945),

1435 
W64LIT
(0xf96f0823a93157ee),

1436 
W64LIT
(0x7d2f4bfcacff2b11),

1437 
W64LIT
(0x3eb34973fb8eb9d0),

1438 
W64LIT
(0xe39f81922238f227),

1439 
W64LIT
(0x239dd084d7e5b230),

1440 
W64LIT
(0x1fa3dec38747a668),

1441 
W64LIT
(0xc5510664f99343b6),

1442 
W64LIT
(0xc829b8c6466deb28),

1443 
W64LIT
(0x85fc9ac5aad8d0bb),

1444 
W64LIT
(0xb6376d14eea8c1f5),

1445 
W64LIT
(0x9d8154408afdd8fa),

1446 
W64LIT
(0x3be01e01f7c0ba71),

1447 
W64LIT
(0x628c953f2bb88d79),

1448 
W64LIT
(0x6d796ca93f6a886f),

1449 
W64LIT
(0xfa5e960dad0b5622),

1450 
W64LIT
(0xe5fd48ce2a4cf04a),

1451 
W64LIT
(0xe7700ffa81605dc2),

1452 
W64LIT
(0x2dd4f0086c211b62),

1453 
W64LIT
(0x2221099e78f31e74),

1454 
W64LIT
(0xdb4e01bdd1c2499a),

1455 
W64LIT
(0xf417b68116cfff70),

1456 
W64LIT
(0xb506f33aea92c039),

1457 
W64LIT
(0x514762ee6fc89c37),

1458 
W64LIT
(0x9c3d8d5a25eb74be),

1459 
W64LIT
(0x396d59355cec17f9),

1460 
W64LIT
(0xccc636aee53544cd),

1461 
W64LIT
(0x0b1a77feb78aaaf3),

1462 
W64LIT
(0xe9392f763aa4f490),

1463 
W64LIT
(0xaaa52df96dd56651),

1464 
W64LIT
(0x46cf55fd5b3f9160),

1465 
W64LIT
(0xa4ec0d75d611cf03),

1466 
W64LIT
(0xaff67a8b619b65f0),

1467 
W64LIT
(0x3415e797e312bf67),

1468 
W64LIT
(0x7af15bba0b9d8538),

1469 
W64LIT
(0x811314ad09807f5e),

1470 
W64LIT
(0x8771ddf101f47d33),

1471 
W64LIT
(0x969b23be3d777209),

1472 
W64LIT
(0xd365e86d6272e2a5),

1473 
W64LIT
(0x58d05224736e9b4c),

1474 
W64LIT
(0xc660984afda9427a),

1475 
W64LIT
(0x5414359c63869f96),

1476 
W64LIT
(0xe885f66c95b258d4),

1477 
W64LIT
(0x655285798cda2350),

1478 
W64LIT
(0x6cc5b5b3907c242b),

1479 
W64LIT
(0x6ff42b9d944625e7),

1480 
W64LIT
(0xc0025116f5dd4017),

1481 
W64LIT
(0xa28ec429de65cd6e),

1482 
W64LIT
(0x63304c2584ae213d),

1483 
W64LIT
(0x7fa20cc807d38699),

1484 
W64LIT
(0x996eda2829a5771f),

1485 
W64LIT
(0x1b4c50ab241f098d),

1486 
W64LIT
(0x1e1f07d928510a2c),

1487 
W64LIT
(0x33cbf7d14470114e),

1488 
W64LIT
(0xb055a448e6dcc398),

1489 
W64LIT
(0x98d2033286b3db5b),

1490 
W64LIT
(0xec6a780436eaf731),

1491 
W64LIT
(0xa1bf5a07da5fcca2),

1492 
W64LIT
(0xbaf30aacfe40c52f),

1493 
W64LIT
(0xf144e1f31a81fcd1),

1494 
W64LIT
(0xe0ae1fbc2602f3eb),

1495 
W64LIT
(0x14b9a93d30cd0c9b),

1496 
W64LIT
(0x596c8b3edc783708),

1497 
W64LIT
(0x682a3bdb33248bce),

1498 
W64LIT
(0xb87e4d98556c68a7),

1499 
W64LIT
(0x80afcdb7a696d31a),

1500 
W64LIT
(0x5725abb267bc9e5a),

1501 
W64LIT
(0x914533f89a15dc20),

1502 
W64LIT
(0x5eb29b787b1a9921),

1503 
W64LIT
(0x01bcd91aaf16ac44),

1504 
W64LIT
(0xc1be880c5acbec53),

1505 
W64LIT
(0xedd6a11e99fc5b75),

1506 
W64LIT
(0x028d4734ab2cad88),

1507 
W64LIT
(0x8f5a3421b244d60c),

1508 
W64LIT
(0x4dd52203ecb53b93),

1509 
W64LIT
(0x3f0f906954981594),

1510 
W64LIT
(0xae4aa391ce8dc9b4),

1511 
W64LIT
(0x3698a0a3483e12ef),

1512 
W64LIT
(0xf5ab6f9bb9d95334),

1513 
W64LIT
(0x082be9d0b3b0ab3f),

1514 
W64LIT
(0xd1e8af59c95e4f2d),

1515 
W64LIT
(0xd87f9f93d5f84856),

1516 
W64LIT
(0x6e48f2873b5089a3),

1517 
W64LIT
(0x2443c0c270871c19),

1518 
W64LIT
(0xb1e97d5249ca6fdc),

1519 
W64LIT
(0x7c9392e603e98755),

1520 
W64LIT
(0x839e5399a2acd2d6),

1521 
W64LIT
(0x19c1179f8f33a405),

1522 
W64LIT
(0xde1d56cfdd8c4a3b),

1523 
W64LIT
(0x20ac4eaad3dfb3fc),

1524 
W64LIT
(0x1af089b18b09a5c9),

1525 
W64LIT
(0x3a5cc71b58d61635),

1526 
W64LIT
(0x444212c9f0133ce8),

1527 
W64LIT
(0x72dab26ab82d2e07),

1528 
W64LIT
(0x4c69fb1943a397d7),

1529 
W64LIT
(0xf3c9a6c7b1ad5159),

1530 
W64LIT
(0x1d2e99f72c6b0be0),

1531 
W64LIT
(0xb4ba2a2045846c7d),

1532 
W64LIT
(0xe22358888d2e5e63),

1533 
W64LIT
(0x2887a77a606f18c3),

1534 
W64LIT
(0xa8286acdc6f9cbd9),

1535 
W64LIT
(0x5f0e4262d40c3565),

1536 
W64LIT
(0xeee73f309dc65ab9),

1537 
W64LIT
(0x9be39d1c8289da97),

1538 
W64LIT
(0x1634ee099be1a113),

1539 
W64LIT
(0xea08b1583e9ef55c),

1540 
W64LIT
(0x9727faa49261de4d),

1541 
W64LIT
(0x2c682912c337b726),

1542 
W64LIT
(0xcff7a880e10f4501),

1543 
W64LIT
(0x1788371334f70d57),

1544 
W64LIT
(0x27725eec74bd1dd5),

1545 
W64LIT
(0x3146b0e5ef5cbcc6),

1546 
W64LIT
(0x099730ca1ca6077b),

1547 
W64LIT
(0xf2757fdd1ebbfd1d),

1548 
W64LIT
(0x6aa77cef98082646),

1549 
W64LIT
(0xbb4fd3b65156696b),

1550 
W64LIT
(0x569972a8c8aa321e),

1551 
W64LIT
(0xa3321d337173612a),

1552 
W64LIT
(0x50fbbbf4c0de3073),

1553 
W64LIT
(0x5a5d1510d84236c4),

1554 
W64LIT
(0xfd80864b0a69f80b),

1555 
W64LIT
(0x07de1046a762ae29),

1556 
W64LIT
(0xa6614a417d3d628b),

1557 
W64LIT
(0xd78a6605c12a4d40),

1558 
W64LIT
(0x67dfc24d27f68ed8),

1559 
W64LIT
(0xbc91c3f0f634c742),

1560 
W64LIT
(0xd05476436648e369),

1561 
W64LIT
(0x493aac6b4fed9476),

1562 
W64LIT
(0x12db606138b90ef6),

1563 
W64LIT
(0xa994b3d769ef679d),

1564 
W64LIT
(0x211097b07cc91fb8),

1565 
W64LIT
(0x30fa69ff404a1082),

1566 
W64LIT
(0x3c3e0e4750a21458),

1567 
W64LIT
(0x7504a22c1f4f802e),

1568 
W64LIT
(0x844043df05ce7cff),

1569 
W64LIT
(0xf0f838e9b5975095),

1570 
W64LIT
(0x7e1ed5d2a8c52add),

1571 
W64LIT
(0x90f9eae235037064),

1572 
W64LIT
(0x0662c95c0874026d),

1573 
W64LIT
(0x9416648a965bdf81),

1574 
W64LIT
(0xf69af1b5bde352f8),

1575 
W64LIT
(0x0d78bea2bffea89e),

1576 
W64LIT
(0x293b7e60cf79b487),

1577 
W64LIT
(0xd9c346897aeee412),

1578 
W64LIT
(0xfbe24f17021dfa66),

1579 
W64LIT
(0x1367b97b97afa2b2),

1580 
W64LIT
(0xab19f4e3c2c3ca15),

1581 
W64LIT
(0x48867571e0fb3832),

1582 
W64LIT
(0x93c874cc313971a8),

1583 
W64LIT
(0x79c0c5940fa784f4),

1584 
W64LIT
(0xcd7aefb44a23e889),

1585 
W64LIT
(0x439c028f577192c1),

1586 
W64LIT
(0x5be1cc0a77549a80),

1588 
W64LIT
(0x714d28d778656928),

1589 
W64LIT
(0xc88a7c6b84f64f7c),

1590 
W64LIT
(0xec43cac5ab89aaca),

1591 
W64LIT
(0x777fa38110dc16a3),

1592 
W64LIT
(0x0f7d5c87e4213b5c),

1593 
W64LIT
(0x73f051e5f3a1ef51),

1594 
W64LIT
(0xea714193c330d541),

1595 
W64LIT
(0x95e5f3dae016c4f3),

1596 
W64LIT
(0x63d3738095a0e173),

1597 
W64LIT
(0x9825d66f8ff379d6),

1598 
W64LIT
(0xe8cc38a148f45338),

1599 
W64LIT
(0xa840b0c025f06bb0),

1600 
W64LIT
(0x944135c35f748735),

1601 
W64LIT
(0x74661caa247ad31c),

1602 
W64LIT
(0xe7b16426acd56864),

1603 
W64LIT
(0xd1e689df6e6f0589),

1604 
W64LIT
(0xa73dec47c1d150ec),

1605 
W64LIT
(0x64453ecf427bdd3e),

1606 
W64LIT
(0x0ed99a9e5b43789a),

1607 
W64LIT
(0x7b1b402dc05be840),

1608 
W64LIT
(0x0dc025b56fe5bd25),

1609 
W64LIT
(0x3f183a284e22293a),

1610 
W64LIT
(0xa0aba108160a6ca1),

1611 
W64LIT
(0x46be033705bd4703),

1612 
W64LIT
(0x86df6e94b2b10f6e),

1613 
W64LIT
(0xa216d83a9dceead8),

1614 
W64LIT
(0x129e5b57edc5885b),

1615 
W64LIT
(0x7e3074509c445274),

1616 
W64LIT
(0x7d29cb7ba8e297cb),

1617 
W64LIT
(0x1611a9330eb871a9),

1618 
W64LIT
(0x486799a95efe3f99),

1619 
W64LIT
(0x9fb39b205828459b),

1620 
W64LIT
(0xd0424fc6d10d464f),

1621 
W64LIT
(0xe968feb8f79610fe),

1622 
W64LIT
(0x5d6f8fb164e08b8f),

1623 
W64LIT
(0xaafdc9f2ae34edc9),

1624 
W64LIT
(0x02bd79328bc48679),

1625 
W64LIT
(0x9b3c6944bb55bc69),

1626 
W64LIT
(0x6277b5992ac2a2b5),

1627 
W64LIT
(0x877ba88d0dd34ca8),

1628 
W64LIT
(0xfa5263f6a531db63),

1629 
W64LIT
(0x2e9fde54974164de),

1630 
W64LIT
(0xcda14816d8e9f548),

1631 
W64LIT
(0x675c81e476dd1881),

1632 
W64LIT
(0x2a102c30743c9d2c),

1633 
W64LIT
(0x37f32be07dd82e2b),

1634 
W64LIT
(0x256d70b7901da670),

1635 
W64LIT
(0x4ce86bcdbd83c66b),

1636 
W64LIT
(0x50afaa040b0536aa),

1637 
W64LIT
(0xef5a75ee9f2f6f75),

1638 
W64LIT
(0xb3913c4644ada73c),

1639 
W64LIT
(0x1187e47cd9634de4),

1640 
W64LIT
(0xc54a59deeb13f259),

1641 
W64LIT
(0x0000000000000000),

1642 
W64LIT
(0x01a4c619bf6243c6),

1643 
W64LIT
(0x90cec7a7bc097ec7),

1644 
W64LIT
(0xf94bdcdd91971edc),

1645 
W64LIT
(0x8e347f5c814b087f),

1646 
W64LIT
(0xc7f720ec60d77420),

1647 
W64LIT
(0x354e52d2f61ca852),

1648 
W64LIT
(0x34ea94cb497eeb94),

1649 
W64LIT
(0xae723b964d49143b),

1650 
W64LIT
(0xf48bf968fe72a3f9),

1651 
W64LIT
(0xfc60e8a0cd88a4e8),

1652 
W64LIT
(0x2909931b409a5893),

1653 
W64LIT
(0xbd48a6d81feedfa6),

1654 
W64LIT
(0x6cae2f077181da2f),

1655 
W64LIT
(0xad6b84bd79efd184),

1656 
W64LIT
(0x18c833ad55fb0933),

1657 
W64LIT
(0x204644cacc021c44),

1658 
W64LIT
(0x392ab17e269b56b1),

1659 
W64LIT
(0x14acd001857cf7d0),

1660 
W64LIT
(0x8abb8d386236f18d),

1661 
W64LIT
(0xeefeb3f7204d2cb3),

1662 
W64LIT
(0xf636805a75b62580),

1663 
W64LIT
(0x2bb4ea29cb5edeea),

1664 
W64LIT
(0xc653e6f5dfb537e6),

1665 
W64LIT
(0x8d2dc077b5edcdc0),

1666 
W64LIT
(0x31c1a0b6156151a0),

1667 
W64LIT
(0xf8ef1ac42ef55d1a),

1668 
W64LIT
(0xdbb0e125d65184e1),

1669 
W64LIT
(0x82509cf051ccf69c),

1670 
W64LIT
(0xe33e96424fa89196),

1671 
W64LIT
(0xdf3f1341352c7d13),

1672 
W64LIT
(0x8f90b9453e294bb9),

1673 
W64LIT
(0x1023226566010e22),

1674 
W64LIT
(0xa58095754a15d695),

1675 
W64LIT
(0x2c22a7661c85e2a7),

1676 
W64LIT
(0xe183ef70c46c17ef),

1677 
W64LIT
(0xafd6fd8ff22b57fd),

1678 
W64LIT
(0x471ac52ebadf04c5),

1679 
W64LIT
(0x4d4cadd402e185ad),

1680 
W64LIT
(0x916a01be036b3d01),

1681 
W64LIT
(0x28ad5502fff81b55),

1682 
W64LIT
(0x3657edf9c2ba6ded),

1683 
W64LIT
(0xd2ff36f45ac9c036),

1684 
W64LIT
(0xf1a0cd15a26d19cd),

1685 
W64LIT
(0xd90d98175d950298),

1686 
W64LIT
(0xf7924643cad46646),

1687 
W64LIT
(0xdd826a73bee8fb6a),

1688 
W64LIT
(0x9d0ee212d3ecc3e2),

1689 
W64LIT
(0xb6ba083b18b21d08),

1690 
W64LIT
(0x3da5431ac5e6af43),

1691 
W64LIT
(0x08eb11c833fa0711),

1692 
W64LIT
(0x052b347d5c1fba34),

1693 
W64LIT
(0x6fb7902c45271f90),

1694 
W64LIT
(0x133a9d4e52a7cb9d),

1695 
W64LIT
(0x6e135635fa455c56),

1696 
W64LIT
(0x725497fc4cc3ac97),

1697 
W64LIT
(0xf31db42729a99fb4),

1698 
W64LIT
(0x846217a639758917),

1699 
W64LIT
(0x4b7e26826a58fa26),

1700 
W64LIT
(0x235ffbe1f8a4d9fb),

1701 
W64LIT
(0xff79578bf92e6157),

1702 
W64LIT
(0xda14273c6933c727),

1703 
W64LIT
(0x8b1f4b21dd54b24b),

1704 
W64LIT
(0x9caa240b6c8e8024),

1705 
W64LIT
(0xc1c5abba086e0bab),

1706 
W64LIT
(0xde9bd5588a4e3ed5),

1707 
W64LIT
(0x2d86617fa3e7a161),

1708 
W64LIT
(0xbff5dfea942a59df),

1709 
W64LIT
(0x66f847fdc9bf5b47),

1710 
W64LIT
(0x3b97c84cad5fd0c8),

1711 
W64LIT
(0x3ebcfc31f1406afc),

1712 
W64LIT
(0xca3705590f32c905),

1713 
W64LIT
(0x24c9b6ae2f7fe5b6),

1714 
W64LIT
(0x408c88616d043888),

1715 
W64LIT
(0x93d7788c88afbb78),

1716 
W64LIT
(0x196cf5b4ea994af5),

1717 
W64LIT
(0x9a98af5d0437ffaf),

1718 
W64LIT
(0x8c89066e0a8f8e06),

1719 
W64LIT
(0xab590feb1156ae0f),

1720 
W64LIT
(0xd7d4028906d67a02),

1721 
W64LIT
(0xe4a8db0d9873addb),

1722 
W64LIT
(0xc378d28883aa8dd2),

1723 
W64LIT
(0x4ff1d4e6892503d4),

1724 
W64LIT
(0xd670c490b9b439c4),

1725 
W64LIT
(0x65e1f8d6fd199ef8),

1726 
W64LIT
(0xf2b9723e96cbdc72),

1727 
W64LIT
(0xb12c4574cf692145),

1728 
W64LIT
(0x569d215263bc4921),

1729 
W64LIT
(0x69851b7a2d9e601b),

1730 
W64LIT
(0x5e76309a50464e30),

1731 
W64LIT
(0x5fd2f683ef240df6),

1732 
W64LIT
(0xd8a95e0ee2f7415e),

1733 
W64LIT
(0xe29a505bf0cad250),

1734 
W64LIT
(0x96fc4cf1d4b0014c),

1735 
W64LIT
(0x8806f40ae9f277f4),

1736 
W64LIT
(0x53b6152f3fa3f315),

1737 
W64LIT
(0x1c47c1c9b686f0c1),

1738 
W64LIT
(0x80ede5c2da0870e5),

1739 
W64LIT
(0xd5697bbb8d12fc7b),

1740 
W64LIT
(0xfdc42eb972eae72e),

1741 
W64LIT
(0x0bf2aee3075cc2ae),

1742 
W64LIT
(0x22fb3df847c69a3d),

1743 
W64LIT
(0xbadeeb97c835e3eb),

1744 
W64LIT
(0xdc26ac6a018ab8ac),

1745 
W64LIT
(0xbcec60c1a08c9c60),

1746 
W64LIT
(0x4231f153e6c0bef1),

1747 
W64LIT
(0x337cd9849ea5d7d9),

1748 
W64LIT
(0x5b5d04e70c59f404),

1749 
W64LIT
(0x79a6391f4b9f6e39),

1750 
W64LIT
(0x5212d33680c1b0d3),

1751 
W64LIT
(0xb5a3b7102c14d8b7),

1752 
W64LIT
(0x7f94b249232611b2),

1753 
W64LIT
(0x17b56f2ab1da326f),

1754 
W64LIT
(0x59e07dd5879d727d),

1755 
W64LIT
(0xebd5878a7c529687),

1756 
W64LIT
(0xbb7a2d8e7757a02d),

1757 
W64LIT
(0x0319bf2b34a6c5bf),

1758 
W64LIT
(0x5ccb49a8db82c849),

1759 
W64LIT
(0x1de307d009e4b307),

1760 
W64LIT
(0x49c35fb0e19c7c5f),

1761 
W64LIT
(0x55849e79571a8c9e),

1762 
W64LIT
(0x7abf86347f39ab86),

1763 
W64LIT
(0x9273be9537cdf8be),

1764 
W64LIT
(0xe615a23f13b72ba2),

1765 
W64LIT
(0x6821dd6392fc23dd),

1766 
W64LIT
(0x5af9c2feb33bb7c2),

1767 
W64LIT
(0x06328b5668b97f8b),

1768 
W64LIT
(0x44037a058e79c17a),

1769 
W64LIT
(0x83f45ae9eeaeb55a),

1770 
W64LIT
(0x5739e74bdcde0ae7),

1771 
W64LIT
(0xfbf6a5ef1a5398a5),

1772 
W64LIT
(0xe50c1d142711ee1d),

1773 
W64LIT
(0x1a754a9fde3f8f4a),

1774 
W64LIT
(0x7802ff06f4fd2dff),

1775 
W64LIT
(0xf52f3f714110e03f),

1776 
W64LIT
(0x2674cf9ca4bb63cf),

1777 
W64LIT
(0x60caccaba10624cc),

1778 
W64LIT
(0xb088836d700b6283),

1779 
W64LIT
(0xa6992a5e7eb3132a),

1780 
W64LIT
(0xa9e476d99a922876),

1781 
W64LIT
(0x6b386248a65ae662),

1782 
W64LIT
(0xc2dc14913cc8ce14),

1783 
W64LIT
(0x76db6598afbe5565),

1784 
W64LIT
(0x32d81f9d21c7941f),

1785 
W64LIT
(0x21e282d373605f82),

1786 
W64LIT
(0xc0616da3b70c486d),

1787 
W64LIT
(0x616e0ab21e64670a),

1788 
W64LIT
(0x6d0ae91ecee399e9),

1789 
W64LIT
(0x27d009851bd92009),

1790 
W64LIT
(0xfedd9192464c2291),

1791 
W64LIT
(0x45a7bc1c311b82bc),

1792 
W64LIT
(0x54205860e878cf58),

1793 
W64LIT
(0xa10f6711a9682f67),

1794 
W64LIT
(0x9981107630913a10),

1795 
W64LIT
(0xede70cdc14ebe90c),

1796 
W64LIT
(0x70e9eecec7072aee),

1797 
W64LIT
(0x1f5e7ee28220357e),

1798 
W64LIT
(0x2f3b184d28232718),

1799 
W64LIT
(0x41284e78d2667b4e),

1800 
W64LIT
(0xa424536cf5779553),

1801 
W64LIT
(0xa3b21e2322aca91e),

1802 
W64LIT
(0x4e5512ff36474012),

1803 
W64LIT
(0x1efab8fb3d4276b8),

1804 
W64LIT
(0x89a2321356903432),

1805 
W64LIT
(0xcb93c340b0508ac3),

1806 
W64LIT
(0x306566afaa031266),

1807 
W64LIT
(0x4adae09bd53ab9e0),

1808 
W64LIT
(0xc92eba723b940cba),

1809 
W64LIT
(0x094fd7d18c9844d7),

1810 
W64LIT
(0xcc058e0f678bb68e),

1811 
W64LIT
(0xd4cdbda23270bfbd),

1812 
W64LIT
(0x0a5668fab83e8168),

1813 
W64LIT
(0x510b6c1db467756c),

1814 
W64LIT
(0xb86392a543f16592),

1815 
W64LIT
(0x048ff264e37df9f2),

1816 
W64LIT
(0x3a330e55123d930e),

1817 
W64LIT
(0xb235fa5ffbcfe4fa),

1818 
W64LIT
(0xb9c754bcfc932654),

1819 
W64LIT
(0x3c0185037a84ec85),

1820 
W64LIT
(0x0c64e3acd087fee3),

1821 
W64LIT
(0xe02729697b0e5429),

1822 
W64LIT
(0x07964d4fd7db3c4d),

1823 
W64LIT
(0x814923db656a3323),

1824 
W64LIT
(0x388e776799f91577),

1825 
W64LIT
(0x6a9ca4511938a5a4),

1826 
W64LIT
(0x1bd18c86615dcc8c),

1827 
W64LIT
(0xb407710993769b71),

1828 
W64LIT
(0x150816183a1eb416),

1829 
W64LIT
(0x4395374a59a2fd37),

1830 
W64LIT
(0xc4ee9fc75471b19f),

1831 
W64LIT
(0x5844bbcc38ff31bb),

1832 
W64LIT
(0xcf1c3124532d7331),

1833 
W64LIT
(0xb71ece22a7d05ece),

1834 
W64LIT
(0xaccf42a4c68d9242),

1835 
W64LIT
(0x97588ae86bd2428a),

1836 
W64LIT
(0x75c2dab39b1890da),

1837 
W64LIT
(0x9e175d39e74a065d),

1838 
W64LIT
(0xf0040b0c1d0f5a0b),

1839 
W64LIT
(0xceb8f73dec4f30f7),

1840 
W64LIT
(0xbe5119f32b481a19),

1841 
W64LIT
(0xd35bf0ede5ab83f0),

1842 
W64LIT
(0x7c8d0d621780d40d),

1843 
W64LIT
(0x85c6d1bf8617cad1),

1845 
W64LIT
(0xb1c742127b66f2a4),

1846 
W64LIT
(0xce916098d7a59fc1),

1847 
W64LIT
(0xc312ef8e2406fa70),

1848 
W64LIT
(0x956c7dced81403d5),

1849 
W64LIT
(0x5a0c9b2318dd9520),

1850 
W64LIT
(0xad0d57f51a480e8b),

1851 
W64LIT
(0xe7b9d05287740b01),

1852 
W64LIT
(0x0217f9ea2ed81268),

1853 
W64LIT
(0x4d7cff19f8cd3a06),

1854 
W64LIT
(0x44d1772e572b7b67),

1855 
W64LIT
(0xfb73c5b5e65af72e),

1856 
W64LIT
(0x91427aef84512705),

1857 
W64LIT
(0x0c720963e4cf6c85),

1858 
W64LIT
(0x87c398a0732d8117),

1859 
W64LIT
(0xa17f5e96fe87620e),

1860 
W64LIT
(0x50476c8b8e8fcf1d),

1861 
W64LIT
(0xcb4ee1cc9c8cb225),

1862 
W64LIT
(0x67b2304c91a8b59a),

1863 
W64LIT
(0x54696baad2caebcd),

1864 
W64LIT
(0xddcf03836bf01437),

1865 
W64LIT
(0x46c68ec479f3690f),

1866 
W64LIT
(0x8f9f96e2cba7c942),

1867 
W64LIT
(0xe1802e99f5e93db9),

1868 
W64LIT
(0x4e9a8086c179215a),

1869 
W64LIT
(0xf0c9b4686764a427),

1870 
W64LIT
(0xfd4a3b7e94c7c196),

1871 
W64LIT
(0xfcbbbd0b83abc8a2),

1872 
W64LIT
(0xebcbd93163bb6784),

1873 
W64LIT
(0xf9643c5fc882e546),

1874 
W64LIT
(0xc4da973041f7c5fc),

1875 
W64LIT
(0x1af3eb2c13b3ca97),

1876 
W64LIT
(0x6e1fb87b3e4ef4fb),

1877 
W64LIT
(0x5e229c024498b1f0),

1878 
W64LIT
(0xf516353c2c4d89c3),

1879 
W64LIT
(0xcc869972f97d8da9),

1880 
W64LIT
(0x8d886f08e57fdb2a),

1881 
W64LIT
(0x1cca15e7612efc2f),

1882 
W64LIT
(0x567e9240fc12f9a5),

1883 
W64LIT
(0x43190f9032da44eb),

1884 
W64LIT
(0xfeac44e1ad73daca),

1885 
W64LIT
(0x07c878be65f13f8c),

1886 
W64LIT
(0x618bce87e3358322),

1887 
W64LIT
(0xf895ba2adfeeec72),

1888 
W64LIT
(0x751dd5223a913758),

1889 
W64LIT
(0x59eae4bc21698e7c),

1890 
W64LIT
(0xff5dc294ba1fd3fe),

1891 
W64LIT
(0x03e67f9f39b41b5c),

1892 
W64LIT
(0x2292c117d1efc7c9),

1893 
W64LIT
(0x8a4017b6808ee4a6),

1894 
W64LIT
(0xd1bd0ae08f3f78b2),

1895 
W64LIT
(0x135e631bbc558bf6),

1896 
W64LIT
(0xee14586528924a60),

1897 
W64LIT
(0x8857ee5cae56f6ce),

1898 
W64LIT
(0x0000000000000000),

1899 
W64LIT
(0x0e65f089ca177eed),

1900 
W64LIT
(0x34132358269361db),

1901 
W64LIT
(0x15679dd0cec8bd4e),

1902 
W64LIT
(0x800be01e16dcbe9b),

1903 
W64LIT
(0x949dfbbbcf780ae1),

1904 
W64LIT
(0xe397d773db312fd1),

1905 
W64LIT
(0xedf227fa1126513c),

1906 
W64LIT
(0xb5e945332723d674),

1907 
W64LIT
(0x53a11314b73bd441),

1908 
W64LIT
(0x23634762c683cefd),

1909 
W64LIT
(0x4b4501d28a500cbe),

1910 
W64LIT
(0x473708b16e9f603b),

1911 
W64LIT
(0x1770643ae010af26),

1912 
W64LIT
(0xa746a05d8c1a54b6),

1913 
W64LIT
(0x90b3fc9a933d2e31),

1914 
W64LIT
(0x35e2a52d31ff68ef),

1915 
W64LIT
(0xab34a93e68d53833),

1916 
W64LIT
(0xd81082d720d939d3),

1917 
W64LIT
(0xb86aca25d480b3c5),

1918 
W64LIT
(0xdfd8fa694528065f),

1919 
W64LIT
(0x4f6b06f3d615286e),

1920 
W64LIT
(0x578f1435eb7ef091),

1921 
W64LIT
(0x9af80b32056f740c),

1922 
W64LIT
(0x92a40570bde53c59),

1923 
W64LIT
(0xdbf6fd48196d228f),

1924 
W64LIT
(0x1b026d5904dfc3a3),

1925 
W64LIT
(0x3c4f2d1a9e19298e),

1926 
W64LIT
(0xc8a89e53a538a979),

1927 
W64LIT
(0x991e74ad3cdb6f50),

1928 
W64LIT
(0x042e07215c4524d0),

1929 
W64LIT
(0x8e6e1097dccbc076),

1930 
W64LIT
(0xe071a8ece285348d),

1931 
W64LIT
(0xd784f42bfda24e0a),

1932 
W64LIT
(0x7d41db60821b7f0d),

1933 
W64LIT
(0x85d4614a5df5937f),

1934 
W64LIT
(0xbb8cb5baed34a899),

1935 
W64LIT
(0x40ff700f0b6e5fb7),

1936 
W64LIT
(0x2cf7319e1bf8b924),

1937 
W64LIT
(0x3a76d3d1ec841f36),

1938 
W64LIT
(0x4520f15b40477253),

1939 
W64LIT
(0xf138321d7008ad13),

1940 
W64LIT
(0x42e889e525b64ddf),

1941 
W64LIT
(0x65a5c9a6bf70a7f2),

1942 
W64LIT
(0x208538fdff37d5a1),

1943 
W64LIT
(0x410ef67a1c025683),

1944 
W64LIT
(0x18e412c63d6bd8ff),

1945 
W64LIT
(0x72d5ad9c5f6008d4),

1946 
W64LIT
(0x255ab9a9b41ef845),

1947 
W64LIT
(0x93558305aa89356d),

1948 
W64LIT
(0x70c2547671b81abc),

1949 
W64LIT
(0x3604dab2084b73b3),

1950 
W64LIT
(0x05df81544b292de4),

1951 
W64LIT
(0xf2de4d8249bcb64f),

1952 
W64LIT
(0x0bba71dd813e5309),

1953 
W64LIT
(0xa368a77cd05f7066),

1954 
W64LIT
(0x796fdc41de5e5bdd),

1955 
W64LIT
(0xec03a18f064a5808),

1956 
W64LIT
(0x085c0e42b88a4855),

1957 
W64LIT
(0x274d40439ac6ea2d),

1958 
W64LIT
(0x31cca20c6dba4c3f),

1959 
W64LIT
(0x322add93540e5763),

1960 
W64LIT
(0xb60f3aac1e97cd28),

1961 
W64LIT
(0x7cb05d1595777639),

1962 
W64LIT
(0xb036c4676c0afb90),

1963 
W64LIT
(0x0a4bf7a896525a3d),

1964 
W64LIT
(0x73242be9480c01e0),

1965 
W64LIT
(0x5bfd1d560fb19c14),

1966 
W64LIT
(0x7b7825abf08649b5),

1967 
W64LIT
(0xb7febcd909fbc41c),

1968 
W64LIT
(0x81fa666b01b0b7af),

1969 
W64LIT
(0xd25b757fb68b63ee),

1970 
W64LIT
(0x0d838f16f3a365b1),

1971 
W64LIT
(0x6a31bf5a620bd02b),

1972 
W64LIT
(0x26bcc6368daae319),

1973 
W64LIT
(0x9ed60c13592a50dc),

1974 
W64LIT
(0x581b62c936058748),

1975 
W64LIT
(0x9cc1f5f977f242b4),

1976 
W64LIT
(0x83ed9f812f68a5c7),

1977 
W64LIT
(0x74ec53572dfd3e6c),

1978 
W64LIT
(0xb3d0bbf855bee0cc),

1979 
W64LIT
(0xacfcd1800d2407bf),

1980 
W64LIT
(0x303d24797ad6450b),

1981 
W64LIT
(0x7a89a3dee7ea4081),

1982 
W64LIT
(0x69d7c0c55bbfcb77),

1983 
W64LIT
(0x770a2cc814492530),

1984 
W64LIT
(0x0f9476fcdd7b77d9),

1985 
W64LIT
(0xaeeb286a23fc15d7),

1986 
W64LIT
(0x2174be88e85bdc95),

1987 
W64LIT
(0xde297c1c52440f6b),

1988 
W64LIT
(0xd04c8c9598537186),

1989 
W64LIT
(0x2ee0c8743520ab4c),

1990 
W64LIT
(0x977b8424f6cc11bd),

1991 
W64LIT
(0x10b81c8485e190aa),

1992 
W64LIT
(0xa4a0dfc2b5ae4fea),

1993 
W64LIT
(0x98eff2d82bb76664),

1994 
W64LIT
(0xa8d2d6a15161236f),

1995 
W64LIT
(0xd4628bb4c4165556),

1996 
W64LIT
(0x682646b04cd3c243),

1997 
W64LIT
(0x2d06b7eb0c94b010),

1998 
W64LIT
(0x626db118da81987e),

1999 
W64LIT
(0x2928b0ca50d194c0),

2000 
W64LIT
(0x6df9c7e407faefa7),

2001 
W64LIT
(0x1681e24ff77ca612),

2002 
W64LIT
(0x4952f838a4881ed6),

2003 
W64LIT
(0x76fbaabd03252c04),

2004 
W64LIT
(0xc73ce8af7843dea0),

2005 
W64LIT
(0xe82da6ae5a0f7cd8),

2006 
W64LIT
(0xc10516640adee818),

2007 
W64LIT
(0x968a0251e1a01889),

2008 
W64LIT
(0x37f55cc71f277a87),

2009 
W64LIT
(0xe5ae29b8a9ac1969),

2010 
W64LIT
(0xcabf67b98be0bb11),

2011 
W64LIT
(0xf4e7b3493b2180f7),

2012 
W64LIT
(0xe9dc20db4d6375ec),

2013 
W64LIT
(0x639c376dcded914a),

2014 
W64LIT
(0x12afe56eab3982c2),

2015 
W64LIT
(0xc2e369fb336af344),

2016 
W64LIT
(0xa6b726289b765d82),

2017 
W64LIT
(0x14961ba5d9a4b47a),

2018 
W64LIT
(0xbc44cd0488c59715),

2019 
W64LIT
(0xd3aaf30aa1e76ada),

2020 
W64LIT
(0x28d936bf47bd9df4),

2021 
W64LIT
(0xaf1aae1f34901ce3),

2022 
W64LIT
(0x2f114e01224ca278),

2023 
W64LIT
(0xe648562790180235),

2024 
W64LIT
(0x24ab3fdca372f171),

2025 
W64LIT
(0x52509561a057dd75),

2026 
W64LIT
(0xc6cd6eda6f2fd794),

2027 
W64LIT
(0xa08ed8e3e9eb6b3a),

2028 
W64LIT
(0x09ad8837afe64161),

2029 
W64LIT
(0xbdb54b719fa99e21),

2030 
W64LIT
(0x8c79e97df213d21e),

2031 
W64LIT
(0xcf60e6edc0c996f5),

2032 
W64LIT
(0x5dc4e39d7d2caaac),

2033 
W64LIT
(0x11499af1928d999e),

2034 
W64LIT
(0x5fd31a7753f4b8c4),

2035 
W64LIT
(0x01f18675176c0934),

2036 
W64LIT
(0xc52b1145569bccc8),

2037 
W64LIT
(0x9f278a664e4659e8),

2038 
W64LIT
(0x3dbeab6f897520ba),

2039 
W64LIT
(0xa2992109c7337952),

2040 
W64LIT
(0x9b098d4712037d38),

2041 
W64LIT
(0xc9591826b254a04d),

2042 
W64LIT
(0x3b8755a4fbe81602),

2043 
W64LIT
(0xbe5334eea61d857d),

2044 
W64LIT
(0x51b6eafe99e3c629),

2045 
W64LIT
(0x191594b32a07d1cb),

2046 
W64LIT
(0x1f2c6a78589ae773),

2047 
W64LIT
(0x3fa95285a7ad32d2),

2048 
W64LIT
(0x5c3565e86a40a398),

2049 
W64LIT
(0xb2213d8d42d2e9f8),

2050 
W64LIT
(0xefe5de103ffe4354),

2051 
W64LIT
(0x4ab487a79d3c058a),

2052 
W64LIT
(0xcd771f07ee11849d),

2053 
W64LIT
(0xbfa2b29bb1718c49),

2054 
W64LIT
(0xba7d33cffa58a1ad),

2055 
W64LIT
(0x6fee3e0e2922fdcf),

2056 
W64LIT
(0x64544fd3a81caec6),

2057 
W64LIT
(0xd9e104a237b530e7),

2058 
W64LIT
(0xf32fcbf75ed0bf7b),

2059 
W64LIT
(0x3e58d4f0b0c13be6),

2060 
W64LIT
(0xb418c346304fdf40),

2061 
W64LIT
(0xaac52f4b7fb93107),

2062 
W64LIT
(0xdc3e85f67c9c1d03),

2063 
W64LIT
(0xd5930dc1d37a5c62),

2064 
W64LIT
(0x0639fecb729d36b8),

2065 
W64LIT
(0xc0f490111db2e12c),

2066 
W64LIT
(0x7ea7a4ffbbaf6451),

2067 
W64LIT
(0xf6f04aa315f9929f),

2068 
W64LIT
(0x6643b63986c4bcae),

2069 
W64LIT
(0x6c0841911096e693),

2070 
W64LIT
(0x8425e73f4a999a4b),

2071 
W64LIT
(0x7133d20366d41388),

2072 
W64LIT
(0x38612a3bc25c0d5e),

2073 
W64LIT
(0xb99b4c50c3ecbaf1),

2074 
W64LIT
(0x1d3b93927642f51b),

2075 
W64LIT
(0x7f56228aacc36d65),

2076 
W64LIT
(0x9d30738c609e4b80),

2077 
W64LIT
(0x48a37e4db3e417e2),

2078 
W64LIT
(0x8bb191c397e2ed92),

2079 
W64LIT
(0x2acecf5569658f9c),

2080 
W64LIT
(0xda077b3d0e012bbb),

2081 
W64LIT
(0xa55159b7a2c246de),

2082 
W64LIT
(0x33db5be643625e57),

2083 
W64LIT
(0x821c19f43804acf3),

2084 
W64LIT
(0x3990ac4ed530046a),

2085 
W64LIT
(0xd675725eeace473e),

2086 
W64LIT
(0x789e5a34c93252e9),

2087 
W64LIT
(0x86321ed564418823),

2088 
W64LIT
(0xfa8243c0f136fe1a),

2089 
W64LIT
(0xe45fafcdbec0105d),

2090 
W64LIT
(0x2b3f49207e0986a8),

2091 
W64LIT
(0xa92350d4460d2a5b),

2092 
W64LIT
(0x1eddec0d4ff6ee47),

2093 
W64LIT
(0x89a66829b93afffa),

2094 
W64LIT
(0x607a48f2f4598a16),

2095 
W64LIT
(0x6bc0392f7567d91f),

2096 
W64LIT
(0xea3a5f4474d76eb0),

2097 
W64LIT
(0x5598eddfc5a6e2f9),

2098 
W64LIT
(0x4c8d796cefa13332),

2099 
W64LIT
(0xf701ccd602959bab),

2100 
W64LIT
(0xe2665106cc5d26e5),

2103 cÚ¡ 
wÜd64
 
	gSHARK
::
Dec
::
cbox
[8][256] = {

2105 
W64LIT
(0xe6126af05e55aff3),

2106 
W64LIT
(0x4b6c893f310b0835),

2107 
W64LIT
(0xaa4c0e84ebfc8d57),

2108 
W64LIT
(0xfb9b5c7bf3b3090d),

2109 
W64LIT
(0x4508a6a9ccba5ce2),

2110 
W64LIT
(0xe5d1d2064dc6bde9),

2111 
W64LIT
(0x348343755288edde),

2112 
W64LIT
(0xb684505de46b250c),

2113 
W64LIT
(0xa8cede205a1e91e8),

2114 
W64LIT
(0x40b89b46f9fa6acc),

2115 
W64LIT
(0x8ee1ec1afab080ba),

2116 
W64LIT
(0xde77d6b7408e0a45),

2117 
W64LIT
(0x9a3e184c2e455802),

2118 
W64LIT
(0xbe93fad23f0955ef),

2119 
W64LIT
(0x3ae76ce3af39b909),

2120 
W64LIT
(0xad7ee3cf6f5ea7c6),

2121 
W64LIT
(0x8b51d1f5cff0b694),

2122 
W64LIT
(0x70ca8d8e3c43bf99),

2123 
W64LIT
(0xccdba7f8b2a8f6c9),

2124 
W64LIT
(0x4c5e6474b5a922a4),

2125 
W64LIT
(0x5d31adcd541ccc32),

2126 
W64LIT
(0x9b7f701e8c3456a7),

2127 
W64LIT
(0x2ac9cd08ecfd593a),

2128 
W64LIT
(0x8fa0844858c18e1f),

2129 
W64LIT
(0x32f0c66c745bc9ea),

2130 
W64LIT
(0xc58d6525cbbb888f),

2131 
W64LIT
(0x8c633cbe4b529c05),

2132 
W64LIT
(0xf2cd9ea68aa0774b),

2133 
W64LIT
(0x2cba4811ca2e7d0e),

2134 
W64LIT
(0xe2e33f4dc9649778),

2135 
W64LIT
(0xf4be1bbfac73537f),

2136 
W64LIT
(0x22de6787379f29d9),

2137 
W64LIT
(0x0956c2dd79137e46),

2138 
W64LIT
(0xe061efe978868bc7),

2139 
W64LIT
(0x1cc85ed90f97a85b),

2140 
W64LIT
(0x31337e9a67c8dbf0),

2141 
W64LIT
(0x360193d1e36af161),

2142 
W64LIT
(0x7fefca4a6383e5eb),

2143 
W64LIT
(0x8535fe633241e243),

2144 
W64LIT
(0xc3fee03ced68acbb),

2145 
W64LIT
(0x81c4abdea570dac8),

2146 
W64LIT
(0x67d6c12efb25753b),

2147 
W64LIT
(0xa4282112164dd980),

2148 
W64LIT
(0xcf181f0ea13be4d3),

2149 
W64LIT
(0xa98fb672f86f9f4d),

2150 
W64LIT
(0x5c70c59ff66dc297),

2151 
W64LIT
(0xb0f7d544c2b80138),

2152 
W64LIT
(0x0da79760ee2246cd),

2153 
W64LIT
(0x3740fb83411bffc4),

2154 
W64LIT
(0x24ade29e114c0ded),

2155 
W64LIT
(0xf858e48de0201b17),

2156 
W64LIT
(0x0e642f96fdb154d7),

2157 
W64LIT
(0xddb46e41531d185f),

2158 
W64LIT
(0x25ec8accb33d0348),

2159 
W64LIT
(0x0282d0a4b1e21cbf),

2160 
W64LIT
(0x1bfab3928b3582ca),

2161 
W64LIT
(0xaffc336bdebcbb79),

2162 
W64LIT
(0x35c22b27f0f9e37b),

2163 
W64LIT
(0x03c3b8f61393121a),

2164 
W64LIT
(0xb8e07fcb19da71db),

2165 
W64LIT
(0x99fda0ba3dd64a18),

2166 
W64LIT
(0xce59775c034aea76),

2167 
W64LIT
(0x49ee599b80e9148a),

2168 
W64LIT
(0xfe2b6194c6f33f23),

2169 
W64LIT
(0x4edcb4d0044b3e1b),

2170 
W64LIT
(0xd5a3c4ce887f68bc),

2171 
W64LIT
(0xdf36bee5e2ff04e0),

2172 
W64LIT
(0x171c4ca0c766caa2),

2173 
W64LIT
(0x0bd41279c8f162f9),

2174 
W64LIT
(0xe490ba54efb7b34c),

2175 
W64LIT
(0x5b4228d472cfe806),

2176 
W64LIT
(0x5355825ba9ad98e5),

2177 
W64LIT
(0x9f8e25a31b056e2c),

2178 
W64LIT
(0xcd9acfaa10d9f86c),

2179 
W64LIT
(0x88926903dc63a48e),

2180 
W64LIT
(0xb40680f9558939b3),

2181 
W64LIT
(0x239f0fd595ee277c),

2182 
W64LIT
(0xec8710db34d5c3af),

2183 
W64LIT
(0x87b72ec783a3fefc),

2184 
W64LIT
(0x632794936c144db0),

2185 
W64LIT
(0x46cb1e5fdf294ef8),

2186 
W64LIT
(0x83467b7a1492c677),

2187 
W64LIT
(0x9c4d9d5508967c36),

2188 
W64LIT
(0xd6607c389bec7aa6),

2189 
W64LIT
(0x165d24f26517c407),

2190 
W64LIT
(0xc4cc0d7769ca862a),

2191 
W64LIT
(0xcbe94ab3360adc58),

2192 
W64LIT
(0x847496319030ece6),

2193 
W64LIT
(0x7a5ff7a556c3d3c5),

2194 
W64LIT
(0xc03d58cafefbbea1),

2195 
W64LIT
(0x76b908971a909bad),

2196 
W64LIT
(0x2f79f0e7d9bd6f14),

2197 
W64LIT
(0x197863363ad79e75),

2198 
W64LIT
(0xda86830ad7bf32ce),

2199 
W64LIT
(0x5a034086d0bee6a3),

2200 
W64LIT
(0x97998f2cc0671ecf),

2201 
W64LIT
(0x552607428f7ebcd1),

2202 
W64LIT
(0x51d752ff184f845a),

2203 
W64LIT
(0xbb23c73d0a4963c1),

2204 
W64LIT
(0x2b88a55a4e8c579f),

2205 
W64LIT
(0xd80453ae665d2e71),

2206 
W64LIT
(0xee05c07f8537df10),

2207 
W64LIT
(0x423a4be248187673),

2208 
W64LIT
(0xcaa822e1947bd2fd),

2209 
W64LIT
(0x1abbdbc029448c6f),

2210 
W64LIT
(0x96d8e77e6216106a),

2211 
W64LIT
(0x6266fcc1ce654315),

2212 
W64LIT
(0x89d301517e12aa2b),

2213 
W64LIT
(0x730935782fd0ad83),

2214 
W64LIT
(0x8085c38c0701d46d),

2215 
W64LIT
(0x6b303e1cb7763d53),

2216 
W64LIT
(0x3f57510c9a798f27),

2217 
W64LIT
(0x4449cefb6ecb5247),

2218 
W64LIT
(0x48af31c922981a2f),

2219 
W64LIT
(0x98bcc8e89fa744bd),

2220 
W64LIT
(0x69b2eeb8069421ec),

2221 
W64LIT
(0xebb5fd90b077e93e),

2222 
W64LIT
(0x6a71564e150733f6),

2223 
W64LIT
(0x116fc9b9e1b5ee96),

2224 
W64LIT
(0x4a2de16d937a0690),

2225 
W64LIT
(0xb9a11799bbab7f7e),

2226 
W64LIT
(0x9368da9157562644),

2227 
W64LIT
(0x718be5dc9e32b13c),

2228 
W64LIT
(0xc82af2452599ce42),

2229 
W64LIT
(0xb547e8abf7f83716),

2230 
W64LIT
(0x33b1ae3ed62ac74f),

2231 
W64LIT
(0x799c4f534550c1df),

2232 
W64LIT
(0x3e16395e38088182),

2233 
W64LIT
(0x7c2c72bc7010f7f1),

2234 
W64LIT
(0xf38cf6f428d179ee),

2235 
W64LIT
(0xd29129850cdd422d),

2236 
W64LIT
(0x41f9f3145b8b6469),

2237 
W64LIT
(0x945a37dad3f40cd5),

2238 
W64LIT
(0x757ab061090389b7),

2239 
W64LIT
(0x6554118a4ac76984),

2240 
W64LIT
(0x7d6d1aeed261f954),

2241 
W64LIT
(0x01416852a2710ea5),

2242 
W64LIT
(0xb27505e0735a1d87),

2243 
W64LIT
(0x77f860c5b8e19508),

2244 
W64LIT
(0x78dd2701e721cf7a),

2245 
W64LIT
(0xe12087bbdaf78562),

2246 
W64LIT
(0x86f6469521d2f059),

2247 
W64LIT
(0xef44a82d2746d1b5),

2248 
W64LIT
(0xbc112a768eeb4950),

2249 
W64LIT
(0xc2bf886e4f19a21e),

2250 
W64LIT
(0x307216c8c5b9d555),

2251 
W64LIT
(0xc96b9a1787e8c0e7),

2252 
W64LIT
(0xa31acc5992eff311),

2253 
W64LIT
(0xa0d974af817ce10b),

2254 
W64LIT
(0xdcf50613f16c16fa),

2255 
W64LIT
(0xfca9b1307711239c),

2256 
W64LIT
(0x57a4d7e63e9ca06e),

2257 
W64LIT
(0xc64eddd3d8289a95),

2258 
W64LIT
(0xa25ba40b309efdb4),

2259 
W64LIT
(0x2e3898b57bcc61b1),

2260 
W64LIT
(0xf5ff73ed0e025dda),

2261 
W64LIT
(0xa6aaf1b6a7afc53f),

2262 
W64LIT
(0xd9453bfcc42c20d4),

2263 
W64LIT
(0x9d0cf507aae77293),

2264 
W64LIT
(0x290a75feff6e4b20),

2265 
W64LIT
(0xa7eb99e405decb9a),

2266 
W64LIT
(0xa1981cfd230defae),

2267 
W64LIT
(0x12ac714ff226fc8c),

2268 
W64LIT
(0x743bd833ab728712),

2269 
W64LIT
(0x6c02d35733d417c2),

2270 
W64LIT
(0xe9372d340195f581),

2271 
W64LIT
(0xf77da349bfe04165),

2272 
W64LIT
(0x68f386eaa4e52f49),

2273 
W64LIT
(0x211ddf71240c3bc3),

2274 
W64LIT
(0x13ed191d5057f229),

2275 
W64LIT
(0xe8764566a3e4fb24),

2276 
W64LIT
(0xf9198cdf425115b2),

2277 
W64LIT
(0xd013f921bd3f5e92),

2278 
W64LIT
(0x91ea0a35e6b43afb),

2279 
W64LIT
(0x0732ed4b84a22a91),

2280 
W64LIT
(0xeaf495c21206e79b),

2281 
W64LIT
(0x5214ea090bdc9640),

2282 
W64LIT
(0x0000000000000000),

2283 
W64LIT
(0xb3346db2d12b1322),

2284 
W64LIT
(0x0ce6ff324c534868),

2285 
W64LIT
(0xaebd5b397ccdb5dc),

2286 
W64LIT
(0x0a957a2b6a806c5c),

2287 
W64LIT
(0x1f0be62f1c04ba41),

2288 
W64LIT
(0x14dff456d4f5d8b8),

2289 
W64LIT
(0x58819022615cfa1c),

2290 
W64LIT
(0x05b03def3540362e),

2291 
W64LIT
(0xe3a2571f6b1599dd),

2292 
W64LIT
(0x9229b2c3f52728e1),

2293 
W64LIT
(0xba62af6fa8386d64),

2294 
W64LIT
(0x0673851926d32434),

2295 
W64LIT
(0x641579d8e8b66721),

2296 
W64LIT
(0x04f155bd9731388b),

2297 
W64LIT
(0x9ecf4df1b9746089),

2298 
W64LIT
(0x205cb723867d3566),

2299 
W64LIT
(0x102ea1eb43c4e033),

2300 
W64LIT
(0x3ba604b10d48b7ac),

2301 
W64LIT
(0x50963aadba3e8aff),

2302 
W64LIT
(0xac3f8b9dcd2fa963),

2303 
W64LIT
(0x7b1e9ff7f4b2dd60),

2304 
W64LIT
(0xf63ccb1b1d914fc0),

2305 
W64LIT
(0x7eaea218c1f2eb4e),

2306 
W64LIT
(0x5fb37d69e5fed08d),

2307 
W64LIT
(0x56e5bfb49cedaecb),

2308 
W64LIT
(0x2dfb2043685f73ab),

2309 
W64LIT
(0x61a54437ddf6510f),

2310 
W64LIT
(0x6fc16ba1204705d8),

2311 
W64LIT
(0xe75302a2fc24a156),

2312 
W64LIT
(0x3dd581a82b9b9398),

2313 
W64LIT
(0xdbc7eb5875ce3c6b),

2314 
W64LIT
(0x90ab626744c5345e),

2315 
W64LIT
(0x59c0f870c32df4b9),

2316 
W64LIT
(0x6697a97c59547b9e),

2317 
W64LIT
(0xfde8d962d5602d39),

2318 
W64LIT
(0xd3d041d7aeac4c88),

2319 
W64LIT
(0x5ef2153b478fde28),

2320 
W64LIT
(0xd4e2ac9c2a0e6619),

2321 
W64LIT
(0x1e4a8e7dbe75b4e4),

2322 
W64LIT
(0x72485d2a8da1a326),

2323 
W64LIT
(0x437b23b0ea6978d6),

2324 
W64LIT
(0x159e9c047684d61d),

2325 
W64LIT
(0x0f2547c45fc05a72),

2326 
W64LIT
(0xf10e265099336551),

2327 
W64LIT
(0x3c94e9fa89ea9d3d),

2328 
W64LIT
(0xbfd292809d785b4a),

2329 
W64LIT
(0x0817aa8fdb6270e3),

2330 
W64LIT
(0x60e42c657f875faa),

2331 
W64LIT
(0x18390b6498a690d0),

2332 
W64LIT
(0x478a760d7d58405d),

2333 
W64LIT
(0x284b1dac5d1f4585),

2334 
W64LIT
(0xb1b6bd1660c90f9d),

2335 
W64LIT
(0xd15291731f4e5037),

2336 
W64LIT
(0x4d1f0c2617d82c01),

2337 
W64LIT
(0xc70fb5817a599430),

2338 
W64LIT
(0x6d43bb0591a51967),

2339 
W64LIT
(0x6e8003f382360b7d),

2340 
W64LIT
(0x1d89368bade6a6fe),

2341 
W64LIT
(0x4f9ddc82a63a30be),

2342 
W64LIT
(0xedc6788996a4cd0a),

2343 
W64LIT
(0xab0d66d6498d83f2),

2344 
W64LIT
(0x54676f102d0fb274),

2345 
W64LIT
(0xc17c30985c8ab004),

2346 
W64LIT
(0x3865bc471edba5b6),

2347 
W64LIT
(0x3924d415bcaaab13),

2348 
W64LIT
(0x951b5f8871850270),

2349 
W64LIT
(0x8a10b9a76d81b831),

2350 
W64LIT
(0xbd5042242c9a47f5),

2351 
W64LIT
(0xa5694940b43cd725),

2352 
W64LIT
(0xff6a09c664823186),

2353 
W64LIT
(0x8d2254ece92392a0),

2354 
W64LIT
(0xb7c5380f461a2ba9),

2355 
W64LIT
(0x82071328b6e3c8d2),

2356 
W64LIT
(0xd721146a399d7403),

2357 
W64LIT
(0xfada342951c207a8),

2358 
W64LIT
(0x262f323aa0ae1152),

2359 
W64LIT
(0xf04f4e023b426bf4),

2360 
W64LIT
(0x276e5a6802df1ff7),

2362 
W64LIT
(0x3b4016dbfd16e203),

2363 
W64LIT
(0x9a7574c51174530a),

2364 
W64LIT
(0x90012e69c02ec8d3),

2365 
W64LIT
(0xf44580e3d780e076),

2366 
W64LIT
(0xf81dec2b49eca14b),

2367 
W64LIT
(0x26cae3e8a6e3d7ef),

2368 
W64LIT
(0x0962419e0c41f6ab),

2369 
W64LIT
(0x54d1eb4070ebd951),

2370 
W64LIT
(0x865e884b0188eec8),

2371 
W64LIT
(0xdf76067ea406fe8a),

2372 
W64LIT
(0x29849412e594fba0),

2373 
W64LIT
(0x461569896869c0f2),

2374 
W64LIT
(0xb5ddd6b3bbd6724e),

2375 
W64LIT
(0x0c586cc89e6c413d),

2376 
W64LIT
(0x6b0ad97054d904ea),

2377 
W64LIT
(0xa135621eec62b109),

2378 
W64LIT
(0x0eef7e47087ea461),

2379 
W64LIT
(0xfaaafea4dffe4417),

2380 
W64LIT
(0xe0ad344e80342331),

2381 
W64LIT
(0xab4138b23d382ad0),

2382 
W64LIT
(0x107390468e90fcff),

2383 
W64LIT
(0xbe0885a2218561b9),

2384 
W64LIT
(0xdbed22957d22c132),

2385 
W64LIT
(0x2251c7037fc7e857),

2386 
W64LIT
(0x33835ef8ba5e9c86),

2387 
W64LIT
(0xb3f1e0d7f4e0a8aa),

2388 
W64LIT
(0x3fdb32302432ddbb),

2389 
W64LIT
(0xa719547aa3546bed),

2390 
W64LIT
(0xe10c3df3cb3dab1f),

2391 
W64LIT
(0x17feaf9f8aafae35),

2392 
W64LIT
(0x9df84b1c154b01c0),

2393 
W64LIT
(0x8364a51d93a5595e),

2394 
W64LIT
(0x535cd49974d48b9b),

2395 
W64LIT
(0x01a109bd4b09882e),

2396 
W64LIT
(0xc4d0c529b0c51182),

2397 
W64LIT
(0x2e09abcbe1aba96a),

2398 
W64LIT
(0x1f3de7bccde7d0b0),

2399 
W64LIT
(0x9317355b1d35a5a1),

2400 
W64LIT
(0x6c87e6a950e65620),

2401 
W64LIT
(0x8910ffb142ffc287),

2402 
W64LIT
(0x40395fed275f1a16),

2403 
W64LIT
(0x7b794936da49f815),

2404 
W64LIT
(0xf269b68798b63a92),

2405 
W64LIT
(0xfd27c17ddbc116dd),

2406 
W64LIT
(0x8d8bdb5a9bdbfd3f),

2407 
W64LIT
(0x1ba6c35714c3ef08),

2408 
W64LIT
(0x6e30f426c6f4b37c),

2409 
W64LIT
(0x7fe26ddd036dc7ad),

2410 
W64LIT
(0x14e8b4ad57b4c347),

2411 
W64LIT
(0xb985ba7b25ba3373),

2412 
W64LIT
(0xe9cf75d08c75d59a),

2413 
W64LIT
(0x626898ee5898f241),

2414 
W64LIT
(0x5b9f9cba339cf51e),

2415 
W64LIT
(0xb250e96abfe92084),

2416 
W64LIT
(0x165fa622c1a6261b),

2417 
W64LIT
(0xf5e4895e9c896858),

2418 
W64LIT
(0xb76ac43c2dc49712),

2419 
W64LIT
(0x02b7128f9612e55c),

2420 
W64LIT
(0x1d8af5335bf535ec),

2421 
W64LIT
(0x36b973ae28732b10),

2422 
W64LIT
(0xa8572380e02347a2),

2423 
W64LIT
(0xf6f2926c4192052a),

2424 
W64LIT
(0x8c2ad2e7d0d27511),

2425 
W64LIT
(0xd32e6ab63a6abfb7),

2426 
W64LIT
(0xbd1e9e90fc9e0ccb),

2427 
W64LIT
(0x03161b32dd1b6d72),

2428 
W64LIT
(0x4dc03a98f23ad305),

2429 
W64LIT
(0x81d3b79205b7bc02),

2430 
W64LIT
(0x450372bbb572ad80),

2431 
W64LIT
(0x2d1fb0f93cb0c418),

2432 
W64LIT
(0x2a928f20388f96d2),

2433 
W64LIT
(0x721b08a8d6080ebe),

2434 
W64LIT
(0x92b63ce6563c2d8f),

2435 
W64LIT
(0xeb78675f1a6730c6),

2436 
W64LIT
(0x13658b74538b918d),

2437 
W64LIT
(0x428e4d62b14dff4a),

2438 
W64LIT
(0x88b1f60c09f64aa9),

2439 
W64LIT
(0x75963771d2375c74),

2440 
W64LIT
(0x7ad8408b9140703b),

2441 
W64LIT
(0x57c7f072adf0b423),

2442 
W64LIT
(0xe5971918121994a7),

2443 
W64LIT
(0x5666f9cfe6f93c0d),

2444 
W64LIT
(0x8f3cc9d50dc91863),

2445 
W64LIT
(0x1e9cee0186ee589e),

2446 
W64LIT
(0x8a06e4839fe4aff5),

2447 
W64LIT
(0xb824b3c66eb3bb5d),

2448 
W64LIT
(0xd1997839ac785aeb),

2449 
W64LIT
(0x6752b5b8cab545d7),

2450 
W64LIT
(0xb47cdf0ef0dffa60),

2451 
W64LIT
(0x949a0a82190af76b),

2452 
W64LIT
(0xc04be1c269e12e3a),

2453 
W64LIT
(0xfc86c8c090c89ef3),

2454 
W64LIT
(0xe3bb2f7c5d2f4e43),

2455 
W64LIT
(0x6aabd0cd1fd08cc4),

2456 
W64LIT
(0x2147dc31a2dc8525),

2457 
W64LIT
(0xca3fbb6eb8bbb5e3),

2458 
W64LIT
(0x48fa17ce60176493),

2459 
W64LIT
(0x6444ae8a17ae28a5),

2460 
W64LIT
(0x2b33869d73861efc),

2461 
W64LIT
(0xd0387184e771d2c5),

2462 
W64LIT
(0x7cf476efde76aadf),

2463 
W64LIT
(0x63c9915313917a6f),

2464 
W64LIT
(0xc929a05c65a0d891),

2465 
W64LIT
(0xda4c2b28362b491c),

2466 
W64LIT
(0xfe31da4f06da7baf),

2467 
W64LIT
(0xc1eae87f22e8a614),

2468 
W64LIT
(0x5c12a36337a3a7d4),

2469 
W64LIT
(0x18b0d865c9d8827a),

2470 
W64LIT
(0xe7200b97840b71fb),

2471 
W64LIT
(0x4bec0cfcbd0c09e1),

2472 
W64LIT
(0x0f4e77fa43772c4f),

2473 
W64LIT
(0x4c613325b9335b2b),

2474 
W64LIT
(0xf3c8bf3ad3bfb2bc),

2475 
W64LIT
(0x87ff81f64a8166e6),

2476 
W64LIT
(0xa38270917a705455),

2477 
W64LIT
(0x1911d1d882d10a54),

2478 
W64LIT
(0x44a27b06fe7b25ae),

2479 
W64LIT
(0x049b24ebd9243fb8),

2480 
W64LIT
(0xbb32a8f4b3a8d62f),

2481 
W64LIT
(0x91a027d48b2740fd),

2482 
W64LIT
(0x3d6c20bfb22038e7),

2483 
W64LIT
(0xe681022acf02f9d5),

2484 
W64LIT
(0xf17fadb545ad57e0),

2485 
W64LIT
(0xcc138d0af78d6f07),

2486 
W64LIT
(0x495b1e732b1eecbd),

2487 
W64LIT
(0x38560de9200d8f71),

2488 
W64LIT
(0xa9f62a3dab2acf8c),

2489 
W64LIT
(0x47b46034236048dc),

2490 
W64LIT
(0x8e9dc06846c0904d),

2491 
W64LIT
(0xaccc076b3907781a),

2492 
W64LIT
(0x32225745f15714a8),

2493 
W64LIT
(0xd4a3556f3e55ed7d),

2494 
W64LIT
(0xd7b54e5de34e800f),

2495 
W64LIT
(0xddc114f132141bd6),

2496 
W64LIT
(0x6d26ef141befde0e),

2497 
W64LIT
(0x85489379dc9383ba),

2498 
W64LIT
(0x0bd553119a5313f7),

2499 
W64LIT
(0x786f520407529567),

2500 
W64LIT
(0xcb9eb2d3f3b23dcd),

2501 
W64LIT
(0xa223792c3179dc7b),

2502 
W64LIT
(0x0a745aacd15a9bd9),

2503 
W64LIT
(0x710d139a0b1363cc),

2504 
W64LIT
(0x681cc24289c26998),

2505 
W64LIT
(0x1a07caea5fca6726),

2506 
W64LIT
(0x82c5aca0d8acd170),

2507 
W64LIT
(0x25dcf8da7bf8ba9d),

2508 
W64LIT
(0xc7c6de1b6dde7cf0),

2509 
W64LIT
(0xc35dfaf0b4fa4348),

2510 
W64LIT
(0xded70fc3ef0f76a4),

2511 
W64LIT
(0x504acfaba9cfe6e9),

2512 
W64LIT
(0xc571cc94fbcc99ac),

2513 
W64LIT
(0x5ea5b1eca1b14288),

2514 
W64LIT
(0xae7b15e4af159d46),

2515 
W64LIT
(0xc888a9e12ea950bf),

2516 
W64LIT
(0xf7539bd10a9b8d04),

2517 
W64LIT
(0x962d180d8f181237),

2518 
W64LIT
(0xe43610a559101c89),

2519 
W64LIT
(0x772125fe4425b928),

2520 
W64LIT
(0x84e99ac4979a0b94),

2521 
W64LIT
(0xc667d7a626d7f4de),

2522 
W64LIT
(0xefe343b4c3430f7e),

2523 
W64LIT
(0xd5025cd2755c6553),

2524 
W64LIT
(0xa6b85dc7e85de3c3),

2525 
W64LIT
(0xd61447e0a8470821),

2526 
W64LIT
(0x3e7a3b8d6f3b5595),

2527 
W64LIT
(0x52fddd243fdd03b5),

2528 
W64LIT
(0x8072be2f4ebe342c),

2529 
W64LIT
(0x12c482c9188219a3),

2530 
W64LIT
(0x9eee502ec8506cb2),

2531 
W64LIT
(0xad6d0ed6720ef034),

2532 
W64LIT
(0x59288e35a58e1042),

2533 
W64LIT
(0xe21a26c11626c66d),

2534 
W64LIT
(0x247df16730f132b3),

2535 
W64LIT
(0xf0dea4080ea4dfce),

2536 
W64LIT
(0x31344c772c4c79da),

2537 
W64LIT
(0x4f77281764283659),

2538 
W64LIT
(0x79ce5bb94c5b1d49),

2539 
W64LIT
(0x0000000000000000),

2540 
W64LIT
(0x73ba01159d018690),

2541 
W64LIT
(0x74373ecc993ed45a),

2542 
W64LIT
(0xbcbf972db79784e5),

2543 
W64LIT
(0x4ed621aa2f21be77),

2544 
W64LIT
(0xd95a301aeb30246e),

2545 
W64LIT
(0x9c5942a15e4289ee),

2546 
W64LIT
(0x37187a13637aa33e),

2547 
W64LIT
(0x276bea55edea5fc1),

2548 
W64LIT
(0x1c2bfc8e10fcbdc2),

2549 
W64LIT
(0xed54513b5551ea22),

2550 
W64LIT
(0x20e6d58ce9d50d0b),

2551 
W64LIT
(0x3ae11f66b61f6a2d),

2552 
W64LIT
(0x66f3bc0581bccdf9),

2553 
W64LIT
(0x2cbeb94477b94c36),

2554 
W64LIT
(0x99636ff7cc6f3e78),

2555 
W64LIT
(0x953b033f52037f45),

2556 
W64LIT
(0xb0e7fbe529fbc5d8),

2557 
W64LIT
(0x60df8a61ce8a171d),

2558 
W64LIT
(0x6f91fd9b8dfd3b52),

2559 
W64LIT
(0xaae0310f7631a2fe),

2560 
W64LIT
(0xbfa98c1f6a8ce997),

2561 
W64LIT
(0x8ba7ed3ed4ed27db),

2562 
W64LIT
(0x98c2664a8766b656),

2563 
W64LIT
(0x062c36644f36dae4),

2564 
W64LIT
(0x5570e2fd3be2517f),

2565 
W64LIT
(0xead96ee2516eb8e8),

2566 
W64LIT
(0x419856506c569238),

2567 
W64LIT
(0x23f0cebe34ce6079),

2568 
W64LIT
(0x309545ca6745f1f4),

2569 
W64LIT
(0x5a3e950778957d30),

2570 
W64LIT
(0x617e83dc85839f33),

2571 
W64LIT
(0xfb0bf71994f7cc39),

2572 
W64LIT
(0x3ccd2902f929b0c9),

2573 
W64LIT
(0x70ac1a27401aebe2),

2574 
W64LIT
(0xcea49f85619f8a5b),

2575 
W64LIT
(0x39f704546b04075f),

2576 
W64LIT
(0x0df96575d565c913),

2577 
W64LIT
(0x08c3482347487e85),

2578 
W64LIT
(0xd28f630b71633799),

2579 
W64LIT
(0xecf558861e58620c),

2580 
W64LIT
(0xc2fcf34dfff3cb66),

2581 
W64LIT
(0x978c11b0c4119a19),

2582 
W64LIT
(0x69bdcbffc2cbe1b6),

2583 
W64LIT
(0xba93a149f8a15e01),

2584 
W64LIT
(0x51ebc616e2c66ec7),

2585 
W64LIT
(0x078d3fd9043f52ca),

2586 
W64LIT
(0x58898788ee87986c),

2587 
W64LIT
(0x4a4d0541f60581cf),

2588 
W64LIT
(0xe86e7c6dc77c5db4),

2589 
W64LIT
(0xee424a09884a8750),

2590 
W64LIT
(0xcdb284b7bc84e729),

2591 
W64LIT
(0x65e5a7375ca7a08b),

2592 
W64LIT
(0x2fa8a276aaa22144),

2593 
W64LIT
(0xa0946ba3a76b3927),

2594 
W64LIT
(0xa5ae46f535468eb1),

2595 
W64LIT
(0x35af689cf5684662),

2596 
W64LIT
(0x28259dafae9d738e),

2597 
W64LIT
(0xcf0596382a960275),

2598 
W64LIT
(0xb6cbcd8166cd1f3c),

2599 
W64LIT
(0x7e43646048644f83),

2600 
W64LIT
(0x9bd47d785a7ddb24),

2601 
W64LIT
(0x432f44dffa447764),

2602 
W64LIT
(0x9f4f59938359e49c),

2603 
W64LIT
(0x7d557f52957f22f1),

2604 
W64LIT
(0x76802c430f2c3106),

2605 
W64LIT
(0xdc601d4c791d93f8),

2606 
W64LIT
(0x053a2d56922db796),

2607 
W64LIT
(0x11d299fbc59974d1),

2608 
W64LIT
(0xf9bce59602e52965),

2609 
W64LIT
(0xd8fb39a7a039ac40),

2610 
W64LIT
(0x340e6121be61ce4c),

2611 
W64LIT
(0x5f04b851eab8caa6),

2612 
W64LIT
(0x5db3aade7caa2ffa),

2613 
W64LIT
(0x1549bd101cbd4b69),

2614 
W64LIT
(0xff90d3f24dd3f381),

2615 
W64LIT
(0xafda1c59e41c1568),

2616 
W64LIT
(0xb146f25862f24df6),

2617 
W64LIT
(0xa40f4f487e4f069f),

2619 
W64LIT
(0xa1a35cebf8f0f94c),

2620 
W64LIT
(0x2c203d650f3f095d),

2621 
W64LIT
(0x1a2bdaee4084a2a7),

2622 
W64LIT
(0xd32404574d7bcc68),

2623 
W64LIT
(0xf785bea594a9adc4),

2624 
W64LIT
(0xf2eb54456206949c),

2625 
W64LIT
(0x3f5e334d0475ced1),

2626 
W64LIT
(0x5994299b835d1f60),

2627 
W64LIT
(0x785b7989ac204794),

2628 
W64LIT
(0x025da6a2cf461a41),

2629 
W64LIT
(0xdf1f3a71f01a901b),

2630 
W64LIT
(0x27284f018bb77637),

2631 
W64LIT
(0xe1955a6d694c5310),

2632 
W64LIT
(0x24a1baf2d9d261ac),

2633 
W64LIT
(0xe4fbb08d9fe36a48),

2634 
W64LIT
(0x8d83618ef7cff011),

2635 
W64LIT
(0x2ac72276abf5279e),

2636 
W64LIT
(0xf9e32621e68eebf6),

2637 
W64LIT
(0xbf323fb4d3f86f69),

2638 
W64LIT
(0xbb888605b8745beb),

2639 
W64LIT
(0x70dafe1e7acd2f65),

2640 
W64LIT
(0xd0adf1a41f1edbf3),

2641 
W64LIT
(0x1e91635f2b089625),

2642 
W64LIT
(0xee2791b8864818f8),

2643 
W64LIT
(0x99ce23e4c56c1484),

2644 
W64LIT
(0xf33f0714ff259946),

2645 
W64LIT
(0xbd6f99161cbe7528),

2646 
W64LIT
(0x9f293cf761a63a47),

2647 
W64LIT
(0xb80173f6ea114c70),

2648 
W64LIT
(0x6543ef25d54dc62a),

2649 
W64LIT
(0x39b92c5ea0bfe012),

2650 
W64LIT
(0x63a4f0367187e8e9),

2651 
W64LIT
(0x4c0d38a02cddf62f),

2652 
W64LIT
(0x07334c4239e92319),

2653 
W64LIT
(0x43bff375c3d9bdc7),

2654 
W64LIT
(0xca862b4a5f9a7954),

2655 
W64LIT
(0x5d2e902ae8d12be2),

2656 
W64LIT
(0x137e0e280b4ac78c),

2657 
W64LIT
(0xf162a1b630638307),

2658 
W64LIT
(0x55af17bd3e3c4313),

2659 
W64LIT
(0x358212781ddebc61),

2660 
W64LIT
(0x94214e93e52e452d),

2661 
W64LIT
(0xc18e592edb12063e),

2662 
W64LIT
(0xec7a371a490e02b9),

2663 
W64LIT
(0x4963d240da72cf77),

2664 
W64LIT
(0x41e255d70c9fa786),

2665 
W64LIT
(0xff0439324244c535),

2666 
W64LIT
(0x88ed8b6e0160c949),

2667 
W64LIT
(0x6c163be39e83a301),

2668 
W64LIT
(0xc534e09fb09e32bc),

2669 
W64LIT
(0x806c0cf9d78da1b8),

2670 
W64LIT
(0xdba583c09b96a499),

2671 
W64LIT
(0x746047af11411be7),

2672 
W64LIT
(0xf40c4b56c6ccba5f),

2673 
W64LIT
(0x6270a367eca4e533),

2674 
W64LIT
(0xd41748157492ef71),

2675 
W64LIT
(0xeff3c2e91b6b1522),

2676 
W64LIT
(0x0e66988472274632),

2677 
W64LIT
(0x534808ae9af66dd0),

2678 
W64LIT
(0x8231aa5b18cbbbf9),

2679 
W64LIT
(0xb2dd52c3f3ba3ec0),

2680 
W64LIT
(0xdd429cd33f5c8a5a),

2681 
W64LIT
(0x4e509e02e39bec6e),

2682 
W64LIT
(0x26fc1c5016947bed),

2683 
W64LIT
(0xd9f8256254d0bed8),

2684 
W64LIT
(0x0955d4c64bce652b),

2685 
W64LIT
(0x1610e4c8fde5fed4),

2686 
W64LIT
(0x6dc268b203a0aedb),

2687 
W64LIT
(0x2e7d9bc7c079131c),

2688 
W64LIT
(0xc3d3ff8c14541c7f),

2689 
W64LIT
(0xd64aeeb7bbd4f530),

2690 
W64LIT
(0xab7f7ddee15b8bfc),

2691 
W64LIT
(0x144d426a32a3e495),

2692 
W64LIT
(0x8e0a947da5aae78a),

2693 
W64LIT
(0x798f2ad831034a4e),

2694 
W64LIT
(0x3be48afc6ff9fa53),

2695 
W64LIT
(0x529c5bff07d5600a),

2696 
W64LIT
(0xbee66ce54edb62b3),

2697 
W64LIT
(0x931202d1dcc76634),

2698 
W64LIT
(0x50c1fd5dc8937a4b),

2699 
W64LIT
(0xa4cdb60b0e5fc014),

2700 
W64LIT
(0x57f2b11ff17a5952),

2701 
W64LIT
(0x47054ac4a8558945),

2702 
W64LIT
(0x5a1ddc68d13808fb),

2703 
W64LIT
(0x5cfac37b75f22638),

2704 
W64LIT
(0xc207acdd897711a5),

2705 
W64LIT
(0x289a84d464b33ddf),

2706 
W64LIT
(0xc05a0a7f46310be4),

2707 
W64LIT
(0xe6a6162f50a57009),

2708 
W64LIT
(0x06e71f13a4ca2ec3),

2709 
W64LIT
(0x5f733688279731a3),

2710 
W64LIT
(0xeb497b5870e721a0),

2711 
W64LIT
(0xb667eb7298360a42),

2712 
W64LIT
(0xe3c8fccfa60a4951),

2713 
W64LIT
(0xe772457ecd867dd3),

2714 
W64LIT
(0x6978d103682c9a59),

2715 
W64LIT
(0x0def6d77204251a9),

2716 
W64LIT
(0xc90fdeb90dff6ecf),

2717 
W64LIT
(0xd179a2f5823dd629),

2718 
W64LIT
(0x2fa9c8965d5a1ec6),

2719 
W64LIT
(0x81b85fa84aaeac62),

2720 
W64LIT
(0xdc96cf82a27f8780),

2721 
W64LIT
(0x602d05c523e2ff72),

2722 
W64LIT
(0x19a22f1d12e1b53c),

2723 
W64LIT
(0xe52fe3dc02c06792),

2724 
W64LIT
(0x58407aca1e7e12ba),

2725 
W64LIT
(0x61f95694bec1f2a8),

2726 
W64LIT
(0x48b781114751c2ad),

2727 
W64LIT
(0xaaab2e8f7c788626),

2728 
W64LIT
(0x04bab9b16b8c3482),

2729 
W64LIT
(0x2df46e34921c0487),

2730 
W64LIT
(0x1123a88ac40cddcd),

2731 
W64LIT
(0xc6bd156ce2fb2527),

2732 
W64LIT
(0x7f6835cb95c9648d),

2733 
W64LIT
(0x83e5f90a85e8b623),

2734 
W64LIT
(0x4f84cd537eb8e1b4),

2735 
W64LIT
(0x294ed785f9903005),

2736 
W64LIT
(0x1cccc5fde44e8c64),

2737 
W64LIT
(0xcb52781bc2b9748e),

2738 
W64LIT
(0x1d1896ac796d81be),

2739 
W64LIT
(0xb30901926e99331a),

2740 
W64LIT
(0xad9862cd4591a53f),

2741 
W64LIT
(0xc8db8de890dc6315),

2742 
W64LIT
(0x7bd28c7afe45500f),

2743 
W64LIT
(0x0adc213519ab72b0),

2744 
W64LIT
(0xa8f6882db33e9c67),

2745 
W64LIT
(0xb5ee1e81ca531dd9),

2746 
W64LIT
(0x201b0343b25e552e),

2747 
W64LIT
(0x4036068691bcaa5c),

2748 
W64LIT
(0xae11973e17f4b2a4),

2749 
W64LIT
(0x9efd6fa6fc85379d),

2750 
W64LIT
(0x33650d6bb91492a2),

2751 
W64LIT
(0x3a30d9adf2daf789),

2752 
W64LIT
(0x0c3b3e26bd615c73),

2753 
W64LIT
(0xf651edf4098aa01e),

2754 
W64LIT
(0x710ead4fe7ee22bf),

2755 
W64LIT
(0x3138abc9765288e3),

2756 
W64LIT
(0x9d749a55aee02006),

2757 
W64LIT
(0x6e4b9d4151c5b940),

2758 
W64LIT
(0x84d6b548bc01953a),

2759 
W64LIT
(0x360be78b4fbbabfa),

2760 
W64LIT
(0xa22aa918aa95eed7),

2761 
W64LIT
(0xedae644bd42d0f63),

2762 
W64LIT
(0x46d119953576849f),

2763 
W64LIT
(0x6497bc74486ecbf0),

2764 
W64LIT
(0xfbbe808329c8f1b7),

2765 
W64LIT
(0x4aea27b38817d8ec),

2766 
W64LIT
(0x5626e24e6c595488),

2767 
W64LIT
(0x056eeae0f6af3958),

2768 
W64LIT
(0x4558ec6667139304),

2769 
W64LIT
(0x448cbf37fa309ede),

2770 
W64LIT
(0x6f9fce10cce6b49a),

2771 
W64LIT
(0xa0770fba65d3f496),

2772 
W64LIT
(0x671e49871a0bdc6b),

2773 
W64LIT
(0xda71d09106b5a943),

2774 
W64LIT
(0x08818797d6ed68f1),

2775 
W64LIT
(0xa3fefa4937b6e30d),

2776 
W64LIT
(0xb080f4613cfc2481),

2777 
W64LIT
(0x763de10dde0701a6),

2778 
W64LIT
(0x4dd96bf1b1fefbf5),

2779 
W64LIT
(0x92c6518041e46bee),

2780 
W64LIT
(0x3456412980fdb1bb),

2781 
W64LIT
(0x981a70b5584f195e),

2782 
W64LIT
(0x3d0395efcb33d490),

2783 
W64LIT
(0xba5cd55425575631),

2784 
W64LIT
(0x4b3e74e21534d536),

2785 
W64LIT
(0x6af124f03a498dc2),

2786 
W64LIT
(0x7ebc669a08ea6957),

2787 
W64LIT
(0x30ecf898eb718539),

2788 
W64LIT
(0xa922db7c2e1d91bd),

2789 
W64LIT
(0x7a06df2b63665dd5),

2790 
W64LIT
(0xb154a730a1df295b),

2791 
W64LIT
(0xfc8dccc11021d2ae),

2792 
W64LIT
(0xcfe8c1aaa935400c),

2793 
W64LIT
(0x97a8bb60b74b52b6),

2794 
W64LIT
(0x18767c4c8fc2b8e6),

2795 
W64LIT
(0x9a47d6179709031f),

2796 
W64LIT
(0x0000000000000000),

2797 
W64LIT
(0xac4c319cd8b2a8e5),

2798 
W64LIT
(0xb9d520a7773241aa),

2799 
W64LIT
(0xdecb69206d399dc1),

2800 
W64LIT
(0x1f45300eb62b9bff),

2801 
W64LIT
(0x10f7fbdb592fd017),

2802 
W64LIT
(0x3e8a601c9956c30b),

2803 
W64LIT
(0x8502e619212298e0),

2804 
W64LIT
(0xf5d818075befb785),

2805 
W64LIT
(0x547b44eca31f4ec9),

2806 
W64LIT
(0x9ca0c90433c32ddc),

2807 
W64LIT
(0xe041093cf46f5eca),

2808 
W64LIT
(0xa69010a9c119da55),

2809 
W64LIT
(0xc769463d7fd828fd),

2810 
W64LIT
(0xc4e0b3ce2dbd3f66),

2811 
W64LIT
(0x2575e9a344f16c76),

2812 
W64LIT
(0x01d453519d230dda),

2813 
W64LIT
(0xfa6ad3d2b4ebfc6d),

2814 
W64LIT
(0xd5c31b44e9b1e2ab),

2815 
W64LIT
(0xf83775707bade62c),

2816 
W64LIT
(0xbcbbca47819d78f2),

2817 
W64LIT
(0xd79ebde626f7f8ea),

2818 
W64LIT
(0x5bc98f394c1b0521),

2819 
W64LIT
(0x2246a5e17d184f6f),

2820 
W64LIT
(0x12aa5d799669ca56),

2821 
W64LIT
(0x5ea765d9bab43c79),

2822 
W64LIT
(0x8939d83f9c43c493),

2823 
W64LIT
(0x32b15e3a24379f78),

2824 
W64LIT
(0xe914ddfabfa13be1),

2825 
W64LIT
(0x909bf7228ea271af),

2826 
W64LIT
(0x73530bed28a838fe),

2827 
W64LIT
(0xd2f05706d058c1b2),

2828 
W64LIT
(0xfed06a63df67c8ef),

2829 
W64LIT
(0xb43a4dd057701003),

2830 
W64LIT
(0xa519e55a937ccdce),

2831 
W64LIT
(0x75b414fe8c62163d),

2832 
W64LIT
(0xafc5c46f8ad7bf7e),

2833 
W64LIT
(0x2392f6b0e03b42b5),

2834 
W64LIT
(0x386d7f0f3d9cedc8),

2835 
W64LIT
(0x21cf50122f7d58f4),

2836 
W64LIT
(0x9b9385460a2a0ec5),

2837 
W64LIT
(0x5115ae0c55b07791),

2838 
W64LIT
(0x0fb2cbd5ef044be8),

2839 
W64LIT
(0xea9d2809edc42c7a),

2840 
W64LIT
(0xcc613459fb505797),

2841 
W64LIT
(0x426ba0245efab01d),

2842 
W64LIT
(0x1599113baf80e94f),

2843 
W64LIT
(0x7d3593695a8f7ecc),

2844 
W64LIT
(0x0389f5f35265179b),

2845 
W64LIT
(0x875f40bbee6482a1),

2846 
W64LIT
(0x95f51dc2780d48f7),

2847 
W64LIT
(0x7ce1c038c7ac7316),

2848 
W64LIT
(0xce3c92fb34164dd6),

2849 
W64LIT
(0xcdb5670866735a4d),

2850 
W64LIT
(0x8ab02dccce26d308),

2851 
W64LIT
(0x914fa47313817c75),

2852 
W64LIT
(0x8b647e9d5305ded2),

2853 
W64LIT
(0xd82c7633c9f3b302),

2854 
W64LIT
(0x728758bcb58b3524),

2855 
W64LIT
(0xe8c08eab2282363b),

2856 
W64LIT
(0x8fdec72c3889ea50),

2857 
W64LIT
(0x2b13712736d62a44),

2858 
W64LIT
(0x3cd7c6be5610d94a),

2859 
W64LIT
(0x37dfb4dad298a620),

2860 
W64LIT
(0x868b13ea73478f7b),

2861 
W64LIT
(0xb7b3b82305150798),

2862 
W64LIT
(0x0b08726484887f6a),

2863 
W64LIT
(0x1bff89bfdda7af7d),

2864 
W64LIT
(0x77e9b25c43240c7c),

2865 
W64LIT
(0xf0b6f2e7ad408edd),

2866 
W64LIT
(0x17c4b79960c6f30e),

2867 
W64LIT
(0x8c5732df6aecfdcb),

2868 
W64LIT
(0x68ac8252f50f9783),

2869 
W64LIT
(0x66ca1ad68728d1b1),

2870 
W64LIT
(0x6b2577a1a76a8018),

2871 
W64LIT
(0xe21caf9e3b29448b),

2872 
W64LIT
(0xa74443f85c3ad78f),

2873 
W64LIT
(0xfd599f908d02df74),

2874 
W64LIT
(0x967ce8312a685f6c),

2876 
W64LIT
(0xfa7b9775ba3af751),

2877 
W64LIT
(0x03ef98cb769c2d13),

2878 
W64LIT
(0x7191ce067072359e),

2879 
W64LIT
(0xbab18b6bff7516a8),

2880 
W64LIT
(0xe6e5ef4efbc1065e),

2881 
W64LIT
(0x7bec74a3b1d0dbf4),

2882 
W64LIT
(0x656b4fb907c31c4a),

2883 
W64LIT
(0x4e8520f99fc86304),

2884 
W64LIT
(0x8fd8df31d16dae58),

2885 
W64LIT
(0x90a93fc1e60a7244),

2886 
W64LIT
(0x30ad09f2b449cfc5),

2887 
W64LIT
(0x8453be7e91bb5b90),

2888 
W64LIT
(0x1d68a3d1c08feaad),

2889 
W64LIT
(0x5c54642504b410f6),

2890 
W64LIT
(0x8061383c8a9e3707),

2891 
W64LIT
(0xf9940fbecca6da42),

2892 
W64LIT
(0x46e1d97da982bbdf),

2893 
W64LIT
(0xfc50521656f7ad77),

2894 
W64LIT
(0x5e4d2704f35c2647),

2895 
W64LIT
(0x8bea5973ca48c2cf),

2896 
W64LIT
(0xd06323dfa34593bd),

2897 
W64LIT
(0x62b651306a7a5dce),

2898 
W64LIT
(0xa436b0714966d116),

2899 
W64LIT
(0x4f73fb131ebc78a6),

2900 
W64LIT
(0x92b07ce011e244f5),

2901 
W64LIT
(0x33429139c2d5e2d6),

2902 
W64LIT
(0xcee418c515565403),

2903 
W64LIT
(0xd7be3d56cefcd239),

2904 
W64LIT
(0x53ed83285f4789a9),

2905 
W64LIT
(0xf3e9b51b0d043428),

2906 
W64LIT
(0x20650e0fd8dd8a86),

2907 
W64LIT
(0xb6e7f4add21aa2e4),

2908 
W64LIT
(0x6d0fb63d3189c491),

2909 
W64LIT
(0x0da0a42cac1bafee),

2910 
W64LIT
(0x3f14eeffefba569a),

2911 
W64LIT
(0x13279f361a086850),

2912 
W64LIT
(0x9b225e8ea6dc878c),

2913 
W64LIT
(0x6684d772715f3159),

2914 
W64LIT
(0xa3ebaef824df9092),

2915 
W64LIT
(0xc499a260d4f4ba69),

2916 
W64LIT
(0xaa798c9693e153eb),

2917 
W64LIT
(0x50021be329dba4ba),

2918 
W64LIT
(0x949bb983fd2f1ed3),

2919 
W64LIT
(0xdfdac4d2f8b60ae2),

2920 
W64LIT
(0xf0062dd07b98193b),

2921 
W64LIT
(0xafbdd13e09b024de),

2922 
W64LIT
(0xb95e13a089e93bbb),

2923 
W64LIT
(0x649d945386b707e8),

2924 
W64LIT
(0xe4fcac6f0c2930ef),

2925 
W64LIT
(0x413cc7f4c43bfa5b),

2926 
W64LIT
(0x3b2668bdf49f3a0d),

2927 
W64LIT
(0xe50a77858d5d2b4d),

2928 
W64LIT
(0x05c45da89a517735),

2929 
W64LIT
(0x3ee235156ece4d38),

2930 
W64LIT
(0xfe491137a11f9bc6),

2931 
W64LIT
(0xb7112f47536eb946),

2932 
W64LIT
(0x07dd1e896db94184),

2933 
W64LIT
(0x1ab5bd58ad36ab29),

2934 
W64LIT
(0x8197e3d60bea2ca5),

2935 
W64LIT
(0xab8f577c12954849),

2936 
W64LIT
(0x9cff4007cb65c608),

2937 
W64LIT
(0xa00436335243bd81),

2938 
W64LIT
(0xfda689fcd783b6d5),

2939 
W64LIT
(0xccfd5be4e2be62b2),

2940 
W64LIT
(0x75a348446b575909),

2941 
W64LIT
(0x17151974012d04c7),

2942 
W64LIT
(0xfb8d4c9f3b4eecf3),

2943 
W64LIT
(0xac5249f57f2c09cd),

2944 
W64LIT
(0x9346a70a90965f57),

2945 
W64LIT
(0x043286421b256c97),

2946 
W64LIT
(0x27b81086b564cb02),

2947 
W64LIT
(0x3569545a2e18b8f0),

2948 
W64LIT
(0x6b24735edd449eb7),

2949 
W64LIT
(0x2193d5e559a99124),

2950 
W64LIT
(0xc7763aaba268977a),

2951 
W64LIT
(0xb0cc31ce3ed7f8c2),

2952 
W64LIT
(0xc939064c78ef1587),

2953 
W64LIT
(0x16e3c29e80591f65),

2954 
W64LIT
(0x5da2bfcf85c00b54),

2955 
W64LIT
(0x5990398d9ee567c3),

2956 
W64LIT
(0x67720c98f02b2afb),

2957 
W64LIT
(0x54309da132fec82d),

2958 
W64LIT
(0xeab39088d6aeb212),

2959 
W64LIT
(0x9682faa20ac72862),

2960 
W64LIT
(0xd38cbb14d5d9beae),

2961 
W64LIT
(0x4c9c63d8682055b5),

2962 
W64LIT
(0xd648e6bc4f88c99b),

2963 
W64LIT
(0xdc355c198e2a27f1),

2964 
W64LIT
(0x10c807fd6c944543),

2965 
W64LIT
(0x450e41b6df1e96cc),

2966 
W64LIT
(0x0b8b614f40d6f5c8),

2967 
W64LIT
(0xd27a60fe54ada50c),

2968 
W64LIT
(0x49583e70f2712280),

2969 
W64LIT
(0x8dc19c10268598e9),

2970 
W64LIT
(0x5866e2671f917c61),

2971 
W64LIT
(0x79f537824638ed45),

2972 
W64LIT
(0xc2b267033839e04f),

2973 
W64LIT
(0xcb20456d8f072336),

2974 
W64LIT
(0x2a18b4aa197f64ec),

2975 
W64LIT
(0xdbe84290e3936675),

2976 
W64LIT
(0x73888d27879a032f),

2977 
W64LIT
(0xe8aad3a9214684a3),

2978 
W64LIT
(0x6ee02ef64715e982),

2979 
W64LIT
(0xa996145de57d7ef8),

2980 
W64LIT
(0xc8cfdda6f99b0e25),

2981 
W64LIT
(0x062bc563eccd5a26),

2982 
W64LIT
(0x264ecb6c3410d0a0),

2983 
W64LIT
(0xb8a8c84a089d2019),

2984 
W64LIT
(0x7dc7b1c05d1d81d2),

2985 
W64LIT
(0xd5a77e773914e488),

2986 
W64LIT
(0x4b417d5105991431),

2987 
W64LIT
(0xf62de8b39755431d),

2988 
W64LIT
(0x993b1daf5134b13d),

2989 
W64LIT
(0x82787b1d7d7601b6),

2990 
W64LIT
(0xe321b2e66190716b),

2991 
W64LIT
(0xb5086c66a4868ff7),

2992 
W64LIT
(0x9ee603263c8df0b9),

2993 
W64LIT
(0x349f8fb0af6ca352),

2994 
W64LIT
(0x5b897aac690d5172),

2995 
W64LIT
(0x7c316a2adc699a70),

2996 
W64LIT
(0xd451a59db860ff2a),

2997 
W64LIT
(0x706715ecf1062e3c),

2998 
W64LIT
(0x838ea0f7fc021a14),

2999 
W64LIT
(0x57df056a4462e53e),

3000 
W64LIT
(0xcf12c32f94224fa1),

3001 
W64LIT
(0xed6e8e01bb17f396),

3002 
W64LIT
(0x915fe42b677e69e6),

3003 
W64LIT
(0x89f31a523da0f47e),

3004 
W64LIT
(0xe71334a47ab51dfc),

3005 
W64LIT
(0xa860cfb76409655a),

3006 
W64LIT
(0x9f10d8ccbdf9eb1b),

3007 
W64LIT
(0xef77cd204cffc527),

3008 
W64LIT
(0xf862d4544dd2c1e0),

3009 
W64LIT
(0x8a1c82994b3cd96d),

3010 
W64LIT
(0xae4b0ad488c43f7c),

3011 
W64LIT
(0x98cdc645d040aa9f),

3012 
W64LIT
(0x7fdef2e1aaf5b763),

3013 
W64LIT
(0x4717029728f6a07d),

3014 
W64LIT
(0x745593aeea2342ab),

3015 
W64LIT
(0xee8116cacd8bde85),

3016 
W64LIT
(0x727e56cd06ee188d),

3017 
W64LIT
(0x227c4d2e2f35bc37),

3018 
W64LIT
(0x977421488bb333c0),

3019 
W64LIT
(0xa21d7512a5ab8b30),

3020 
W64LIT
(0xbb4750817e010d0a),

3021 
W64LIT
(0x6cf96dd7b0fddf33),

3022 
W64LIT
(0x2801f78bee97525d),

3023 
W64LIT
(0x1c9e783b41fbf10f),

3024 
W64LIT
(0x9d099bed4a11ddaa),

3025 
W64LIT
(0x7a1aaf4930a4c056),

3026 
W64LIT
(0x32b44ad343a1f974),

3027 
W64LIT
(0x3cfb763499267b89),

3028 
W64LIT
(0xb2d572efc93fce73),

3029 
W64LIT
(0x63408adaeb0e466c),

3030 
W64LIT
(0xada4921ffe58126f),

3031 
W64LIT
(0x5fbbfcee72283de5),

3032 
W64LIT
(0x6ad2a8b45c308515),

3033 
W64LIT
(0x0c567fc62d6fb44c),

3034 
W64LIT
(0x956d62697c5b0571),

3035 
W64LIT
(0x25a153a7428cfdb3),

3036 
W64LIT
(0x150c5a55f6c53276),

3037 
W64LIT
(0xe2d7690ce0e46ac9),

3038 
W64LIT
(0xda1e997a62e77dd7),

3039 
W64LIT
(0xf5c27078e1c96e0e),

3040 
W64LIT
(0xc344bce9b94dfbed),

3041 
W64LIT
(0x60af12119d926b7f),

3042 
W64LIT
(0xa1f2edd9d337a623),

3043 
W64LIT
(0xcad69e870e733894),

3044 
W64LIT
(0x3770177bd9f08e41),

3045 
W64LIT
(0xa5c06b9bc812cab4),

3046 
W64LIT
(0x1f71e0f03767dc1c),

3047 
W64LIT
(0x44f89a5c5e6a8d6e),

3048 
W64LIT
(0x6159c9fb1ce670dd),

3049 
W64LIT
(0x8e2e04db5019b5fa),

3050 
W64LIT
(0x8805c1b8bcd4efdc),

3051 
W64LIT
(0xe138f1c7967847da),

3052 
W64LIT
(0x4ab7a6bb84ed0f93),

3053 
W64LIT
(0x0000000000000000),

3054 
W64LIT
(0x38c9f0768203171e),

3055 
W64LIT
(0x1b4366b22c42b08b),

3056 
W64LIT
(0x7803ec68c74cf6e7),

3057 
W64LIT
(0xec9855eb3a63e834),

3058 
W64LIT
(0xbe830d29e4507a3f),

3059 
W64LIT
(0x2dc5aa2374c62568),

3060 
W64LIT
(0xa62ff350be8ee7a7),

3061 
W64LIT
(0x764cd08f1dcb741a),

3062 
W64LIT
(0x8c3747faa7f1834b),

3063 
W64LIT
(0x0fb9e70d5bf3995f),

3064 
W64LIT
(0x55c6464bb38ad38f),

3065 
W64LIT
(0xf7db3359162158bf),

3066 
W64LIT
(0xd195f8352231881f),

3067 
W64LIT
(0x0992226eb73ec379),

3068 
W64LIT
(0x14fa81bf77b129d4),

3069 
W64LIT
(0x48aee59a73053922),

3070 
W64LIT
(0x2457884dc3f8e611),

3071 
W64LIT
(0xffbfcadd206b8064),

3072 
W64LIT
(0xb4feb78c25f29455),

3073 
W64LIT
(0x864afd5f66536d21),

3074 
W64LIT
(0x6f16f51cc661f220),

3075 
W64LIT
(0xde2c1f3879c21140),

3076 
W64LIT
(0x195a2593dbaa863a),

3077 
W64LIT
(0x2e2a32e8025a087b),

3078 
W64LIT
(0x432584d533d3ccea),

3079 
W64LIT
(0x2c3371c9f5b23eca),

3080 
W64LIT
(0xa7d928ba3ffafc05),

3081 
W64LIT
(0x42d35f3fb2a7d748),

3082 
W64LIT
(0x85a5659410cf4032),

3083 
W64LIT
(0x0864f984364ad8db),

3084 
W64LIT
(0xf21f6ef18c702f8a),

3085 
W64LIT
(0xf1f0f63afaec0299),

3086 
W64LIT
(0xd9f101b1147b50c4),

3087 
W64LIT
(0x2fdce902832e13d9),

3088 
W64LIT
(0x4d6ab832e9544e17),

3089 
W64LIT
(0xe0ce2a2d170c5c78),

3090 
W64LIT
(0x51f4c009a8afbf18),

3091 
W64LIT
(0x68cbeb95abd8b3a4),

3092 
W64LIT
(0xc15dffc84ea5cd5c),

3093 
W64LIT
(0x02194321f7e836b1),

3094 
W64LIT
(0x113edc17ede05ee1),

3095 
W64LIT
(0x521b58c2de33920b),

3096 
W64LIT
(0x9ad4856427a89c2e),

3097 
W64LIT
(0x5629de80c516fe9c),

3098 
W64LIT
(0x77ba0b659cbf6fb8),

3099 
W64LIT
(0x238a96c4ae41a795),

3100 
W64LIT
(0x12d144dc9b7c73f2),

3101 
W64LIT
(0xd807da5b950f4b66),

3102 
W64LIT
(0x3686cc91588495e3),

3103 
W64LIT
(0x18acfe795ade9d98),

3104 
W64LIT
(0x5a7fa146e8794ad0),

3105 
W64LIT
(0xc680e141231c8cd8),

3106 
W64LIT
(0x1e873b1ab613c7be),

3107 
W64LIT
(0xf434ab9260bd75ac),

3108 
W64LIT
(0xcd0b800e63ca7910),

3109 
W64LIT
(0xbc9a4e0813b84c8e),

3110 
W64LIT
(0x3d0dadde1852602b),

3111 
W64LIT
(0x40ca1c1e454fe1f9),

3112 
W64LIT
(0x0a7dbaa5c1a2ee6a),

3113 
W64LIT
(0x693d307f2aaca806),

3114 
W64LIT
(0x0e4f3ce7da8782fd),

3115 
W64LIT
(0xbd6c95e292cc572c),

3116 
W64LIT
(0x3ad0b35775eb21af),

3117 
W64LIT
(0x7e28290b2b81acc1),

3118 
W64LIT
(0x01f6dbea81741ba2),

3119 
W64LIT
(0x87bc26b5e7277683),

3120 
W64LIT
(0x393f2b9c03770cbc),

3121 
W64LIT
(0xddc387f30f5e3c53),

3122 
W64LIT
(0xeb454b6257daa9b0),

3123 
W64LIT
(0xb323a905484bd5d1),

3124 
W64LIT
(0xb13aea24bfa3e360),

3125 
W64LIT
(0x315bd218353dd467),

3126 
W64LIT
(0x2bee6f40980b7f4e),

3127 
W64LIT
(0xe95c0843a0329f01),

3128 
W64LIT
(0xc56f798a5580a1cb),

3129 
W64LIT
(0xbf75d6c36524619d),

3130 
W64LIT
(0x29f72c616fe349ff),

3131 
W64LIT
(0xc0ab2422cfd1d6fe),

3133 
W64LIT
(0x561fc423e957943c),

3134 
W64LIT
(0x014287ca69079288),

3135 
W64LIT
(0x2f086129dfcd1d21),

3136 
W64LIT
(0xc537d4aea044fd99),

3137 
W64LIT
(0xf1e8c3bfd7c8a457),

3138 
W64LIT
(0x2971998a5cdf9bfb),

3139 
W64LIT
(0x23fa649a2ce9e460),

3140 
W64LIT
(0x3aa9e9c356a6716a),

3141 
W64LIT
(0xd6efa4e7aa3d1708),

3142 
W64LIT
(0x705a24b1fda5b5eb),

3143 
W64LIT
(0x101e0ce2b170a9fc),

3144 
W64LIT
(0x7ca821020e814caa),

3145 
W64LIT
(0x0bc97ada1931ed13),

3146 
W64LIT
(0x34df1711778c59ce),

3147 
W64LIT
(0xd35020ef9226d2bf),

3148 
W64LIT
(0x575d43e9805006b4),

3149 
W64LIT
(0x91acebec9b1db840),

3150 
W64LIT
(0x549b3f423b5945d9),

3151 
W64LIT
(0x99a3ed9d3925163e),

3152 
W64LIT
(0x7917a50a369a891d),

3153 
W64LIT
(0xe372343cb4b6dc4e),

3154 
W64LIT
(0x8d40e2bdd949e8fd),

3155 
W64LIT
(0xcfbc29bed0728202),

3156 
W64LIT
(0x969794857108ac12),

3157 
W64LIT
(0xdd26de3db30cfa1b),

3158 
W64LIT
(0x115c8b28d8773b74),

3159 
W64LIT
(0xe9f9c92cc480a3d5),

3160 
W64LIT
(0x4dc8b21b4116d0d3),

3161 
W64LIT
(0x316093194f979c79),

3162 
W64LIT
(0x5124bb4a0342806e),

3163 
W64LIT
(0xb31408bcdef3cea8),

3164 
W64LIT
(0xc1cad76cf158aaa6),

3165 
W64LIT
(0x88ff66b5e1522d4a),

3166 
W64LIT
(0xa8c37e8476b28a47),

3167 
W64LIT
(0x15a188ea896b6c4b),

3168 
W64LIT
(0xa24883940684f5dc),

3169 
W64LIT
(0xda1da1545919ee49),

3170 
W64LIT
(0x22b8e35045ee76e8),

3171 
W64LIT
(0x6106af9925d28e9f),

3172 
W64LIT
(0xef80318f4792250f),

3173 
W64LIT
(0x663dd0f0cfc79acd),

3174 
W64LIT
(0x302214d326900ef1),

3175 
W64LIT
(0xdfa2255c61022bfe),

3176 
W64LIT
(0xe6cdb0348cad19f9),

3177 
W64LIT
(0x50663c806a4512e6),

3178 
W64LIT
(0x65fbac5b74ced9a0),

3179 
W64LIT
(0xc4755364c9436f11),

3180 
W64LIT
(0x8fc419dc0b473918),

3181 
W64LIT
(0x5c9439339961eba7),

3182 
W64LIT
(0x3f166dcb6ebdb4dd),

3183 
W64LIT
(0xba59890715ccf25e),

3184 
W64LIT
(0xf0aa4475becf36df),

3185 
W64LIT
(0x03c67cabbb09436d),

3186 
W64LIT
(0xb99ff5acaec5b133),

3187 
W64LIT
(0xf9e7c5ce75f00a29),

3188 
W64LIT
(0x6df4aa2ad6f677de),

3189 
W64LIT
(0xaeba8627f5a00c9d),

3190 
W64LIT
(0xa573fcfdec91e18e),

3191 
W64LIT
(0x7f6e5da9b5880fc7),

3192 
W64LIT
(0xca03adb6e86947b5),

3193 
W64LIT
(0x74a72773acb9e2d4),

3194 
W64LIT
(0x604428534cd51c17),

3195 
W64LIT
(0xf8a542041cf798a1),

3196 
W64LIT
(0x448533a08a29ec25),

3197 
W64LIT
(0x80f060c4436a8334),

3198 
W64LIT
(0x0db082799a236bc9),

3199 
W64LIT
(0xfa21b965cef94944),

3200 
W64LIT
(0x64b92b911dc94b28),

3201 
W64LIT
(0x7118a37b94a22763),

3202 
W64LIT
(0xaff801ed9ca79e15),

3203 
W64LIT
(0x1dae8e9b2b53c235),

3204 
W64LIT
(0x13d870490a79ea91),

3205 
W64LIT
(0x8a7b9dd4335cfcaf),

3206 
W64LIT
(0x1f2a75faf95d13d0),

3207 
W64LIT
(0xeec2b6452e95b787),

3208 
W64LIT
(0xc34e2c0d23567b43),

3209 
W64LIT
(0x47434f0b3120af48),

3210 
W64LIT
(0xa18eff3fbd8db6b1),

3211 
W64LIT
(0x98e16a57502284b6),

3212 
W64LIT
(0x37196bbacc851aa3),

3213 
W64LIT
(0x8e869e166240ab90),

3214 
W64LIT
(0x9fda153eba3790e4),

3215 
W64LIT
(0xf515c07d86d4f368),

3216 
W64LIT
(0x72dedfd02fab640e),

3217 
W64LIT
(0xe230b3f6ddb14ec6),

3218 
W64LIT
(0x97d5134f180f3e9a),

3219 
W64LIT
(0xe1f6cf5d66b80dab),

3220 
W64LIT
(0xe78f37fee5aa8b71),

3221 
W64LIT
(0xa30a045e6f836754),

3222 
W64LIT
(0x90ee6c26f21a2ac8),

3223 
W64LIT
(0xaa4785e5a4bc5ba2),

3224 
W64LIT
(0x4e0eceb0fa1f93be),

3225 
W64LIT
(0x94136fe4a3067df7),

3226 
W64LIT
(0x7b935e6be49458f8),

3227 
W64LIT
(0x9b2716fceb2bc7db),

3228 
W64LIT
(0x840d63061276d40b),

3229 
W64LIT
(0xed04caee959cf4ea),

3230 
W64LIT
(0xea3fb5877f89e0b8),

3231 
W64LIT
(0xb56df01f5de14872),

3232 
W64LIT
(0x4935b1d9100a87ec),

3233 
W64LIT
(0x82749ba5916452d1),

3234 
W64LIT
(0x58693af1c87dbc98),

3235 
W64LIT
(0x89bde17f8855bfc2),

3236 
W64LIT
(0x677f573aa6c00845),

3237 
W64LIT
(0xeb7d324d168e7230),

3238 
W64LIT
(0x0284fb61d20ed1e5),

3239 
W64LIT
(0xb190f3dd0cfd1f4d),

3240 
W64LIT
(0x684b2e22eeedb269),

3241 
W64LIT
(0x2bf562eb8ed14a1e),

3242 
W64LIT
(0xe0b448970fbf9f23),

3243 
W64LIT
(0x396f9568edaf3207),

3244 
W64LIT
(0x52e2c7e1b84bc303),

3245 
W64LIT
(0x77615bd817b0a1b9),

3246 
W64LIT
(0x7e2cda63dc8f9d4f),

3247 
W64LIT
(0xf22ebf146cc1e73a),

3248 
W64LIT
(0xc08850a6985f382e),

3249 
W64LIT
(0xd9dbddffe210ad24),

3250 
W64LIT
(0xbfe60d0f2dd737e9),

3251 
W64LIT
(0x9a659136822c5553),

3252 
W64LIT
(0x87cb1fada97f9766),

3253 
W64LIT
(0x4c8a35d12811425b),

3254 
W64LIT
(0x83361c6ff863c059),

3255 
W64LIT
(0xd212a725fb214037),

3256 
W64LIT
(0x9e9892f4d330026c),

3257 
W64LIT
(0x45c7b46ae32e7ead),

3258 
W64LIT
(0x5baf465a7374fff5),

3259 
W64LIT
(0xdc6459f7da0b6893),

3260 
W64LIT
(0xd46b5f867833c6ed),

3261 
W64LIT
(0x5dd6bef9f066792f),

3262 
W64LIT
(0xcb412a7c816ed53d),

3263 
W64LIT
(0x75e5a0b9c5be705c),

3264 
W64LIT
(0xf6d3bcd63dddb005),

3265 
W64LIT
(0xfb633eafa7fedbcc),

3266 
W64LIT
(0xd529d84c11345465),

3267 
W64LIT
(0xc9c5d11d536004d8),

3268 
W64LIT
(0xdb5f269e301e7cc1),

3269 
W64LIT
(0x86899867c07805ee),

3270 
W64LIT
(0x3d9296aabcb36538),

3271 
W64LIT
(0x2cce1d8264c45e4c),

3272 
W64LIT
(0x5aedc1901a736d7d),

3273 
W64LIT
(0x2e4ae6e3b6ca8fa9),

3274 
W64LIT
(0x1e68f230905a8158),

3275 
W64LIT
(0xdee0a2960805b976),

3276 
W64LIT
(0xcd38d2df027c53e7),

3277 
W64LIT
(0x6909a9e887ea20e1),

3278 
W64LIT
(0x24c11bf3c6fcf032),

3279 
W64LIT
(0x18110a9313480782),

3280 
W64LIT
(0xa7f7079c3e9f306b),

3281 
W64LIT
(0xd8995a358b173fac),

3282 
W64LIT
(0x854fe4cc7b714683),

3283 
W64LIT
(0xbd62f66effd9e60c),

3284 
W64LIT
(0x14e30f20e06cfec3),

3285 
W64LIT
(0x6e32d6816dff34b3),

3286 
W64LIT
(0x217e9ffbfee73585),

3287 
W64LIT
(0xc88756d73a679650),

3288 
W64LIT
(0x359d90db1e8bcb46),

3289 
W64LIT
(0x2645e09214f221d7),

3290 
W64LIT
(0x04fd03c2511c573f),

3291 
W64LIT
(0x739c581a46acf686),

3292 
W64LIT
(0xb0d2741765fa8dc5),

3293 
W64LIT
(0xa0cc78f5d48a2439),

3294 
W64LIT
(0x5e10c2524b6f3a42),

3295 
W64LIT
(0xe50bcc9f37a45a94),

3296 
W64LIT
(0x53a0402bd14c518b),

3297 
W64LIT
(0x413ab7a8b2322992),

3298 
W64LIT
(0x203c183197e0a70d),

3299 
W64LIT
(0xcc7a55156b7bc16f),

3300 
W64LIT
(0x4601c8c158273dc0),

3301 
W64LIT
(0xbea48ac544d0a561),

3302 
W64LIT
(0x638254f8f7dc5f7a),

3303 
W64LIT
(0xa6b580565798a2e3),

3304 
W64LIT
(0x3cd01160d5b4f7b0),

3305 
W64LIT
(0x8c026577b04e7a75),

3306 
W64LIT
(0x7ad1d9a18d93ca70),

3307 
W64LIT
(0x785522c05f9d1b95),

3308 
W64LIT
(0x5f5245982268a8ca),

3309 
W64LIT
(0x9551e82eca01ef7f),

3310 
W64LIT
(0x0000000000000000),

3311 
W64LIT
(0xbb1b0ecd7ccb60d6),

3312 
W64LIT
(0x094d81bbcb3f3cf6),

3313 
W64LIT
(0x28331e4035d80973),

3314 
W64LIT
(0xf7913b1c54da228d),

3315 
W64LIT
(0x6acfd5433ce3638c),

3316 
W64LIT
(0x1bd77638a84144ef),

3317 
W64LIT
(0x62c0d3329edbcdf2),

3318 
W64LIT
(0x81b2e70e2a6d11bc),

3319 
W64LIT
(0xd7ad232dc33a8580),

3320 
W64LIT
(0x05bf8408381bc5b7),

3321 
W64LIT
(0x33e468789d994d9c),

3322 
W64LIT
(0xfedcbaa79fe51e7b),

3323 
W64LIT
(0x4f4c497a93180136),

3324 
W64LIT
(0x073b7f69ea151452),

3325 
W64LIT
(0x0cf205b3f324f941),

3326 
W64LIT
(0x382d12a284a8a08f),

3327 
W64LIT
(0x1cec0951425450bd),

3328 
W64LIT
(0x55d9b888525ed751),

3329 
W64LIT
(0x6cb62de0bff1e556),

3330 
W64LIT
(0xd1d4db8e4028035a),

3331 
W64LIT
(0x25839c39affb62ba),

3332 
W64LIT
(0x4af3cd72ab03c481),

3333 
W64LIT
(0xa4317b3785967306),

3334 
W64LIT
(0x1a95f1f2c146d667),

3335 
W64LIT
(0x926a97472014fb2d),

3336 
W64LIT
(0xb7e90b7e8fef9997),

3337 
W64LIT
(0xcefeae74b975108a),

3338 
W64LIT
(0x3e54ea0107ba2655),

3339 
W64LIT
(0xd0965c44292f91d2),

3340 
W64LIT
(0xab05022fcdbbc92a),

3341 
W64LIT
(0xfd1ac60c24ec5d16),

3342 
W64LIT
(0xfc5841c64debcf9e),

3343 
W64LIT
(0xe4494b555ea3c81c),

3344 
W64LIT
(0xb6ab8cb4e6e80b1f),

3345 
W64LIT
(0x3beb6e093fa1e3e2),

3346 
W64LIT
(0xf36c38de05c675b2),

3347 
W64LIT
(0x9c1c6995013ed389),

3348 
W64LIT
(0x8b391a1e5a5b6e27),

3349 
W64LIT
(0xec464d24fc9b6662),

3350 
W64LIT
(0xad7cfa8c4ea94ff0),

3351 
W64LIT
(0x0f347918482dba2c),

3352 
W64LIT
(0x9d5eee5f68394101),

3353 
W64LIT
(0x7623dc127eb73331),

3354 
W64LIT
(0x32a6efb2f49edf14),

3355 
W64LIT
(0x2d8c9a480dc3ccc4),

3356 
W64LIT
(0xb2568f76b7f45c20),

3357 
W64LIT
(0x0e76fed2212a28a4),

3358 
W64LIT
(0x48773613790d1564),

3359 
W64LIT
(0x129af783637e7819),

3360 
W64LIT
(0x080f0671a238ae7e),

3361 
W64LIT
(0x365bec70a582882b),

3362 
W64LIT
(0x42fccb03093b6aff),

3363 
W64LIT
(0x0a8bfd1070367f9b),

3364 
W64LIT
(0xff9e3d6df6e28cf3),

3365 
W64LIT
(0xe8bb4ee6ad87315d),

3366 
W64LIT
(0xc7b32fcf724a2c7c),

3367 
W64LIT
(0xb8dd7266c7c223bb),

3368 
W64LIT
(0x9328108d491369a5),

3369 
W64LIT
(0x0679f8a3831286da),

3370 
W64LIT
(0x270767587df5b35f),

3371 
W64LIT
(0xa981f94e1fb518cf),

3372 
W64LIT
(0x6b8d528955e4f104),

3373 
W64LIT
(0x1667f44132622f26),

3374 
W64LIT
(0x2ab7e521e7d6d896),

3375 
W64LIT
(0xac3e7d4627aedd78),

3376 
W64LIT
(0x7deaa6c86786de22),

3377 
W64LIT
(0x1725738b5b65bdae),

3378 
W64LIT
(0x4bb14ab8c2045609),

3379 
W64LIT
(0x592bbd3ba17a2e10),

3380 
W64LIT
(0xc20cabc74a51e9cb),

3381 
W64LIT
(0x6f70514b04f8a63b),

3382 
W64LIT
(0xbc2071a496de7484),

3383 
W64LIT
(0x19538d597a4f950a),

3384 
W64LIT
(0xf45747b7efd361e0),

3385 
W64LIT
(0x43be4cc9603cf877),

3386 
W64LIT
(0xc6f1a8051b4dbef4),

3387 
W64LIT
(0xb42f77d534e6dafa),

3388 
W64LIT
(0x40783062db35bb1a),

3390 
W64LIT
(0xf5a96c292deb0a4e),

3391 
W64LIT
(0x211c9df6ee653c51),

3392 
W64LIT
(0x04de5ddcbeeef596),

3393 
W64LIT
(0xe1e5b06f7457c19f),

3394 
W64LIT
(0x74ca30f014a54fb6),

3395 
W64LIT
(0xc296f9f7c5457d85),

3396 
W64LIT
(0x7d4ee08a484d10b0),

3397 
W64LIT
(0xae87f2d0bf9b13ad),

3398 
W64LIT
(0x8df4bb480e89afb7),

3399 
W64LIT
(0x2d8b7a67d9a2d61e),

3400 
W64LIT
(0x0f3559c8bd712adb),

3401 
W64LIT
(0x541bc7312f013338),

3402 
W64LIT
(0x9ec4848b636d5164),

3403 
W64LIT
(0x952f809f60f28e29),

3404 
W64LIT
(0x28984d8cb28d6357),

3405 
W64LIT
(0xd4b5f1dfc38e361f),

3406 
W64LIT
(0x5674135f7076b373),

3407 
W64LIT
(0xb791a330042172ec),

3408 
W64LIT
(0xab94c53bd4b4a6e4),

3409 
W64LIT
(0xf17731f59305ffd8),

3410 
W64LIT
(0x39c7a621801e1dcf),

3411 
W64LIT
(0x20d1f7c13ba47c8e),

3412 
W64LIT
(0x5e3da912f95facaa),

3413 
W64LIT
(0xb1202a82e5b80731),

3414 
W64LIT
(0x13303fc36de4fed3),

3415 
W64LIT
(0x2e29c43e5314168a),

3416 
W64LIT
(0x861fbf5c0d1670fa),

3417 
W64LIT
(0x6458b16af3f771f1),

3418 
W64LIT
(0x3043765bdcf642c9),

3419 
W64LIT
(0x12fd55f4b825be0c),

3420 
W64LIT
(0x0a266e23d65e9f92),

3421 
W64LIT
(0x6595db5d2636312e),

3422 
W64LIT
(0x85bd010587a0b06e),

3423 
W64LIT
(0x9bd7b3600842e42d),

3424 
W64LIT
(0xaa59af0c0175e63b),

3425 
W64LIT
(0x240faa1d854a8918),

3426 
W64LIT
(0xf464061ef82a4a91),

3427 
W64LIT
(0x5c527d7ca6282ce1),

3428 
W64LIT
(0x03a2be598ab6c094),

3429 
W64LIT
(0x40571b7776bdf8e9),

3430 
W64LIT
(0xe4f687841f7874d6),

3431 
W64LIT
(0x115febad32937e98),

3432 
W64LIT
(0x5108f0da442e8671),

3433 
W64LIT
(0x9cab50e53c1ad12f),

3434 
W64LIT
(0x33e1c8025640825d),

3435 
W64LIT
(0x87d2d56bd8d73025),

3436 
W64LIT
(0xc0f92d999a32fdce),

3437 
W64LIT
(0x62e938d8126e042c),

3438 
W64LIT
(0x4a717554a0e3677b),

3439 
W64LIT
(0x0beb0414039fdf4d),

3440 
W64LIT
(0xd6da25b19cf9b654),

3441 
W64LIT
(0x55d6ad06fac073e7),

3442 
W64LIT
(0x632452efc7af44f3),

3443 
W64LIT
(0xb5fe775e5b56f2a7),

3444 
W64LIT
(0x892ae694b0675a21),

3445 
W64LIT
(0x7a32030f7c1525b2),

3446 
W64LIT
(0x5d9f174b73e96c3e),

3447 
W64LIT
(0xc35b93c010843d5a),

3448 
W64LIT
(0x373f95dee8ae77cb),

3449 
W64LIT
(0xfb515fd6455b604a),

3450 
W64LIT
(0xa9fb11558bc326af),

3451 
W64LIT
(0x22be23af64d3fcc5),

3452 
W64LIT
(0xa8367b625e026670),

3453 
W64LIT
(0xb8a4faf8b9505837),

3454 
W64LIT
(0x785dd7612362a5f9),

3455 
W64LIT
(0x588c20a018c6d977),

3456 
W64LIT
(0xea0eb47b77c81ed2),

3457 
W64LIT
(0xa6ce489d36b20c74),

3458 
W64LIT
(0x0c97e79137c7ea4f),

3459 
W64LIT
(0x7c838abd9d8c506f),

3460 
W64LIT
(0x57b97968a5b7f3ac),

3461 
W64LIT
(0x6c110b277ade6e28),

3462 
W64LIT
(0xc785ce1cae6ac8cc),

3463 
W64LIT
(0x1581b6718c7d8b0e),

3464 
W64LIT
(0x614b868198d8c4b8),

3465 
W64LIT
(0x27ad14440ffc498c),

3466 
W64LIT
(0xdb80a8177eff1cc4),

3467 
W64LIT
(0x472bf8f242e5cdeb),

3468 
W64LIT
(0x8a8858cd3ad19ab5),

3469 
W64LIT
(0xf60bd270a75dcada),

3470 
W64LIT
(0x43f5a52efc0b387d),

3471 
W64LIT
(0x6ddc6110af1f2ef7),

3472 
W64LIT
(0xf0ba5bc246c4bf07),

3473 
W64LIT
(0x6fb3b57ef068aebc),

3474 
W64LIT
(0x18db3bd76e7b219e),

3475 
W64LIT
(0x903cb7740bdd3b60),

3476 
W64LIT
(0x7bff6938a9d4656d),

3477 
W64LIT
(0xbdb7cd13d27fed7e),

3478 
W64LIT
(0x051337eb6b2fb549),

3479 
W64LIT
(0x77688ea99e138f22),

3480 
W64LIT
(0xd9ef7c7921889c8f),

3481 
W64LIT
(0x077ce38534583502),

3482 
W64LIT
(0xf318e59bcc727f93),

3483 
W64LIT
(0xb34ffeecbacf877a),

3484 
W64LIT
(0xe9ac0a22fd7ede46),

3485 
W64LIT
(0xfc2dbc5371035548),

3486 
W64LIT
(0x026fd46e5f77804b),

3487 
W64LIT
(0xe53bedb3cab93409),

3488 
W64LIT
(0xcc6eca08adf51781),

3489 
W64LIT
(0xe028da58a1968140),

3490 
W64LIT
(0x3a6518780aa8dd5b),

3491 
W64LIT
(0xce011e66f28297ca),

3492 
W64LIT
(0xa4a19cf369c58c3f),

3493 
W64LIT
(0xc5ea1a72f11d4887),

3494 
W64LIT
(0xc427704524dc0858),

3495 
W64LIT
(0x4238cf1929ca78a2),

3496 
W64LIT
(0x481ea13aff94e730),

3497 
W64LIT
(0xdf5ef5cbc011e952),

3498 
W64LIT
(0x80ae36eeec8f0527),

3499 
W64LIT
(0x5ae3f4ce47b1593c),

3500 
W64LIT
(0xcda3a03f7834575e),

3501 
W64LIT
(0x71d9071b7f8afaff),

3502 
W64LIT
(0xcadf43ba4c6c625c),

3503 
W64LIT
(0x1623082806cb4b9a),

3504 
W64LIT
(0x17ee621fd30a0b45),

3505 
W64LIT
(0x448946abc8530d7f),

3506 
W64LIT
(0x974054f13f850e62),

3507 
W64LIT
(0x73b6d37520fd7ab4),

3508 
W64LIT
(0xc8b097d4131be217),

3509 
W64LIT
(0x9f09eebcb6ac11bb),

3510 
W64LIT
(0x45442c9c1d924da0),

3511 
W64LIT
(0x1b79858ee4cde10a),

3512 
W64LIT
(0x0984d07a5ce85f06),

3513 
W64LIT
(0x4cc0fce6417a12a6),

3514 
W64LIT
(0x99b8670e57356466),

3515 
W64LIT
(0xad254c89352dd339),

3516 
W64LIT
(0x322ca2358381c282),

3517 
W64LIT
(0xcfcc74512743d715),

3518 
W64LIT
(0x6b6de8a24e865b2a),

3519 
W64LIT
(0xda4dc220ab3e5c1b),

3520 
W64LIT
(0x88e78ca365a61afe),

3521 
W64LIT
(0x939e092d816bfbf4),

3522 
W64LIT
(0xcb12298d99ad2283),

3523 
W64LIT
(0xeed0e9a7c926eb44),

3524 
W64LIT
(0x98750d3982f424b9),

3525 
W64LIT
(0xd5789be8164f76c0),

3526 
W64LIT
(0xbe15734a58c92dea),

3527 
W64LIT
(0x49d3cb0d2a55a7ef),

3528 
W64LIT
(0x67fa0f337941b165),

3529 
W64LIT
(0x8c39d17fdb48ef68),

3530 
W64LIT
(0x25c2c02a508bc9c7),

3531 
W64LIT
(0x349d2b876218b75f),

3532 
W64LIT
(0x70146d2caa4bba20),

3533 
W64LIT
(0x1c05660bd095d408),

3534 
W64LIT
(0xfe42683d2e74d503),

3535 
W64LIT
(0x9a1ad957dd83a4f2),

3536 
W64LIT
(0xf2d58fac19b33f4c),

3537 
W64LIT
(0x81635cd9394e45f8),

3538 
W64LIT
(0xb65cc907d1e03233),

3539 
W64LIT
(0xdd3121a59f666919),

3540 
W64LIT
(0x318e1c6c09370216),

3541 
W64LIT
(0x8b4532faef10da6a),

3542 
W64LIT
(0x191651e0bbba6141),

3543 
W64LIT
(0x3f762f9361876812),

3544 
W64LIT
(0xb96990cf6c9118e8),

3545 
W64LIT
(0xb4331d698e97b278),

3546 
W64LIT
(0xd822164ef449dc50),

3547 
W64LIT
(0x84706b325261f0b1),

3548 
W64LIT
(0x4eaf28881e0d92ed),

3549 
W64LIT
(0x69023ccc11f1db61),

3550 
W64LIT
(0x66376504ac80f1ba),

3551 
W64LIT
(0x0849ba4d89291fd9),

3552 
W64LIT
(0xff8f020afbb595dc),

3553 
W64LIT
(0x50c59aed91efc6ae),

3554 
W64LIT
(0x1dc80c3c055494d7),

3555 
W64LIT
(0x1e6ab2658fe25443),

3556 
W64LIT
(0x3d19fbfd3ef0e859),

3557 
W64LIT
(0xfa9c35e1909a2095),

3558 
W64LIT
(0x52aa4e83ce9846e5),

3559 
W64LIT
(0x419a7140a37cb836),

3560 
W64LIT
(0xa07fc12fd72b79a9),

3561 
W64LIT
(0x68cf56fbc4309bbe),

3562 
W64LIT
(0x01cd6a37d5c140df),

3563 
W64LIT
(0x9253631a54aabb2b),

3564 
W64LIT
(0xd06bac037d60c389),

3565 
W64LIT
(0x295527bb674c2388),

3566 
W64LIT
(0xd204786d221743c2),

3567 
W64LIT
(0x0000000000000000),

3568 
W64LIT
(0xf7c6b847729c8a05),

3569 
W64LIT
(0xdcfc4b924aa729c6),

3570 
W64LIT
(0xe38a64012b2041d4),

3571 
W64LIT
(0xb28294db6f0ec7a5),

3572 
W64LIT
(0x9d663ad2e9db91f0),

3573 
W64LIT
(0x91f1dd43de1c7bbf),

3574 
W64LIT
(0x6086ecb64d198467),

3575 
W64LIT
(0x59414a97cd0799a8),

3576 
W64LIT
(0xace826bee0ec93e6),

3577 
W64LIT
(0xa56cf6c4bc04cce0),

3578 
W64LIT
(0x727bb942f53c3a6b),

3579 
W64LIT
(0x6e7edf4925a9ee63),

3580 
W64LIT
(0x26607e73da3d0953),

3581 
W64LIT
(0xe75439dd95ceb442),

3582 
W64LIT
(0x7990bd56f6a3e526),

3583 
W64LIT
(0xecbf3dc996516b0f),

3584 
W64LIT
(0x76a5e49e4bd2cffd),

3585 
W64LIT
(0x968d3ec6ea444ebd),

3586 
W64LIT
(0x5b2e9ef9927019e3),

3587 
W64LIT
(0x6aa082959b471bf5),

3588 
W64LIT
(0xbb0644a133e698a3),

3589 
W64LIT
(0x830c88b76639c5b3),

3590 
W64LIT
(0xe2470e36fee1010b),

3591 
W64LIT
(0xb0ed40b5307947ee),

3592 
W64LIT
(0x355041b0b7d9f780),

3593 
W64LIT
(0x8e560511843f6f23),

3594 
W64LIT
(0x7f2134e4173a90fb),

3595 
W64LIT
(0x2af799e2edfae31c),

3596 
W64LIT
(0x4bbc1f63752227a4),

3597 
W64LIT
(0xf8f3e18fcfeda0de),

3598 
W64LIT
(0x0d5a8da6e206aa90),

3599 
W64LIT
(0x2c4610500c6396c1),

3600 
W64LIT
(0xde939ffc15d0a98d),

3601 
W64LIT
(0xaf4a98e76a5a5372),

3602 
W64LIT
(0x8f9b6f2651fe2ffc),

3603 
W64LIT
(0x36f2ffe93d6f3714),

3604 
W64LIT
(0x0ef833ff68b06a04),

3605 
W64LIT
(0xe69953ea400ff49d),

3606 
W64LIT
(0x23734998b112bc1a),

3607 
W64LIT
(0x3ebb45a4b44628cd),

3608 
W64LIT
(0x1ab4efb9310ca1d5),

3609 
W64LIT
(0x2fe4ae0986d55655),

3610 
W64LIT
(0xebc3de4ca2095e0d),

3611 
W64LIT
(0x536724b41b59063a),

3612 
W64LIT
(0x46e692c597248d34),

3613 
W64LIT
(0x2b3af3d5383ba3c3),

3614 
W64LIT
(0x3ba8724fdf699d84),

3615 
W64LIT
(0xc13447ae4ff3bd11),

3616 
W64LIT
(0x4d0d96d194bb5279),

3617 
W64LIT
(0xfde0d664a4c21597),

3618 
W64LIT
(0xd7174f864938f68b),

3619 
W64LIT
(0x7eec5ed3c2fbd024),

3620 
W64LIT
(0xbfd8197d8d086d35),

3621 
W64LIT
(0x4f6242bfcbccd232),

3622 
W64LIT
(0xa70322aae3734cab),

3623 
W64LIT
(0xa3dd7f765d9db93d),

3624 
W64LIT
(0x94e2eaa8b533cef6),

3625 
W64LIT
(0x144cdc4659bccbd1),

3626 
W64LIT
(0xc648a42b7bab8813),

3627 
W64LIT
(0xf93e8bb81a2ce001),

3628 
W64LIT
(0xbacb2e96e627d87c),

3629 
W64LIT
(0xbc7aa72407beada1),

3630 
W64LIT
(0xc97dfde3c6daa2c8),

3631 
W64LIT
(0xa1b2ab1802ea3976),

3632 
W64LIT
(0x1fa7d8525a23149c),

3633 
W64LIT
(0x75075ac7c1640f69),

3634 
W64LIT
(0xe861601528bf9e99),

3635 
W64LIT
(0xa2101541885cf9e2),

3636 
W64LIT
(0xef1d83901ce7ab9b),

3637 
W64LIT
(0x06b189b2e19975dd),

3638 
W64LIT
(0x380acc1655df5d10),

3639 
W64LIT
(0x1092819ae7523e47),

3640 
W64LIT
(0xd3c9125af7d6031d),

3641 
W64LIT
(0xd1a6c634a8a18356),

3642 
W64LIT
(0x5ff0c3252c9eec75),

3643 
W64LIT
(0x82c1e280b3f8856c),

3644 
W64LIT
(0xed7257fe43902bd0),

3645 
W64LIT
(0x3cd491caeb31a886),

3647 
W64LIT
(0x94af9eb6fad9e7df),

3648 
W64LIT
(0x9208ae5e03c94ddd),

3649 
W64LIT
(0x1d8de8d67158480b),

3650 
W64LIT
(0xfd093cd2ba147af8),

3651 
W64LIT
(0xa45ceb22e6597ccf),

3652 
W64LIT
(0x9bbde6e77bf113da),

3653 
W64LIT
(0xe4edf4b465fffe5c),

3654 
W64LIT
(0x7125622e4e8d2a2f),

3655 
W64LIT
(0x1791b81b8f68430d),

3656 
W64LIT
(0xb56a63d1902195c0),

3657 
W64LIT
(0xa980832b30d2ee67),

3658 
W64LIT
(0x4c0a7fb384862397),

3659 
W64LIT
(0xed58bc0d1dc7a05b),

3660 
W64LIT
(0x5955d7f05c4d0637),

3661 
W64LIT
(0xd2b9b1c8806fcf4e),

3662 
W64LIT
(0x06a730e8f910aa02),

3663 
W64LIT
(0xb8b60bd846aa0768),

3664 
W64LIT
(0x45bf370afcbe7d90),

3665 
W64LIT
(0x16f6b0375ec370a1),

3666 
W64LIT
(0x892276608b81afd4),

3667 
W64LIT
(0xdcccc1b5d0ec08e7),

3668 
W64LIT
(0xe856949162df5f58),

3669 
W64LIT
(0x82592e81a41a977e),

3670 
W64LIT
(0xac8eabb74fca1164),

3671 
W64LIT
(0xfac9041692afe356),

3672 
W64LIT
(0x3b882d75331ba3ba),

3673 
W64LIT
(0xa39cd3e6cee2e561),

3674 
W64LIT
(0xd077a190d7cca9e3),

3675 
W64LIT
(0x9c7dde23534a8a74),

3676 
W64LIT
(0x80973ed9f3b9f1d3),

3677 
W64LIT
(0xce535132209cb4e9),

3678 
W64LIT
(0xaa299b5fb6dabb66),

3679 
W64LIT
(0x2d7e9d426dd8d31b),

3680 
W64LIT
(0x8a8b6e140d89fad5),

3681 
W64LIT
(0x6ca88af83fd56224),

3682 
W64LIT
(0xf5db7c4713871753),

3683 
W64LIT
(0xeef1a4799bcff55a),

3684 
W64LIT
(0x76e55aea6636b381),

3685 
W64LIT
(0x8ee24ea4a33a367a),

3686 
W64LIT
(0x25acddd7c44bbeb0),

3687 
W64LIT
(0x9adaeecbaa5a2076),

3688 
W64LIT
(0x0e75707d5083c7a9),

3689 
W64LIT
(0x2bd9adaa94c87919),

3690 
W64LIT
(0x19e4c866dfeb84a4),

3691 
W64LIT
(0x129f9087f070bc0e),

3692 
W64LIT
(0xd9c2e929aff4f7e4),

3693 
W64LIT
(0x6f01928cb9dd3725),

3694 
W64LIT
(0x39463d2d64b8c517),

3695 
W64LIT
(0xebff8ce5e4d70a59),

3696 
W64LIT
(0xb40d6bfd418aa66c),

3697 
W64LIT
(0xf21b44833b3c8efd),

3698 
W64LIT
(0x3654457ce5903112),

3699 
W64LIT
(0x431807e205aed792),

3700 
W64LIT
(0xb10343613e92596f),

3701 
W64LIT
(0x0a1c50cdfe300b06),

3702 
W64LIT
(0x778252c6b79d802d),

3703 
W64LIT
(0x0cbb60250720a104),

3704 
W64LIT
(0xe1e3dc281ae7015f),

3705 
W64LIT
(0x0f1278518128f405),

3706 
W64LIT
(0x47712752ab1d1b3d),

3707 
W64LIT
(0xe24ac45c9cef545e),

3708 
W64LIT
(0x1ceae0faa0f37ba7),

3709 
W64LIT
(0x9814fe93fdf946db),

3710 
W64LIT
(0xec3fb421cc6c93f7),

3711 
W64LIT
(0x833e26ad75b1a4d2),

3712 
W64LIT
(0x6b68b23c176efb8a),

3713 
W64LIT
(0x4904572ffb9edc94),

3714 
W64LIT
(0x4bca4777ac3dba39),

3715 
W64LIT
(0x2762cd8f93e8d81d),

3716 
W64LIT
(0x9eb3ce7b04e9ecd9),

3717 
W64LIT
(0xc2e8311727bc15ed),

3718 
W64LIT
(0xea9884c9357c39f5),

3719 
W64LIT
(0xfc6e34fe6bbf4954),

3720 
W64LIT
(0x13f898ab21db8fa2),

3721 
W64LIT
(0xb7a47389c782f36d),

3722 
W64LIT
(0x7b3932e3b0bd2129),

3723 
W64LIT
(0xaf27b3c3c9c24465),

3724 
W64LIT
(0xb6c37ba51629c0c1),

3725 
W64LIT
(0x84fe1e695d0a3d7c),

3726 
W64LIT
(0x1a4dd01259e3d1a5),

3727 
W64LIT
(0xab4e9373677188ca),

3728 
W64LIT
(0x90c6be06546a2b70),

3729 
W64LIT
(0xf37c4cafea97bd51),

3730 
W64LIT
(0x647aca6d96460f8f),

3731 
W64LIT
(0x4ec46febd325453a),

3732 
W64LIT
(0x3e8605e94c035cb9),

3733 
W64LIT
(0x0ddc6809d68b92a8),

3734 
W64LIT
(0x8bec6638dc22c979),

3735 
W64LIT
(0x67d3d219104e5a8e),

3736 
W64LIT
(0x2abea58645634ab5),

3737 
W64LIT
(0x5b9bc7a80bee609a),

3738 
W64LIT
(0x936fa672d2627e71),

3739 
W64LIT
(0x7d9e020b49ad8b2b),

3740 
W64LIT
(0x5832dfdc8de6359b),

3741 
W64LIT
(0xc7e6198b58a4eaee),

3742 
W64LIT
(0xd41e8120797f654c),

3743 
W64LIT
(0xf4bc746bc22c24ff),

3744 
W64LIT
(0xe084d404cb4c32f3),

3745 
W64LIT
(0x48635f032a35ef38),

3746 
W64LIT
(0x8757061ddb02687d),

3747 
W64LIT
(0x522e8f1173d63e9d),

3748 
W64LIT
(0xbcdf2b68e819cbc7),

3749 
W64LIT
(0xbf76331c6e119ec6),

3750 
W64LIT
(0x08d24095a9936dab),

3751 
W64LIT
(0x728c7a5ac8857f2e),

3752 
W64LIT
(0xd110a9bc06679a4f),

3753 
W64LIT
(0x1f43f88e26fb2ea6),

3754 
W64LIT
(0xb2aa5b15b89a0c6e),

3755 
W64LIT
(0x4aad4f5b7d968995),

3756 
W64LIT
(0x9fd4c657d542df75),

3757 
W64LIT
(0x323d65cc4b23fdbd),

3758 
W64LIT
(0xc38f393bf6172641),

3759 
W64LIT
(0xa152c3be994183cc),

3760 
W64LIT
(0x9d1ad60f82e1b9d8),

3761 
W64LIT
(0xe744ecc0e3f7ab5d),

3762 
W64LIT
(0x38213501b513f6bb),

3763 
W64LIT
(0xade9a39b9e6122c8),

3764 
W64LIT
(0x37334d50343b02be),

3765 
W64LIT
(0x55eeb7d55b6da733),

3766 
W64LIT
(0x970686c27cd1b2de),

3767 
W64LIT
(0x427f0fced405e43e),

3768 
W64LIT
(0xc026214f701f7340),

3769 
W64LIT
(0x40b11f9683a68293),

3770 
W64LIT
(0x02ce105857a366ad),

3771 
W64LIT
(0x7e371a7fcfa5de2a),

3772 
W64LIT
(0xffc72c8aedb71c55),

3773 
W64LIT
(0x68c1aa489166ae8b),

3774 
W64LIT
(0xc68111a7890fd942),

3775 
W64LIT
(0x79f722bbe71e4784),

3776 
W64LIT
(0xd579890ca8d456e0),

3777 
W64LIT
(0x70426a029f261983),

3778 
W64LIT
(0xb0644b4def396ac3),

3779 
W64LIT
(0xdb0cf971f8579149),

3780 
W64LIT
(0x5489bff98ac6949f),

3781 
W64LIT
(0x046920b0aeb3ccaf),

3782 
W64LIT
(0x7cf90a279806b887),

3783 
W64LIT
(0x050e289c7f18ff03),

3784 
W64LIT
(0x651dc24147ed3c23),

3785 
W64LIT
(0x5e95ef3474f69f99),

3786 
W64LIT
(0x6dcf82d4ee7e5188),

3787 
W64LIT
(0x8f854688729105d6),

3788 
W64LIT
(0x81f036f52212c27f),

3789 
W64LIT
(0xb9d103f4970134c4),

3790 
W64LIT
(0x5349873da27d0d31),

3791 
W64LIT
(0x20a2f54bbb5341b3),

3792 
W64LIT
(0xf0d554db6c9fe850),

3793 
W64LIT
(0x07c038c428bb99ae),

3794 
W64LIT
(0x30f375941c809b10),

3795 
W64LIT
(0x3fe10dc59da86f15),

3796 
W64LIT
(0x46162f7e7ab62891),

3797 
W64LIT
(0xe623e4ec325c98f1),

3798 
W64LIT
(0xfea024a63c1c2ff9),

3799 
W64LIT
(0x349a5524b23357bf),

3800 
W64LIT
(0x35fd5d0863986413),

3801 
W64LIT
(0x96618eeead7a8172),

3802 
W64LIT
(0xcb5d79ae5f844bea),

3803 
W64LIT
(0x21c5fd676af8721f),

3804 
W64LIT
(0x5720a78d0ccec19e),

3805 
W64LIT
(0xf6726433958f4252),

3806 
W64LIT
(0x8d4b56d02532637b),

3807 
W64LIT
(0x24cbd5fb15e08d1c),

3808 
W64LIT
(0x3aef2559e2b09016),

3809 
W64LIT
(0x5afccf84da455336),

3810 
W64LIT
(0x51879765f5de6b9c),

3811 
W64LIT
(0x2917bdf2c36b1fb4),

3812 
W64LIT
(0xa7f5f356605129ce),

3813 
W64LIT
(0xc1412963a1b440ec),

3814 
W64LIT
(0x3d2f1d9dca0b09b8),

3815 
W64LIT
(0xa53be30e37f24f63),

3816 
W64LIT
(0x5ff2e718a55dac35),

3817 
W64LIT
(0xa2fbdbca1f49d6cd),

3818 
W64LIT
(0xf7156c1f442471fe),

3819 
W64LIT
(0x7a5e3acf61161285),

3820 
W64LIT
(0xca3a71828e2f7846),

3821 
W64LIT
(0x1b2ad83e8848e209),

3822 
W64LIT
(0xa8e78b07e179ddcb),

3823 
W64LIT
(0xef96ac554a64c6f6),

3824 
W64LIT
(0x0000000000000000),

3825 
W64LIT
(0x6013eadd38f5c320),

3826 
W64LIT
(0x3c4815b11ba03a14),

3827 
W64LIT
(0x09b548b978385e07),

3828 
W64LIT
(0x226ce513ecf0271e),

3829 
W64LIT
(0x63baf2a9befd9621),

3830 
W64LIT
(0x44d83f262d154e3c),

3831 
W64LIT
(0xcdfa4946a694e1e8),

3832 
W64LIT
(0x113688f37678e90f),

3833 
W64LIT
(0x859916458ca10ed0),

3834 
W64LIT
(0xc52809d30f078c43),

3835 
W64LIT
(0x4d6d779f552d103b),

3836 
W64LIT
(0x1e24f0a2f7501d0a),

3837 
W64LIT
(0x0167082cd1ab33ac),

3838 
W64LIT
(0x1438a06f0960160c),

3839 
W64LIT
(0xf9601c6214a7b657),

3840 
W64LIT
(0xa035cb9248eab060),

3841 
W64LIT
(0x50e09f4924755830),

3842 
W64LIT
(0xd7b79954ff77304d),

3843 
W64LIT
(0xe58afc98b454cdf0),

3844 
W64LIT
(0x03a9187486085501),

3845 
W64LIT
(0x62ddfa856f56a58d),

3846 
W64LIT
(0xc44f01ffdeacbfef),

3847 
W64LIT
(0x73eb7276192e4c82),

3848 
W64LIT
(0xd6d091782edc03e1),

3849 
W64LIT
(0xfbae0c3a4304d0fa),

3850 
W64LIT
(0x9973f6bf2c527577),

3851 
W64LIT
(0x105180dfa7d3daa3),

3852 
W64LIT
(0x2605c5a34243ebb1),

3853 
W64LIT
(0x91a1b62a85c118dc),

3854 
W64LIT
(0xc99369f608272d47),

3855 
W64LIT
(0x5d3cf740f2feca98),

3856 
W64LIT
(0xcf34591ef1378745),

3857 
W64LIT
(0xc8f461dad98c1eeb),

3858 
W64LIT
(0x0b7b58e12f9b38aa),

3859 
W64LIT
(0xe32dcc704d4467f2),

3860 
W64LIT
(0x754c429ee03ee680),

3861 
W64LIT
(0xd3deb9e451c4fce2),

3862 
W64LIT
(0x6e669aa068760489),

3863 
W64LIT
(0x66b4da35c1e56922),

3864 
W64LIT
(0x4fa367c7028e7696),

3865 
W64LIT
(0xba781b80110961c5),

3866 
W64LIT
(0x41d617ba520db13f),

3867 
W64LIT
(0x335a6de09a88ce11),

3868 
W64LIT
(0xdf65d9c156e45de6),

3869 
W64LIT
(0xcc9d416a773fd244),

3870 
W64LIT
(0x5c5bff6c2355f934),

3871 
W64LIT
(0x2870b5de12c02c18),

3872 
W64LIT
(0x155fa843d8cb25a0),

3873 
W64LIT
(0x78902a9736b57428),

3874 
W64LIT
(0xae40bbef186977c9),

3875 
W64LIT
(0x88457e4c5a2a9c78),

3876 
W64LIT
(0x6a0fba10c6c5c826),

3877 
W64LIT
(0x7f5012531e0eed86),

3878 
W64LIT
(0x8c2c5efcf49950d7),

3879 
W64LIT
(0x31947db8cd2ba8bc),

3880 
W64LIT
(0x2c19956ebc73e0b7),

3881 
W64LIT
(0x230bed3f3d5b14b2),

3882 
W64LIT
(0x69a6a26440cd9d27),

3883 
W64LIT
(0x86300e310aa95bd1),

3884 
W64LIT
(0xb3cd533969313fc2),

3885 
W64LIT
(0x1883c04a0e40b708),

3886 
W64LIT
(0xf1b25cf7bd34dbfc),

3887 
W64LIT
(0x2fb08d1a3a7bb5b6),

3888 
W64LIT
(0xd8a5e1057e5fc448),

3889 
W64LIT
(0xddabc99901473b4b),

3890 
W64LIT
(0xde02d1ed874f6e4a),

3891 
W64LIT
(0xbdb8234439b2f86b),

3892 
W64LIT
(0x5647afa1dd65f232),

3893 
W64LIT
(0x2ed78536ebd0861a),

3894 
W64LIT
(0xe9319cbdb3746cf4),

3895 
W64LIT
(0xa692fb7ab1fa1a62),

3896 
W64LIT
(0x742b4ab23195d52c),

3897 
W64LIT
(0x95c8969a2b72d473),

3898 
W64LIT
(0x6174e2f1e95ef08c),

3899 
W64LIT
(0xf807144ec50c85fb),

3900 
W64LIT
(0xbe113b30bfbaad6a),

3901 
W64LIT
(0xda6bf15d29fca2e5),

3902 
W64LIT
(0xbb1f13acc0a25269),

3904 
W64LIT
(0xc22b27f0f9e37bf9),

3905 
W64LIT
(0x93fad23f0955ef09),

3906 
W64LIT
(0x32ed4b84a22a91a2),

3907 
W64LIT
(0x3898b57bcc61b1cc),

3908 
W64LIT
(0x55825ba9ad98e5ad),

3909 
W64LIT
(0xb2eeb8069421ec94),

3910 
W64LIT
(0xc7eb5875ce3c6bce),

3911 
W64LIT
(0x4b1dac5d1f45851f),

3912 
W64LIT
(0xc16ba1204705d847),

3913 
W64LIT
(0xc5380f461a2ba91a),

3914 
W64LIT
(0xb908971a909bad90),

3915 
W64LIT
(0x303e1cb7763d5376),

3916 
W64LIT
(0xe6ff324c53486853),

3917 
W64LIT
(0x6d1aeed261f95461),

3918 
W64LIT
(0x0193d1e36af1616a),

3919 
W64LIT
(0x51d1f5cff0b694f0),

3920 
W64LIT
(0x29b2c3f52728e127),

3921 
W64LIT
(0x112a768eeb4950eb),

3922 
W64LIT
(0x8fb672f86f9f4d6f),

3923 
W64LIT
(0xf0c66c745bc9ea5b),

3924 
W64LIT
(0x3f8b9dcd2fa9632f),

3925 
W64LIT
(0x65bc471edba5b6db),

3926 
W64LIT
(0x4d9d5508967c3696),

3927 
W64LIT
(0x3a4be24818767318),

3928 
W64LIT
(0x2794936c144db014),

3929 
W64LIT
(0x2af2452599ce4299),

3930 
W64LIT
(0x4a8e7dbe75b4e475),

3931 
W64LIT
(0x9ddc82a63a30be3a),

3932 
W64LIT
(0xade29e114c0ded4c),

3933 
W64LIT
(0xd1d2064dc6bde9c6),

3934 
W64LIT
(0x7da349bfe04165e0),

3935 
W64LIT
(0x6b9a1787e8c0e7e8),

3936 
W64LIT
(0xa54437ddf6510ff6),

3937 
W64LIT
(0x2254ece92392a023),

3938 
W64LIT
(0x79f0e7d9bd6f14bd),

3939 
W64LIT
(0x57510c9a798f2779),

3940 
W64LIT
(0x346db2d12b13222b),

3941 
W64LIT
(0x54118a4ac76984c7),

3942 
W64LIT
(0xefca4a6383e5eb83),

3943 
W64LIT
(0xca8d8e3c43bf9943),

3944 
W64LIT
(0xfc336bdebcbb79bc),

3945 
W64LIT
(0x3e184c2e45580245),

3946 
W64LIT
(0xf495c21206e79b06),

3947 
W64LIT
(0xff73ed0e025dda02),

3948 
W64LIT
(0x4228d472cfe806cf),

3949 
W64LIT
(0xbcc8e89fa744bda7),

3950 
W64LIT
(0xab626744c5345ec5),

3951 
W64LIT
(0xb6bd1660c90f9dc9),

3952 
W64LIT
(0xb72ec783a3fefca3),

3953 
W64LIT
(0x8be5dc9e32b13c32),

3954 
W64LIT
(0x485d2a8da1a326a1),

3955 
W64LIT
(0xc6788996a4cd0aa4),

3956 
W64LIT
(0x40fb83411bffc41b),

3957 
W64LIT
(0x08a6a9ccba5ce2ba),

3958 
W64LIT
(0xf386eaa4e52f49e5),

3959 
W64LIT
(0x1acc5992eff311ef),

3960 
W64LIT
(0xa2571f6b1599dd15),

3961 
W64LIT
(0x44a82d2746d1b546),

3962 
W64LIT
(0x70c59ff66dc2976d),

3963 
W64LIT
(0x8d6525cbbb888fbb),

3964 
W64LIT
(0x963aadba3e8aff3e),

3965 
W64LIT
(0x7c30985c8ab0048a),

3966 
W64LIT
(0x607c389bec7aa6ec),

3967 
W64LIT
(0xa822e1947bd2fd7b),

3968 
W64LIT
(0x034086d0bee6a3be),

3969 
W64LIT
(0x66fcc1ce65431565),

3970 
W64LIT
(0xb37d69e5fed08dfe),

3971 
W64LIT
(0x2f323aa0ae1152ae),

3972 
W64LIT
(0x56c2dd79137e4613),

3973 
W64LIT
(0x31adcd541ccc321c),

3974 
W64LIT
(0xdff456d4f5d8b8f5),

3975 
W64LIT
(0xf9f3145b8b64698b),

3976 
W64LIT
(0x764566a3e4fb24e4),

3977 
W64LIT
(0x0cf507aae77293e7),

3978 
W64LIT
(0x59775c034aea764a),

3979 
W64LIT
(0xb89b46f9fa6accfa),

3980 
W64LIT
(0xe8d962d5602d3960),

3981 
W64LIT
(0x17aa8fdb6270e362),

3982 
W64LIT
(0x1c4ca0c766caa266),

3983 
W64LIT
(0x2de16d937a06907a),

3984 
W64LIT
(0x2547c45fc05a72c0),

3985 
W64LIT
(0x0fb5817a59943059),

3986 
W64LIT
(0x0680f9558939b389),

3987 
W64LIT
(0x16395e3808818208),

3988 
W64LIT
(0xac714ff226fc8c26),

3989 
W64LIT
(0xa9b1307711239c11),

3990 
W64LIT
(0xec8accb33d03483d),

3991 
W64LIT
(0x6c893f310b08350b),

3992 
W64LIT
(0xc4abdea570dac870),

3993 
W64LIT
(0xba4811ca2e7d0e2e),

3994 
W64LIT
(0xf155bd9731388b31),

3995 
W64LIT
(0xdd2701e721cf7a21),

3996 
W64LIT
(0xe94ab3360adc580a),

3997 
W64LIT
(0x23c73d0a4963c149),

3998 
W64LIT
(0x5cb723867d35667d),

3999 
W64LIT
(0x5042242c9a47f59a),

4000 
W64LIT
(0x198cdf425115b251),

4001 
W64LIT
(0x0a75feff6e4b206e),

4002 
W64LIT
(0xfda0ba3dd64a18d6),

4003 
W64LIT
(0xcede205a1e91e81e),

4004 
W64LIT
(0xd041d7aeac4c88ac),

4005 
W64LIT
(0xe42c657f875faa87),

4006 
W64LIT
(0x36bee5e2ff04e0ff),

4007 
W64LIT
(0x6fc9b9e1b5ee96b5),

4008 
W64LIT
(0x998f2cc0671ecf67),

4009 
W64LIT
(0xd301517e12aa2b12),

4010 
W64LIT
(0xaea218c1f2eb4ef2),

4011 
W64LIT
(0xda342951c207a8c2),

4012 
W64LIT
(0x61efe978868bc786),

4013 
W64LIT
(0x7f701e8c3456a734),

4014 
W64LIT
(0x0be62f1c04ba4104),

4015 
W64LIT
(0x9129850cdd422ddd),

4016 
W64LIT
(0xd6c12efb25753b25),

4017 
W64LIT
(0xe33f4dc964977864),

4018 
W64LIT
(0x1579d8e8b66721b6),

4019 
W64LIT
(0xf860c5b8e19508e1),

4020 
W64LIT
(0x7496319030ece630),

4021 
W64LIT
(0x88a55a4e8c579f8c),

4022 
W64LIT
(0xcf4df1b974608974),

4023 
W64LIT
(0x10b9a76d81b83181),

4024 
W64LIT
(0x0e26509933655133),

4025 
W64LIT
(0x43bb0591a51967a5),

4026 
W64LIT
(0x926903dc63a48e63),

4027 
W64LIT
(0x9c4f534550c1df50),

4028 
W64LIT
(0x3bd833ab72871272),

4029 
W64LIT
(0xa4d7e63e9ca06e9c),

4030 
W64LIT
(0xb46e41531d185f1d),

4031 
W64LIT
(0x126af05e55aff355),

4032 
W64LIT
(0x24d415bcaaab13aa),

4033 
W64LIT
(0x1e9ff7f4b2dd60b2),

4034 
W64LIT
(0x05c07f8537df1037),

4035 
W64LIT
(0x467b7a1492c67792),

4036 
W64LIT
(0x2087bbdaf78562f7),

4037 
W64LIT
(0x819022615cfa1c5c),

4038 
W64LIT
(0xcd9ea68aa0774ba0),

4039 
W64LIT
(0xa79760ee2246cd22),

4040 
W64LIT
(0x8343755288edde88),

4041 
W64LIT
(0x58e48de0201b1720),

4042 
W64LIT
(0x7216c8c5b9d555b9),

4043 
W64LIT
(0x372d340195f58195),

4044 
W64LIT
(0xa11799bbab7f7eab),

4045 
W64LIT
(0x9f0fd595ee277cee),

4046 
W64LIT
(0x676f102d0fb2740f),

4047 
W64LIT
(0x9e9c047684d61d84),

4048 
W64LIT
(0x49cefb6ecb5247cb),

4049 
W64LIT
(0xd41279c8f162f9f1),

4050 
W64LIT
(0x1f0c2617d82c01d8),

4051 
W64LIT
(0x97a97c59547b9e54),

4052 
W64LIT
(0xe76ce3af39b90939),

4053 
W64LIT
(0xc3b8f61393121a93),

4054 
W64LIT
(0x5ba40b309efdb49e),

4055 
W64LIT
(0xea0a35e6b43afbb4),

4056 
W64LIT
(0x5a37dad3f40cd5f4),

4057 
W64LIT
(0x14ea090bdc9640dc),

4058 
W64LIT
(0x5e6474b5a922a4a9),

4059 
W64LIT
(0xfee03ced68acbb68),

4060 
W64LIT
(0x071328b6e3c8d2e3),

4061 
W64LIT
(0x5302a2fc24a15624),

4062 
W64LIT
(0x85c38c0701d46d01),

4063 
W64LIT
(0x3d58cafefbbea1fb),

4064 
W64LIT
(0x84505de46b250c6b),

4065 
W64LIT
(0x642f96fdb154d7b1),

4066 
W64LIT
(0xbf886e4f19a21e19),

4067 
W64LIT
(0x02d35733d417c2d4),

4068 
W64LIT
(0x68da915756264456),

4069 
W64LIT
(0x8710db34d5c3afd5),

4070 
W64LIT
(0x0d66d6498d83f28d),

4071 
W64LIT
(0x7b23b0ea6978d669),

4072 
W64LIT
(0x1b5f887185027085),

4073 
W64LIT
(0x3ccb1b1d914fc091),

4074 
W64LIT
(0x0453ae665d2e715d),

4075 
W64LIT
(0xcb1e5fdf294ef829),

4076 
W64LIT
(0xf6469521d2f059d2),

4077 
W64LIT
(0xb03def3540362e40),

4078 
W64LIT
(0x633cbe4b529c0552),

4079 
W64LIT
(0xf7d544c2b80138b8),

4080 
W64LIT
(0x7ab061090389b703),

4081 
W64LIT
(0x0000000000000000),

4082 
W64LIT
(0xdba7f8b2a8f6c9a8),

4083 
W64LIT
(0x35fe633241e24341),

4084 
W64LIT
(0x21146a399d74039d),

4085 
W64LIT
(0xd581a82b9b93989b),

4086 
W64LIT
(0x0935782fd0ad83d0),

4087 
W64LIT
(0x5ff7a556c3d3c5c3),

4088 
W64LIT
(0xaf31c922981a2f98),

4089 
W64LIT
(0x90ba54efb7b34cb7),

4090 
W64LIT
(0x5291731f4e50374e),

4091 
W64LIT
(0xc0f870c32df4b92d),

4092 
W64LIT
(0x7ee3cf6f5ea7c65e),

4093 
W64LIT
(0xe07fcb19da71dbda),

4094 
W64LIT
(0x4eddd3d8289a9528),

4095 
W64LIT
(0x13f921bd3f5e923f),

4096 
W64LIT
(0xf50613f16c16fa6c),

4097 
W64LIT
(0x981cfd230defae0d),

4098 
W64LIT
(0x4c0e84ebfc8d57fc),

4099 
W64LIT
(0x82d0a4b1e21cbfe2),

4100 
W64LIT
(0x89368bade6a6fee6),

4101 
W64LIT
(0xd292809d785b4a78),

4102 
W64LIT
(0x47e8abf7f83716f8),

4103 
W64LIT
(0x8e25a31b056e2c05),

4104 
W64LIT
(0xd752ff184f845a4f),

4105 
W64LIT
(0xcc0d7769ca862aca),

4106 
W64LIT
(0x694940b43cd7253c),

4107 
W64LIT
(0x2ea1eb43c4e033c4),

4108 
W64LIT
(0xde6787379f29d99f),

4109 
W64LIT
(0x181f0ea13be4d33b),

4110 
W64LIT
(0x416852a2710ea571),

4111 
W64LIT
(0x62af6fa8386d6438),

4112 
W64LIT
(0xa0844858c18e1fc1),

4113 
W64LIT
(0x337e9a67c8dbf0c8),

4114 
W64LIT
(0x2c72bc7010f7f110),

4115 
W64LIT
(0xbd5b397ccdb5dccd),

4116 
W64LIT
(0xd8e77e6216106a16),

4117 
W64LIT
(0x86830ad7bf32cebf),

4118 
W64LIT
(0x4f4e023b426bf442),

4119 
W64LIT
(0xe5bfb49cedaecbed),

4120 
W64LIT
(0x8a760d7d58405d58),

4121 
W64LIT
(0xe2ac9c2a0e66190e),

4122 
W64LIT
(0xb5fd90b077e93e77),

4123 
W64LIT
(0xdcb4d0044b3e1b4b),

4124 
W64LIT
(0x453bfcc42c20d42c),

4125 
W64LIT
(0xed191d5057f22957),

4126 
W64LIT
(0xe1ec1afab080bab0),

4127 
W64LIT
(0xee599b80e9148ae9),

4128 
W64LIT
(0x2607428f7ebcd17e),

4129 
W64LIT
(0x5d24f26517c40717),

4130 
W64LIT
(0x6a09c66482318682),

4131 
W64LIT
(0xa604b10d48b7ac48),

4132 
W64LIT
(0xbe1bbfac73537f73),

4133 
W64LIT
(0x282112164dd9804d),

4134 
W64LIT
(0x7505e0735a1d875a),

4135 
W64LIT
(0x73851926d32434d3),

4136 
W64LIT
(0xd974af817ce10b7c),

4137 
W64LIT
(0xeb99e405decb9ade),

4138 
W64LIT
(0x9b5c7bf3b3090db3),

4139 
W64LIT
(0xfab3928b3582ca35),

4140 
W64LIT
(0x8003f382360b7d36),

4141 
W64LIT
(0x94e9fa89ea9d3dea),

4142 
W64LIT
(0xb1ae3ed62ac74f2a),

4143 
W64LIT
(0x9acfaa10d9f86cd9),

4144 
W64LIT
(0x390b6498a690d0a6),

4145 
W64LIT
(0xf2153b478fde288f),

4146 
W64LIT
(0x71564e150733f607),

4147 
W64LIT
(0xa3c4ce887f68bc7f),

4148 
W64LIT
(0xaaf1b6a7afc53faf),

4149 
W64LIT
(0x1ddf71240c3bc30c),

4150 
W64LIT
(0x77d6b7408e0a458e),

4151 
W64LIT
(0x2b6194c6f33f23f3),

4152 
W64LIT
(0xc9cd08ecfd593afd),

4153 
W64LIT
(0xc85ed90f97a85b97),

4154 
W64LIT
(0x8cf6f428d179eed1),

4155 
W64LIT
(0x957a2b6a806c5c80),

4156 
W64LIT
(0xbbdbc029448c6f44),

4157 
W64LIT
(0x7863363ad79e75d7),

4158 
W64LIT
(0x6e5a6802df1ff7df),

4159 
W64LIT
(0xfb2043685f73ab5f),

4162 
	gNAMESPACE_END


	@simple.cpp

3 
	~"pch.h
"

5 #iâdeà
CRYPTOPP_IMPORTS


7 
	~"sim¶e.h
"

8 
	~"£cblock.h
"

10 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

12 
NAMESPACE_END


	@simple.h

6 #iâdeà
CRYPTOPP_SIMPLE_H


7 
	#CRYPTOPP_SIMPLE_H


	)

9 
	~"üy±lib.h
"

10 
	~"misc.h
"

12 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

15 
‹m¶©e
 <
şass
 
DERIVED
, cÏs 
BASE
>

16 şas 
	cCRYPTOPP_NO_VTABLE
 
ClÚabËIm¶
 : 
public
 
BASE


18 
public
:

19 
ClÚabË
 * 
	$ClÚe
(ècÚ¡ { 
Ãw
 
	`DERIVED
(*
¡©ic_ÿ¡
<cÚ¡ 
DERIVED
 *>(
this
));}

20 
	}
};

23 
	g‹m¶©e
 <
şass
 
	gBASE
, cÏs 
	gALGORITHM_INFO
=
BASE
>

24 şas 
	cCRYPTOPP_NO_VTABLE
 
AlgÜ™hmIm¶
 : 
public
 
BASE


26 
public
:

27 
¡d
::
¡ršg
 
CRYPTOPP_API
 
	$SticAlgÜ™hmName
(è{ 
ALGORITHM_INFO
::
	`SticAlgÜ™hmName
();}

28 
¡d
::
¡ršg
 
	$AlgÜ™hmName
(ècÚ¡ { 
ALGORITHM_INFO
::
	`SticAlgÜ™hmName
();
	}
}

32 şas 
	cCRYPTOPP_DLL
 
	mInv®idKeyL’gth
 : 
public
 
Inv®idArgum’t


34 
public
:

35 
ex¶ic™
 
	$Inv®idKeyL’gth
(cÚ¡ 
¡d
::
¡ršg
 &
®gÜ™hm
, 
size_t
 
Ëngth
è: 
	`Inv®idArgum’t
×lgÜ™hm + ": " + 
	`IÁToSŒšg
(length) + " is‚ot‡ valid key†ength") {}

36 
	}
};

39 şas 
	cCRYPTOPP_DLL
 
	mInv®idRounds
 : 
public
 
Inv®idArgum’t


41 
public
:

42 
ex¶ic™
 
	$Inv®idRounds
(cÚ¡ 
¡d
::
¡ršg
 &
®gÜ™hm
, 
rounds
è: 
	`Inv®idArgum’t
×lgÜ™hm + ": " + 
	`IÁToSŒšg
(rounds) + " is‚ot‡ valid‚umber of„ounds") {}

43 
	}
};

48 
	g‹m¶©e
 <
şass
 
	gT
>

49 şas 
	cCRYPTOPP_NO_VTABLE
 
	mBufã¾ess
 : 
public
 
T


51 
public
:

52 
boŞ
 
	$IsŞ©edFlush
(
boŞ
 
h¬dFlush
, boŞ 
blockšg
è{ 
çl£
;}

53 
	}
};

56 
	g‹m¶©e
 <
şass
 
	gT
>

57 şas 
	cCRYPTOPP_NO_VTABLE
 
	mUnæushabË
 : 
public
 
T


59 
public
:

60 
boŞ
 
Flush
(boŞ 
com¶‘eFlush
, 
´İag©iÚ
=-1, boŞ 
blockšg
=
Œue
)

61 { 
ChªÃlFlush
(
DEFAULT_CHANNEL
, 
com¶‘eFlush
, 
´İag©iÚ
, 
blockšg
);}

62 
boŞ
 
	$IsŞ©edFlush
(
boŞ
 
h¬dFlush
, boŞ 
blockšg
)

63 {
	`as£¹
(
çl£
);  f®£;
	}
}

64 
boŞ
 
ChªÃlFlush
(cÚ¡ 
¡d
::
¡ršg
 &
chªÃl
, boŞ 
h¬dFlush
, 
´İag©iÚ
=-1, boŞ 
blockšg
=
Œue
)

66 ià(
h¬dFlush
 && !
IÅutBufãrIsEm±y
())

67 
throw
 
CªnÙFlush
("Unflushable<T>:his object has buffered inputhat cannot be flushed");

70 
Bufã»dT¿nsfÜm©iÚ
 *
	g©ched
 = 
this
->
A‰achedT¿nsfÜm©iÚ
();

71  
	g©ched
 && 
	g´İag©iÚ
 ?‡‰ached->
ChªÃlFlush
(
chªÃl
, 
h¬dFlush
, 
´İag©iÚ
-1, 
blockšg
è: 
çl£
;

75 
	g´Ùeùed
:

76 
vœtu®
 
boŞ
 
	$IÅutBufãrIsEm±y
(ècÚ¡ { 
çl£
;
	}
}

80 
	g‹m¶©e
 <
şass
 
	gT
>

81 şas 
	cCRYPTOPP_NO_VTABLE
 
	mIÅutRejeùšg
 : 
public
 
T


83 
public
:

84 
IÅutRejeùed
 : 
public
 
NÙIm¶em’‹d


85 {
IÅutRejeùed
(è: 
NÙIm¶em’‹d
("BufferedTransformation:his object doesn't‡llow input") {}};

88 
size_t
 
	$Put2
(cÚ¡ 
by‹
 *
begš
, 
size_t
 
Ëngth
, 
mes§geEnd
, 
boŞ
 
blockšg
)

89 {
throw
 
	`IÅutRejeùed
();
	}
}

90 
boŞ
 
	$IsŞ©edFlush
(
boŞ
, boŞè{ 
çl£
;
	}
}

91 
boŞ
 
	$IsŞ©edMes§geS”›sEnd
(
boŞ
è{
throw
 
	`IÅutRejeùed
();
	}
}

93 
size_t
 
	$ChªÃlPut2
(cÚ¡ 
¡d
::
¡ršg
 &
chªÃl
, cÚ¡ 
by‹
 *
begš
, 
size_t
 
Ëngth
, 
mes§geEnd
, 
boŞ
 
blockšg
)

94 {
throw
 
	`IÅutRejeùed
();
	}
}

95 
boŞ
 
	$ChªÃlMes§geS”›sEnd
(cÚ¡ 
¡d
::
¡ršg
 &, , 
boŞ
è{
throw
 
	`IÅutRejeùed
();
	}
}

99 
	g‹m¶©e
 <
şass
 
	gT
>

100 şas 
	cCRYPTOPP_NO_VTABLE
 
	mCu¡omFlushPrİag©iÚ
 : 
public
 
T


102 
public
:

103 
vœtu®
 
boŞ
 
Flush
(boŞ 
h¬dFlush
, 
´İag©iÚ
=-1, boŞ 
blockšg
=
Œue
) =0;

105 
	m´iv©e
:

106 
boŞ
 
	$IsŞ©edFlush
(
boŞ
 
h¬dFlush
, boŞ 
blockšg
è{
	`as£¹
(
çl£
);  false;}

107 
	}
};

110 
	g‹m¶©e
 <
şass
 
	gT
>

111 
şass
 
CRYPTOPP_NO_VTABLE
 
	gCu¡omSigÇlPrİag©iÚ
 : 
public
 
Cu¡omFlushPrİag©iÚ
<
T
>

113 
public
:

114 
vœtu®
 
In™Ÿlize
(cÚ¡ 
NameV®uePaœs
 &
·¿m‘”s
=
g_nuÎNameV®uePaœs
, 
´İag©iÚ
=-1) =0;

116 
	g´iv©e
:

117 
IsŞ©edIn™Ÿlize
(cÚ¡ 
NameV®uePaœs
 &
·¿m‘”s
è{
as£¹
(
çl£
);}

121 
	g‹m¶©e
 <
şass
 
	gT
>

122 
şass
 
CRYPTOPP_NO_VTABLE
 
	gMuÉichªÃl
 : 
public
 
Cu¡omFlushPrİag©iÚ
<
T
>

124 
public
:

125 
boŞ
 
Flush
(boŞ 
h¬dFlush
, 
´İag©iÚ
=-1, boŞ 
blockšg
=
Œue
)

126 { 
this
->
ChªÃlFlush
(
DEFAULT_CHANNEL
, 
h¬dFlush
, 
´İag©iÚ
, 
blockšg
);}

127 
boŞ
 
Mes§geS”›sEnd
(
´İag©iÚ
=-1, boŞ 
blockšg
=
Œue
)

128 { 
this
->
ChªÃlMes§geS”›sEnd
(
DEFAULT_CHANNEL
, 
´İag©iÚ
, 
blockšg
);}

129 
by‹
 * 
C»©ePutS·û
(
size_t
 &
size
)

130 { 
	gthis
->
ChªÃlC»©ePutS·û
(
DEFAULT_CHANNEL
, 
size
);}

131 
size_t
 
Put2
(cÚ¡ 
by‹
 *
begš
, size_ˆ
Ëngth
, 
mes§geEnd
, 
boŞ
 
blockšg
)

132 { 
	gthis
->
ChªÃlPut2
(
DEFAULT_CHANNEL
, 
begš
, 
Ëngth
, 
mes§geEnd
, 
blockšg
);}

133 
size_t
 
PutModifŸbË2
(
by‹
 *
šSŒšg
, size_ˆ
Ëngth
, 
mes§geEnd
, 
boŞ
 
blockšg
)

134 { 
	gthis
->
ChªÃlPutModifŸbË2
(
DEFAULT_CHANNEL
, 
šSŒšg
, 
Ëngth
, 
mes§geEnd
, 
blockšg
);}

138 
by‹
 * 
ChªÃlC»©ePutS·û
(cÚ¡ 
¡d
::
¡ršg
 &
chªÃl
, 
size_t
 &
size
)

139 {
	gsize
 = 0;  
	gNULL
;}

140 
boŞ
 
ChªÃlPutModifŸbË
(cÚ¡ 
¡d
::
¡ršg
 &
chªÃl
, 
by‹
 *
šSŒšg
, 
size_t
 
Ëngth
)

141 {
	gthis
->
ChªÃlPut
(
chªÃl
, 
šSŒšg
, 
Ëngth
);  
	gçl£
;}

143 
vœtu®
 
size_t
 
ChªÃlPut2
(cÚ¡ 
¡d
::
¡ršg
 &
chªÃl
, cÚ¡ 
by‹
 *
begš
, size_ˆ
Ëngth
, 
mes§geEnd
, 
boŞ
 
blockšg
) =0;

144 
size_t
 
ChªÃlPutModifŸbË2
(cÚ¡ 
¡d
::
¡ršg
 &
chªÃl
, 
by‹
 *
begš
, size_ˆ
Ëngth
, 
mes§geEnd
, 
boŞ
 
blockšg
)

145 { 
ChªÃlPut2
(
chªÃl
, 
begš
, 
Ëngth
, 
mes§geEnd
, 
blockšg
);}

147 
vœtu®
 
boŞ
 
ChªÃlFlush
(cÚ¡ 
¡d
::
¡ršg
 &
chªÃl
, boŞ 
h¬dFlush
, 
´İag©iÚ
=-1, boŞ 
blockšg
=
Œue
) =0;

151 
	g‹m¶©e
 <
şass
 
	gT
>

152 şas 
	cCRYPTOPP_NO_VTABLE
 
	mAutoSigÇlšg
 : 
public
 
T


154 
public
:

155 
AutoSigÇlšg
(
´İag©iÚ
=-1è: 
	$m_autoSigÇlPrİag©iÚ
(
´İag©iÚ
) {}

157 
	$S‘AutoSigÇlPrİag©iÚ
(
´İag©iÚ
)

158 {
m_autoSigÇlPrİag©iÚ
 = 
´İag©iÚ
;
	}
}

159 
	$G‘AutoSigÇlPrİag©iÚ
() const

160 { 
m_autoSigÇlPrİag©iÚ
;
	}
}

162 
	g´iv©e
:

163 
m_autoSigÇlPrİag©iÚ
;

167 
şass
 
CRYPTOPP_DLL
 
CRYPTOPP_NO_VTABLE
 
	gStÜe
 : 
public
 
AutoSigÇlšg
<
IÅutRejeùšg
<
Bufã»dT¿nsfÜm©iÚ
> >

169 
public
:

170 
StÜe
(è: 
m_mes§geEnd
(
çl£
) {}

172 
IsŞ©edIn™Ÿlize
(cÚ¡ 
NameV®uePaœs
 &
·¿m‘”s
)

174 
m_mes§geEnd
 = 
çl£
;

175 
StÜeIn™Ÿlize
(
·¿m‘”s
);

178 
Numb”OfMes§ges
(ècÚ¡ { 
	gm_mes§geEnd
 ? 0 : 1;}

179 
boŞ
 
G‘NextMes§ge
();

180 
CİyMes§gesTo
(
Bufã»dT¿nsfÜm©iÚ
 &
rg‘
, 
couÁ
=
UINT_MAX
, cÚ¡ 
¡d
::
¡ršg
 &
chªÃl
=
DEFAULT_CHANNEL
) const;

182 
	g´Ùeùed
:

183 
vœtu®
 
StÜeIn™Ÿlize
(cÚ¡ 
NameV®uePaœs
 &
·¿m‘”s
) =0;

185 
boŞ
 
	gm_mes§geEnd
;

189 şas 
	cCRYPTOPP_DLL
 
CRYPTOPP_NO_VTABLE
 
	mSšk
 : 
public
 
Bufã»dT¿nsfÜm©iÚ


191 
public
:

192 
size_t
 
	$T¿nsãrTo2
(
Bufã»dT¿nsfÜm©iÚ
 &
rg‘
, 
lwÜd
 &
ŒªsãrBy‹s
, cÚ¡ 
¡d
::
¡ršg
 &
chªÃl
=
DEFAULT_CHANNEL
, 
boŞ
 
blockšg
=
Œue
)

193 {
ŒªsãrBy‹s
 = 0;  0;}

194 
size_t
 
	$CİyRªgeTo2
(
Bufã»dT¿nsfÜm©iÚ
 &
rg‘
, 
lwÜd
 &
begš
,†wÜd 
’d
=
LWORD_MAX
, cÚ¡ 
¡d
::
¡ršg
 &
chªÃl
=
DEFAULT_CHANNEL
, 
boŞ
 
blockšg
=
Œue
) const

195 { 0;
	}
}

198 
şass
 
CRYPTOPP_DLL
 
	gB™Buck‘
 : 
public
 
Bufã¾ess
<
Sšk
>

200 
public
:

201 
¡d
::
¡ršg
 
AlgÜ™hmName
() const { "BitBucket";}

202 
IsŞ©edIn™Ÿlize
(cÚ¡ 
NameV®uePaœs
 &
·¿m‘”s
) {}

203 
size_t
 
Put2
(cÚ¡ 
by‹
 *
begš
, size_ˆ
Ëngth
, 
mes§geEnd
, 
boŞ
 
blockšg
)

207 
	gNAMESPACE_END


	@skipjack.cpp

4 
	~"pch.h
"

6 #iâdeà
CRYPTOPP_IMPORTS


8 
	~"skjack.h
"

18 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

23 cÚ¡ 
by‹
 
SKIPJACK
::
Ba£
::
fTabË
[256] = {

40 
	}
};

47 
	#g
(
b
, 
w
, 
i
, 
j
, 
k
, 
l
) \

49 
w
 ^ğ(
wÜd
)
b
[
i
*256 + (w & 0xff)] << 8; \

50 
w
 ^ğ(
wÜd
)
b
[
j
*256 + (w >> 8)]; \

51 
w
 ^ğ(
wÜd
)
b
[
k
*256 + (w & 0xff)] << 8; \

52 
w
 ^ğ(
wÜd
)
b
[
l
*256 + (w >> 8)]; \

53 }

	)

55 
	#g0
(
b
, 
w
è
	`g
Ñab, w, 0, 1, 2, 3)

	)

56 
	#g1
(
b
, 
w
è
	`g
Ñab, w, 4, 5, 6, 7)

	)

57 
	#g2
(
b
, 
w
è
	`g
Ñab, w, 8, 9, 0, 1)

	)

58 
	#g3
(
b
, 
w
è
	`g
Ñab, w, 2, 3, 4, 5)

	)

59 
	#g4
(
b
, 
w
è
	`g
Ñab, w, 6, 7, 8, 9)

	)

64 
	#h
(
b
, 
w
, 
i
, 
j
, 
k
, 
l
) \

66 
w
 ^ğ(
wÜd
)
b
[
l
*256 + (w >> 8)]; \

67 
w
 ^ğ(
wÜd
)
b
[
k
*256 + (w & 0xff)] << 8; \

68 
w
 ^ğ(
wÜd
)
b
[
j
*256 + (w >> 8)]; \

69 
w
 ^ğ(
wÜd
)
b
[
i
*256 + (w & 0xff)] << 8; \

70 }

	)

72 
	#h0
(
b
, 
w
è
	`h
Ñab, w, 0, 1, 2, 3)

	)

73 
	#h1
(
b
, 
w
è
	`h
Ñab, w, 4, 5, 6, 7)

	)

74 
	#h2
(
b
, 
w
è
	`h
Ñab, w, 8, 9, 0, 1)

	)

75 
	#h3
(
b
, 
w
è
	`h
Ñab, w, 2, 3, 4, 5)

	)

76 
	#h4
(
b
, 
w
è
	`h
Ñab, w, 6, 7, 8, 9)

	)

81 
	gSKIPJACK
::
Ba£
::
	$UncheckedS‘Key
(cÚ¡ 
by‹
 *
key
, 
Ëngth
, cÚ¡ 
NameV®uePaœs
 &)

83 
	`As£¹V®idKeyL’gth
(
Ëngth
);

86 
i
;

87 
i
 = 0; i < 10; i++) {

88 
by‹
 *
t
 = 
b
+
i
*256, 
k
 = 
key
[9-i];

89 
c
;

90 
c
 = 0; c < 256; c++) {

91 
t
[
c
] = 
fTabË
[ø^ 
k
];

94 
	}
}

96 
	gBlockG‘AndPut
<
	twÜd16
, 
	tL™eEndŸn
> 
	tBlock
;

101 
	gSKIPJACK
::
Enc
::
	$ProûssAndXÜBlock
(cÚ¡ 
by‹
 *
šBlock
, cÚ¡ by‹ *
xÜBlock
, by‹ *
outBlock
) const

103 
wÜd16
 
w1
, 
w2
, 
w3
, 
w4
;

104 
Block
::
	`G‘
(
šBlock
)(
w4
)(
w3
)(
w2
)(
w1
);

107 
	`g0
(
b
, 
w1
); 
w4
 ^= w1 ^ 1;

108 
	`g1
(
b
, 
w4
); 
w3
 ^= w4 ^ 2;

109 
	`g2
(
b
, 
w3
); 
w2
 ^= w3 ^ 3;

110 
	`g3
(
b
, 
w2
); 
w1
 ^= w2 ^ 4;

111 
	`g4
(
b
, 
w1
); 
w4
 ^= w1 ^ 5;

112 
	`g0
(
b
, 
w4
); 
w3
 ^= w4 ^ 6;

113 
	`g1
(
b
, 
w3
); 
w2
 ^= w3 ^ 7;

114 
	`g2
(
b
, 
w2
); 
w1
 ^= w2 ^ 8;

117 
w2
 ^ğ
w1
 ^ 9; 
	`g3
(
b
, w1);

118 
w1
 ^ğ
w4
 ^ 10; 
	`g4
(
b
, w4);

119 
w4
 ^ğ
w3
 ^ 11; 
	`g0
(
b
, w3);

120 
w3
 ^ğ
w2
 ^ 12; 
	`g1
(
b
, w2);

121 
w2
 ^ğ
w1
 ^ 13; 
	`g2
(
b
, w1);

122 
w1
 ^ğ
w4
 ^ 14; 
	`g3
(
b
, w4);

123 
w4
 ^ğ
w3
 ^ 15; 
	`g4
(
b
, w3);

124 
w3
 ^ğ
w2
 ^ 16; 
	`g0
(
b
, w2);

127 
	`g1
(
b
, 
w1
); 
w4
 ^= w1 ^ 17;

128 
	`g2
(
b
, 
w4
); 
w3
 ^= w4 ^ 18;

129 
	`g3
(
b
, 
w3
); 
w2
 ^= w3 ^ 19;

130 
	`g4
(
b
, 
w2
); 
w1
 ^= w2 ^ 20;

131 
	`g0
(
b
, 
w1
); 
w4
 ^= w1 ^ 21;

132 
	`g1
(
b
, 
w4
); 
w3
 ^= w4 ^ 22;

133 
	`g2
(
b
, 
w3
); 
w2
 ^= w3 ^ 23;

134 
	`g3
(
b
, 
w2
); 
w1
 ^= w2 ^ 24;

137 
w2
 ^ğ
w1
 ^ 25; 
	`g4
(
b
, w1);

138 
w1
 ^ğ
w4
 ^ 26; 
	`g0
(
b
, w4);

139 
w4
 ^ğ
w3
 ^ 27; 
	`g1
(
b
, w3);

140 
w3
 ^ğ
w2
 ^ 28; 
	`g2
(
b
, w2);

141 
w2
 ^ğ
w1
 ^ 29; 
	`g3
(
b
, w1);

142 
w1
 ^ğ
w4
 ^ 30; 
	`g4
(
b
, w4);

143 
w4
 ^ğ
w3
 ^ 31; 
	`g0
(
b
, w3);

144 
w3
 ^ğ
w2
 ^ 32; 
	`g1
(
b
, w2);

146 
Block
::
	`Put
(
xÜBlock
, 
outBlock
)(
w4
)(
w3
)(
w2
)(
w1
);

147 
	}
}

152 
	gSKIPJACK
::
Dec
::
	$ProûssAndXÜBlock
(cÚ¡ 
by‹
 *
šBlock
, cÚ¡ by‹ *
xÜBlock
, by‹ *
outBlock
) const

154 
wÜd16
 
w1
, 
w2
, 
w3
, 
w4
;

155 
Block
::
	`G‘
(
šBlock
)(
w4
)(
w3
)(
w2
)(
w1
);

158 
	`h1
(
b
, 
w2
); 
w3
 ^= w2 ^ 32;

159 
	`h0
(
b
, 
w3
); 
w4
 ^= w3 ^ 31;

160 
	`h4
(
b
, 
w4
); 
w1
 ^= w4 ^ 30;

161 
	`h3
(
b
, 
w1
); 
w2
 ^= w1 ^ 29;

162 
	`h2
(
b
, 
w2
); 
w3
 ^= w2 ^ 28;

163 
	`h1
(
b
, 
w3
); 
w4
 ^= w3 ^ 27;

164 
	`h0
(
b
, 
w4
); 
w1
 ^= w4 ^ 26;

165 
	`h4
(
b
, 
w1
); 
w2
 ^= w1 ^ 25;

168 
w1
 ^ğ
w2
 ^ 24; 
	`h3
(
b
, w2);

169 
w2
 ^ğ
w3
 ^ 23; 
	`h2
(
b
, w3);

170 
w3
 ^ğ
w4
 ^ 22; 
	`h1
(
b
, w4);

171 
w4
 ^ğ
w1
 ^ 21; 
	`h0
(
b
, w1);

172 
w1
 ^ğ
w2
 ^ 20; 
	`h4
(
b
, w2);

173 
w2
 ^ğ
w3
 ^ 19; 
	`h3
(
b
, w3);

174 
w3
 ^ğ
w4
 ^ 18; 
	`h2
(
b
, w4);

175 
w4
 ^ğ
w1
 ^ 17; 
	`h1
(
b
, w1);

178 
	`h0
(
b
, 
w2
); 
w3
 ^= w2 ^ 16;

179 
	`h4
(
b
, 
w3
); 
w4
 ^= w3 ^ 15;

180 
	`h3
(
b
, 
w4
); 
w1
 ^= w4 ^ 14;

181 
	`h2
(
b
, 
w1
); 
w2
 ^= w1 ^ 13;

182 
	`h1
(
b
, 
w2
); 
w3
 ^= w2 ^ 12;

183 
	`h0
(
b
, 
w3
); 
w4
 ^= w3 ^ 11;

184 
	`h4
(
b
, 
w4
); 
w1
 ^= w4 ^ 10;

185 
	`h3
(
b
, 
w1
); 
w2
 ^= w1 ^ 9;

188 
w1
 ^ğ
w2
 ^ 8; 
	`h2
(
b
, w2);

189 
w2
 ^ğ
w3
 ^ 7; 
	`h1
(
b
, w3);

190 
w3
 ^ğ
w4
 ^ 6; 
	`h0
(
b
, w4);

191 
w4
 ^ğ
w1
 ^ 5; 
	`h4
(
b
, w1);

192 
w1
 ^ğ
w2
 ^ 4; 
	`h3
(
b
, w2);

193 
w2
 ^ğ
w3
 ^ 3; 
	`h2
(
b
, w3);

194 
w3
 ^ğ
w4
 ^ 2; 
	`h1
(
b
, w4);

195 
w4
 ^ğ
w1
 ^ 1; 
	`h0
(
b
, w1);

197 
Block
::
	`Put
(
xÜBlock
, 
outBlock
)(
w4
)(
w3
)(
w2
)(
w1
);

198 
	}
}

200 
	gNAMESPACE_END


	@skipjack.h

1 #iâdeà
CRYPTOPP_SKIPJACK_H


2 
	#CRYPTOPP_SKIPJACK_H


	)

7 
	~"£ckey.h
"

8 
	~"£cblock.h
"

10 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

13 
SKIPJACK_Info
 : 
public
 
FixedBlockSize
<8>,…ubliø
FixedKeyL’gth
<10>

15 
CRYPTOPP_DLL
 cÚ¡ * 
CRYPTOPP_API
 
	`SticAlgÜ™hmName
() { "SKIPJACK";}

16 
	}
};

19 
şass
 
	gSKIPJACK
 : 
public
 
SKIPJACK_Info
,…ubliø
	gBlockCh”Docum’tiÚ


21 
şass
 
CRYPTOPP_DLL
 
CRYPTOPP_NO_VTABLE
 
	gBa£
 : 
public
 
BlockCh”Im¶
<
SKIPJACK_Info
>

23 
public
:

24 
UncheckedS‘Key
(cÚ¡ 
by‹
 *
u£rKey
, 
Ëngth
, cÚ¡ 
NameV®uePaœs
 &
·¿ms
);

25 
O±im®D©aAlignm’t
(ècÚ¡ { 
	gG‘Alignm’tOf
<
	gwÜd16
>();}

27 
	g´Ùeùed
:

28 cÚ¡ 
by‹
 
fTabË
[256];

30 
	gFixedSizeSecBlock
<
	gby‹
, 10*256> 
	gb
;

33 şas 
	cCRYPTOPP_DLL
 
CRYPTOPP_NO_VTABLE
 
	gEnc
 : 
public
 
Ba£


35 
public
:

36 
ProûssAndXÜBlock
(cÚ¡ 
by‹
 *
šBlock
, cÚ¡ by‹ *
xÜBlock
, by‹ *
outBlock
) const;

37 
	g´iv©e
:

38 cÚ¡ 
by‹
 
Se
[256];

39 cÚ¡ 
wÜd32
 
	gTe
[4][256];

42 şas 
	cCRYPTOPP_DLL
 
CRYPTOPP_NO_VTABLE
 
	gDec
 : 
public
 
Ba£


44 
public
:

45 
ProûssAndXÜBlock
(cÚ¡ 
by‹
 *
šBlock
, cÚ¡ by‹ *
xÜBlock
, by‹ *
outBlock
) const;

46 
	g´iv©e
:

47 cÚ¡ 
by‹
 
Sd
[256];

48 cÚ¡ 
wÜd32
 
	gTd
[4][256];

51 
	gpublic
:

52 
BlockCh”Fš®
<
	tENCRYPTION
, 
	tEnc
> 
	tEnüy±iÚ
;

53 
	gBlockCh”Fš®
<
	tDECRYPTION
, 
	tDec
> 
	tDeüy±iÚ
;

56 
	gSKIPJACK
::
	tEnüy±iÚ
 
	tSKIPJACKEnüy±iÚ
;

57 
	gSKIPJACK
::
	tDeüy±iÚ
 
	tSKIPJACKDeüy±iÚ
;

59 
	gNAMESPACE_END


	@smartptr.h

1 #iâdeà
CRYPTOPP_SMARTPTR_H


2 
	#CRYPTOPP_SMARTPTR_H


	)

4 
	~"cÚfig.h
"

5 
	~<®gÜ™hm
>

7 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

9 
‹m¶©e
 <
şass
 
T
> cÏs 
	csim¶e_±r


11 
public
:

12 
	$sim¶e_±r
(
T
 *
p
 = 
NULL
è: 
	$m_p
(
p
) {}

13 ~
	$sim¶e_±r
(è{
d–‘e
 
m_p
; m_°ğ
NULL
;
	}
}

14 
T
 *
	gm_p
;

17 
	g‹m¶©e
 <
şass
 
	gT
> cÏs 
	cmemb”_±r


19 
	mpublic
:

20 
ex¶ic™
 
	$memb”_±r
(
T
 *
p
 = 
NULL
è: 
	$m_p
(
p
) {}

22 ~
	`memb”_±r
();

24 cÚ¡ 
T
& 
İ”©Ü
*(ècÚ¡ {  *
m_p
; 
	}
}

25 
	gT
& 
	gİ”©Ü
*(è{  *
	gm_p
; }

27 cÚ¡ 
T
* 
	gİ”©Ü
->(ècÚ¡ {  
	gm_p
; }

28 
T
* 
	gİ”©Ü
->(è{  
	gm_p
; }

30 cÚ¡ 
T
* 
	$g‘
(ècÚ¡ {  
m_p
; 
	}
}

31 
T
* 
	$g‘
(è{  
m_p
; 
	}
}

33 
T
* 
	$»Ëa£
()

35 
T
 *
Şd_p
 = 
m_p
;

36 
m_p
 = 0;

37  
Şd_p
;

38 
	}
}

40 
»£t
(
T
 *
p
 = 0);

42 
	g´Ùeùed
:

43 
memb”_±r
(cÚ¡ memb”_±r<
T
>& 
rhs
);

44 
	gİ”©Ü
=(cÚ¡ 
memb”_±r
<
T
>& 
rhs
);

46 
T
 *
	gm_p
;

49 
	g‹m¶©e
 <
şass
 
	gT
> 
	gmemb”_±r
<T>::~
	$memb”_±r
(è{
d–‘e
 
m_p
;
	}
}

50 
	g‹m¶©e
 <
şass
 
	gT
> 
	gmemb”_±r
<T>::
	$»£t
(
T
 *
p
è{
d–‘e
 
m_p
; m_°ğp;
	}
}

54 
	g‹m¶©e
<
şass
 
	gT
> cÏs 
	gv®ue_±r
 : 
public
 
memb”_±r
<
T
>

56 
public
:

57 
v®ue_±r
(cÚ¡ 
T
 &
obj
è: 
memb”_±r
<T>(
Ãw
 T(obj)) {}

58 
v®ue_±r
(
T
 *
p
 = 
NULL
è: 
memb”_±r
<T>(p) {}

59 
v®ue_±r
(cÚ¡ v®ue_±r<
T
>& 
rhs
)

60 : 
memb”_±r
<
T
>(
rhs
.
m_p
 ? 
Ãw
 T(*rhs.m_pè: 
NULL
) {}

62 
v®ue_±r
<
T
>& 
İ”©Ü
=(cÚ¡ v®ue_±r<T>& 
rhs
);

63 
boŞ
 
	gİ”©Ü
==(cÚ¡ 
v®ue_±r
<
T
>& 
rhs
)

65  (!
this
->
m_p
 && !
rhs
.m_p) || (this->m_p &&„hs.m_p && *this->m_p == *rhs.m_p);

69 
	g‹m¶©e
 <
şass
 
	gT
> 
	gv®ue_±r
<T>& v®ue_±r<T>::
İ”©Ü
=(cÚ¡ 
v®ue_±r
<
T
>& 
rhs
)

71 
T
 *
Şd_p
 = 
this
->
m_p
;

72 
	gthis
->
	gm_p
 = 
rhs
.
m_p
 ? 
Ãw
 
T
(*rhs.m_pè: 
NULL
;

73 
d–‘e
 
	gŞd_p
;

74  *
	gthis
;

79 
	g‹m¶©e
<
şass
 
	gT
> cÏs 
	gşÚabË_±r
 : 
public
 
memb”_±r
<
T
>

81 
public
:

82 
şÚabË_±r
(cÚ¡ 
T
 &
obj
è: 
memb”_±r
<T>(obj.
ClÚe
()) {}

83 
şÚabË_±r
(
T
 *
p
 = 
NULL
è: 
memb”_±r
<T>(p) {}

84 
şÚabË_±r
(cÚ¡ clÚabË_±r<
T
>& 
rhs
)

85 : 
memb”_±r
<
T
>(
rhs
.
m_p
 ?„hs.m_p->
ClÚe
(è: 
NULL
) {}

87 
şÚabË_±r
<
T
>& 
İ”©Ü
=(cÚ¡ clÚabË_±r<T>& 
rhs
);

90 
	g‹m¶©e
 <
şass
 
	gT
> 
	gşÚabË_±r
<T>& clÚabË_±r<T>::
İ”©Ü
=(cÚ¡ 
şÚabË_±r
<
T
>& 
rhs
)

92 
T
 *
Şd_p
 = 
this
->
m_p
;

93 
	gthis
->
	gm_p
 = 
rhs
.
m_p
 ?„hs.m_p->
ClÚe
(è: 
NULL
;

94 
d–‘e
 
	gŞd_p
;

95  *
	gthis
;

100 
	g‹m¶©e
<
şass
 
	gT
> cÏs 
	ccouÁed_±r


102 
	mpublic
:

103 
ex¶ic™
 
couÁed_±r
(
T
 *
p
 = 0);

104 
	$couÁed_±r
(cÚ¡ 
T
 &
r
è: 
	$m_p
(0è{
	`©ch
(
r
);}

105 
	`couÁed_±r
(cÚ¡ 
couÁed_±r
<
T
>& 
rhs
);

107 ~
	`couÁed_±r
();

109 cÚ¡ 
T
& 
İ”©Ü
*(ècÚ¡ {  *
m_p
; 
	}
}

110 
	gT
& 
	gİ”©Ü
*(è{  *
	gm_p
; }

112 cÚ¡ 
T
* 
	gİ”©Ü
->(ècÚ¡ {  
	gm_p
; }

113 
T
* 
	gİ”©Ü
->(è{  
g‘
(); }

115 cÚ¡ 
T
* 
	$g‘
(ècÚ¡ {  
m_p
; 
	}
}

116 
T
* 
g‘
();

118 
©ch
(cÚ¡ 
T
 &
p
);

120 
	gcouÁed_±r
<
	gT
> & 
	gİ”©Ü
=(cÚ¡ 
couÁed_±r
<
T
>& 
rhs
);

122 
	g´iv©e
:

123 
T
 *
m_p
;

126 
	g‹m¶©e
 <
şass
 
	gT
> 
	gcouÁed_±r
<T>::
	$couÁed_±r
(
T
 *
p
)

127 : 
	$m_p
(
p
)

129 ià(
m_p
)

130 
m_p
->
m_»ã»nûCouÁ
 = 1;

131 
	}
}

133 
	g‹m¶©e
 <
şass
 
	gT
> 
	gcouÁed_±r
<T>::
couÁed_±r
(cÚ¡ couÁed_±r<
T
>& 
rhs
)

134 : 
	$m_p
(
rhs
.
m_p
)

136 ià(
m_p
)

137 
m_p
->
m_»ã»nûCouÁ
++;

138 
	}
}

140 
	g‹m¶©e
 <
şass
 
	gT
> 
	gcouÁed_±r
<T>::~
	$couÁed_±r
()

142 ià(
m_p
 && --m_p->
m_»ã»nûCouÁ
 == 0)

143 
d–‘e
 
m_p
;

144 
	}
}

146 
	g‹m¶©e
 <
şass
 
	gT
> 
	gcouÁed_±r
<T>::
	$©ch
(cÚ¡ 
T
 &
r
)

148 ià(
m_p
 && --m_p->
m_»ã»nûCouÁ
 == 0)

149 
d–‘e
 
m_p
;

150 ià(
r
.
m_»ã»nûCouÁ
 == 0)

152 
m_p
 = 
r
.
	`şÚe
();

153 
m_p
->
m_»ã»nûCouÁ
 = 1;

157 
m_p
 = 
cÚ¡_ÿ¡
<
T
 *>(&
r
);

158 
m_p
->
m_»ã»nûCouÁ
++;

160 
	}
}

162 
	g‹m¶©e
 <
şass
 
	gT
> 
T
* 
	gcouÁed_±r
<T>::
	$g‘
()

164 ià(
m_p
 && m_p->
m_»ã»nûCouÁ
 > 1)

166 
T
 *
‹mp
 = 
m_p
->
	`şÚe
();

167 
m_p
->
m_»ã»nûCouÁ
--;

168 
m_p
 = 
‹mp
;

169 
m_p
->
m_»ã»nûCouÁ
 = 1;

171  
m_p
;

172 
	}
}

174 
	g‹m¶©e
 <
şass
 
	gT
> 
	gcouÁed_±r
<T> & couÁed_±r<T>::
İ”©Ü
=(cÚ¡ 
couÁed_±r
<
T
>& 
rhs
)

176 ià(
m_p
 !ğ
rhs
.m_p)

178 ià(
m_p
 && --m_p->
m_»ã»nûCouÁ
 == 0)

179 
d–‘e
 
m_p
;

180 
	gm_p
 = 
rhs
.
m_p
;

181 ià(
	gm_p
)

182 
	gm_p
->
	gm_»ã»nûCouÁ
++;

184  *
	gthis
;

189 
	g‹m¶©e
 <
şass
 
	gT
> cÏs 
	cveùÜ_memb”_±rs


191 
	mpublic
:

192 
	$veùÜ_memb”_±rs
(
size_t
 
size
=0)

193 : 
	`m_size
(
size
), 
	`m_±r
(
Ãw
 
memb”_±r
<
T
>[size]) {}

194 ~
	$veùÜ_memb”_±rs
()

195 {
d–‘e
 [] 
this
->
m_±r
;
	}
}

197 
	gmemb”_±r
<
	gT
>& 
	gİ”©Ü
[](
size_t
 
	gšdex
)

198 {
as£¹
(
šdex
<
this
->
m_size
);  
	gthis
->
	gm_±r
[index];}

199 cÚ¡ 
	gmemb”_±r
<
	gT
>& 
	gİ”©Ü
[](
size_t
 
	gšdex
) const

200 {
as£¹
(
šdex
<
this
->
m_size
);  
	gthis
->
	gm_±r
[index];}

202 
size_t
 
	$size
(ècÚ¡ { 
this
->
m_size
;
	}
}

203 
	$»size
(
size_t
 
ÃwSize
)

205 
memb”_±r
<
T
> *
ÃwPŒ
 = 
Ãw
 memb”_±r<T>[
ÃwSize
];

206 
size_t
 
i
=0; i<
this
->
m_size
 && i<
ÃwSize
; i++)

207 
ÃwPŒ
[
i
].
	`»£t
(
this
->
m_±r
[i].
	`»Ëa£
());

208 
d–‘e
 [] 
this
->
m_±r
;

209 
this
->
m_size
 = 
ÃwSize
;

210 
this
->
m_±r
 = 
ÃwPŒ
;

211 
	}
}

213 
	g´iv©e
:

214 
veùÜ_memb”_±rs
(cÚ¡ veùÜ_memb”_±rs<
T
> &
c
);

215 
	gİ”©Ü
=(cÚ¡ 
veùÜ_memb”_±rs
<
T
> &
x
);

217 
size_t
 
	gm_size
;

218 
	gmemb”_±r
<
	gT
> *
	gm_±r
;

221 
	gNAMESPACE_END


	@socketft.cpp

3 
	~"pch.h
"

4 
	~"sock‘á.h
"

6 #ifdeà
SOCKETS_AVAILABLE


8 
	~"wa™.h
"

10 #ifdeà
USE_BERKELEY_STYLE_SOCKETS


11 
	~<”ºo.h
>

12 
	~<Ãtdb.h
>

13 
	~<uni¡d.h
>

14 
	~<¬·/š‘.h
>

15 
	~<Ãtš‘/š.h
>

16 
	~<sys/ioùl.h
>

19 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

21 #ifdeà
USE_WINDOWS_STYLE_SOCKETS


22 cÚ¡ 
SOCKET_EINVAL
 = 
WSAEINVAL
;

23 cÚ¡ 
SOCKET_EWOULDBLOCK
 = 
WSAEWOULDBLOCK
;

24 
	tsockËn_t
;

26 cÚ¡ 
SOCKET_EINVAL
 = 
EINVAL
;

27 cÚ¡ 
SOCKET_EWOULDBLOCK
 = 
EWOULDBLOCK
;

30 
Sock‘
::
E¼
::
	$E¼
(
sock‘_t
 
s
, cÚ¡ 
¡d
::
¡ršg
& 
İ”©iÚ
, 
”rÜ
)

31 : 
	`OS_E¼Ü
(
IO_ERROR
, "Sock‘: " + 
İ”©iÚ
 + " o³¿tiÚ faed w™hƒ¼Ü " + 
	`IÁToSŒšg
(
”rÜ
), operation,ƒrror)

32 , 
	$m_s
(
s
)

34 
	}
}

36 
	gSock‘
::~
	$Sock‘
()

38 ià(
m_own
)

40 
Œy


42 
	`Clo£Sock‘
();

44 
	`ÿtch
 (...)

48 
	}
}

50 
	gSock‘
::
	$A‰achSock‘
(
sock‘_t
 
s
, 
boŞ
 
own
)

52 ià(
m_own
)

53 
	`Clo£Sock‘
();

55 
m_s
 = 
s
;

56 
m_own
 = 
own
;

57 
	`Sock‘Chªged
();

58 
	}
}

60 
sock‘_t
 
	gSock‘
::
	$D‘achSock‘
()

62 
sock‘_t
 
s
 = 
m_s
;

63 
m_s
 = 
INVALID_SOCKET
;

64 
	`Sock‘Chªged
();

65  
s
;

66 
	}
}

68 
	gSock‘
::
	$C»©e
(
nTy³
)

70 
	`as£¹
(
m_s
 =ğ
INVALID_SOCKET
);

71 
m_s
 = 
	`sock‘
(
AF_INET
, 
nTy³
, 0);

72 
	`CheckAndHªdËE¼Ü
("sock‘", 
m_s
);

73 
m_own
 = 
Œue
;

74 
	`Sock‘Chªged
();

75 
	}
}

77 
	gSock‘
::
	$Clo£Sock‘
()

79 ià(
m_s
 !ğ
INVALID_SOCKET
)

81 #ifdeà
USE_WINDOWS_STYLE_SOCKETS


82 
	`CªûlIo
((
HANDLE
è
m_s
);

83 
	`CheckAndHªdËE¼Ü_št
("şo£sock‘", 
	`şo£sock‘
(
m_s
));

85 
	`CheckAndHªdËE¼Ü_št
("şo£", 
	`şo£
(
m_s
));

87 
m_s
 = 
INVALID_SOCKET
;

88 
	`Sock‘Chªged
();

90 
	}
}

92 
	gSock‘
::
	$Bšd
(
pÜt
, cÚ¡ *
addr
)

94 
sockaddr_š
 
§
;

95 
	`mem£t
(&
§
, 0, (sa));

96 
§
.
sš_çmy
 = 
AF_INET
;

98 ià(
addr
 =ğ
NULL
)

99 
§
.
sš_addr
.
s_addr
 = 
	`htÚl
(
INADDR_ANY
);

102 
»suÉ
 = 
	`š‘_addr
(
addr
);

103 ià(
»suÉ
 == -1)

105 
	`S‘La¡E¼Ü
(
SOCKET_EINVAL
);

106 
	`CheckAndHªdËE¼Ü_št
("š‘_addr", 
SOCKET_ERROR
);

108 
§
.
sš_addr
.
s_addr
 = 
»suÉ
;

111 
§
.
sš_pÜt
 = 
	`htÚs
((
u_shÜt
)
pÜt
);

113 
	`Bšd
((
sockaddr
 *)&
§
, (sa));

114 
	}
}

116 
	gSock‘
::
	$Bšd
(cÚ¡ 
sockaddr
 *
p§
, 
sockËn_t
 
§L’
)

118 
	`as£¹
(
m_s
 !ğ
INVALID_SOCKET
);

120 
	`CheckAndHªdËE¼Ü_št
("bšd", 
	`bšd
(
m_s
, 
cÚ¡_ÿ¡
<
sockaddr
 *>(
p§
), 
§L’
));

121 
	}
}

123 
	gSock‘
::
	$Li¡’
(
backlog
)

125 
	`as£¹
(
m_s
 !ğ
INVALID_SOCKET
);

126 
	`CheckAndHªdËE¼Ü_št
("li¡’", 
	`li¡’
(
m_s
, 
backlog
));

127 
	}
}

129 
boŞ
 
	gSock‘
::
	$CÚÃù
(cÚ¡ *
addr
, 
pÜt
)

131 
	`as£¹
(
addr
 !ğ
NULL
);

133 
sockaddr_š
 
§
;

134 
	`mem£t
(&
§
, 0, (sa));

135 
§
.
sš_çmy
 = 
AF_INET
;

136 
§
.
sš_addr
.
s_addr
 = 
	`š‘_addr
(
addr
);

138 ià(
§
.
sš_addr
.
s_addr
 == -1)

140 
ho¡’t
 *
Ího¡
 = 
	`g‘ho¡byÇme
(
addr
);

141 ià(
Ího¡
 =ğ
NULL
)

143 
	`S‘La¡E¼Ü
(
SOCKET_EINVAL
);

144 
	`CheckAndHªdËE¼Ü_št
("g‘ho¡byÇme", 
SOCKET_ERROR
);

147 
§
.
sš_addr
.
s_addr
 = ((
š_addr
 *)
Ího¡
->
h_addr
)->s_addr;

150 
§
.
sš_pÜt
 = 
	`htÚs
((
u_shÜt
)
pÜt
);

152  
	`CÚÃù
((cÚ¡ 
sockaddr
 *)&
§
, (sa));

153 
	}
}

155 
boŞ
 
	gSock‘
::
	$CÚÃù
(cÚ¡ 
sockaddr
* 
p§
, 
sockËn_t
 
§L’
)

157 
	`as£¹
(
m_s
 !ğ
INVALID_SOCKET
);

158 
»suÉ
 = 
	`cÚÃù
(
m_s
, 
cÚ¡_ÿ¡
<
sockaddr
*>(
p§
), 
§L’
);

159 ià(
»suÉ
 =ğ
SOCKET_ERROR
 && 
	`G‘La¡E¼Ü
(è=ğ
SOCKET_EWOULDBLOCK
)

160  
çl£
;

161 
	`CheckAndHªdËE¼Ü_št
("cÚÃù", 
»suÉ
);

162  
Œue
;

163 
	}
}

165 
boŞ
 
	gSock‘
::
	$Acû±
(
Sock‘
& 
rg‘
, 
sockaddr
 *
p§
, 
sockËn_t
 *
p§L’
)

167 
	`as£¹
(
m_s
 !ğ
INVALID_SOCKET
);

168 
sock‘_t
 
s
 = 
	`acû±
(
m_s
, 
p§
, 
p§L’
);

169 ià(
s
 =ğ
INVALID_SOCKET
 && 
	`G‘La¡E¼Ü
(è=ğ
SOCKET_EWOULDBLOCK
)

170  
çl£
;

171 
	`CheckAndHªdËE¼Ü
("acû±", 
s
);

172 
rg‘
.
	`A‰achSock‘
(
s
, 
Œue
);

173  
Œue
;

174 
	}
}

176 
	gSock‘
::
	$G‘SockName
(
sockaddr
 *
p§
, 
sockËn_t
 *
p§L’
)

178 
	`as£¹
(
m_s
 !ğ
INVALID_SOCKET
);

179 
	`CheckAndHªdËE¼Ü_št
("g‘sockÇme", 
	`g‘sockÇme
(
m_s
, 
p§
, 
p§L’
));

180 
	}
}

182 
	gSock‘
::
	$G‘P“rName
(
sockaddr
 *
p§
, 
sockËn_t
 *
p§L’
)

184 
	`as£¹
(
m_s
 !ğ
INVALID_SOCKET
);

185 
	`CheckAndHªdËE¼Ü_št
("g‘³”Çme", 
	`g‘³”Çme
(
m_s
, 
p§
, 
p§L’
));

186 
	}
}

188 
	gSock‘
::
	$S’d
(cÚ¡ 
by‹
* 
buf
, 
size_t
 
bufL’
, 
æags
)

190 
	`as£¹
(
m_s
 !ğ
INVALID_SOCKET
);

191 
»suÉ
 = 
	`£nd
(
m_s
, (cÚ¡ *)
buf
, 
	`UnsigÃdMš
(
INT_MAX
, 
bufL’
), 
æags
);

192 
	`CheckAndHªdËE¼Ü_št
("£nd", 
»suÉ
);

193  
»suÉ
;

194 
	}
}

196 
	gSock‘
::
	$Reûive
(
by‹
* 
buf
, 
size_t
 
bufL’
, 
æags
)

198 
	`as£¹
(
m_s
 !ğ
INVALID_SOCKET
);

199 
»suÉ
 = 
	`»cv
(
m_s
, (*)
buf
, 
	`UnsigÃdMš
(
INT_MAX
, 
bufL’
), 
æags
);

200 
	`CheckAndHªdËE¼Ü_št
("»cv", 
»suÉ
);

201  
»suÉ
;

202 
	}
}

204 
	gSock‘
::
	$ShutDown
(
how
)

206 
	`as£¹
(
m_s
 !ğ
INVALID_SOCKET
);

207 
»suÉ
 = 
	`shutdown
(
m_s
, 
how
);

208 
	`CheckAndHªdËE¼Ü_št
("shutdown", 
»suÉ
);

209 
	}
}

211 
	gSock‘
::
	$IOC
(
cmd
, *
¬gp
)

213 
	`as£¹
(
m_s
 !ğ
INVALID_SOCKET
);

214 #ifdeà
USE_WINDOWS_STYLE_SOCKETS


215 
	`CheckAndHªdËE¼Ü_št
("ioùlsock‘", 
	`ioùlsock‘
(
m_s
, 
cmd
, 
¬gp
));

217 
	`CheckAndHªdËE¼Ü_št
("ioùl", 
	`ioùl
(
m_s
, 
cmd
, 
¬gp
));

219 
	}
}

221 
boŞ
 
	gSock‘
::
	$S’dR—dy
(cÚ¡ 
timev®
 *
timeout
)

223 
fd_£t
 
fds
;

224 
	`FD_ZERO
(&
fds
);

225 
	`FD_SET
(
m_s
, &
fds
);

226 
»ady
;

227 ià(
timeout
 =ğ
NULL
)

228 
»ady
 = 
	`£Ëù
(()
m_s
+1, 
NULL
, &
fds
, NULL, NULL);

231 
timev®
 
timeoutCİy
 = *
timeout
;

232 
»ady
 = 
	`£Ëù
(()
m_s
+1, 
NULL
, &
fds
, NULL, &
timeoutCİy
);

234 
	`CheckAndHªdËE¼Ü_št
("£Ëù", 
»ady
);

235  
»ady
 > 0;

236 
	}
}

238 
boŞ
 
	gSock‘
::
	$ReûiveR—dy
(cÚ¡ 
timev®
 *
timeout
)

240 
fd_£t
 
fds
;

241 
	`FD_ZERO
(&
fds
);

242 
	`FD_SET
(
m_s
, &
fds
);

243 
»ady
;

244 ià(
timeout
 =ğ
NULL
)

245 
»ady
 = 
	`£Ëù
(()
m_s
+1, &
fds
, 
NULL
, NULL, NULL);

248 
timev®
 
timeoutCİy
 = *
timeout
;

249 
»ady
 = 
	`£Ëù
(()
m_s
+1, &
fds
, 
NULL
, NULL, &
timeoutCİy
);

251 
	`CheckAndHªdËE¼Ü_št
("£Ëù", 
»ady
);

252  
»ady
 > 0;

253 
	}
}

255 
	gSock‘
::
	$PÜtNameToNumb”
(cÚ¡ *
Çme
, cÚ¡ *
´ÙocŞ
)

257 
pÜt
 = 
	`©oi
(
Çme
);

258 ià(
	`IÁToSŒšg
(
pÜt
è=ğ
Çme
)

259  
pÜt
;

261 
£rv’t
 *
£
 = 
	`g‘£rvbyÇme
(
Çme
, 
´ÙocŞ
);

262 ià(!
£
)

263 
throw
 
	`E¼
(
INVALID_SOCKET
, "g‘£rvbyÇme", 
SOCKET_EINVAL
);

264  
	`Áohs
(
£
->
s_pÜt
);

265 
	}
}

267 
	gSock‘
::
	$S¹Sock‘s
()

269 #ifdeà
USE_WINDOWS_STYLE_SOCKETS


270 
WSADATA
 
wsd
;

271 
»suÉ
 = 
	`WSAS¹up
(0x0202, &
wsd
);

272 ià(
»suÉ
 != 0)

273 
throw
 
	`E¼
(
INVALID_SOCKET
, "WSAS¹up", 
»suÉ
);

275 
	}
}

277 
	gSock‘
::
	$ShutdownSock‘s
()

279 #ifdeà
USE_WINDOWS_STYLE_SOCKETS


280 
»suÉ
 = 
	`WSACËªup
();

281 ià(
»suÉ
 != 0)

282 
throw
 
	`E¼
(
INVALID_SOCKET
, "WSACËªup", 
»suÉ
);

284 
	}
}

286 
	gSock‘
::
	$G‘La¡E¼Ü
()

288 #ifdeà
USE_WINDOWS_STYLE_SOCKETS


289  
	`WSAG‘La¡E¼Ü
();

291  
”ºo
;

293 
	}
}

295 
	gSock‘
::
	$S‘La¡E¼Ü
(
”rÜCode
)

297 #ifdeà
USE_WINDOWS_STYLE_SOCKETS


298 
	`WSAS‘La¡E¼Ü
(
”rÜCode
);

300 
”ºo
 = 
”rÜCode
;

302 
	}
}

304 
	gSock‘
::
	$HªdËE¼Ü
(cÚ¡ *
İ”©iÚ
) const

306 
”r
 = 
	`G‘La¡E¼Ü
();

307 
throw
 
	`E¼
(
m_s
, 
İ”©iÚ
, 
”r
);

308 
	}
}

310 #ifdeà
USE_WINDOWS_STYLE_SOCKETS


312 
	gSock‘Reûiv”
::
	$Sock‘Reûiv”
(
Sock‘
 &
s
)

313 : 
	`m_s
(
s
), 
	`m_»suÉP’dšg
(
çl£
), 
	$m_eofReûived
(
çl£
)

315 
m_ev’t
.
	`A‰achHªdË
(
	`C»©eEv’t
(
NULL
, 
Œue
, 
çl£
, NULL),rue);

316 
m_s
.
	`CheckAndHªdËE¼Ü
("C»©eEv’t", 
m_ev’t
.
	`HªdËV®id
());

317 
	`mem£t
(&
m_ov”Ïµed
, 0, (m_overlapped));

318 
m_ov”Ïµed
.
hEv’t
 = 
m_ev’t
;

319 
	}
}

321 
	gSock‘Reûiv”
::~
	$Sock‘Reûiv”
()

323 #ifdeà
USE_WINDOWS_STYLE_SOCKETS


324 
	`CªûlIo
((
HANDLE
è
m_s
.
	`G‘Sock‘
());

326 
	}
}

328 
boŞ
 
	gSock‘Reûiv”
::
	$Reûive
(
by‹
* 
buf
, 
size_t
 
bufL’
)

330 
	`as£¹
(!
m_»suÉP’dšg
 && !
m_eofReûived
);

332 
DWORD
 
æags
 = 0;

334 
WSABUF
 
w§buf
 = {
	`UnsigÃdMš
((
u_lÚg
)128*1024, 
bufL’
), (*)
buf
};

335 ià(
	`WSARecv
(
m_s
, &
w§buf
, 1, &
m_Ï¡ResuÉ
, &
æags
, &
m_ov”Ïµed
, 
NULL
) == 0)

337 ià(
m_Ï¡ResuÉ
 == 0)

338 
m_eofReûived
 = 
Œue
;

342 
	`WSAG‘La¡E¼Ü
())

345 
m_s
.
	`CheckAndHªdËE¼Ü_št
("WSARecv", 
SOCKET_ERROR
);

346 
WSAEDISCON
:

347 
m_Ï¡ResuÉ
 = 0;

348 
m_eofReûived
 = 
Œue
;

350 
WSA_IO_PENDING
:

351 
m_»suÉP’dšg
 = 
Œue
;

354  !
m_»suÉP’dšg
;

355 
	}
}

357 
	gSock‘Reûiv”
::
	$G‘Wa™Objeùs
(
Wa™ObjeùCÚš”
 &
cÚš”
, 
C®lSck
 cÚ¡& 
ÿÎSck
)

359 ià(
m_»suÉP’dšg
)

360 
cÚš”
.
	`AddHªdË
(
m_ev’t
, 
	`C®lSck
("Sock‘Reûiv”::G‘Wa™Objeùs(è-„esuÉ…’dšg", &
ÿÎSck
));

361 ià(!
m_eofReûived
)

362 
cÚš”
.
	`S‘NoWa™
(
	`C®lSck
("Sock‘Reûiv”::G‘Wa™Objeùs(è-„esuÉ„—dy", &
ÿÎSck
));

363 
	}
}

365 
	gSock‘Reûiv”
::
	$G‘ReûiveResuÉ
()

367 ià(
m_»suÉP’dšg
)

369 
DWORD
 
æags
 = 0;

370 ià(
	`WSAG‘Ov”ÏµedResuÉ
(
m_s
, &
m_ov”Ïµed
, &
m_Ï¡ResuÉ
, 
çl£
, &
æags
))

372 ià(
m_Ï¡ResuÉ
 == 0)

373 
m_eofReûived
 = 
Œue
;

377 
	`WSAG‘La¡E¼Ü
())

380 
m_s
.
	`CheckAndHªdËE¼Ü
("WSAG‘Ov”ÏµedResuÉ", 
FALSE
);

381 
WSAEDISCON
:

382 
m_Ï¡ResuÉ
 = 0;

383 
m_eofReûived
 = 
Œue
;

386 
m_»suÉP’dšg
 = 
çl£
;

388  
m_Ï¡ResuÉ
;

389 
	}
}

393 
	gSock‘S’d”
::
	$Sock‘S’d”
(
Sock‘
 &
s
)

394 : 
	`m_s
(
s
), 
	`m_»suÉP’dšg
(
çl£
), 
	$m_Ï¡ResuÉ
(0)

396 
m_ev’t
.
	`A‰achHªdË
(
	`C»©eEv’t
(
NULL
, 
Œue
, 
çl£
, NULL),rue);

397 
m_s
.
	`CheckAndHªdËE¼Ü
("C»©eEv’t", 
m_ev’t
.
	`HªdËV®id
());

398 
	`mem£t
(&
m_ov”Ïµed
, 0, (m_overlapped));

399 
m_ov”Ïµed
.
hEv’t
 = 
m_ev’t
;

400 
	}
}

403 
	gSock‘S’d”
::~
	$Sock‘S’d”
()

405 #ifdeà
USE_WINDOWS_STYLE_SOCKETS


406 
	`CªûlIo
((
HANDLE
è
m_s
.
	`G‘Sock‘
());

408 
	}
}

410 
	gSock‘S’d”
::
	$S’d
(cÚ¡ 
by‹
* 
buf
, 
size_t
 
bufL’
)

412 
	`as£¹
(!
m_»suÉP’dšg
);

413 
DWORD
 
wr™‹n
 = 0;

415 
WSABUF
 
w§buf
 = {
	`UnsigÃdMš
((
u_lÚg
)128*1024, 
bufL’
), (*)
buf
};

416 ià(
	`WSAS’d
(
m_s
, &
w§buf
, 1, &
wr™‹n
, 0, &
m_ov”Ïµed
, 
NULL
) == 0)

418 
m_»suÉP’dšg
 = 
çl£
;

419 
m_Ï¡ResuÉ
 = 
wr™‹n
;

423 ià(
	`WSAG‘La¡E¼Ü
(è!ğ
WSA_IO_PENDING
)

424 
m_s
.
	`CheckAndHªdËE¼Ü_št
("WSAS’d", 
SOCKET_ERROR
);

426 
m_»suÉP’dšg
 = 
Œue
;

428 
	}
}

430 
	gSock‘S’d”
::
	$S’dEof
()

432 
	`as£¹
(!
m_»suÉP’dšg
);

433 
m_s
.
	`ShutDown
(
SD_SEND
);

434 
m_s
.
	`CheckAndHªdËE¼Ü
("Re£tEv’t", 
	`Re£tEv’t
(
m_ev’t
));

435 
m_s
.
	`CheckAndHªdËE¼Ü_št
("WSAEv’tS–eù", 
	`WSAEv’tS–eù
(m_s, 
m_ev’t
, 
FD_CLOSE
));

436 
m_»suÉP’dšg
 = 
Œue
;

437 
	}
}

439 
boŞ
 
	gSock‘S’d”
::
	$EofS’t
()

441 ià(
m_»suÉP’dšg
)

443 
WSANETWORKEVENTS
 
ev’ts
;

444 
m_s
.
	`CheckAndHªdËE¼Ü_št
("WSAEnumN‘wÜkEv’ts", 
	`WSAEnumN‘wÜkEv’ts
(m_s, 
m_ev’t
, &
ev’ts
));

445 ià((
ev’ts
.
lN‘wÜkEv’ts
 & 
FD_CLOSE
) != FD_CLOSE)

446 
throw
 
Sock‘
::
	`E¼
(
m_s
, "WSAEnumN‘wÜkEv’t (FD_CLOSE‚Ù…»£Á)", 
E_FAIL
);

447 ià(
ev’ts
.
iE¼ÜCode
[
FD_CLOSE_BIT
] != 0)

448 
throw
 
Sock‘
::
	`E¼
(
m_s
, "FD_CLOSE (vŸ WSAEnumN‘wÜkEv’ts)", 
ev’ts
.
iE¼ÜCode
[
FD_CLOSE_BIT
]);

449 
m_»suÉP’dšg
 = 
çl£
;

451  
m_Ï¡ResuÉ
 != 0;

452 
	}
}

454 
	gSock‘S’d”
::
	$G‘Wa™Objeùs
(
Wa™ObjeùCÚš”
 &
cÚš”
, 
C®lSck
 cÚ¡& 
ÿÎSck
)

456 ià(
m_»suÉP’dšg
)

457 
cÚš”
.
	`AddHªdË
(
m_ev’t
, 
	`C®lSck
("Sock‘S’d”::G‘Wa™Objeùs(è-„esuÉ…’dšg", &
ÿÎSck
));

459 
cÚš”
.
	`S‘NoWa™
(
	`C®lSck
("Sock‘S’d”::G‘Wa™Objeùs(è-„esuÉ„—dy", &
ÿÎSck
));

460 
	}
}

462 
	gSock‘S’d”
::
	$G‘S’dResuÉ
()

464 ià(
m_»suÉP’dšg
)

466 
DWORD
 
æags
 = 0;

467 
BOOL
 
»suÉ
 = 
	`WSAG‘Ov”ÏµedResuÉ
(
m_s
, &
m_ov”Ïµed
, &
m_Ï¡ResuÉ
, 
çl£
, &
æags
);

468 
m_s
.
	`CheckAndHªdËE¼Ü
("WSAG‘Ov”ÏµedResuÉ", 
»suÉ
);

469 
m_»suÉP’dšg
 = 
çl£
;

471  
m_Ï¡ResuÉ
;

472 
	}
}

476 #ifdeà
USE_BERKELEY_STYLE_SOCKETS


478 
	gSock‘Reûiv”
::
	$Sock‘Reûiv”
(
Sock‘
 &
s
)

479 : 
	`m_s
(
s
), 
	`m_Ï¡ResuÉ
(0), 
	$m_eofReûived
(
çl£
)

481 
	}
}

483 
	gSock‘Reûiv”
::
	$G‘Wa™Objeùs
(
Wa™ObjeùCÚš”
 &
cÚš”
, 
C®lSck
 cÚ¡& 
ÿÎSck
)

485 ià(!
m_eofReûived
)

486 
cÚš”
.
	`AddR—dFd
(
m_s
, 
	`C®lSck
("Sock‘Reûiv”::G‘Wa™Objeùs()", &
ÿÎSck
));

487 
	}
}

489 
boŞ
 
	gSock‘Reûiv”
::
	$Reûive
(
by‹
* 
buf
, 
size_t
 
bufL’
)

491 
m_Ï¡ResuÉ
 = 
m_s
.
	`Reûive
(
buf
, 
bufL’
);

492 ià(
bufL’
 > 0 && 
m_Ï¡ResuÉ
 == 0)

493 
m_eofReûived
 = 
Œue
;

494  
Œue
;

495 
	}
}

497 
	gSock‘Reûiv”
::
	$G‘ReûiveResuÉ
()

499  
m_Ï¡ResuÉ
;

500 
	}
}

502 
	gSock‘S’d”
::
	$Sock‘S’d”
(
Sock‘
 &
s
)

503 : 
	`m_s
(
s
), 
	$m_Ï¡ResuÉ
(0)

505 
	}
}

507 
	gSock‘S’d”
::
	$S’d
(cÚ¡ 
by‹
* 
buf
, 
size_t
 
bufL’
)

509 
m_Ï¡ResuÉ
 = 
m_s
.
	`S’d
(
buf
, 
bufL’
);

510 
	}
}

512 
	gSock‘S’d”
::
	$S’dEof
()

514 
m_s
.
	`ShutDown
(
SD_SEND
);

515 
	}
}

517 
	gSock‘S’d”
::
	$G‘S’dResuÉ
()

519  
m_Ï¡ResuÉ
;

520 
	}
}

522 
	gSock‘S’d”
::
	$G‘Wa™Objeùs
(
Wa™ObjeùCÚš”
 &
cÚš”
, 
C®lSck
 cÚ¡& 
ÿÎSck
)

524 
cÚš”
.
	`AddWr™eFd
(
m_s
, 
	`C®lSck
("Sock‘S’d”::G‘Wa™Objeùs()", &
ÿÎSck
));

525 
	}
}

529 
	gNAMESPACE_END


	@socketft.h

1 #iâdeà
CRYPTOPP_SOCKETFT_H


2 
	#CRYPTOPP_SOCKETFT_H


	)

4 
	~"cÚfig.h
"

6 #ifdeà
SOCKETS_AVAILABLE


8 
	~"ÃtwÜk.h
"

9 
	~"queue.h
"

11 #ifdeà
USE_WINDOWS_STYLE_SOCKETS


12 #ià
defšed
(
_WINSOCKAPI_
è&& !defšed(
_WINSOCK2API_
)

13 #”rÜ 
Wšsock
 1 
is
 
nÙ
 
suµÜ‹d
 
by
 
this
 
lib¿ry
. 
PËa£
 
šşude
hi 
fe
 
Ü
 
wšsock2
.
h
 
befÜe
 
wšdows
.h.

15 
	~<wšsock2.h
>

16 
	~"wšpes.h
"

18 
	~<sys/time.h
>

19 
	~<sys/ty³s.h
>

20 
	~<sys/sock‘.h
>

21 
	~<uni¡d.h
>

24 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

26 #ifdeà
USE_WINDOWS_STYLE_SOCKETS


27 ::
SOCKET
 
	tsock‘_t
;

29 
	tsock‘_t
;

30 cÚ¡ 
sock‘_t
 
INVALID_SOCKET
 = -1;

32 cÚ¡ 
SD_RECEIVE
 = 0;

33 cÚ¡ 
SD_SEND
 = 1;

34 cÚ¡ 
SD_BOTH
 = 2;

35 cÚ¡ 
SOCKET_ERROR
 = -1;

38 #iâdeà
sockËn_t


39 
TYPE_OF_SOCKLEN_T
 
	tsockËn_t
;

43 şas 
	cSock‘


45 
public
:

47 şas 
	cE¼
 : 
public
 
OS_E¼Ü


49 
public
:

50 
	`E¼
(
sock‘_t
 
s
, cÚ¡ 
¡d
::
¡ršg
& 
İ”©iÚ
, 
”rÜ
);

51 
sock‘_t
 
	`G‘Sock‘
(ècÚ¡ { 
m_s
;}

53 
´iv©e
:

54 
sock‘_t
 
m_s
;

57 
	$Sock‘
(
sock‘_t
 
s
 = 
INVALID_SOCKET
, 
boŞ
 
own
=
çl£
è: 
	`m_s
(s), 
	$m_own
(
own
è{
	}
}

58 
	$Sock‘
(cÚ¡ 
Sock‘
 &
s
è: 
	`m_s
(s.
m_s
), 
	$m_own
(
çl£
è{
	}
}

59 
	gvœtu®
 ~
Sock‘
();

61 
boŞ
 
	$G‘OwÃrsh
(ècÚ¡ { 
m_own
;
	}
}

62 
	$S‘OwÃrsh
(
boŞ
 
own
è{
m_own
 = own;
	}
}

64 
İ”©Ü
 
	$sock‘_t
(è{ 
m_s
;
	}
}

65 
sock‘_t
 
	$G‘Sock‘
(ècÚ¡ { 
m_s
;
	}
}

66 
A‰achSock‘
(
sock‘_t
 
s
, 
boŞ
 
own
=
çl£
);

67 
sock‘_t
 
D‘achSock‘
();

68 
Clo£Sock‘
();

70 
C»©e
(
nTy³
 = 
SOCK_STREAM
);

71 
Bšd
(
pÜt
, cÚ¡ *
addr
=
NULL
);

72 
Bšd
(cÚ¡ 
sockaddr
* 
p§
, 
sockËn_t
 
§L’
);

73 
Li¡’
(
backlog
=5);

76 
boŞ
 
CÚÃù
(cÚ¡ *
addr
, 
pÜt
);

77 
boŞ
 
CÚÃù
(cÚ¡ 
sockaddr
* 
p§
, 
sockËn_t
 
§L’
);

78 
boŞ
 
Acû±
(
Sock‘
& 
s
, 
sockaddr
 *
p§
=
NULL
, 
sockËn_t
 *
p§L’
=NULL);

79 
G‘SockName
(
sockaddr
 *
p§
, 
sockËn_t
 *
p§L’
);

80 
G‘P“rName
(
sockaddr
 *
p§
, 
sockËn_t
 *
p§L’
);

81 
S’d
(cÚ¡ 
by‹
* 
buf
, 
size_t
 
bufL’
, 
æags
=0);

82 
Reûive
(
by‹
* 
buf
, 
size_t
 
bufL’
, 
æags
=0);

83 
ShutDown
(
how
 = 
SD_SEND
);

85 
IOC
(
cmd
, *
¬gp
);

86 
boŞ
 
S’dR—dy
(cÚ¡ 
timev®
 *
timeout
);

87 
boŞ
 
ReûiveR—dy
(cÚ¡ 
timev®
 *
timeout
);

89 
vœtu®
 
	$HªdËE¼Ü
(cÚ¡ *
İ”©iÚ
) const;

90 
	$CheckAndHªdËE¼Ü_št
(cÚ¡ *
İ”©iÚ
, 
»suÉ
) const

91 {ià(
»suÉ
 =ğ
SOCKET_ERROR
è
	`HªdËE¼Ü
(
İ”©iÚ
);
	}
}

92 
	$CheckAndHªdËE¼Ü
(cÚ¡ *
İ”©iÚ
, 
sock‘_t
 
»suÉ
) const

93 {ià(
»suÉ
 =ğ
SOCKET_ERROR
è
	`HªdËE¼Ü
(
İ”©iÚ
);
	}
}

94 #ifdeà
USE_WINDOWS_STYLE_SOCKETS


95 
	$CheckAndHªdËE¼Ü
(cÚ¡ *
İ”©iÚ
, 
BOOL
 
»suÉ
) const

96 {
	`as£¹
(
»suÉ
==
TRUE
 ||„esuÉ==
FALSE
); ià(!»suÉè
	`HªdËE¼Ü
(
İ”©iÚ
);
	}
}

97 
	$CheckAndHªdËE¼Ü
(cÚ¡ *
İ”©iÚ
, 
boŞ
 
»suÉ
) const

98 {ià(!
»suÉ
è
	`HªdËE¼Ü
(
İ”©iÚ
);
	}
}

102 
PÜtNameToNumb”
(cÚ¡ *
Çme
, cÚ¡ *
´ÙocŞ
="tcp");

104 
S¹Sock‘s
();

106 
ShutdownSock‘s
();

108 
G‘La¡E¼Ü
();

110 
S‘La¡E¼Ü
(
”rÜCode
);

112 
	g´Ùeùed
:

113 
vœtu®
 
	$Sock‘Chªged
(è{
	}
}

115 
sock‘_t
 
m_s
;

116 
boŞ
 
	gm_own
;

119 şas 
	cSock‘sIn™Ÿliz”


121 
	mpublic
:

122 
	$Sock‘sIn™Ÿliz”
(è{
Sock‘
::
	`S¹Sock‘s
();}

123 ~
	$Sock‘sIn™Ÿliz”
(è{
Œy
 {
Sock‘
::
	`ShutdownSock‘s
();} 
	`ÿtch
 (...è{}
	}
}

126 şas 
	cSock‘Reûiv”
 : 
public
 
N‘wÜkReûiv”


128 
public
:

129 
Sock‘Reûiv”
(
Sock‘
 &
s
);

131 #ifdeà
USE_BERKELEY_STYLE_SOCKETS


132 
boŞ
 
	$Mu¡Wa™ToReûive
(è{ 
Œue
;}

134 ~
	`Sock‘Reûiv”
();

135 
boŞ
 
	$Mu¡Wa™FÜResuÉ
(è{ 
Œue
;
	}
}

137 
boŞ
 
Reûive
(
by‹
* 
buf
, 
size_t
 
bufL’
);

138 
G‘ReûiveResuÉ
();

139 
boŞ
 
	$EofReûived
(ècÚ¡ { 
m_eofReûived
;
	}
}

141 
	$G‘MaxWa™ObjeùCouÁ
(ècÚ¡ { 1;
	}
}

142 
G‘Wa™Objeùs
(
Wa™ObjeùCÚš”
 &
cÚš”
, 
C®lSck
 cÚ¡& 
ÿÎSck
);

144 
	g´iv©e
:

145 
Sock‘
 &
m_s
;

146 
boŞ
 
	gm_eofReûived
;

148 #ifdeà
USE_WINDOWS_STYLE_SOCKETS


149 
WšdowsHªdË
 
	gm_ev’t
;

150 
OVERLAPPED
 
	gm_ov”Ïµed
;

151 
boŞ
 
	gm_»suÉP’dšg
;

152 
DWORD
 
	gm_Ï¡ResuÉ
;

154 
	gm_Ï¡ResuÉ
;

158 şas 
	cSock‘S’d”
 : 
public
 
N‘wÜkS’d”


160 
public
:

161 
Sock‘S’d”
(
Sock‘
 &
s
);

163 #ifdeà
USE_BERKELEY_STYLE_SOCKETS


164 
boŞ
 
	$Mu¡Wa™ToS’d
(è{ 
Œue
;}

166 ~
	`Sock‘S’d”
();

167 
boŞ
 
	$Mu¡Wa™FÜResuÉ
(è{ 
Œue
;
	}
}

168 
boŞ
 
	$Mu¡Wa™FÜEof
(è{  
Œue
; 
	}
}

169 
boŞ
 
EofS’t
();

171 
S’d
(cÚ¡ 
by‹
* 
buf
, 
size_t
 
bufL’
);

172 
G‘S’dResuÉ
();

173 
S’dEof
();

175 
	$G‘MaxWa™ObjeùCouÁ
(ècÚ¡ { 1;
	}
}

176 
G‘Wa™Objeùs
(
Wa™ObjeùCÚš”
 &
cÚš”
, 
C®lSck
 cÚ¡& 
ÿÎSck
);

178 
	g´iv©e
:

179 
Sock‘
 &
m_s
;

180 #ifdeà
USE_WINDOWS_STYLE_SOCKETS


181 
WšdowsHªdË
 
	gm_ev’t
;

182 
OVERLAPPED
 
	gm_ov”Ïµed
;

183 
boŞ
 
	gm_»suÉP’dšg
;

184 
DWORD
 
	gm_Ï¡ResuÉ
;

186 
	gm_Ï¡ResuÉ
;

191 
şass
 
	gSock‘Sourû
 : 
public
 
N‘wÜkSourû
,…ubliø
	gSock‘


193 
	gpublic
:

194 
Sock‘Sourû
(
sock‘_t
 
s
 = 
INVALID_SOCKET
, 
boŞ
 
pumpAÎ
 = 
çl£
, 
Bufã»dT¿nsfÜm©iÚ
 *
©chm’t
 = 
NULL
)

195 : 
N‘wÜkSourû
(
©chm’t
), 
Sock‘
(
s
), 
m_»ûiv”
(*
this
)

197 ià(
	gpumpAÎ
)

198 
PumpAÎ
();

201 
	g´iv©e
:

202 
N‘wÜkReûiv”
 & 
AcûssReûiv”
(è{ 
m_»ûiv”
;}

203 
Sock‘Reûiv”
 
	gm_»ûiv”
;

207 
şass
 
	gSock‘Sšk
 : 
public
 
N‘wÜkSšk
,…ubliø
	gSock‘


209 
	gpublic
:

210 
Sock‘Sšk
(
sock‘_t
 
s
=
INVALID_SOCKET
, 
maxBufãrSize
=0, 
autoFlushBound
=16*1024)

211 : 
N‘wÜkSšk
(
maxBufãrSize
, 
autoFlushBound
), 
Sock‘
(
s
), 
m_£nd”
(*
this
) {}

213 
S’dEof
(è{
ShutDown
(
SD_SEND
);}

215 
	g´iv©e
:

216 
N‘wÜkS’d”
 & 
AcûssS’d”
(è{ 
m_£nd”
;}

217 
Sock‘S’d”
 
	gm_£nd”
;

220 
	gNAMESPACE_END


	@sosemanuk.cpp

5 
	~"pch.h
"

7 #iâdeà
CRYPTOPP_GENERATE_X64_MASM


9 
	~"so£mªuk.h
"

10 
	~"misc.h
"

11 
	~"ıu.h
"

13 
	~"£½’.h
"

15 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

17 
So£mªukPŞicy
::
	$Ch”S‘Key
(cÚ¡ 
NameV®uePaœs
 &
·¿ms
, cÚ¡ 
by‹
 *
u£rKey
, 
size_t
 
keyËn
)

19 
	`S”³Á_KeyScheduË
(
m_key
, 24, 
u£rKey
, 
keyËn
);

20 
	}
}

22 
	gSo£mªukPŞicy
::
	$Ch”ResynchrÚize
(
by‹
 *
key¡»amBufãr
, cÚ¡ by‹ *
iv
, 
size_t
 
Ëngth
)

24 
	`as£¹
(
Ëngth
==16);

26 
wÜd32
 
a
, 
b
, 
c
, 
d
, 
e
;

28 
BlockG‘AndPut
<
	twÜd32
, 
	tL™eEndŸn
> 
	tBlock
;

29 
Block
::
	`G‘
(
iv
)(
a
)(
b
)(
c
)(
d
);

31 cÚ¡ 
wÜd32
 *
k
 = 
m_key
;

32 
i
=1;

36 
	`befÜeS0
(
KX
); befÜeS0(
S0
); 
	`aá”S0
(
LT
);

37 
	`aá”S0
(
KX
);‡á”S0(
S1
); 
	`aá”S1
(
LT
);

38 ià(
i
 == 3)

40 
m_¡©e
[4] = 
b
;

41 
m_¡©e
[5] = 
e
;

42 
m_¡©e
[10] = 
c
;

43 
m_¡©e
[11] = 
a
;

45 
	`aá”S1
(
KX
);‡á”S1(
S2
); 
	`aá”S2
(
LT
);

46 
	`aá”S2
(
KX
);‡á”S2(
S3
); 
	`aá”S3
(
LT
);

47 ià(
i
 == 2)

49 
m_¡©e
[6] = 
c
;

50 
m_¡©e
[7] = 
d
;

51 
m_¡©e
[8] = 
b
;

52 
m_¡©e
[9] = 
e
;

54 
	`aá”S3
(
KX
);‡á”S3(
S4
); 
	`aá”S4
(
LT
);

55 
	`aá”S4
(
KX
);‡á”S4(
S5
); 
	`aá”S5
(
LT
);

56 
	`aá”S5
(
KX
);‡á”S5(
S6
); 
	`aá”S6
(
LT
);

57 
	`aá”S6
(
KX
);‡á”S6(
S7
); 
	`aá”S7
(
LT
);

59 ià(
i
 == 3)

62 ++
i
;

63 
c
 = 
b
;

64 
b
 = 
e
;

65 
e
 = 
d
;

66 
d
 = 
a
;

67 
a
 = 
e
;

68 
k
 += 32;

70 
Œue
);

72 
	`aá”S7
(
KX
);

74 
m_¡©e
[0] = 
a
;

75 
m_¡©e
[1] = 
b
;

76 
m_¡©e
[2] = 
e
;

77 
m_¡©e
[3] = 
d
;

79 
	#XMUX
(
c
, 
x
, 
y
è(x ^ (y & (0 - (ø& 1))))

	)

80 
m_¡©e
[11] +ğ
	`XMUX
(m_state[10], m_state[1], m_state[8]);

81 
m_¡©e
[10] = 
	`rÙlFixed
(m_state[10] * 0x54655307, 7);

82 
	}
}

85 
wÜd32
 
s_so£mªukMulTabËs
[512] = {

86 #ià
CRYPTOPP_BOOL_X86
 | 
CRYPTOPP_BOOL_X64


284 #ià
CRYPTOPP_BOOL_X86
 || 
CRYPTOPP_BOOL_X64


285 
So£mªukPŞicy
::
	$G‘Alignm’t
() const

287 #ià
CRYPTOPP_BOOL_SSE2_ASM_AVAILABLE


288 #ifdeà
__INTEL_COMPILER


289 ià(
	`HasSSE2
(è&& !
	`IsP4
())

291 ià(
	`HasSSE2
())

296  
G‘Alignm’tOf
<
wÜd32
>();

297 
	}
}

299 
So£mªukPŞicy
::
	$G‘O±im®BlockSize
() const

301 #ià
CRYPTOPP_BOOL_SSE2_ASM_AVAILABLE


302 #ifdeà
__INTEL_COMPILER


303 ià(
	`HasSSE2
(è&& !
	`IsP4
())

305 ià(
	`HasSSE2
())

307  4*
BYTES_PER_ITERATION
;

310  
BYTES_PER_ITERATION
;

311 
	}
}

314 #ifdeà
CRYPTOPP_X64_MASM_AVAILABLE


316 
So£mªuk_O³¿‹Key¡»am
(
size_t
 
™”©iÚCouÁ
, cÚ¡ 
by‹
 *
šput
, by‹ *
ouut
, 
wÜd32
 *
¡©e
);

320 #´agm¨
w¬nšg
(
di§bË
: 4731)

322 
So£mªukPŞicy
::
	$O³¿‹Key¡»am
(
Key¡»amO³¿tiÚ
 
İ”©iÚ
, 
by‹
 *
ouut
, cÚ¡ by‹ *
šput
, 
size_t
 
™”©iÚCouÁ
)

326 #ifdeà
CRYPTOPP_X64_MASM_AVAILABLE


327 
	`So£mªuk_O³¿‹Key¡»am
(
™”©iÚCouÁ
, 
šput
, 
ouut
, 
m_¡©e
.
	`d©a
());

331 #ià
CRYPTOPP_BOOL_SSE2_ASM_AVAILABLE


332 #ifdeà
CRYPTOPP_GENERATE_X64_MASM


333 
ALIGN
 8

334 
So£mªuk_O³¿‹Key¡»am
 
PROC
 
FRAME


335 
»x_push_»g
 
rsi


336 
push_»g
 
rdi


337 
	`®loc_¡ack
(80*4*2+12*4+8*
WORD_SZ
 + 2*16+8)

338 
§ve_xmm128
 
xmm6
, 02f0
h


339 
§ve_xmm128
 
xmm7
, 0300
h


340 .
’d´Şog


341 
mov
 
rdi
, 
r8


342 
mov
 
¿x
, 
r9


344 #ifdeà
__INTEL_COMPILER


345 ià(
	`HasSSE2
(è&& !
	$IsP4
())

347 ià(
	$HasSSE2
())

350 #ifdeà
__GNUC__


351 #ià
CRYPTOPP_BOOL_X64


352 
FixedSizeAligÃdSecBlock
<
by‹
, 80*4*2+12*4+8*
WORD_SZ
> 
wÜk¥aû
;

354 
__asm__
 
__vŞ©e__


357 
	`AS_PUSH_IF86
Ğ
bx
)

359 
wÜd32
 *
¡©e
 = 
m_¡©e
;

360 
	`AS2
Ğ
mov
 
	`WORD_REG
(
ax
), 
¡©e
)

361 
	`AS2
Ğ
mov
 
	`WORD_REG
(
di
), 
ouut
)

362 
	`AS2
Ğ
mov
 
	`WORD_REG
(
dx
), 
šput
)

363 
	`AS2
Ğ
mov
 
	`WORD_REG
(
cx
), 
™”©iÚCouÁ
)

367 #ià
	`defšed
(
__GNUC__
è&& 
CRYPTOPP_BOOL_X64


368 
	#SSE2_wÜk¥aû
 %5

	)

370 
	#SSE2_wÜk¥aû
 
	`WORD_REG
(
¥
)

	)

373 
	#SSE2_ouut
 
WORD_PTR
 [
SSE2_wÜk¥aû
+1*
WORD_SZ
]

	)

374 
	#SSE2_šput
 
WORD_PTR
 [
SSE2_wÜk¥aû
+2*
WORD_SZ
]

	)

375 
	#SSE2_wÜdsLeá
 
WORD_PTR
 [
SSE2_wÜk¥aû
+3*
WORD_SZ
]

	)

376 
	#SSE2_diEnd
 
WORD_PTR
 [
SSE2_wÜk¥aû
+4*
WORD_SZ
]

	)

377 
	#SSE2_pMulTabËs
 
WORD_PTR
 [
SSE2_wÜk¥aû
+5*
WORD_SZ
]

	)

378 
	#SSE2_¡©e
 
WORD_PTR
 [
SSE2_wÜk¥aû
+6*
WORD_SZ
]

	)

379 
	#SSE2_wÜdsLeá2
 
WORD_PTR
 [
SSE2_wÜk¥aû
+7*
WORD_SZ
]

	)

380 
	#SSE2_¡©eCİy
 
SSE2_wÜk¥aû
 + 8*
WORD_SZ


	)

381 
	#SSE2_uvS¹
 
SSE2_¡©eCİy
 + 12*4

	)

383 #ià
CRYPTOPP_BOOL_X86


384 
	`AS_PUSH_IF86
Ğ
bp
)

385 
	`AS2
Ğ
mov
 
AS_REG_6
, 
e¥
)

386 
	`AS2
Ğ
ªd
 
e¥
, -16)

387 
	`AS2
Ğ
sub
 
e¥
, 80*4*2+12*4+8*
WORD_SZ
)

388 
	`AS2
Ğ
mov
 [
e¥
], 
AS_REG_6
)

390 
	`AS2
Ğ
mov
 
SSE2_ouut
, 
	`WORD_REG
(
di
))

391 
	`AS2
Ğ
mov
 
SSE2_šput
, 
	`WORD_REG
(
dx
))

392 
	`AS2
Ğ
mov
 
SSE2_¡©e
, 
	`WORD_REG
(
ax
))

393 #iâdeà
_MSC_VER


394 
	`AS2
Ğ
mov
 
SSE2_pMulTabËs
, 
	`WORD_REG
(
si
))

396 
	`AS2
Ğ
Ëa
 
	`WORD_REG
(
cx
), [4*WORD_REG(cx)+WORD_REG(cx)])

397 
	`AS2
Ğ
Ëa
 
	`WORD_REG
(
si
), [4*WORD_REG(
cx
)])

398 
	`AS2
Ğ
mov
 
SSE2_wÜdsLeá
, 
	`WORD_REG
(
si
))

399 
	`AS2
Ğ
movdqa
 
xmm0
, [
	`WORD_REG
(
ax
)+0*16])

400 
	`AS2
Ğ
movdqa
 [
SSE2_¡©eCİy
+0*16], 
xmm0
)

401 
	`AS2
Ğ
movdqa
 
xmm0
, [
	`WORD_REG
(
ax
)+1*16])

402 
	`AS2
Ğ
movdqa
 [
SSE2_¡©eCİy
+1*16], 
xmm0
)

403 
	`AS2
Ğ
movq
 
xmm0
, 
QWORD
 
PTR
 [
	`WORD_REG
(
ax
)+2*16])

404 
	`AS2
Ğ
movq
 
QWORD
 
PTR
 [
SSE2_¡©eCİy
+2*16], 
xmm0
)

405 
	`AS2
Ğ
p¤lq
 
xmm0
, 32)

406 
	`AS2
Ğ
movd
 
AS_REG_6d
, 
xmm0
)

407 
	`AS2
Ğ
mov
 
ecx
, [
	`WORD_REG
(
ax
)+10*4])

408 
	`AS2
Ğ
mov
 
edx
, [
	`WORD_REG
(
ax
)+11*4])

409 
	`AS2
Ğ
pcm³qb
 
xmm7
, xmm7)

411 
	#s
(
i
è
SSE2_¡©eCİy
 + 
	`ASM_MOD
(i,10)*4

	)

412 
	#u
(
j
è
	`WORD_REG
(
di
è+ (
	`ASM_MOD
(j,4)*20 + (j/4)è* 4

	)

413 
	#v
(
j
è
	`WORD_REG
(
di
è+ (
	`ASM_MOD
(j,4)*20 + (j/4)è* 4 + 80*4

	)

415 
	#R10
 
ecx


	)

416 
	#R11
 
edx


	)

417 
	#R20
 
edx


	)

418 
	#R21
 
ecx


	)

420 
	#R20r
 
	`WORD_REG
(
dx
)

	)

421 
	#R21r
 
	`WORD_REG
(
cx
)

	)

423 
	#SSE2_STEP
(
i
, 
j
) \

424 
	`AS2
Ğ
mov
 
—x
, [
	`s
(
i
+0)])\

425 
	`AS2
Ğ
mov
 [
	`v
(
i
)], 
—x
)\

426 
	`AS2
Ğ
rŞ
 
—x
, 8)\

427 
	`AS2
Ğ
Ëa
 
AS_REG_7
, [
AS_REG_6
 + 
R2
##
j
##
r
])\

428 
	`AS2
Ğ
xÜ
 
AS_REG_7d
, 
R1
##
j
)\

429 
	`AS2
Ğ
mov
 [
	`u
(
i
)], 
AS_REG_7d
)\

430 
	`AS2
Ğ
mov
 
AS_REG_7d
, 1)\

431 
	`AS2
Ğ
ªd
 
AS_REG_7d
, 
R2
##
j
)\

432 
	`AS1
Ğ
Ãg
 
AS_REG_7d
)\

433 
	`AS2
Ğ
ªd
 
AS_REG_7d
, 
AS_REG_6d
)\

434 
	`AS2
Ğ
xÜ
 
AS_REG_6d
, 
—x
)\

435 
	`AS2
Ğ
movzx
 
—x
, 
®
)\

436 
	`AS2
Ğ
xÜ
 
AS_REG_6d
, [
	`WORD_REG
(
si
)+WORD_REG(
ax
)*4])\

437 
	`AS2
Ğ
mov
 
—x
, [
	`s
(
i
+3)])\

438 
	`AS2
Ğ
xÜ
 
AS_REG_7d
, [
	`s
(
i
+2)])\

439 
	`AS2
Ğ
add
 
R1
##
j
, 
AS_REG_7d
)\

440 
	`AS2
Ğ
movzx
 
AS_REG_7d
, 
®
)\

441 
	`AS2
Ğ
shr
 
—x
, 8)\

442 
	`AS2
Ğ
xÜ
 
AS_REG_6d
, [
	`WORD_REG
(
si
)+1024+
AS_REG_7
*4])\

443 
	`AS2
Ğ
xÜ
 
AS_REG_6d
, 
—x
)\

444 
	`AS2
Ğ
imul
 
R2
##
j
, 
	`AS_HEX
(54655307))\

445 
	`AS2
Ğ
rŞ
 
R2
##
j
, 7)\

446 
	`AS2
Ğ
mov
 [
	`s
(
i
+0)], 
AS_REG_6d
)\

447 

	)

448 
	`ASL
(2)

449 
	`AS2
Ğ
Ëa
 
	`WORD_REG
(
di
), [
SSE2_uvS¹
])

450 
	`AS2
Ğ
mov
 
	`WORD_REG
(
ax
), 80)

451 
	`AS2
Ğ
cmp
 
	`WORD_REG
(
si
), 80)

452 
	`AS2
Ğ
cmovg
 
	`WORD_REG
(
si
), WORD_REG(
ax
))

453 
	`AS2
Ğ
mov
 
SSE2_wÜdsLeá2
, 
	`WORD_REG
(
si
))

454 
	`AS2
Ğ
Ëa
 
	`WORD_REG
(
si
), [WORD_REG(
di
)+WORD_REG(si)])

455 
	`AS2
Ğ
mov
 
SSE2_diEnd
, 
	`WORD_REG
(
si
))

456 #ifdeà
_MSC_VER


457 
	`AS2
Ğ
Ëa
 
	`WORD_REG
(
si
), 
s_so£mªukMulTabËs
)

459 
	`AS2
Ğ
mov
 
	`WORD_REG
(
si
), 
SSE2_pMulTabËs
)

462 
	`ASL
(0)

463 
	`SSE2_STEP
(0, 0)

464 
	`SSE2_STEP
(1, 1)

465 
	`SSE2_STEP
(2, 0)

466 
	`SSE2_STEP
(3, 1)

467 
	`SSE2_STEP
(4, 0)

468 
	`SSE2_STEP
(5, 1)

469 
	`SSE2_STEP
(6, 0)

470 
	`SSE2_STEP
(7, 1)

471 
	`SSE2_STEP
(8, 0)

472 
	`SSE2_STEP
(9, 1)

473 
	`SSE2_STEP
(10, 0)

474 
	`SSE2_STEP
(11, 1)

475 
	`SSE2_STEP
(12, 0)

476 
	`SSE2_STEP
(13, 1)

477 
	`SSE2_STEP
(14, 0)

478 
	`SSE2_STEP
(15, 1)

479 
	`SSE2_STEP
(16, 0)

480 
	`SSE2_STEP
(17, 1)

481 
	`SSE2_STEP
(18, 0)

482 
	`SSE2_STEP
(19, 1)

484 
	`AS2
Ğ
add
 
	`WORD_REG
(
di
), 5*4)

485 
	`AS2
Ğ
cmp
 
	`WORD_REG
(
di
), 
SSE2_diEnd
)

486 
	`ASJ
Ğ
jÃ
, 0, 
b
)

488 
	`AS2
Ğ
mov
 
	`WORD_REG
(
ax
), 
SSE2_šput
)

489 
	`AS2
Ğ
mov
 
AS_REG_7
, 
SSE2_ouut
)

490 
	`AS2
Ğ
Ëa
 
	`WORD_REG
(
di
), [
SSE2_uvS¹
])

491 
	`AS2
Ğ
mov
 
	`WORD_REG
(
si
), 
SSE2_wÜdsLeá2
)

493 
	`ASL
(1)

494 
	`AS2
Ğ
movdqa
 
xmm0
, [
	`WORD_REG
(
di
)+0*20*4])

495 
	`AS2
Ğ
movdqa
 
xmm2
, [
	`WORD_REG
(
di
)+2*20*4])

496 
	`AS2
Ğ
movdqa
 
xmm3
, [
	`WORD_REG
(
di
)+3*20*4])

497 
	`AS2
Ğ
movdqa
 
xmm1
, [
	`WORD_REG
(
di
)+1*20*4])

499 
	`AS2
Ğ
movdqa
 
xmm4
, 
xmm0
)

500 
	`AS2
Ğ
·nd
 
xmm0
, 
xmm2
)

501 
	`AS2
Ğ
pxÜ
 
xmm0
, 
xmm3
)

502 
	`AS2
Ğ
pxÜ
 
xmm2
, 
xmm1
)

503 
	`AS2
Ğ
pxÜ
 
xmm2
, 
xmm0
)

504 
	`AS2
Ğ
pÜ
 
xmm3
, 
xmm4
)

505 
	`AS2
Ğ
pxÜ
 
xmm3
, 
xmm1
)

506 
	`AS2
Ğ
pxÜ
 
xmm4
, 
xmm2
)

507 
	`AS2
Ğ
movdqa
 
xmm1
, 
xmm3
)

508 
	`AS2
Ğ
pÜ
 
xmm3
, 
xmm4
)

509 
	`AS2
Ğ
pxÜ
 
xmm3
, 
xmm0
)

510 
	`AS2
Ğ
·nd
 
xmm0
, 
xmm1
)

511 
	`AS2
Ğ
pxÜ
 
xmm4
, 
xmm0
)

512 
	`AS2
Ğ
pxÜ
 
xmm1
, 
xmm3
)

513 
	`AS2
Ğ
pxÜ
 
xmm1
, 
xmm4
)

514 
	`AS2
Ğ
pxÜ
 
xmm4
, 
xmm7
)

516 
	`AS2
Ğ
pxÜ
 
xmm2
, [
	`WORD_REG
(
di
)+80*4])

517 
	`AS2
Ğ
pxÜ
 
xmm3
, [
	`WORD_REG
(
di
)+80*5])

518 
	`AS2
Ğ
pxÜ
 
xmm1
, [
	`WORD_REG
(
di
)+80*6])

519 
	`AS2
Ğ
pxÜ
 
xmm4
, [
	`WORD_REG
(
di
)+80*7])

522 
	`AS2
Ğ
cmp
 
	`WORD_REG
(
si
), 16)

523 
	`ASJ
Ğ
jl
, 4, 
f
)

525 
	`AS2
Ğ
movdqa
 
xmm6
, 
xmm2
)

526 
	`AS2
Ğ
puÅckldq
 
xmm2
, 
xmm3
)

527 
	`AS2
Ğ
movdqa
 
xmm5
, 
xmm1
)

528 
	`AS2
Ğ
puÅckldq
 
xmm1
, 
xmm4
)

529 
	`AS2
Ğ
movdqa
 
xmm0
, 
xmm2
)

530 
	`AS2
Ğ
puÅcklqdq
 
xmm2
, 
xmm1
)

531 
	`AS2
Ğ
puÅckhqdq
 
xmm0
, 
xmm1
)

532 
	`AS2
Ğ
puÅckhdq
 
xmm6
, 
xmm3
)

533 
	`AS2
Ğ
puÅckhdq
 
xmm5
, 
xmm4
)

534 
	`AS2
Ğ
movdqa
 
xmm3
, 
xmm6
)

535 
	`AS2
Ğ
puÅcklqdq
 
xmm6
, 
xmm5
)

536 
	`AS2
Ğ
puÅckhqdq
 
xmm3
, 
xmm5
)

538 
	`AS_XMM_OUTPUT4
(
SSE2_So£mªuk_Ouut
, 
	`WORD_REG
(
ax
), 
AS_REG_7
, 2,0,6,3, 1, 0,1,2,3, 4)

541 
	`AS2
Ğ
add
 
	`WORD_REG
(
di
), 4*4)

542 
	`AS2
Ğ
sub
 
	`WORD_REG
(
si
), 16)

543 
	`ASJ
Ğ
jnz
, 1, 
b
)

546 
	`AS2
Ğ
mov
 
	`WORD_REG
(
si
), 
SSE2_wÜdsLeá
)

547 
	`AS2
Ğ
sub
 
	`WORD_REG
(
si
), 80)

548 
	`ASJ
Ğ
jz
, 6, 
f
)

549 
	`AS2
Ğ
mov
 
SSE2_wÜdsLeá
, 
	`WORD_REG
(
si
))

550 
	`AS2
Ğ
mov
 
SSE2_šput
, 
	`WORD_REG
(
ax
))

551 
	`AS2
Ğ
mov
 
SSE2_ouut
, 
AS_REG_7
)

552 
	`ASJ
Ğ
jmp
, 2, 
b
)

554 
	`ASL
(4)

555 
	`AS2
Ğ
‹¡
 
	`WORD_REG
(
ax
), WORD_REG(ax))

556 
	`ASJ
Ğ
jz
, 5, 
f
)

557 
	`AS2
Ğ
movd
 
xmm0
, 
dwÜd
 
±r
 [
	`WORD_REG
(
ax
)+0*4])

558 
	`AS2
Ğ
pxÜ
 
xmm2
, 
xmm0
)

559 
	`AS2
Ğ
movd
 
xmm0
, 
dwÜd
 
±r
 [
	`WORD_REG
(
ax
)+1*4])

560 
	`AS2
Ğ
pxÜ
 
xmm3
, 
xmm0
)

561 
	`AS2
Ğ
movd
 
xmm0
, 
dwÜd
 
±r
 [
	`WORD_REG
(
ax
)+2*4])

562 
	`AS2
Ğ
pxÜ
 
xmm1
, 
xmm0
)

563 
	`AS2
Ğ
movd
 
xmm0
, 
dwÜd
 
±r
 [
	`WORD_REG
(
ax
)+3*4])

564 
	`AS2
Ğ
pxÜ
 
xmm4
, 
xmm0
)

565 
	`AS2
Ğ
add
 
	`WORD_REG
(
ax
), 16)

566 
	`ASL
(5)

567 
	`AS2
Ğ
movd
 
dwÜd
 
±r
 [
AS_REG_7
+0*4], 
xmm2
)

568 
	`AS2
Ğ
movd
 
dwÜd
 
±r
 [
AS_REG_7
+1*4], 
xmm3
)

569 
	`AS2
Ğ
movd
 
dwÜd
 
±r
 [
AS_REG_7
+2*4], 
xmm1
)

570 
	`AS2
Ğ
movd
 
dwÜd
 
±r
 [
AS_REG_7
+3*4], 
xmm4
)

571 
	`AS2
Ğ
sub
 
	`WORD_REG
(
si
), 4)

572 
	`ASJ
Ğ
jz
, 6, 
f
)

573 
	`AS2
Ğ
add
 
AS_REG_7
, 16)

574 
	`AS2
Ğ
p¤ldq
 
xmm2
, 4)

575 
	`AS2
Ğ
p¤ldq
 
xmm3
, 4)

576 
	`AS2
Ğ
p¤ldq
 
xmm1
, 4)

577 
	`AS2
Ğ
p¤ldq
 
xmm4
, 4)

578 
	`ASJ
Ğ
jmp
, 4, 
b
)

580 
	`ASL
(6)

581 
	`AS2
Ğ
mov
 
AS_REG_6
, 
SSE2_¡©e
)

582 
	`AS2
Ğ
movdqa
 
xmm0
, [
SSE2_¡©eCİy
+0*16])

583 
	`AS2
Ğ
movdqa
 [
AS_REG_6
+0*16], 
xmm0
)

584 
	`AS2
Ğ
movdqa
 
xmm0
, [
SSE2_¡©eCİy
+1*16])

585 
	`AS2
Ğ
movdqa
 [
AS_REG_6
+1*16], 
xmm0
)

586 
	`AS2
Ğ
movq
 
xmm0
, 
QWORD
 
PTR
 [
SSE2_¡©eCİy
+2*16])

587 
	`AS2
Ğ
movq
 
QWORD
 
PTR
 [
AS_REG_6
+2*16], 
xmm0
)

588 
	`AS2
Ğ
mov
 [
AS_REG_6
+10*4], 
ecx
)

589 
	`AS2
Ğ
mov
 [
AS_REG_6
+11*4], 
edx
)

591 
	`AS_POP_IF86
Ğ
¥
)

592 
	`AS_POP_IF86
Ğ
bp
)

594 #ifdeà
__GNUC__


595 
	`AS_POP_IF86
Ğ
bx
)

598 : "a" (
m_¡©e
.
m_±r
), "c" (
™”©iÚCouÁ
), "S" (
s_so£mªukMulTabËs
), "D" (
ouut
), "d" (
šput
)

599 #ià
CRYPTOPP_BOOL_X64


600 , "r" (
wÜk¥aû
.
m_±r
)

607 #ifdeà
CRYPTOPP_GENERATE_X64_MASM


608 
movdqa
 
xmm6
, [
r¥
 + 02f0
h
]

609 
movdqa
 
xmm7
, [
r¥
 + 0300
h
]

610 
add
 
r¥
, 80*4*2+12*4+8*
WORD_SZ
 + 2*16+8

611 
pİ
 
rdi


612 
pİ
 
rsi


613 
»t


614 
So£mªuk_O³¿‹Key¡»am
 
ENDP


616 
	}
}

620 #iâdeà
CRYPTOPP_GENERATE_X64_MASM


622 #ià
CRYPTOPP_BOOL_X86
 | 
CRYPTOPP_BOOL_X64


623 
	#MUL_A
(
x
è(x = 
	`rÙlFixed
(x, 8), x ^ 
s_so£mªukMulTabËs
[
	`by‹
(x)])

	)

625 
	#MUL_A
(
x
è(((xè<< 8è^ 
s_so£mªukMulTabËs
[(xè>> 24])

	)

628 
	#DIV_A
(
x
è(((xè>> 8è^ 
s_so£mªukMulTabËs
[256 + 
	`by‹
(x)])

	)

630 
	#r1
(
i
è((i%2è? 
»g2
 : 
»g1
)

	)

631 
	#r2
(
i
è((i%2è? 
»g1
 : 
»g2
)

	)

633 
	#STEP
(
x0
, 
x1
, 
x2
, 
x3
, 
x4
, 
x5
, 
x6
, 
x7
, 
x8
, 
x9
, 
v
, 
u
) \

634 
u
 = (
s
##
x9
 + 
	`r2
(
x0
)è^ 
	`r1
(x0);\

635 
v
 = 
s
##
x0
;\

636 
s
##
x0
 = 
	`MUL_A
(s##x0è^ 
	`DIV_A
(s##
x3
è^ s##
x9
;\

637 
	`r1
(
x0
è+ğ
	`XMUX
(
	`r2
(x0), 
s
##
x2
, s##
x9
);\

638 
	`r2
(
x0
èğ
	`rÙlFixed
(r2(x0) * 0x54655307, 7);\

639 

	)

640 
	#SOSEMANUK_OUTPUT
(
x
) \

641 
	`CRYPTOPP_KEYSTREAM_OUTPUT_WORD
(
x
, 
LITTLE_ENDIAN_ORDER
, 0, 
u2
 ^ 
v0
);\

642 
	`CRYPTOPP_KEYSTREAM_OUTPUT_WORD
(
x
, 
LITTLE_ENDIAN_ORDER
, 1, 
u3
 ^ 
v1
);\

643 
	`CRYPTOPP_KEYSTREAM_OUTPUT_WORD
(
x
, 
LITTLE_ENDIAN_ORDER
, 2, 
u1
 ^ 
v2
);\

644 
	`CRYPTOPP_KEYSTREAM_OUTPUT_WORD
(
x
, 
LITTLE_ENDIAN_ORDER
, 3, 
u4
 ^ 
v3
);

	)

646 
	#OUTPUT4
 \

647 
	`S2
(0, 
u0
, 
u1
, 
u2
, 
u3
, 
u4
);\

648 
	`CRYPTOPP_KEYSTREAM_OUTPUT_SWITCH
(
SOSEMANUK_OUTPUT
, 4*4);

	)

650 
wÜd32
 
	gs0
 = 
m_¡©e
[0];

651 
wÜd32
 
	gs1
 = 
m_¡©e
[1];

652 
wÜd32
 
	gs2
 = 
m_¡©e
[2];

653 
wÜd32
 
	gs3
 = 
m_¡©e
[3];

654 
wÜd32
 
	gs4
 = 
m_¡©e
[4];

655 
wÜd32
 
	gs5
 = 
m_¡©e
[5];

656 
wÜd32
 
	gs6
 = 
m_¡©e
[6];

657 
wÜd32
 
	gs7
 = 
m_¡©e
[7];

658 
wÜd32
 
	gs8
 = 
m_¡©e
[8];

659 
wÜd32
 
	gs9
 = 
m_¡©e
[9];

660 
wÜd32
 
	g»g1
 = 
m_¡©e
[10];

661 
wÜd32
 
	g»g2
 = 
m_¡©e
[11];

662 
wÜd32
 
	gu0
, 
	gu1
, 
	gu2
, 
	gu3
, 
	gu4
, 
	gv0
, 
	gv1
, 
	gv2
, 
	gv3
;

666 
STEP
(0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 
v0
, 
u0
)

667 
STEP
(1, 2, 3, 4, 5, 6, 7, 8, 9, 0, 
v1
, 
u1
)

668 
STEP
(2, 3, 4, 5, 6, 7, 8, 9, 0, 1, 
v2
, 
u2
)

669 
STEP
(3, 4, 5, 6, 7, 8, 9, 0, 1, 2, 
v3
, 
u3
)

670 
OUTPUT4


671 
STEP
(4, 5, 6, 7, 8, 9, 0, 1, 2, 3, 
v0
, 
u0
)

672 
STEP
(5, 6, 7, 8, 9, 0, 1, 2, 3, 4, 
v1
, 
u1
)

673 
STEP
(6, 7, 8, 9, 0, 1, 2, 3, 4, 5, 
v2
, 
u2
)

674 
STEP
(7, 8, 9, 0, 1, 2, 3, 4, 5, 6, 
v3
, 
u3
)

675 
OUTPUT4


676 
STEP
(8, 9, 0, 1, 2, 3, 4, 5, 6, 7, 
v0
, 
u0
)

677 
STEP
(9, 0, 1, 2, 3, 4, 5, 6, 7, 8, 
v1
, 
u1
)

678 
STEP
(0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 
v2
, 
u2
)

679 
STEP
(1, 2, 3, 4, 5, 6, 7, 8, 9, 0, 
v3
, 
u3
)

680 
OUTPUT4


681 
STEP
(2, 3, 4, 5, 6, 7, 8, 9, 0, 1, 
v0
, 
u0
)

682 
STEP
(3, 4, 5, 6, 7, 8, 9, 0, 1, 2, 
v1
, 
u1
)

683 
STEP
(4, 5, 6, 7, 8, 9, 0, 1, 2, 3, 
v2
, 
u2
)

684 
STEP
(5, 6, 7, 8, 9, 0, 1, 2, 3, 4, 
v3
, 
u3
)

685 
OUTPUT4


686 
STEP
(6, 7, 8, 9, 0, 1, 2, 3, 4, 5, 
v0
, 
u0
)

687 
STEP
(7, 8, 9, 0, 1, 2, 3, 4, 5, 6, 
v1
, 
u1
)

688 
STEP
(8, 9, 0, 1, 2, 3, 4, 5, 6, 7, 
v2
, 
u2
)

689 
STEP
(9, 0, 1, 2, 3, 4, 5, 6, 7, 8, 
v3
, 
u3
)

690 
	gOUTPUT4


692 --
	g™”©iÚCouÁ
);

694 
	gm_¡©e
[0] = 
s0
;

695 
	gm_¡©e
[1] = 
s1
;

696 
	gm_¡©e
[2] = 
s2
;

697 
	gm_¡©e
[3] = 
s3
;

698 
	gm_¡©e
[4] = 
s4
;

699 
	gm_¡©e
[5] = 
s5
;

700 
	gm_¡©e
[6] = 
s6
;

701 
	gm_¡©e
[7] = 
s7
;

702 
	gm_¡©e
[8] = 
s8
;

703 
	gm_¡©e
[9] = 
s9
;

704 
	gm_¡©e
[10] = 
»g1
;

705 
	gm_¡©e
[11] = 
»g2
;

709 
	gNAMESPACE_END


	@sosemanuk.h

1 #iâdeà
CRYPTOPP_SOSEMANUK_H


2 
	#CRYPTOPP_SOSEMANUK_H


	)

4 
	~"¡rchr.h
"

6 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

9 
So£mªukInfo
 : 
public
 
V¬ŸbËKeyL’gth
<16, 1, 32, 1, 
Sim¶eKeyšgIÁ”çû
::
UNIQUE_IV
, 16>

11 cÚ¡ * 
	`SticAlgÜ™hmName
() { "Sosemanuk";}

12 
	}
};

15 
şass
 
	gSo£mªukPŞicy
 : 
public
 
Add™iveCh”CÚü‘ePŞicy
<
wÜd32
, 20>,…ubliø
	gSo£mªukInfo


17 
	g´Ùeùed
:

18 
Ch”S‘Key
(cÚ¡ 
NameV®uePaœs
 &
·¿ms
, cÚ¡ 
by‹
 *
key
, 
size_t
 
Ëngth
);

19 
O³¿‹Key¡»am
(
Key¡»amO³¿tiÚ
 
İ”©iÚ
, 
by‹
 *
ouut
, cÚ¡ by‹ *
šput
, 
size_t
 
™”©iÚCouÁ
);

20 
Ch”ResynchrÚize
(
by‹
 *
key¡»amBufãr
, cÚ¡ by‹ *
iv
, 
size_t
 
Ëngth
);

21 
boŞ
 
Ch”IsRªdomAcûss
(ècÚ¡ { 
	gçl£
;}

22 #ià
CRYPTOPP_BOOL_X86
 || 
CRYPTOPP_BOOL_X64


23 
G‘Alignm’t
() const;

24 
G‘O±im®BlockSize
() const;

27 
	gFixedSizeSecBlock
<
	gwÜd32
, 25*4> 
	gm_key
;

28 
	gFixedSizeAligÃdSecBlock
<
	gwÜd32
, 12> 
	gm_¡©e
;

32 
	gSo£mªuk
 : 
public
 
So£mªukInfo
,…ubliø
	gSymm‘ricCh”Docum’tiÚ


34 
	gSymm‘ricCh”Fš®
<
	tCÚü‘ePŞicyHŞd”
<
	tSo£mªukPŞicy
, 
	tAdd™iveCh”Tem¶©e
<> >, 
	tSo£mªukInfo
> 
	tEnüy±iÚ
;

35 
Enüy±iÚ
 
	tDeüy±iÚ
;

38 
	gNAMESPACE_END


	@square.cpp

4 
	~"pch.h
"

5 
	~"squ¬e.h
"

6 
	~"misc.h
"

7 
	~"gf256.h
"

9 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

12 
	$Squ¬eT¿nsfÜm
 (
wÜd32
 
š
[4], wÜd32 
out
[4])

14 cÚ¡ 
by‹
 
G
[4][4] =

22 
GF256
 
	`gf256
(0xf5);

24 
i
 = 0; i < 4; i++)

26 
wÜd32
 
‹mp
 = 0;

27 
j
 = 0; j < 4; j++)

28 
k
 = 0; k < 4; k++)

29 
‹mp
 ^ğ(
wÜd32
)
gf256
.
	`MuÉly
(
	`GETBYTE
(
š
[
i
], 3-
k
), 
G
[k][
j
]) << ((3-j)*8);

30 
out
[
i
] = 
‹mp
;

32 
	}
}

34 
	#roundkeys
(
i
, 
j
è
m_roundkeys
[(i)*4+(j)]

	)

35 
	#roundkeys4
(
i
è(
m_roundkeys
+(i)*4)

	)

37 
	gSqu¬e
::
Ba£
::
	$UncheckedS‘Key
(cÚ¡ 
by‹
 *
u£rKey
, 
Ëngth
, cÚ¡ 
NameV®uePaœs
 &)

39 
	`As£¹V®idKeyL’gth
(
Ëngth
);

41 cÚ¡ 
wÜd32
 
off£t
[
ROUNDS
] = {

46 
	`G‘U£rKey
(
BIG_ENDIAN_ORDER
, 
m_roundkeys
.
	`d©a
(), 
KEYLENGTH
/4, 
u£rKey
, KEYLENGTH);

49 
i
 = 1; i < 
ROUNDS
+1; i++)

51 
	`roundkeys
(
i
, 0èğroundkeys(i-1, 0è^ 
	`rÙlFixed
Ôoundkeys(i-1, 3), 8Uè^ 
off£t
[i-1];

52 
	`roundkeys
(
i
, 1) =„oundkeys(i-1, 1) ^„oundkeys(i, 0);

53 
	`roundkeys
(
i
, 2) =„oundkeys(i-1, 2) ^„oundkeys(i, 1);

54 
	`roundkeys
(
i
, 3) =„oundkeys(i-1, 3) ^„oundkeys(i, 2);

58 ià(
	`IsFÜw¬dT¿nsfÜm©iÚ
())

60 
i
 = 0; i < 
ROUNDS
; i++)

61 
	`Squ¬eT¿nsfÜm
 (
	`roundkeys4
(
i
),„oundkeys4(i));

65 
i
 = 0; i < 
ROUNDS
/2; i++)

66 
j
 = 0; j < 4; j++)

67 
¡d
::
	`sw­
(
	`roundkeys
(
i
, 
j
),„oundkeys(
ROUNDS
-i, j));

68 
	`Squ¬eT¿nsfÜm
 (
	`roundkeys4
(
ROUNDS
),„oundkeys4(ROUNDS));

70 
	}
}

72 
	#MSB
(
x
è(((xè>> 24è& 0xffUè

	)

73 
	#SSB
(
x
è(((xè>> 16è& 0xffUè

	)

74 
	#TSB
(
x
è(((xè>> 8è& 0xffUè

	)

75 
	#LSB
(
x
è(((xèè& 0xffUè

	)

77 
	#squ¬eRound
(
‹xt
, 
‹mp
, 
T0
, 
T1
, 
T2
, 
T3
, 
roundkey
) \

79 
‹mp
[0] = 
T0
[
	`MSB
 (
‹xt
[0])] \

80 ^ 
T1
[
	`MSB
 (
‹xt
[1])] \

81 ^ 
T2
[
	`MSB
 (
‹xt
[2])] \

82 ^ 
T3
[
	`MSB
 (
‹xt
[3])] \

83 ^ 
roundkey
[0]; \

84 
‹mp
[1] = 
T0
[
	`SSB
 (
‹xt
[0])] \

85 ^ 
T1
[
	`SSB
 (
‹xt
[1])] \

86 ^ 
T2
[
	`SSB
 (
‹xt
[2])] \

87 ^ 
T3
[
	`SSB
 (
‹xt
[3])] \

88 ^ 
roundkey
[1]; \

89 
‹mp
[2] = 
T0
[
	`TSB
 (
‹xt
[0])] \

90 ^ 
T1
[
	`TSB
 (
‹xt
[1])] \

91 ^ 
T2
[
	`TSB
 (
‹xt
[2])] \

92 ^ 
T3
[
	`TSB
 (
‹xt
[3])] \

93 ^ 
roundkey
[2]; \

94 
‹mp
[3] = 
T0
[
	`LSB
 (
‹xt
[0])] \

95 ^ 
T1
[
	`LSB
 (
‹xt
[1])] \

96 ^ 
T2
[
	`LSB
 (
‹xt
[2])] \

97 ^ 
T3
[
	`LSB
 (
‹xt
[3])] \

98 ^ 
roundkey
[3]; \

99 }

	)

101 
	#squ¬eFš®
(
‹xt
, 
‹mp
, 
S
, 
roundkey
) \

103 
‹xt
[0] = ((
wÜd32
è(
S
[
	`MSB
 (
‹mp
[0])]) << 24) \

104 ^ ((
wÜd32
è(
S
[
	`MSB
 (
‹mp
[1])]) << 16) \

105 ^ ((
wÜd32
è(
S
[
	`MSB
 (
‹mp
[2])]) << 8) \

106 ^ (
wÜd32
è(
S
[
	`MSB
 (
‹mp
[3])]) \

107 ^ 
roundkey
[0]; \

108 
‹xt
[1] = ((
wÜd32
è(
S
[
	`SSB
 (
‹mp
[0])]) << 24) \

109 ^ ((
wÜd32
è(
S
[
	`SSB
 (
‹mp
[1])]) << 16) \

110 ^ ((
wÜd32
è(
S
[
	`SSB
 (
‹mp
[2])]) << 8) \

111 ^ (
wÜd32
è(
S
[
	`SSB
 (
‹mp
[3])]) \

112 ^ 
roundkey
[1]; \

113 
‹xt
[2] = ((
wÜd32
è(
S
[
	`TSB
 (
‹mp
[0])]) << 24) \

114 ^ ((
wÜd32
è(
S
[
	`TSB
 (
‹mp
[1])]) << 16) \

115 ^ ((
wÜd32
è(
S
[
	`TSB
 (
‹mp
[2])]) << 8) \

116 ^ (
wÜd32
è(
S
[
	`TSB
 (
‹mp
[3])]) \

117 ^ 
roundkey
[2]; \

118 
‹xt
[3] = ((
wÜd32
è(
S
[
	`LSB
 (
‹mp
[0])]) << 24) \

119 ^ ((
wÜd32
è(
S
[
	`LSB
 (
‹mp
[1])]) << 16) \

120 ^ ((
wÜd32
è(
S
[
	`LSB
 (
‹mp
[2])]) << 8) \

121 ^ (
wÜd32
è(
S
[
	`LSB
 (
‹mp
[3])]) \

122 ^ 
roundkey
[3]; \

123 }

	)

125 
	gBlockG‘AndPut
<
	twÜd32
, 
	tBigEndŸn
> 
	tBlock
;

127 
	gSqu¬e
::
Enc
::
	$ProûssAndXÜBlock
(cÚ¡ 
by‹
 *
šBlock
, cÚ¡ by‹ *
xÜBlock
, by‹ *
outBlock
) const

129 
wÜd32
 
‹xt
[4], 
‹mp
[4];

130 
Block
::
	`G‘
(
šBlock
)(
‹xt
[0])(text[1])(text[2])(text[3]);

133 
‹xt
[0] ^ğ
	`roundkeys
(0, 0);

134 
‹xt
[1] ^ğ
	`roundkeys
(0, 1);

135 
‹xt
[2] ^ğ
	`roundkeys
(0, 2);

136 
‹xt
[3] ^ğ
	`roundkeys
(0, 3);

139 
i
=1; i+1<
ROUNDS
; i+=2)

141 
	`squ¬eRound
 (
‹xt
, 
‹mp
, 
Te
[0], Te[1], Te[2], Te[3], 
	`roundkeys4
(
i
));

142 
	`squ¬eRound
 (
‹mp
, 
‹xt
, 
Te
[0], Te[1], Te[2], Te[3], 
	`roundkeys4
(
i
+1));

144 
	`squ¬eRound
 (
‹xt
, 
‹mp
, 
Te
[0], Te[1], Te[2], Te[3], 
	`roundkeys4
(
ROUNDS
-1));

147 
	`squ¬eFš®
 (
‹xt
, 
‹mp
, 
Se
, 
	`roundkeys4
(
ROUNDS
));

149 
Block
::
	`Put
(
xÜBlock
, 
outBlock
)(
‹xt
[0])(text[1])(text[2])(text[3]);

150 
	}
}

152 
	gSqu¬e
::
Dec
::
	$ProûssAndXÜBlock
(cÚ¡ 
by‹
 *
šBlock
, cÚ¡ by‹ *
xÜBlock
, by‹ *
outBlock
) const

154 
wÜd32
 
‹xt
[4], 
‹mp
[4];

155 
Block
::
	`G‘
(
šBlock
)(
‹xt
[0])(text[1])(text[2])(text[3]);

158 
‹xt
[0] ^ğ
	`roundkeys
(0, 0);

159 
‹xt
[1] ^ğ
	`roundkeys
(0, 1);

160 
‹xt
[2] ^ğ
	`roundkeys
(0, 2);

161 
‹xt
[3] ^ğ
	`roundkeys
(0, 3);

164 
i
=1; i+1<
ROUNDS
; i+=2)

166 
	`squ¬eRound
 (
‹xt
, 
‹mp
, 
Td
[0], Td[1], Td[2], Td[3], 
	`roundkeys4
(
i
));

167 
	`squ¬eRound
 (
‹mp
, 
‹xt
, 
Td
[0], Td[1], Td[2], Td[3], 
	`roundkeys4
(
i
+1));

169 
	`squ¬eRound
 (
‹xt
, 
‹mp
, 
Td
[0], Td[1], Td[2], Td[3], 
	`roundkeys4
(
ROUNDS
-1));

172 
	`squ¬eFš®
 (
‹xt
, 
‹mp
, 
Sd
, 
	`roundkeys4
(
ROUNDS
));

174 
Block
::
	`Put
(
xÜBlock
, 
outBlock
)(
‹xt
[0])(text[1])(text[2])(text[3]);

175 
	}
}

177 
	gNAMESPACE_END


	@square.h

1 #iâdeà
CRYPTOPP_SQUARE_H


2 
	#CRYPTOPP_SQUARE_H


	)

7 
	~"£ckey.h
"

8 
	~"£cblock.h
"

10 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

13 
Squ¬e_Info
 : 
public
 
FixedBlockSize
<16>,…ubliø
FixedKeyL’gth
<16>, 
FixedRounds
<8>

15 cÚ¡ *
	`SticAlgÜ™hmName
() { "Square";}

16 
	}
};

19 
şass
 
	gSqu¬e
 : 
public
 
Squ¬e_Info
,…ubliø
	gBlockCh”Docum’tiÚ


21 
şass
 
CRYPTOPP_NO_VTABLE
 
	gBa£
 : 
public
 
BlockCh”Im¶
<
Squ¬e_Info
>

23 
public
:

24 
UncheckedS‘Key
(cÚ¡ 
by‹
 *
u£rKey
, 
Ëngth
, cÚ¡ 
NameV®uePaœs
 &
·¿ms
);

26 
	g´Ùeùed
:

27 
FixedSizeSecBlock
<
wÜd32
, 4*(
	gROUNDS
+1)> 
	gm_roundkeys
;

30 şas 
	cCRYPTOPP_NO_VTABLE
 
	gEnc
 : 
public
 
Ba£


32 
public
:

33 
ProûssAndXÜBlock
(cÚ¡ 
by‹
 *
šBlock
, cÚ¡ by‹ *
xÜBlock
, by‹ *
outBlock
) const;

34 
	g´iv©e
:

35 cÚ¡ 
by‹
 
Se
[256];

36 cÚ¡ 
wÜd32
 
	gTe
[4][256];

39 şas 
	cCRYPTOPP_NO_VTABLE
 
	gDec
 : 
public
 
Ba£


41 
public
:

42 
ProûssAndXÜBlock
(cÚ¡ 
by‹
 *
šBlock
, cÚ¡ by‹ *
xÜBlock
, by‹ *
outBlock
) const;

43 
	g´iv©e
:

44 cÚ¡ 
by‹
 
Sd
[256];

45 cÚ¡ 
wÜd32
 
	gTd
[4][256];

48 
	gpublic
:

49 
BlockCh”Fš®
<
	tENCRYPTION
, 
	tEnc
> 
	tEnüy±iÚ
;

50 
	gBlockCh”Fš®
<
	tDECRYPTION
, 
	tDec
> 
	tDeüy±iÚ
;

53 
	gSqu¬e
::
	tEnüy±iÚ
 
	tSqu¬eEnüy±iÚ
;

54 
	gSqu¬e
::
	tDeüy±iÚ
 
	tSqu¬eDeüy±iÚ
;

56 
	gNAMESPACE_END


	@squaretb.cpp

1 
	~"pch.h
"

2 
	~"squ¬e.h
"

4 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

6 cÚ¡ 
by‹
 
Squ¬e
::
Enc
::
Se
[256] = {

23 
	}
};

25 cÚ¡ 
by‹
 
	gSqu¬e
::
Dec
::
Sd
[256] = {

44 cÚ¡ 
wÜd32
 
	gSqu¬e
::
Enc
::
Te
[4][256] = {

313 cÚ¡ 
wÜd32
 
	gSqu¬e
::
Dec
::
Td
[4][256] = {

582 
	gNAMESPACE_END


	@stdcpp.h

1 #iâdeà
CRYPTOPP_STDCPP_H


2 
	#CRYPTOPP_STDCPP_H


	)

4 #ià
_MSC_VER
 >= 1500

5 
	#_DO_NOT_DECLARE_INTERLOCKED_INTRINSICS_IN_MEMORY


	)

6 
	~<šŒš.h
>

9 
	~<¡ddef.h
>

10 
	~<as£¹.h
>

11 
	~<lim™s.h
>

12 
	~<¡dlib.h
>

13 
	~<¡ršg.h
>

14 
	~<memÜy
>

15 
	~<¡ršg
>

16 
	~<exû±iÚ
>

17 
	~<ty³šfo
>

18 
	~<®gÜ™hm
>

19 
	~<m­
>

20 
	~<veùÜ
>

22 #ifdeà
CRYPTOPP_INCLUDE_VECTOR_CC


24 
	~<veùÜ.cc
>

28 #ifdeà
__sun


29 
	~<®loÿ.h
>

30 #–ià
defšed
(
__MINGW32__
è|| defšed(
__BORLANDC__
)

31 
	~<m®loc.h
>

34 #ifdeà
_MSC_VER


35 #´agm¨
w¬nšg
(
di§bË
: 4231)

36 #ifdeà
_CRTAPI1


37 
	#CRYPTOPP_MSVCRT6


	)

	@strciphr.cpp

3 
	~"pch.h
"

5 #iâdeà
CRYPTOPP_IMPORTS


7 
	~"¡rchr.h
"

9 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

11 
‹m¶©e
 <
şass
 
S
>

12 
Add™iveCh”Tem¶©e
<
S
>::
	$UncheckedS‘Key
(cÚ¡ 
by‹
 *
key
, 
Ëngth
, cÚ¡ 
NameV®uePaœs
 &
·¿ms
)

14 
PŞicyIÁ”çû
 &
pŞicy
 = 
this
->
	`AcûssPŞicy
();

15 
pŞicy
.
	`Ch”S‘Key
(
·¿ms
, 
key
, 
Ëngth
);

16 
m_ËáOv”
 = 0;

17 
bufãrBy‹Size
 = 
pŞicy
.
	`CªO³¿‹Key¡»am
(è? 
	`G‘BufãrBy‹Size
ÕŞicyè: 
	`RoundUpToMuÉËOf
(1024U, GetBufferByteSize(policy));

18 
m_bufãr
.
	`New
(
bufãrBy‹Size
);

20 ià(
this
->
	`IsResynchrÚizabË
())

22 
size_t
 
ivL’gth
;

23 cÚ¡ 
by‹
 *
iv
 = 
this
->
	`G‘IVAndThrowIfInv®id
(
·¿ms
, 
ivL’gth
);

24 
pŞicy
.
	`Ch”ResynchrÚize
(
m_bufãr
, 
iv
, 
ivL’gth
);

26 
	}
}

28 
	g‹m¶©e
 <
şass
 
	gS
>

29 
	gAdd™iveCh”Tem¶©e
<
	gS
>::
	$G’”©eBlock
(
by‹
 *
outSŒšg
, 
size_t
 
Ëngth
)

31 ià(
m_ËáOv”
 > 0)

33 
size_t
 
Ën
 = 
	`STDMIN
(
m_ËáOv”
, 
Ëngth
);

34 
	`memıy
(
outSŒšg
, 
	`Key¡»amBufãrEnd
()-
m_ËáOv”
, 
Ën
);

35 
Ëngth
 -ğ
Ën
;

36 
m_ËáOv”
 -ğ
Ën
;

37 
outSŒšg
 +ğ
Ën
;

39 ià(!
Ëngth
)

42 
	`as£¹
(
m_ËáOv”
 == 0);

44 
PŞicyIÁ”çû
 &
pŞicy
 = 
this
->
	`AcûssPŞicy
();

45 
by‹sP”I‹¿tiÚ
 = 
pŞicy
.
	`G‘By‹sP”I‹¿tiÚ
();

47 ià(
Ëngth
 >ğ
by‹sP”I‹¿tiÚ
)

49 
size_t
 
™”©iÚs
 = 
Ëngth
 / 
by‹sP”I‹¿tiÚ
;

50 
pŞicy
.
	`Wr™eKey¡»am
(
outSŒšg
, 
™”©iÚs
);

51 
outSŒšg
 +ğ
™”©iÚs
 * 
by‹sP”I‹¿tiÚ
;

52 
Ëngth
 -ğ
™”©iÚs
 * 
by‹sP”I‹¿tiÚ
;

55 ià(
Ëngth
 > 0)

57 
size_t
 
bufãrBy‹Size
 = 
	`RoundUpToMuÉËOf
(
Ëngth
, 
by‹sP”I‹¿tiÚ
);

58 
size_t
 
bufãrI‹¿tiÚs
 = 
bufãrBy‹Size
 / 
by‹sP”I‹¿tiÚ
;

60 
pŞicy
.
	`Wr™eKey¡»am
(
	`Key¡»amBufãrEnd
()-
bufãrBy‹Size
, 
bufãrI‹¿tiÚs
);

61 
	`memıy
(
outSŒšg
, 
	`Key¡»amBufãrEnd
()-
bufãrBy‹Size
, 
Ëngth
);

62 
m_ËáOv”
 = 
bufãrBy‹Size
 - 
Ëngth
;

64 
	}
}

66 
	g‹m¶©e
 <
şass
 
	gS
>

67 
	gAdd™iveCh”Tem¶©e
<
	gS
>::
	$ProûssD©a
(
by‹
 *
outSŒšg
, cÚ¡ by‹ *
šSŒšg
, 
size_t
 
Ëngth
)

69 ià(
m_ËáOv”
 > 0)

71 
size_t
 
Ën
 = 
	`STDMIN
(
m_ËáOv”
, 
Ëngth
);

72 
	`xÜbuf
(
outSŒšg
, 
šSŒšg
, 
	`Key¡»amBufãrEnd
()-
m_ËáOv”
, 
Ën
);

73 
Ëngth
 -ğ
Ën
;

74 
m_ËáOv”
 -ğ
Ën
;

75 
šSŒšg
 +ğ
Ën
;

76 
outSŒšg
 +ğ
Ën
;

78 ià(!
Ëngth
)

81 
	`as£¹
(
m_ËáOv”
 == 0);

83 
PŞicyIÁ”çû
 &
pŞicy
 = 
this
->
	`AcûssPŞicy
();

84 
by‹sP”I‹¿tiÚ
 = 
pŞicy
.
	`G‘By‹sP”I‹¿tiÚ
();

86 ià(
pŞicy
.
	`CªO³¿‹Key¡»am
(è&& 
Ëngth
 >ğ
by‹sP”I‹¿tiÚ
)

88 
size_t
 
™”©iÚs
 = 
Ëngth
 / 
by‹sP”I‹¿tiÚ
;

89 
®ignm’t
 = 
pŞicy
.
	`G‘Alignm’t
();

90 
Key¡»amO³¿tiÚ
 
İ”©iÚ
 = 
	`Key¡»amO³¿tiÚ
((
	`IsAligÃdOn
(
šSŒšg
, 
®ignm’t
è* 2è| ()IsAligÃdOn(
outSŒšg
,‡lignment));

92 
pŞicy
.
	`O³¿‹Key¡»am
(
İ”©iÚ
, 
outSŒšg
, 
šSŒšg
, 
™”©iÚs
);

94 
šSŒšg
 +ğ
™”©iÚs
 * 
by‹sP”I‹¿tiÚ
;

95 
outSŒšg
 +ğ
™”©iÚs
 * 
by‹sP”I‹¿tiÚ
;

96 
Ëngth
 -ğ
™”©iÚs
 * 
by‹sP”I‹¿tiÚ
;

98 ià(!
Ëngth
)

102 
size_t
 
bufãrBy‹Size
 = 
m_bufãr
.
	`size
();

103 
size_t
 
bufãrI‹¿tiÚs
 = 
bufãrBy‹Size
 / 
by‹sP”I‹¿tiÚ
;

105 
Ëngth
 >ğ
bufãrBy‹Size
)

107 
pŞicy
.
	`Wr™eKey¡»am
(
m_bufãr
, 
bufãrI‹¿tiÚs
);

108 
	`xÜbuf
(
outSŒšg
, 
šSŒšg
, 
	`Key¡»amBufãrBegš
(), 
bufãrBy‹Size
);

109 
Ëngth
 -ğ
bufãrBy‹Size
;

110 
šSŒšg
 +ğ
bufãrBy‹Size
;

111 
outSŒšg
 +ğ
bufãrBy‹Size
;

114 ià(
Ëngth
 > 0)

116 
bufãrBy‹Size
 = 
	`RoundUpToMuÉËOf
(
Ëngth
, 
by‹sP”I‹¿tiÚ
);

117 
bufãrI‹¿tiÚs
 = 
bufãrBy‹Size
 / 
by‹sP”I‹¿tiÚ
;

119 
pŞicy
.
	`Wr™eKey¡»am
(
	`Key¡»amBufãrEnd
()-
bufãrBy‹Size
, 
bufãrI‹¿tiÚs
);

120 
	`xÜbuf
(
outSŒšg
, 
šSŒšg
, 
	`Key¡»amBufãrEnd
()-
bufãrBy‹Size
, 
Ëngth
);

121 
m_ËáOv”
 = 
bufãrBy‹Size
 - 
Ëngth
;

123 
	}
}

125 
	g‹m¶©e
 <
şass
 
	gS
>

126 
	gAdd™iveCh”Tem¶©e
<
	gS
>::
	$ResynchrÚize
(cÚ¡ 
by‹
 *
iv
, 
Ëngth
)

128 
PŞicyIÁ”çû
 &
pŞicy
 = 
this
->
	`AcûssPŞicy
();

129 
m_ËáOv”
 = 0;

130 
m_bufãr
.
	`New
(
	`G‘BufãrBy‹Size
(
pŞicy
));

131 
pŞicy
.
	`Ch”ResynchrÚize
(
m_bufãr
, 
iv
, 
this
->
	`ThrowIfInv®idIVL’gth
(
Ëngth
));

132 
	}
}

134 
	g‹m¶©e
 <
şass
 
	gBASE
>

135 
	gAdd™iveCh”Tem¶©e
<
	gBASE
>::
	$S“k
(
lwÜd
 
pos™iÚ
)

137 
PŞicyIÁ”çû
 &
pŞicy
 = 
this
->
	`AcûssPŞicy
();

138 
by‹sP”I‹¿tiÚ
 = 
pŞicy
.
	`G‘By‹sP”I‹¿tiÚ
();

140 
pŞicy
.
	`S“kToI‹¿tiÚ
(
pos™iÚ
 / 
by‹sP”I‹¿tiÚ
);

141 
pos™iÚ
 %ğ
by‹sP”I‹¿tiÚ
;

143 ià(
pos™iÚ
 > 0)

145 
pŞicy
.
	`Wr™eKey¡»am
(
	`Key¡»amBufãrEnd
()-
by‹sP”I‹¿tiÚ
, 1);

146 
m_ËáOv”
 = 
by‹sP”I‹¿tiÚ
 - ()
pos™iÚ
;

149 
m_ËáOv”
 = 0;

150 
	}
}

152 
	g‹m¶©e
 <
şass
 
	gBASE
>

153 
	gCFB_Ch”Tem¶©e
<
	gBASE
>::
	$UncheckedS‘Key
(cÚ¡ 
by‹
 *
key
, 
Ëngth
, cÚ¡ 
NameV®uePaœs
 &
·¿ms
)

155 
PŞicyIÁ”çû
 &
pŞicy
 = 
this
->
	`AcûssPŞicy
();

156 
pŞicy
.
	`Ch”S‘Key
(
·¿ms
, 
key
, 
Ëngth
);

158 ià(
this
->
	`IsResynchrÚizabË
())

160 
size_t
 
ivL’gth
;

161 cÚ¡ 
by‹
 *
iv
 = 
this
->
	`G‘IVAndThrowIfInv®id
(
·¿ms
, 
ivL’gth
);

162 
pŞicy
.
	`Ch”ResynchrÚize
(
iv
, 
ivL’gth
);

165 
m_ËáOv”
 = 
pŞicy
.
	`G‘By‹sP”I‹¿tiÚ
();

166 
	}
}

168 
	g‹m¶©e
 <
şass
 
	gBASE
>

169 
	gCFB_Ch”Tem¶©e
<
	gBASE
>::
	$ResynchrÚize
(cÚ¡ 
by‹
 *
iv
, 
Ëngth
)

171 
PŞicyIÁ”çû
 &
pŞicy
 = 
this
->
	`AcûssPŞicy
();

172 
pŞicy
.
	`Ch”ResynchrÚize
(
iv
, 
this
->
	`ThrowIfInv®idIVL’gth
(
Ëngth
));

173 
m_ËáOv”
 = 
pŞicy
.
	`G‘By‹sP”I‹¿tiÚ
();

174 
	}
}

176 
	g‹m¶©e
 <
şass
 
	gBASE
>

177 
	gCFB_Ch”Tem¶©e
<
	gBASE
>::
	$ProûssD©a
(
by‹
 *
outSŒšg
, cÚ¡ by‹ *
šSŒšg
, 
size_t
 
Ëngth
)

179 
	`as£¹
(
Ëngth
 % 
this
->
	`Mªd©ÜyBlockSize
() == 0);

181 
PŞicyIÁ”çû
 &
pŞicy
 = 
this
->
	`AcûssPŞicy
();

182 
by‹sP”I‹¿tiÚ
 = 
pŞicy
.
	`G‘By‹sP”I‹¿tiÚ
();

183 
®ignm’t
 = 
pŞicy
.
	`G‘Alignm’t
();

184 
by‹
 *
»g
 = 
pŞicy
.
	`G‘Regi¡”Begš
();

186 ià(
m_ËáOv”
)

188 
size_t
 
Ën
 = 
	`STDMIN
(
m_ËáOv”
, 
Ëngth
);

189 
	`CombšeMes§geAndShiáRegi¡”
(
outSŒšg
, 
»g
 + 
by‹sP”I‹¿tiÚ
 - 
m_ËáOv”
, 
šSŒšg
, 
Ën
);

190 
m_ËáOv”
 -ğ
Ën
;

191 
Ëngth
 -ğ
Ën
;

192 
šSŒšg
 +ğ
Ën
;

193 
outSŒšg
 +ğ
Ën
;

196 ià(!
Ëngth
)

199 
	`as£¹
(
m_ËáOv”
 == 0);

201 ià(
pŞicy
.
	`CªI‹¿‹
(è&& 
Ëngth
 >ğ
by‹sP”I‹¿tiÚ
 && 
	`IsAligÃdOn
(
outSŒšg
, 
®ignm’t
))

203 ià(
	`IsAligÃdOn
(
šSŒšg
, 
®ignm’t
))

204 
pŞicy
.
	`I‹¿‹
(
outSŒšg
, 
šSŒšg
, 
	`G‘Ch”Dœ
(*
this
), 
Ëngth
 / 
by‹sP”I‹¿tiÚ
);

207 
	`memıy
(
outSŒšg
, 
šSŒšg
, 
Ëngth
);

208 
pŞicy
.
	`I‹¿‹
(
outSŒšg
, outSŒšg, 
	`G‘Ch”Dœ
(*
this
), 
Ëngth
 / 
by‹sP”I‹¿tiÚ
);

210 
šSŒšg
 +ğ
Ëngth
 -†’gth % 
by‹sP”I‹¿tiÚ
;

211 
outSŒšg
 +ğ
Ëngth
 -†’gth % 
by‹sP”I‹¿tiÚ
;

212 
Ëngth
 %ğ
by‹sP”I‹¿tiÚ
;

215 
Ëngth
 >ğ
by‹sP”I‹¿tiÚ
)

217 
pŞicy
.
	`T¿nsfÜmRegi¡”
();

218 
	`CombšeMes§geAndShiáRegi¡”
(
outSŒšg
, 
»g
, 
šSŒšg
, 
by‹sP”I‹¿tiÚ
);

219 
Ëngth
 -ğ
by‹sP”I‹¿tiÚ
;

220 
šSŒšg
 +ğ
by‹sP”I‹¿tiÚ
;

221 
outSŒšg
 +ğ
by‹sP”I‹¿tiÚ
;

224 ià(
Ëngth
 > 0)

226 
pŞicy
.
	`T¿nsfÜmRegi¡”
();

227 
	`CombšeMes§geAndShiáRegi¡”
(
outSŒšg
, 
»g
, 
šSŒšg
, 
Ëngth
);

228 
m_ËáOv”
 = 
by‹sP”I‹¿tiÚ
 - 
Ëngth
;

230 
	}
}

232 
	g‹m¶©e
 <
şass
 
	gBASE
>

233 
	gCFB_Enüy±iÚTem¶©e
<
	gBASE
>::
	$CombšeMes§geAndShiáRegi¡”
(
by‹
 *
ouut
, by‹ *
»g
, cÚ¡ by‹ *
mes§ge
, 
size_t
 
Ëngth
)

235 
	`xÜbuf
(
»g
, 
mes§ge
, 
Ëngth
);

236 
	`memıy
(
ouut
, 
»g
, 
Ëngth
);

237 
	}
}

239 
	g‹m¶©e
 <
şass
 
	gBASE
>

240 
	gCFB_Deüy±iÚTem¶©e
<
	gBASE
>::
	$CombšeMes§geAndShiáRegi¡”
(
by‹
 *
ouut
, by‹ *
»g
, cÚ¡ by‹ *
mes§ge
, 
size_t
 
Ëngth
)

242 
i
=0; i<
Ëngth
; i++)

244 
by‹
 
b
 = 
mes§ge
[
i
];

245 
ouut
[
i
] = 
»g
[i] ^ 
b
;

246 
»g
[
i
] = 
b
;

248 
	}
}

250 
	gNAMESPACE_END


	@strciphr.h

28 #iâdeà
CRYPTOPP_STRCIPHR_H


29 
	#CRYPTOPP_STRCIPHR_H


	)

31 
	~"£ckey.h
"

32 
	~"£cblock.h
"

33 
	~"¬gÇmes.h
"

35 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

37 
‹m¶©e
 <
şass
 
POLICY_INTERFACE
, cÏs 
BASE
 = 
Em±y
>

38 şas 
	cCRYPTOPP_NO_VTABLE
 
Ab¡¿ùPŞicyHŞd”
 : 
public
 
BASE


40 
public
:

41 
POLICY_INTERFACE
 
	tPŞicyIÁ”çû
;

42 
vœtu®
 ~
	$Ab¡¿ùPŞicyHŞd”
() {}

44 
´Ùeùed
:

45 
vœtu®
 cÚ¡ 
POLICY_INTERFACE
 & 
	$G‘PŞicy
() const =0;

46 
vœtu®
 
POLICY_INTERFACE
 & 
	`AcûssPŞicy
() =0;

47 
	}
};

49 
	g‹m¶©e
 <
şass
 
	gPOLICY
, cÏs 
	gBASE
, cÏs 
	gPOLICY_INTERFACE
 = 
CPP_TYPENAME
 
BASE
::
PŞicyIÁ”çû
>

50 
şass
 
CÚü‘ePŞicyHŞd”
 : 
public
 
BASE
, 
´Ùeùed
 
	gPOLICY


52 
	g´Ùeùed
:

53 cÚ¡ 
POLICY_INTERFACE
 & 
G‘PŞicy
(ècÚ¡ { *
this
;}

54 
	gPOLICY_INTERFACE
 & 
AcûssPŞicy
(è{ *
	gthis
;}

57 
	eKey¡»amO³¿tiÚFÏgs
 {
	mOUTPUT_ALIGNED
=1, 
	mINPUT_ALIGNED
=2, 
	mINPUT_NULL
 = 4};

58 
	eKey¡»amO³¿tiÚ
 {

59 
	mWRITE_KEYSTREAM
 = 
INPUT_NULL
,

60 
	mWRITE_KEYSTREAM_ALIGNED
 = 
INPUT_NULL
 | 
OUTPUT_ALIGNED
,

61 
	mXOR_KEYSTREAM
 = 0,

62 
	mXOR_KEYSTREAM_INPUT_ALIGNED
 = 
INPUT_ALIGNED
,

63 
	mXOR_KEYSTREAM_OUTPUT_ALIGNED
ğ
OUTPUT_ALIGNED
,

64 
	mXOR_KEYSTREAM_BOTH_ALIGNED
 = 
OUTPUT_ALIGNED
 | 
INPUT_ALIGNED
};

66 
CRYPTOPP_DLL
 
CRYPTOPP_NO_VTABLE
 
	gAdd™iveCh”Ab¡¿ùPŞicy


68 
	gvœtu®
 ~
Add™iveCh”Ab¡¿ùPŞicy
() {}

69 
vœtu®
 
G‘Alignm’t
() const { 1;}

70 
vœtu®
 
G‘By‹sP”I‹¿tiÚ
() const =0;

71 
vœtu®
 
G‘O±im®BlockSize
(ècÚ¡ { 
G‘By‹sP”I‹¿tiÚ
();}

72 
vœtu®
 
G‘I‹¿tiÚsToBufãr
() const =0;

73 
vœtu®
 
Wr™eKey¡»am
(
by‹
 *
key¡»am
, 
size_t
 
™”©iÚCouÁ
)

74 {
O³¿‹Key¡»am
(
Key¡»amO³¿tiÚ
(
INPUT_NULL
 | (
Key¡»amO³¿tiÚFÏgs
)
IsAligÃdOn
(
key¡»am
, 
G‘Alignm’t
())), key¡»am, 
NULL
, 
™”©iÚCouÁ
);}

75 
vœtu®
 
boŞ
 
CªO³¿‹Key¡»am
(ècÚ¡ { 
	gçl£
;}

76 
vœtu®
 
O³¿‹Key¡»am
(
Key¡»amO³¿tiÚ
 
İ”©iÚ
, 
by‹
 *
ouut
, cÚ¡ by‹ *
šput
, 
size_t
 
™”©iÚCouÁ
è{
as£¹
(
çl£
);}

77 
vœtu®
 
Ch”S‘Key
(cÚ¡ 
NameV®uePaœs
 &
·¿ms
, cÚ¡ 
by‹
 *
key
, 
size_t
 
Ëngth
) =0;

78 
vœtu®
 
Ch”ResynchrÚize
(
by‹
 *
key¡»amBufãr
, cÚ¡ by‹ *
iv
, 
size_t
 
Ëngth
è{
throw
 
NÙIm¶em’‹d
("SimpleKeyingInterface:his object doesn't support„esynchronization");}

79 
vœtu®
 
boŞ
 
Ch”IsRªdomAcûss
() const =0;

80 
vœtu®
 
S“kToI‹¿tiÚ
(
lwÜd
 
™”©iÚCouÁ
è{
as£¹
(!
Ch”IsRªdomAcûss
()); 
throw
 
NÙIm¶em’‹d
("StreamTransformation:his object doesn't support„andom‡ccess");}

83 
	g‹m¶©e
 <
ty³Çme
 
	gWT
, 
	gW
, 
	gX
 = 1, 
şass
 
	gBASE
 = 
Add™iveCh”Ab¡¿ùPŞicy
>

84 
CRYPTOPP_NO_VTABLE
 
Add™iveCh”CÚü‘ePŞicy
 : 
public
 
BASE


86 
WT
 
	tWÜdTy³
;

87 
CRYPTOPP_CONSTANT
(
BYTES_PER_ITERATION
 = (
WÜdTy³
è* 
W
)

89 #ià!(
CRYPTOPP_BOOL_X86
 || 
CRYPTOPP_BOOL_X64
)

90 
G‘Alignm’t
(ècÚ¡ { 
G‘Alignm’tOf
<
WÜdTy³
>();}

92 
G‘By‹sP”I‹¿tiÚ
(ècÚ¡ { 
	gBYTES_PER_ITERATION
;}

93 
G‘I‹¿tiÚsToBufãr
(ècÚ¡ { 
	gX
;}

94 
boŞ
 
CªO³¿‹Key¡»am
(ècÚ¡ { 
	gŒue
;}

95 
vœtu®
 
O³¿‹Key¡»am
(
Key¡»amO³¿tiÚ
 
İ”©iÚ
, 
by‹
 *
ouut
, cÚ¡ by‹ *
šput
, 
size_t
 
™”©iÚCouÁ
) =0;

99 
	#CRYPTOPP_KEYSTREAM_OUTPUT_WORD
(
x
, 
b
, 
i
, 
a
) \

100 
	`PutWÜd
(
	`boŞ
(
x
 & 
OUTPUT_ALIGNED
), 
b
, 
ouut
+
i
*(
WÜdTy³
), (x & 
INPUT_NULL
è? 
a
 :‡ ^ 
G‘WÜd
<WÜdTy³>(boŞ(x & 
INPUT_ALIGNED
), b, 
šput
+i*(WÜdTy³)));

	)

101 
	#CRYPTOPP_KEYSTREAM_OUTPUT_XMM
(
x
, 
i
, 
a
) {\

102 
__m128i
 
t
 = (
x
 & 
INPUT_NULL
è? 
a
 : 
	`_mm_xÜ_si128
×, (x & 
INPUT_ALIGNED
è? 
	`_mm_lßd_si128
((__m128˜*)
šput
+
i
è: 
	`_mm_lßdu_si128
((__m128i *)input+i));\

103 ià(
x
 & 
OUTPUT_ALIGNED
è
	`_mm_¡Üe_si128
((
__m128i
 *)
ouut
+
i
, 
t
);\

104 
	`_mm_¡Üeu_si128
((
__m128i
 *)
ouut
+
i
, 
t
);}

	)

105 
	#CRYPTOPP_KEYSTREAM_OUTPUT_SWITCH
(
x
, 
y
) \

106 
İ”©iÚ
) \

108 
WRITE_KEYSTREAM
: \

109 
	`x
(
WRITE_KEYSTREAM
) \

111 
XOR_KEYSTREAM
: \

112 
	`x
(
XOR_KEYSTREAM
) \

113 
šput
 +ğ
y
; \

115 
XOR_KEYSTREAM_INPUT_ALIGNED
: \

116 
	`x
(
XOR_KEYSTREAM_INPUT_ALIGNED
) \

117 
šput
 +ğ
y
; \

119 
XOR_KEYSTREAM_OUTPUT_ALIGNED
: \

120 
	`x
(
XOR_KEYSTREAM_OUTPUT_ALIGNED
) \

121 
šput
 +ğ
y
; \

123 
WRITE_KEYSTREAM_ALIGNED
: \

124 
	`x
(
WRITE_KEYSTREAM_ALIGNED
) \

126 
XOR_KEYSTREAM_BOTH_ALIGNED
: \

127 
	`x
(
XOR_KEYSTREAM_BOTH_ALIGNED
) \

128 
šput
 +ğ
y
; \

131 
ouut
 +ğ
y
;

	)

133 
	g‹m¶©e
 <
şass
 
	gBASE
 = 
Ab¡¿ùPŞicyHŞd”
<
Add™iveCh”Ab¡¿ùPŞicy
, 
	gSymm‘ricCh”
> >

134 
şass
 
CRYPTOPP_NO_VTABLE
 
	gAdd™iveCh”Tem¶©e
 : 
public
 
BASE
,…ubliø
	gRªdomNumb”G’”©Ü


136 
	gpublic
:

137 
G’”©eBlock
(
by‹
 *
ouut
, 
size_t
 
size
);

138 
ProûssD©a
(
by‹
 *
outSŒšg
, cÚ¡ by‹ *
šSŒšg
, 
size_t
 
Ëngth
);

139 
ResynchrÚize
(cÚ¡ 
by‹
 *
iv
, 
Ëngth
=-1);

140 
O±im®BlockSize
(ècÚ¡ { 
	gthis
->
G‘PŞicy
().
G‘O±im®BlockSize
();}

141 
G‘O±im®NextBlockSize
(ècÚ¡ { ()
	gthis
->
	gm_ËáOv”
;}

142 
O±im®D©aAlignm’t
(ècÚ¡ { 
	gthis
->
G‘PŞicy
().
G‘Alignm’t
();}

143 
boŞ
 
IsS–fInv”tšg
(ècÚ¡ { 
	gŒue
;}

144 
boŞ
 
IsFÜw¬dT¿nsfÜm©iÚ
(ècÚ¡ { 
	gŒue
;}

145 
boŞ
 
IsRªdomAcûss
(ècÚ¡ { 
	gthis
->
G‘PŞicy
().
Ch”IsRªdomAcûss
();}

146 
S“k
(
lwÜd
 
pos™iÚ
);

148 
ty³Çme
 
	tBASE
::
	tPŞicyIÁ”çû
 PolicyInterface;

150 
	g´Ùeùed
:

151 
UncheckedS‘Key
(cÚ¡ 
by‹
 *
key
, 
Ëngth
, cÚ¡ 
NameV®uePaœs
 &
·¿ms
);

153 
G‘BufãrBy‹Size
(cÚ¡ 
PŞicyIÁ”çû
 &
pŞicy
ècÚ¡ { 
	gpŞicy
.
G‘By‹sP”I‹¿tiÚ
(è*…Şicy.
G‘I‹¿tiÚsToBufãr
();}

155 
šlše
 
by‹
 * 
Key¡»amBufãrBegš
(è{ 
	gthis
->
	gm_bufãr
.
d©a
();}

156 
šlše
 
by‹
 * 
Key¡»amBufãrEnd
(è{ (
	gthis
->
	gm_bufãr
.
d©a
(è+his->m_bufãr.
size
());}

158 
SecBy‹Block
 
	gm_bufãr
;

159 
size_t
 
	gm_ËáOv”
;

162 şas 
	cCRYPTOPP_DLL
 
CRYPTOPP_NO_VTABLE
 
	mCFB_Ch”Ab¡¿ùPŞicy


164 
	mpublic
:

165 
vœtu®
 ~
	$CFB_Ch”Ab¡¿ùPŞicy
() {}

166 
vœtu®
 
	$G‘Alignm’t
() const =0;

167 
vœtu®
 
	$G‘By‹sP”I‹¿tiÚ
() const =0;

168 
vœtu®
 
by‹
 * 
	`G‘Regi¡”Begš
() =0;

169 
vœtu®
 
	`T¿nsfÜmRegi¡”
() =0;

170 
vœtu®
 
boŞ
 
	$CªI‹¿‹
(ècÚ¡ { 
çl£
;
	}
}

171 
vœtu®
 
	$I‹¿‹
(
by‹
 *
ouut
, cÚ¡ by‹ *
šput
, 
Ch”Dœ
 
dœ
, 
size_t
 
™”©iÚCouÁ
è{
	`as£¹
(
çl£
); 
throw
 0;
	}
}

172 
vœtu®
 
Ch”S‘Key
(cÚ¡ 
NameV®uePaœs
 &
·¿ms
, cÚ¡ 
by‹
 *
key
, 
size_t
 
Ëngth
) =0;

173 
vœtu®
 
	$Ch”ResynchrÚize
(cÚ¡ 
by‹
 *
iv
, 
size_t
 
Ëngth
è{
throw
 
	`NÙIm¶em’‹d
("Sim¶eKeyšgIÁ”çû:hi objeù dÛ¢'ˆsuµÜˆ»synchrÚiz©iÚ");
	}
}

176 
	g‹m¶©e
 <
ty³Çme
 
	gWT
, 
	gW
, 
şass
 
	gBASE
 = 
CFB_Ch”Ab¡¿ùPŞicy
>

177 
CRYPTOPP_NO_VTABLE
 
CFB_Ch”CÚü‘ePŞicy
 : 
public
 
BASE


179 
WT
 
	tWÜdTy³
;

181 
G‘Alignm’t
(ècÚ¡ { (
	gWÜdTy³
);}

182 
G‘By‹sP”I‹¿tiÚ
(ècÚ¡ { (
	gWÜdTy³
è* 
	gW
;}

183 
boŞ
 
CªI‹¿‹
(ècÚ¡ { 
	gŒue
;}

184 
T¿nsfÜmRegi¡”
(è{
	gthis
->
I‹¿‹
(
NULL
, NULL, 
ENCRYPTION
, 1);}

186 
	g‹m¶©e
 <
şass
 
	gB
>

187 
	sRegi¡”Ouut


189 
Regi¡”Ouut
(
by‹
 *
ouut
, cÚ¡ by‹ *
šput
, 
Ch”Dœ
 
dœ
)

190 : 
m_ouut
(
ouut
), 
m_šput
(
šput
), 
m_dœ
(
dœ
) {}

192 
šlše
 
	gRegi¡”Ouut
& 
İ”©Ü
()(
	gWÜdTy³
 &
	g»gi¡”WÜd
)

194 
as£¹
(
IsAligÃd
<
WÜdTy³
>(
m_ouut
));

195 
as£¹
(
IsAligÃd
<
WÜdTy³
>(
m_šput
));

197 ià(!
N©iveBy‹Ord”Is
(
B
::
ToEnum
()))

198 
»gi¡”WÜd
 = 
By‹Rev”£
(registerWord);

200 ià(
	gm_dœ
 =ğ
ENCRYPTION
)

202 ià(
m_šput
 =ğ
NULL
)

203 
as£¹
(
m_ouut
 =ğ
NULL
);

206 
WÜdTy³
 
	gù
 = *(cÚ¡ WÜdTy³ *)
m_šput
 ^ 
»gi¡”WÜd
;

207 
	g»gi¡”WÜd
 = 
ù
;

208 *(
	gWÜdTy³
*)
	gm_ouut
 = 
ù
;

209 
	gm_šput
 +ğ(
WÜdTy³
);

210 
	gm_ouut
 +ğ(
WÜdTy³
);

215 
WÜdTy³
 
	gù
 = *(cÚ¡ WÜdTy³ *)
m_šput
;

216 *(
	gWÜdTy³
*)
	gm_ouut
 = 
»gi¡”WÜd
 ^ 
ù
;

217 
	g»gi¡”WÜd
 = 
ù
;

218 
	gm_šput
 +ğ(
WÜdTy³
);

219 
	gm_ouut
 +ğ(
WÜdTy³
);

224  *
	gthis
;

227 
by‹
 *
	gm_ouut
;

228 cÚ¡ 
by‹
 *
	gm_šput
;

229 
Ch”Dœ
 
	gm_dœ
;

233 
	g‹m¶©e
 <
şass
 
	gBASE
>

234 şas 
	cCRYPTOPP_NO_VTABLE
 
	mCFB_Ch”Tem¶©e
 : 
public
 
BASE


236 
public
:

237 
ProûssD©a
(
by‹
 *
outSŒšg
, cÚ¡ by‹ *
šSŒšg
, 
size_t
 
Ëngth
);

238 
ResynchrÚize
(cÚ¡ 
by‹
 *
iv
, 
Ëngth
=-1);

239 
	$O±im®BlockSize
(ècÚ¡ { 
this
->
	`G‘PŞicy
().
	`G‘By‹sP”I‹¿tiÚ
();}

240 
	$G‘O±im®NextBlockSize
(ècÚ¡ { ()
m_ËáOv”
;
	}
}

241 
	$O±im®D©aAlignm’t
(ècÚ¡ { 
this
->
	`G‘PŞicy
().
	`G‘Alignm’t
();
	}
}

242 
boŞ
 
	$IsRªdomAcûss
(ècÚ¡ { 
çl£
;
	}
}

243 
boŞ
 
	$IsS–fInv”tšg
(ècÚ¡ { 
çl£
;
	}
}

245 
ty³Çme
 
	tBASE
::
	tPŞicyIÁ”çû
 PolicyInterface;

247 
	g´Ùeùed
:

248 
vœtu®
 
CombšeMes§geAndShiáRegi¡”
(
by‹
 *
ouut
, by‹ *
»g
, cÚ¡ by‹ *
mes§ge
, 
size_t
 
Ëngth
) =0;

250 
UncheckedS‘Key
(cÚ¡ 
by‹
 *
key
, 
Ëngth
, cÚ¡ 
NameV®uePaœs
 &
·¿ms
);

252 
size_t
 
	gm_ËáOv”
;

255 
	g‹m¶©e
 <
şass
 
	gBASE
 = 
Ab¡¿ùPŞicyHŞd”
<
CFB_Ch”Ab¡¿ùPŞicy
, 
	gSymm‘ricCh”
> >

256 
şass
 
CRYPTOPP_NO_VTABLE
 
	gCFB_Enüy±iÚTem¶©e
 : 
public
 
CFB_Ch”Tem¶©e
<
BASE
>

258 
boŞ
 
IsFÜw¬dT¿nsfÜm©iÚ
(ècÚ¡ { 
Œue
;}

259 
CombšeMes§geAndShiáRegi¡”
(
by‹
 *
ouut
, by‹ *
»g
, cÚ¡ by‹ *
mes§ge
, 
size_t
 
Ëngth
);

262 
	g‹m¶©e
 <
şass
 
	gBASE
 = 
Ab¡¿ùPŞicyHŞd”
<
CFB_Ch”Ab¡¿ùPŞicy
, 
	gSymm‘ricCh”
> >

263 
şass
 
CRYPTOPP_NO_VTABLE
 
	gCFB_Deüy±iÚTem¶©e
 : 
public
 
CFB_Ch”Tem¶©e
<
BASE
>

265 
boŞ
 
IsFÜw¬dT¿nsfÜm©iÚ
(ècÚ¡ { 
çl£
;}

266 
CombšeMes§geAndShiáRegi¡”
(
by‹
 *
ouut
, by‹ *
»g
, cÚ¡ by‹ *
mes§ge
, 
size_t
 
Ëngth
);

269 
	g‹m¶©e
 <
şass
 
	gBASE
>

270 şas 
	cCFB_RequœeFuÎD©aBlocks
 : 
public
 
BASE


272 
public
:

273 
	$Mªd©ÜyBlockSize
(ècÚ¡ { 
this
->
	`O±im®BlockSize
();}

274 
	}
};

277 
	g‹m¶©e
 <
şass
 
	gBASE
, cÏs 
	gINFO
 = 
BASE
>

278 
şass
 
Symm‘ricCh”Fš®
 : 
public
 
AlgÜ™hmIm¶
<
Sim¶eKeyšgIÁ”çûIm¶
<
BASE
, 
	gINFO
>, INFO>

280 
	gpublic
:

281 
Symm‘ricCh”Fš®
() {}

282 
Symm‘ricCh”Fš®
(cÚ¡ 
by‹
 *
key
)

283 {
this
->
S‘Key
(
key
,his->
DEFAULT_KEYLENGTH
);}

284 
Symm‘ricCh”Fš®
(cÚ¡ 
by‹
 *
key
, 
size_t
 
Ëngth
)

285 {
	gthis
->
S‘Key
(
key
, 
Ëngth
);}

286 
Symm‘ricCh”Fš®
(cÚ¡ 
by‹
 *
key
, 
size_t
 
Ëngth
, cÚ¡ by‹ *
iv
)

287 {
	gthis
->
S‘KeyW™hIV
(
key
, 
Ëngth
, 
iv
);}

289 
ClÚabË
 * 
ClÚe
(ècÚ¡ { 
	g¡©ic_ÿ¡
<
	gSymm‘ricCh”
 *>(
Ãw
 
	gSymm‘ricCh”Fš®
<
	gBASE
, 
	gINFO
>(*
	gthis
));}

292 
	gNAMESPACE_END


294 #ifdeà
CRYPTOPP_MANUALLY_INSTANTIATE_TEMPLATES


295 
	~"¡rchr.ıp
"

298 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

299 
CRYPTOPP_DLL_TEMPLATE_CLASS
 
Ab¡¿ùPŞicyHŞd”
<
Add™iveCh”Ab¡¿ùPŞicy
, 
Symm‘ricCh”
>;

300 
CRYPTOPP_DLL_TEMPLATE_CLASS
 
Add™iveCh”Tem¶©e
<
Ab¡¿ùPŞicyHŞd”
<
Add™iveCh”Ab¡¿ùPŞicy
, 
Symm‘ricCh”
> >;

301 
CRYPTOPP_DLL_TEMPLATE_CLASS
 
CFB_Ch”Tem¶©e
<
Ab¡¿ùPŞicyHŞd”
<
CFB_Ch”Ab¡¿ùPŞicy
, 
Symm‘ricCh”
> >;

302 
CRYPTOPP_DLL_TEMPLATE_CLASS
 
CFB_Enüy±iÚTem¶©e
<
Ab¡¿ùPŞicyHŞd”
<
CFB_Ch”Ab¡¿ùPŞicy
, 
Symm‘ricCh”
> >;

303 
CRYPTOPP_DLL_TEMPLATE_CLASS
 
CFB_Deüy±iÚTem¶©e
<
Ab¡¿ùPŞicyHŞd”
<
CFB_Ch”Ab¡¿ùPŞicy
, 
Symm‘ricCh”
> >;

304 
NAMESPACE_END


	@tea.cpp

3 
	~"pch.h
"

4 
	~"‹a.h
"

5 
	~"misc.h
"

7 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

9 cÚ¡ 
wÜd32
 
DELTA
 = 0x9e3779b9;

10 
BlockG‘AndPut
<
	twÜd32
, 
	tBigEndŸn
> 
	tBlock
;

12 
TEA
::
Ba£
::
	$UncheckedS‘Key
(cÚ¡ 
by‹
 *
u£rKey
, 
Ëngth
, cÚ¡ 
NameV®uePaœs
 &
·¿ms
)

14 
	`As£¹V®idKeyL’gth
(
Ëngth
);

16 
	`G‘U£rKey
(
BIG_ENDIAN_ORDER
, 
m_k
.
	`begš
(), 4, 
u£rKey
, 
KEYLENGTH
);

17 
m_lim™
 = 
	`G‘RoundsAndThrowIfInv®id
(
·¿ms
, 
this
è* 
DELTA
;

18 
	}
}

20 
	gTEA
::
Enc
::
	$ProûssAndXÜBlock
(cÚ¡ 
by‹
 *
šBlock
, cÚ¡ by‹ *
xÜBlock
, by‹ *
outBlock
) const

22 
wÜd32
 
y
, 
z
;

23 
Block
::
	`G‘
(
šBlock
)(
y
)(
z
);

25 
wÜd32
 
sum
 = 0;

26 
sum
 !ğ
m_lim™
)

28 
sum
 +ğ
DELTA
;

29 
y
 +ğ(
z
 << 4è+ 
m_k
[0] ^ z + 
sum
 ^ (z >> 5) + m_k[1];

30 
z
 +ğ(
y
 << 4è+ 
m_k
[2] ^ y + 
sum
 ^ (y >> 5) + m_k[3];

33 
Block
::
	`Put
(
xÜBlock
, 
outBlock
)(
y
)(
z
);

34 
	}
}

36 
	gTEA
::
Dec
::
	$ProûssAndXÜBlock
(cÚ¡ 
by‹
 *
šBlock
, cÚ¡ by‹ *
xÜBlock
, by‹ *
outBlock
) const

38 
wÜd32
 
y
, 
z
;

39 
Block
::
	`G‘
(
šBlock
)(
y
)(
z
);

41 
wÜd32
 
sum
 = 
m_lim™
;

42 
sum
 != 0)

44 
z
 -ğ(
y
 << 4è+ 
m_k
[2] ^ y + 
sum
 ^ (y >> 5) + m_k[3];

45 
y
 -ğ(
z
 << 4è+ 
m_k
[0] ^ z + 
sum
 ^ (z >> 5) + m_k[1];

46 
sum
 -ğ
DELTA
;

49 
Block
::
	`Put
(
xÜBlock
, 
outBlock
)(
y
)(
z
);

50 
	}
}

52 
	gXTEA
::
Ba£
::
	$UncheckedS‘Key
(cÚ¡ 
by‹
 *
u£rKey
, 
Ëngth
, cÚ¡ 
NameV®uePaœs
 &
·¿ms
)

54 
	`As£¹V®idKeyL’gth
(
Ëngth
);

56 
	`G‘U£rKey
(
BIG_ENDIAN_ORDER
, 
m_k
.
	`begš
(), 4, 
u£rKey
, 
KEYLENGTH
);

57 
m_lim™
 = 
	`G‘RoundsAndThrowIfInv®id
(
·¿ms
, 
this
è* 
DELTA
;

58 
	}
}

60 
	gXTEA
::
Enc
::
	$ProûssAndXÜBlock
(cÚ¡ 
by‹
 *
šBlock
, cÚ¡ by‹ *
xÜBlock
, by‹ *
outBlock
) const

62 
wÜd32
 
y
, 
z
;

63 
Block
::
	`G‘
(
šBlock
)(
y
)(
z
);

65 #ifdeà
__SUNPRO_CC


67 
size_t
 
sum
 = 0;

68 (
sum
&0xffffffffè!ğ
m_lim™
)

70 
wÜd32
 
sum
 = 0;

71 
sum
 !ğ
m_lim™
)

74 
y
 +ğ(
z
<<4 ^ z>>5è+ z ^ 
sum
 + 
m_k
[sum&3];

75 
sum
 +ğ
DELTA
;

76 
z
 +ğ(
y
<<4 ^ y>>5è+ y ^ 
sum
 + 
m_k
[sum>>11 & 3];

79 
Block
::
	`Put
(
xÜBlock
, 
outBlock
)(
y
)(
z
);

80 
	}
}

82 
	gXTEA
::
Dec
::
	$ProûssAndXÜBlock
(cÚ¡ 
by‹
 *
šBlock
, cÚ¡ by‹ *
xÜBlock
, by‹ *
outBlock
) const

84 
wÜd32
 
y
, 
z
;

85 
Block
::
	`G‘
(
šBlock
)(
y
)(
z
);

87 #ifdeà
__SUNPRO_CC


89 
size_t
 
sum
 = 
m_lim™
;

90 (
sum
&0xffffffff) != 0)

92 
wÜd32
 
sum
 = 
m_lim™
;

93 
sum
 != 0)

96 
z
 -ğ(
y
<<4 ^ y>>5è+ y ^ 
sum
 + 
m_k
[sum>>11 & 3];

97 
sum
 -ğ
DELTA
;

98 
y
 -ğ(
z
<<4 ^ z>>5è+ z ^ 
sum
 + 
m_k
[sum&3];

101 
Block
::
	`Put
(
xÜBlock
, 
outBlock
)(
y
)(
z
);

102 
	}
}

104 
	#MX
 (
z
>>5^
y
<<2)+(y>>3^z<<4)^(
sum
^y)+(
m_k
[
p
&3^
e
]^z)

	)

106 
	gBTEA
::
Enc
::
	$ProûssAndXÜBlock
(cÚ¡ 
by‹
 *
šBlock
, cÚ¡ by‹ *
xÜBlock
, by‹ *
outBlock
) const

108 
n
 = 
m_blockSize
 / 4;

109 
wÜd32
 *
v
 = (wÜd32*)
outBlock
;

110 
	`CÚd™iÚ®By‹Rev”£
(
BIG_ENDIAN_ORDER
, 
v
, (cÚ¡ 
wÜd32
*)
šBlock
, 
m_blockSize
);

112 
wÜd32
 
y
 = 
v
[0], 
z
 = v[
n
-1], 
e
;

113 
wÜd32
 
p
, 
q
 = 6+52/
n
;

114 
wÜd32
 
sum
 = 0;

116 
q
-- > 0)

118 
sum
 +ğ
DELTA
;

119 
e
 = 
sum
>>2 & 3;

120 
p
 = 0;… < 
n
-1;…++)

122 
y
 = 
v
[
p
+1];

123 
z
 = 
v
[
p
] +ğ
MX
;

125 
y
 = 
v
[0];

126 
z
 = 
v
[
n
-1] +ğ
MX
;

129 
	`CÚd™iÚ®By‹Rev”£
(
BIG_ENDIAN_ORDER
, 
v
, v, 
m_blockSize
);

130 
	}
}

132 
	gBTEA
::
Dec
::
	$ProûssAndXÜBlock
(cÚ¡ 
by‹
 *
šBlock
, cÚ¡ by‹ *
xÜBlock
, by‹ *
outBlock
) const

134 
n
 = 
m_blockSize
 / 4;

135 
wÜd32
 *
v
 = (wÜd32*)
outBlock
;

136 
	`CÚd™iÚ®By‹Rev”£
(
BIG_ENDIAN_ORDER
, 
v
, (cÚ¡ 
wÜd32
*)
šBlock
, 
m_blockSize
);

138 
wÜd32
 
y
 = 
v
[0], 
z
 = v[
n
-1], 
e
;

139 
wÜd32
 
p
, 
q
 = 6+52/
n
;

140 
wÜd32
 
sum
 = 
q
 * 
DELTA
;

142 
sum
 != 0)

144 
e
 = 
sum
>>2 & 3;

145 
p
 = 
n
-1;… > 0;…--)

147 
z
 = 
v
[
p
-1];

148 
y
 = 
v
[
p
] -ğ
MX
;

151 
z
 = 
v
[
n
-1];

152 
y
 = 
v
[0] -ğ
MX
;

153 
sum
 -ğ
DELTA
;

156 
	`CÚd™iÚ®By‹Rev”£
(
BIG_ENDIAN_ORDER
, 
v
, v, 
m_blockSize
);

157 
	}
}

159 
	gNAMESPACE_END


	@tea.h

1 #iâdeà
CRYPTOPP_TEA_H


2 
	#CRYPTOPP_TEA_H


	)

7 
	~"£ckey.h
"

8 
	~"£cblock.h
"

10 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

13 
TEA_Info
 : 
public
 
FixedBlockSize
<8>,…ubliø
FixedKeyL’gth
<16>,…ubliø
V¬ŸbËRounds
<32>

15 cÚ¡ *
	`SticAlgÜ™hmName
() { "TEA";}

16 
	}
};

19 
şass
 
	gTEA
 : 
public
 
TEA_Info
,…ubliø
	gBlockCh”Docum’tiÚ


21 
şass
 
CRYPTOPP_NO_VTABLE
 
	gBa£
 : 
public
 
BlockCh”Im¶
<
TEA_Info
>

23 
public
:

24 
UncheckedS‘Key
(cÚ¡ 
by‹
 *
u£rKey
, 
Ëngth
, cÚ¡ 
NameV®uePaœs
 &
·¿ms
);

26 
	g´Ùeùed
:

27 
FixedSizeSecBlock
<
wÜd32
, 4> 
	gm_k
;

28 
wÜd32
 
	gm_lim™
;

31 şas 
	cCRYPTOPP_NO_VTABLE
 
	gEnc
 : 
public
 
Ba£


33 
public
:

34 
ProûssAndXÜBlock
(cÚ¡ 
by‹
 *
šBlock
, cÚ¡ by‹ *
xÜBlock
, by‹ *
outBlock
) const;

37 şas 
	cCRYPTOPP_NO_VTABLE
 
	gDec
 : 
public
 
Ba£


39 
public
:

40 
ProûssAndXÜBlock
(cÚ¡ 
by‹
 *
šBlock
, cÚ¡ by‹ *
xÜBlock
, by‹ *
outBlock
) const;

43 
	gpublic
:

44 
BlockCh”Fš®
<
	tENCRYPTION
, 
	tEnc
> 
	tEnüy±iÚ
;

45 
	gBlockCh”Fš®
<
	tDECRYPTION
, 
	tDec
> 
	tDeüy±iÚ
;

48 
	gTEA
::
	tEnüy±iÚ
 
	tTEAEnüy±iÚ
;

49 
	gTEA
::
	tDeüy±iÚ
 
	tTEADeüy±iÚ
;

52 
	gXTEA_Info
 : 
public
 
FixedBlockSize
<8>,…ubliø
	gFixedKeyL’gth
<16>,…ubliø
	gV¬ŸbËRounds
<32>

54 cÚ¡ *
SticAlgÜ™hmName
() { "XTEA";}

58 
şass
 
	gXTEA
 : 
public
 
XTEA_Info
,…ubliø
	gBlockCh”Docum’tiÚ


60 
şass
 
CRYPTOPP_NO_VTABLE
 
	gBa£
 : 
public
 
BlockCh”Im¶
<
XTEA_Info
>

62 
public
:

63 
UncheckedS‘Key
(cÚ¡ 
by‹
 *
u£rKey
, 
Ëngth
, cÚ¡ 
NameV®uePaœs
 &
·¿ms
);

65 
	g´Ùeùed
:

66 
FixedSizeSecBlock
<
wÜd32
, 4> 
	gm_k
;

67 
wÜd32
 
	gm_lim™
;

70 şas 
	cCRYPTOPP_NO_VTABLE
 
	gEnc
 : 
public
 
Ba£


72 
public
:

73 
ProûssAndXÜBlock
(cÚ¡ 
by‹
 *
šBlock
, cÚ¡ by‹ *
xÜBlock
, by‹ *
outBlock
) const;

76 şas 
	cCRYPTOPP_NO_VTABLE
 
	gDec
 : 
public
 
Ba£


78 
public
:

79 
ProûssAndXÜBlock
(cÚ¡ 
by‹
 *
šBlock
, cÚ¡ by‹ *
xÜBlock
, by‹ *
outBlock
) const;

82 
	gpublic
:

83 
BlockCh”Fš®
<
	tENCRYPTION
, 
	tEnc
> 
	tEnüy±iÚ
;

84 
	gBlockCh”Fš®
<
	tDECRYPTION
, 
	tDec
> 
	tDeüy±iÚ
;

88 
	gBTEA_Info
 : 
public
 
FixedKeyL’gth
<16>

90 cÚ¡ *
SticAlgÜ™hmName
() { "BTEA";}

95 
şass
 
	gBTEA
 : 
public
 
BTEA_Info
,…ubliø
	gBlockCh”Docum’tiÚ


97 
şass
 
CRYPTOPP_NO_VTABLE
 
	gBa£
 : 
public
 
AlgÜ™hmIm¶
<
Sim¶eKeyšgIÁ”çûIm¶
<
BlockCh”
, 
	gBTEA_Info
>, BTEA_Info>,…ublic BTEA_Info

99 
	gpublic
:

100 
UncheckedS‘Key
(cÚ¡ 
by‹
 *
key
, 
Ëngth
, cÚ¡ 
NameV®uePaœs
 &
·¿ms
)

102 
	gm_blockSize
 = 
·¿ms
.
G‘IÁV®ueW™hDeçuÉ
("BlockSize", 60*4);

103 
G‘U£rKey
(
BIG_ENDIAN_ORDER
, 
m_k
.
begš
(), 4, 
key
, 
KEYLENGTH
);

106 
BlockSize
(ècÚ¡ { 
	gm_blockSize
;}

108 
	g´Ùeùed
:

109 
FixedSizeSecBlock
<
wÜd32
, 4> 
	gm_k
;

110 
	gm_blockSize
;

113 şas 
	cCRYPTOPP_NO_VTABLE
 
	gEnc
 : 
public
 
Ba£


115 
public
:

116 
ProûssAndXÜBlock
(cÚ¡ 
by‹
 *
šBlock
, cÚ¡ by‹ *
xÜBlock
, by‹ *
outBlock
) const;

119 şas 
	cCRYPTOPP_NO_VTABLE
 
	gDec
 : 
public
 
Ba£


121 
public
:

122 
ProûssAndXÜBlock
(cÚ¡ 
by‹
 *
šBlock
, cÚ¡ by‹ *
xÜBlock
, by‹ *
outBlock
) const;

125 
	gpublic
:

126 
BlockCh”Fš®
<
	tENCRYPTION
, 
	tEnc
> 
	tEnüy±iÚ
;

127 
	gBlockCh”Fš®
<
	tDECRYPTION
, 
	tDec
> 
	tDeüy±iÚ
;

130 
	gNAMESPACE_END


	@test.cpp

3 
	#_CRT_SECURE_NO_DEPRECATE


	)

4 
	#CRYPTOPP_DEFAULT_NO_DLL


	)

5 
	#CRYPTOPP_ENABLE_NAMESPACE_WEAK
 1

	)

7 
	~"dÎ.h
"

8 
	~"md5.h
"

9 
	~"remd.h
"

10 
	~"ºg.h
"

11 
	~"gz.h
"

12 
	~"deçuÉ.h
"

13 
	~"¿ndpoŞ.h
"

14 
	~"ida.h
"

15 
	~"ba£64.h
"

16 
	~"sock‘á.h
"

17 
	~"wa™.h
"

18 
	~"çùÜy.h
"

19 
	~"wh¾poŞ.h
"

20 
	~"tig”.h
"

22 
	~"v®id©e.h
"

23 
	~"b’ch.h
"

25 
	~<io¡»am
>

26 
	~<time.h
>

28 #ifdeà
CRYPTOPP_WIN32_AVAILABLE


29 
	~<wšdows.h
>

32 #ià
defšed
(
USE_BERKELEY_STYLE_SOCKETS
è&& !defšed(
macštosh
)

33 
	~<Ãtš‘/š.h
>

34 
	~<Ãtš‘/tı.h
>

37 #ià(
_MSC_VER
 >= 1000)

38 
	~<ütdbg.h
>

41 #ià
defšed
(
__MWERKS__
è&& defšed(
macštosh
)

42 
	~<cÚsŞe.h
>

45 #ifdeà
__BORLANDC__


46 #´agm¨
comm’t
(
lib
, "cryptlib_bds.lib")

47 #´agm¨
comm’t
(
lib
, "ws2_32.lib")

50 
	$USING_NAMESPACE
(
Cry±oPP
)

51 
	$USING_NAMESPACE
(
¡d
)

53 cÚ¡ 
MAX_PHRASE_LENGTH
=250;

55 
	`Regi¡”FaùÜ›s
();

57 
	`G’”©eRSAKey
(
keyL’gth
, cÚ¡ *
´ivF’ame
, cÚ¡ *
pubF’ame
, cÚ¡ *
£ed
);

58 
¡ršg
 
	`RSAEnüy±SŒšg
(cÚ¡ *
pubF’ame
, cÚ¡ *
£ed
, cÚ¡ *
mes§ge
);

59 
¡ršg
 
	`RSADeüy±SŒšg
(cÚ¡ *
´ivF’ame
, cÚ¡ *
ch”‹xt
);

60 
	`RSASignFe
(cÚ¡ *
´ivF’ame
, cÚ¡ *
mes§geF’ame
, cÚ¡ *
sigÇtu»F’ame
);

61 
boŞ
 
	`RSAV”ifyFe
(cÚ¡ *
pubF’ame
, cÚ¡ *
mes§geF’ame
, cÚ¡ *
sigÇtu»F’ame
);

63 
	`Dige¡Fe
(cÚ¡ *
fe
);

64 
	`HmacFe
(cÚ¡ *
hexKey
, cÚ¡ *
fe
);

66 
	`AES_CTR_Enüy±
(cÚ¡ *
hexKey
, cÚ¡ *
hexIV
, cÚ¡ *
šfe
, cÚ¡ *
outfe
);

68 
¡ršg
 
	`Enüy±SŒšg
(cÚ¡ *
¶aš‹xt
, cÚ¡ *
·ssPh¿£
);

69 
¡ršg
 
	`Deüy±SŒšg
(cÚ¡ *
ch”‹xt
, cÚ¡ *
·ssPh¿£
);

71 
	`Enüy±Fe
(cÚ¡ *
š
, cÚ¡ *
out
, cÚ¡ *
·ssPh¿£
);

72 
	`Deüy±Fe
(cÚ¡ *
š
, cÚ¡ *
out
, cÚ¡ *
·ssPh¿£
);

74 
	`Seü‘Sh¬eFe
(
th»shŞd
, 
nSh¬es
, cÚ¡ *
f’ame
, cÚ¡ *
£ed
);

75 
	`Seü‘Recov”Fe
(
th»shŞd
, cÚ¡ *
outF’ame
, *cÚ¡ *
šF’ames
);

77 
	`InfÜm©iÚDi¥”£Fe
(
th»shŞd
, 
nSh¬es
, cÚ¡ *
f’ame
);

78 
	`InfÜm©iÚRecov”Fe
(
th»shŞd
, cÚ¡ *
outF’ame
, *cÚ¡ *
šF’ames
);

80 
	`GzFe
(cÚ¡ *
š
, cÚ¡ *
out
, 
deæ©e_Ëv–
);

81 
	`GunzFe
(cÚ¡ *
š
, cÚ¡ *
out
);

83 
	`Ba£64Encode
(cÚ¡ *
šfe
, cÚ¡ *
outfe
);

84 
	`Ba£64Decode
(cÚ¡ *
šfe
, cÚ¡ *
outfe
);

85 
	`HexEncode
(cÚ¡ *
šfe
, cÚ¡ *
outfe
);

86 
	`HexDecode
(cÚ¡ *
šfe
, cÚ¡ *
outfe
);

88 
	`FÜw¬dTıPÜt
(cÚ¡ *
sourûPÜt
, cÚ¡ *
de¡š©iÚHo¡
, cÚ¡ *
de¡š©iÚPÜt
);

90 
	`FIPS140_Sam¶eAµliÿtiÚ
();

91 
	`FIPS140_G’”©eRªdomFes
();

93 
boŞ
 
	`V®id©e
(, bool, const *);

95 (*
AdhocTe¡
)(
¬gc
, *
¬gv
[]èğ
NULL
;

97 
OFB_Mode
<
AES
>::
Enüy±iÚ
 
s_glob®RNG
;

99 
RªdomNumb”G’”©Ü
 & 
	$Glob®RNG
()

101  
s_glob®RNG
;

102 
	}
}

104 
CRYPTOPP_API
 
	$maš
(
¬gc
, *
¬gv
[])

106 #ifdeà
_CRTDBG_LEAK_CHECK_DF


108 
‹mpæag
 = 
	`_C¹S‘DbgFÏg
Ğ
_CRTDBG_REPORT_FLAG
 );

109 
‹mpæag
 |ğ
_CRTDBG_LEAK_CHECK_DF
;

110 
	`_C¹S‘DbgFÏg
Ğ
‹mpæag
 );

113 #ià
	`defšed
(
__MWERKS__
è&& defšed(
macštosh
)

114 
¬gc
 = 
	`ccommªd
(&
¬gv
);

117 
Œy


119 
	`Regi¡”FaùÜ›s
();

121 
¡d
::
¡ršg
 
£ed
 = 
	`IÁToSŒšg
(
	`time
(
NULL
));

122 
£ed
.
	`»size
(16);

123 
s_glob®RNG
.
	`S‘KeyW™hIV
((
by‹
 *)
£ed
.
	`d©a
(), 16, (byte *)seed.data());

125 
¡d
::
¡ršg
 
commªd
, 
execubËName
, 
macF’ame
;

127 ià(
¬gc
 < 2)

128 
commªd
 = 'h';

130 
commªd
 = 
¬gv
[1];

132 ià(
commªd
 == "g")

134 
£ed
[1024], 
´ivF’ame
[128], 
pubF’ame
[128];

135 
keyL’gth
;

137 
cout
 << "Key†ength in bits: ";

138 
cš
 >> 
keyL’gth
;

140 
cout
 << "\nSave…rivate keyo file: ";

141 
cš
 >> 
´ivF’ame
;

143 
cout
 << "\nSave…ublic keyo file: ";

144 
cš
 >> 
pubF’ame
;

146 
cout
 << "\nRandom Seed: ";

147 
	`ws
(
cš
);

148 
cš
.
	`g‘lše
(
£ed
, 1024);

150 
	`G’”©eRSAKey
(
keyL’gth
, 
´ivF’ame
, 
pubF’ame
, 
£ed
);

152 ià(
commªd
 == "rs")

153 
	`RSASignFe
(
¬gv
[2],‡rgv[3],‡rgv[4]);

154 ià(
commªd
 == "rv")

156 
boŞ
 
v”if›d
 = 
	`RSAV”ifyFe
(
¬gv
[2],‡rgv[3],‡rgv[4]);

157 
cout
 << (
v”if›d
 ? "v®id sigÇtu»" : "šv®id sigÇtu»"è<< 
’dl
;

159 ià(
commªd
 == "r")

161 
´ivF’ame
[128], 
pubF’ame
[128];

162 
£ed
[1024], 
mes§ge
[1024];

164 
cout
 << "Private key file: ";

165 
cš
 >> 
´ivF’ame
;

167 
cout
 << "\nPublic key file: ";

168 
cš
 >> 
pubF’ame
;

170 
cout
 << "\nRandom Seed: ";

171 
	`ws
(
cš
);

172 
cš
.
	`g‘lše
(
£ed
, 1024);

174 
cout
 << "\nMessage: ";

175 
cš
.
	`g‘lše
(
mes§ge
, 1024);

177 
¡ršg
 
ch”‹xt
 = 
	`RSAEnüy±SŒšg
(
pubF’ame
, 
£ed
, 
mes§ge
);

178 
cout
 << "\nCh”‹xt: " << 
ch”‹xt
 << 
’dl
;

180 
¡ršg
 
deüy±ed
 = 
	`RSADeüy±SŒšg
(
´ivF’ame
, 
ch”‹xt
.
	`c_¡r
());

181 
cout
 << "\nDeüy±ed: " << 
deüy±ed
 << 
’dl
;

183 ià(
commªd
 == "mt")

185 
Mau»rRªdomÃssTe¡
 
mt
;

186 
FeStÜe
 
	`fs
(
¬gv
[2]);

187 
fs
.
	`T¿nsãrAÎTo
(
mt
);

188 
cout
 << "Mau»¸Te¡ V®ue: " << 
mt
.
	`G‘Te¡V®ue
(è<< 
’dl
;

190 ià(
commªd
 == "mac_dll")

193 
¡d
::
f¡»am
 
	`dÎFe
(
¬gv
[2], 
ios
::
š
 | ios::
out
 | ios::
bš¬y
);

194 
¡d
::
if¡»am
::
pos_ty³
 
feEnd
 = 
dÎFe
.
	`£ekg
(0, std::
ios_ba£
::
’d
).
	`‹Îg
();

195 ià(
feEnd
 > 20*1000*1000)

197 
û¼
 << "Input fileoo†arge (morehan 20 MB).\n";

202 
feSize
 = ()
feEnd
;

203 
SecBy‹Block
 
	`buf
(
feSize
);

204 
dÎFe
.
	`£ekg
(0, 
¡d
::
ios_ba£
::
beg
);

205 
dÎFe
.
	`»ad
((*)
buf
.
	`begš
(), 
feSize
);

208 
wÜd32
 
coffPos
 = *(
wÜd16
 *)(
buf
+0x3c);

209 
wÜd32
 
İtiÚ®H—d”Pos
 = 
coffPos
 + 24;

210 
wÜd16
 
İtiÚ®H—d”Magic
 = *(wÜd16 *)(
buf
+
İtiÚ®H—d”Pos
);

211 ià(
İtiÚ®H—d”Magic
 != 0x10b && optionalHeaderMagic != 0x20b)

213 
û¼
 << "Target file is‚ot‡ PE32 or PE32+ image.\n";

216 
wÜd32
 
checksumPos
 = 
İtiÚ®H—d”Pos
 + 64;

217 
wÜd32
 
û¹ifiÿ‹TabËDœeùÜyPos
 = 
İtiÚ®H—d”Pos
 + (
İtiÚ®H—d”Magic
 == 0x10b ? 128 : 144);

218 
wÜd32
 
û¹ifiÿ‹TabËPos
 = *(wÜd32 *)(
buf
+
û¹ifiÿ‹TabËDœeùÜyPos
);

219 
wÜd32
 
û¹ifiÿ‹TabËSize
 = *(wÜd32 *)(
buf
+
û¹ifiÿ‹TabËDœeùÜyPos
+4);

220 ià(
û¹ifiÿ‹TabËSize
 != 0)

221 
û¼
 << "Warning: certificateable (IMAGE_DIRECTORY_ENTRY_SECURITY) ofarget image is‚otƒmpty.\n";

224 
by‹
 
mac
[] = 
CRYPTOPP_DUMMY_DLL_MAC
;

225 
by‹
 *
found
 = 
¡d
::
	`£¬ch
(
buf
.
	`begš
(), buf.
	`’d
(), 
mac
+0, mac+(mac));

226 ià(
found
 =ğ
buf
.
	`’d
())

228 
û¼
 << "MAC…laceholder‚ot found. Possiblyhe‡ctual MAC was‡lready…laced.\n";

231 
wÜd32
 
macPos
 = ()(
found
-
buf
.
	`begš
());

234 
memb”_±r
<
Mes§geAuth’tiÿtiÚCode
> 
	`pMac
(
	`NewIÁegr™yCheckšgMAC
());

235 
	`as£¹
(
pMac
->
	`Dige¡Size
(è=ğ(
mac
));

236 
M‘”F‹r
 
	`f
(
Ãw
 
	`HashF‹r
(*
pMac
,‚ew 
	`A¼aySšk
(
mac
, (mac))));

237 
f
.
	`AddRªgeToSk
(0, 
checksumPos
, 4);

238 
f
.
	`AddRªgeToSk
(0, 
û¹ifiÿ‹TabËDœeùÜyPos
, 8);

239 
f
.
	`AddRªgeToSk
(0, 
macPos
, (
mac
));

240 
f
.
	`AddRªgeToSk
(0, 
û¹ifiÿ‹TabËPos
, 
û¹ifiÿ‹TabËSize
);

241 
f
.
	`PutMes§geEnd
(
buf
.
	`begš
(), buf.
	`size
());

244 
cout
 << "PÏcšg MAC iÀf" << 
¬gv
[2] << ",†oÿtiÚ " << 
macPos
 << ".\n";

245 
dÎFe
.
	`£ekg
(
macPos
, 
¡d
::
ios_ba£
::
beg
);

246 
dÎFe
.
	`wr™e
((*)
mac
, (mac));

248 ià(
commªd
 == "m")

249 
	`Dige¡Fe
(
¬gv
[2]);

250 ià(
commªd
 == "tv")

252 
¡d
::
¡ršg
 
âame
 = 
¬gv
[2];

253 ià(
âame
.
	`fšd
(".txt"è=ğ
¡d
::
¡ršg
::
Åos
)

254 
âame
 = "TestVectors/" + fname + ".txt";

255  !
	`RunTe¡D©aFe
(
âame
.
	`c_¡r
());

257 ià(
commªd
 == "t")

260 
·ssPh¿£
[
MAX_PHRASE_LENGTH
], 
¶aš‹xt
[1024];

262 
cout
 << "Passphrase: ";

263 
cš
.
	`g‘lše
(
·ssPh¿£
, 
MAX_PHRASE_LENGTH
);

265 
cout
 << "\nPlaintext: ";

266 
cš
.
	`g‘lše
(
¶aš‹xt
, 1024);

268 
¡ršg
 
ch”‹xt
 = 
	`Enüy±SŒšg
(
¶aš‹xt
, 
·ssPh¿£
);

269 
cout
 << "\nCh”‹xt: " << 
ch”‹xt
 << 
’dl
;

271 
¡ršg
 
deüy±ed
 = 
	`Deüy±SŒšg
(
ch”‹xt
.
	`c_¡r
(), 
·ssPh¿£
);

272 
cout
 << "\nDeüy±ed: " << 
deüy±ed
 << 
’dl
;

276 ià(
commªd
 == "e64")

277 
	`Ba£64Encode
(
¬gv
[2],‡rgv[3]);

278 ià(
commªd
 == "d64")

279 
	`Ba£64Decode
(
¬gv
[2],‡rgv[3]);

280 ià(
commªd
 == "e16")

281 
	`HexEncode
(
¬gv
[2],‡rgv[3]);

282 ià(
commªd
 == "d16")

283 
	`HexDecode
(
¬gv
[2],‡rgv[3]);

284 ià(
commªd
 == "e" || command == "d")

286 
·ssPh¿£
[
MAX_PHRASE_LENGTH
];

287 
cout
 << "Passphrase: ";

288 
cš
.
	`g‘lše
(
·ssPh¿£
, 
MAX_PHRASE_LENGTH
);

289 ià(
commªd
 == "e")

290 
	`Enüy±Fe
(
¬gv
[2],‡rgv[3], 
·ssPh¿£
);

292 
	`Deüy±Fe
(
¬gv
[2],‡rgv[3], 
·ssPh¿£
);

294 ià(
commªd
 == "ss")

296 
£ed
[1024];

297 
cout
 << "\nRandom Seed: ";

298 
	`ws
(
cš
);

299 
cš
.
	`g‘lše
(
£ed
, 1024);

300 
	`Seü‘Sh¬eFe
(
	`©oi
(
¬gv
[2]),‡toi×rgv[3]),‡rgv[4], 
£ed
);

302 ià(
commªd
 == "sr")

303 
	`Seü‘Recov”Fe
(
¬gc
-3, 
¬gv
[2],‡rgv+3);

304 ià(
commªd
 == "id")

305 
	`InfÜm©iÚDi¥”£Fe
(
	`©oi
(
¬gv
[2]),‡toi(argv[3]),‡rgv[4]);

306 ià(
commªd
 == "ir")

307 
	`InfÜm©iÚRecov”Fe
(
¬gc
-3, 
¬gv
[2],‡rgv+3);

308 ià(
commªd
 == "v" || command == "vv")

309  !
	`V®id©e
(
¬gc
>2 ? 
	`©oi
(
¬gv
[2]è: 0,‡rgv[1][1] =ğ'v',‡rgc>3 ?‡rgv[3] : 
NULL
);

310 ià(
commªd
 == "b")

311 
	`B’chm¬kAÎ
(
¬gc
<3 ? 1 : 
	`©of
(
¬gv
[2]),‡rgc<4 ? 0 :‡tof(argv[3])*1e9);

312 ià(
commªd
 == "b2")

313 
	`B’chm¬kAÎ2
(
¬gc
<3 ? 1 : 
	`©of
(
¬gv
[2]),‡rgc<4 ? 0 :‡tof(argv[3])*1e9);

314 ià(
commªd
 == "z")

315 
	`GzFe
(
¬gv
[3],‡rgv[4],‡rgv[2][0]-'0');

316 ià(
commªd
 == "u")

317 
	`GunzFe
(
¬gv
[2],‡rgv[3]);

318 ià(
commªd
 == "fips")

319 
	`FIPS140_Sam¶eAµliÿtiÚ
();

320 ià(
commªd
 == "fips-rand")

321 
	`FIPS140_G’”©eRªdomFes
();

322 ià(
commªd
 == "ft")

323 
	`FÜw¬dTıPÜt
(
¬gv
[2],‡rgv[3],‡rgv[4]);

324 ià(
commªd
 == "a")

326 ià(
AdhocTe¡
)

327  (*
AdhocTe¡
)(
¬gc
, 
¬gv
);

330 
û¼
 << "AdhocTest‚ot defined.\n";

334 ià(
commªd
 == "hmac")

335 
	`HmacFe
(
¬gv
[2],‡rgv[3]);

336 ià(
commªd
 == "ae")

337 
	`AES_CTR_Enüy±
(
¬gv
[2],‡rgv[3],‡rgv[4],‡rgv[5]);

338 ià(
commªd
 == "h")

340 
FeSourû
 
	`u§ge
("Te¡D©a/u§ge.d©", 
Œue
, 
Ãw
 
	`FeSšk
(
cout
));

343 ià(
commªd
 == "V")

345 
cout
 << 
CRYPTOPP_VERSION
 / 100 << '.' << (CRYPTOPP_VERSION % 100è/ 10 << '.' << CRYPTOPP_VERSION % 10 << 
’dl
;

349 
û¼
 << "Unrecognized command. Run \"cryptest h\"o obtain usage information.\n";

354 
	`ÿtch
(
Cry±oPP
::
Exû±iÚ
 &
e
)

356 
cout
 << "\nCry±oPP::Exû±iÚ caught: " << 
e
.
	`wh©
(è<< 
’dl
;

359 
	`ÿtch
(
¡d
::
exû±iÚ
 &
e
)

361 
cout
 << "\n¡d::exû±iÚ caught: " << 
e
.
	`wh©
(è<< 
’dl
;

364 
	}
}

366 
	$FIPS140_G’”©eRªdomFes
()

368 #ifdeà
OS_RNG_AVAILABLE


369 
DeçuÉAutoS“dedRNG
 
ºg
;

370 
RªdomNumb”StÜe
 
	`¡Üe
(
ºg
, 
ULONG_MAX
);

372 
i
=0; i<100000; i++)

373 
¡Üe
.
	`T¿nsãrTo
(
	`FeSšk
((
	`IÁToSŒšg
(
i
è+ ".ºd").
	`c_¡r
()).
	`Ref
(), 20000);

375 
cout
 << "OS…rovided RNG‚ot‡vailable.\n";

376 
	`ex™
(-1);

378 
	}
}

380 
SecBy‹Block
 
	$HexDecodeSŒšg
(cÚ¡ *
hex
)

382 
SŒšgSourû
 
	`ss
(
hex
, 
Œue
, 
Ãw
 
HexDecod”
);

383 
SecBy‹Block
 
	`»suÉ
((
size_t
)
ss
.
	`MaxR‘r›vabË
());

384 
ss
.
	`G‘
(
»suÉ
,„esuÉ.
	`size
());

385  
»suÉ
;

386 
	}
}

388 
	$G’”©eRSAKey
(
keyL’gth
, cÚ¡ *
´ivF’ame
, cÚ¡ *
pubF’ame
, cÚ¡ *
£ed
)

390 
RªdomPoŞ
 
¿ndPoŞ
;

391 
¿ndPoŞ
.
	`IncÜpÜ©eEÁrİy
((
by‹
 *)
£ed
, 
	`¡¾’
(seed));

393 
RSAES_OAEP_SHA_Deüy±Ü
 
	`´iv
(
¿ndPoŞ
, 
keyL’gth
);

394 
HexEncod”
 
	`´ivFe
(
Ãw
 
	`FeSšk
(
´ivF’ame
));

395 
´iv
.
	`DEREncode
(
´ivFe
);

396 
´ivFe
.
	`Mes§geEnd
();

398 
RSAES_OAEP_SHA_Enüy±Ü
 
	`pub
(
´iv
);

399 
HexEncod”
 
	`pubFe
(
Ãw
 
	`FeSšk
(
pubF’ame
));

400 
pub
.
	`DEREncode
(
pubFe
);

401 
pubFe
.
	`Mes§geEnd
();

402 
	}
}

404 
¡ršg
 
	$RSAEnüy±SŒšg
(cÚ¡ *
pubF’ame
, cÚ¡ *
£ed
, cÚ¡ *
mes§ge
)

406 
FeSourû
 
	`pubFe
(
pubF’ame
, 
Œue
, 
Ãw
 
HexDecod”
);

407 
RSAES_OAEP_SHA_Enüy±Ü
 
	`pub
(
pubFe
);

409 
RªdomPoŞ
 
¿ndPoŞ
;

410 
¿ndPoŞ
.
	`IncÜpÜ©eEÁrİy
((
by‹
 *)
£ed
, 
	`¡¾’
(seed));

412 
¡ršg
 
»suÉ
;

413 
	`SŒšgSourû
(
mes§ge
, 
Œue
, 
Ãw
 
	`PK_Enüy±ÜF‹r
(
¿ndPoŞ
, 
pub
,‚ew 
	`HexEncod”
Òew 
	`SŒšgSšk
(
»suÉ
))));

414  
»suÉ
;

415 
	}
}

417 
¡ršg
 
	$RSADeüy±SŒšg
(cÚ¡ *
´ivF’ame
, cÚ¡ *
ch”‹xt
)

419 
FeSourû
 
	`´ivFe
(
´ivF’ame
, 
Œue
, 
Ãw
 
HexDecod”
);

420 
RSAES_OAEP_SHA_Deüy±Ü
 
	`´iv
(
´ivFe
);

422 
¡ršg
 
»suÉ
;

423 
	`SŒšgSourû
(
ch”‹xt
, 
Œue
, 
Ãw
 
	`HexDecod”
Òew 
	`PK_Deüy±ÜF‹r
(
	`Glob®RNG
(), 
´iv
,‚ew 
	`SŒšgSšk
(
»suÉ
))));

424  
»suÉ
;

425 
	}
}

427 
	$RSASignFe
(cÚ¡ *
´ivF’ame
, cÚ¡ *
mes§geF’ame
, cÚ¡ *
sigÇtu»F’ame
)

429 
FeSourû
 
	`´ivFe
(
´ivF’ame
, 
Œue
, 
Ãw
 
HexDecod”
);

430 
RSASS
<
PKCS1v15
, 
SHA
>::
SigÃr
 
	`´iv
(
´ivFe
);

431 
FeSourû
 
	`f
(
mes§geF’ame
, 
Œue
, 
Ãw
 
	`SigÃrF‹r
(
	`Glob®RNG
(), 
´iv
,‚ew 
	`HexEncod”
Òew 
	`FeSšk
(
sigÇtu»F’ame
))));

432 
	}
}

434 
boŞ
 
	$RSAV”ifyFe
(cÚ¡ *
pubF’ame
, cÚ¡ *
mes§geF’ame
, cÚ¡ *
sigÇtu»F’ame
)

436 
FeSourû
 
	`pubFe
(
pubF’ame
, 
Œue
, 
Ãw
 
HexDecod”
);

437 
RSASS
<
PKCS1v15
, 
SHA
>::
V”if›r
 
	`pub
(
pubFe
);

439 
FeSourû
 
	`sigÇtu»Fe
(
sigÇtu»F’ame
, 
Œue
, 
Ãw
 
HexDecod”
);

440 ià(
sigÇtu»Fe
.
	`MaxR‘r›vabË
(è!ğ
pub
.
	`SigÇtu»L’gth
())

441  
çl£
;

442 
SecBy‹Block
 
	`sigÇtu»
(
pub
.
	`SigÇtu»L’gth
());

443 
sigÇtu»Fe
.
	`G‘
(
sigÇtu»
, sigÇtu».
	`size
());

445 
V”if›rF‹r
 *
v”if›rF‹r
 = 
Ãw
 
	`V”if›rF‹r
(
pub
);

446 
v”if›rF‹r
->
	`Put
(
sigÇtu»
, 
pub
.
	`SigÇtu»L’gth
());

447 
FeSourû
 
	`f
(
mes§geF’ame
, 
Œue
, 
v”if›rF‹r
);

449  
v”if›rF‹r
->
	`G‘La¡ResuÉ
();

450 
	}
}

452 
	$Dige¡Fe
(cÚ¡ *
f’ame
)

454 
SHA1
 
sha
;

455 
RIPEMD160
 
remd
;

456 
SHA256
 
sha256
;

457 
Tig”
 
tig”
;

458 
SHA512
 
sha512
;

459 
WhœÍoŞ
 
whœÍoŞ
;

460 
veùÜ_memb”_±rs
<
HashF‹r
> 
	`f‹rs
(6);

461 
f‹rs
[0].
	`»£t
(
Ãw
 
	`HashF‹r
(
sha
));

462 
f‹rs
[1].
	`»£t
(
Ãw
 
	`HashF‹r
(
remd
));

463 
f‹rs
[2].
	`»£t
(
Ãw
 
	`HashF‹r
(
tig”
));

464 
f‹rs
[3].
	`»£t
(
Ãw
 
	`HashF‹r
(
sha256
));

465 
f‹rs
[4].
	`»£t
(
Ãw
 
	`HashF‹r
(
sha512
));

466 
f‹rs
[5].
	`»£t
(
Ãw
 
	`HashF‹r
(
whœÍoŞ
));

468 
auto_±r
<
ChªÃlSw™ch
> 
	`chªÃlSw™ch
(
Ãw
 ChannelSwitch);

469 
size_t
 
i
;

470 
i
=0; i<
f‹rs
.
	`size
(); i++)

471 
chªÃlSw™ch
->
	`AddDeçuÉRou‹
(*
f‹rs
[
i
]);

472 
	`FeSourû
(
f’ame
, 
Œue
, 
chªÃlSw™ch
.
	`»Ëa£
());

474 
HexEncod”
 
	`’cod”
(
Ãw
 
	`FeSšk
(
cout
), 
çl£
);

475 
i
=0; i<
f‹rs
.
	`size
(); i++)

477 
cout
 << 
f‹rs
[
i
]->
	`AlgÜ™hmName
() << ": ";

478 
f‹rs
[
i
]->
	`T¿nsãrTo
(
’cod”
);

479 
cout
 << "\n";

481 
	}
}

483 
	$HmacFe
(cÚ¡ *
hexKey
, cÚ¡ *
fe
)

485 
memb”_±r
<
Mes§geAuth’tiÿtiÚCode
> 
mac
;

486 ià(
	`¡rcmp
(
hexKey
, "selftest") == 0)

488 
û¼
 << "Computing HMAC/SHA1 value for selfest.\n";

489 
mac
.
	`»£t
(
	`NewIÁegr™yCheckšgMAC
());

493 
¡d
::
¡ršg
 
decodedKey
;

494 
	`SŒšgSourû
(
hexKey
, 
Œue
, 
Ãw
 
	`HexDecod”
Òew 
	`SŒšgSšk
(
decodedKey
)));

495 
mac
.
	`»£t
(
Ãw
 
HMAC
<
SHA1
>((cÚ¡ 
by‹
 *)
decodedKey
.
	`d©a
(), decodedKey.
	`size
()));

497 
	`FeSourû
(
fe
, 
Œue
, 
Ãw
 
	`HashF‹r
(*
mac
,‚ew 
	`HexEncod”
Òew 
	`FeSšk
(
cout
))));

498 
	}
}

500 
	$AES_CTR_Enüy±
(cÚ¡ *
hexKey
, cÚ¡ *
hexIV
, cÚ¡ *
šfe
, cÚ¡ *
outfe
)

502 
SecBy‹Block
 
key
 = 
	`HexDecodeSŒšg
(
hexKey
);

503 
SecBy‹Block
 
iv
 = 
	`HexDecodeSŒšg
(
hexIV
);

504 
CTR_Mode
<
AES
>::
Enüy±iÚ
 
	`«s
(
key
, key.
	`size
(), 
iv
);

505 
	`FeSourû
(
šfe
, 
Œue
, 
Ãw
 
	`SŒ—mT¿nsfÜm©iÚF‹r
(
«s
,‚ew 
	`FeSšk
(
outfe
)));

506 
	}
}

508 
¡ršg
 
	$Enüy±SŒšg
(cÚ¡ *
š¡r
, cÚ¡ *
·ssPh¿£
)

510 
¡ršg
 
out¡r
;

512 
DeçuÉEnüy±ÜW™hMAC
 
	`’üy±Ü
(
·ssPh¿£
, 
Ãw
 
	`HexEncod”
Òew 
	`SŒšgSšk
(
out¡r
)));

513 
’üy±Ü
.
	`Put
((
by‹
 *)
š¡r
, 
	`¡¾’
(instr));

514 
’üy±Ü
.
	`Mes§geEnd
();

516  
out¡r
;

517 
	}
}

519 
¡ršg
 
	$Deüy±SŒšg
(cÚ¡ *
š¡r
, cÚ¡ *
·ssPh¿£
)

521 
¡ršg
 
out¡r
;

523 
HexDecod”
 
	`deüy±Ü
(
Ãw
 
	`DeçuÉDeüy±ÜW™hMAC
(
·ssPh¿£
,‚ew 
	`SŒšgSšk
(
out¡r
)));

524 
deüy±Ü
.
	`Put
((
by‹
 *)
š¡r
, 
	`¡¾’
(instr));

525 
deüy±Ü
.
	`Mes§geEnd
();

527  
out¡r
;

528 
	}
}

530 
	$Enüy±Fe
(cÚ¡ *
š
, cÚ¡ *
out
, cÚ¡ *
·ssPh¿£
)

532 
FeSourû
 
	`f
(
š
, 
Œue
, 
Ãw
 
	`DeçuÉEnüy±ÜW™hMAC
(
·ssPh¿£
,‚ew 
	`FeSšk
(
out
)));

533 
	}
}

535 
	$Deüy±Fe
(cÚ¡ *
š
, cÚ¡ *
out
, cÚ¡ *
·ssPh¿£
)

537 
FeSourû
 
	`f
(
š
, 
Œue
, 
Ãw
 
	`DeçuÉDeüy±ÜW™hMAC
(
·ssPh¿£
,‚ew 
	`FeSšk
(
out
)));

538 
	}
}

540 
	$Seü‘Sh¬eFe
(
th»shŞd
, 
nSh¬es
, cÚ¡ *
f’ame
, cÚ¡ *
£ed
)

542 
	`as£¹
(
nSh¬es
<=1000);

544 
RªdomPoŞ
 
ºg
;

545 
ºg
.
	`IncÜpÜ©eEÁrİy
((
by‹
 *)
£ed
, 
	`¡¾’
(seed));

547 
ChªÃlSw™ch
 *
chªÃlSw™ch
;

548 
FeSourû
 
	`sourû
(
f’ame
, 
çl£
, 
Ãw
 
	`Seü‘Sh¬šg
(
ºg
, 
th»shŞd
, 
nSh¬es
, 
chªÃlSw™ch
 =‚ew 
ChªÃlSw™ch
));

550 
veùÜ_memb”_±rs
<
FeSšk
> 
	`feSšks
(
nSh¬es
);

551 
¡ršg
 
chªÃl
;

552 
i
=0; i<
nSh¬es
; i++)

554 
ex‹nsiÚ
[5] = ".000";

555 
ex‹nsiÚ
[1]='0'+
	`by‹
(
i
/100);

556 
ex‹nsiÚ
[2]='0'+
	`by‹
((
i
/10)%10);

557 
ex‹nsiÚ
[3]='0'+
	`by‹
(
i
%10);

558 
feSšks
[
i
].
	`»£t
(
Ãw
 
	`FeSšk
((
	`¡ršg
(
f’ame
)+
ex‹nsiÚ
).
	`c_¡r
()));

560 
chªÃl
 = 
WÜdToSŒšg
<
wÜd32
>(
i
);

561 
feSšks
[
i
]->
	`Put
((
by‹
 *)
chªÃl
.
	`d©a
(), 4);

562 
chªÃlSw™ch
->
	`AddRou‹
(
chªÃl
, *
feSšks
[
i
], 
DEFAULT_CHANNEL
);

565 
sourû
.
	`PumpAÎ
();

566 
	}
}

568 
	$Seü‘Recov”Fe
(
th»shŞd
, cÚ¡ *
outF’ame
, *cÚ¡ *
šF’ames
)

570 
	`as£¹
(
th»shŞd
<=1000);

572 
Seü‘Recov”y
 
	`»cov”y
(
th»shŞd
, 
Ãw
 
	`FeSšk
(
outF’ame
));

574 
veùÜ_memb”_±rs
<
FeSourû
> 
	`feSourûs
(
th»shŞd
);

575 
SecBy‹Block
 
	`chªÃl
(4);

576 
i
;

577 
i
=0; i<
th»shŞd
; i++)

579 
feSourûs
[
i
].
	`»£t
(
Ãw
 
	`FeSourû
(
šF’ames
[i], 
çl£
));

580 
feSourûs
[
i
]->
	`Pump
(4);

581 
feSourûs
[
i
]->
	`G‘
(
chªÃl
, 4);

582 
feSourûs
[
i
]->
	`A‰ach
(
Ãw
 
	`ChªÃlSw™ch
(
»cov”y
, 
	`¡ršg
((*)
chªÃl
.
	`begš
(), 4)));

585 
feSourûs
[0]->
	`Pump
(256))

586 
i
=1; i<
th»shŞd
; i++)

587 
feSourûs
[
i
]->
	`Pump
(256);

589 
i
=0; i<
th»shŞd
; i++)

590 
feSourûs
[
i
]->
	`PumpAÎ
();

591 
	}
}

593 
	$InfÜm©iÚDi¥”£Fe
(
th»shŞd
, 
nSh¬es
, cÚ¡ *
f’ame
)

595 
	`as£¹
(
nSh¬es
<=1000);

597 
ChªÃlSw™ch
 *
chªÃlSw™ch
;

598 
FeSourû
 
	`sourû
(
f’ame
, 
çl£
, 
Ãw
 
	`InfÜm©iÚDi¥”§l
(
th»shŞd
, 
nSh¬es
, 
chªÃlSw™ch
 =‚ew 
ChªÃlSw™ch
));

600 
veùÜ_memb”_±rs
<
FeSšk
> 
	`feSšks
(
nSh¬es
);

601 
¡ršg
 
chªÃl
;

602 
i
=0; i<
nSh¬es
; i++)

604 
ex‹nsiÚ
[5] = ".000";

605 
ex‹nsiÚ
[1]='0'+
	`by‹
(
i
/100);

606 
ex‹nsiÚ
[2]='0'+
	`by‹
((
i
/10)%10);

607 
ex‹nsiÚ
[3]='0'+
	`by‹
(
i
%10);

608 
feSšks
[
i
].
	`»£t
(
Ãw
 
	`FeSšk
((
	`¡ršg
(
f’ame
)+
ex‹nsiÚ
).
	`c_¡r
()));

610 
chªÃl
 = 
WÜdToSŒšg
<
wÜd32
>(
i
);

611 
feSšks
[
i
]->
	`Put
((
by‹
 *)
chªÃl
.
	`d©a
(), 4);

612 
chªÃlSw™ch
->
	`AddRou‹
(
chªÃl
, *
feSšks
[
i
], 
DEFAULT_CHANNEL
);

615 
sourû
.
	`PumpAÎ
();

616 
	}
}

618 
	$InfÜm©iÚRecov”Fe
(
th»shŞd
, cÚ¡ *
outF’ame
, *cÚ¡ *
šF’ames
)

620 
	`as£¹
(
th»shŞd
<=1000);

622 
InfÜm©iÚRecov”y
 
	`»cov”y
(
th»shŞd
, 
Ãw
 
	`FeSšk
(
outF’ame
));

624 
veùÜ_memb”_±rs
<
FeSourû
> 
	`feSourûs
(
th»shŞd
);

625 
SecBy‹Block
 
	`chªÃl
(4);

626 
i
;

627 
i
=0; i<
th»shŞd
; i++)

629 
feSourûs
[
i
].
	`»£t
(
Ãw
 
	`FeSourû
(
šF’ames
[i], 
çl£
));

630 
feSourûs
[
i
]->
	`Pump
(4);

631 
feSourûs
[
i
]->
	`G‘
(
chªÃl
, 4);

632 
feSourûs
[
i
]->
	`A‰ach
(
Ãw
 
	`ChªÃlSw™ch
(
»cov”y
, 
	`¡ršg
((*)
chªÃl
.
	`begš
(), 4)));

635 
feSourûs
[0]->
	`Pump
(256))

636 
i
=1; i<
th»shŞd
; i++)

637 
feSourûs
[
i
]->
	`Pump
(256);

639 
i
=0; i<
th»shŞd
; i++)

640 
feSourûs
[
i
]->
	`PumpAÎ
();

641 
	}
}

643 
	$GzFe
(cÚ¡ *
š
, cÚ¡ *
out
, 
deæ©e_Ëv–
)

656 
Equ®™yCom·risÚF‹r
 
com·risÚ
;

658 
Gunz
 
	`gunz
(
Ãw
 
	`ChªÃlSw™ch
(
com·risÚ
, "0"));

659 
gunz
.
	`S‘AutoSigÇlPrİag©iÚ
(0);

661 
FeSšk
 
	`sšk
(
out
);

663 
ChªÃlSw™ch
 *
cs
;

664 
Gz
 
	`gz
(
cs
 = 
Ãw
 
	`ChªÃlSw™ch
(
sšk
), 
deæ©e_Ëv–
);

665 
cs
->
	`AddDeçuÉRou‹
(
gunz
);

667 
cs
 = 
Ãw
 
	`ChªÃlSw™ch
(
gz
);

668 
cs
->
	`AddDeçuÉRou‹
(
com·risÚ
, "1");

669 
FeSourû
 
	`sourû
(
š
, 
Œue
, 
cs
);

671 
com·risÚ
.
	`ChªÃlMes§geS”›sEnd
("0");

672 
com·risÚ
.
	`ChªÃlMes§geS”›sEnd
("1");

673 
	}
}

675 
	$GunzFe
(cÚ¡ *
š
, cÚ¡ *
out
)

677 
	`FeSourû
(
š
, 
Œue
, 
Ãw
 
	`Gunz
Òew 
	`FeSšk
(
out
)));

678 
	}
}

680 
	$Ba£64Encode
(cÚ¡ *
š
, cÚ¡ *
out
)

682 
	`FeSourû
(
š
, 
Œue
, 
Ãw
 
	`Ba£64Encod”
Òew 
	`FeSšk
(
out
)));

683 
	}
}

685 
	$Ba£64Decode
(cÚ¡ *
š
, cÚ¡ *
out
)

687 
	`FeSourû
(
š
, 
Œue
, 
Ãw
 
	`Ba£64Decod”
Òew 
	`FeSšk
(
out
)));

688 
	}
}

690 
	$HexEncode
(cÚ¡ *
š
, cÚ¡ *
out
)

692 
	`FeSourû
(
š
, 
Œue
, 
Ãw
 
	`HexEncod”
Òew 
	`FeSšk
(
out
)));

693 
	}
}

695 
	$HexDecode
(cÚ¡ *
š
, cÚ¡ *
out
)

697 
	`FeSourû
(
š
, 
Œue
, 
Ãw
 
	`HexDecod”
Òew 
	`FeSšk
(
out
)));

698 
	}
}

700 
	$FÜw¬dTıPÜt
(cÚ¡ *
sourûPÜtName
, cÚ¡ *
de¡š©iÚHo¡
, cÚ¡ *
de¡š©iÚPÜtName
)

702 #ifdeà
SOCKETS_AVAILABLE


703 
Sock‘sIn™Ÿliz”
 
sockIn™
;

705 
Sock‘
 
sockLi¡’
, 
sockSourû
, 
sockDe¡š©iÚ
;

707 
sourûPÜt
 = 
Sock‘
::
	`PÜtNameToNumb”
(
sourûPÜtName
);

708 
de¡š©iÚPÜt
 = 
Sock‘
::
	`PÜtNameToNumb”
(
de¡š©iÚPÜtName
);

710 
sockLi¡’
.
	`C»©e
();

711 
sockLi¡’
.
	`Bšd
(
sourûPÜt
);

712 
	`£tsockİt
(
sockLi¡’
, 
IPPROTO_TCP
, 
TCP_NODELAY
, "\x01", 1);

714 
cout
 << "Li¡šg oÀpÜˆ" << 
sourûPÜt
 << ".\n";

715 
sockLi¡’
.
	`Li¡’
();

717 
sockLi¡’
.
	`Acû±
(
sockSourû
);

718 
cout
 << "CÚÃùiÚ‡cû±ed oÀpÜˆ" << 
sourûPÜt
 << ".\n";

719 
sockLi¡’
.
	`Clo£Sock‘
();

721 
cout
 << "Makšg cÚÃùiÚØ" << 
de¡š©iÚHo¡
 << ",…Üˆ" << 
de¡š©iÚPÜt
 << ".\n";

722 
sockDe¡š©iÚ
.
	`C»©e
();

723 
sockDe¡š©iÚ
.
	`CÚÃù
(
de¡š©iÚHo¡
, 
de¡š©iÚPÜt
);

725 
cout
 << "CÚÃùiÚ madtØ" << 
de¡š©iÚHo¡
 << ", startingo forward.\n";

727 
Sock‘Sourû
 
	`out
(
sockSourû
, 
çl£
, 
Ãw
 
	`Sock‘Sšk
(
sockDe¡š©iÚ
));

728 
Sock‘Sourû
 
	`š
(
sockDe¡š©iÚ
, 
çl£
, 
Ãw
 
	`Sock‘Sšk
(
sockSourû
));

730 
Wa™ObjeùCÚš”
 
wa™Objeùs
;

732 !(
š
.
	`SourûExhau¡ed
(è&& 
out
.SourceExhausted()))

734 
wa™Objeùs
.
	`CË¬
();

736 
out
.
	`G‘Wa™Objeùs
(
wa™Objeùs
, 
	`C®lSck
("FÜw¬dTıPÜˆ- out", 
NULL
));

737 
š
.
	`G‘Wa™Objeùs
(
wa™Objeùs
, 
	`C®lSck
("FÜw¬dTıPÜˆ- in", 
NULL
));

739 
wa™Objeùs
.
	`Wa™
(
INFINITE_TIME
);

741 ià(!
out
.
	`SourûExhau¡ed
())

743 
cout
 << "o" << 
æush
;

744 
out
.
	`PumpAÎ2
(
çl£
);

745 ià(
out
.
	`SourûExhau¡ed
())

746 
cout
 << "EOF„eceived on source socket.\n";

749 ià(!
š
.
	`SourûExhau¡ed
())

751 
cout
 << "i" << 
æush
;

752 
š
.
	`PumpAÎ2
(
çl£
);

753 ià(
š
.
	`SourûExhau¡ed
())

754 
cout
 << "EOF„eceived on destination socket.\n";

758 
cout
 << "Socket support was‚otƒnabled‡t compileime.\n";

759 
	`ex™
(-1);

761 
	}
}

763 
boŞ
 
	$V®id©e
(
®g
, 
boŞ
 
thÜough
, cÚ¡ *
£edIÅut
)

765 
boŞ
 
»suÉ
;

767 
¡d
::
¡ršg
 
£ed
 = 
£edIÅut
 ? std::
	`¡ršg
(£edIÅutè: 
	`IÁToSŒšg
(
	`time
(
NULL
));

768 
£ed
.
	`»size
(16);

770 
cout
 << "Usšg s“d: " << 
£ed
 << 
’dl
 <<ƒndl;

771 
s_glob®RNG
.
	`S‘KeyW™hIV
((
by‹
 *)
£ed
.
	`d©a
(), 16, (byte *)seed.data());

773 
®g
)

775 0: 
»suÉ
 = 
	`V®id©eAÎ
(
thÜough
); ;

776 1: 
»suÉ
 = 
	`Te¡S‘tšgs
(); ;

777 2: 
»suÉ
 = 
	`Te¡OS_RNG
(); ;

778 3: 
»suÉ
 = 
	`V®id©eMD5
(); ;

779 4: 
»suÉ
 = 
	`V®id©eSHA
(); ;

780 5: 
»suÉ
 = 
	`V®id©eDES
(); ;

781 6: 
»suÉ
 = 
	`V®id©eIDEA
(); ;

782 7: 
»suÉ
 = 
	`V®id©eARC4
(); ;

783 8: 
»suÉ
 = 
	`V®id©eRC5
(); ;

784 9: 
»suÉ
 = 
	`V®id©eBlowfish
(); ;

786 11: 
»suÉ
 = 
	`V®id©eTh»eWay
(); ;

787 12: 
»suÉ
 = 
	`V®id©eBBS
(); ;

788 13: 
»suÉ
 = 
	`V®id©eDH
(); ;

789 14: 
»suÉ
 = 
	`V®id©eRSA
(); ;

790 15: 
»suÉ
 = 
	`V®id©eElGam®
(); ;

791 16: 
»suÉ
 = 
	`V®id©eDSA
(
thÜough
); ;

793 18: 
»suÉ
 = 
	`V®id©eSAFER
(); ;

794 19: 
»suÉ
 = 
	`V®id©eLUC
(); ;

795 20: 
»suÉ
 = 
	`V®id©eRabš
(); ;

797 22: 
»suÉ
 = 
	`V®id©eECP
(); ;

798 23: 
»suÉ
 = 
	`V®id©eEC2N
(); ;

800 25: 
»suÉ
 = 
	`V®id©eGOST
(); ;

801 26: 
»suÉ
 = 
	`V®id©eTig”
(); ;

802 27: 
»suÉ
 = 
	`V®id©eRIPEMD
(); ;

803 28: 
»suÉ
 = 
	`V®id©eHMAC
(); ;

805 30: 
»suÉ
 = 
	`V®id©eSHARK
(); ;

806 32: 
»suÉ
 = 
	`V®id©eLUC_DH
(); ;

807 33: 
»suÉ
 = 
	`V®id©eLUC_DL
(); ;

808 34: 
»suÉ
 = 
	`V®id©eSEAL
(); ;

809 35: 
»suÉ
 = 
	`V®id©eCAST
(); ;

810 36: 
»suÉ
 = 
	`V®id©eSqu¬e
(); ;

811 37: 
»suÉ
 = 
	`V®id©eRC2
(); ;

812 38: 
»suÉ
 = 
	`V®id©eRC6
(); ;

813 39: 
»suÉ
 = 
	`V®id©eMARS
(); ;

814 40: 
»suÉ
 = 
	`V®id©eRW
(); ;

815 41: 
»suÉ
 = 
	`V®id©eMD2
(); ;

816 42: 
»suÉ
 = 
	`V®id©eNR
(); ;

817 43: 
»suÉ
 = 
	`V®id©eMQV
(); ;

818 44: 
»suÉ
 = 
	`V®id©eRijnd«l
(); ;

819 45: 
»suÉ
 = 
	`V®id©eTwofish
(); ;

820 46: 
»suÉ
 = 
	`V®id©eS”³Á
(); ;

821 47: 
»suÉ
 = 
	`V®id©eCh”Modes
(); ;

822 48: 
»suÉ
 = 
	`V®id©eCRC32
(); ;

823 49: 
»suÉ
 = 
	`V®id©eECDSA
(); ;

824 50: 
»suÉ
 = 
	`V®id©eXTR_DH
(); ;

825 51: 
»suÉ
 = 
	`V®id©eSKIPJACK
(); ;

826 52: 
»suÉ
 = 
	`V®id©eSHA2
(); ;

827 53: 
»suÉ
 = 
	`V®id©ePªama
(); ;

828 54: 
»suÉ
 = 
	`V®id©eAdËr32
(); ;

829 55: 
»suÉ
 = 
	`V®id©eMD4
(); ;

830 56: 
»suÉ
 = 
	`V®id©ePBKDF
(); ;

831 57: 
»suÉ
 = 
	`V®id©eESIGN
(); ;

832 58: 
»suÉ
 = 
	`V®id©eDLIES
(); ;

833 59: 
»suÉ
 = 
	`V®id©eBa£Code
(); ;

834 60: 
»suÉ
 = 
	`V®id©eSHACAL2
(); ;

835 61: 
»suÉ
 = 
	`V®id©eCam–lŸ
(); ;

836 62: 
»suÉ
 = 
	`V®id©eWhœÍoŞ
(); ;

837 63: 
»suÉ
 = 
	`V®id©eTTMAC
(); ;

838 64: 
»suÉ
 = 
	`V®id©eS®§
(); ;

839 65: 
»suÉ
 = 
	`V®id©eSo£mªuk
(); ;

840 66: 
»suÉ
 = 
	`V®id©eVMAC
(); ;

841 67: 
»suÉ
 = 
	`V®id©eCCM
(); ;

842 68: 
»suÉ
 = 
	`V®id©eGCM
(); ;

843 69: 
»suÉ
 = 
	`V®id©eCMAC
(); ;

844 :  
çl£
;

847 
time_t
 
’dTime
 = 
	`time
(
NULL
);

848 
cout
 << "\nTe¡ƒnded‡ˆ" << 
	`asùime
(
	`loÿÉime
(&
’dTime
));

849 
cout
 << "S“d u£d was: " << 
£ed
 << 
’dl
;

851  
»suÉ
;

852 
	}
}

	@tftables.cpp

3 
	~"pch.h
"

4 
	~"twofish.h
"

6 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

8 cÚ¡ 
by‹
 
Twofish
::
Ba£
::
q
[2][256] = {

54 
	}
};

56 cÚ¡ 
wÜd32
 
	gTwofish
::
Ba£
::
mds
[4][256] = {

317 
	gNAMESPACE_END


	@tiger.cpp

3 
	~"pch.h
"

4 
	~"tig”.h
"

5 
	~"misc.h
"

6 
	~"ıu.h
"

8 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

10 
Tig”
::
	$In™S‹
(
HashWÜdTy³
 *
¡©e
)

12 
¡©e
[0] = 
	`W64LIT
(0x0123456789ABCDEF);

13 
¡©e
[1] = 
	`W64LIT
(0xFEDCBA9876543210);

14 
¡©e
[2] = 
	`W64LIT
(0xF096A5B4C3B2E187);

15 
	}
}

17 
	gTig”
::
	$Trunÿ‹dFš®
(
by‹
 *
hash
, 
size_t
 
size
)

19 
	`ThrowIfInv®idTrunÿ‹dSize
(
size
);

21 
	`PadLa¡Block
(56, 0x01);

22 
	`CÜ»ùEndŸÃss
(
m_d©a
, m_data, 56);

24 
m_d©a
[7] = 
	`G‘B™CouÁLo
();

26 
	`T¿nsfÜm
(
m_¡©e
, 
m_d©a
);

27 
	`CÜ»ùEndŸÃss
(
m_¡©e
, m_¡©e, 
	`Dige¡Size
());

28 
	`memıy
(
hash
, 
m_¡©e
, 
size
);

30 
	`Re¡¬t
();

31 
	}
}

33 
	gTig”
::
	$T¿nsfÜm
 (
wÜd64
 *
dige¡
, cÚ¡ wÜd64 *
X
)

35 #ià
CRYPTOPP_BOOL_SSE2_ASM_AVAILABLE
 && 
CRYPTOPP_BOOL_X86


36 ià(
	`HasSSE2
())

38 #ifdeà
__GNUC__


39 
__asm__
 
__vŞ©e__


42 
	`AS1
Ğ
push
 
ebx
)

44 #ià
_MSC_VER
 < 1300

45 cÚ¡ 
wÜd64
 *
t
 = 
bË
;

46 
	`AS2
Ğ
mov
 
edx
, 
t
)

48 
	`AS2
Ğ
Ëa
 
edx
, [
bË
])

50 
	`AS2
Ğ
mov
 
—x
, 
dige¡
)

51 
	`AS2
Ğ
mov
 
esi
, 
X
)

53 
	`AS2
Ğ
movq
 
mm0
, [
—x
])

54 
	`AS2
Ğ
movq
 
mm1
, [
—x
+1*8])

55 
	`AS2
Ğ
movq
 
mm5
, 
mm1
)

56 
	`AS2
Ğ
movq
 
mm2
, [
—x
+2*8])

57 
	`AS2
Ğ
movq
 
mm7
, [
edx
+4*2048+0*8])

58 
	`AS2
Ğ
movq
 
mm6
, [
edx
+4*2048+1*8])

59 
	`AS2
Ğ
mov
 
ecx
, 
e¥
)

60 
	`AS2
Ğ
ªd
 
e¥
, 0xfffffff0)

61 
	`AS2
Ğ
sub
 
e¥
, 8*8)

62 
	`AS1
Ğ
push
 
ecx
)

64 
	#SSE2_round
(
a
,
b
,
c
,
x
,
mul
) \

65 
	`AS2
Ğ
pxÜ
 
c
, [
x
])\

66 
	`AS2
Ğ
movd
 
ecx
, 
c
)\

67 
	`AS2
Ğ
movzx
 
edi
, 
ş
)\

68 
	`AS2
Ğ
movq
 
mm3
, [
edx
+0*2048+
edi
*8])\

69 
	`AS2
Ğ
movzx
 
edi
, 
ch
)\

70 
	`AS2
Ğ
movq
 
mm4
, [
edx
+3*2048+
edi
*8])\

71 
	`AS2
Ğ
shr
 
ecx
, 16)\

72 
	`AS2
Ğ
movzx
 
edi
, 
ş
)\

73 
	`AS2
Ğ
pxÜ
 
mm3
, [
edx
+1*2048+
edi
*8])\

74 
	`AS2
Ğ
movzx
 
edi
, 
ch
)\

75 
	`AS2
Ğ
pxÜ
 
mm4
, [
edx
+2*2048+
edi
*8])\

76 
	`AS3
Ğ
³xŒw
 
ecx
, 
c
, 2)\

77 
	`AS2
Ğ
movzx
 
edi
, 
ş
)\

78 
	`AS2
Ğ
pxÜ
 
mm3
, [
edx
+2*2048+
edi
*8])\

79 
	`AS2
Ğ
movzx
 
edi
, 
ch
)\

80 
	`AS2
Ğ
pxÜ
 
mm4
, [
edx
+1*2048+
edi
*8])\

81 
	`AS3
Ğ
³xŒw
 
ecx
, 
c
, 3)\

82 
	`AS2
Ğ
movzx
 
edi
, 
ş
)\

83 
	`AS2
Ğ
pxÜ
 
mm3
, [
edx
+3*2048+
edi
*8])\

84 
	`AS2
Ğ
psubq
 
a
, 
mm3
)\

85 
	`AS2
Ğ
movzx
 
edi
, 
ch
)\

86 
	`AS2
Ğ
pxÜ
 
mm4
, [
edx
+0*2048+
edi
*8])\

87 
	`AS2
Ğ
·ddq
 
b
, 
mm4
)\

88 
SSE2_mul_
##
	`mul
(
b
)

	)

90 
	#SSE2_mul_5
(
b
) \

91 
	`AS2
Ğ
movq
 
mm3
, 
b
)\

92 
	`AS2
Ğ
p¦lq
 
b
, 2)\

93 
	`AS2
Ğ
·ddq
 
b
, 
mm3
)

	)

95 
	#SSE2_mul_7
(
b
) \

96 
	`AS2
Ğ
movq
 
mm3
, 
b
)\

97 
	`AS2
Ğ
p¦lq
 
b
, 3)\

98 
	`AS2
Ğ
psubq
 
b
, 
mm3
)

	)

100 
	#SSE2_mul_9
(
b
) \

101 
	`AS2
Ğ
movq
 
mm3
, 
b
)\

102 
	`AS2
Ğ
p¦lq
 
b
, 3)\

103 
	`AS2
Ğ
·ddq
 
b
, 
mm3
)

	)

105 
	#Ïb–2_5
 1

	)

106 
	#Ïb–2_7
 2

	)

107 
	#Ïb–2_9
 3

	)

109 
	#SSE2_·ss
(
A
,
B
,
C
,
mul
,
X
) \

110 
	`AS2
Ğ
xÜ
 
ebx
,ƒbx)\

111 
	`ASL
(
mul
)\

112 
	`SSE2_round
(
A
,
B
,
C
,
X
+0*8+
ebx
,
mul
)\

113 
	`SSE2_round
(
B
,
C
,
A
,
X
+1*8+
ebx
,
mul
)\

114 
	`AS2
Ğ
cmp
 
ebx
, 6*8)\

115 
	`ASJ
Ğ
je
, 
Ïb–2_
##
mul
, 
f
)\

116 
	`SSE2_round
(
C
,
A
,
B
,
X
+2*8+
ebx
,
mul
)\

117 
	`AS2
Ğ
add
 
ebx
, 3*8)\

118 
	`ASJ
Ğ
jmp
, 
mul
, 
b
)\

119 
	`ASL
(
Ïb–2_
##
mul
)

	)

121 
	#SSE2_key_scheduË
(
Y
,
X
) \

122 
	`AS2
Ğ
movq
 
mm3
, [
X
+7*8])\

123 
	`AS2
Ğ
pxÜ
 
mm3
, 
mm6
)\

124 
	`AS2
Ğ
movq
 
mm4
, [
X
+0*8])\

125 
	`AS2
Ğ
psubq
 
mm4
, 
mm3
)\

126 
	`AS2
Ğ
movq
 [
Y
+0*8], 
mm4
)\

127 
	`AS2
Ğ
pxÜ
 
mm4
, [
X
+1*8])\

128 
	`AS2
Ğ
movq
 
mm3
, 
mm4
)\

129 
	`AS2
Ğ
movq
 [
Y
+1*8], 
mm4
)\

130 
	`AS2
Ğ
·ddq
 
mm4
, [
X
+2*8])\

131 
	`AS2
Ğ
pxÜ
 
mm3
, 
mm7
)\

132 
	`AS2
Ğ
p¦lq
 
mm3
, 19)\

133 
	`AS2
Ğ
movq
 [
Y
+2*8], 
mm4
)\

134 
	`AS2
Ğ
pxÜ
 
mm3
, 
mm4
)\

135 
	`AS2
Ğ
movq
 
mm4
, [
X
+3*8])\

136 
	`AS2
Ğ
psubq
 
mm4
, 
mm3
)\

137 
	`AS2
Ğ
movq
 [
Y
+3*8], 
mm4
)\

138 
	`AS2
Ğ
pxÜ
 
mm4
, [
X
+4*8])\

139 
	`AS2
Ğ
movq
 
mm3
, 
mm4
)\

140 
	`AS2
Ğ
movq
 [
Y
+4*8], 
mm4
)\

141 
	`AS2
Ğ
·ddq
 
mm4
, [
X
+5*8])\

142 
	`AS2
Ğ
pxÜ
 
mm3
, 
mm7
)\

143 
	`AS2
Ğ
p¤lq
 
mm3
, 23)\

144 
	`AS2
Ğ
movq
 [
Y
+5*8], 
mm4
)\

145 
	`AS2
Ğ
pxÜ
 
mm3
, 
mm4
)\

146 
	`AS2
Ğ
movq
 
mm4
, [
X
+6*8])\

147 
	`AS2
Ğ
psubq
 
mm4
, 
mm3
)\

148 
	`AS2
Ğ
movq
 [
Y
+6*8], 
mm4
)\

149 
	`AS2
Ğ
pxÜ
 
mm4
, [
X
+7*8])\

150 
	`AS2
Ğ
movq
 
mm3
, 
mm4
)\

151 
	`AS2
Ğ
movq
 [
Y
+7*8], 
mm4
)\

152 
	`AS2
Ğ
·ddq
 
mm4
, [
Y
+0*8])\

153 
	`AS2
Ğ
pxÜ
 
mm3
, 
mm7
)\

154 
	`AS2
Ğ
p¦lq
 
mm3
, 19)\

155 
	`AS2
Ğ
movq
 [
Y
+0*8], 
mm4
)\

156 
	`AS2
Ğ
pxÜ
 
mm3
, 
mm4
)\

157 
	`AS2
Ğ
movq
 
mm4
, [
Y
+1*8])\

158 
	`AS2
Ğ
psubq
 
mm4
, 
mm3
)\

159 
	`AS2
Ğ
movq
 [
Y
+1*8], 
mm4
)\

160 
	`AS2
Ğ
pxÜ
 
mm4
, [
Y
+2*8])\

161 
	`AS2
Ğ
movq
 
mm3
, 
mm4
)\

162 
	`AS2
Ğ
movq
 [
Y
+2*8], 
mm4
)\

163 
	`AS2
Ğ
·ddq
 
mm4
, [
Y
+3*8])\

164 
	`AS2
Ğ
pxÜ
 
mm3
, 
mm7
)\

165 
	`AS2
Ğ
p¤lq
 
mm3
, 23)\

166 
	`AS2
Ğ
movq
 [
Y
+3*8], 
mm4
)\

167 
	`AS2
Ğ
pxÜ
 
mm3
, 
mm4
)\

168 
	`AS2
Ğ
movq
 
mm4
, [
Y
+4*8])\

169 
	`AS2
Ğ
psubq
 
mm4
, 
mm3
)\

170 
	`AS2
Ğ
movq
 [
Y
+4*8], 
mm4
)\

171 
	`AS2
Ğ
pxÜ
 
mm4
, [
Y
+5*8])\

172 
	`AS2
Ğ
movq
 [
Y
+5*8], 
mm4
)\

173 
	`AS2
Ğ
·ddq
 
mm4
, [
Y
+6*8])\

174 
	`AS2
Ğ
movq
 [
Y
+6*8], 
mm4
)\

175 
	`AS2
Ğ
pxÜ
 
mm4
, [
edx
+4*2048+2*8])\

176 
	`AS2
Ğ
movq
 
mm3
, [
Y
+7*8])\

177 
	`AS2
Ğ
psubq
 
mm3
, 
mm4
)\

178 
	`AS2
Ğ
movq
 [
Y
+7*8], 
mm3
)

	)

180 
	`SSE2_·ss
(
mm0
, 
mm1
, 
mm2
, 5, 
esi
)

181 
	`SSE2_key_scheduË
(
e¥
+4, 
esi
)

182 
	`SSE2_·ss
(
mm2
, 
mm0
, 
mm1
, 7, 
e¥
+4)

183 
	`SSE2_key_scheduË
(
e¥
+4,ƒsp+4)

184 
	`SSE2_·ss
(
mm1
, 
mm2
, 
mm0
, 9, 
e¥
+4)

186 
	`AS2
Ğ
pxÜ
 
mm0
, [
—x
+0*8])

187 
	`AS2
Ğ
movq
 [
—x
+0*8], 
mm0
)

188 
	`AS2
Ğ
psubq
 
mm1
, 
mm5
)

189 
	`AS2
Ğ
movq
 [
—x
+1*8], 
mm1
)

190 
	`AS2
Ğ
·ddq
 
mm2
, [
—x
+2*8])

191 
	`AS2
Ğ
movq
 [
—x
+2*8], 
mm2
)

193 
	`AS1
Ğ
pİ
 
e¥
)

194 
	`AS1
Ğ
emms
)

195 #ifdeà
__GNUC__


196 
	`AS1
Ğ
pİ
 
ebx
)

199 : "a" (
dige¡
), "S" (
X
), "d" (
bË
)

207 
wÜd64
 
a
 = 
dige¡
[0];

208 
wÜd64
 
b
 = 
dige¡
[1];

209 
wÜd64
 
c
 = 
dige¡
[2];

210 
wÜd64
 
Y
[8];

212 
	#t1
 (
bË
)

	)

213 
	#t2
 (
bË
+256)

	)

214 
	#t3
 (
bË
+256*2)

	)

215 
	#t4
 (
bË
+256*3)

	)

217 
	#round
(
a
,
b
,
c
,
x
,
mul
) \

218 
c
 ^ğ
x
; \

219 
a
 -ğ
t1
[
	`GETBYTE
(
c
,0)] ^ 
t2
[GETBYTE(c,2)] ^ 
t3
[GETBYTE(c,4)] ^ 
t4
[GETBYTE(c,6)]; \

220 
b
 +ğ
t4
[
	`GETBYTE
(
c
,1)] ^ 
t3
[GETBYTE(c,3)] ^ 
t2
[GETBYTE(c,5)] ^ 
t1
[GETBYTE(c,7)]; \

221 
b
 *ğ
mul


	)

223 
	#·ss
(
a
,
b
,
c
,
mul
,
X
) {\

224 
i
=0;\

225 
Œue
)\

227 
	`round
(
a
,
b
,
c
,
X
[
i
+0],
mul
); \

228 
	`round
(
b
,
c
,
a
,
X
[
i
+1],
mul
); \

229 ià(
i
==6)\

231 
	`round
(
c
,
a
,
b
,
X
[
i
+2],
mul
); \

232 
i
+=3;\

233 }}

	)

235 
	#key_scheduË
(
Y
,
X
) \

236 
Y
[0] = 
X
[0] - (X[7]^
	`W64LIT
(0xA5A5A5A5A5A5A5A5)); \

237 
Y
[1] = 
X
[1] ^ Y[0]; \

238 
Y
[2] = 
X
[2] + Y[1]; \

239 
Y
[3] = 
X
[3] - (Y[2] ^ ((~Y[1])<<19)); \

240 
Y
[4] = 
X
[4] ^ Y[3]; \

241 
Y
[5] = 
X
[5] + Y[4]; \

242 
Y
[6] = 
X
[6] - (Y[5] ^ ((~Y[4])>>23)); \

243 
Y
[7] = 
X
[7] ^ Y[6]; \

244 
Y
[0] += Y[7]; \

245 
Y
[1] -= Y[0] ^ ((~Y[7])<<19); \

246 
Y
[2] ^= Y[1]; \

247 
Y
[3] += Y[2]; \

248 
Y
[4] -= Y[3] ^ ((~Y[2])>>23); \

249 
Y
[5] ^= Y[4]; \

250 
Y
[6] += Y[5]; \

251 
Y
[7] -ğY[6] ^ 
	`W64LIT
(0x0123456789ABCDEF)

	)

253 
	`·ss
(
a
,
b
,
c
,5,
X
);

254 
	`key_scheduË
(
Y
,
X
);

255 
	`·ss
(
c
,
a
,
b
,7,
Y
);

256 
	`key_scheduË
(
Y
,Y);

257 
	`·ss
(
b
,
c
,
a
,9,
Y
);

259 
dige¡
[0] = 
a
 ^ digest[0];

260 
dige¡
[1] = 
b
 - digest[1];

261 
dige¡
[2] = 
c
 + digest[2];

263 
	}
}

265 
	gNAMESPACE_END


	@tiger.h

1 #iâdeà
CRYPTOPP_TIGER_H


2 
	#CRYPTOPP_TIGER_H


	)

4 
	~"cÚfig.h
"

5 
	~"™”hash.h
"

7 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

10 
şass
 
Tig”
 : 
public
 
I‹¿‹dHashW™hSticT¿nsfÜm
<
wÜd64
, 
L™eEndŸn
, 64, 24, Tiger>

12 
public
:

13 
	`In™S‹
(
HashWÜdTy³
 *
¡©e
);

14 
	`T¿nsfÜm
(
wÜd64
 *
dige¡
, cÚ¡ wÜd64 *
d©a
);

15 
	`Trunÿ‹dFš®
(
by‹
 *
hash
, 
size_t
 
size
);

16 cÚ¡ * 
	`SticAlgÜ™hmName
() { "Tiger";}

18 
´Ùeùed
:

19 cÚ¡ 
wÜd64
 
bË
[4*256+3];

20 
	}
};

22 
	gNAMESPACE_END


	@tigertab.cpp

1 
	~"pch.h
"

2 
	~"tig”.h
"

4 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

6 cÚ¡ 
wÜd64
 
Tig”
::
bË
[4*256+3] =

8 
	`W64LIT
(0x02AAB17CF7E90C5E) , W64LIT(0xAC424B03E243A8EC) ,

9 
	`W64LIT
(0x72CD5BE30DD5FCD3) , W64LIT(0x6D019B93F6F97F3A) ,

10 
	`W64LIT
(0xCD9978FFD21F9193) , W64LIT(0x7573A1C9708029E2) ,

11 
	`W64LIT
(0xB164326B922A83C3) , W64LIT(0x46883EEE04915870) ,

12 
	`W64LIT
(0xEAACE3057103ECE6) , W64LIT(0xC54169B808A3535C) ,

13 
	`W64LIT
(0x4CE754918DDEC47C) , W64LIT(0x0AA2F4DFDC0DF40C) ,

14 
	`W64LIT
(0x10B76F18A74DBEFA) , W64LIT(0xC6CCB6235AD1AB6A) ,

15 
	`W64LIT
(0x13726121572FE2FF) , W64LIT(0x1A488C6F199D921E) ,

16 
	`W64LIT
(0x4BC9F9F4DA0007CA) , W64LIT(0x26F5E6F6E85241C7) ,

17 
	`W64LIT
(0x859079DBEA5947B6) , W64LIT(0x4F1885C5C99E8C92) ,

18 
	`W64LIT
(0xD78E761EA96F864B) , W64LIT(0x8E36428C52B5C17D) ,

19 
	`W64LIT
(0x69CF6827373063C1) , W64LIT(0xB607C93D9BB4C56E) ,

20 
	`W64LIT
(0x7D820E760E76B5EA) , W64LIT(0x645C9CC6F07FDC42) ,

21 
	`W64LIT
(0xBF38A078243342E0) , W64LIT(0x5F6B343C9D2E7D04) ,

22 
	`W64LIT
(0xF2C28AEB600B0EC6) , W64LIT(0x6C0ED85F7254BCAC) ,

23 
	`W64LIT
(0x71592281A4DB4FE5) , W64LIT(0x1967FA69CE0FED9F) ,

24 
	`W64LIT
(0xFD5293F8B96545DB) , W64LIT(0xC879E9D7F2A7600B) ,

25 
	`W64LIT
(0x860248920193194E) , W64LIT(0xA4F9533B2D9CC0B3) ,

26 
	`W64LIT
(0x9053836C15957613) , W64LIT(0xDB6DCF8AFC357BF1) ,

27 
	`W64LIT
(0x18BEEA7A7A370F57) , W64LIT(0x037117CA50B99066) ,

28 
	`W64LIT
(0x6AB30A9774424A35) , W64LIT(0xF4E92F02E325249B) ,

29 
	`W64LIT
(0x7739DB07061CCAE1) , W64LIT(0xD8F3B49CECA42A05) ,

30 
	`W64LIT
(0xBD56BE3F51382F73) , W64LIT(0x45FAED5843B0BB28) ,

31 
	`W64LIT
(0x1C813D5C11BF1F83) , W64LIT(0x8AF0E4B6D75FA169) ,

32 
	`W64LIT
(0x33EE18A487AD9999) , W64LIT(0x3C26E8EAB1C94410) ,

33 
	`W64LIT
(0xB510102BC0A822F9) , W64LIT(0x141EEF310CE6123B) ,

34 
	`W64LIT
(0xFC65B90059DDB154) , W64LIT(0xE0158640C5E0E607) ,

35 
	`W64LIT
(0x884E079826C3A3CF) , W64LIT(0x930D0D9523C535FD) ,

36 
	`W64LIT
(0x35638D754E9A2B00) , W64LIT(0x4085FCCF40469DD5) ,

37 
	`W64LIT
(0xC4B17AD28BE23A4C) , W64LIT(0xCAB2F0FC6A3E6A2E) ,

38 
	`W64LIT
(0x2860971A6B943FCD) , W64LIT(0x3DDE6EE212E30446) ,

39 
	`W64LIT
(0x6222F32AE01765AE) , W64LIT(0x5D550BB5478308FE) ,

40 
	`W64LIT
(0xA9EFA98DA0EDA22A) , W64LIT(0xC351A71686C40DA7) ,

41 
	`W64LIT
(0x1105586D9C867C84) , W64LIT(0xDCFFEE85FDA22853) ,

42 
	`W64LIT
(0xCCFBD0262C5EEF76) , W64LIT(0xBAF294CB8990D201) ,

43 
	`W64LIT
(0xE69464F52AFAD975) , W64LIT(0x94B013AFDF133E14) ,

44 
	`W64LIT
(0x06A7D1A32823C958) , W64LIT(0x6F95FE5130F61119) ,

45 
	`W64LIT
(0xD92AB34E462C06C0) , W64LIT(0xED7BDE33887C71D2) ,

46 
	`W64LIT
(0x79746D6E6518393E) , W64LIT(0x5BA419385D713329) ,

47 
	`W64LIT
(0x7C1BA6B948A97564) , W64LIT(0x31987C197BFDAC67) ,

48 
	`W64LIT
(0xDE6C23C44B053D02) , W64LIT(0x581C49FED002D64D) ,

49 
	`W64LIT
(0xDD474D6338261571) , W64LIT(0xAA4546C3E473D062) ,

50 
	`W64LIT
(0x928FCE349455F860) , W64LIT(0x48161BBACAAB94D9) ,

51 
	`W64LIT
(0x63912430770E6F68) , W64LIT(0x6EC8A5E602C6641C) ,

52 
	`W64LIT
(0x87282515337DDD2B) , W64LIT(0x2CDA6B42034B701B) ,

53 
	`W64LIT
(0xB03D37C181CB096D) , W64LIT(0xE108438266C71C6F) ,

54 
	`W64LIT
(0x2B3180C7EB51B255) , W64LIT(0xDF92B82F96C08BBC) ,

55 
	`W64LIT
(0x5C68C8C0A632F3BA) , W64LIT(0x5504CC861C3D0556) ,

56 
	`W64LIT
(0xABBFA4E55FB26B8F) , W64LIT(0x41848B0AB3BACEB4) ,

57 
	`W64LIT
(0xB334A273AA445D32) , W64LIT(0xBCA696F0A85AD881) ,

58 
	`W64LIT
(0x24F6EC65B528D56C) , W64LIT(0x0CE1512E90F4524A) ,

59 
	`W64LIT
(0x4E9DD79D5506D35A) , W64LIT(0x258905FAC6CE9779) ,

60 
	`W64LIT
(0x2019295B3E109B33) , W64LIT(0xF8A9478B73A054CC) ,

61 
	`W64LIT
(0x2924F2F934417EB0) , W64LIT(0x3993357D536D1BC4) ,

62 
	`W64LIT
(0x38A81AC21DB6FF8B) , W64LIT(0x47C4FBF17D6016BF) ,

63 
	`W64LIT
(0x1E0FAADD7667E3F5) , W64LIT(0x7ABCFF62938BEB96) ,

64 
	`W64LIT
(0xA78DAD948FC179C9) , W64LIT(0x8F1F98B72911E50D) ,

65 
	`W64LIT
(0x61E48EAE27121A91) , W64LIT(0x4D62F7AD31859808) ,

66 
	`W64LIT
(0xECEBA345EF5CEAEB) , W64LIT(0xF5CEB25EBC9684CE) ,

67 
	`W64LIT
(0xF633E20CB7F76221) , W64LIT(0xA32CDF06AB8293E4) ,

68 
	`W64LIT
(0x985A202CA5EE2CA4) , W64LIT(0xCF0B8447CC8A8FB1) ,

69 
	`W64LIT
(0x9F765244979859A3) , W64LIT(0xA8D516B1A1240017) ,

70 
	`W64LIT
(0x0BD7BA3EBB5DC726) , W64LIT(0xE54BCA55B86ADB39) ,

71 
	`W64LIT
(0x1D7A3AFD6C478063) , W64LIT(0x519EC608E7669EDD) ,

72 
	`W64LIT
(0x0E5715A2D149AA23) , W64LIT(0x177D4571848FF194) ,

73 
	`W64LIT
(0xEEB55F3241014C22) , W64LIT(0x0F5E5CA13A6E2EC2) ,

74 
	`W64LIT
(0x8029927B75F5C361) , W64LIT(0xAD139FABC3D6E436) ,

75 
	`W64LIT
(0x0D5DF1A94CCF402F) , W64LIT(0x3E8BD948BEA5DFC8) ,

76 
	`W64LIT
(0xA5A0D357BD3FF77E) , W64LIT(0xA2D12E251F74F645) ,

77 
	`W64LIT
(0x66FD9E525E81A082) , W64LIT(0x2E0C90CE7F687A49) ,

78 
	`W64LIT
(0xC2E8BCBEBA973BC5) , W64LIT(0x000001BCE509745F) ,

79 
	`W64LIT
(0x423777BBE6DAB3D6) , W64LIT(0xD1661C7EAEF06EB5) ,

80 
	`W64LIT
(0xA1781F354DAACFD8) , W64LIT(0x2D11284A2B16AFFC) ,

81 
	`W64LIT
(0xF1FC4F67FA891D1F) , W64LIT(0x73ECC25DCB920ADA) ,

82 
	`W64LIT
(0xAE610C22C2A12651) , W64LIT(0x96E0A810D356B78A) ,

83 
	`W64LIT
(0x5A9A381F2FE7870F) , W64LIT(0xD5AD62EDE94E5530) ,

84 
	`W64LIT
(0xD225E5E8368D1427) , W64LIT(0x65977B70C7AF4631) ,

85 
	`W64LIT
(0x99F889B2DE39D74F) , W64LIT(0x233F30BF54E1D143) ,

86 
	`W64LIT
(0x9A9675D3D9A63C97) , W64LIT(0x5470554FF334F9A8) ,

87 
	`W64LIT
(0x166ACB744A4F5688) , W64LIT(0x70C74CAAB2E4AEAD) ,

88 
	`W64LIT
(0xF0D091646F294D12) , W64LIT(0x57B82A89684031D1) ,

89 
	`W64LIT
(0xEFD95A5A61BE0B6B) , W64LIT(0x2FBD12E969F2F29A) ,

90 
	`W64LIT
(0x9BD37013FEFF9FE8) , W64LIT(0x3F9B0404D6085A06) ,

91 
	`W64LIT
(0x4940C1F3166CFE15) , W64LIT(0x09542C4DCDF3DEFB) ,

92 
	`W64LIT
(0xB4C5218385CD5CE3) , W64LIT(0xC935B7DC4462A641) ,

93 
	`W64LIT
(0x3417F8A68ED3B63F) , W64LIT(0xB80959295B215B40) ,

94 
	`W64LIT
(0xF99CDAEF3B8C8572) , W64LIT(0x018C0614F8FCB95D) ,

95 
	`W64LIT
(0x1B14ACCD1A3ACDF3) , W64LIT(0x84D471F200BB732D) ,

96 
	`W64LIT
(0xC1A3110E95E8DA16) , W64LIT(0x430A7220BF1A82B8) ,

97 
	`W64LIT
(0xB77E090D39DF210E) , W64LIT(0x5EF4BD9F3CD05E9D) ,

98 
	`W64LIT
(0x9D4FF6DA7E57A444) , W64LIT(0xDA1D60E183D4A5F8) ,

99 
	`W64LIT
(0xB287C38417998E47) , W64LIT(0xFE3EDC121BB31886) ,

100 
	`W64LIT
(0xC7FE3CCC980CCBEF) , W64LIT(0xE46FB590189BFD03) ,

101 
	`W64LIT
(0x3732FD469A4C57DC) , W64LIT(0x7EF700A07CF1AD65) ,

102 
	`W64LIT
(0x59C64468A31D8859) , W64LIT(0x762FB0B4D45B61F6) ,

103 
	`W64LIT
(0x155BAED099047718) , W64LIT(0x68755E4C3D50BAA6) ,

104 
	`W64LIT
(0xE9214E7F22D8B4DF) , W64LIT(0x2ADDBF532EAC95F4) ,

105 
	`W64LIT
(0x32AE3909B4BD0109) , W64LIT(0x834DF537B08E3450) ,

106 
	`W64LIT
(0xFA209DA84220728D) , W64LIT(0x9E691D9B9EFE23F7) ,

107 
	`W64LIT
(0x0446D288C4AE8D7F) , W64LIT(0x7B4CC524E169785B) ,

108 
	`W64LIT
(0x21D87F0135CA1385) , W64LIT(0xCEBB400F137B8AA5) ,

109 
	`W64LIT
(0x272E2B66580796BE) , W64LIT(0x3612264125C2B0DE) ,

110 
	`W64LIT
(0x057702BDAD1EFBB2) , W64LIT(0xD4BABB8EACF84BE9) ,

111 
	`W64LIT
(0x91583139641BC67B) , W64LIT(0x8BDC2DE08036E024) ,

112 
	`W64LIT
(0x603C8156F49F68ED) , W64LIT(0xF7D236F7DBEF5111) ,

113 
	`W64LIT
(0x9727C4598AD21E80) , W64LIT(0xA08A0896670A5FD7) ,

114 
	`W64LIT
(0xCB4A8F4309EBA9CB) , W64LIT(0x81AF564B0F7036A1) ,

115 
	`W64LIT
(0xC0B99AA778199ABD) , W64LIT(0x959F1EC83FC8E952) ,

116 
	`W64LIT
(0x8C505077794A81B9) , W64LIT(0x3ACAAF8F056338F0) ,

117 
	`W64LIT
(0x07B43F50627A6778) , W64LIT(0x4A44AB49F5ECCC77) ,

118 
	`W64LIT
(0x3BC3D6E4B679EE98) , W64LIT(0x9CC0D4D1CF14108C) ,

119 
	`W64LIT
(0x4406C00B206BC8A0) , W64LIT(0x82A18854C8D72D89) ,

120 
	`W64LIT
(0x67E366B35C3C432C) , W64LIT(0xB923DD61102B37F2) ,

121 
	`W64LIT
(0x56AB2779D884271D) , W64LIT(0xBE83E1B0FF1525AF) ,

122 
	`W64LIT
(0xFB7C65D4217E49A9) , W64LIT(0x6BDBE0E76D48E7D4) ,

123 
	`W64LIT
(0x08DF828745D9179E) , W64LIT(0x22EA6A9ADD53BD34) ,

124 
	`W64LIT
(0xE36E141C5622200A) , W64LIT(0x7F805D1B8CB750EE) ,

125 
	`W64LIT
(0xAFE5C7A59F58E837) , W64LIT(0xE27F996A4FB1C23C) ,

126 
	`W64LIT
(0xD3867DFB0775F0D0) , W64LIT(0xD0E673DE6E88891A) ,

127 
	`W64LIT
(0x123AEB9EAFB86C25) , W64LIT(0x30F1D5D5C145B895) ,

128 
	`W64LIT
(0xBB434A2DEE7269E7) , W64LIT(0x78CB67ECF931FA38) ,

129 
	`W64LIT
(0xF33B0372323BBF9C) , W64LIT(0x52D66336FB279C74) ,

130 
	`W64LIT
(0x505F33AC0AFB4EAA) , W64LIT(0xE8A5CD99A2CCE187) ,

131 
	`W64LIT
(0x534974801E2D30BB) , W64LIT(0x8D2D5711D5876D90) ,

132 
	`W64LIT
(0x1F1A412891BC038E) , W64LIT(0xD6E2E71D82E56648) ,

133 
	`W64LIT
(0x74036C3A497732B7) , W64LIT(0x89B67ED96361F5AB) ,

134 
	`W64LIT
(0xFFED95D8F1EA02A2) , W64LIT(0xE72B3BD61464D43D) ,

135 
	`W64LIT
(0xA6300F170BDC4820) , W64LIT(0xEBC18760ED78A77A) ,

136 
	`W64LIT
(0xE6A6BE5A05A12138) , W64LIT(0xB5A122A5B4F87C98) ,

137 
	`W64LIT
(0x563C6089140B6990) , W64LIT(0x4C46CB2E391F5DD5) ,

138 
	`W64LIT
(0xD932ADDBC9B79434) , W64LIT(0x08EA70E42015AFF5) ,

139 
	`W64LIT
(0xD765A6673E478CF1) , W64LIT(0xC4FB757EAB278D99) ,

140 
	`W64LIT
(0xDF11C6862D6E0692) , W64LIT(0xDDEB84F10D7F3B16) ,

141 
	`W64LIT
(0x6F2EF604A665EA04) , W64LIT(0x4A8E0F0FF0E0DFB3) ,

142 
	`W64LIT
(0xA5EDEEF83DBCBA51) , W64LIT(0xFC4F0A2A0EA4371E) ,

143 
	`W64LIT
(0xE83E1DA85CB38429) , W64LIT(0xDC8FF882BA1B1CE2) ,

144 
	`W64LIT
(0xCD45505E8353E80D) , W64LIT(0x18D19A00D4DB0717) ,

145 
	`W64LIT
(0x34A0CFEDA5F38101) , W64LIT(0x0BE77E518887CAF2) ,

146 
	`W64LIT
(0x1E341438B3C45136) , W64LIT(0xE05797F49089CCF9) ,

147 
	`W64LIT
(0xFFD23F9DF2591D14) , W64LIT(0x543DDA228595C5CD) ,

148 
	`W64LIT
(0x661F81FD99052A33) , W64LIT(0x8736E641DB0F7B76) ,

149 
	`W64LIT
(0x15227725418E5307) , W64LIT(0xE25F7F46162EB2FA) ,

150 
	`W64LIT
(0x48A8B2126C13D9FE) , W64LIT(0xAFDC541792E76EEA) ,

151 
	`W64LIT
(0x03D912BFC6D1898F) , W64LIT(0x31B1AAFA1B83F51B) ,

152 
	`W64LIT
(0xF1AC2796E42AB7D9) , W64LIT(0x40A3A7D7FCD2EBAC) ,

153 
	`W64LIT
(0x1056136D0AFBBCC5) , W64LIT(0x7889E1DD9A6D0C85) ,

154 
	`W64LIT
(0xD33525782A7974AA) , W64LIT(0xA7E25D09078AC09B) ,

155 
	`W64LIT
(0xBD4138B3EAC6EDD0) , W64LIT(0x920ABFBE71EB9E70) ,

156 
	`W64LIT
(0xA2A5D0F54FC2625C) , W64LIT(0xC054E36B0B1290A3) ,

157 
	`W64LIT
(0xF6DD59FF62FE932B) , W64LIT(0x3537354511A8AC7D) ,

158 
	`W64LIT
(0xCA845E9172FADCD4) , W64LIT(0x84F82B60329D20DC) ,

159 
	`W64LIT
(0x79C62CE1CD672F18) , W64LIT(0x8B09A2ADD124642C) ,

160 
	`W64LIT
(0xD0C1E96A19D9E726) , W64LIT(0x5A786A9B4BA9500C) ,

161 
	`W64LIT
(0x0E020336634C43F3) , W64LIT(0xC17B474AEB66D822) ,

162 
	`W64LIT
(0x6A731AE3EC9BAAC2) , W64LIT(0x8226667AE0840258) ,

163 
	`W64LIT
(0x67D4567691CAECA5) , W64LIT(0x1D94155C4875ADB5) ,

164 
	`W64LIT
(0x6D00FD985B813FDF) , W64LIT(0x51286EFCB774CD06) ,

165 
	`W64LIT
(0x5E8834471FA744AF) , W64LIT(0xF72CA0AEE761AE2E) ,

166 
	`W64LIT
(0xBE40E4CDAEE8E09A) , W64LIT(0xE9970BBB5118F665) ,

167 
	`W64LIT
(0x726E4BEB33DF1964) , W64LIT(0x703B000729199762) ,

168 
	`W64LIT
(0x4631D816F5EF30A7) , W64LIT(0xB880B5B51504A6BE) ,

169 
	`W64LIT
(0x641793C37ED84B6C) , W64LIT(0x7B21ED77F6E97D96) ,

170 
	`W64LIT
(0x776306312EF96B73) , W64LIT(0xAE528948E86FF3F4) ,

171 
	`W64LIT
(0x53DBD7F286A3F8F8) , W64LIT(0x16CADCE74CFC1063) ,

172 
	`W64LIT
(0x005C19BDFA52C6DD) , W64LIT(0x68868F5D64D46AD3) ,

173 
	`W64LIT
(0x3A9D512CCF1E186A) , W64LIT(0x367E62C2385660AE) ,

174 
	`W64LIT
(0xE359E7EA77DCB1D7) , W64LIT(0x526C0773749ABE6E) ,

175 
	`W64LIT
(0x735AE5F9D09F734B) , W64LIT(0x493FC7CC8A558BA8) ,

176 
	`W64LIT
(0xB0B9C1533041AB45) , W64LIT(0x321958BA470A59BD) ,

177 
	`W64LIT
(0x852DB00B5F46C393) , W64LIT(0x91209B2BD336B0E5) ,

178 
	`W64LIT
(0x6E604F7D659EF19F) , W64LIT(0xB99A8AE2782CCB24) ,

179 
	`W64LIT
(0xCCF52AB6C814C4C7) , W64LIT(0x4727D9AFBE11727B) ,

180 
	`W64LIT
(0x7E950D0C0121B34D) , W64LIT(0x756F435670AD471F) ,

181 
	`W64LIT
(0xF5ADD442615A6849) , W64LIT(0x4E87E09980B9957A) ,

182 
	`W64LIT
(0x2ACFA1DF50AEE355) , W64LIT(0xD898263AFD2FD556) ,

183 
	`W64LIT
(0xC8F4924DD80C8FD6) , W64LIT(0xCF99CA3D754A173A) ,

184 
	`W64LIT
(0xFE477BACAF91BF3C) , W64LIT(0xED5371F6D690C12D) ,

185 
	`W64LIT
(0x831A5C285E687094) , W64LIT(0xC5D3C90A3708A0A4) ,

186 
	`W64LIT
(0x0F7F903717D06580) , W64LIT(0x19F9BB13B8FDF27F) ,

187 
	`W64LIT
(0xB1BD6F1B4D502843) , W64LIT(0x1C761BA38FFF4012) ,

188 
	`W64LIT
(0x0D1530C4E2E21F3B) , W64LIT(0x8943CE69A7372C8A) ,

189 
	`W64LIT
(0xE5184E11FEB5CE66) , W64LIT(0x618BDB80BD736621) ,

190 
	`W64LIT
(0x7D29BAD68B574D0B) , W64LIT(0x81BB613E25E6FE5B) ,

191 
	`W64LIT
(0x071C9C10BC07913F) , W64LIT(0xC7BEEB7909AC2D97) ,

192 
	`W64LIT
(0xC3E58D353BC5D757) , W64LIT(0xEB017892F38F61E8) ,

193 
	`W64LIT
(0xD4EFFB9C9B1CC21A) , W64LIT(0x99727D26F494F7AB) ,

194 
	`W64LIT
(0xA3E063A2956B3E03) , W64LIT(0x9D4A8B9A4AA09C30) ,

195 
	`W64LIT
(0x3F6AB7D500090FB4) , W64LIT(0x9CC0F2A057268AC0) ,

196 
	`W64LIT
(0x3DEE9D2DEDBF42D1) , W64LIT(0x330F49C87960A972) ,

197 
	`W64LIT
(0xC6B2720287421B41) , W64LIT(0x0AC59EC07C00369C) ,

198 
	`W64LIT
(0xEF4EAC49CB353425) , W64LIT(0xF450244EEF0129D8) ,

199 
	`W64LIT
(0x8ACC46E5CAF4DEB6) , W64LIT(0x2FFEAB63989263F7) ,

200 
	`W64LIT
(0x8F7CB9FE5D7A4578) , W64LIT(0x5BD8F7644E634635) ,

201 
	`W64LIT
(0x427A7315BF2DC900) , W64LIT(0x17D0C4AA2125261C) ,

202 
	`W64LIT
(0x3992486C93518E50) , W64LIT(0xB4CBFEE0A2D7D4C3) ,

203 
	`W64LIT
(0x7C75D6202C5DDD8D) , W64LIT(0xDBC295D8E35B6C61) ,

204 
	`W64LIT
(0x60B369D302032B19) , W64LIT(0xCE42685FDCE44132) ,

205 
	`W64LIT
(0x06F3DDB9DDF65610) , W64LIT(0x8EA4D21DB5E148F0) ,

206 
	`W64LIT
(0x20B0FCE62FCD496F) , W64LIT(0x2C1B912358B0EE31) ,

207 
	`W64LIT
(0xB28317B818F5A308) , W64LIT(0xA89C1E189CA6D2CF) ,

208 
	`W64LIT
(0x0C6B18576AAADBC8) , W64LIT(0xB65DEAA91299FAE3) ,

209 
	`W64LIT
(0xFB2B794B7F1027E7) , W64LIT(0x04E4317F443B5BEB) ,

210 
	`W64LIT
(0x4B852D325939D0A6) , W64LIT(0xD5AE6BEEFB207FFC) ,

211 
	`W64LIT
(0x309682B281C7D374) , W64LIT(0xBAE309A194C3B475) ,

212 
	`W64LIT
(0x8CC3F97B13B49F05) , W64LIT(0x98A9422FF8293967) ,

213 
	`W64LIT
(0x244B16B01076FF7C) , W64LIT(0xF8BF571C663D67EE) ,

214 
	`W64LIT
(0x1F0D6758EEE30DA1) , W64LIT(0xC9B611D97ADEB9B7) ,

215 
	`W64LIT
(0xB7AFD5887B6C57A2) , W64LIT(0x6290AE846B984FE1) ,

216 
	`W64LIT
(0x94DF4CDEACC1A5FD) , W64LIT(0x058A5BD1C5483AFF) ,

217 
	`W64LIT
(0x63166CC142BA3C37) , W64LIT(0x8DB8526EB2F76F40) ,

218 
	`W64LIT
(0xE10880036F0D6D4E) , W64LIT(0x9E0523C9971D311D) ,

219 
	`W64LIT
(0x45EC2824CC7CD691) , W64LIT(0x575B8359E62382C9) ,

220 
	`W64LIT
(0xFA9E400DC4889995) , W64LIT(0xD1823ECB45721568) ,

221 
	`W64LIT
(0xDAFD983B8206082F) , W64LIT(0xAA7D29082386A8CB) ,

222 
	`W64LIT
(0x269FCD4403B87588) , W64LIT(0x1B91F5F728BDD1E0) ,

223 
	`W64LIT
(0xE4669F39040201F6) , W64LIT(0x7A1D7C218CF04ADE) ,

224 
	`W64LIT
(0x65623C29D79CE5CE) , W64LIT(0x2368449096C00BB1) ,

225 
	`W64LIT
(0xAB9BF1879DA503BA) , W64LIT(0xBC23ECB1A458058E) ,

226 
	`W64LIT
(0x9A58DF01BB401ECC) , W64LIT(0xA070E868A85F143D) ,

227 
	`W64LIT
(0x4FF188307DF2239E) , W64LIT(0x14D565B41A641183) ,

228 
	`W64LIT
(0xEE13337452701602) , W64LIT(0x950E3DCF3F285E09) ,

229 
	`W64LIT
(0x59930254B9C80953) , W64LIT(0x3BF299408930DA6D) ,

230 
	`W64LIT
(0xA955943F53691387) , W64LIT(0xA15EDECAA9CB8784) ,

231 
	`W64LIT
(0x29142127352BE9A0) , W64LIT(0x76F0371FFF4E7AFB) ,

232 
	`W64LIT
(0x0239F450274F2228) , W64LIT(0xBB073AF01D5E868B) ,

233 
	`W64LIT
(0xBFC80571C10E96C1) , W64LIT(0xD267088568222E23) ,

234 
	`W64LIT
(0x9671A3D48E80B5B0) , W64LIT(0x55B5D38AE193BB81) ,

235 
	`W64LIT
(0x693AE2D0A18B04B8) , W64LIT(0x5C48B4ECADD5335F) ,

236 
	`W64LIT
(0xFD743B194916A1CA) , W64LIT(0x2577018134BE98C4) ,

237 
	`W64LIT
(0xE77987E83C54A4AD) , W64LIT(0x28E11014DA33E1B9) ,

238 
	`W64LIT
(0x270CC59E226AA213) , W64LIT(0x71495F756D1A5F60) ,

239 
	`W64LIT
(0x9BE853FB60AFEF77) , W64LIT(0xADC786A7F7443DBF) ,

240 
	`W64LIT
(0x0904456173B29A82) , W64LIT(0x58BC7A66C232BD5E) ,

241 
	`W64LIT
(0xF306558C673AC8B2) , W64LIT(0x41F639C6B6C9772A) ,

242 
	`W64LIT
(0x216DEFE99FDA35DA) , W64LIT(0x11640CC71C7BE615) ,

243 
	`W64LIT
(0x93C43694565C5527) , W64LIT(0xEA038E6246777839) ,

244 
	`W64LIT
(0xF9ABF3CE5A3E2469) , W64LIT(0x741E768D0FD312D2) ,

245 
	`W64LIT
(0x0144B883CED652C6) , W64LIT(0xC20B5A5BA33F8552) ,

246 
	`W64LIT
(0x1AE69633C3435A9D) , W64LIT(0x97A28CA4088CFDEC) ,

247 
	`W64LIT
(0x8824A43C1E96F420) , W64LIT(0x37612FA66EEEA746) ,

248 
	`W64LIT
(0x6B4CB165F9CF0E5A) , W64LIT(0x43AA1C06A0ABFB4A) ,

249 
	`W64LIT
(0x7F4DC26FF162796B) , W64LIT(0x6CBACC8E54ED9B0F) ,

250 
	`W64LIT
(0xA6B7FFEFD2BB253E) , W64LIT(0x2E25BC95B0A29D4F) ,

251 
	`W64LIT
(0x86D6A58BDEF1388C) , W64LIT(0xDED74AC576B6F054) ,

252 
	`W64LIT
(0x8030BDBC2B45805D) , W64LIT(0x3C81AF70E94D9289) ,

253 
	`W64LIT
(0x3EFF6DDA9E3100DB) , W64LIT(0xB38DC39FDFCC8847) ,

254 
	`W64LIT
(0x123885528D17B87E) , W64LIT(0xF2DA0ED240B1B642) ,

255 
	`W64LIT
(0x44CEFADCD54BF9A9) , W64LIT(0x1312200E433C7EE6) ,

256 
	`W64LIT
(0x9FFCC84F3A78C748) , W64LIT(0xF0CD1F72248576BB) ,

257 
	`W64LIT
(0xEC6974053638CFE4) , W64LIT(0x2BA7B67C0CEC4E4C) ,

258 
	`W64LIT
(0xAC2F4DF3E5CE32ED) , W64LIT(0xCB33D14326EA4C11) ,

259 
	`W64LIT
(0xA4E9044CC77E58BC) , W64LIT(0x5F513293D934FCEF) ,

260 
	`W64LIT
(0x5DC9645506E55444) , W64LIT(0x50DE418F317DE40A) ,

261 
	`W64LIT
(0x388CB31A69DDE259) , W64LIT(0x2DB4A83455820A86) ,

262 
	`W64LIT
(0x9010A91E84711AE9) , W64LIT(0x4DF7F0B7B1498371) ,

263 
	`W64LIT
(0xD62A2EABC0977179) , W64LIT(0x22FAC097AA8D5C0E) ,

264 
	`W64LIT
(0xF49FCC2FF1DAF39B) , W64LIT(0x487FD5C66FF29281) ,

265 
	`W64LIT
(0xE8A30667FCDCA83F) , W64LIT(0x2C9B4BE3D2FCCE63) ,

266 
	`W64LIT
(0xDA3FF74B93FBBBC2) , W64LIT(0x2FA165D2FE70BA66) ,

267 
	`W64LIT
(0xA103E279970E93D4) , W64LIT(0xBECDEC77B0E45E71) ,

268 
	`W64LIT
(0xCFB41E723985E497) , W64LIT(0xB70AAA025EF75017) ,

269 
	`W64LIT
(0xD42309F03840B8E0) , W64LIT(0x8EFC1AD035898579) ,

270 
	`W64LIT
(0x96C6920BE2B2ABC5) , W64LIT(0x66AF4163375A9172) ,

271 
	`W64LIT
(0x2174ABDCCA7127FB) , W64LIT(0xB33CCEA64A72FF41) ,

272 
	`W64LIT
(0xF04A4933083066A5) , W64LIT(0x8D970ACDD7289AF5) ,

273 
	`W64LIT
(0x8F96E8E031C8C25E) , W64LIT(0xF3FEC02276875D47) ,

274 
	`W64LIT
(0xEC7BF310056190DD) , W64LIT(0xF5ADB0AEBB0F1491) ,

275 
	`W64LIT
(0x9B50F8850FD58892) , W64LIT(0x4975488358B74DE8) ,

276 
	`W64LIT
(0xA3354FF691531C61) , W64LIT(0x0702BBE481D2C6EE) ,

277 
	`W64LIT
(0x89FB24057DEDED98) , W64LIT(0xAC3075138596E902) ,

278 
	`W64LIT
(0x1D2D3580172772ED) , W64LIT(0xEB738FC28E6BC30D) ,

279 
	`W64LIT
(0x5854EF8F63044326) , W64LIT(0x9E5C52325ADD3BBE) ,

280 
	`W64LIT
(0x90AA53CF325C4623) , W64LIT(0xC1D24D51349DD067) ,

281 
	`W64LIT
(0x2051CFEEA69EA624) , W64LIT(0x13220F0A862E7E4F) ,

282 
	`W64LIT
(0xCE39399404E04864) , W64LIT(0xD9C42CA47086FCB7) ,

283 
	`W64LIT
(0x685AD2238A03E7CC) , W64LIT(0x066484B2AB2FF1DB) ,

284 
	`W64LIT
(0xFE9D5D70EFBF79EC) , W64LIT(0x5B13B9DD9C481854) ,

285 
	`W64LIT
(0x15F0D475ED1509AD) , W64LIT(0x0BEBCD060EC79851) ,

286 
	`W64LIT
(0xD58C6791183AB7F8) , W64LIT(0xD1187C5052F3EEE4) ,

287 
	`W64LIT
(0xC95D1192E54E82FF) , W64LIT(0x86EEA14CB9AC6CA2) ,

288 
	`W64LIT
(0x3485BEB153677D5D) , W64LIT(0xDD191D781F8C492A) ,

289 
	`W64LIT
(0xF60866BAA784EBF9) , W64LIT(0x518F643BA2D08C74) ,

290 
	`W64LIT
(0x8852E956E1087C22) , W64LIT(0xA768CB8DC410AE8D) ,

291 
	`W64LIT
(0x38047726BFEC8E1A) , W64LIT(0xA67738B4CD3B45AA) ,

292 
	`W64LIT
(0xAD16691CEC0DDE19) , W64LIT(0xC6D4319380462E07) ,

293 
	`W64LIT
(0xC5A5876D0BA61938) , W64LIT(0x16B9FA1FA58FD840) ,

294 
	`W64LIT
(0x188AB1173CA74F18) , W64LIT(0xABDA2F98C99C021F) ,

295 
	`W64LIT
(0x3E0580AB134AE816) , W64LIT(0x5F3B05B773645ABB) ,

296 
	`W64LIT
(0x2501A2BE5575F2F6) , W64LIT(0x1B2F74004E7E8BA9) ,

297 
	`W64LIT
(0x1CD7580371E8D953) , W64LIT(0x7F6ED89562764E30) ,

298 
	`W64LIT
(0xB15926FF596F003D) , W64LIT(0x9F65293DA8C5D6B9) ,

299 
	`W64LIT
(0x6ECEF04DD690F84C) , W64LIT(0x4782275FFF33AF88) ,

300 
	`W64LIT
(0xE41433083F820801) , W64LIT(0xFD0DFE409A1AF9B5) ,

301 
	`W64LIT
(0x4325A3342CDB396B) , W64LIT(0x8AE77E62B301B252) ,

302 
	`W64LIT
(0xC36F9E9F6655615A) , W64LIT(0x85455A2D92D32C09) ,

303 
	`W64LIT
(0xF2C7DEA949477485) , W64LIT(0x63CFB4C133A39EBA) ,

304 
	`W64LIT
(0x83B040CC6EBC5462) , W64LIT(0x3B9454C8FDB326B0) ,

305 
	`W64LIT
(0x56F56A9E87FFD78C) , W64LIT(0x2DC2940D99F42BC6) ,

306 
	`W64LIT
(0x98F7DF096B096E2D) , W64LIT(0x19A6E01E3AD852BF) ,

307 
	`W64LIT
(0x42A99CCBDBD4B40B) , W64LIT(0xA59998AF45E9C559) ,

308 
	`W64LIT
(0x366295E807D93186) , W64LIT(0x6B48181BFAA1F773) ,

309 
	`W64LIT
(0x1FEC57E2157A0A1D) , W64LIT(0x4667446AF6201AD5) ,

310 
	`W64LIT
(0xE615EBCACFB0F075) , W64LIT(0xB8F31F4F68290778) ,

311 
	`W64LIT
(0x22713ED6CE22D11E) , W64LIT(0x3057C1A72EC3C93B) ,

312 
	`W64LIT
(0xCB46ACC37C3F1F2F) , W64LIT(0xDBB893FD02AAF50E) ,

313 
	`W64LIT
(0x331FD92E600B9FCF) , W64LIT(0xA498F96148EA3AD6) ,

314 
	`W64LIT
(0xA8D8426E8B6A83EA) , W64LIT(0xA089B274B7735CDC) ,

315 
	`W64LIT
(0x87F6B3731E524A11) , W64LIT(0x118808E5CBC96749) ,

316 
	`W64LIT
(0x9906E4C7B19BD394) , W64LIT(0xAFED7F7E9B24A20C) ,

317 
	`W64LIT
(0x6509EADEEB3644A7) , W64LIT(0x6C1EF1D3E8EF0EDE) ,

318 
	`W64LIT
(0xB9C97D43E9798FB4) , W64LIT(0xA2F2D784740C28A3) ,

319 
	`W64LIT
(0x7B8496476197566F) , W64LIT(0x7A5BE3E6B65F069D) ,

320 
	`W64LIT
(0xF96330ED78BE6F10) , W64LIT(0xEEE60DE77A076A15) ,

321 
	`W64LIT
(0x2B4BEE4AA08B9BD0) , W64LIT(0x6A56A63EC7B8894E) ,

322 
	`W64LIT
(0x02121359BA34FEF4) , W64LIT(0x4CBF99F8283703FC) ,

323 
	`W64LIT
(0x398071350CAF30C8) , W64LIT(0xD0A77A89F017687A) ,

324 
	`W64LIT
(0xF1C1A9EB9E423569) , W64LIT(0x8C7976282DEE8199) ,

325 
	`W64LIT
(0x5D1737A5DD1F7ABD) , W64LIT(0x4F53433C09A9FA80) ,

326 
	`W64LIT
(0xFA8B0C53DF7CA1D9) , W64LIT(0x3FD9DCBC886CCB77) ,

327 
	`W64LIT
(0xC040917CA91B4720) , W64LIT(0x7DD00142F9D1DCDF) ,

328 
	`W64LIT
(0x8476FC1D4F387B58) , W64LIT(0x23F8E7C5F3316503) ,

329 
	`W64LIT
(0x032A2244E7E37339) , W64LIT(0x5C87A5D750F5A74B) ,

330 
	`W64LIT
(0x082B4CC43698992E) , W64LIT(0xDF917BECB858F63C) ,

331 
	`W64LIT
(0x3270B8FC5BF86DDA) , W64LIT(0x10AE72BB29B5DD76) ,

332 
	`W64LIT
(0x576AC94E7700362B) , W64LIT(0x1AD112DAC61EFB8F) ,

333 
	`W64LIT
(0x691BC30EC5FAA427) , W64LIT(0xFF246311CC327143) ,

334 
	`W64LIT
(0x3142368E30E53206) , W64LIT(0x71380E31E02CA396) ,

335 
	`W64LIT
(0x958D5C960AAD76F1) , W64LIT(0xF8D6F430C16DA536) ,

336 
	`W64LIT
(0xC8FFD13F1BE7E1D2) , W64LIT(0x7578AE66004DDBE1) ,

337 
	`W64LIT
(0x05833F01067BE646) , W64LIT(0xBB34B5AD3BFE586D) ,

338 
	`W64LIT
(0x095F34C9A12B97F0) , W64LIT(0x247AB64525D60CA8) ,

339 
	`W64LIT
(0xDCDBC6F3017477D1) , W64LIT(0x4A2E14D4DECAD24D) ,

340 
	`W64LIT
(0xBDB5E6D9BE0A1EEB) , W64LIT(0x2A7E70F7794301AB) ,

341 
	`W64LIT
(0xDEF42D8A270540FD) , W64LIT(0x01078EC0A34C22C1) ,

342 
	`W64LIT
(0xE5DE511AF4C16387) , W64LIT(0x7EBB3A52BD9A330A) ,

343 
	`W64LIT
(0x77697857AA7D6435) , W64LIT(0x004E831603AE4C32) ,

344 
	`W64LIT
(0xE7A21020AD78E312) , W64LIT(0x9D41A70C6AB420F2) ,

345 
	`W64LIT
(0x28E06C18EA1141E6) , W64LIT(0xD2B28CBD984F6B28) ,

346 
	`W64LIT
(0x26B75F6C446E9D83) , W64LIT(0xBA47568C4D418D7F) ,

347 
	`W64LIT
(0xD80BADBFE6183D8E) , W64LIT(0x0E206D7F5F166044) ,

348 
	`W64LIT
(0xE258A43911CBCA3E) , W64LIT(0x723A1746B21DC0BC) ,

349 
	`W64LIT
(0xC7CAA854F5D7CDD3) , W64LIT(0x7CAC32883D261D9C) ,

350 
	`W64LIT
(0x7690C26423BA942C) , W64LIT(0x17E55524478042B8) ,

351 
	`W64LIT
(0xE0BE477656A2389F) , W64LIT(0x4D289B5E67AB2DA0) ,

352 
	`W64LIT
(0x44862B9C8FBBFD31) , W64LIT(0xB47CC8049D141365) ,

353 
	`W64LIT
(0x822C1B362B91C793) , W64LIT(0x4EB14655FB13DFD8) ,

354 
	`W64LIT
(0x1ECBBA0714E2A97B) , W64LIT(0x6143459D5CDE5F14) ,

355 
	`W64LIT
(0x53A8FBF1D5F0AC89) , W64LIT(0x97EA04D81C5E5B00) ,

356 
	`W64LIT
(0x622181A8D4FDB3F3) , W64LIT(0xE9BCD341572A1208) ,

357 
	`W64LIT
(0x1411258643CCE58A) , W64LIT(0x9144C5FEA4C6E0A4) ,

358 
	`W64LIT
(0x0D33D06565CF620F) , W64LIT(0x54A48D489F219CA1) ,

359 
	`W64LIT
(0xC43E5EAC6D63C821) , W64LIT(0xA9728B3A72770DAF) ,

360 
	`W64LIT
(0xD7934E7B20DF87EF) , W64LIT(0xE35503B61A3E86E5) ,

361 
	`W64LIT
(0xCAE321FBC819D504) , W64LIT(0x129A50B3AC60BFA6) ,

362 
	`W64LIT
(0xCD5E68EA7E9FB6C3) , W64LIT(0xB01C90199483B1C7) ,

363 
	`W64LIT
(0x3DE93CD5C295376C) , W64LIT(0xAED52EDF2AB9AD13) ,

364 
	`W64LIT
(0x2E60F512C0A07884) , W64LIT(0xBC3D86A3E36210C9) ,

365 
	`W64LIT
(0x35269D9B163951CE) , W64LIT(0x0C7D6E2AD0CDB5FA) ,

366 
	`W64LIT
(0x59E86297D87F5733) , W64LIT(0x298EF221898DB0E7) ,

367 
	`W64LIT
(0x55000029D1A5AA7E) , W64LIT(0x8BC08AE1B5061B45) ,

368 
	`W64LIT
(0xC2C31C2B6C92703A) , W64LIT(0x94CC596BAF25EF42) ,

369 
	`W64LIT
(0x0A1D73DB22540456) , W64LIT(0x04B6A0F9D9C4179A) ,

370 
	`W64LIT
(0xEFFDAFA2AE3D3C60) , W64LIT(0xF7C8075BB49496C4) ,

371 
	`W64LIT
(0x9CC5C7141D1CD4E3) , W64LIT(0x78BD1638218E5534) ,

372 
	`W64LIT
(0xB2F11568F850246A) , W64LIT(0xEDFABCFA9502BC29) ,

373 
	`W64LIT
(0x796CE5F2DA23051B) , W64LIT(0xAAE128B0DC93537C) ,

374 
	`W64LIT
(0x3A493DA0EE4B29AE) , W64LIT(0xB5DF6B2C416895D7) ,

375 
	`W64LIT
(0xFCABBD25122D7F37) , W64LIT(0x70810B58105DC4B1) ,

376 
	`W64LIT
(0xE10FDD37F7882A90) , W64LIT(0x524DCAB5518A3F5C) ,

377 
	`W64LIT
(0x3C9E85878451255B) , W64LIT(0x4029828119BD34E2) ,

378 
	`W64LIT
(0x74A05B6F5D3CECCB) , W64LIT(0xB610021542E13ECA) ,

379 
	`W64LIT
(0x0FF979D12F59E2AC) , W64LIT(0x6037DA27E4F9CC50) ,

380 
	`W64LIT
(0x5E92975A0DF1847D) , W64LIT(0xD66DE190D3E623FE) ,

381 
	`W64LIT
(0x5032D6B87B568048) , W64LIT(0x9A36B7CE8235216E) ,

382 
	`W64LIT
(0x80272A7A24F64B4A) , W64LIT(0x93EFED8B8C6916F7) ,

383 
	`W64LIT
(0x37DDBFF44CCE1555) , W64LIT(0x4B95DB5D4B99BD25) ,

384 
	`W64LIT
(0x92D3FDA169812FC0) , W64LIT(0xFB1A4A9A90660BB6) ,

385 
	`W64LIT
(0x730C196946A4B9B2) , W64LIT(0x81E289AA7F49DA68) ,

386 
	`W64LIT
(0x64669A0F83B1A05F) , W64LIT(0x27B3FF7D9644F48B) ,

387 
	`W64LIT
(0xCC6B615C8DB675B3) , W64LIT(0x674F20B9BCEBBE95) ,

388 
	`W64LIT
(0x6F31238275655982) , W64LIT(0x5AE488713E45CF05) ,

389 
	`W64LIT
(0xBF619F9954C21157) , W64LIT(0xEABAC46040A8EAE9) ,

390 
	`W64LIT
(0x454C6FE9F2C0C1CD) , W64LIT(0x419CF6496412691C) ,

391 
	`W64LIT
(0xD3DC3BEF265B0F70) , W64LIT(0x6D0E60F5C3578A9E) ,

392 
	`W64LIT
(0x5B0E608526323C55) , W64LIT(0x1A46C1A9FA1B59F5) ,

393 
	`W64LIT
(0xA9E245A17C4C8FFA) , W64LIT(0x65CA5159DB2955D7) ,

394 
	`W64LIT
(0x05DB0A76CE35AFC2) , W64LIT(0x81EAC77EA9113D45) ,

395 
	`W64LIT
(0x528EF88AB6AC0A0D) , W64LIT(0xA09EA253597BE3FF) ,

396 
	`W64LIT
(0x430DDFB3AC48CD56) , W64LIT(0xC4B3A67AF45CE46F) ,

397 
	`W64LIT
(0x4ECECFD8FBE2D05E) , W64LIT(0x3EF56F10B39935F0) ,

398 
	`W64LIT
(0x0B22D6829CD619C6) , W64LIT(0x17FD460A74DF2069) ,

399 
	`W64LIT
(0x6CF8CC8E8510ED40) , W64LIT(0xD6C824BF3A6ECAA7) ,

400 
	`W64LIT
(0x61243D581A817049) , W64LIT(0x048BACB6BBC163A2) ,

401 
	`W64LIT
(0xD9A38AC27D44CC32) , W64LIT(0x7FDDFF5BAAF410AB) ,

402 
	`W64LIT
(0xAD6D495AA804824B) , W64LIT(0xE1A6A74F2D8C9F94) ,

403 
	`W64LIT
(0xD4F7851235DEE8E3) , W64LIT(0xFD4B7F886540D893) ,

404 
	`W64LIT
(0x247C20042AA4BFDA) , W64LIT(0x096EA1C517D1327C) ,

405 
	`W64LIT
(0xD56966B4361A6685) , W64LIT(0x277DA5C31221057D) ,

406 
	`W64LIT
(0x94D59893A43ACFF7) , W64LIT(0x64F0C51CCDC02281) ,

407 
	`W64LIT
(0x3D33BCC4FF6189DB) , W64LIT(0xE005CB184CE66AF1) ,

408 
	`W64LIT
(0xFF5CCD1D1DB99BEA) , W64LIT(0xB0B854A7FE42980F) ,

409 
	`W64LIT
(0x7BD46A6A718D4B9F) , W64LIT(0xD10FA8CC22A5FD8C) ,

410 
	`W64LIT
(0xD31484952BE4BD31) , W64LIT(0xC7FA975FCB243847) ,

411 
	`W64LIT
(0x4886ED1E5846C407) , W64LIT(0x28CDDB791EB70B04) ,

412 
	`W64LIT
(0xC2B00BE2F573417F) , W64LIT(0x5C9590452180F877) ,

413 
	`W64LIT
(0x7A6BDDFFF370EB00) , W64LIT(0xCE509E38D6D9D6A4) ,

414 
	`W64LIT
(0xEBEB0F00647FA702) , W64LIT(0x1DCC06CF76606F06) ,

415 
	`W64LIT
(0xE4D9F28BA286FF0A) , W64LIT(0xD85A305DC918C262) ,

416 
	`W64LIT
(0x475B1D8732225F54) , W64LIT(0x2D4FB51668CCB5FE) ,

417 
	`W64LIT
(0xA679B9D9D72BBA20) , W64LIT(0x53841C0D912D43A5) ,

418 
	`W64LIT
(0x3B7EAA48BF12A4E8) , W64LIT(0x781E0E47F22F1DDF) ,

419 
	`W64LIT
(0xEFF20CE60AB50973) , W64LIT(0x20D261D19DFFB742) ,

420 
	`W64LIT
(0x16A12B03062A2E39) , W64LIT(0x1960EB2239650495) ,

421 
	`W64LIT
(0x251C16FED50EB8B8) , W64LIT(0x9AC0C330F826016E) ,

422 
	`W64LIT
(0xED152665953E7671) , W64LIT(0x02D63194A6369570) ,

423 
	`W64LIT
(0x5074F08394B1C987) , W64LIT(0x70BA598C90B25CE1) ,

424 
	`W64LIT
(0x794A15810B9742F6) , W64LIT(0x0D5925E9FCAF8C6C) ,

425 
	`W64LIT
(0x3067716CD868744E) , W64LIT(0x910AB077E8D7731B) ,

426 
	`W64LIT
(0x6A61BBDB5AC42F61) , W64LIT(0x93513EFBF0851567) ,

427 
	`W64LIT
(0xF494724B9E83E9D5) , W64LIT(0xE887E1985C09648D) ,

428 
	`W64LIT
(0x34B1D3C675370CFD) , W64LIT(0xDC35E433BC0D255D) ,

429 
	`W64LIT
(0xD0AAB84234131BE0) , W64LIT(0x08042A50B48B7EAF) ,

430 
	`W64LIT
(0x9997C4EE44A3AB35) , W64LIT(0x829A7B49201799D0) ,

431 
	`W64LIT
(0x263B8307B7C54441) , W64LIT(0x752F95F4FD6A6CA6) ,

432 
	`W64LIT
(0x927217402C08C6E5) , W64LIT(0x2A8AB754A795D9EE) ,

433 
	`W64LIT
(0xA442F7552F72943D) , W64LIT(0x2C31334E19781208) ,

434 
	`W64LIT
(0x4FA98D7CEAEE6291) , W64LIT(0x55C3862F665DB309) ,

435 
	`W64LIT
(0xBD0610175D53B1F3) , W64LIT(0x46FE6CB840413F27) ,

436 
	`W64LIT
(0x3FE03792DF0CFA59) , W64LIT(0xCFE700372EB85E8F) ,

437 
	`W64LIT
(0xA7BE29E7ADBCE118) , W64LIT(0xE544EE5CDE8431DD) ,

438 
	`W64LIT
(0x8A781B1B41F1873E) , W64LIT(0xA5C94C78A0D2F0E7) ,

439 
	`W64LIT
(0x39412E2877B60728) , W64LIT(0xA1265EF3AFC9A62C) ,

440 
	`W64LIT
(0xBCC2770C6A2506C5) , W64LIT(0x3AB66DD5DCE1CE12) ,

441 
	`W64LIT
(0xE65499D04A675B37) , W64LIT(0x7D8F523481BFD216) ,

442 
	`W64LIT
(0x0F6F64FCEC15F389) , W64LIT(0x74EFBE618B5B13C8) ,

443 
	`W64LIT
(0xACDC82B714273E1D) , W64LIT(0xDD40BFE003199D17) ,

444 
	`W64LIT
(0x37E99257E7E061F8) , W64LIT(0xFA52626904775AAA) ,

445 
	`W64LIT
(0x8BBBF63A463D56F9) , W64LIT(0xF0013F1543A26E64) ,

446 
	`W64LIT
(0xA8307E9F879EC898) , W64LIT(0xCC4C27A4150177CC) ,

447 
	`W64LIT
(0x1B432F2CCA1D3348) , W64LIT(0xDE1D1F8F9F6FA013) ,

448 
	`W64LIT
(0x606602A047A7DDD6) , W64LIT(0xD237AB64CC1CB2C7) ,

449 
	`W64LIT
(0x9B938E7225FCD1D3) , W64LIT(0xEC4E03708E0FF476) ,

450 
	`W64LIT
(0xFEB2FBDA3D03C12D) , W64LIT(0xAE0BCED2EE43889A) ,

451 
	`W64LIT
(0x22CB8923EBFB4F43) , W64LIT(0x69360D013CF7396D) ,

452 
	`W64LIT
(0x855E3602D2D4E022) , W64LIT(0x073805BAD01F784C) ,

453 
	`W64LIT
(0x33E17A133852F546) , W64LIT(0xDF4874058AC7B638) ,

454 
	`W64LIT
(0xBA92B29C678AA14A) , W64LIT(0x0CE89FC76CFAADCD) ,

455 
	`W64LIT
(0x5F9D4E0908339E34) , W64LIT(0xF1AFE9291F5923B9) ,

456 
	`W64LIT
(0x6E3480F60F4A265F) , W64LIT(0xEEBF3A2AB29B841C) ,

457 
	`W64LIT
(0xE21938A88F91B4AD) , W64LIT(0x57DFEFF845C6D3C3) ,

458 
	`W64LIT
(0x2F006B0BF62CAAF2) , W64LIT(0x62F479EF6F75EE78) ,

459 
	`W64LIT
(0x11A55AD41C8916A9) , W64LIT(0xF229D29084FED453) ,

460 
	`W64LIT
(0x42F1C27B16B000E6) , W64LIT(0x2B1F76749823C074) ,

461 
	`W64LIT
(0x4B76ECA3C2745360) , W64LIT(0x8C98F463B91691BD) ,

462 
	`W64LIT
(0x14BCC93CF1ADE66A) , W64LIT(0x8885213E6D458397) ,

463 
	`W64LIT
(0x8E177DF0274D4711) , W64LIT(0xB49B73B5503F2951) ,

464 
	`W64LIT
(0x10168168C3F96B6B) , W64LIT(0x0E3D963B63CAB0AE) ,

465 
	`W64LIT
(0x8DFC4B5655A1DB14) , W64LIT(0xF789F1356E14DE5C) ,

466 
	`W64LIT
(0x683E68AF4E51DAC1) , W64LIT(0xC9A84F9D8D4B0FD9) ,

467 
	`W64LIT
(0x3691E03F52A0F9D1) , W64LIT(0x5ED86E46E1878E80) ,

468 
	`W64LIT
(0x3C711A0E99D07150) , W64LIT(0x5A0865B20C4E9310) ,

469 
	`W64LIT
(0x56FBFC1FE4F0682E) , W64LIT(0xEA8D5DE3105EDF9B) ,

470 
	`W64LIT
(0x71ABFDB12379187A) , W64LIT(0x2EB99DE1BEE77B9C) ,

471 
	`W64LIT
(0x21ECC0EA33CF4523) , W64LIT(0x59A4D7521805C7A1) ,

472 
	`W64LIT
(0x3896F5EB56AE7C72) , W64LIT(0xAA638F3DB18F75DC) ,

473 
	`W64LIT
(0x9F39358DABE9808E) , W64LIT(0xB7DEFA91C00B72AC) ,

474 
	`W64LIT
(0x6B5541FD62492D92) , W64LIT(0x6DC6DEE8F92E4D5B) ,

475 
	`W64LIT
(0x353F57ABC4BEEA7E) , W64LIT(0x735769D6DA5690CE) ,

476 
	`W64LIT
(0x0A234AA642391484) , W64LIT(0xF6F9508028F80D9D) ,

477 
	`W64LIT
(0xB8E319A27AB3F215) , W64LIT(0x31AD9C1151341A4D) ,

478 
	`W64LIT
(0x773C22A57BEF5805) , W64LIT(0x45C7561A07968633) ,

479 
	`W64LIT
(0xF913DA9E249DBE36) , W64LIT(0xDA652D9B78A64C68) ,

480 
	`W64LIT
(0x4C27A97F3BC334EF) , W64LIT(0x76621220E66B17F4) ,

481 
	`W64LIT
(0x967743899ACD7D0B) , W64LIT(0xF3EE5BCAE0ED6782) ,

482 
	`W64LIT
(0x409F753600C879FC) , W64LIT(0x06D09A39B5926DB6) ,

483 
	`W64LIT
(0x6F83AEB0317AC588) , W64LIT(0x01E6CA4A86381F21) ,

484 
	`W64LIT
(0x66FF3462D19F3025) , W64LIT(0x72207C24DDFD3BFB) ,

485 
	`W64LIT
(0x4AF6B6D3E2ECE2EB) , W64LIT(0x9C994DBEC7EA08DE) ,

486 
	`W64LIT
(0x49ACE597B09A8BC4) , W64LIT(0xB38C4766CF0797BA) ,

487 
	`W64LIT
(0x131B9373C57C2A75) , W64LIT(0xB1822CCE61931E58) ,

488 
	`W64LIT
(0x9D7555B909BA1C0C) , W64LIT(0x127FAFDD937D11D2) ,

489 
	`W64LIT
(0x29DA3BADC66D92E4) , W64LIT(0xA2C1D57154C2ECBC) ,

490 
	`W64LIT
(0x58C5134D82F6FE24) , W64LIT(0x1C3AE3515B62274F) ,

491 
	`W64LIT
(0xE907C82E01CB8126) , W64LIT(0xF8ED091913E37FCB) ,

492 
	`W64LIT
(0x3249D8F9C80046C9) , W64LIT(0x80CF9BEDE388FB63) ,

493 
	`W64LIT
(0x1881539A116CF19E) , W64LIT(0x5103F3F76BD52457) ,

494 
	`W64LIT
(0x15B7E6F5AE47F7A8) , W64LIT(0xDBD7C6DED47E9CCF) ,

495 
	`W64LIT
(0x44E55C410228BB1A) , W64LIT(0xB647D4255EDB4E99) ,

496 
	`W64LIT
(0x5D11882BB8AAFC30) , W64LIT(0xF5098BBB29D3212A) ,

497 
	`W64LIT
(0x8FB5EA14E90296B3) , W64LIT(0x677B942157DD025A) ,

498 
	`W64LIT
(0xFB58E7C0A390ACB5) , W64LIT(0x89D3674C83BD4A01) ,

499 
	`W64LIT
(0x9E2DA4DF4BF3B93B) , W64LIT(0xFCC41E328CAB4829) ,

500 
	`W64LIT
(0x03F38C96BA582C52) , W64LIT(0xCAD1BDBD7FD85DB2) ,

501 
	`W64LIT
(0xBBB442C16082AE83) , W64LIT(0xB95FE86BA5DA9AB0) ,

502 
	`W64LIT
(0xB22E04673771A93F) , W64LIT(0x845358C9493152D8) ,

503 
	`W64LIT
(0xBE2A488697B4541E) , W64LIT(0x95A2DC2DD38E6966) ,

504 
	`W64LIT
(0xC02C11AC923C852B) , W64LIT(0x2388B1990DF2A87B) ,

505 
	`W64LIT
(0x7C8008FA1B4F37BE) , W64LIT(0x1F70D0C84D54E503) ,

506 
	`W64LIT
(0x5490ADEC7ECE57D4) , W64LIT(0x002B3C27D9063A3A) ,

507 
	`W64LIT
(0x7EAEA3848030A2BF) , W64LIT(0xC602326DED2003C0) ,

508 
	`W64LIT
(0x83A7287D69A94086) , W64LIT(0xC57A5FCB30F57A8A) ,

509 
	`W64LIT
(0xB56844E479EBE779) , W64LIT(0xA373B40F05DCBCE9) ,

510 
	`W64LIT
(0xD71A786E88570EE2) , W64LIT(0x879CBACDBDE8F6A0) ,

511 
	`W64LIT
(0x976AD1BCC164A32F) , W64LIT(0xAB21E25E9666D78B) ,

512 
	`W64LIT
(0x901063AAE5E5C33C) , W64LIT(0x9818B34448698D90) ,

513 
	`W64LIT
(0xE36487AE3E1E8ABB) , W64LIT(0xAFBDF931893BDCB4) ,

514 
	`W64LIT
(0x6345A0DC5FBBD519) , W64LIT(0x8628FE269B9465CA) ,

515 
	`W64LIT
(0x1E5D01603F9C51EC) , W64LIT(0x4DE44006A15049B7) ,

516 
	`W64LIT
(0xBF6C70E5F776CBB1) , W64LIT(0x411218F2EF552BED) ,

517 
	`W64LIT
(0xCB0C0708705A36A3) , W64LIT(0xE74D14754F986044) ,

518 
	`W64LIT
(0xCD56D9430EA8280E) , W64LIT(0xC12591D7535F5065) ,

519 
	`W64LIT
(0xC83223F1720AEF96) , W64LIT(0xC3A0396F7363A51F) ,

520 
	`W64LIT
(0xffffffffffffffff),

521 
	`W64LIT
(0xA5A5A5A5A5A5A5A5),

522 
	`W64LIT
(0x0123456789ABCDEF),

523 
	}
};

525 
	gNAMESPACE_END


	@trdlocal.cpp

3 
	~"pch.h
"

5 #iâdeà
CRYPTOPP_IMPORTS


6 #ifdeà
THREADS_AVAILABLE


8 
	~"Œdloÿl.h
"

10 #ifdeà
HAS_WINTHREADS


11 
	~<wšdows.h
>

14 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

16 
Th»adLoÿlStÜage
::
E¼
::
	$E¼
(cÚ¡ 
¡d
::
¡ršg
& 
İ”©iÚ
, 
”rÜ
)

17 : 
	`OS_E¼Ü
(
OTHER_ERROR
, "Th»adLoÿlStÜage: " + 
İ”©iÚ
 + " o³¿tiÚ faed w™hƒ¼Ü 0x" + 
	`IÁToSŒšg
(
”rÜ
, 16), operation,ƒrror)

19 
	}
}

21 
	gTh»adLoÿlStÜage
::
	$Th»adLoÿlStÜage
()

23 #ifdeà
HAS_WINTHREADS


24 
m_šdex
 = 
	`TlsAÎoc
();

25 ià(
m_šdex
 =ğ
TLS_OUT_OF_INDEXES
)

26 
throw
 
	`E¼
("TlsAÎoc", 
	`G‘La¡E¼Ü
());

28 
”rÜ
 = 
	`±h»ad_key_ü—‹
(&
m_šdex
, 
NULL
);

29 ià(
”rÜ
)

30 
throw
 
	`E¼
("±h»ad_key_ü—‹", 
”rÜ
);

32 
	}
}

34 
	gTh»adLoÿlStÜage
::~
	$Th»adLoÿlStÜage
()

36 #ifdeà
HAS_WINTHREADS


37 ià(!
	`TlsF»e
(
m_šdex
))

38 
throw
 
	`E¼
("TlsF»e", 
	`G‘La¡E¼Ü
());

40 
”rÜ
 = 
	`±h»ad_key_d–‘e
(
m_šdex
);

41 ià(
”rÜ
)

42 
throw
 
	`E¼
("±h»ad_key_d–‘e", 
”rÜ
);

44 
	}
}

46 
	gTh»adLoÿlStÜage
::
	$S‘V®ue
(*
v®ue
)

48 #ifdeà
HAS_WINTHREADS


49 ià(!
	`TlsS‘V®ue
(
m_šdex
, 
v®ue
))

50 
throw
 
	`E¼
("TlsS‘V®ue", 
	`G‘La¡E¼Ü
());

52 
”rÜ
 = 
	`±h»ad_£t¥ecific
(
m_šdex
, 
v®ue
);

53 ià(
”rÜ
)

54 
throw
 
	`E¼
("±h»ad_key_g‘¥ecific", 
”rÜ
);

56 
	}
}

58 *
	gTh»adLoÿlStÜage
::
	$G‘V®ue
() const

60 #ifdeà
HAS_WINTHREADS


61 *
»suÉ
 = 
	`TlsG‘V®ue
(
m_šdex
);

62 ià(!
»suÉ
 && 
	`G‘La¡E¼Ü
(è!ğ
NO_ERROR
)

63 
throw
 
	`E¼
("TlsG‘V®ue", 
	`G‘La¡E¼Ü
());

65 *
»suÉ
 = 
	`±h»ad_g‘¥ecific
(
m_šdex
);

67  
»suÉ
;

68 
	}
}

70 
	gNAMESPACE_END


	@trdlocal.h

1 #iâdeà
CRYPTOPP_TRDLOCAL_H


2 
	#CRYPTOPP_TRDLOCAL_H


	)

4 
	~"cÚfig.h
"

6 #ifdeà
THREADS_AVAILABLE


8 
	~"misc.h
"

10 #ifdeà
HAS_WINTHREADS


11 
	tTh»adLoÿlIndexTy³
;

13 
	~<±h»ad.h
>

14 
±h»ad_key_t
 
	tTh»adLoÿlIndexTy³
;

17 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

20 şas 
	cCRYPTOPP_DLL
 
Th»adLoÿlStÜage
 : 
public
 
NÙCİyabË


22 
public
:

24 şas 
	cE¼
 : 
public
 
OS_E¼Ü


26 
public
:

27 
	`E¼
(cÚ¡ 
¡d
::
¡ršg
& 
İ”©iÚ
, 
”rÜ
);

30 
	`Th»adLoÿlStÜage
();

31 ~
	`Th»adLoÿlStÜage
();

33 
	`S‘V®ue
(*
v®ue
);

34 *
	$G‘V®ue
() const;

36 
´iv©e
:

37 
Th»adLoÿlIndexTy³
 
m_šdex
;

38 
	}
};

40 
	gNAMESPACE_END


	@trunhash.h

1 #iâdeà
CRYPTOPP_TRUNHASH_H


2 
	#CRYPTOPP_TRUNHASH_H


	)

4 
	~"üy±lib.h
"

6 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

8 şas 
	cNuÎHash
 : 
public
 
HashT¿nsfÜm©iÚ


10 
public
:

11 
	$Upd©e
(cÚ¡ 
by‹
 *
šput
, 
size_t
 
Ëngth
) {}

12 
	$Dige¡Size
(ècÚ¡ { 0;
	}
}

13 
	$Trunÿ‹dFš®
(
by‹
 *
dige¡
, 
size_t
 
dige¡Size
è{
	}
}

14 
boŞ
 
	$Trunÿ‹dV”ify
(cÚ¡ 
by‹
 *
dige¡
, 
size_t
 
dige¡L’gth
è{ 
Œue
;
	}
}

18 
	g‹m¶©e
 <
şass
 
	gT
>

19 şas 
	cTrunÿ‹dHashTem¶©e
 : 
public
 
HashT¿nsfÜm©iÚ


21 
public
:

22 
	$Trunÿ‹dHashTem¶©e
(
T
 
hm
, 
dige¡Size
)

23 : 
	`m_hm
(
hm
), 
	$m_dige¡Size
(
dige¡Size
) {}

24 
	$Trunÿ‹dHashTem¶©e
(cÚ¡ 
by‹
 *
key
, 
size_t
 
keyL’gth
, 
dige¡Size
)

25 : 
	`m_hm
(
key
, 
keyL’gth
), 
	$m_dige¡Size
(
dige¡Size
è{
	}
}

26 
	$Trunÿ‹dHashTem¶©e
(
size_t
 
dige¡Size
)

27 : 
	$m_dige¡Size
(
dige¡Size
è{
	}
}

29 
	$Re¡¬t
()

30 {
m_hm
.
	`Re¡¬t
();
	}
}

31 
	$Upd©e
(cÚ¡ 
by‹
 *
šput
, 
size_t
 
Ëngth
)

32 {
m_hm
.
	`Upd©e
(
šput
, 
Ëngth
);
	}
}

33 
	$Dige¡Size
(ècÚ¡ { 
m_dige¡Size
;
	}
}

34 
	$Trunÿ‹dFš®
(
by‹
 *
dige¡
, 
size_t
 
dige¡Size
)

35 {
m_hm
.
	`Trunÿ‹dFš®
(
dige¡
, 
dige¡Size
);
	}
}

36 
boŞ
 
	$Trunÿ‹dV”ify
(cÚ¡ 
by‹
 *
dige¡
, 
size_t
 
dige¡L’gth
)

37 { 
m_hm
.
	`Trunÿ‹dV”ify
(
dige¡
, 
dige¡L’gth
);
	}
}

39 
	g´iv©e
:

40 
T
 
m_hm
;

41 
	gm_dige¡Size
;

44 
	gTrunÿ‹dHashTem¶©e
<
	tHashT¿nsfÜm©iÚ
 &> 
	tTrunÿ‹dHashModuË
;

46 
	gNAMESPACE_END


	@ttmac.cpp

3 
	~"pch.h
"

4 
	~"‰mac.h
"

5 
	~"misc.h
"

7 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

9 
TTMAC_Ba£
::
	$UncheckedS‘Key
(cÚ¡ 
by‹
 *
u£rKey
, 
keyËngth
, cÚ¡ 
NameV®uePaœs
 &)

11 
	`As£¹V®idKeyL’gth
(
keyËngth
);

13 
	`memıy
(
m_key
, 
u£rKey
, 
KEYLENGTH
);

14 
	`CÜ»ùEndŸÃss
(
m_key
, m_key, 
KEYLENGTH
);

16 
	`In™
();

17 
	}
}

19 
	gTTMAC_Ba£
::
	$In™
()

21 
m_dige¡
[0] = m_dige¡[5] = 
m_key
[0];

22 
m_dige¡
[1] = m_dige¡[6] = 
m_key
[1];

23 
m_dige¡
[2] = m_dige¡[7] = 
m_key
[2];

24 
m_dige¡
[3] = m_dige¡[8] = 
m_key
[3];

25 
m_dige¡
[4] = m_dige¡[9] = 
m_key
[4];

26 
	}
}

28 
	gTTMAC_Ba£
::
	$Trunÿ‹dFš®
(
by‹
 *
hash
, 
size_t
 
size
)

30 
	`PadLa¡Block
(
	`BlockSize
(è- 2*(
HashWÜdTy³
));

31 
	`CÜ»ùEndŸÃss
(
m_d©a
, m_d©a, 
	`BlockSize
(è- 2*(
HashWÜdTy³
));

33 
m_d©a
[m_d©a.
	`size
()-2] = 
	`G‘B™CouÁLo
();

34 
m_d©a
[m_d©a.
	`size
()-1] = 
	`G‘B™CouÁHi
();

36 
	`T¿nsfÜm
(
m_dige¡
, 
m_d©a
, 
Œue
);

38 
wÜd32
 
t2
 = 
m_dige¡
[2];

39 
wÜd32
 
t3
 = 
m_dige¡
[3];

40 ià(
size
 !ğ
DIGESTSIZE
)

42 
size
)

45 
m_dige¡
[3] += m_digest[1] + m_digest[4];

48 
m_dige¡
[2] +ğm_dige¡[0] + 
t3
;

51 
m_dige¡
[0] +ğm_dige¡[1] + 
t3
;

52 
m_dige¡
[1] +ğm_dige¡[4] + 
t2
;

56 
m_dige¡
[0] +=

57 
m_dige¡
[1] +

58 
m_dige¡
[2] +

59 
m_dige¡
[3] +

60 
m_dige¡
[4];

68 
throw
 
	`Inv®idArgum’t
("TTMAC_Ba£: cª'ˆŒunÿ‹‡ Two-T¿ck-MAC 20 by‹ dige¡Ø" + 
	`IÁToSŒšg
(
size
) + " bytes");

73 
	`CÜ»ùEndŸÃss
(
m_dige¡
, m_dige¡, 
size
);

74 
	`memıy
(
hash
, 
m_dige¡
, 
size
);

76 
	`Re¡¬t
();

77 
	}
}

81 
	#F
(
x
, 
y
, 
z
è(x ^ y ^ z)

	)

82 
	#G
(
x
, 
y
, 
z
è(z ^ (x & (y^z)))

	)

83 
	#H
(
x
, 
y
, 
z
è(z ^ (x | ~y))

	)

84 
	#I
(
x
, 
y
, 
z
è(y ^ (z & (x^y)))

	)

85 
	#J
(
x
, 
y
, 
z
è(x ^ (y | ~z))

	)

87 
	#k0
 0

	)

88 
	#k1
 0x5a827999UL

	)

89 
	#k2
 0x6ed9eba1UL

	)

90 
	#k3
 0x8f1bbcdcUL

	)

91 
	#k4
 0xa953fd4eUL

	)

92 
	#k5
 0x50a28be6UL

	)

93 
	#k6
 0x5c4dd124UL

	)

94 
	#k7
 0x6d703ef3UL

	)

95 
	#k8
 0x7a6d76e9UL

	)

96 
	#k9
 0

	)

98 
	gTTMAC_Ba£
::
	$T¿nsfÜm
(
wÜd32
 *
dige¡
, cÚ¡ wÜd32 *
X
, 
boŞ
 
Ï¡
)

100 
	#Subround
(
f
, 
a
, 
b
, 
c
, 
d
, 
e
, 
x
, 
s
, 
k
) \

101 
a
 +ğ
	`f
(
b
, 
c
, 
d
è+ 
x
 + 
k
;\

102 
a
 = 
	`rÙlFixed
((
wÜd32
ï, 
s
è+ 
e
;\

103 
c
 = 
	`rÙlFixed
((
wÜd32
)c, 10U)

	)

105 
wÜd32
 
a1
, 
b1
, 
c1
, 
d1
, 
e1
, 
a2
, 
b2
, 
c2
, 
d2
, 
e2
;

106 
wÜd32
 *
ŒackA
, *
ŒackB
;

108 ià(!
Ï¡
)

110 
ŒackA
 = 
dige¡
;

111 
ŒackB
 = 
dige¡
+5;

115 
ŒackB
 = 
dige¡
;

116 
ŒackA
 = 
dige¡
+5;

118 
a1
 = 
ŒackA
[0];

119 
b1
 = 
ŒackA
[1];

120 
c1
 = 
ŒackA
[2];

121 
d1
 = 
ŒackA
[3];

122 
e1
 = 
ŒackA
[4];

123 
a2
 = 
ŒackB
[0];

124 
b2
 = 
ŒackB
[1];

125 
c2
 = 
ŒackB
[2];

126 
d2
 = 
ŒackB
[3];

127 
e2
 = 
ŒackB
[4];

129 
	`Subround
(
F
, 
a1
, 
b1
, 
c1
, 
d1
, 
e1
, 
X
[ 0], 11, 
k0
);

130 
	`Subround
(
F
, 
e1
, 
a1
, 
b1
, 
c1
, 
d1
, 
X
[ 1], 14, 
k0
);

131 
	`Subround
(
F
, 
d1
, 
e1
, 
a1
, 
b1
, 
c1
, 
X
[ 2], 15, 
k0
);

132 
	`Subround
(
F
, 
c1
, 
d1
, 
e1
, 
a1
, 
b1
, 
X
[ 3], 12, 
k0
);

133 
	`Subround
(
F
, 
b1
, 
c1
, 
d1
, 
e1
, 
a1
, 
X
[ 4], 5, 
k0
);

134 
	`Subround
(
F
, 
a1
, 
b1
, 
c1
, 
d1
, 
e1
, 
X
[ 5], 8, 
k0
);

135 
	`Subround
(
F
, 
e1
, 
a1
, 
b1
, 
c1
, 
d1
, 
X
[ 6], 7, 
k0
);

136 
	`Subround
(
F
, 
d1
, 
e1
, 
a1
, 
b1
, 
c1
, 
X
[ 7], 9, 
k0
);

137 
	`Subround
(
F
, 
c1
, 
d1
, 
e1
, 
a1
, 
b1
, 
X
[ 8], 11, 
k0
);

138 
	`Subround
(
F
, 
b1
, 
c1
, 
d1
, 
e1
, 
a1
, 
X
[ 9], 13, 
k0
);

139 
	`Subround
(
F
, 
a1
, 
b1
, 
c1
, 
d1
, 
e1
, 
X
[10], 14, 
k0
);

140 
	`Subround
(
F
, 
e1
, 
a1
, 
b1
, 
c1
, 
d1
, 
X
[11], 15, 
k0
);

141 
	`Subround
(
F
, 
d1
, 
e1
, 
a1
, 
b1
, 
c1
, 
X
[12], 6, 
k0
);

142 
	`Subround
(
F
, 
c1
, 
d1
, 
e1
, 
a1
, 
b1
, 
X
[13], 7, 
k0
);

143 
	`Subround
(
F
, 
b1
, 
c1
, 
d1
, 
e1
, 
a1
, 
X
[14], 9, 
k0
);

144 
	`Subround
(
F
, 
a1
, 
b1
, 
c1
, 
d1
, 
e1
, 
X
[15], 8, 
k0
);

146 
	`Subround
(
G
, 
e1
, 
a1
, 
b1
, 
c1
, 
d1
, 
X
[ 7], 7, 
k1
);

147 
	`Subround
(
G
, 
d1
, 
e1
, 
a1
, 
b1
, 
c1
, 
X
[ 4], 6, 
k1
);

148 
	`Subround
(
G
, 
c1
, 
d1
, 
e1
, 
a1
, 
b1
, 
X
[13], 8, 
k1
);

149 
	`Subround
(
G
, 
b1
, 
c1
, 
d1
, 
e1
, 
a1
, 
X
[ 1], 13, 
k1
);

150 
	`Subround
(
G
, 
a1
, 
b1
, 
c1
, 
d1
, 
e1
, 
X
[10], 11, 
k1
);

151 
	`Subround
(
G
, 
e1
, 
a1
, 
b1
, 
c1
, 
d1
, 
X
[ 6], 9, 
k1
);

152 
	`Subround
(
G
, 
d1
, 
e1
, 
a1
, 
b1
, 
c1
, 
X
[15], 7, 
k1
);

153 
	`Subround
(
G
, 
c1
, 
d1
, 
e1
, 
a1
, 
b1
, 
X
[ 3], 15, 
k1
);

154 
	`Subround
(
G
, 
b1
, 
c1
, 
d1
, 
e1
, 
a1
, 
X
[12], 7, 
k1
);

155 
	`Subround
(
G
, 
a1
, 
b1
, 
c1
, 
d1
, 
e1
, 
X
[ 0], 12, 
k1
);

156 
	`Subround
(
G
, 
e1
, 
a1
, 
b1
, 
c1
, 
d1
, 
X
[ 9], 15, 
k1
);

157 
	`Subround
(
G
, 
d1
, 
e1
, 
a1
, 
b1
, 
c1
, 
X
[ 5], 9, 
k1
);

158 
	`Subround
(
G
, 
c1
, 
d1
, 
e1
, 
a1
, 
b1
, 
X
[ 2], 11, 
k1
);

159 
	`Subround
(
G
, 
b1
, 
c1
, 
d1
, 
e1
, 
a1
, 
X
[14], 7, 
k1
);

160 
	`Subround
(
G
, 
a1
, 
b1
, 
c1
, 
d1
, 
e1
, 
X
[11], 13, 
k1
);

161 
	`Subround
(
G
, 
e1
, 
a1
, 
b1
, 
c1
, 
d1
, 
X
[ 8], 12, 
k1
);

163 
	`Subround
(
H
, 
d1
, 
e1
, 
a1
, 
b1
, 
c1
, 
X
[ 3], 11, 
k2
);

164 
	`Subround
(
H
, 
c1
, 
d1
, 
e1
, 
a1
, 
b1
, 
X
[10], 13, 
k2
);

165 
	`Subround
(
H
, 
b1
, 
c1
, 
d1
, 
e1
, 
a1
, 
X
[14], 6, 
k2
);

166 
	`Subround
(
H
, 
a1
, 
b1
, 
c1
, 
d1
, 
e1
, 
X
[ 4], 7, 
k2
);

167 
	`Subround
(
H
, 
e1
, 
a1
, 
b1
, 
c1
, 
d1
, 
X
[ 9], 14, 
k2
);

168 
	`Subround
(
H
, 
d1
, 
e1
, 
a1
, 
b1
, 
c1
, 
X
[15], 9, 
k2
);

169 
	`Subround
(
H
, 
c1
, 
d1
, 
e1
, 
a1
, 
b1
, 
X
[ 8], 13, 
k2
);

170 
	`Subround
(
H
, 
b1
, 
c1
, 
d1
, 
e1
, 
a1
, 
X
[ 1], 15, 
k2
);

171 
	`Subround
(
H
, 
a1
, 
b1
, 
c1
, 
d1
, 
e1
, 
X
[ 2], 14, 
k2
);

172 
	`Subround
(
H
, 
e1
, 
a1
, 
b1
, 
c1
, 
d1
, 
X
[ 7], 8, 
k2
);

173 
	`Subround
(
H
, 
d1
, 
e1
, 
a1
, 
b1
, 
c1
, 
X
[ 0], 13, 
k2
);

174 
	`Subround
(
H
, 
c1
, 
d1
, 
e1
, 
a1
, 
b1
, 
X
[ 6], 6, 
k2
);

175 
	`Subround
(
H
, 
b1
, 
c1
, 
d1
, 
e1
, 
a1
, 
X
[13], 5, 
k2
);

176 
	`Subround
(
H
, 
a1
, 
b1
, 
c1
, 
d1
, 
e1
, 
X
[11], 12, 
k2
);

177 
	`Subround
(
H
, 
e1
, 
a1
, 
b1
, 
c1
, 
d1
, 
X
[ 5], 7, 
k2
);

178 
	`Subround
(
H
, 
d1
, 
e1
, 
a1
, 
b1
, 
c1
, 
X
[12], 5, 
k2
);

180 
	`Subround
(
I
, 
c1
, 
d1
, 
e1
, 
a1
, 
b1
, 
X
[ 1], 11, 
k3
);

181 
	`Subround
(
I
, 
b1
, 
c1
, 
d1
, 
e1
, 
a1
, 
X
[ 9], 12, 
k3
);

182 
	`Subround
(
I
, 
a1
, 
b1
, 
c1
, 
d1
, 
e1
, 
X
[11], 14, 
k3
);

183 
	`Subround
(
I
, 
e1
, 
a1
, 
b1
, 
c1
, 
d1
, 
X
[10], 15, 
k3
);

184 
	`Subround
(
I
, 
d1
, 
e1
, 
a1
, 
b1
, 
c1
, 
X
[ 0], 14, 
k3
);

185 
	`Subround
(
I
, 
c1
, 
d1
, 
e1
, 
a1
, 
b1
, 
X
[ 8], 15, 
k3
);

186 
	`Subround
(
I
, 
b1
, 
c1
, 
d1
, 
e1
, 
a1
, 
X
[12], 9, 
k3
);

187 
	`Subround
(
I
, 
a1
, 
b1
, 
c1
, 
d1
, 
e1
, 
X
[ 4], 8, 
k3
);

188 
	`Subround
(
I
, 
e1
, 
a1
, 
b1
, 
c1
, 
d1
, 
X
[13], 9, 
k3
);

189 
	`Subround
(
I
, 
d1
, 
e1
, 
a1
, 
b1
, 
c1
, 
X
[ 3], 14, 
k3
);

190 
	`Subround
(
I
, 
c1
, 
d1
, 
e1
, 
a1
, 
b1
, 
X
[ 7], 5, 
k3
);

191 
	`Subround
(
I
, 
b1
, 
c1
, 
d1
, 
e1
, 
a1
, 
X
[15], 6, 
k3
);

192 
	`Subround
(
I
, 
a1
, 
b1
, 
c1
, 
d1
, 
e1
, 
X
[14], 8, 
k3
);

193 
	`Subround
(
I
, 
e1
, 
a1
, 
b1
, 
c1
, 
d1
, 
X
[ 5], 6, 
k3
);

194 
	`Subround
(
I
, 
d1
, 
e1
, 
a1
, 
b1
, 
c1
, 
X
[ 6], 5, 
k3
);

195 
	`Subround
(
I
, 
c1
, 
d1
, 
e1
, 
a1
, 
b1
, 
X
[ 2], 12, 
k3
);

197 
	`Subround
(
J
, 
b1
, 
c1
, 
d1
, 
e1
, 
a1
, 
X
[ 4], 9, 
k4
);

198 
	`Subround
(
J
, 
a1
, 
b1
, 
c1
, 
d1
, 
e1
, 
X
[ 0], 15, 
k4
);

199 
	`Subround
(
J
, 
e1
, 
a1
, 
b1
, 
c1
, 
d1
, 
X
[ 5], 5, 
k4
);

200 
	`Subround
(
J
, 
d1
, 
e1
, 
a1
, 
b1
, 
c1
, 
X
[ 9], 11, 
k4
);

201 
	`Subround
(
J
, 
c1
, 
d1
, 
e1
, 
a1
, 
b1
, 
X
[ 7], 6, 
k4
);

202 
	`Subround
(
J
, 
b1
, 
c1
, 
d1
, 
e1
, 
a1
, 
X
[12], 8, 
k4
);

203 
	`Subround
(
J
, 
a1
, 
b1
, 
c1
, 
d1
, 
e1
, 
X
[ 2], 13, 
k4
);

204 
	`Subround
(
J
, 
e1
, 
a1
, 
b1
, 
c1
, 
d1
, 
X
[10], 12, 
k4
);

205 
	`Subround
(
J
, 
d1
, 
e1
, 
a1
, 
b1
, 
c1
, 
X
[14], 5, 
k4
);

206 
	`Subround
(
J
, 
c1
, 
d1
, 
e1
, 
a1
, 
b1
, 
X
[ 1], 12, 
k4
);

207 
	`Subround
(
J
, 
b1
, 
c1
, 
d1
, 
e1
, 
a1
, 
X
[ 3], 13, 
k4
);

208 
	`Subround
(
J
, 
a1
, 
b1
, 
c1
, 
d1
, 
e1
, 
X
[ 8], 14, 
k4
);

209 
	`Subround
(
J
, 
e1
, 
a1
, 
b1
, 
c1
, 
d1
, 
X
[11], 11, 
k4
);

210 
	`Subround
(
J
, 
d1
, 
e1
, 
a1
, 
b1
, 
c1
, 
X
[ 6], 8, 
k4
);

211 
	`Subround
(
J
, 
c1
, 
d1
, 
e1
, 
a1
, 
b1
, 
X
[15], 5, 
k4
);

212 
	`Subround
(
J
, 
b1
, 
c1
, 
d1
, 
e1
, 
a1
, 
X
[13], 6, 
k4
);

214 
	`Subround
(
J
, 
a2
, 
b2
, 
c2
, 
d2
, 
e2
, 
X
[ 5], 8, 
k5
);

215 
	`Subround
(
J
, 
e2
, 
a2
, 
b2
, 
c2
, 
d2
, 
X
[14], 9, 
k5
);

216 
	`Subround
(
J
, 
d2
, 
e2
, 
a2
, 
b2
, 
c2
, 
X
[ 7], 9, 
k5
);

217 
	`Subround
(
J
, 
c2
, 
d2
, 
e2
, 
a2
, 
b2
, 
X
[ 0], 11, 
k5
);

218 
	`Subround
(
J
, 
b2
, 
c2
, 
d2
, 
e2
, 
a2
, 
X
[ 9], 13, 
k5
);

219 
	`Subround
(
J
, 
a2
, 
b2
, 
c2
, 
d2
, 
e2
, 
X
[ 2], 15, 
k5
);

220 
	`Subround
(
J
, 
e2
, 
a2
, 
b2
, 
c2
, 
d2
, 
X
[11], 15, 
k5
);

221 
	`Subround
(
J
, 
d2
, 
e2
, 
a2
, 
b2
, 
c2
, 
X
[ 4], 5, 
k5
);

222 
	`Subround
(
J
, 
c2
, 
d2
, 
e2
, 
a2
, 
b2
, 
X
[13], 7, 
k5
);

223 
	`Subround
(
J
, 
b2
, 
c2
, 
d2
, 
e2
, 
a2
, 
X
[ 6], 7, 
k5
);

224 
	`Subround
(
J
, 
a2
, 
b2
, 
c2
, 
d2
, 
e2
, 
X
[15], 8, 
k5
);

225 
	`Subround
(
J
, 
e2
, 
a2
, 
b2
, 
c2
, 
d2
, 
X
[ 8], 11, 
k5
);

226 
	`Subround
(
J
, 
d2
, 
e2
, 
a2
, 
b2
, 
c2
, 
X
[ 1], 14, 
k5
);

227 
	`Subround
(
J
, 
c2
, 
d2
, 
e2
, 
a2
, 
b2
, 
X
[10], 14, 
k5
);

228 
	`Subround
(
J
, 
b2
, 
c2
, 
d2
, 
e2
, 
a2
, 
X
[ 3], 12, 
k5
);

229 
	`Subround
(
J
, 
a2
, 
b2
, 
c2
, 
d2
, 
e2
, 
X
[12], 6, 
k5
);

231 
	`Subround
(
I
, 
e2
, 
a2
, 
b2
, 
c2
, 
d2
, 
X
[ 6], 9, 
k6
);

232 
	`Subround
(
I
, 
d2
, 
e2
, 
a2
, 
b2
, 
c2
, 
X
[11], 13, 
k6
);

233 
	`Subround
(
I
, 
c2
, 
d2
, 
e2
, 
a2
, 
b2
, 
X
[ 3], 15, 
k6
);

234 
	`Subround
(
I
, 
b2
, 
c2
, 
d2
, 
e2
, 
a2
, 
X
[ 7], 7, 
k6
);

235 
	`Subround
(
I
, 
a2
, 
b2
, 
c2
, 
d2
, 
e2
, 
X
[ 0], 12, 
k6
);

236 
	`Subround
(
I
, 
e2
, 
a2
, 
b2
, 
c2
, 
d2
, 
X
[13], 8, 
k6
);

237 
	`Subround
(
I
, 
d2
, 
e2
, 
a2
, 
b2
, 
c2
, 
X
[ 5], 9, 
k6
);

238 
	`Subround
(
I
, 
c2
, 
d2
, 
e2
, 
a2
, 
b2
, 
X
[10], 11, 
k6
);

239 
	`Subround
(
I
, 
b2
, 
c2
, 
d2
, 
e2
, 
a2
, 
X
[14], 7, 
k6
);

240 
	`Subround
(
I
, 
a2
, 
b2
, 
c2
, 
d2
, 
e2
, 
X
[15], 7, 
k6
);

241 
	`Subround
(
I
, 
e2
, 
a2
, 
b2
, 
c2
, 
d2
, 
X
[ 8], 12, 
k6
);

242 
	`Subround
(
I
, 
d2
, 
e2
, 
a2
, 
b2
, 
c2
, 
X
[12], 7, 
k6
);

243 
	`Subround
(
I
, 
c2
, 
d2
, 
e2
, 
a2
, 
b2
, 
X
[ 4], 6, 
k6
);

244 
	`Subround
(
I
, 
b2
, 
c2
, 
d2
, 
e2
, 
a2
, 
X
[ 9], 15, 
k6
);

245 
	`Subround
(
I
, 
a2
, 
b2
, 
c2
, 
d2
, 
e2
, 
X
[ 1], 13, 
k6
);

246 
	`Subround
(
I
, 
e2
, 
a2
, 
b2
, 
c2
, 
d2
, 
X
[ 2], 11, 
k6
);

248 
	`Subround
(
H
, 
d2
, 
e2
, 
a2
, 
b2
, 
c2
, 
X
[15], 9, 
k7
);

249 
	`Subround
(
H
, 
c2
, 
d2
, 
e2
, 
a2
, 
b2
, 
X
[ 5], 7, 
k7
);

250 
	`Subround
(
H
, 
b2
, 
c2
, 
d2
, 
e2
, 
a2
, 
X
[ 1], 15, 
k7
);

251 
	`Subround
(
H
, 
a2
, 
b2
, 
c2
, 
d2
, 
e2
, 
X
[ 3], 11, 
k7
);

252 
	`Subround
(
H
, 
e2
, 
a2
, 
b2
, 
c2
, 
d2
, 
X
[ 7], 8, 
k7
);

253 
	`Subround
(
H
, 
d2
, 
e2
, 
a2
, 
b2
, 
c2
, 
X
[14], 6, 
k7
);

254 
	`Subround
(
H
, 
c2
, 
d2
, 
e2
, 
a2
, 
b2
, 
X
[ 6], 6, 
k7
);

255 
	`Subround
(
H
, 
b2
, 
c2
, 
d2
, 
e2
, 
a2
, 
X
[ 9], 14, 
k7
);

256 
	`Subround
(
H
, 
a2
, 
b2
, 
c2
, 
d2
, 
e2
, 
X
[11], 12, 
k7
);

257 
	`Subround
(
H
, 
e2
, 
a2
, 
b2
, 
c2
, 
d2
, 
X
[ 8], 13, 
k7
);

258 
	`Subround
(
H
, 
d2
, 
e2
, 
a2
, 
b2
, 
c2
, 
X
[12], 5, 
k7
);

259 
	`Subround
(
H
, 
c2
, 
d2
, 
e2
, 
a2
, 
b2
, 
X
[ 2], 14, 
k7
);

260 
	`Subround
(
H
, 
b2
, 
c2
, 
d2
, 
e2
, 
a2
, 
X
[10], 13, 
k7
);

261 
	`Subround
(
H
, 
a2
, 
b2
, 
c2
, 
d2
, 
e2
, 
X
[ 0], 13, 
k7
);

262 
	`Subround
(
H
, 
e2
, 
a2
, 
b2
, 
c2
, 
d2
, 
X
[ 4], 7, 
k7
);

263 
	`Subround
(
H
, 
d2
, 
e2
, 
a2
, 
b2
, 
c2
, 
X
[13], 5, 
k7
);

265 
	`Subround
(
G
, 
c2
, 
d2
, 
e2
, 
a2
, 
b2
, 
X
[ 8], 15, 
k8
);

266 
	`Subround
(
G
, 
b2
, 
c2
, 
d2
, 
e2
, 
a2
, 
X
[ 6], 5, 
k8
);

267 
	`Subround
(
G
, 
a2
, 
b2
, 
c2
, 
d2
, 
e2
, 
X
[ 4], 8, 
k8
);

268 
	`Subround
(
G
, 
e2
, 
a2
, 
b2
, 
c2
, 
d2
, 
X
[ 1], 11, 
k8
);

269 
	`Subround
(
G
, 
d2
, 
e2
, 
a2
, 
b2
, 
c2
, 
X
[ 3], 14, 
k8
);

270 
	`Subround
(
G
, 
c2
, 
d2
, 
e2
, 
a2
, 
b2
, 
X
[11], 14, 
k8
);

271 
	`Subround
(
G
, 
b2
, 
c2
, 
d2
, 
e2
, 
a2
, 
X
[15], 6, 
k8
);

272 
	`Subround
(
G
, 
a2
, 
b2
, 
c2
, 
d2
, 
e2
, 
X
[ 0], 14, 
k8
);

273 
	`Subround
(
G
, 
e2
, 
a2
, 
b2
, 
c2
, 
d2
, 
X
[ 5], 6, 
k8
);

274 
	`Subround
(
G
, 
d2
, 
e2
, 
a2
, 
b2
, 
c2
, 
X
[12], 9, 
k8
);

275 
	`Subround
(
G
, 
c2
, 
d2
, 
e2
, 
a2
, 
b2
, 
X
[ 2], 12, 
k8
);

276 
	`Subround
(
G
, 
b2
, 
c2
, 
d2
, 
e2
, 
a2
, 
X
[13], 9, 
k8
);

277 
	`Subround
(
G
, 
a2
, 
b2
, 
c2
, 
d2
, 
e2
, 
X
[ 9], 12, 
k8
);

278 
	`Subround
(
G
, 
e2
, 
a2
, 
b2
, 
c2
, 
d2
, 
X
[ 7], 5, 
k8
);

279 
	`Subround
(
G
, 
d2
, 
e2
, 
a2
, 
b2
, 
c2
, 
X
[10], 15, 
k8
);

280 
	`Subround
(
G
, 
c2
, 
d2
, 
e2
, 
a2
, 
b2
, 
X
[14], 8, 
k8
);

282 
	`Subround
(
F
, 
b2
, 
c2
, 
d2
, 
e2
, 
a2
, 
X
[12], 8, 
k9
);

283 
	`Subround
(
F
, 
a2
, 
b2
, 
c2
, 
d2
, 
e2
, 
X
[15], 5, 
k9
);

284 
	`Subround
(
F
, 
e2
, 
a2
, 
b2
, 
c2
, 
d2
, 
X
[10], 12, 
k9
);

285 
	`Subround
(
F
, 
d2
, 
e2
, 
a2
, 
b2
, 
c2
, 
X
[ 4], 9, 
k9
);

286 
	`Subround
(
F
, 
c2
, 
d2
, 
e2
, 
a2
, 
b2
, 
X
[ 1], 12, 
k9
);

287 
	`Subround
(
F
, 
b2
, 
c2
, 
d2
, 
e2
, 
a2
, 
X
[ 5], 5, 
k9
);

288 
	`Subround
(
F
, 
a2
, 
b2
, 
c2
, 
d2
, 
e2
, 
X
[ 8], 14, 
k9
);

289 
	`Subround
(
F
, 
e2
, 
a2
, 
b2
, 
c2
, 
d2
, 
X
[ 7], 6, 
k9
);

290 
	`Subround
(
F
, 
d2
, 
e2
, 
a2
, 
b2
, 
c2
, 
X
[ 6], 8, 
k9
);

291 
	`Subround
(
F
, 
c2
, 
d2
, 
e2
, 
a2
, 
b2
, 
X
[ 2], 13, 
k9
);

292 
	`Subround
(
F
, 
b2
, 
c2
, 
d2
, 
e2
, 
a2
, 
X
[13], 6, 
k9
);

293 
	`Subround
(
F
, 
a2
, 
b2
, 
c2
, 
d2
, 
e2
, 
X
[14], 5, 
k9
);

294 
	`Subround
(
F
, 
e2
, 
a2
, 
b2
, 
c2
, 
d2
, 
X
[ 0], 15, 
k9
);

295 
	`Subround
(
F
, 
d2
, 
e2
, 
a2
, 
b2
, 
c2
, 
X
[ 3], 13, 
k9
);

296 
	`Subround
(
F
, 
c2
, 
d2
, 
e2
, 
a2
, 
b2
, 
X
[ 9], 11, 
k9
);

297 
	`Subround
(
F
, 
b2
, 
c2
, 
d2
, 
e2
, 
a2
, 
X
[11], 11, 
k9
);

299 
a1
 -ğ
ŒackA
[0];

300 
b1
 -ğ
ŒackA
[1];

301 
c1
 -ğ
ŒackA
[2];

302 
d1
 -ğ
ŒackA
[3];

303 
e1
 -ğ
ŒackA
[4];

304 
a2
 -ğ
ŒackB
[0];

305 
b2
 -ğ
ŒackB
[1];

306 
c2
 -ğ
ŒackB
[2];

307 
d2
 -ğ
ŒackB
[3];

308 
e2
 -ğ
ŒackB
[4];

310 ià(!
Ï¡
)

312 
ŒackA
[0] = (
b1
 + 
e1
è- 
d2
;

313 
ŒackA
[1] = 
c1
 - 
e2
;

314 
ŒackA
[2] = 
d1
 - 
a2
;

315 
ŒackA
[3] = 
e1
 - 
b2
;

316 
ŒackA
[4] = 
a1
 - 
c2
;

317 
ŒackB
[0] = 
d1
 - 
e2
;

318 
ŒackB
[1] = (
e1
 + 
c1
è- 
a2
;

319 
ŒackB
[2] = 
a1
 - 
b2
;

320 
ŒackB
[3] = 
b1
 - 
c2
;

321 
ŒackB
[4] = 
c1
 - 
d2
;

325 
ŒackB
[0] = 
a2
 - 
a1
;

326 
ŒackB
[1] = 
b2
 - 
b1
;

327 
ŒackB
[2] = 
c2
 - 
c1
;

328 
ŒackB
[3] = 
d2
 - 
d1
;

329 
ŒackB
[4] = 
e2
 - 
e1
;

330 
ŒackA
[0] = 0;

331 
ŒackA
[1] = 0;

332 
ŒackA
[2] = 0;

333 
ŒackA
[3] = 0;

334 
ŒackA
[4] = 0;

336 
	}
}

338 
	gNAMESPACE_END


	@ttmac.h

3 #iâdeà
CRYPTOPP_TTMAC_H


4 
	#CRYPTOPP_TTMAC_H


	)

6 
	~"£ckey.h
"

7 
	~"™”hash.h
"

9 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

12 
şass
 
CRYPTOPP_NO_VTABLE
 
TTMAC_Ba£
 : 
public
 
FixedKeyL’gth
<20>,…ubliø
I‹¿‹dHash
<
wÜd32
, 
L™eEndŸn
, 64, 
Mes§geAuth’tiÿtiÚCode
>

14 
public
:

15 
¡d
::
¡ršg
 
	`SticAlgÜ™hmName
(è{ std::
	`¡ršg
("Two-Track-MAC");}

16 
	`CRYPTOPP_CONSTANT
(
DIGESTSIZE
=20)

18 
	`Dige¡Size
(ècÚ¡ { 
DIGESTSIZE
;};

19 
	`UncheckedS‘Key
(cÚ¡ 
by‹
 *
u£rKey
, 
keyËngth
, cÚ¡ 
NameV®uePaœs
 &
·¿ms
);

20 
	`Trunÿ‹dFš®
(
by‹
 *
mac
, 
size_t
 
size
);

22 
´Ùeùed
:

23 
	`T¿nsfÜm
 (
wÜd32
 *
dige¡
, cÚ¡ wÜd32 *
X
, 
boŞ
 
Ï¡
);

24 
	`HashEndŸnCÜ»ùedBlock
(cÚ¡ 
wÜd32
 *
d©a
è{
	`T¿nsfÜm
(
m_dige¡
, d©a, 
çl£
);}

25 
	`In™
();

26 
wÜd32
* 
	`S‹Buf
(è{ 
m_dige¡
;}

28 
FixedSizeSecBlock
<
wÜd32
, 10> 
m_dige¡
;

29 
FixedSizeSecBlock
<
wÜd32
, 5> 
m_key
;

30 
	}
};

34 
DOCUMENTED_TYPEDEF
(
Mes§geAuth’tiÿtiÚCodeFš®
<
TTMAC_Ba£
>, 
TTMAC
)

36 
	gNAMESPACE_END


	@twofish.cpp

4 
	~"pch.h
"

5 
	~"twofish.h
"

6 
	~"misc.h
"

8 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

12 
šlše
 
	$Mod
(
c
)

14 cÚ¡ 
modulus
 = 0x14d;

15 
c2
 = (
c
<<1è^ ((ø& 0x80è? 
modulus
 : 0);

16 
c1
 = 
c2
 ^ (
c
>>1è^ ((ø& 1è? (
modulus
>>1) : 0);

17  
c
 | (
c1
 << 8è| (
c2
 << 16) | (c1 << 24);

18 
	}
}

22 
wÜd32
 
	$R“dSŞomÚ
(
wÜd32
 
high
, wÜd32 
low
)

24 
i
=0; i<8; i++)

26 
high
 = 
	`Mod
(high>>24è^ (high<<8è^ (
low
>>24);

27 
low
 <<= 8;

29  
high
;

30 
	}
}

32 
šlše
 
wÜd32
 
	gTwofish
::
Ba£
::
	$h0
(
wÜd32
 
x
, cÚ¡ wÜd32 *
key
, 
kL’
)

34 
x
 = x | (x<<8) | (x<<16) | (x<<24);

35 
kL’
)

37 
	#Q
(
a
, 
b
, 
c
, 
d
, 
t
è
q
[a][
	`GETBYTE
Ñ,0)] ^ (q[b][GETBYTEÑ,1)] << 8è^ (q[c][GETBYTEÑ,2)] << 16è^ (q[d][GETBYTEÑ,3)] << 24)

	)

38 4: 
x
 = 
	`Q
(1, 0, 0, 1, xè^ 
key
[6];

39 3: 
x
 = 
	`Q
(1, 1, 0, 0, xè^ 
key
[4];

40 2: 
x
 = 
	`Q
(0, 1, 0, 1, xè^ 
key
[2];

41 
x
 = 
	`Q
(0, 0, 1, 1, xè^ 
key
[0];

43  
x
;

44 
	}
}

46 
šlše
 
wÜd32
 
	gTwofish
::
Ba£
::
	$h
(
wÜd32
 
x
, cÚ¡ wÜd32 *
key
, 
kL’
)

48 
x
 = 
	`h0
(x, 
key
, 
kL’
);

49  
mds
[0][
	`GETBYTE
(
x
,0)] ^ mds[1][GETBYTE(x,1)] ^ mds[2][GETBYTE(x,2)] ^ mds[3][GETBYTE(x,3)];

50 
	}
}

52 
	gTwofish
::
Ba£
::
	$UncheckedS‘Key
(cÚ¡ 
by‹
 *
u£rKey
, 
keyËngth
, cÚ¡ 
NameV®uePaœs
 &)

54 
	`As£¹V®idKeyL’gth
(
keyËngth
);

56 
Ën
 = (
keyËngth
 <= 16 ? 2 : (keylength <= 24 ? 3 : 4));

57 
SecBlock
<
wÜd32
> 
	`key
(
Ën
*2);

58 
	`G‘U£rKey
(
LITTLE_ENDIAN_ORDER
, 
key
.
	`begš
(), 
Ën
*2, 
u£rKey
, 
keyËngth
);

60 
i
;

61 
i
=0; i<40; i+=2)

63 
wÜd32
 
a
 = 
	`h
(
i
, 
key
, 
Ën
);

64 
wÜd32
 
b
 = 
	`rÙlFixed
(
	`h
(
i
+1, 
key
+1, 
Ën
), 8);

65 
m_k
[
i
] = 
a
+
b
;

66 
m_k
[
i
+1] = 
	`rÙlFixed
(
a
+2*
b
, 9);

69 
SecBlock
<
wÜd32
> 
	`svec
(2*
Ën
);

70 
i
=0; i<
Ën
; i++)

71 
svec
[2*(
Ën
-
i
-1)] = 
	`R“dSŞomÚ
(
key
[2*i+1], key[2*i]);

72 
i
=0; i<256; i++)

74 
wÜd32
 
t
 = 
	`h0
(
i
, 
svec
, 
Ën
);

75 
m_s
[0*256+
i
] = 
mds
[0][
	`GETBYTE
(
t
, 0)];

76 
m_s
[1*256+
i
] = 
mds
[1][
	`GETBYTE
(
t
, 1)];

77 
m_s
[2*256+
i
] = 
mds
[2][
	`GETBYTE
(
t
, 2)];

78 
m_s
[3*256+
i
] = 
mds
[3][
	`GETBYTE
(
t
, 3)];

80 
	}
}

82 
	#G1
(
x
è(
m_s
[0*256+
	`GETBYTE
(x,0)] ^ m_s[1*256+GETBYTE(x,1)] ^ m_s[2*256+GETBYTE(x,2)] ^ m_s[3*256+GETBYTE(x,3)])

	)

83 
	#G2
(
x
è(
m_s
[0*256+
	`GETBYTE
(x,3)] ^ m_s[1*256+GETBYTE(x,0)] ^ m_s[2*256+GETBYTE(x,1)] ^ m_s[3*256+GETBYTE(x,2)])

	)

85 
	#ENCROUND
(
n
, 
a
, 
b
, 
c
, 
d
) \

86 
x
 = 
	`G1
 (
a
); 
y
 = 
	`G2
 (
b
); \

87 
x
 +ğ
y
; y +ğx + 
k
[2 * (
n
) + 1]; \

88 (
c
è^ğ
x
 + 
k
[2 * (
n
)]; \

89 (
c
èğ
	`rÙrFixed
(c, 1); \

90 (
d
èğ
	`rÙlFixed
(d, 1è^ 
y


	)

92 
	#ENCCYCLE
(
n
) \

93 
	`ENCROUND
 (2 * (
n
), 
a
, 
b
, 
c
, 
d
); \

94 
	`ENCROUND
 (2 * (
n
è+ 1, 
c
, 
d
, 
a
, 
b
)

	)

96 
	#DECROUND
(
n
, 
a
, 
b
, 
c
, 
d
) \

97 
x
 = 
	`G1
 (
a
); 
y
 = 
	`G2
 (
b
); \

98 
x
 +ğ
y
; y += x; \

99 (
d
è^ğ
y
 + 
k
[2 * (
n
) + 1]; \

100 (
d
èğ
	`rÙrFixed
(d, 1); \

101 (
c
èğ
	`rÙlFixed
(c, 1); \

102 (
c
è^ğ(
x
 + 
k
[2 * (
n
)])

	)

104 
	#DECCYCLE
(
n
) \

105 
	`DECROUND
 (2 * (
n
è+ 1, 
c
, 
d
, 
a
, 
b
); \

106 
	`DECROUND
 (2 * (
n
), 
a
, 
b
, 
c
, 
d
)

	)

108 
	gBlockG‘AndPut
<
	twÜd32
, 
	tL™eEndŸn
> 
	tBlock
;

110 
	gTwofish
::
Enc
::
	$ProûssAndXÜBlock
(cÚ¡ 
by‹
 *
šBlock
, cÚ¡ by‹ *
xÜBlock
, by‹ *
outBlock
) const

112 
wÜd32
 
x
, 
y
, 
a
, 
b
, 
c
, 
d
;

114 
Block
::
	`G‘
(
šBlock
)(
a
)(
b
)(
c
)(
d
);

116 
a
 ^ğ
m_k
[0];

117 
b
 ^ğ
m_k
[1];

118 
c
 ^ğ
m_k
[2];

119 
d
 ^ğ
m_k
[3];

121 cÚ¡ 
wÜd32
 *
k
 = 
m_k
+8;

122 
	`ENCCYCLE
 (0);

123 
	`ENCCYCLE
 (1);

124 
	`ENCCYCLE
 (2);

125 
	`ENCCYCLE
 (3);

126 
	`ENCCYCLE
 (4);

127 
	`ENCCYCLE
 (5);

128 
	`ENCCYCLE
 (6);

129 
	`ENCCYCLE
 (7);

131 
c
 ^ğ
m_k
[4];

132 
d
 ^ğ
m_k
[5];

133 
a
 ^ğ
m_k
[6];

134 
b
 ^ğ
m_k
[7];

136 
Block
::
	`Put
(
xÜBlock
, 
outBlock
)(
c
)(
d
)(
a
)(
b
);

137 
	}
}

139 
	gTwofish
::
Dec
::
	$ProûssAndXÜBlock
(cÚ¡ 
by‹
 *
šBlock
, cÚ¡ by‹ *
xÜBlock
, by‹ *
outBlock
) const

141 
wÜd32
 
x
, 
y
, 
a
, 
b
, 
c
, 
d
;

143 
Block
::
	`G‘
(
šBlock
)(
c
)(
d
)(
a
)(
b
);

145 
c
 ^ğ
m_k
[4];

146 
d
 ^ğ
m_k
[5];

147 
a
 ^ğ
m_k
[6];

148 
b
 ^ğ
m_k
[7];

150 cÚ¡ 
wÜd32
 *
k
 = 
m_k
+8;

151 
	`DECCYCLE
 (7);

152 
	`DECCYCLE
 (6);

153 
	`DECCYCLE
 (5);

154 
	`DECCYCLE
 (4);

155 
	`DECCYCLE
 (3);

156 
	`DECCYCLE
 (2);

157 
	`DECCYCLE
 (1);

158 
	`DECCYCLE
 (0);

160 
a
 ^ğ
m_k
[0];

161 
b
 ^ğ
m_k
[1];

162 
c
 ^ğ
m_k
[2];

163 
d
 ^ğ
m_k
[3];

165 
Block
::
	`Put
(
xÜBlock
, 
outBlock
)(
a
)(
b
)(
c
)(
d
);

166 
	}
}

168 
	gNAMESPACE_END


	@twofish.h

1 #iâdeà
CRYPTOPP_TWOFISH_H


2 
	#CRYPTOPP_TWOFISH_H


	)

7 
	~"£ckey.h
"

8 
	~"£cblock.h
"

10 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

13 
Twofish_Info
 : 
public
 
FixedBlockSize
<16>,…ubliø
V¬ŸbËKeyL’gth
<16, 0, 32>, 
FixedRounds
<16>

15 cÚ¡ *
	`SticAlgÜ™hmName
() { "Twofish";}

16 
	}
};

19 
şass
 
	gTwofish
 : 
public
 
Twofish_Info
,…ubliø
	gBlockCh”Docum’tiÚ


21 
şass
 
CRYPTOPP_NO_VTABLE
 
	gBa£
 : 
public
 
BlockCh”Im¶
<
Twofish_Info
>

23 
public
:

24 
UncheckedS‘Key
(cÚ¡ 
by‹
 *
u£rKey
, 
Ëngth
, cÚ¡ 
NameV®uePaœs
 &
·¿ms
);

26 
	g´Ùeùed
:

27 
wÜd32
 
h0
(wÜd32 
x
, cÚ¡ wÜd32 *
key
, 
kL’
);

28 
wÜd32
 
h
(wÜd32 
x
, cÚ¡ wÜd32 *
key
, 
kL’
);

30 cÚ¡ 
by‹
 
	gq
[2][256];

31 cÚ¡ 
wÜd32
 
	gmds
[4][256];

33 
	gFixedSizeSecBlock
<
	gwÜd32
, 40> 
	gm_k
;

34 
	gFixedSizeSecBlock
<
	gwÜd32
, 4*256> 
	gm_s
;

37 şas 
	cCRYPTOPP_NO_VTABLE
 
	gEnc
 : 
public
 
Ba£


39 
public
:

40 
ProûssAndXÜBlock
(cÚ¡ 
by‹
 *
šBlock
, cÚ¡ by‹ *
xÜBlock
, by‹ *
outBlock
) const;

43 şas 
	cCRYPTOPP_NO_VTABLE
 
	gDec
 : 
public
 
Ba£


45 
public
:

46 
ProûssAndXÜBlock
(cÚ¡ 
by‹
 *
šBlock
, cÚ¡ by‹ *
xÜBlock
, by‹ *
outBlock
) const;

49 
	gpublic
:

50 
BlockCh”Fš®
<
	tENCRYPTION
, 
	tEnc
> 
	tEnüy±iÚ
;

51 
	gBlockCh”Fš®
<
	tDECRYPTION
, 
	tDec
> 
	tDeüy±iÚ
;

54 
	gTwofish
::
	tEnüy±iÚ
 
	tTwofishEnüy±iÚ
;

55 
	gTwofish
::
	tDeüy±iÚ
 
	tTwofishDeüy±iÚ
;

57 
	gNAMESPACE_END


	@validat1.cpp

3 
	~"pch.h
"

5 
	#CRYPTOPP_ENABLE_NAMESPACE_WEAK
 1

	)

6 
	~"fes.h
"

7 
	~"hex.h
"

8 
	~"ba£32.h
"

9 
	~"ba£64.h
"

10 
	~"modes.h
"

11 
	~"cbcmac.h
"

12 
	~"dmac.h
"

13 
	~"id—.h
"

14 
	~"des.h
"

15 
	~"rc2.h
"

16 
	~"¬c4.h
"

17 
	~"rc5.h
"

18 
	~"blowfish.h
"

19 
	~"3way.h
"

20 
	~"§ãr.h
"

21 
	~"go¡.h
"

22 
	~"sh¬k.h
"

23 
	~"ÿ¡.h
"

24 
	~"squ¬e.h
"

25 
	~"£®.h
"

26 
	~"rc6.h
"

27 
	~"m¬s.h
"

28 
	~"rijnd«l.h
"

29 
	~"twofish.h
"

30 
	~"£½’t.h
"

31 
	~"skjack.h
"

32 
	~"shaÿl2.h
"

33 
	~"ÿm–lŸ.h
"

34 
	~"o¤ng.h
"

35 
	~"zdeæ©e.h
"

36 
	~"ıu.h
"

38 
	~<time.h
>

39 
	~<memÜy
>

40 
	~<io¡»am
>

41 
	~<iomª
>

43 
	~"v®id©e.h
"

45 
	$USING_NAMESPACE
(
Cry±oPP
)

46 
	$USING_NAMESPACE
(
¡d
)

48 
boŞ
 
	$V®id©eAÎ
(
boŞ
 
thÜough
)

50 
boŞ
 
·ss
=
	`Te¡S‘tšgs
();

51 
·ss
=
	`Te¡OS_RNG
() &&…ass;

53 
·ss
=
	`V®id©eCRC32
() &&…ass;

54 
·ss
=
	`V®id©eAdËr32
() &&…ass;

55 
·ss
=
	`V®id©eMD2
() &&…ass;

56 
·ss
=
	`V®id©eMD5
() &&…ass;

57 
·ss
=
	`V®id©eSHA
() &&…ass;

58 
·ss
=
	`RunTe¡D©aFe
("TestVectors/sha3.txt") &&…ass;

59 
·ss
=
	`V®id©eTig”
() &&…ass;

60 
·ss
=
	`V®id©eRIPEMD
() &&…ass;

61 
·ss
=
	`V®id©ePªama
() &&…ass;

62 
·ss
=
	`V®id©eWhœÍoŞ
() &&…ass;

64 
·ss
=
	`V®id©eHMAC
() &&…ass;

65 
·ss
=
	`V®id©eTTMAC
() &&…ass;

67 
·ss
=
	`V®id©ePBKDF
() &&…ass;

69 
·ss
=
	`V®id©eDES
() &&…ass;

70 
·ss
=
	`V®id©eCh”Modes
() &&…ass;

71 
·ss
=
	`V®id©eIDEA
() &&…ass;

72 
·ss
=
	`V®id©eSAFER
() &&…ass;

73 
·ss
=
	`V®id©eRC2
() &&…ass;

74 
·ss
=
	`V®id©eARC4
() &&…ass;

75 
·ss
=
	`V®id©eRC5
() &&…ass;

76 
·ss
=
	`V®id©eBlowfish
() &&…ass;

77 
·ss
=
	`V®id©eTh»eWay
() &&…ass;

78 
·ss
=
	`V®id©eGOST
() &&…ass;

79 
·ss
=
	`V®id©eSHARK
() &&…ass;

80 
·ss
=
	`V®id©eCAST
() &&…ass;

81 
·ss
=
	`V®id©eSqu¬e
() &&…ass;

82 
·ss
=
	`V®id©eSKIPJACK
() &&…ass;

83 
·ss
=
	`V®id©eSEAL
() &&…ass;

84 
·ss
=
	`V®id©eRC6
() &&…ass;

85 
·ss
=
	`V®id©eMARS
() &&…ass;

86 
·ss
=
	`V®id©eRijnd«l
() &&…ass;

87 
·ss
=
	`V®id©eTwofish
() &&…ass;

88 
·ss
=
	`V®id©eS”³Á
() &&…ass;

89 
·ss
=
	`V®id©eSHACAL2
() &&…ass;

90 
·ss
=
	`V®id©eCam–lŸ
() &&…ass;

91 
·ss
=
	`V®id©eS®§
() &&…ass;

92 
·ss
=
	`V®id©eSo£mªuk
() &&…ass;

93 
·ss
=
	`V®id©eVMAC
() &&…ass;

94 
·ss
=
	`V®id©eCCM
() &&…ass;

95 
·ss
=
	`V®id©eGCM
() &&…ass;

96 
·ss
=
	`V®id©eCMAC
() &&…ass;

97 
·ss
=
	`RunTe¡D©aFe
("TestVectors/eax.txt") &&…ass;

98 
·ss
=
	`RunTe¡D©aFe
("TestVectors/seed.txt") &&…ass;

100 
·ss
=
	`V®id©eBBS
() &&…ass;

101 
·ss
=
	`V®id©eDH
() &&…ass;

102 
·ss
=
	`V®id©eMQV
() &&…ass;

103 
·ss
=
	`V®id©eRSA
() &&…ass;

104 
·ss
=
	`V®id©eElGam®
() &&…ass;

105 
·ss
=
	`V®id©eDLIES
() &&…ass;

106 
·ss
=
	`V®id©eNR
() &&…ass;

107 
·ss
=
	`V®id©eDSA
(
thÜough
) &&…ass;

108 
·ss
=
	`V®id©eLUC
() &&…ass;

109 
·ss
=
	`V®id©eLUC_DH
() &&…ass;

110 
·ss
=
	`V®id©eLUC_DL
() &&…ass;

111 
·ss
=
	`V®id©eXTR_DH
() &&…ass;

112 
·ss
=
	`V®id©eRabš
() &&…ass;

113 
·ss
=
	`V®id©eRW
() &&…ass;

115 
·ss
=
	`V®id©eECP
() &&…ass;

116 
·ss
=
	`V®id©eEC2N
() &&…ass;

117 
·ss
=
	`V®id©eECDSA
() &&…ass;

118 
·ss
=
	`V®id©eESIGN
() &&…ass;

120 ià(
·ss
)

121 
cout
 << "\nAllests…assed!\n";

123 
cout
 << "\nOops! Not‡llests…assed.\n";

125  
·ss
;

126 
	}
}

128 
boŞ
 
	$Te¡S‘tšgs
()

130 
boŞ
 
·ss
 = 
Œue
;

132 
cout
 << "\nTesting Settings...\n\n";

134 
wÜd32
 
w
;

135 
	`memıy_s
(&
w
, (w), "\x01\x02\x03\x04", 4);

137 ià(
w
 == 0x04030201L)

139 #ifdeà
IS_LITTLE_ENDIAN


140 
cout
 << "passed: ";

142 
cout
 << "FAILED: ";

143 
·ss
 = 
çl£
;

145 
cout
 << "Your machine is†ittleƒndian.\n";

147 ià(
w
 == 0x01020304L)

149 #iâdeà
IS_LITTLE_ENDIAN


150 
cout
 << "passed: ";

152 
cout
 << "FAILED: ";

153 
·ss
 = 
çl£
;

155 
cout
 << "Your machine is bigƒndian.\n";

159 
cout
 << "FAILED: Your machine is‚either bigƒndian‚or†ittleƒndian.\n";

160 
·ss
 = 
çl£
;

163 #ifdeà
CRYPTOPP_ALLOW_UNALIGNED_DATA_ACCESS


164 
by‹
 
‹¡v®s
[10] = {1,2,2,3,3,3,3,2,2,1};

165 ià(*(
wÜd32
 *)(
‹¡v®s
+3è=ğ0x03030303 && *(
wÜd64
 *)Ñe¡v®s+1è=ğ
	`W64LIT
(0x0202030303030202))

166 
cout
 << "passed: Your machine‡llows unaligned data‡ccess.\n";

169 
cout
 << "FAILED: Unaligned data‡ccess gave incorrect„esults.\n";

170 
·ss
 = 
çl£
;

173 
cout
 << "passed: CRYPTOPP_ALLOW_UNALIGNED_DATA_ACCESS is‚ot defined. Will„estricto‡ligned data‡ccess.\n";

176 ià((
by‹
) == 1)

177 
cout
 << "passed: ";

180 
cout
 << "FAILED: ";

181 
·ss
 = 
çl£
;

183 
cout
 << "sizeof(by‹è=ğ" << (
by‹
è<< 
’dl
;

185 ià((
wÜd16
) == 2)

186 
cout
 << "passed: ";

189 
cout
 << "FAILED: ";

190 
·ss
 = 
çl£
;

192 
cout
 << "sizeof(wÜd16è=ğ" << (
wÜd16
è<< 
’dl
;

194 ià((
wÜd32
) == 4)

195 
cout
 << "passed: ";

198 
cout
 << "FAILED: ";

199 
·ss
 = 
çl£
;

201 
cout
 << "sizeof(wÜd32è=ğ" << (
wÜd32
è<< 
’dl
;

203 ià((
wÜd64
) == 8)

204 
cout
 << "passed: ";

207 
cout
 << "FAILED: ";

208 
·ss
 = 
çl£
;

210 
cout
 << "sizeof(wÜd64è=ğ" << (
wÜd64
è<< 
’dl
;

212 #ifdeà
CRYPTOPP_WORD128_AVAILABLE


213 ià((
wÜd128
) == 16)

214 
cout
 << "passed: ";

217 
cout
 << "FAILED: ";

218 
·ss
 = 
çl£
;

220 
cout
 << "sizeof(wÜd128è=ğ" << (
wÜd128
è<< 
’dl
;

223 ià((
wÜd
è=ğ2*(
hwÜd
)

224 #ifdeà
CRYPTOPP_NATIVE_DWORD_AVAILABLE


225 && (
dwÜd
è=ğ2*(
wÜd
)

228 
cout
 << "passed: ";

231 
cout
 << "FAILED: ";

232 
·ss
 = 
çl£
;

234 
cout
 << "sizeof(hwÜdè=ğ" << (
hwÜd
è<< ", sizeof(wÜdè=ğ" << (
wÜd
);

235 #ifdeà
CRYPTOPP_NATIVE_DWORD_AVAILABLE


236 
cout
 << ", sizeof(dwÜdè=ğ" << (
dwÜd
);

238 
cout
 << 
’dl
;

240 #ifdeà
CRYPTOPP_CPUID_AVAILABLE


241 
boŞ
 
hasMMX
 = 
	`HasMMX
();

242 
boŞ
 
hasISSE
 = 
	`HasISSE
();

243 
boŞ
 
hasSSE2
 = 
	`HasSSE2
();

244 
boŞ
 
hasSSSE3
 = 
	`HasSSSE3
();

245 
boŞ
 
isP4
 = 
	`IsP4
();

246 
ÿcheLšeSize
 = 
	`G‘CacheLšeSize
();

248 ià((
isP4
 && (!
hasMMX
 || !
hasSSE2
)è|| (hasSSE2 && !hasMMXè|| (
ÿcheLšeSize
 < 16 || cacheLšeSiz> 256 || !
	`IsPow”Of2
(cacheLineSize)))

250 
cout
 << "FAILED: ";

251 
·ss
 = 
çl£
;

254 
cout
 << "passed: ";

256 
cout
 << "hasMMX =ğ" << 
hasMMX
 << ", hasISSE =ğ" << 
hasISSE
 << ", hasSSE2 =ğ" << 
hasSSE2
 << ", hasSSSE3 =ğ" << 
hasSSSE3
 << ", hasAESNI =ğ" << 
	`HasAESNI
(è<< ", hasCLMUL =ğ" << 
	`HasCLMUL
(è<< ", isP4 =ğ" << 
isP4
 << ", cacheLšeSiz=ğ" << 
ÿcheLšeSize
;

257 
cout
 << ", AESNI_INTRINSICS =ğ" << 
CRYPTOPP_BOOL_AESNI_INTRINSICS_AVAILABLE
 << 
’dl
;

260 ià(!
·ss
)

262 
cout
 << "Somü™iÿÈ£‰šg iÀcÚfig.h i šƒ¼Ü. PËa£ fix iˆªd„ecompe." << 
’dl
;

263 
	`abÜt
();

265  
·ss
;

266 
	}
}

268 
boŞ
 
	$Te¡OS_RNG
()

270 
boŞ
 
·ss
 = 
Œue
;

272 
memb”_±r
<
RªdomNumb”G’”©Ü
> 
ºg
;

273 #ifdeà
BLOCKING_RNG_AVAILABLE


274 
Œy
 {
ºg
.
	`»£t
(
Ãw
 
BlockšgRng
);}

275 
	`ÿtch
 (
OS_RNG_E¼
 &) {}

278 ià(
ºg
.
	`g‘
())

280 
cout
 << "\nTesting operating system…rovided blocking„andom‚umber generator...\n\n";

282 
A¼aySšk
 *
sšk
;

283 
RªdomNumb”Sourû
 
	`‹¡
(*
ºg
, 
UINT_MAX
, 
çl£
, 
Ãw
 
	`Deæ©Ü
(
sšk
òew 
	`A¼aySšk
(
NULL
,0)));

284 
tÙ®
=0, 
Ëngth
=0;

285 
time_t
 
t
 = 
	`time
(
NULL
), 
t1
 = 0;

288 
tÙ®
 < 16 && (
t1
 < 10 ||otal*8 > ()t1))

290 
‹¡
.
	`Pump
(1);

291 
tÙ®
 += 1;

292 
t1
 = 
	`time
(
NULL
è- 
t
;

295 ià(
tÙ®
 < 16)

297 
cout
 << "FAILED:";

298 
·ss
 = 
çl£
;

301 
cout
 << "passed:";

302 
cout
 << " iˆtook " << (
t1
è<< " secÚd tØg’”©" << 
tÙ®
 << " by‹s" << 
’dl
;

305 ià(
t1
 < 2)

309 
t
 = 
	`time
(
NULL
);

310 
	`time
(
NULL
è- 
t
 < 2)

312 
‹¡
.
	`Pump
(1);

313 
tÙ®
 += 1;

318 
t
 = 
	`time
(
NULL
);

319 
	`time
(
NULL
è- 
t
 < 2)

321 
‹¡
.
	`Pump
(1);

322 
tÙ®
 += 1;

323 
Ëngth
 += 1;

325 ià(
Ëngth
 > 1024)

327 
cout
 << "FAILED:";

328 
·ss
 = 
çl£
;

331 
cout
 << "passed:";

332 
cout
 << " iˆg’”©ed " << 
Ëngth
 << " by‹ š " << (
	`time
(
NULL
è- 
t
è<< " secÚds" << 
’dl
;

336 
‹¡
.
	`A‰achedT¿nsfÜm©iÚ
()->
	`Mes§geEnd
();

338 ià(
sšk
->
	`TÙ®PutL’gth
(è< 
tÙ®
)

340 
cout
 << "FAILED:";

341 
·ss
 = 
çl£
;

344 
cout
 << "passed:";

345 
cout
 << " " << 
tÙ®
 << " g’”©ed by‹ com´es£dØ" << (
size_t
)
sšk
->
	`TÙ®PutL’gth
(è<< " by‹ by DEFLATE" << 
’dl
;

348 
cout
 << "\nNØİ”©šg sy¡em…rovided blockšg„ªdom‚umb” g’”©Ü, skpšge¡." << 
’dl
;

350 
ºg
.
	`»£t
(
NULL
);

351 #ifdeà
NONBLOCKING_RNG_AVAILABLE


352 
Œy
 {
ºg
.
	`»£t
(
Ãw
 
NÚblockšgRng
);}

353 
	`ÿtch
 (
OS_RNG_E¼
 &) {}

356 ià(
ºg
.
	`g‘
())

358 
cout
 << "\nTesting operating system…rovided‚onblocking„andom‚umber generator...\n\n";

360 
A¼aySšk
 *
sšk
;

361 
RªdomNumb”Sourû
 
	`‹¡
(*
ºg
, 100000, 
Œue
, 
Ãw
 
	`Deæ©Ü
(
sšk
òew 
	`A¼aySšk
(
NULL
, 0)));

363 ià(
sšk
->
	`TÙ®PutL’gth
() < 100000)

365 
cout
 << "FAILED:";

366 
·ss
 = 
çl£
;

369 
cout
 << "passed:";

370 
cout
 << " 100000 g’”©ed by‹ com´es£dØ" << (
size_t
)
sšk
->
	`TÙ®PutL’gth
(è<< " by‹ by DEFLATE" << 
’dl
;

373 
cout
 << "\nNØİ”©šg sy¡em…rovided‚Úblockšg„ªdom‚umb” g’”©Ü, skpšge¡." << 
’dl
;

375  
·ss
;

376 
	}
}

379 
	gauto_±r
<
	tBlockT¿nsfÜm©iÚ
> 
	t­bt
;

381 şas 
	cCh”FaùÜy


383 
	mpublic
:

384 
vœtu®
 
	$BlockSize
() const =0;

385 
vœtu®
 
	$KeyL’gth
() const =0;

387 
vœtu®
 
­bt
 
	$NewEnüy±iÚ
(cÚ¡ 
by‹
 *
key
) const =0;

388 
vœtu®
 
­bt
 
	$NewDeüy±iÚ
(cÚ¡ 
by‹
 *
key
) const =0;

391 
‹m¶©e
 <
şass
 
E
, cÏs 
D
> cÏs 
	cFixedRoundsCh”FaùÜy
 : 
public
 
Ch”FaùÜy


393 
public
:

394 
	$FixedRoundsCh”FaùÜy
(
keyËn
=0è: 
	`m_keyËn
(keyËn?keyËn:
E
::
DEFAULT_KEYLENGTH
) {}

395 
	$BlockSize
(ècÚ¡ { 
E
::
BLOCKSIZE
;
	}
}

396 
	$KeyL’gth
(ècÚ¡ { 
m_keyËn
;
	}
}

398 
­bt
 
	$NewEnüy±iÚ
(cÚ¡ 
by‹
 *
key
) const

399 { 
	`­bt
(
Ãw
 
	`E
(
key
, 
m_keyËn
));
	}
}

400 
­bt
 
	$NewDeüy±iÚ
(cÚ¡ 
by‹
 *
key
) const

401 { 
	`­bt
(
Ãw
 
	`D
(
key
, 
m_keyËn
));
	}
}

403 
	gm_keyËn
;

406 
	g‹m¶©e
 <
şass
 
	gE
, cÏs 
	gD
> cÏs 
	cV¬ŸbËRoundsCh”FaùÜy
 : 
public
 
Ch”FaùÜy


408 
public
:

409 
	$V¬ŸbËRoundsCh”FaùÜy
(
keyËn
=0, 
rounds
=0)

410 : 
	`m_keyËn
(
keyËn
 ? keyËÀ: 
E
::
DEFAULT_KEYLENGTH
), 
	`m_rounds
(
rounds
 ?„ound : E::
DEFAULT_ROUNDS
) {}

411 
	$BlockSize
(ècÚ¡ { 
E
::
BLOCKSIZE
;
	}
}

412 
	$KeyL’gth
(ècÚ¡ { 
m_keyËn
;
	}
}

414 
­bt
 
	$NewEnüy±iÚ
(cÚ¡ 
by‹
 *
key
) const

415 { 
	`­bt
(
Ãw
 
	`E
(
key
, 
m_keyËn
, 
m_rounds
));
	}
}

416 
­bt
 
	$NewDeüy±iÚ
(cÚ¡ 
by‹
 *
key
) const

417 { 
	`­bt
(
Ãw
 
	`D
(
key
, 
m_keyËn
, 
m_rounds
));
	}
}

419 
	gm_keyËn
, 
	gm_rounds
;

422 
boŞ
 
	$BlockT¿nsfÜm©iÚTe¡
(cÚ¡ 
Ch”FaùÜy
 &
cg
, 
Bufã»dT¿nsfÜm©iÚ
 &
v®d©a
, 
tu¶es
 = 0xffff)

424 
HexEncod”
 
	`ouut
(
Ãw
 
	`FeSšk
(
cout
));

425 
SecBy‹Block
 
	`¶aš
(
cg
.
	`BlockSize
()), 
	`ch”
(cg.BlockSize()), 
	`out
(cg.BlockSize()), 
	`ouÏš
(cg.BlockSize());

426 
SecBy‹Block
 
	`key
(
cg
.
	`KeyL’gth
());

427 
boŞ
 
·ss
=
Œue
, 
ç
;

429 
v®d©a
.
	`MaxR‘r›vabË
(è&& 
tu¶es
--)

431 
v®d©a
.
	`G‘
(
key
, 
cg
.
	`KeyL’gth
());

432 
v®d©a
.
	`G‘
(
¶aš
, 
cg
.
	`BlockSize
());

433 
v®d©a
.
	`G‘
(
ch”
, 
cg
.
	`BlockSize
());

435 
­bt
 
ŒªsE
 = 
cg
.
	`NewEnüy±iÚ
(
key
);

436 
ŒªsE
->
	`ProûssBlock
(
¶aš
, 
out
);

437 
ç
 = 
	`memcmp
(
out
, 
ch”
, 
cg
.
	`BlockSize
()) != 0;

439 
­bt
 
ŒªsD
 = 
cg
.
	`NewDeüy±iÚ
(
key
);

440 
ŒªsD
->
	`ProûssBlock
(
out
, 
ouÏš
);

441 
ç
=ç || 
	`memcmp
(
ouÏš
, 
¶aš
, 
cg
.
	`BlockSize
());

443 
·ss
 =…as && !
ç
;

445 
cout
 << (
ç
 ? "FAILED " : "passed ");

446 
ouut
.
	`Put
(
key
, 
cg
.
	`KeyL’gth
());

447 
cout
 << " ";

448 
ouut
.
	`Put
(
ouÏš
, 
cg
.
	`BlockSize
());

449 
cout
 << " ";

450 
ouut
.
	`Put
(
out
, 
cg
.
	`BlockSize
());

451 
cout
 << 
’dl
;

453  
·ss
;

454 
	}
}

456 
şass
 
	gF‹rTe¡”
 : 
public
 
UnæushabË
<
Sšk
>

458 
public
:

459 
F‹rTe¡”
(cÚ¡ 
by‹
 *
v®idOuut
, 
size_t
 
ouutL’
)

460 : 
v®idOuut
(v®idOuut), 
ouutL’
(ouutL’), 
couÁ”
(0), 
ç
(
çl£
) {}

461 
PutBy‹
(
by‹
 
šBy‹
)

463 ià(
	gcouÁ”
 >ğ
ouutL’
 || 
v®idOuut
[
couÁ”
] !ğ
šBy‹
)

465 
¡d
::
û¼
 << "šcÜ»ù ouuˆ" << 
couÁ”
 << ", " << (
wÜd16
)
v®idOuut
[couÁ”] << ", " << (wÜd16)
šBy‹
 << "\n";

466 
	gç
 = 
Œue
;

467 
as£¹
(
çl£
);

469 
	gcouÁ”
++;

471 
size_t
 
Put2
(cÚ¡ 
by‹
 *
šSŒšg
, size_ˆ
Ëngth
, 
mes§geEnd
, 
boŞ
 
blockšg
)

473 
	gËngth
--)

474 
	gF‹rTe¡”
::
PutBy‹
(*
šSŒšg
++);

476 ià(
	gmes§geEnd
)

477 ià(
	gcouÁ”
 !ğ
ouutL’
)

479 
ç
 = 
Œue
;

480 
as£¹
(
çl£
);

485 
boŞ
 
G‘ResuÉ
()

487  !
	gç
;

490 cÚ¡ 
by‹
 *
	gv®idOuut
;

491 
size_t
 
	gouutL’
, 
	gcouÁ”
;

492 
boŞ
 
	gç
;

495 
boŞ
 
	$Te¡F‹r
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
, cÚ¡ 
by‹
 *
š
, 
size_t
 
šL’
, cÚ¡ by‹ *
out
, size_ˆ
outL’
)

497 
F‹rTe¡”
 *
á
;

498 
bt
.
	`A‰ach
(
á
 = 
Ãw
 
	`F‹rTe¡”
(
out
, 
outL’
));

500 
šL’
)

502 
size_t
 
¿ndomL’
 = 
	`Glob®RNG
().
	`G’”©eWÜd32
(0, (
wÜd32
)
šL’
);

503 
bt
.
	`Put
(
š
, 
¿ndomL’
);

504 
š
 +ğ
¿ndomL’
;

505 
šL’
 -ğ
¿ndomL’
;

507 
bt
.
	`Mes§geEnd
();

508  
á
->
	`G‘ResuÉ
();

509 
	}
}

511 
boŞ
 
	$V®id©eDES
()

513 
cout
 << "\nDES validation suite„unning...\n\n";

515 
FeSourû
 
	`v®d©a
("Te¡D©a/desû¹.d©", 
Œue
, 
Ãw
 
HexDecod”
);

516 
boŞ
 
·ss
 = 
	`BlockT¿nsfÜm©iÚTe¡
(
FixedRoundsCh”FaùÜy
<
DESEnüy±iÚ
, 
DESDeüy±iÚ
>(), 
v®d©a
);

518 
cout
 << "\nTesting EDE2, EDE3,‡nd XEX3 variants...\n\n";

520 
FeSourû
 
	`v®d©a1
("Te¡D©a/3desv®.d©", 
Œue
, 
Ãw
 
HexDecod”
);

521 
·ss
 = 
	`BlockT¿nsfÜm©iÚTe¡
(
FixedRoundsCh”FaùÜy
<
DES_EDE2_Enüy±iÚ
, 
DES_EDE2_Deüy±iÚ
>(), 
v®d©a1
, 1) &&…ass;

522 
·ss
 = 
	`BlockT¿nsfÜm©iÚTe¡
(
FixedRoundsCh”FaùÜy
<
DES_EDE3_Enüy±iÚ
, 
DES_EDE3_Deüy±iÚ
>(), 
v®d©a1
, 1) &&…ass;

523 
·ss
 = 
	`BlockT¿nsfÜm©iÚTe¡
(
FixedRoundsCh”FaùÜy
<
DES_XEX3_Enüy±iÚ
, 
DES_XEX3_Deüy±iÚ
>(), 
v®d©a1
, 1) &&…ass;

525  
·ss
;

526 
	}
}

528 
boŞ
 
	$Te¡ModeIV
(
Symm‘ricCh”
 &
e
, Symm‘ricCh” &
d
)

530 
SecBy‹Block
 
Ï¡IV
, 
	`iv
(
e
.
	`IVSize
());

531 
SŒ—mT¿nsfÜm©iÚF‹r
 
	`f‹r
(
e
, 
Ãw
 
	`SŒ—mT¿nsfÜm©iÚF‹r
(
d
));

532 
by‹
 
¶aš‹xt
[20480];

534 
i
=1; i<(
¶aš‹xt
); i*=2)

536 
e
.
	`G‘NextIV
(
	`Glob®RNG
(), 
iv
);

537 ià(
iv
 =ğ
Ï¡IV
)

538  
çl£
;

540 
Ï¡IV
 = 
iv
;

542 
e
.
	`ResynchrÚize
(
iv
);

543 
d
.
	`ResynchrÚize
(
iv
);

545 
Ëngth
 = 
	`STDMAX
(
	`Glob®RNG
().
	`G’”©eWÜd32
(0, 
i
), (
wÜd32
)
e
.
	`MšLa¡BlockSize
());

546 
	`Glob®RNG
().
	`G’”©eBlock
(
¶aš‹xt
, 
Ëngth
);

548 ià(!
	`Te¡F‹r
(
f‹r
, 
¶aš‹xt
, 
Ëngth
,…laintext,†ength))

549  
çl£
;

552  
Œue
;

553 
	}
}

555 
boŞ
 
	$V®id©eCh”Modes
()

557 
cout
 << "\nTesting DES modes...\n\n";

558 cÚ¡ 
by‹
 
key
[] = {0x01,0x23,0x45,0x67,0x89,0xab,0xcd,0xef};

559 cÚ¡ 
by‹
 
iv
[] = {0x12,0x34,0x56,0x78,0x90,0xab,0xcd,0xef};

560 cÚ¡ 
by‹
 
¶aš
[] = {

564 
DESEnüy±iÚ
 
	`desE
(
key
);

565 
DESDeüy±iÚ
 
	`desD
(
key
);

566 
boŞ
 
·ss
=
Œue
, 
ç
;

570 cÚ¡ 
by‹
 
’üy±ed
[] = {

575 
ECB_Mode_Ex‹º®Ch”
::
Enüy±iÚ
 
	`modeE
(
desE
);

576 
ç
 = !
	`Te¡F‹r
(
	`SŒ—mT¿nsfÜm©iÚF‹r
(
modeE
, 
NULL
, 
SŒ—mT¿nsfÜm©iÚF‹r
::
NO_PADDING
).
	`Ref
(),

577 
¶aš
, ÕÏš), 
’üy±ed
, (encrypted));

578 
·ss
 =…as && !
ç
;

579 
cout
 << (
ç
 ? "FAILED " : "·s£d "è<< "ECBƒnüy±iÚ" << 
’dl
;

581 
ECB_Mode_Ex‹º®Ch”
::
Deüy±iÚ
 
	`modeD
(
desD
);

582 
ç
 = !
	`Te¡F‹r
(
	`SŒ—mT¿nsfÜm©iÚF‹r
(
modeD
, 
NULL
, 
SŒ—mT¿nsfÜm©iÚF‹r
::
NO_PADDING
).
	`Ref
(),

583 
’üy±ed
, Ónüy±ed), 
¶aš
, (plain));

584 
·ss
 =…as && !
ç
;

585 
cout
 << (
ç
 ? "FAILED " : "·s£d "è<< "ECB deüy±iÚ" << 
’dl
;

589 cÚ¡ 
by‹
 
’üy±ed
[] = {

594 
CBC_Mode_Ex‹º®Ch”
::
Enüy±iÚ
 
	`modeE
(
desE
, 
iv
);

595 
ç
 = !
	`Te¡F‹r
(
	`SŒ—mT¿nsfÜm©iÚF‹r
(
modeE
, 
NULL
, 
SŒ—mT¿nsfÜm©iÚF‹r
::
NO_PADDING
).
	`Ref
(),

596 
¶aš
, ÕÏš), 
’üy±ed
, (encrypted));

597 
·ss
 =…as && !
ç
;

598 
cout
 << (
ç
 ? "FAILED " : "·s£d "è<< "CBCƒnüy±iÚ w™h‚Ø·ddšg" << 
’dl
;

600 
CBC_Mode_Ex‹º®Ch”
::
Deüy±iÚ
 
	`modeD
(
desD
, 
iv
);

601 
ç
 = !
	`Te¡F‹r
(
	`SŒ—mT¿nsfÜm©iÚF‹r
(
modeD
, 
NULL
, 
SŒ—mT¿nsfÜm©iÚF‹r
::
NO_PADDING
).
	`Ref
(),

602 
’üy±ed
, Ónüy±ed), 
¶aš
, (plain));

603 
·ss
 =…as && !
ç
;

604 
cout
 << (
ç
 ? "FAILED " : "·s£d "è<< "CBC deüy±iÚ w™h‚Ø·ddšg" << 
’dl
;

606 
ç
 = !
	`Te¡ModeIV
(
modeE
, 
modeD
);

607 
·ss
 =…as && !
ç
;

608 
cout
 << (
ç
 ? "FAILED " : "·s£d "è<< "CBC modIV g’”©iÚ" << 
’dl
;

613 cÚ¡ 
by‹
 
’üy±ed
[] = {

619 
CBC_Mode_Ex‹º®Ch”
::
Enüy±iÚ
 
	`modeE
(
desE
, 
iv
);

620 
ç
 = !
	`Te¡F‹r
(
	`SŒ—mT¿nsfÜm©iÚF‹r
(
modeE
).
	`Ref
(),

621 
¶aš
, ÕÏš), 
’üy±ed
, (encrypted));

622 
·ss
 =…as && !
ç
;

623 
cout
 << (
ç
 ? "FAILED " : "·s£d "è<< "CBCƒnüy±iÚ w™h PKCS #7…addšg" << 
’dl
;

625 
CBC_Mode_Ex‹º®Ch”
::
Deüy±iÚ
 
	`modeD
(
desD
, 
iv
);

626 
ç
 = !
	`Te¡F‹r
(
	`SŒ—mT¿nsfÜm©iÚF‹r
(
modeD
).
	`Ref
(),

627 
’üy±ed
, Ónüy±ed), 
¶aš
, (plain));

628 
·ss
 =…as && !
ç
;

629 
cout
 << (
ç
 ? "FAILED " : "·s£d "è<< "CBC deüy±iÚ w™h PKCS #7…addšg" << 
’dl
;

634 cÚ¡ 
by‹
 
’üy±ed
[] = {

640 
CBC_Mode_Ex‹º®Ch”
::
Enüy±iÚ
 
	`modeE
(
desE
, 
iv
);

641 
ç
 = !
	`Te¡F‹r
(
	`SŒ—mT¿nsfÜm©iÚF‹r
(
modeE
, 
NULL
, 
SŒ—mT¿nsfÜm©iÚF‹r
::
ONE_AND_ZEROS_PADDING
).
	`Ref
(),

642 
¶aš
, ÕÏš), 
’üy±ed
, (encrypted));

643 
·ss
 =…as && !
ç
;

644 
cout
 << (
ç
 ? "FAILED " : "·s£d "è<< "CBCƒnüy±iÚ w™h oÃ-ªd-z”o ·ddšg" << 
’dl
;

646 
CBC_Mode_Ex‹º®Ch”
::
Deüy±iÚ
 
	`modeD
(
desD
, 
iv
);

647 
ç
 = !
	`Te¡F‹r
(
	`SŒ—mT¿nsfÜm©iÚF‹r
(
modeD
, 
NULL
, 
SŒ—mT¿nsfÜm©iÚF‹r
::
ONE_AND_ZEROS_PADDING
).
	`Ref
(),

648 
’üy±ed
, Ónüy±ed), 
¶aš
, (plain));

649 
·ss
 =…as && !
ç
;

650 
cout
 << (
ç
 ? "FAILED " : "·s£d "è<< "CBC deüy±iÚ w™h oÃ-ªd-z”o ·ddšg" << 
’dl
;

653 cÚ¡ 
by‹
 
¶aš
[] = {'a', 0, 0, 0, 0, 0, 0, 0};

655 cÚ¡ 
by‹
 
’üy±ed
[] = {

658 
CBC_Mode_Ex‹º®Ch”
::
Enüy±iÚ
 
	`modeE
(
desE
, 
iv
);

659 
ç
 = !
	`Te¡F‹r
(
	`SŒ—mT¿nsfÜm©iÚF‹r
(
modeE
, 
NULL
, 
SŒ—mT¿nsfÜm©iÚF‹r
::
ZEROS_PADDING
).
	`Ref
(),

660 
¶aš
, 1, 
’üy±ed
, (encrypted));

661 
·ss
 =…as && !
ç
;

662 
cout
 << (
ç
 ? "FAILED " : "·s£d "è<< "CBCƒnüy±iÚ w™h z”o ·ddšg" << 
’dl
;

664 
CBC_Mode_Ex‹º®Ch”
::
Deüy±iÚ
 
	`modeD
(
desD
, 
iv
);

665 
ç
 = !
	`Te¡F‹r
(
	`SŒ—mT¿nsfÜm©iÚF‹r
(
modeD
, 
NULL
, 
SŒ—mT¿nsfÜm©iÚF‹r
::
ZEROS_PADDING
).
	`Ref
(),

666 
’üy±ed
, Ónüy±ed), 
¶aš
, (plain));

667 
·ss
 =…as && !
ç
;

668 
cout
 << (
ç
 ? "FAILED " : "·s£d "è<< "CBC deüy±iÚ w™h z”o ·ddšg" << 
’dl
;

673 cÚ¡ 
by‹
 
’üy±ed
[] = {

678 
CBC_CTS_Mode_Ex‹º®Ch”
::
Enüy±iÚ
 
	`modeE
(
desE
, 
iv
);

679 
ç
 = !
	`Te¡F‹r
(
	`SŒ—mT¿nsfÜm©iÚF‹r
(
modeE
).
	`Ref
(),

680 
¶aš
, ÕÏš), 
’üy±ed
, (encrypted));

681 
·ss
 =…as && !
ç
;

682 
cout
 << (
ç
 ? "FAILED " : "·s£d "è<< "CBCƒnüy±iÚ w™h ch”‹xˆ¡—lšg (CTS)" << 
’dl
;

684 
CBC_CTS_Mode_Ex‹º®Ch”
::
Deüy±iÚ
 
	`modeD
(
desD
, 
iv
);

685 
ç
 = !
	`Te¡F‹r
(
	`SŒ—mT¿nsfÜm©iÚF‹r
(
modeD
).
	`Ref
(),

686 
’üy±ed
, Ónüy±ed), 
¶aš
, (plain));

687 
·ss
 =…as && !
ç
;

688 
cout
 << (
ç
 ? "FAILED " : "·s£d "è<< "CBC deüy±iÚ w™h ch”‹xˆ¡—lšg (CTS)" << 
’dl
;

690 
ç
 = !
	`Te¡ModeIV
(
modeE
, 
modeD
);

691 
·ss
 =…as && !
ç
;

692 
cout
 << (
ç
 ? "FAILED " : "·s£d "è<< "CBC CTS IV g’”©iÚ" << 
’dl
;

696 cÚ¡ 
by‹
 
deüy±iÚIV
[] = {0x4D, 0xD0, 0xAC, 0x8F, 0x47, 0xCF, 0x79, 0xCE};

697 cÚ¡ 
by‹
 
’üy±ed
[] = {0x12, 0x34, 0x56};

699 
by‹
 
¡Ş’IV
[8];

701 
CBC_CTS_Mode_Ex‹º®Ch”
::
Enüy±iÚ
 
	`modeE
(
desE
, 
iv
);

702 
modeE
.
	`S‘StŞ’IV
(
¡Ş’IV
);

703 
ç
 = !
	`Te¡F‹r
(
	`SŒ—mT¿nsfÜm©iÚF‹r
(
modeE
).
	`Ref
(),

704 
¶aš
, 3, 
’üy±ed
, (encrypted));

705 
ç
 = 
	`memcmp
(
¡Ş’IV
, 
deüy±iÚIV
, 8) != 0 || fail;

706 
·ss
 =…as && !
ç
;

707 
cout
 << (
ç
 ? "FAILED " : "·s£d "è<< "CBCƒnüy±iÚ w™h ch”‹xˆªd IV s‹®šg" << 
’dl
;

709 
CBC_CTS_Mode_Ex‹º®Ch”
::
Deüy±iÚ
 
	`modeD
(
desD
, 
¡Ş’IV
);

710 
ç
 = !
	`Te¡F‹r
(
	`SŒ—mT¿nsfÜm©iÚF‹r
(
modeD
).
	`Ref
(),

711 
’üy±ed
, Ónüy±ed), 
¶aš
, 3);

712 
·ss
 =…as && !
ç
;

713 
cout
 << (
ç
 ? "FAILED " : "·s£d "è<< "CBC deüy±iÚ w™h ch”‹xˆªd IV s‹®šg" << 
’dl
;

716 cÚ¡ 
by‹
 
’üy±ed
[] = {

721 
CFB_Mode_Ex‹º®Ch”
::
Enüy±iÚ
 
	`modeE
(
desE
, 
iv
);

722 
ç
 = !
	`Te¡F‹r
(
	`SŒ—mT¿nsfÜm©iÚF‹r
(
modeE
).
	`Ref
(),

723 
¶aš
, ÕÏš), 
’üy±ed
, (encrypted));

724 
·ss
 =…as && !
ç
;

725 
cout
 << (
ç
 ? "FAILED " : "·s£d "è<< "CFBƒnüy±iÚ" << 
’dl
;

727 
CFB_Mode_Ex‹º®Ch”
::
Deüy±iÚ
 
	`modeD
(
desE
, 
iv
);

728 
ç
 = !
	`Te¡F‹r
(
	`SŒ—mT¿nsfÜm©iÚF‹r
(
modeD
).
	`Ref
(),

729 
’üy±ed
, Ónüy±ed), 
¶aš
, (plain));

730 
·ss
 =…as && !
ç
;

731 
cout
 << (
ç
 ? "FAILED " : "·s£d "è<< "CFB deüy±iÚ" << 
’dl
;

733 
ç
 = !
	`Te¡ModeIV
(
modeE
, 
modeD
);

734 
·ss
 =…as && !
ç
;

735 
cout
 << (
ç
 ? "FAILED " : "·s£d "è<< "CFB modIV g’”©iÚ" << 
’dl
;

738 cÚ¡ 
by‹
 
¶aš
[] = {

740 cÚ¡ 
by‹
 
’üy±ed
[] = {

743 
CFB_Mode_Ex‹º®Ch”
::
Enüy±iÚ
 
	`modeE
(
desE
, 
iv
, 1);

744 
ç
 = !
	`Te¡F‹r
(
	`SŒ—mT¿nsfÜm©iÚF‹r
(
modeE
).
	`Ref
(),

745 
¶aš
, ÕÏš), 
’üy±ed
, (encrypted));

746 
·ss
 =…as && !
ç
;

747 
cout
 << (
ç
 ? "FAILED " : "·s£d "è<< "CFB (8-b™ f“dbackè’üy±iÚ" << 
’dl
;

749 
CFB_Mode_Ex‹º®Ch”
::
Deüy±iÚ
 
	`modeD
(
desE
, 
iv
, 1);

750 
ç
 = !
	`Te¡F‹r
(
	`SŒ—mT¿nsfÜm©iÚF‹r
(
modeD
).
	`Ref
(),

751 
’üy±ed
, Ónüy±ed), 
¶aš
, (plain));

752 
·ss
 =…as && !
ç
;

753 
cout
 << (
ç
 ? "FAILED " : "·s£d "è<< "CFB (8-b™ f“dbackèdeüy±iÚ" << 
’dl
;

755 
ç
 = !
	`Te¡ModeIV
(
modeE
, 
modeD
);

756 
·ss
 =…as && !
ç
;

757 
cout
 << (
ç
 ? "FAILED " : "·s£d "è<< "CFB (8-b™ f“dbackèIV g’”©iÚ" << 
’dl
;

760 cÚ¡ 
by‹
 
’üy±ed
[] = {

765 
OFB_Mode_Ex‹º®Ch”
::
Enüy±iÚ
 
	`modeE
(
desE
, 
iv
);

766 
ç
 = !
	`Te¡F‹r
(
	`SŒ—mT¿nsfÜm©iÚF‹r
(
modeE
).
	`Ref
(),

767 
¶aš
, ÕÏš), 
’üy±ed
, (encrypted));

768 
·ss
 =…as && !
ç
;

769 
cout
 << (
ç
 ? "FAILED " : "·s£d "è<< "OFBƒnüy±iÚ" << 
’dl
;

771 
OFB_Mode_Ex‹º®Ch”
::
Deüy±iÚ
 
	`modeD
(
desE
, 
iv
);

772 
ç
 = !
	`Te¡F‹r
(
	`SŒ—mT¿nsfÜm©iÚF‹r
(
modeD
).
	`Ref
(),

773 
’üy±ed
, Ónüy±ed), 
¶aš
, (plain));

774 
·ss
 =…as && !
ç
;

775 
cout
 << (
ç
 ? "FAILED " : "·s£d "è<< "OFB deüy±iÚ" << 
’dl
;

777 
ç
 = !
	`Te¡ModeIV
(
modeE
, 
modeD
);

778 
·ss
 =…as && !
ç
;

779 
cout
 << (
ç
 ? "FAILED " : "·s£d "è<< "OFB IV g’”©iÚ" << 
’dl
;

782 cÚ¡ 
by‹
 
’üy±ed
[] = {

787 
CTR_Mode_Ex‹º®Ch”
::
Enüy±iÚ
 
	`modeE
(
desE
, 
iv
);

788 
ç
 = !
	`Te¡F‹r
(
	`SŒ—mT¿nsfÜm©iÚF‹r
(
modeE
).
	`Ref
(),

789 
¶aš
, ÕÏš), 
’üy±ed
, (encrypted));

790 
·ss
 =…as && !
ç
;

791 
cout
 << (
ç
 ? "FAILED " : "·s£d "è<< "CouÁ” Mod’üy±iÚ" << 
’dl
;

793 
CTR_Mode_Ex‹º®Ch”
::
Deüy±iÚ
 
	`modeD
(
desE
, 
iv
);

794 
ç
 = !
	`Te¡F‹r
(
	`SŒ—mT¿nsfÜm©iÚF‹r
(
modeD
).
	`Ref
(),

795 
’üy±ed
, Ónüy±ed), 
¶aš
, (plain));

796 
·ss
 =…as && !
ç
;

797 
cout
 << (
ç
 ? "FAILED " : "·s£d "è<< "CouÁ” Moddeüy±iÚ" << 
’dl
;

799 
ç
 = !
	`Te¡ModeIV
(
modeE
, 
modeD
);

800 
·ss
 =…as && !
ç
;

801 
cout
 << (
ç
 ? "FAILED " : "·s£d "è<< "CouÁ” ModIV g’”©iÚ" << 
’dl
;

804 cÚ¡ 
by‹
 
¶aš
[] = {

809 cÚ¡ 
by‹
 
mac1
[] = {

811 cÚ¡ 
by‹
 
mac2
[] = {

814 
CBC_MAC
<
DES
> 
	`cbcmac
(
key
);

815 
HashF‹r
 
	`cbcmacF‹r
(
cbcmac
);

816 
ç
 = !
	`Te¡F‹r
(
cbcmacF‹r
, 
¶aš
, ÕÏš), 
mac1
, (mac1));

817 
·ss
 =…as && !
ç
;

818 
cout
 << (
ç
 ? "FAILED " : "·s£d "è<< "CBC MAC" << 
’dl
;

820 
DMAC
<
DES
> 
	`dmac
(
key
);

821 
HashF‹r
 
	`dmacF‹r
(
dmac
);

822 
ç
 = !
	`Te¡F‹r
(
dmacF‹r
, 
¶aš
, ÕÏš), 
mac2
, (mac2));

823 
·ss
 =…as && !
ç
;

824 
cout
 << (
ç
 ? "FAILED " : "·s£d "è<< "DMAC" << 
’dl
;

827 
CTR_Mode
<
AES
>::
Enüy±iÚ
 
	`modeE
(
¶aš
, 16,…lain);

828 
CTR_Mode
<
AES
>::
Deüy±iÚ
 
	`modeD
(
¶aš
, 16,…lain);

829 
ç
 = !
	`Te¡ModeIV
(
modeE
, 
modeD
);

830 
·ss
 =…as && !
ç
;

831 
cout
 << (
ç
 ? "FAILED " : "·s£d "è<< "AES CTR Mode" << 
’dl
;

834 
OFB_Mode
<
AES
>::
Enüy±iÚ
 
	`modeE
(
¶aš
, 16,…lain);

835 
OFB_Mode
<
AES
>::
Deüy±iÚ
 
	`modeD
(
¶aš
, 16,…lain);

836 
ç
 = !
	`Te¡ModeIV
(
modeE
, 
modeD
);

837 
·ss
 =…as && !
ç
;

838 
cout
 << (
ç
 ? "FAILED " : "·s£d "è<< "AES OFB Mode" << 
’dl
;

841 
CFB_Mode
<
AES
>::
Enüy±iÚ
 
	`modeE
(
¶aš
, 16,…lain);

842 
CFB_Mode
<
AES
>::
Deüy±iÚ
 
	`modeD
(
¶aš
, 16,…lain);

843 
ç
 = !
	`Te¡ModeIV
(
modeE
, 
modeD
);

844 
·ss
 =…as && !
ç
;

845 
cout
 << (
ç
 ? "FAILED " : "·s£d "è<< "AES CFB Mode" << 
’dl
;

848 
CBC_Mode
<
AES
>::
Enüy±iÚ
 
	`modeE
(
¶aš
, 16,…lain);

849 
CBC_Mode
<
AES
>::
Deüy±iÚ
 
	`modeD
(
¶aš
, 16,…lain);

850 
ç
 = !
	`Te¡ModeIV
(
modeE
, 
modeD
);

851 
·ss
 =…as && !
ç
;

852 
cout
 << (
ç
 ? "FAILED " : "·s£d "è<< "AES CBC Mode" << 
’dl
;

855  
·ss
;

856 
	}
}

858 
boŞ
 
	$V®id©eIDEA
()

860 
cout
 << "\nIDEA validation suite„unning...\n\n";

862 
FeSourû
 
	`v®d©a
("Te¡D©a/id—v®.d©", 
Œue
, 
Ãw
 
HexDecod”
);

863  
	`BlockT¿nsfÜm©iÚTe¡
(
FixedRoundsCh”FaùÜy
<
IDEAEnüy±iÚ
, 
IDEADeüy±iÚ
>(), 
v®d©a
);

864 
	}
}

866 
boŞ
 
	$V®id©eSAFER
()

868 
cout
 << "\nSAFER validation suite„unning...\n\n";

870 
FeSourû
 
	`v®d©a
("Te¡D©a/§ãrv®.d©", 
Œue
, 
Ãw
 
HexDecod”
);

871 
boŞ
 
·ss
 = 
Œue
;

872 
·ss
 = 
	`BlockT¿nsfÜm©iÚTe¡
(
V¬ŸbËRoundsCh”FaùÜy
<
SAFER_K_Enüy±iÚ
, 
SAFER_K_Deüy±iÚ
>(8,6), 
v®d©a
, 4) &&…ass;

873 
·ss
 = 
	`BlockT¿nsfÜm©iÚTe¡
(
V¬ŸbËRoundsCh”FaùÜy
<
SAFER_K_Enüy±iÚ
, 
SAFER_K_Deüy±iÚ
>(16,12), 
v®d©a
, 4) &&…ass;

874 
·ss
 = 
	`BlockT¿nsfÜm©iÚTe¡
(
V¬ŸbËRoundsCh”FaùÜy
<
SAFER_SK_Enüy±iÚ
, 
SAFER_SK_Deüy±iÚ
>(8,6), 
v®d©a
, 4) &&…ass;

875 
·ss
 = 
	`BlockT¿nsfÜm©iÚTe¡
(
V¬ŸbËRoundsCh”FaùÜy
<
SAFER_SK_Enüy±iÚ
, 
SAFER_SK_Deüy±iÚ
>(16,10), 
v®d©a
, 4) &&…ass;

876  
·ss
;

877 
	}
}

879 
boŞ
 
	$V®id©eRC2
()

881 
cout
 << "\nRC2 validation suite„unning...\n\n";

883 
FeSourû
 
	`v®d©a
("Te¡D©a/rc2v®.d©", 
Œue
, 
Ãw
 
HexDecod”
);

884 
HexEncod”
 
	`ouut
(
Ãw
 
	`FeSšk
(
cout
));

885 
SecBy‹Block
 
	`¶aš
(
RC2Enüy±iÚ
::
BLOCKSIZE
), 
	`ch”
(RC2Enüy±iÚ::BLOCKSIZE), 
	`out
(RC2Enüy±iÚ::BLOCKSIZE), 
	`ouÏš
(RC2Encryption::BLOCKSIZE);

886 
SecBy‹Block
 
	`key
(128);

887 
boŞ
 
·ss
=
Œue
, 
ç
;

889 
v®d©a
.
	`MaxR‘r›vabË
())

891 
by‹
 
keyL’
, 
efãùiveL’
;

893 
v®d©a
.
	`G‘
(
keyL’
);

894 
v®d©a
.
	`G‘
(
efãùiveL’
);

895 
v®d©a
.
	`G‘
(
key
, 
keyL’
);

896 
v®d©a
.
	`G‘
(
¶aš
, 
RC2Enüy±iÚ
::
BLOCKSIZE
);

897 
v®d©a
.
	`G‘
(
ch”
, 
RC2Enüy±iÚ
::
BLOCKSIZE
);

899 
­bt
 
	`ŒªsE
(
Ãw
 
	`RC2Enüy±iÚ
(
key
, 
keyL’
, 
efãùiveL’
));

900 
ŒªsE
->
	`ProûssBlock
(
¶aš
, 
out
);

901 
ç
 = 
	`memcmp
(
out
, 
ch”
, 
RC2Enüy±iÚ
::
BLOCKSIZE
) != 0;

903 
­bt
 
	`ŒªsD
(
Ãw
 
	`RC2Deüy±iÚ
(
key
, 
keyL’
, 
efãùiveL’
));

904 
ŒªsD
->
	`ProûssBlock
(
out
, 
ouÏš
);

905 
ç
=ç || 
	`memcmp
(
ouÏš
, 
¶aš
, 
RC2Enüy±iÚ
::
BLOCKSIZE
);

907 
·ss
 =…as && !
ç
;

909 
cout
 << (
ç
 ? "FAILED " : "passed ");

910 
ouut
.
	`Put
(
key
, 
keyL’
);

911 
cout
 << " ";

912 
ouut
.
	`Put
(
ouÏš
, 
RC2Enüy±iÚ
::
BLOCKSIZE
);

913 
cout
 << " ";

914 
ouut
.
	`Put
(
out
, 
RC2Enüy±iÚ
::
BLOCKSIZE
);

915 
cout
 << 
’dl
;

917  
·ss
;

918 
	}
}

920 
boŞ
 
	$V®id©eARC4
()

922 
Key0
[] = {0x01,0x23,0x45,0x67,0x89,0xab,0xcd,0xef };

923 
IÅut0
[]={0x01,0x23,0x45,0x67,0x89,0xab,0xcd,0xef};

924 
Ouut0
[] = {0x75,0xb7,0x87,0x80,0x99,0xe0,0xc5,0x96};

926 
Key1
[]={0x01,0x23,0x45,0x67,0x89,0xab,0xcd,0xef};

927 
IÅut1
[]={0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00};

928 
Ouut1
[]={0x74,0x94,0xc2,0xe7,0x10,0x4b,0x08,0x79};

930 
Key2
[]={0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00};

931 
IÅut2
[]={0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00};

932 
Ouut2
[]={0xde,0x18,0x89,0x41,0xa3,0x37,0x5d,0x3a};

934 
Key3
[]={0xef,0x01,0x23,0x45};

935 
IÅut3
[]={0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00};

936 
Ouut3
[]={0xd6,0xa1,0x41,0xa7,0xec,0x3c,0x38,0xdf,0xbd,0x61};

938 
Key4
[]={ 0x01,0x23,0x45,0x67,0x89,0xab, 0xcd,0xef };

939 
IÅut4
[] =

992 
Ouut4
[]= {

1047 
memb”_±r
<
W—k
::
ARC4
> 
¬c4
;

1048 
boŞ
 
·ss
=
Œue
, 
ç
;

1049 
i
;

1051 
cout
 << "\nARC4 validation suite„unning...\n\n";

1053 
¬c4
.
	`»£t
(
Ãw
 
W—k
::
	`ARC4
(
Key0
, (Key0)));

1054 
¬c4
->
	`ProûssSŒšg
(
IÅut0
, (Input0));

1055 
ç
 = 
	`memcmp
(
IÅut0
, 
Ouut0
, (Input0)) != 0;

1056 
cout
 << (
ç
 ? "FAILED" : "·s£d"è<< " Te¡ 0" << 
’dl
;

1057 
·ss
 =…as && !
ç
;

1059 
¬c4
.
	`»£t
(
Ãw
 
W—k
::
	`ARC4
(
Key1
, (Key1)));

1060 
¬c4
->
	`ProûssSŒšg
(
Key1
, 
IÅut1
, (Key1));

1061 
ç
 = 
	`memcmp
(
Ouut1
, 
Key1
, (Key1)) != 0;

1062 
cout
 << (
ç
 ? "FAILED" : "·s£d"è<< " Te¡ 1" << 
’dl
;

1063 
·ss
 =…as && !
ç
;

1065 
¬c4
.
	`»£t
(
Ãw
 
W—k
::
	`ARC4
(
Key2
, (Key2)));

1066 
i
=0, 
ç
=
çl£
; i<(
IÅut2
); i++)

1067 ià(
¬c4
->
	`ProûssBy‹
(
IÅut2
[
i
]è!ğ
Ouut2
[i])

1068 
ç
 = 
Œue
;

1069 
cout
 << (
ç
 ? "FAILED" : "·s£d"è<< " Te¡ 2" << 
’dl
;

1070 
·ss
 =…as && !
ç
;

1072 
¬c4
.
	`»£t
(
Ãw
 
W—k
::
	`ARC4
(
Key3
, (Key3)));

1073 
i
=0, 
ç
=
çl£
; i<(
IÅut3
); i++)

1074 ià(
¬c4
->
	`ProûssBy‹
(
IÅut3
[
i
]è!ğ
Ouut3
[i])

1075 
ç
 = 
Œue
;

1076 
cout
 << (
ç
 ? "FAILED" : "·s£d"è<< " Te¡ 3" << 
’dl
;

1077 
·ss
 =…as && !
ç
;

1079 
¬c4
.
	`»£t
(
Ãw
 
W—k
::
	`ARC4
(
Key4
, (Key4)));

1080 
i
=0, 
ç
=
çl£
; i<(
IÅut4
); i++)

1081 ià(
¬c4
->
	`ProûssBy‹
(
IÅut4
[
i
]è!ğ
Ouut4
[i])

1082 
ç
 = 
Œue
;

1083 
cout
 << (
ç
 ? "FAILED" : "·s£d"è<< " Te¡ 4" << 
’dl
;

1084 
·ss
 =…as && !
ç
;

1086  
·ss
;

1087 
	}
}

1089 
boŞ
 
	$V®id©eRC5
()

1091 
cout
 << "\nRC5 validation suite„unning...\n\n";

1093 
FeSourû
 
	`v®d©a
("Te¡D©a/rc5v®.d©", 
Œue
, 
Ãw
 
HexDecod”
);

1094  
	`BlockT¿nsfÜm©iÚTe¡
(
V¬ŸbËRoundsCh”FaùÜy
<
RC5Enüy±iÚ
, 
RC5Deüy±iÚ
>(16, 12), 
v®d©a
);

1095 
	}
}

1097 
boŞ
 
	$V®id©eRC6
()

1099 
cout
 << "\nRC6 validation suite„unning...\n\n";

1101 
FeSourû
 
	`v®d©a
("Te¡D©a/rc6v®.d©", 
Œue
, 
Ãw
 
HexDecod”
);

1102 
boŞ
 
·ss
 = 
Œue
;

1103 
·ss
 = 
	`BlockT¿nsfÜm©iÚTe¡
(
FixedRoundsCh”FaùÜy
<
RC6Enüy±iÚ
, 
RC6Deüy±iÚ
>(16), 
v®d©a
, 2) &&…ass;

1104 
·ss
 = 
	`BlockT¿nsfÜm©iÚTe¡
(
FixedRoundsCh”FaùÜy
<
RC6Enüy±iÚ
, 
RC6Deüy±iÚ
>(24), 
v®d©a
, 2) &&…ass;

1105 
·ss
 = 
	`BlockT¿nsfÜm©iÚTe¡
(
FixedRoundsCh”FaùÜy
<
RC6Enüy±iÚ
, 
RC6Deüy±iÚ
>(32), 
v®d©a
, 2) &&…ass;

1106  
·ss
;

1107 
	}
}

1109 
boŞ
 
	$V®id©eMARS
()

1111 
cout
 << "\nMARS validation suite„unning...\n\n";

1113 
FeSourû
 
	`v®d©a
("Te¡D©a/m¬sv®.d©", 
Œue
, 
Ãw
 
HexDecod”
);

1114 
boŞ
 
·ss
 = 
Œue
;

1115 
·ss
 = 
	`BlockT¿nsfÜm©iÚTe¡
(
FixedRoundsCh”FaùÜy
<
MARSEnüy±iÚ
, 
MARSDeüy±iÚ
>(16), 
v®d©a
, 4) &&…ass;

1116 
·ss
 = 
	`BlockT¿nsfÜm©iÚTe¡
(
FixedRoundsCh”FaùÜy
<
MARSEnüy±iÚ
, 
MARSDeüy±iÚ
>(24), 
v®d©a
, 3) &&…ass;

1117 
·ss
 = 
	`BlockT¿nsfÜm©iÚTe¡
(
FixedRoundsCh”FaùÜy
<
MARSEnüy±iÚ
, 
MARSDeüy±iÚ
>(32), 
v®d©a
, 2) &&…ass;

1118  
·ss
;

1119 
	}
}

1121 
boŞ
 
	$V®id©eRijnd«l
()

1123 
cout
 << "\nRijndael (AES) validation suite„unning...\n\n";

1125 
FeSourû
 
	`v®d©a
("Te¡D©a/rijnd«l.d©", 
Œue
, 
Ãw
 
HexDecod”
);

1126 
boŞ
 
·ss
 = 
Œue
;

1127 
·ss
 = 
	`BlockT¿nsfÜm©iÚTe¡
(
FixedRoundsCh”FaùÜy
<
Rijnd«lEnüy±iÚ
, 
Rijnd«lDeüy±iÚ
>(16), 
v®d©a
, 4) &&…ass;

1128 
·ss
 = 
	`BlockT¿nsfÜm©iÚTe¡
(
FixedRoundsCh”FaùÜy
<
Rijnd«lEnüy±iÚ
, 
Rijnd«lDeüy±iÚ
>(24), 
v®d©a
, 3) &&…ass;

1129 
·ss
 = 
	`BlockT¿nsfÜm©iÚTe¡
(
FixedRoundsCh”FaùÜy
<
Rijnd«lEnüy±iÚ
, 
Rijnd«lDeüy±iÚ
>(32), 
v®d©a
, 2) &&…ass;

1130 
·ss
 = 
	`RunTe¡D©aFe
("TestVectors/aes.txt") &&…ass;

1131  
·ss
;

1132 
	}
}

1134 
boŞ
 
	$V®id©eTwofish
()

1136 
cout
 << "\nTwofish validation suite„unning...\n\n";

1138 
FeSourû
 
	`v®d©a
("Te¡D©a/twofishv.d©", 
Œue
, 
Ãw
 
HexDecod”
);

1139 
boŞ
 
·ss
 = 
Œue
;

1140 
·ss
 = 
	`BlockT¿nsfÜm©iÚTe¡
(
FixedRoundsCh”FaùÜy
<
TwofishEnüy±iÚ
, 
TwofishDeüy±iÚ
>(16), 
v®d©a
, 4) &&…ass;

1141 
·ss
 = 
	`BlockT¿nsfÜm©iÚTe¡
(
FixedRoundsCh”FaùÜy
<
TwofishEnüy±iÚ
, 
TwofishDeüy±iÚ
>(24), 
v®d©a
, 3) &&…ass;

1142 
·ss
 = 
	`BlockT¿nsfÜm©iÚTe¡
(
FixedRoundsCh”FaùÜy
<
TwofishEnüy±iÚ
, 
TwofishDeüy±iÚ
>(32), 
v®d©a
, 2) &&…ass;

1143  
·ss
;

1144 
	}
}

1146 
boŞ
 
	$V®id©eS”³Á
()

1148 
cout
 << "\nSerpent validation suite„unning...\n\n";

1150 
FeSourû
 
	`v®d©a
("Te¡D©a/£½’tv.d©", 
Œue
, 
Ãw
 
HexDecod”
);

1151 
boŞ
 
·ss
 = 
Œue
;

1152 
·ss
 = 
	`BlockT¿nsfÜm©iÚTe¡
(
FixedRoundsCh”FaùÜy
<
S”³ÁEnüy±iÚ
, 
S”³ÁDeüy±iÚ
>(16), 
v®d©a
, 5) &&…ass;

1153 
·ss
 = 
	`BlockT¿nsfÜm©iÚTe¡
(
FixedRoundsCh”FaùÜy
<
S”³ÁEnüy±iÚ
, 
S”³ÁDeüy±iÚ
>(24), 
v®d©a
, 4) &&…ass;

1154 
·ss
 = 
	`BlockT¿nsfÜm©iÚTe¡
(
FixedRoundsCh”FaùÜy
<
S”³ÁEnüy±iÚ
, 
S”³ÁDeüy±iÚ
>(32), 
v®d©a
, 3) &&…ass;

1155  
·ss
;

1156 
	}
}

1158 
boŞ
 
	$V®id©eBlowfish
()

1160 
cout
 << "\nBlowfish validation suite„unning...\n\n";

1162 
HexEncod”
 
	`ouut
(
Ãw
 
	`FeSšk
(
cout
));

1163 cÚ¡ *
key
[]={"abcdefghijklmnopqrstuvwxyz", "Who is John Galt?"};

1164 
by‹
 *
¶aš
[]={(byte *)"BLOWFISH", (byte *)"\xfe\xdc\xba\x98\x76\x54\x32\x10"};

1165 
by‹
 *
ch”
[]={(byte *)"\x32\x4e\xd0\xfe\xf4\x13\xa2\x03", (byte *)"\xcc\x91\x73\x2b\x80\x22\xf6\x84"};

1166 
by‹
 
out
[8], 
ouÏš
[8];

1167 
boŞ
 
·ss
=
Œue
, 
ç
;

1169 
i
=0; i<2; i++)

1171 
ECB_Mode
<
Blowfish
>::
Enüy±iÚ
 
	`’c
((
by‹
 *)
key
[
i
], 
	`¡¾’
(key[i]));

1172 
’c
.
	`ProûssD©a
(
out
, 
¶aš
[
i
], 8);

1173 
ç
 = 
	`memcmp
(
out
, 
ch”
[
i
], 8) != 0;

1175 
ECB_Mode
<
Blowfish
>::
Deüy±iÚ
 
	`dec
((
by‹
 *)
key
[
i
], 
	`¡¾’
(key[i]));

1176 
dec
.
	`ProûssD©a
(
ouÏš
, 
ch”
[
i
], 8);

1177 
ç
 = fa || 
	`memcmp
(
ouÏš
, 
¶aš
[
i
], 8);

1178 
·ss
 =…as && !
ç
;

1180 
cout
 << (
ç
 ? "FAILED " : "passed ");

1181 
cout
 << '\"' << 
key
[
i
] << '\"';

1182 
j
=0; j<(sigÃd )(30-
	`¡¾’
(
key
[
i
])); j++)

1183 
cout
 << ' ';

1184 
ouut
.
	`Put
(
ouÏš
, 8);

1185 
cout
 << " ";

1186 
ouut
.
	`Put
(
out
, 8);

1187 
cout
 << 
’dl
;

1189  
·ss
;

1190 
	}
}

1192 
boŞ
 
	$V®id©eTh»eWay
()

1194 
cout
 << "\n3-WAY validation suite„unning...\n\n";

1196 
FeSourû
 
	`v®d©a
("Te¡D©a/3wayv®.d©", 
Œue
, 
Ãw
 
HexDecod”
);

1197  
	`BlockT¿nsfÜm©iÚTe¡
(
FixedRoundsCh”FaùÜy
<
Th»eWayEnüy±iÚ
, 
Th»eWayDeüy±iÚ
>(), 
v®d©a
);

1198 
	}
}

1200 
boŞ
 
	$V®id©eGOST
()

1202 
cout
 << "\nGOST validation suite„unning...\n\n";

1204 
FeSourû
 
	`v®d©a
("Te¡D©a/go¡v®.d©", 
Œue
, 
Ãw
 
HexDecod”
);

1205  
	`BlockT¿nsfÜm©iÚTe¡
(
FixedRoundsCh”FaùÜy
<
GOSTEnüy±iÚ
, 
GOSTDeüy±iÚ
>(), 
v®d©a
);

1206 
	}
}

1208 
boŞ
 
	$V®id©eSHARK
()

1210 
cout
 << "\nSHARK validation suite„unning...\n\n";

1212 
FeSourû
 
	`v®d©a
("Te¡D©a/sh¬kv®.d©", 
Œue
, 
Ãw
 
HexDecod”
);

1213  
	`BlockT¿nsfÜm©iÚTe¡
(
FixedRoundsCh”FaùÜy
<
SHARKEnüy±iÚ
, 
SHARKDeüy±iÚ
>(), 
v®d©a
);

1214 
	}
}

1216 
boŞ
 
	$V®id©eCAST
()

1218 
boŞ
 
·ss
 = 
Œue
;

1220 
cout
 << "\nCAST-128 validation suite„unning...\n\n";

1222 
FeSourû
 
	`v®128
("Te¡D©a/ÿ¡128v.d©", 
Œue
, 
Ãw
 
HexDecod”
);

1223 
·ss
 = 
	`BlockT¿nsfÜm©iÚTe¡
(
FixedRoundsCh”FaùÜy
<
CAST128Enüy±iÚ
, 
CAST128Deüy±iÚ
>(16), 
v®128
, 1) &&…ass;

1224 
·ss
 = 
	`BlockT¿nsfÜm©iÚTe¡
(
FixedRoundsCh”FaùÜy
<
CAST128Enüy±iÚ
, 
CAST128Deüy±iÚ
>(10), 
v®128
, 1) &&…ass;

1225 
·ss
 = 
	`BlockT¿nsfÜm©iÚTe¡
(
FixedRoundsCh”FaùÜy
<
CAST128Enüy±iÚ
, 
CAST128Deüy±iÚ
>(5), 
v®128
, 1) &&…ass;

1227 
cout
 << "\nCAST-256 validation suite„unning...\n\n";

1229 
FeSourû
 
	`v®256
("Te¡D©a/ÿ¡256v.d©", 
Œue
, 
Ãw
 
HexDecod”
);

1230 
·ss
 = 
	`BlockT¿nsfÜm©iÚTe¡
(
FixedRoundsCh”FaùÜy
<
CAST256Enüy±iÚ
, 
CAST256Deüy±iÚ
>(16), 
v®256
, 1) &&…ass;

1231 
·ss
 = 
	`BlockT¿nsfÜm©iÚTe¡
(
FixedRoundsCh”FaùÜy
<
CAST256Enüy±iÚ
, 
CAST256Deüy±iÚ
>(24), 
v®256
, 1) &&…ass;

1232 
·ss
 = 
	`BlockT¿nsfÜm©iÚTe¡
(
FixedRoundsCh”FaùÜy
<
CAST256Enüy±iÚ
, 
CAST256Deüy±iÚ
>(32), 
v®256
, 1) &&…ass;

1234  
·ss
;

1235 
	}
}

1237 
boŞ
 
	$V®id©eSqu¬e
()

1239 
cout
 << "\nSquare validation suite„unning...\n\n";

1241 
FeSourû
 
	`v®d©a
("Te¡D©a/squ¬eva.d©", 
Œue
, 
Ãw
 
HexDecod”
);

1242  
	`BlockT¿nsfÜm©iÚTe¡
(
FixedRoundsCh”FaùÜy
<
Squ¬eEnüy±iÚ
, 
Squ¬eDeüy±iÚ
>(), 
v®d©a
);

1243 
	}
}

1245 
boŞ
 
	$V®id©eSKIPJACK
()

1247 
cout
 << "\nSKIPJACK validation suite„unning...\n\n";

1249 
FeSourû
 
	`v®d©a
("Te¡D©a/skjack.d©", 
Œue
, 
Ãw
 
HexDecod”
);

1250  
	`BlockT¿nsfÜm©iÚTe¡
(
FixedRoundsCh”FaùÜy
<
SKIPJACKEnüy±iÚ
, 
SKIPJACKDeüy±iÚ
>(), 
v®d©a
);

1251 
	}
}

1253 
boŞ
 
	$V®id©eSEAL
()

1255 
by‹
 
šput
[] = {0x37,0xa0,0x05,0x95,0x9b,0x84,0xc4,0x9c,0xa4,0xbe,0x1e,0x05,0x06,0x73,0x53,0x0f,0x5f,0xb0,0x97,0xfd,0xf6,0xa1,0x3f,0xbd,0x6c,0x2c,0xde,0xcd,0x81,0xfd,0xee,0x7c};

1256 
by‹
 
ouut
[32];

1257 
by‹
 
key
[] = {0x67, 0x45, 0x23, 0x01, 0xef, 0xcd, 0xab, 0x89, 0x98, 0xba, 0xdc, 0xfe, 0x10, 0x32, 0x54, 0x76, 0xc3, 0xd2, 0xe1, 0xf0};

1258 
by‹
 
iv
[] = {0x01, 0x35, 0x77, 0xaf};

1260 
cout
 << "\nSEAL validation suite„unning...\n\n";

1262 
SEAL
<>::
Enüy±iÚ
 
	`£®
(
key
, (key), 
iv
);

1263 
size
 = (
šput
);

1264 
boŞ
 
·ss
 = 
Œue
;

1266 
	`mem£t
(
ouut
, 1, 
size
);

1267 
£®
.
	`ProûssSŒšg
(
ouut
, 
šput
, 
size
);

1268 
i
=0; i<
size
; i++)

1269 ià(
ouut
[
i
] != 0)

1270 
·ss
 = 
çl£
;

1272 
£®
.
	`S“k
(1);

1273 
ouut
[1] = 
£®
.
	`ProûssBy‹
(output[1]);

1274 
£®
.
	`ProûssSŒšg
(
ouut
+2, 
size
-2);

1275 
·ss
 =…as && 
	`memcmp
(
ouut
+1, 
šput
+1, 
size
-1) == 0;

1277 
cout
 << (
·ss
 ? "·s£d" : "FAILED"è<< 
’dl
;

1278  
·ss
;

1279 
	}
}

1281 
boŞ
 
	$V®id©eBa£Code
()

1283 
boŞ
 
·ss
 = 
Œue
, 
ç
;

1284 
by‹
 
d©a
[255];

1285 
i
=0; i<255; i++)

1286 
d©a
[
i
] = i;

1287 cÚ¡ *
hexEncoded
 =

1295 cÚ¡ *
ba£32Encoded
 =

1302 cÚ¡ *
ba£64AndHexEncoded
 =

1313 
cout
 << "\nBase64, base32‡nd hex coding validation suite„unning...\n\n";

1315 
ç
 = !
	`Te¡F‹r
(
	`HexEncod”
().
	`Ref
(), 
d©a
, 255, (cÚ¡ 
by‹
 *)
hexEncoded
, 
	`¡¾’
(hexEncoded));

1316 
cout
 << (
ç
 ? "FAILED " : "passed ");

1317 
cout
 << "Hex Encoding\n";

1318 
·ss
 =…as && !
ç
;

1320 
ç
 = !
	`Te¡F‹r
(
	`HexDecod”
().
	`Ref
(), (cÚ¡ 
by‹
 *)
hexEncoded
, 
	`¡¾’
(hexEncoded), 
d©a
, 255);

1321 
cout
 << (
ç
 ? "FAILED " : "passed ");

1322 
cout
 << "Hex Decoding\n";

1323 
·ss
 =…as && !
ç
;

1325 
ç
 = !
	`Te¡F‹r
(
	`Ba£32Encod”
().
	`Ref
(), 
d©a
, 255, (cÚ¡ 
by‹
 *)
ba£32Encoded
, 
	`¡¾’
(base32Encoded));

1326 
cout
 << (
ç
 ? "FAILED " : "passed ");

1327 
cout
 << "Base32 Encoding\n";

1328 
·ss
 =…as && !
ç
;

1330 
ç
 = !
	`Te¡F‹r
(
	`Ba£32Decod”
().
	`Ref
(), (cÚ¡ 
by‹
 *)
ba£32Encoded
, 
	`¡¾’
(ba£32Encoded), 
d©a
, 255);

1331 
cout
 << (
ç
 ? "FAILED " : "passed ");

1332 
cout
 << "Base32 Decoding\n";

1333 
·ss
 =…as && !
ç
;

1335 
ç
 = !
	`Te¡F‹r
(
	`Ba£64Encod”
(
Ãw
 
HexEncod”
).
	`Ref
(), 
d©a
, 255, (cÚ¡ 
by‹
 *)
ba£64AndHexEncoded
, 
	`¡¾’
(base64AndHexEncoded));

1336 
cout
 << (
ç
 ? "FAILED " : "passed ");

1337 
cout
 << "Base64 Encoding\n";

1338 
·ss
 =…as && !
ç
;

1340 
ç
 = !
	`Te¡F‹r
(
	`HexDecod”
(
Ãw
 
Ba£64Decod”
).
	`Ref
(), (cÚ¡ 
by‹
 *)
ba£64AndHexEncoded
, 
	`¡¾’
(ba£64AndHexEncoded), 
d©a
, 255);

1341 
cout
 << (
ç
 ? "FAILED " : "passed ");

1342 
cout
 << "Base64 Decoding\n";

1343 
·ss
 =…as && !
ç
;

1345  
·ss
;

1346 
	}
}

1348 
boŞ
 
	$V®id©eSHACAL2
()

1350 
cout
 << "\nSHACAL-2 validation suite„unning...\n\n";

1352 
boŞ
 
·ss
 = 
Œue
;

1353 
FeSourû
 
	`v®d©a
("Te¡D©a/shaÿl2v.d©", 
Œue
, 
Ãw
 
HexDecod”
);

1354 
·ss
 = 
	`BlockT¿nsfÜm©iÚTe¡
(
FixedRoundsCh”FaùÜy
<
SHACAL2Enüy±iÚ
, 
SHACAL2Deüy±iÚ
>(16), 
v®d©a
, 4) &&…ass;

1355 
·ss
 = 
	`BlockT¿nsfÜm©iÚTe¡
(
FixedRoundsCh”FaùÜy
<
SHACAL2Enüy±iÚ
, 
SHACAL2Deüy±iÚ
>(64), 
v®d©a
, 10) &&…ass;

1356  
·ss
;

1357 
	}
}

1359 
boŞ
 
	$V®id©eCam–lŸ
()

1361 
cout
 << "\nCamellia validation suite„unning...\n\n";

1363 
boŞ
 
·ss
 = 
Œue
;

1364 
FeSourû
 
	`v®d©a
("Te¡D©a/ÿm–lŸ.d©", 
Œue
, 
Ãw
 
HexDecod”
);

1365 
·ss
 = 
	`BlockT¿nsfÜm©iÚTe¡
(
FixedRoundsCh”FaùÜy
<
Cam–lŸEnüy±iÚ
, 
Cam–lŸDeüy±iÚ
>(16), 
v®d©a
, 15) &&…ass;

1366 
·ss
 = 
	`BlockT¿nsfÜm©iÚTe¡
(
FixedRoundsCh”FaùÜy
<
Cam–lŸEnüy±iÚ
, 
Cam–lŸDeüy±iÚ
>(24), 
v®d©a
, 15) &&…ass;

1367 
·ss
 = 
	`BlockT¿nsfÜm©iÚTe¡
(
FixedRoundsCh”FaùÜy
<
Cam–lŸEnüy±iÚ
, 
Cam–lŸDeüy±iÚ
>(32), 
v®d©a
, 15) &&…ass;

1368  
·ss
;

1369 
	}
}

1371 
boŞ
 
	$V®id©eS®§
()

1373 
cout
 << "\nSalsa validation suite„unning...\n";

1375  
	`RunTe¡D©aFe
("TestVectors/salsa.txt");

1376 
	}
}

1378 
boŞ
 
	$V®id©eSo£mªuk
()

1380 
cout
 << "\nSosemanuk validation suite„unning...\n";

1381  
	`RunTe¡D©aFe
("TestVectors/sosemanuk.txt");

1382 
	}
}

1384 
boŞ
 
	$V®id©eVMAC
()

1386 
cout
 << "\nVMAC validation suite„unning...\n";

1387  
	`RunTe¡D©aFe
("TestVectors/vmac.txt");

1388 
	}
}

1390 
boŞ
 
	$V®id©eCCM
()

1392 
cout
 << "\nAES/CCM validation suite„unning...\n";

1393  
	`RunTe¡D©aFe
("TestVectors/ccm.txt");

1394 
	}
}

1396 
boŞ
 
	$V®id©eGCM
()

1398 
cout
 << "\nAES/GCM validation suite„unning...\n";

1399 
cout
 << "\n2Kables:";

1400 
boŞ
 
·ss
 = 
	`RunTe¡D©aFe
("Te¡VeùÜs/gcm.txt", 
	`MakeP¬am‘”s
(
Name
::
	`TabËSize
(), ()2048));

1401 
cout
 << "\n64Kables:";

1402  
	`RunTe¡D©aFe
("Te¡VeùÜs/gcm.txt", 
	`MakeP¬am‘”s
(
Name
::
	`TabËSize
(), ()64*1024)è&& 
·ss
;

1403 
	}
}

1405 
boŞ
 
	$V®id©eCMAC
()

1407 
cout
 << "\nCMAC validation suite„unning...\n";

1408  
	`RunTe¡D©aFe
("TestVectors/cmac.txt");

1409 
	}
}

	@validat2.cpp

3 
	~"pch.h
"

5 
	#CRYPTOPP_ENABLE_NAMESPACE_WEAK
 1

	)

6 
	~"blumshub.h
"

7 
	~"r§.h
"

8 
	~"md2.h
"

9 
	~"–gam®.h
"

10 
	~"Ä.h
"

11 
	~"d§.h
"

12 
	~"dh.h
"

13 
	~"mqv.h
"

14 
	~"luc.h
"

15 
	~"xŒüy±.h
"

16 
	~"¿bš.h
"

17 
	~"rw.h
"

18 
	~"ecüy±o.h
"

19 
	~"eı.h
"

20 
	~"ec2n.h
"

21 
	~"a¢.h
"

22 
	~"ºg.h
"

23 
	~"fes.h
"

24 
	~"hex.h
"

25 
	~"oids.h
"

26 
	~"esign.h
"

27 
	~"o¤ng.h
"

29 
	~<io¡»am
>

30 
	~<iomª
>

32 
	~"v®id©e.h
"

34 
	$USING_NAMESPACE
(
Cry±oPP
)

35 
	$USING_NAMESPACE
(
¡d
)

37 şas 
	cFixedRNG
 : 
public
 
RªdomNumb”G’”©Ü


39 
public
:

40 
	$FixedRNG
(
Bufã»dT¿nsfÜm©iÚ
 &
sourû
è: 
	$m_sourû
(
sourû
) {}

42 
	$G’”©eBlock
(
by‹
 *
ouut
, 
size_t
 
size
)

44 
m_sourû
.
	`G‘
(
ouut
, 
size
);

45 
	}
}

47 
	g´iv©e
:

48 
Bufã»dT¿nsfÜm©iÚ
 &
m_sourû
;

51 
boŞ
 
	$V®id©eBBS
()

53 
cout
 << "\nBlumBlumShub validation suite„unning...\n\n";

55 
IÁeg”
 
	`p
("212004934506826557583707108431463840565872545889679278744389317666981496005411448865750399674653351");

56 
IÁeg”
 
	`q
("100677295735404212434355574418077394581488455772477016953458064183204108039226017738610663984508231");

57 
IÁeg”
 
	`£ed
("63239752671357255800299643604761065219897634268887145610573595874544114193025997412441121667211431");

58 
BlumBlumShub
 
	`bbs
(
p
, 
q
, 
£ed
);

59 
boŞ
 
·ss
 = 
Œue
, 
ç
;

60 
j
;

62 cÚ¡ 
by‹
 
ouut1
[] = {

65 cÚ¡ 
by‹
 
ouut2
[] = {

69 
by‹
 
buf
[20];

71 
bbs
.
	`G’”©eBlock
(
buf
, 20);

72 
ç
 = 
	`memcmp
(
ouut1
, 
buf
, 20) != 0;

73 
·ss
 =…as && !
ç
;

75 
cout
 << (
ç
 ? "FAILED " : "passed ");

76 
j
=0;j<20;j++)

77 
cout
 << 
	`£tw
(2è<< 
	`£tfl
('0'è<< 
hex
 << ()
buf
[
j
];

78 
cout
 << 
’dl
;

80 
bbs
.
	`S“k
(10);

81 
bbs
.
	`G’”©eBlock
(
buf
, 10);

82 
ç
 = 
	`memcmp
(
ouut1
+10, 
buf
, 10) != 0;

83 
·ss
 =…as && !
ç
;

85 
cout
 << (
ç
 ? "FAILED " : "passed ");

86 
j
=0;j<10;j++)

87 
cout
 << 
	`£tw
(2è<< 
	`£tfl
('0'è<< 
hex
 << ()
buf
[
j
];

88 
cout
 << 
’dl
;

90 
bbs
.
	`S“k
(1234567);

91 
bbs
.
	`G’”©eBlock
(
buf
, 20);

92 
ç
 = 
	`memcmp
(
ouut2
, 
buf
, 20) != 0;

93 
·ss
 =…as && !
ç
;

95 
cout
 << (
ç
 ? "FAILED " : "passed ");

96 
j
=0;j<20;j++)

97 
cout
 << 
	`£tw
(2è<< 
	`£tfl
('0'è<< 
hex
 << ()
buf
[
j
];

98 
cout
 << 
’dl
;

100  
·ss
;

101 
	}
}

103 
boŞ
 
	$SigÇtu»V®id©e
(
PK_SigÃr
 &
´iv
, 
PK_V”if›r
 &
pub
, 
boŞ
 
thÜough
 = 
çl£
)

105 
boŞ
 
·ss
 = 
Œue
, 
ç
;

107 
ç
 = !
pub
.
	`G‘M©”Ÿl
().
	`V®id©e
(
	`Glob®RNG
(), 
thÜough
 ? 3 : 2è|| !
´iv
.GetMaterial().Validate(GlobalRNG(),horough ? 3 : 2);

108 
·ss
 =…as && !
ç
;

110 
cout
 << (
ç
 ? "FAILED " : "passed ");

111 
cout
 << "signature key validation\n";

113 cÚ¡ 
by‹
 *
mes§ge
 = (byte *)"test message";

114 cÚ¡ 
mes§geL’
 = 12;

116 
SecBy‹Block
 
	`sigÇtu»
(
´iv
.
	`MaxSigÇtu»L’gth
());

117 
size_t
 
sigÇtu»L’gth
 = 
´iv
.
	`SignMes§ge
(
	`Glob®RNG
(), 
mes§ge
, 
mes§geL’
, 
sigÇtu»
);

118 
ç
 = !
pub
.
	`V”ifyMes§ge
(
mes§ge
, 
mes§geL’
, 
sigÇtu»
, 
sigÇtu»L’gth
);

119 
·ss
 =…as && !
ç
;

121 
cout
 << (
ç
 ? "FAILED " : "passed ");

122 
cout
 << "signature‡nd verification\n";

124 ++
sigÇtu»
[0];

125 
ç
 = 
pub
.
	`V”ifyMes§ge
(
mes§ge
, 
mes§geL’
, 
sigÇtu»
, 
sigÇtu»L’gth
);

126 
·ss
 =…as && !
ç
;

128 
cout
 << (
ç
 ? "FAILED " : "passed ");

129 
cout
 << "checkšg inv®id sigÇtu»" << 
’dl
;

131 ià(
´iv
.
	`MaxRecov”abËL’gth
() > 0)

133 
sigÇtu»L’gth
 = 
´iv
.
	`SignMes§geW™hRecov”y
(
	`Glob®RNG
(), 
mes§ge
, 
mes§geL’
, 
NULL
, 0, 
sigÇtu»
);

134 
SecBy‹Block
 
	`»cov”ed
(
´iv
.
	`MaxRecov”abËL’gthFromSigÇtu»L’gth
(
sigÇtu»L’gth
));

135 
DecodšgResuÉ
 
»suÉ
 = 
pub
.
	`Recov”Mes§ge
(
»cov”ed
, 
NULL
, 0, 
sigÇtu»
, 
sigÇtu»L’gth
);

136 
ç
 = !(
»suÉ
.
isV®idCodšg
 &&„esuÉ.
mes§geL’gth
 =ğ
mes§geL’
 && 
	`memcmp
(
»cov”ed
, 
mes§ge
, messageLen) == 0);

137 
·ss
 =…as && !
ç
;

139 
cout
 << (
ç
 ? "FAILED " : "passed ");

140 
cout
 << "sigÇtu»‡nd v”ifiÿtiÚ w™h„ecov”y" << 
’dl
;

142 ++
sigÇtu»
[0];

143 
»suÉ
 = 
pub
.
	`Recov”Mes§ge
(
»cov”ed
, 
NULL
, 0, 
sigÇtu»
, 
sigÇtu»L’gth
);

144 
ç
 = 
»suÉ
.
isV®idCodšg
;

145 
·ss
 =…as && !
ç
;

147 
cout
 << (
ç
 ? "FAILED " : "passed ");

148 
cout
 << "»cov”y w™h inv®id sigÇtu»" << 
’dl
;

151  
·ss
;

152 
	}
}

154 
boŞ
 
	$Cry±oSy¡emV®id©e
(
PK_Deüy±Ü
 &
´iv
, 
PK_Enüy±Ü
 &
pub
, 
boŞ
 
thÜough
 = 
çl£
)

156 
boŞ
 
·ss
 = 
Œue
, 
ç
;

158 
ç
 = !
pub
.
	`G‘M©”Ÿl
().
	`V®id©e
(
	`Glob®RNG
(), 
thÜough
 ? 3 : 2è|| !
´iv
.GetMaterial().Validate(GlobalRNG(),horough ? 3 : 2);

159 
·ss
 =…as && !
ç
;

161 
cout
 << (
ç
 ? "FAILED " : "passed ");

162 
cout
 << "cryptosystem key validation\n";

164 cÚ¡ 
by‹
 *
mes§ge
 = (byte *)"test message";

165 cÚ¡ 
mes§geL’
 = 12;

166 
SecBy‹Block
 
	`ch”‹xt
(
´iv
.
	`Ch”‹xtL’gth
(
mes§geL’
));

167 
SecBy‹Block
 
	`¶aš‹xt
(
´iv
.
	`MaxPÏš‹xtL’gth
(
ch”‹xt
.
	`size
()));

169 
pub
.
	`Enüy±
(
	`Glob®RNG
(), 
mes§ge
, 
mes§geL’
, 
ch”‹xt
);

170 
ç
 = 
´iv
.
	`Deüy±
(
	`Glob®RNG
(), 
ch”‹xt
,…riv.
	`Ch”‹xtL’gth
(
mes§geL’
), 
¶aš‹xt
è!ğ
	`DecodšgResuÉ
(messageLen);

171 
ç
 = fa || 
	`memcmp
(
mes§ge
, 
¶aš‹xt
, 
mes§geL’
);

172 
·ss
 =…as && !
ç
;

174 
cout
 << (
ç
 ? "FAILED " : "passed ");

175 
cout
 << "encryption‡nd decryption\n";

177  
·ss
;

178 
	}
}

180 
boŞ
 
	$Sim¶eKeyAg»em’tV®id©e
(
Sim¶eKeyAg»em’tDomaš
 &
d
)

182 ià(
d
.
	`G‘Cry±oP¬am‘”s
().
	`V®id©e
(
	`Glob®RNG
(), 3))

183 
cout
 << "·s£d sim¶key‡g»em’ˆdomaš…¬am‘” v®id©iÚ" << 
’dl
;

186 
cout
 << "FAILED sim¶key‡g»em’ˆdomaš…¬am‘” šv®id" << 
’dl
;

187  
çl£
;

190 
SecBy‹Block
 
	`´iv1
(
d
.
	`Priv©eKeyL’gth
()), 
	`´iv2
(d.PrivateKeyLength());

191 
SecBy‹Block
 
	`pub1
(
d
.
	`PublicKeyL’gth
()), 
	`pub2
(d.PublicKeyLength());

192 
SecBy‹Block
 
	`v®1
(
d
.
	`Ag»edV®ueL’gth
()), 
	`v®2
(d.AgreedValueLength());

194 
d
.
	`G’”©eKeyPaœ
(
	`Glob®RNG
(), 
´iv1
, 
pub1
);

195 
d
.
	`G’”©eKeyPaœ
(
	`Glob®RNG
(), 
´iv2
, 
pub2
);

197 
	`mem£t
(
v®1
.
	`begš
(), 0x10, v®1.
	`size
());

198 
	`mem£t
(
v®2
.
	`begš
(), 0x11, v®2.
	`size
());

200 ià(!(
d
.
	`Ag»e
(
v®1
, 
´iv1
, 
pub2
è&& d.Ag»e(
v®2
, 
´iv2
, 
pub1
)))

202 
cout
 << "FAILED sim¶key‡g»em’ˆçed" << 
’dl
;

203  
çl£
;

206 ià(
	`memcmp
(
v®1
.
	`begš
(), 
v®2
.begš(), 
d
.
	`Ag»edV®ueL’gth
()))

208 
cout
 << "FAILED sim¶ag»ed v®ue nÙƒqu®" << 
’dl
;

209  
çl£
;

212 
cout
 << "·s£d sim¶key‡g»em’t" << 
’dl
;

213  
Œue
;

214 
	}
}

216 
boŞ
 
	$Auth’tiÿ‹dKeyAg»em’tV®id©e
(
Auth’tiÿ‹dKeyAg»em’tDomaš
 &
d
)

218 ià(
d
.
	`G‘Cry±oP¬am‘”s
().
	`V®id©e
(
	`Glob®RNG
(), 3))

219 
cout
 << "·s£d‡uth’tiÿ‹d key‡g»em’ˆdomaš…¬am‘” v®id©iÚ" << 
’dl
;

222 
cout
 << "FAILED‡uth’tiÿ‹d key‡g»em’ˆdomaš…¬am‘” šv®id" << 
’dl
;

223  
çl£
;

226 
SecBy‹Block
 
	`¥riv1
(
d
.
	`SticPriv©eKeyL’gth
()), 
	`¥riv2
(d.StaticPrivateKeyLength());

227 
SecBy‹Block
 
	`•riv1
(
d
.
	`Ephem”®Priv©eKeyL’gth
()), 
	`•riv2
(d.EphemeralPrivateKeyLength());

228 
SecBy‹Block
 
	`¥ub1
(
d
.
	`SticPublicKeyL’gth
()), 
	`¥ub2
(d.StaticPublicKeyLength());

229 
SecBy‹Block
 
	`•ub1
(
d
.
	`Ephem”®PublicKeyL’gth
()), 
	`•ub2
(d.EphemeralPublicKeyLength());

230 
SecBy‹Block
 
	`v®1
(
d
.
	`Ag»edV®ueL’gth
()), 
	`v®2
(d.AgreedValueLength());

232 
d
.
	`G’”©eSticKeyPaœ
(
	`Glob®RNG
(), 
¥riv1
, 
¥ub1
);

233 
d
.
	`G’”©eSticKeyPaœ
(
	`Glob®RNG
(), 
¥riv2
, 
¥ub2
);

234 
d
.
	`G’”©eEphem”®KeyPaœ
(
	`Glob®RNG
(), 
•riv1
, 
•ub1
);

235 
d
.
	`G’”©eEphem”®KeyPaœ
(
	`Glob®RNG
(), 
•riv2
, 
•ub2
);

237 
	`mem£t
(
v®1
.
	`begš
(), 0x10, v®1.
	`size
());

238 
	`mem£t
(
v®2
.
	`begš
(), 0x11, v®2.
	`size
());

240 ià(!(
d
.
	`Ag»e
(
v®1
, 
¥riv1
, 
•riv1
, 
¥ub2
, 
•ub2
è&& d.Ag»e(
v®2
, 
¥riv2
, 
•riv2
, 
¥ub1
, 
•ub1
)))

242 
cout
 << "FAILED‡uth’tiÿ‹d key‡g»em’ˆçed" << 
’dl
;

243  
çl£
;

246 ià(
	`memcmp
(
v®1
.
	`begš
(), 
v®2
.begš(), 
d
.
	`Ag»edV®ueL’gth
()))

248 
cout
 << "FAILED‡uth’tiÿ‹d‡g»ed v®ue nÙƒqu®" << 
’dl
;

249  
çl£
;

252 
cout
 << "·s£d‡uth’tiÿ‹d key‡g»em’t" << 
’dl
;

253  
Œue
;

254 
	}
}

256 
boŞ
 
	$V®id©eRSA
()

258 
cout
 << "\nRSA validation suite„unning...\n\n";

260 
by‹
 
out
[100], 
outPÏš
[100];

261 
boŞ
 
·ss
 = 
Œue
, 
ç
;

264 cÚ¡ *
¶aš
 = "Everyone gets Friday off.";

265 
by‹
 *
sigÇtu»
 = (byte *)

271 
FeSourû
 
	`keys
("Te¡D©a/r§512a.d©", 
Œue
, 
Ãw
 
HexDecod”
);

272 
W—k
::
RSASSA_PKCS1v15_MD2_SigÃr
 
	`r§Priv
(
keys
);

273 
W—k
::
RSASSA_PKCS1v15_MD2_V”if›r
 
	`r§Pub
(
r§Priv
);

275 
size_t
 
sigÇtu»L’gth
 = 
r§Priv
.
	`SignMes§ge
(
	`Glob®RNG
(), (
by‹
 *)
¶aš
, 
	`¡¾’
ÕÏš), 
out
);

276 
ç
 = 
	`memcmp
(
sigÇtu»
, 
out
, 64) != 0;

277 
·ss
 =…as && !
ç
;

279 
cout
 << (
ç
 ? "FAILED " : "passed ");

280 
cout
 << "signature check‡gainstest vector\n";

282 
ç
 = !
r§Pub
.
	`V”ifyMes§ge
((
by‹
 *)
¶aš
, 
	`¡¾’
ÕÏš), 
out
, 
sigÇtu»L’gth
);

283 
·ss
 =…as && !
ç
;

285 
cout
 << (
ç
 ? "FAILED " : "passed ");

286 
cout
 << "verification check‡gainstest vector\n";

288 
out
[10]++;

289 
ç
 = 
r§Pub
.
	`V”ifyMes§ge
((
by‹
 *)
¶aš
, 
	`¡¾’
ÕÏš), 
out
, 
sigÇtu»L’gth
);

290 
·ss
 =…as && !
ç
;

292 
cout
 << (
ç
 ? "FAILED " : "passed ");

293 
cout
 << "invalid signature verification\n";

296 
FeSourû
 
	`keys
("Te¡D©a/r§1024.d©", 
Œue
, 
Ãw
 
HexDecod”
);

297 
RSAES_PKCS1v15_Deüy±Ü
 
	`r§Priv
(
keys
);

298 
RSAES_PKCS1v15_Enüy±Ü
 
	`r§Pub
(
r§Priv
);

300 
·ss
 = 
	`Cry±oSy¡emV®id©e
(
r§Priv
, 
r§Pub
) &&…ass;

303 
RSAES
<
OAEP
<
SHA
> >::
Deüy±Ü
 
	`r§Priv
(
	`Glob®RNG
(), 512);

304 
RSAES
<
OAEP
<
SHA
> >::
Enüy±Ü
 
	`r§Pub
(
r§Priv
);

306 
·ss
 = 
	`Cry±oSy¡emV®id©e
(
r§Priv
, 
r§Pub
) &&…ass;

309 
by‹
 *
¶aš
 = (byte *)

311 
by‹
 *
’üy±ed
 = (byte *)

316 
by‹
 *
ß•S“d
 = (byte *)

319 
By‹Queue
 
bq
;

320 
bq
.
	`Put
(
ß•S“d
, 20);

321 
FixedRNG
 
	`ºg
(
bq
);

323 
FeSourû
 
	`´ivFe
("Te¡D©a/r§400pv.d©", 
Œue
, 
Ãw
 
HexDecod”
);

324 
FeSourû
 
	`pubFe
("Te¡D©a/r§400pb.d©", 
Œue
, 
Ãw
 
HexDecod”
);

325 
RSAES_OAEP_SHA_Deüy±Ü
 
r§Priv
;

326 
r§Priv
.
	`AcûssKey
().
	`BERDecodePriv©eKey
(
´ivFe
, 
çl£
, 0);

327 
RSAES_OAEP_SHA_Enüy±Ü
 
	`r§Pub
(
pubFe
);

329 
	`mem£t
(
out
, 0, 50);

330 
	`mem£t
(
outPÏš
, 0, 8);

331 
r§Pub
.
	`Enüy±
(
ºg
, 
¶aš
, 8, 
out
);

332 
DecodšgResuÉ
 
»suÉ
 = 
r§Priv
.
	`FixedL’gthDeüy±
(
	`Glob®RNG
(), 
’üy±ed
, 
outPÏš
);

333 
ç
 = !
»suÉ
.
isV®idCodšg
 || (»suÉ.
mes§geL’gth
!=8è|| 
	`memcmp
(
out
, 
’üy±ed
, 50è|| memcmp(
¶aš
, 
outPÏš
, 8);

334 
·ss
 =…as && !
ç
;

336 
cout
 << (
ç
 ? "FAILED " : "passed ");

337 
cout
 << "PKCS 2.0ƒncryption‡nd decryption\n";

340  
·ss
;

341 
	}
}

343 
boŞ
 
	$V®id©eDH
()

345 
cout
 << "\nDH validation suite„unning...\n\n";

347 
FeSourû
 
	`f
("Te¡D©a/dh1024.d©", 
Œue
, 
Ãw
 
	`HexDecod”
());

348 
DH
 
	`dh
(
f
);

349  
	`Sim¶eKeyAg»em’tV®id©e
(
dh
);

350 
	}
}

352 
boŞ
 
	$V®id©eMQV
()

354 
cout
 << "\nMQV validation suite„unning...\n\n";

356 
FeSourû
 
	`f
("Te¡D©a/mqv1024.d©", 
Œue
, 
Ãw
 
	`HexDecod”
());

357 
MQV
 
	`mqv
(
f
);

358  
	`Auth’tiÿ‹dKeyAg»em’tV®id©e
(
mqv
);

359 
	}
}

361 
boŞ
 
	$V®id©eLUC_DH
()

363 
cout
 << "\nLUC-DH validation suite„unning...\n\n";

365 
FeSourû
 
	`f
("Te¡D©a/lucd512.d©", 
Œue
, 
Ãw
 
	`HexDecod”
());

366 
LUC_DH
 
	`dh
(
f
);

367  
	`Sim¶eKeyAg»em’tV®id©e
(
dh
);

368 
	}
}

370 
boŞ
 
	$V®id©eXTR_DH
()

372 
cout
 << "\nXTR-DH validation suite„unning...\n\n";

374 
FeSourû
 
	`f
("Te¡D©a/xŒdh171.d©", 
Œue
, 
Ãw
 
	`HexDecod”
());

375 
XTR_DH
 
	`dh
(
f
);

376  
	`Sim¶eKeyAg»em’tV®id©e
(
dh
);

377 
	}
}

379 
boŞ
 
	$V®id©eElGam®
()

381 
cout
 << "\nElGamal validation suite„unning...\n\n";

382 
boŞ
 
·ss
 = 
Œue
;

384 
FeSourû
 
	`fc
("Te¡D©a/–gc1024.d©", 
Œue
, 
Ãw
 
HexDecod”
);

385 
ElGam®Deüy±Ü
 
	`´ivC
(
fc
);

386 
ElGam®Enüy±Ü
 
	`pubC
(
´ivC
);

387 
´ivC
.
	`AcûssKey
().
	`P»compu‹
();

388 
By‹Queue
 
queue
;

389 
´ivC
.
	`AcûssKey
().
	`SaveP»computiÚ
(
queue
);

390 
´ivC
.
	`AcûssKey
().
	`LßdP»computiÚ
(
queue
);

392 
·ss
 = 
	`Cry±oSy¡emV®id©e
(
´ivC
, 
pubC
) &&…ass;

394  
·ss
;

395 
	}
}

397 
boŞ
 
	$V®id©eDLIES
()

399 
cout
 << "\nDLIES validation suite„unning...\n\n";

400 
boŞ
 
·ss
 = 
Œue
;

402 
FeSourû
 
	`fc
("Te¡D©a/dl›1024.d©", 
Œue
, 
Ãw
 
HexDecod”
);

403 
DLIES
<>::
Deüy±Ü
 
	`´ivC
(
fc
);

404 
DLIES
<>::
Enüy±Ü
 
	`pubC
(
´ivC
);

405 
·ss
 = 
	`Cry±oSy¡emV®id©e
(
´ivC
, 
pubC
) &&…ass;

408 
cout
 << "G’”©šg‚ewƒnüy±iÚ key..." << 
’dl
;

409 
DLIES
<>::
GroupP¬am‘”s
 
gp
;

410 
gp
.
	`G’”©eRªdomW™hKeySize
(
	`Glob®RNG
(), 128);

411 
DLIES
<>::
Deüy±Ü
 
deüy±Ü
;

412 
deüy±Ü
.
	`AcûssKey
().
	`G’”©eRªdom
(
	`Glob®RNG
(), 
gp
);

413 
DLIES
<>::
Enüy±Ü
 
	`’üy±Ü
(
deüy±Ü
);

415 
·ss
 = 
	`Cry±oSy¡emV®id©e
(
deüy±Ü
, 
’üy±Ü
) &&…ass;

417  
·ss
;

418 
	}
}

420 
boŞ
 
	$V®id©eNR
()

422 
cout
 << "\nNR validation suite„unning...\n\n";

423 
boŞ
 
·ss
 = 
Œue
;

425 
FeSourû
 
	`f
("Te¡D©a/Ä2048.d©", 
Œue
, 
Ãw
 
HexDecod”
);

426 
NR
<
SHA
>::
SigÃr
 
	`´ivS
(
f
);

427 
´ivS
.
	`AcûssKey
().
	`P»compu‹
();

428 
NR
<
SHA
>::
V”if›r
 
	`pubS
(
´ivS
);

430 
·ss
 = 
	`SigÇtu»V®id©e
(
´ivS
, 
pubS
) &&…ass;

433 
cout
 << "G’”©šg‚ew sigÇtu» key..." << 
’dl
;

434 
NR
<
SHA
>::
SigÃr
 
	`´ivS
(
	`Glob®RNG
(), 256);

435 
NR
<
SHA
>::
V”if›r
 
	`pubS
(
´ivS
);

437 
·ss
 = 
	`SigÇtu»V®id©e
(
´ivS
, 
pubS
) &&…ass;

439  
·ss
;

440 
	}
}

442 
boŞ
 
	$V®id©eDSA
(
boŞ
 
thÜough
)

444 
cout
 << "\nDSA validation suite„unning...\n\n";

446 
boŞ
 
·ss
 = 
Œue
;

447 
FeSourû
 
	`fs1
("Te¡D©a/d§1024.d©", 
Œue
, 
Ãw
 
	`HexDecod”
());

448 
DSA
::
SigÃr
 
	`´iv
(
fs1
);

449 
DSA
::
V”if›r
 
	`pub
(
´iv
);

450 
FeSourû
 
	`fs2
("Te¡D©a/d§1024b.d©", 
Œue
, 
Ãw
 
	`HexDecod”
());

451 
DSA
::
V”if›r
 
	`pub1
(
fs2
);

452 
	`as£¹
(
pub
.
	`G‘Key
(è=ğ
pub1
.GetKey());

453 
·ss
 = 
	`SigÇtu»V®id©e
(
´iv
, 
pub
, 
thÜough
) &&…ass;

454 
·ss
 = 
	`RunTe¡D©aFe
("Te¡VeùÜs/d§.txt", 
g_nuÎNameV®uePaœs
, 
thÜough
) &&…ass;

455  
·ss
;

456 
	}
}

458 
boŞ
 
	$V®id©eLUC
()

460 
cout
 << "\nLUC validation suite„unning...\n\n";

461 
boŞ
 
·ss
=
Œue
;

464 
FeSourû
 
	`f
("Te¡D©a/luc1024.d©", 
Œue
, 
Ãw
 
HexDecod”
);

465 
LUCSSA_PKCS1v15_SHA_SigÃr
 
	`´iv
(
f
);

466 
LUCSSA_PKCS1v15_SHA_V”if›r
 
	`pub
(
´iv
);

467 
·ss
 = 
	`SigÇtu»V®id©e
(
´iv
, 
pub
) &&…ass;

470 
LUCES_OAEP_SHA_Deüy±Ü
 
	`´iv
(
	`Glob®RNG
(), 512);

471 
LUCES_OAEP_SHA_Enüy±Ü
 
	`pub
(
´iv
);

472 
·ss
 = 
	`Cry±oSy¡emV®id©e
(
´iv
, 
pub
) &&…ass;

474  
·ss
;

475 
	}
}

477 
boŞ
 
	$V®id©eLUC_DL
()

479 
cout
 << "\nLUC-HMP validation suite„unning...\n\n";

481 
FeSourû
 
	`f
("Te¡D©a/lucs512.d©", 
Œue
, 
Ãw
 
HexDecod”
);

482 
LUC_HMP
<
SHA
>::
SigÃr
 
	`´ivS
(
f
);

483 
LUC_HMP
<
SHA
>::
V”if›r
 
	`pubS
(
´ivS
);

484 
boŞ
 
·ss
 = 
	`SigÇtu»V®id©e
(
´ivS
, 
pubS
);

486 
cout
 << "\nLUC-IES validation suite„unning...\n\n";

488 
FeSourû
 
	`fc
("Te¡D©a/lucc512.d©", 
Œue
, 
Ãw
 
HexDecod”
);

489 
LUC_IES
<>::
Deüy±Ü
 
	`´ivC
(
fc
);

490 
LUC_IES
<>::
Enüy±Ü
 
	`pubC
(
´ivC
);

491 
·ss
 = 
	`Cry±oSy¡emV®id©e
(
´ivC
, 
pubC
) &&…ass;

493  
·ss
;

494 
	}
}

496 
boŞ
 
	$V®id©eRabš
()

498 
cout
 << "\nRabin validation suite„unning...\n\n";

499 
boŞ
 
·ss
=
Œue
;

502 
FeSourû
 
	`f
("Te¡D©a/¿bi1024.d©", 
Œue
, 
Ãw
 
HexDecod”
);

503 
RabšSS
<
PSSR
, 
SHA
>::
SigÃr
 
	`´iv
(
f
);

504 
RabšSS
<
PSSR
, 
SHA
>::
V”if›r
 
	`pub
(
´iv
);

505 
·ss
 = 
	`SigÇtu»V®id©e
(
´iv
, 
pub
) &&…ass;

508 
RabšES
<
OAEP
<
SHA
> >::
Deüy±Ü
 
	`´iv
(
	`Glob®RNG
(), 512);

509 
RabšES
<
OAEP
<
SHA
> >::
Enüy±Ü
 
	`pub
(
´iv
);

510 
·ss
 = 
	`Cry±oSy¡emV®id©e
(
´iv
, 
pub
) &&…ass;

512  
·ss
;

513 
	}
}

515 
boŞ
 
	$V®id©eRW
()

517 
cout
 << "\nRW validation suite„unning...\n\n";

519 
FeSourû
 
	`f
("Te¡D©a/rw1024.d©", 
Œue
, 
Ãw
 
HexDecod”
);

520 
RWSS
<
PSSR
, 
SHA
>::
SigÃr
 
	`´iv
(
f
);

521 
RWSS
<
PSSR
, 
SHA
>::
V”if›r
 
	`pub
(
´iv
);

523  
	`SigÇtu»V®id©e
(
´iv
, 
pub
);

524 
	}
}

539 
boŞ
 
	$V®id©eECP
()

541 
cout
 << "\nECP validation suite„unning...\n\n";

543 
ECIES
<
ECP
>::
Deüy±Ü
 
	`ıriv
(
	`Glob®RNG
(), 
ASN1
::
	`£ı192r1
());

544 
ECIES
<
ECP
>::
Enüy±Ü
 
	`ıub
(
ıriv
);

545 
By‹Queue
 
bq
;

546 
ıriv
.
	`G‘Key
().
	`DEREncode
(
bq
);

547 
ıub
.
	`AcûssKey
().
	`AcûssGroupP¬am‘”s
().
	`S‘EncodeAsOID
(
Œue
);

548 
ıub
.
	`G‘Key
().
	`DEREncode
(
bq
);

549 
ECDSA
<
ECP
, 
SHA
>::
SigÃr
 
	`¥riv
(
bq
);

550 
ECDSA
<
ECP
, 
SHA
>::
V”if›r
 
	`¥ub
(
bq
);

551 
ECDH
<
ECP
>::
Domaš
 
	`ecdhc
(
ASN1
::
	`£ı192r1
());

552 
ECMQV
<
ECP
>::
Domaš
 
	`ecmqvc
(
ASN1
::
	`£ı192r1
());

554 
¥riv
.
	`AcûssKey
().
	`P»compu‹
();

555 
By‹Queue
 
queue
;

556 
¥riv
.
	`AcûssKey
().
	`SaveP»computiÚ
(
queue
);

557 
¥riv
.
	`AcûssKey
().
	`LßdP»computiÚ
(
queue
);

559 
boŞ
 
·ss
 = 
	`SigÇtu»V®id©e
(
¥riv
, 
¥ub
);

560 
ıub
.
	`AcûssKey
().
	`P»compu‹
();

561 
ıriv
.
	`AcûssKey
().
	`P»compu‹
();

562 
·ss
 = 
	`Cry±oSy¡emV®id©e
(
ıriv
, 
ıub
) &&…ass;

563 
·ss
 = 
	`Sim¶eKeyAg»em’tV®id©e
(
ecdhc
) &&…ass;

564 
·ss
 = 
	`Auth’tiÿ‹dKeyAg»em’tV®id©e
(
ecmqvc
) &&…ass;

566 
cout
 << "Tuºšg oÀpošˆcom´essiÚ..." << 
’dl
;

567 
ıriv
.
	`AcûssKey
().
	`AcûssGroupP¬am‘”s
().
	`S‘PoštCom´essiÚ
(
Œue
);

568 
ıub
.
	`AcûssKey
().
	`AcûssGroupP¬am‘”s
().
	`S‘PoštCom´essiÚ
(
Œue
);

569 
ecdhc
.
	`AcûssGroupP¬am‘”s
().
	`S‘PoštCom´essiÚ
(
Œue
);

570 
ecmqvc
.
	`AcûssGroupP¬am‘”s
().
	`S‘PoštCom´essiÚ
(
Œue
);

571 
·ss
 = 
	`Cry±oSy¡emV®id©e
(
ıriv
, 
ıub
) &&…ass;

572 
·ss
 = 
	`Sim¶eKeyAg»em’tV®id©e
(
ecdhc
) &&…ass;

573 
·ss
 = 
	`Auth’tiÿ‹dKeyAg»em’tV®id©e
(
ecmqvc
) &&…ass;

575 
cout
 << "Te¡šg SEC 2, NIST,‡nd B¿špoŞ„ecomm’ded curves..." << 
’dl
;

576 
OID
 
oid
;

577 !(
oid
 = 
DL_GroupP¬am‘”s_EC
<
ECP
>::
	`G‘NextRecomm’dedP¬am‘”sOID
(oid)).
m_v®ues
.
	`em±y
())

579 
DL_GroupP¬am‘”s_EC
<
ECP
> 
	`·¿ms
(
oid
);

580 
boŞ
 
ç
 = !
·¿ms
.
	`V®id©e
(
	`Glob®RNG
(), 2);

581 
cout
 << (
ç
 ? "FAILED" : "·s£d"è<< " " << 
dec
 << 
·¿ms
.
	`G‘Curve
().
	`G‘F›ld
().
	`MaxEËm’tB™L’gth
(è<< " b™s" << 
’dl
;

582 
·ss
 =…as && !
ç
;

585  
·ss
;

586 
	}
}

588 
boŞ
 
	$V®id©eEC2N
()

590 
cout
 << "\nEC2N validation suite„unning...\n\n";

592 
ECIES
<
EC2N
>::
Deüy±Ü
 
	`ıriv
(
	`Glob®RNG
(), 
ASN1
::
	`£ù193r1
());

593 
ECIES
<
EC2N
>::
Enüy±Ü
 
	`ıub
(
ıriv
);

594 
By‹Queue
 
bq
;

595 
ıriv
.
	`DEREncode
(
bq
);

596 
ıub
.
	`AcûssKey
().
	`AcûssGroupP¬am‘”s
().
	`S‘EncodeAsOID
(
Œue
);

597 
ıub
.
	`DEREncode
(
bq
);

598 
ECDSA
<
EC2N
, 
SHA
>::
SigÃr
 
	`¥riv
(
bq
);

599 
ECDSA
<
EC2N
, 
SHA
>::
V”if›r
 
	`¥ub
(
bq
);

600 
ECDH
<
EC2N
>::
Domaš
 
	`ecdhc
(
ASN1
::
	`£ù193r1
());

601 
ECMQV
<
EC2N
>::
Domaš
 
	`ecmqvc
(
ASN1
::
	`£ù193r1
());

603 
¥riv
.
	`AcûssKey
().
	`P»compu‹
();

604 
By‹Queue
 
queue
;

605 
¥riv
.
	`AcûssKey
().
	`SaveP»computiÚ
(
queue
);

606 
¥riv
.
	`AcûssKey
().
	`LßdP»computiÚ
(
queue
);

608 
boŞ
 
·ss
 = 
	`SigÇtu»V®id©e
(
¥riv
, 
¥ub
);

609 
·ss
 = 
	`Cry±oSy¡emV®id©e
(
ıriv
, 
ıub
) &&…ass;

610 
·ss
 = 
	`Sim¶eKeyAg»em’tV®id©e
(
ecdhc
) &&…ass;

611 
·ss
 = 
	`Auth’tiÿ‹dKeyAg»em’tV®id©e
(
ecmqvc
) &&…ass;

613 
cout
 << "Tuºšg oÀpošˆcom´essiÚ..." << 
’dl
;

614 
ıriv
.
	`AcûssKey
().
	`AcûssGroupP¬am‘”s
().
	`S‘PoštCom´essiÚ
(
Œue
);

615 
ıub
.
	`AcûssKey
().
	`AcûssGroupP¬am‘”s
().
	`S‘PoštCom´essiÚ
(
Œue
);

616 
ecdhc
.
	`AcûssGroupP¬am‘”s
().
	`S‘PoštCom´essiÚ
(
Œue
);

617 
ecmqvc
.
	`AcûssGroupP¬am‘”s
().
	`S‘PoštCom´essiÚ
(
Œue
);

618 
·ss
 = 
	`Cry±oSy¡emV®id©e
(
ıriv
, 
ıub
) &&…ass;

619 
·ss
 = 
	`Sim¶eKeyAg»em’tV®id©e
(
ecdhc
) &&…ass;

620 
·ss
 = 
	`Auth’tiÿ‹dKeyAg»em’tV®id©e
(
ecmqvc
) &&…ass;

623 
cout
 << "Te¡šg SEC 2„ecomm’ded curves..." << 
’dl
;

624 
OID
 
oid
;

625 !(
oid
 = 
DL_GroupP¬am‘”s_EC
<
EC2N
>::
	`G‘NextRecomm’dedP¬am‘”sOID
(oid)).
m_v®ues
.
	`em±y
())

627 
DL_GroupP¬am‘”s_EC
<
EC2N
> 
	`·¿ms
(
oid
);

628 
boŞ
 
ç
 = !
·¿ms
.
	`V®id©e
(
	`Glob®RNG
(), 2);

629 
cout
 << (
ç
 ? "FAILED" : "·s£d"è<< " " << 
·¿ms
.
	`G‘Curve
().
	`G‘F›ld
().
	`MaxEËm’tB™L’gth
(è<< " b™s" << 
’dl
;

630 
·ss
 =…as && !
ç
;

634  
·ss
;

635 
	}
}

637 
boŞ
 
	$V®id©eECDSA
()

639 
cout
 << "\nECDSA validation suite„unning...\n\n";

642 
GF2NT
 
	`gf2n
(191, 9, 0);

643 
by‹
 
a
[]="\x28\x66\x53\x7B\x67\x67\x52\x63\x6A\x68\xF5\x65\x54\xE1\x26\x40\x27\x6B\x64\x9E\xF7\x52\x62\x67";

644 
by‹
 
b
[]="\x2E\x45\xEF\x57\x1F\x00\x78\x6F\x67\xB0\x08\x1B\x94\x95\xA3\xD9\x54\x62\xF5\xDE\x0A\xA1\x85\xEC";

645 
EC2N
 
	`ec
(
gf2n
, 
	`PŞynomŸlMod2
(
a
,24), PŞynomŸlMod2(
b
,24));

647 
EC2N
::
Pošt
 
P
;

648 
ec
.
	`DecodePošt
(
P
, (
by‹
 *)"\x04\x36\xB3\xDA\xF8\xA2\x32\x06\xF9\xC4\xF2\x99\xD7\xB2\x1A\x9C\x36\x91\x37\xF2\xC8\x4A\xE1\xAA\x0D"

649 "\x76\x5B\xE7\x34\x33\xB3\xF9\x5E\x33\x29\x32\xE7\x0E\xA2\x45\xCA\x24\x18\xEA\x0E\xF9\x80\x18\xFB", 
ec
.
	`EncodedPoštSize
());

650 
IÁeg”
 
	`n
("40000000000000000000000004a20e90c39067c893bbb9a5H");

651 
IÁeg”
 
	`d
("340562e1dda332f9d2aec168249b5696ee39d0ed4d03760fH");

652 
EC2N
::
Pošt
 
	`Q
(
ec
.
	`MuÉly
(
d
, 
P
));

653 
ECDSA
<
EC2N
, 
SHA
>::
SigÃr
 
	`´iv
(
ec
, 
P
, 
n
, 
d
);

654 
ECDSA
<
EC2N
, 
SHA
>::
V”if›r
 
	`pub
(
´iv
);

656 
IÁeg”
 
	`h
("A9993E364706816ABA3E25717850C26C9CD0D89DH");

657 
IÁeg”
 
	`k
("3eeace72b4919d991738d521879f787cb590aff8189d2b69H");

658 
by‹
 
sig
[]="\x03\x8e\x5a\x11\xfb\x55\xe4\xc6\x54\x71\xdc\xd4\x99\x84\x52\xb1\xe0\x2d\x8a\xf7\x09\x9b\xb9\x30"

660 
IÁeg”
 
	`r
(
sig
, 24);

661 
IÁeg”
 
	`s
(
sig
+24, 24);

663 
IÁeg”
 
rOut
, 
sOut
;

664 
boŞ
 
ç
, 
·ss
=
Œue
;

666 
´iv
.
	`RawSign
(
k
, 
h
, 
rOut
, 
sOut
);

667 
ç
 = (
rOut
 !ğ
r
è|| (
sOut
 !ğ
s
);

668 
·ss
 =…as && !
ç
;

670 
cout
 << (
ç
 ? "FAILED " : "passed ");

671 
cout
 << "signature check‡gainstest vector\n";

673 
ç
 = !
pub
.
	`V”ifyMes§ge
((
by‹
 *)"abc", 3, 
sig
, (sig));

674 
·ss
 =…as && !
ç
;

676 
cout
 << (
ç
 ? "FAILED " : "passed ");

677 
cout
 << "verification check‡gainstest vector\n";

679 
ç
 = 
pub
.
	`V”ifyMes§ge
((
by‹
 *)"xyz", 3, 
sig
, (sig));

680 
·ss
 =…as && !
ç
;

682 
·ss
 = 
	`SigÇtu»V®id©e
(
´iv
, 
pub
) &&…ass;

684  
·ss
;

685 
	}
}

687 
boŞ
 
	$V®id©eESIGN
()

689 
cout
 << "\nESIGN validation suite„unning...\n\n";

691 
boŞ
 
·ss
 = 
Œue
, 
ç
;

693 cÚ¡ *
¶aš
 = "test";

694 cÚ¡ 
by‹
 *
sigÇtu»
 = (byte *)

701 
FeSourû
 
	`keys
("Te¡D©a/esig1536.d©", 
Œue
, 
Ãw
 
HexDecod”
);

702 
ESIGN
<
SHA
>::
SigÃr
 
	`sigÃr
(
keys
);

703 
ESIGN
<
SHA
>::
V”if›r
 
	`v”if›r
(
sigÃr
);

705 
ç
 = !
	`SigÇtu»V®id©e
(
sigÃr
, 
v”if›r
);

706 
·ss
 =…as && !
ç
;

708 
ç
 = !
v”if›r
.
	`V”ifyMes§ge
((
by‹
 *)
¶aš
, 
	`¡¾’
ÕÏš), 
sigÇtu»
, v”if›r.
	`SigÇtu»L’gth
());

709 
·ss
 =…as && !
ç
;

711 
cout
 << (
ç
 ? "FAILED " : "passed ");

712 
cout
 << "verification check‡gainstest vector\n";

714 
cout
 << "G’”©šg sigÇtu» key from s“d..." << 
’dl
;

715 
sigÃr
.
	`AcûssKey
().
	`G’”©eRªdom
(
	`Glob®RNG
(), 
	`MakeP¬am‘”s
("S“d", 
	`CÚ¡By‹A¼ayP¬am‘”
((cÚ¡ 
by‹
 *)"test", 4))("KeySize", 3*512));

716 
v”if›r
 = 
sigÃr
;

718 
ç
 = !
	`SigÇtu»V®id©e
(
sigÃr
, 
v”if›r
);

719 
·ss
 =…as && !
ç
;

721  
·ss
;

722 
	}
}

	@validat3.cpp

3 
	~"pch.h
"

4 
	~"v®id©e.h
"

6 
	#CRYPTOPP_ENABLE_NAMESPACE_WEAK
 1

	)

7 
	~"sm¬Œ.h
"

8 
	~"üc.h
"

9 
	~"adËr32.h
"

10 
	~"md2.h
"

11 
	~"md4.h
"

12 
	~"md5.h
"

13 
	~"sha.h
"

14 
	~"tig”.h
"

15 
	~"remd.h
"

17 
	~"hmac.h
"

18 
	~"‰mac.h
"

20 
	~"š‹g”.h
"

21 
	~"pwdba£d.h
"

22 
	~"f‹rs.h
"

23 
	~"hex.h
"

24 
	~"fes.h
"

26 
	~<io¡»am
>

27 
	~<iomª
>

29 
	$USING_NAMESPACE
(
Cry±oPP
)

30 
	$USING_NAMESPACE
(
¡d
)

32 
	sHashTe¡Tu¶e


34 
	`HashTe¡Tu¶e
(cÚ¡ *
šput
, cÚ¡ *
ouut
, 
»³©Times
=1)

35 : 
	`šput
((
by‹
 *)
šput
), 
	`ouut
((by‹ *)
ouut
), 
	`šputL’
(
	`¡¾’
(šput)), 
	`»³©Times
(
»³©Times
) {}

37 
	`HashTe¡Tu¶e
(cÚ¡ *
šput
, 
šputL’
, cÚ¡ *
ouut
, 
»³©Times
)

38 : 
	`šput
((
by‹
 *)
šput
), 
	`ouut
((by‹ *)
ouut
), 
	`šputL’
(
šputL’
), 
	`»³©Times
(
»³©Times
) {}

40 cÚ¡ 
by‹
 *
šput
, *
ouut
;

41 
size_t
 
šputL’
;

42 
»³©Times
;

45 
boŞ
 
	$HashModuËTe¡
(
HashT¿nsfÜm©iÚ
 &
md
, cÚ¡ 
HashTe¡Tu¶e
 *
‹¡S‘
, 
‹¡S‘Size
)

47 
boŞ
 
·ss
=
Œue
, 
ç
;

48 
SecBy‹Block
 
	`dige¡
(
md
.
	`Dige¡Size
());

50 
i
=0; i<
‹¡S‘Size
; i++)

52 
j
;

54 
j
=0; j<
‹¡S‘
[
i
].
»³©Times
; j++)

55 
md
.
	`Upd©e
(
‹¡S‘
[
i
].
šput
,e¡S‘[i].
šputL’
);

56 
md
.
	`Fš®
(
dige¡
);

57 
ç
 = 
	`memcmp
(
dige¡
, 
‹¡S‘
[
i
].
ouut
, 
md
.
	`Dige¡Size
()) != 0;

58 
·ss
 =…as && !
ç
;

60 
cout
 << (
ç
 ? "FAILED " : "passed ");

61 
j
=0; j<
md
.
	`Dige¡Size
(); j++)

62 
cout
 << 
	`£tw
(2è<< 
	`£tfl
('0'è<< 
hex
 << ()
dige¡
[
j
];

63 
cout
 << " \"" << (*)
‹¡S‘
[
i
].
šput
 << '\"';

64 ià(
‹¡S‘
[
i
].
»³©Times
 != 1)

65 
cout
 << "„•—‹d " << 
dec
 << 
‹¡S‘
[
i
].
»³©Times
 << "imes";

66 
cout
 << 
’dl
;

69  
·ss
;

70 
	}
}

72 
boŞ
 
	$V®id©eCRC32
()

74 
HashTe¡Tu¶e
 
‹¡S‘
[] =

76 
	`HashTe¡Tu¶e
("", "\x00\x00\x00\x00"),

77 
	`HashTe¡Tu¶e
("a", "\x43\xbe\xb7\xe8"),

78 
	`HashTe¡Tu¶e
("abc", "\xc2\x41\x24\x35"),

79 
	`HashTe¡Tu¶e
("message digest", "\x7f\x9d\x15\x20"),

80 
	`HashTe¡Tu¶e
("abcdefghijklmnopqrstuvwxyz", "\xbd\x50\x27\x4c"),

81 
	`HashTe¡Tu¶e
("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789", "\xd2\xe6\xc2\x1f"),

82 
	`HashTe¡Tu¶e
("12345678901234567890123456789012345678901234567890123456789012345678901234567890", "\x72\x4a\xa9\x7c"),

83 
	`HashTe¡Tu¶e
("123456789", "\x26\x39\xf4\xcb")

86 
CRC32
 
üc
;

88 
cout
 << "\nCRC-32 validation suite„unning...\n\n";

89  
	`HashModuËTe¡
(
üc
, 
‹¡S‘
, (testSet)/(testSet[0]));

90 
	}
}

92 
boŞ
 
	$V®id©eAdËr32
()

94 
HashTe¡Tu¶e
 
‹¡S‘
[] =

96 
	`HashTe¡Tu¶e
("", "\x00\x00\x00\x01"),

97 
	`HashTe¡Tu¶e
("a", "\x00\x62\x00\x62"),

98 
	`HashTe¡Tu¶e
("abc", "\x02\x4d\x01\x27"),

99 
	`HashTe¡Tu¶e
("message digest", "\x29\x75\x05\x86"),

100 
	`HashTe¡Tu¶e
("abcdefghijklmnopqrstuvwxyz", "\x90\x86\x0b\x20"),

101 
	`HashTe¡Tu¶e
("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789", "\x8a\xdb\x15\x0c"),

102 
	`HashTe¡Tu¶e
("aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa", "\x15\xd8\x70\xf9", 15625)

105 
AdËr32
 
md
;

107 
cout
 << "\nAdler-32 validation suite„unning...\n\n";

108  
	`HashModuËTe¡
(
md
, 
‹¡S‘
, (testSet)/(testSet[0]));

109 
	}
}

111 
boŞ
 
	$V®id©eMD2
()

113 
HashTe¡Tu¶e
 
‹¡S‘
[] =

115 
	`HashTe¡Tu¶e
("", "\x83\x50\xe5\xa3\xe2\x4c\x15\x3d\xf2\x27\x5c\x9f\x80\x69\x27\x73"),

116 
	`HashTe¡Tu¶e
("a", "\x32\xec\x01\xec\x4a\x6d\xac\x72\xc0\xab\x96\xfb\x34\xc0\xb5\xd1"),

117 
	`HashTe¡Tu¶e
("abc", "\xda\x85\x3b\x0d\x3f\x88\xd9\x9b\x30\x28\x3a\x69\xe6\xde\xd6\xbb"),

118 
	`HashTe¡Tu¶e
("message digest", "\xab\x4f\x49\x6b\xfb\x2a\x53\x0b\x21\x9f\xf3\x30\x31\xfe\x06\xb0"),

119 
	`HashTe¡Tu¶e
("abcdefghijklmnopqrstuvwxyz", "\x4e\x8d\xdf\xf3\x65\x02\x92\xab\x5a\x41\x08\xc3\xaa\x47\x94\x0b"),

120 
	`HashTe¡Tu¶e
("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789", "\xda\x33\xde\xf2\xa4\x2d\xf1\x39\x75\x35\x28\x46\xc3\x03\x38\xcd"),

121 
	`HashTe¡Tu¶e
("12345678901234567890123456789012345678901234567890123456789012345678901234567890", "\xd5\x97\x6f\x79\xd8\x3d\x3a\x0d\xc9\x80\x6c\x3c\x66\xf3\xef\xd8")

124 
W—k
::
MD2
 
md2
;

126 
cout
 << "\nMD2 validation suite„unning...\n\n";

127  
	`HashModuËTe¡
(
md2
, 
‹¡S‘
, (testSet)/(testSet[0]));

128 
	}
}

130 
boŞ
 
	$V®id©eMD4
()

132 
HashTe¡Tu¶e
 
‹¡S‘
[] =

134 
	`HashTe¡Tu¶e
("", "\x31\xd6\xcf\xe0\xd1\x6a\xe9\x31\xb7\x3c\x59\xd7\xe0\xc0\x89\xc0"),

135 
	`HashTe¡Tu¶e
("a", "\xbd\xe5\x2c\xb3\x1d\xe3\x3e\x46\x24\x5e\x05\xfb\xdb\xd6\xfb\x24"),

136 
	`HashTe¡Tu¶e
("abc", "\xa4\x48\x01\x7a\xaf\x21\xd8\x52\x5f\xc1\x0a\xe8\x7a\xa6\x72\x9d"),

137 
	`HashTe¡Tu¶e
("message digest", "\xd9\x13\x0a\x81\x64\x54\x9f\xe8\x18\x87\x48\x06\xe1\xc7\x01\x4b"),

138 
	`HashTe¡Tu¶e
("abcdefghijklmnopqrstuvwxyz", "\xd7\x9e\x1c\x30\x8a\xa5\xbb\xcd\xee\xa8\xed\x63\xdf\x41\x2d\xa9"),

139 
	`HashTe¡Tu¶e
("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789", "\x04\x3f\x85\x82\xf2\x41\xdb\x35\x1c\xe6\x27\xe1\x53\xe7\xf0\xe4"),

140 
	`HashTe¡Tu¶e
("12345678901234567890123456789012345678901234567890123456789012345678901234567890", "\xe3\x3b\x4d\xdc\x9c\x38\xf2\x19\x9c\x3e\x7b\x16\x4f\xcc\x05\x36")

143 
W—k
::
MD4
 
md4
;

145 
cout
 << "\nMD4 validation suite„unning...\n\n";

146  
	`HashModuËTe¡
(
md4
, 
‹¡S‘
, (testSet)/(testSet[0]));

147 
	}
}

149 
boŞ
 
	$V®id©eMD5
()

151 
HashTe¡Tu¶e
 
‹¡S‘
[] =

153 
	`HashTe¡Tu¶e
("", "\xd4\x1d\x8c\xd9\x8f\x00\xb2\x04\xe9\x80\x09\x98\xec\xf8\x42\x7e"),

154 
	`HashTe¡Tu¶e
("a", "\x0c\xc1\x75\xb9\xc0\xf1\xb6\xa8\x31\xc3\x99\xe2\x69\x77\x26\x61"),

155 
	`HashTe¡Tu¶e
("abc", "\x90\x01\x50\x98\x3c\xd2\x4f\xb0\xd6\x96\x3f\x7d\x28\xe1\x7f\x72"),

156 
	`HashTe¡Tu¶e
("message digest", "\xf9\x6b\x69\x7d\x7c\xb7\x93\x8d\x52\x5a\x2f\x31\xaa\xf1\x61\xd0"),

157 
	`HashTe¡Tu¶e
("abcdefghijklmnopqrstuvwxyz", "\xc3\xfc\xd3\xd7\x61\x92\xe4\x00\x7d\xfb\x49\x6c\xca\x67\xe1\x3b"),

158 
	`HashTe¡Tu¶e
("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789", "\xd1\x74\xab\x98\xd2\x77\xd9\xf5\xa5\x61\x1c\x2c\x9f\x41\x9d\x9f"),

159 
	`HashTe¡Tu¶e
("12345678901234567890123456789012345678901234567890123456789012345678901234567890", "\x57\xed\xf4\xa2\x2b\xe3\xc9\x55\xac\x49\xda\x2e\x21\x07\xb6\x7a")

162 
W—k
::
MD5
 
md5
;

164 
cout
 << "\nMD5 validation suite„unning...\n\n";

165  
	`HashModuËTe¡
(
md5
, 
‹¡S‘
, (testSet)/(testSet[0]));

166 
	}
}

168 
boŞ
 
	$V®id©eSHA
()

170 
cout
 << "\nSHA validation suite„unning...\n\n";

171  
	`RunTe¡D©aFe
("TestVectors/sha.txt");

172 
	}
}

174 
boŞ
 
	$V®id©eSHA2
()

176 
cout
 << "\nSHA validation suite„unning...\n\n";

177  
	`RunTe¡D©aFe
("TestVectors/sha.txt");

178 
	}
}

180 
boŞ
 
	$V®id©eTig”
()

182 
cout
 << "\nTiger validation suite„unning...\n\n";

184 
HashTe¡Tu¶e
 
‹¡S‘
[] =

186 
	`HashTe¡Tu¶e
("", "\x32\x93\xac\x63\x0c\x13\xf0\x24\x5f\x92\xbb\xb1\x76\x6e\x16\x16\x7a\x4e\x58\x49\x2d\xde\x73\xf3"),

187 
	`HashTe¡Tu¶e
("abc", "\x2a\xab\x14\x84\xe8\xc1\x58\xf2\xbf\xb8\xc5\xff\x41\xb5\x7a\x52\x51\x29\x13\x1c\x95\x7b\x5f\x93"),

188 
	`HashTe¡Tu¶e
("Tiger", "\xdd\x00\x23\x07\x99\xf5\x00\x9f\xec\x6d\xeb\xc8\x38\xbb\x6a\x27\xdf\x2b\x9d\x6f\x11\x0c\x79\x37"),

189 
	`HashTe¡Tu¶e
("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-", "\xf7\x1c\x85\x83\x90\x2a\xfb\x87\x9e\xdf\xe6\x10\xf8\x2c\x0d\x47\x86\xa3\xa5\x34\x50\x44\x86\xb5"),

190 
	`HashTe¡Tu¶e
("ABCDEFGHIJKLMNOPQRSTUVWXYZ=abcdefghijklmnopqrstuvwxyz+0123456789", "\x48\xce\xeb\x63\x08\xb8\x7d\x46\xe9\x5d\x65\x61\x12\xcd\xf1\x8d\x97\x91\x5f\x97\x65\x65\x89\x57"),

191 
	`HashTe¡Tu¶e
("Tiger - A Fast New Hash Function, by Ross Anderson‡nd Eli Biham", "\x8a\x86\x68\x29\x04\x0a\x41\x0c\x72\x9a\xd2\x3f\x5a\xda\x71\x16\x03\xb3\xcd\xd3\x57\xe4\xc1\x5e"),

192 
	`HashTe¡Tu¶e
("Tiger - A Fast New Hash Function, by Ross Anderson‡nd Eli Biham,…roceedings of Fast Software Encryption 3, Cambridge.", "\xce\x55\xa6\xaf\xd5\x91\xf5\xeb\xac\x54\x7f\xf8\x4f\x89\x22\x7f\x93\x31\xda\xb0\xb6\x11\xc8\x89"),

193 
	`HashTe¡Tu¶e
("Tiger - A Fast New Hash Function, by Ross Anderson‡nd Eli Biham,…roceedings of Fast Software Encryption 3, Cambridge, 1996.", "\x63\x1a\xbd\xd1\x03\xeb\x9a\x3d\x24\x5b\x6d\xfd\x4d\x77\xb2\x57\xfc\x74\x39\x50\x1d\x15\x68\xdd"),

194 
	`HashTe¡Tu¶e
("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-", "\xc5\x40\x34\xe5\xb4\x3e\xb8\x00\x58\x48\xa7\xe0\xae\x6a\xac\x76\xe4\xff\x59\x0a\xe7\x15\xfd\x25")

197 
Tig”
 
tig”
;

199  
	`HashModuËTe¡
(
tig”
, 
‹¡S‘
, (testSet)/(testSet[0]));

200 
	}
}

202 
boŞ
 
	$V®id©eRIPEMD
()

204 
HashTe¡Tu¶e
 
‹¡S‘128
[] =

206 
	`HashTe¡Tu¶e
("", "\xcd\xf2\x62\x13\xa1\x50\xdc\x3e\xcb\x61\x0f\x18\xf6\xb3\x8b\x46"),

207 
	`HashTe¡Tu¶e
("a", "\x86\xbe\x7a\xfa\x33\x9d\x0f\xc7\xcf\xc7\x85\xe7\x2f\x57\x8d\x33"),

208 
	`HashTe¡Tu¶e
("abc", "\xc1\x4a\x12\x19\x9c\x66\xe4\xba\x84\x63\x6b\x0f\x69\x14\x4c\x77"),

209 
	`HashTe¡Tu¶e
("message digest", "\x9e\x32\x7b\x3d\x6e\x52\x30\x62\xaf\xc1\x13\x2d\x7d\xf9\xd1\xb8"),

210 
	`HashTe¡Tu¶e
("abcdefghijklmnopqrstuvwxyz", "\xfd\x2a\xa6\x07\xf7\x1d\xc8\xf5\x10\x71\x49\x22\xb3\x71\x83\x4e"),

211 
	`HashTe¡Tu¶e
("abcdbcdecdefdefgefghfghighijhijkijkljklmklmnlmnomnopnopq", "\xa1\xaa\x06\x89\xd0\xfa\xfa\x2d\xdc\x22\xe8\x8b\x49\x13\x3a\x06"),

212 
	`HashTe¡Tu¶e
("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789", "\xd1\xe9\x59\xeb\x17\x9c\x91\x1f\xae\xa4\x62\x4c\x60\xc5\xc7\x02"),

213 
	`HashTe¡Tu¶e
("12345678901234567890123456789012345678901234567890123456789012345678901234567890", "\x3f\x45\xef\x19\x47\x32\xc2\xdb\xb2\xc4\xa2\xc7\x69\x79\x5f\xa3"),

214 
	`HashTe¡Tu¶e
("aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa", "\x4a\x7f\x57\x23\xf9\x54\xeb\xa1\x21\x6c\x9d\x8f\x63\x20\x43\x1f", 15625)

217 
HashTe¡Tu¶e
 
‹¡S‘160
[] =

219 
	`HashTe¡Tu¶e
("", "\x9c\x11\x85\xa5\xc5\xe9\xfc\x54\x61\x28\x08\x97\x7e\xe8\xf5\x48\xb2\x25\x8d\x31"),

220 
	`HashTe¡Tu¶e
("a", "\x0b\xdc\x9d\x2d\x25\x6b\x3e\xe9\xda\xae\x34\x7b\xe6\xf4\xdc\x83\x5a\x46\x7f\xfe"),

221 
	`HashTe¡Tu¶e
("abc", "\x8e\xb2\x08\xf7\xe0\x5d\x98\x7a\x9b\x04\x4a\x8e\x98\xc6\xb0\x87\xf1\x5a\x0b\xfc"),

222 
	`HashTe¡Tu¶e
("message digest", "\x5d\x06\x89\xef\x49\xd2\xfa\xe5\x72\xb8\x81\xb1\x23\xa8\x5f\xfa\x21\x59\x5f\x36"),

223 
	`HashTe¡Tu¶e
("abcdefghijklmnopqrstuvwxyz", "\xf7\x1c\x27\x10\x9c\x69\x2c\x1b\x56\xbb\xdc\xeb\x5b\x9d\x28\x65\xb3\x70\x8d\xbc"),

224 
	`HashTe¡Tu¶e
("abcdbcdecdefdefgefghfghighijhijkijkljklmklmnlmnomnopnopq", "\x12\xa0\x53\x38\x4a\x9c\x0c\x88\xe4\x05\xa0\x6c\x27\xdc\xf4\x9a\xda\x62\xeb\x2b"),

225 
	`HashTe¡Tu¶e
("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789", "\xb0\xe2\x0b\x6e\x31\x16\x64\x02\x86\xed\x3a\x87\xa5\x71\x30\x79\xb2\x1f\x51\x89"),

226 
	`HashTe¡Tu¶e
("12345678901234567890123456789012345678901234567890123456789012345678901234567890", "\x9b\x75\x2e\x45\x57\x3d\x4b\x39\xf4\xdb\xd3\x32\x3c\xab\x82\xbf\x63\x32\x6b\xfb"),

227 
	`HashTe¡Tu¶e
("aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa", "\x52\x78\x32\x43\xc1\x69\x7b\xdb\xe1\x6d\x37\xf9\x7f\x68\xf0\x83\x25\xdc\x15\x28", 15625)

230 
HashTe¡Tu¶e
 
‹¡S‘256
[] =

232 
	`HashTe¡Tu¶e
("", "\x02\xba\x4c\x4e\x5f\x8e\xcd\x18\x77\xfc\x52\xd6\x4d\x30\xe3\x7a\x2d\x97\x74\xfb\x1e\x5d\x02\x63\x80\xae\x01\x68\xe3\xc5\x52\x2d"),

233 
	`HashTe¡Tu¶e
("a", "\xf9\x33\x3e\x45\xd8\x57\xf5\xd9\x0a\x91\xba\xb7\x0a\x1e\xba\x0c\xfb\x1b\xe4\xb0\x78\x3c\x9a\xcf\xcd\x88\x3a\x91\x34\x69\x29\x25"),

234 
	`HashTe¡Tu¶e
("abc", "\xaf\xbd\x6e\x22\x8b\x9d\x8c\xbb\xce\xf5\xca\x2d\x03\xe6\xdb\xa1\x0a\xc0\xbc\x7d\xcb\xe4\x68\x0e\x1e\x42\xd2\xe9\x75\x45\x9b\x65"),

235 
	`HashTe¡Tu¶e
("message digest", "\x87\xe9\x71\x75\x9a\x1c\xe4\x7a\x51\x4d\x5c\x91\x4c\x39\x2c\x90\x18\xc7\xc4\x6b\xc1\x44\x65\x55\x4a\xfc\xdf\x54\xa5\x07\x0c\x0e"),

236 
	`HashTe¡Tu¶e
("abcdefghijklmnopqrstuvwxyz", "\x64\x9d\x30\x34\x75\x1e\xa2\x16\x77\x6b\xf9\xa1\x8a\xcc\x81\xbc\x78\x96\x11\x8a\x51\x97\x96\x87\x82\xdd\x1f\xd9\x7d\x8d\x51\x33"),

237 
	`HashTe¡Tu¶e
("abcdbcdecdefdefgefghfghighijhijkijkljklmklmnlmnomnopnopq", "\x38\x43\x04\x55\x83\xaa\xc6\xc8\xc8\xd9\x12\x85\x73\xe7\xa9\x80\x9a\xfb\x2a\x0f\x34\xcc\xc3\x6e\xa9\xe7\x2f\x16\xf6\x36\x8e\x3f"),

238 
	`HashTe¡Tu¶e
("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789", "\x57\x40\xa4\x08\xac\x16\xb7\x20\xb8\x44\x24\xae\x93\x1c\xbb\x1f\xe3\x63\xd1\xd0\xbf\x40\x17\xf1\xa8\x9f\x7e\xa6\xde\x77\xa0\xb8"),

239 
	`HashTe¡Tu¶e
("12345678901234567890123456789012345678901234567890123456789012345678901234567890", "\x06\xfd\xcc\x7a\x40\x95\x48\xaa\xf9\x13\x68\xc0\x6a\x62\x75\xb5\x53\xe3\xf0\x99\xbf\x0e\xa4\xed\xfd\x67\x78\xdf\x89\xa8\x90\xdd"),

240 
	`HashTe¡Tu¶e
("aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa", "\xac\x95\x37\x44\xe1\x0e\x31\x51\x4c\x15\x0d\x4d\x8d\x7b\x67\x73\x42\xe3\x33\x99\x78\x82\x96\xe4\x3a\xe4\x85\x0c\xe4\xf9\x79\x78", 15625)

243 
HashTe¡Tu¶e
 
‹¡S‘320
[] =

245 
	`HashTe¡Tu¶e
("", "\x22\xd6\x5d\x56\x61\x53\x6c\xdc\x75\xc1\xfd\xf5\xc6\xde\x7b\x41\xb9\xf2\x73\x25\xeb\xc6\x1e\x85\x57\x17\x7d\x70\x5a\x0e\xc8\x80\x15\x1c\x3a\x32\xa0\x08\x99\xb8"),

246 
	`HashTe¡Tu¶e
("a", "\xce\x78\x85\x06\x38\xf9\x26\x58\xa5\xa5\x85\x09\x75\x79\x92\x6d\xda\x66\x7a\x57\x16\x56\x2c\xfc\xf6\xfb\xe7\x7f\x63\x54\x2f\x99\xb0\x47\x05\xd6\x97\x0d\xff\x5d"),

247 
	`HashTe¡Tu¶e
("abc", "\xde\x4c\x01\xb3\x05\x4f\x89\x30\xa7\x9d\x09\xae\x73\x8e\x92\x30\x1e\x5a\x17\x08\x5b\xef\xfd\xc1\xb8\xd1\x16\x71\x3e\x74\xf8\x2f\xa9\x42\xd6\x4c\xdb\xc4\x68\x2d"),

248 
	`HashTe¡Tu¶e
("message digest", "\x3a\x8e\x28\x50\x2e\xd4\x5d\x42\x2f\x68\x84\x4f\x9d\xd3\x16\xe7\xb9\x85\x33\xfa\x3f\x2a\x91\xd2\x9f\x84\xd4\x25\xc8\x8d\x6b\x4e\xff\x72\x7d\xf6\x6a\x7c\x01\x97"),

249 
	`HashTe¡Tu¶e
("abcdefghijklmnopqrstuvwxyz", "\xca\xbd\xb1\x81\x0b\x92\x47\x0a\x20\x93\xaa\x6b\xce\x05\x95\x2c\x28\x34\x8c\xf4\x3f\xf6\x08\x41\x97\x51\x66\xbb\x40\xed\x23\x40\x04\xb8\x82\x44\x63\xe6\xb0\x09"),

250 
	`HashTe¡Tu¶e
("abcdbcdecdefdefgefghfghighijhijkijkljklmklmnlmnomnopnopq", "\xd0\x34\xa7\x95\x0c\xf7\x22\x02\x1b\xa4\xb8\x4d\xf7\x69\xa5\xde\x20\x60\xe2\x59\xdf\x4c\x9b\xb4\xa4\x26\x8c\x0e\x93\x5b\xbc\x74\x70\xa9\x69\xc9\xd0\x72\xa1\xac"),

251 
	`HashTe¡Tu¶e
("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789", "\xed\x54\x49\x40\xc8\x6d\x67\xf2\x50\xd2\x32\xc3\x0b\x7b\x3e\x57\x70\xe0\xc6\x0c\x8c\xb9\xa4\xca\xfe\x3b\x11\x38\x8a\xf9\x92\x0e\x1b\x99\x23\x0b\x84\x3c\x86\xa4"),

252 
	`HashTe¡Tu¶e
("12345678901234567890123456789012345678901234567890123456789012345678901234567890", "\x55\x78\x88\xaf\x5f\x6d\x8e\xd6\x2a\xb6\x69\x45\xc6\xd2\xa0\xa4\x7e\xcd\x53\x41\xe9\x15\xeb\x8f\xea\x1d\x05\x24\x95\x5f\x82\x5d\xc7\x17\xe4\xa0\x08\xab\x2d\x42"),

253 
	`HashTe¡Tu¶e
("aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa", "\xbd\xee\x37\xf4\x37\x1e\x20\x64\x6b\x8b\x0d\x86\x2d\xda\x16\x29\x2a\xe3\x6f\x40\x96\x5e\x8c\x85\x09\xe6\x3d\x1d\xbd\xde\xcc\x50\x3e\x2b\x63\xeb\x92\x45\xbb\x66", 15625)

256 
boŞ
 
·ss
 = 
Œue
;

258 
cout
 << "\nRIPEMD-128 validation suite„unning...\n\n";

259 
RIPEMD128
 
md128
;

260 
·ss
 = 
	`HashModuËTe¡
(
md128
, 
‹¡S‘128
, (testSet128)/(testSet128[0])) &&…ass;

262 
cout
 << "\nRIPEMD-160 validation suite„unning...\n\n";

263 
RIPEMD160
 
md160
;

264 
·ss
 = 
	`HashModuËTe¡
(
md160
, 
‹¡S‘160
, (testSet160)/(testSet160[0])) &&…ass;

266 
cout
 << "\nRIPEMD-256 validation suite„unning...\n\n";

267 
RIPEMD256
 
md256
;

268 
·ss
 = 
	`HashModuËTe¡
(
md256
, 
‹¡S‘256
, (testSet256)/(testSet256[0])) &&…ass;

270 
cout
 << "\nRIPEMD-320 validation suite„unning...\n\n";

271 
RIPEMD320
 
md320
;

272 
·ss
 = 
	`HashModuËTe¡
(
md320
, 
‹¡S‘320
, (testSet320)/(testSet320[0])) &&…ass;

274  
·ss
;

275 
	}
}

277 #ifdeà
CRYPTOPP_REMOVED


278 
boŞ
 
	$V®id©eHAVAL
()

280 
HashTe¡Tu¶e
 
‹¡S‘
[] =

282 
	`HashTe¡Tu¶e
("", "\xC6\x8F\x39\x91\x3F\x90\x1F\x3D\xDF\x44\xC7\x07\x35\x7A\x7D\x70"),

283 
	`HashTe¡Tu¶e
("a", "\x4D\xA0\x8F\x51\x4A\x72\x75\xDB\xC4\xCE\xCE\x4A\x34\x73\x85\x98\x39\x83\xA8\x30"),

284 
	`HashTe¡Tu¶e
("HAVAL", "\x0C\x13\x96\xD7\x77\x26\x89\xC4\x67\x73\xF3\xDA\xAC\xA4\xEF\xA9\x82\xAD\xBF\xB2\xF1\x46\x7E\xEA"),

285 
	`HashTe¡Tu¶e
("0123456789", "\xBE\xBD\x78\x16\xF0\x9B\xAE\xEC\xF8\x90\x3B\x1B\x9B\xC6\x72\xD9\xFA\x42\x8E\x46\x2B\xA6\x99\xF8\x14\x84\x15\x29"),

286 
	`HashTe¡Tu¶e
("abcdefghijklmnopqrstuvwxyz", "\xC9\xC7\xD8\xAF\xA1\x59\xFD\x9E\x96\x5C\xB8\x3F\xF5\xEE\x6F\x58\xAE\xDA\x35\x2C\x0E\xFF\x00\x55\x48\x15\x3A\x61\x55\x1C\x38\xEE"),

287 
	`HashTe¡Tu¶e
("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789", "\xB4\x5C\xB6\xE6\x2F\x2B\x13\x20\xE4\xF8\xF1\xB0\xB2\x73\xD4\x5A\xDD\x47\xC3\x21\xFD\x23\x99\x9D\xCF\x40\x3A\xC3\x76\x36\xD9\x63")

290 
boŞ
 
·ss
=
Œue
;

292 
cout
 << "\nHAVAL validation suite„unning...\n\n";

294 
HAVAL3
 
	`md
(16);

295 
·ss
 = 
	`HashModuËTe¡
(
md
, 
‹¡S‘
+0, 1) &&…ass;

298 
HAVAL3
 
	`md
(20);

299 
·ss
 = 
	`HashModuËTe¡
(
md
, 
‹¡S‘
+1, 1) &&…ass;

302 
HAVAL4
 
	`md
(24);

303 
·ss
 = 
	`HashModuËTe¡
(
md
, 
‹¡S‘
+2, 1) &&…ass;

306 
HAVAL4
 
	`md
(28);

307 
·ss
 = 
	`HashModuËTe¡
(
md
, 
‹¡S‘
+3, 1) &&…ass;

310 
HAVAL5
 
	`md
(32);

311 
·ss
 = 
	`HashModuËTe¡
(
md
, 
‹¡S‘
+4, 1) &&…ass;

314 
HAVAL5
 
	`md
(32);

315 
·ss
 = 
	`HashModuËTe¡
(
md
, 
‹¡S‘
+5, 1) &&…ass;

318  
·ss
;

319 
	}
}

322 
boŞ
 
	$V®id©ePªama
()

324  
	`RunTe¡D©aFe
("TestVectors/panama.txt");

325 
	}
}

327 
boŞ
 
	$V®id©eWhœÍoŞ
()

329  
	`RunTe¡D©aFe
("TestVectors/whrlpool.txt");

330 
	}
}

332 #ifdeà
CRYPTOPP_REMOVED


333 
boŞ
 
	$V®id©eMD5MAC
()

335 cÚ¡ 
by‹
 
keys
[2][
MD5MAC
::
KEYLENGTH
]={

339 cÚ¡ *
Te¡V®s
[7]={

348 cÚ¡ 
by‹
 
ouut
[2][7][
MD5MAC
::
DIGESTSIZE
]={

364 
by‹
 
dige¡
[
MD5MAC
::
DIGESTSIZE
];

365 
boŞ
 
·ss
=
Œue
, 
ç
;

367 
cout
 << "\nMD5MAC validation suite„unning...\n";

369 
k
=0; k<2; k++)

371 
MD5MAC
 
	`mac
(
keys
[
k
]);

372 
cout
 << "\nKEY: ";

373 
j
=0;j<
MD5MAC
::
KEYLENGTH
;j++)

374 
cout
 << 
	`£tw
(2è<< 
	`£tfl
('0'è<< 
hex
 << ()
keys
[
k
][
j
];

375 
cout
 << 
’dl
 <<ƒndl;

376 
i
=0;i<7;i++)

378 
mac
.
	`Upd©e
((
by‹
 *)
Te¡V®s
[
i
], 
	`¡¾’
(TestVals[i]));

379 
mac
.
	`Fš®
(
dige¡
);

380 
ç
 = 
	`memcmp
(
dige¡
, 
ouut
[
k
][
i
], 
MD5MAC
::
DIGESTSIZE
)

381 || !
mac
.
	`V”ifyDige¡
(
ouut
[
k
][
i
], (
by‹
 *)
Te¡V®s
[i], 
	`¡¾’
(TestVals[i]));

382 
·ss
 =…as && !
ç
;

383 
cout
 << (
ç
 ? "FAILED " : "passed ");

384 
j
=0;j<
MD5MAC
::
DIGESTSIZE
;j++)

385 
cout
 << 
	`£tw
(2è<< 
	`£tfl
('0'è<< 
hex
 << ()
dige¡
[
j
];

386 
cout
 << " \"" << 
Te¡V®s
[
i
] << '\"' << 
’dl
;

390  
·ss
;

391 
	}
}

394 
boŞ
 
	$V®id©eHMAC
()

396  
	`RunTe¡D©aFe
("TestVectors/hmac.txt");

397 
	}
}

399 #ifdeà
CRYPTOPP_REMOVED


400 
boŞ
 
	$V®id©eXMACC
()

402 
XMACC
<
	tMD5
> 
	tXMACC_MD5
;

404 cÚ¡ 
by‹
 
keys
[2][
XMACC_MD5
::
KEYLENGTH
]={

408 cÚ¡ 
wÜd32
 
couÁ”s
[2]={0xccddeeff, 0x76543210};

410 cÚ¡ *
Te¡V®s
[7]={

419 cÚ¡ 
by‹
 
ouut
[2][7][
XMACC_MD5
::
DIGESTSIZE
]={

435 
by‹
 
dige¡
[
XMACC_MD5
::
DIGESTSIZE
];

436 
boŞ
 
·ss
=
Œue
, 
ç
;

438 
cout
 << "\nXMACC/MD5 validation suite„unning...\n";

440 
k
=0; k<2; k++)

442 
XMACC_MD5
 
	`mac
(
keys
[
k
], 
couÁ”s
[k]);

443 
cout
 << "\nKEY: ";

444 
j
=0;j<
XMACC_MD5
::
KEYLENGTH
;j++)

445 
cout
 << 
	`£tw
(2è<< 
	`£tfl
('0'è<< 
hex
 << ()
keys
[
k
][
j
];

446 
cout
 << " COUNTER: 0x" << 
hex
 << 
couÁ”s
[
k
] << 
’dl
 <<ƒndl;

447 
i
=0;i<7;i++)

449 
mac
.
	`Upd©e
((
by‹
 *)
Te¡V®s
[
i
], 
	`¡¾’
(TestVals[i]));

450 
mac
.
	`Fš®
(
dige¡
);

451 
ç
 = 
	`memcmp
(
dige¡
, 
ouut
[
k
][
i
], 
XMACC_MD5
::
DIGESTSIZE
)

452 || !
mac
.
	`V”ifyDige¡
(
ouut
[
k
][
i
], (
by‹
 *)
Te¡V®s
[i], 
	`¡¾’
(TestVals[i]));

453 
·ss
 =…as && !
ç
;

454 
cout
 << (
ç
 ? "FAILED " : "passed ");

455 
j
=0;j<
XMACC_MD5
::
DIGESTSIZE
;j++)

456 
cout
 << 
	`£tw
(2è<< 
	`£tfl
('0'è<< 
hex
 << ()
dige¡
[
j
];

457 
cout
 << " \"" << 
Te¡V®s
[
i
] << '\"' << 
’dl
;

461  
·ss
;

462 
	}
}

465 
boŞ
 
	$V®id©eTTMAC
()

467 cÚ¡ 
by‹
 
key
[
TTMAC
::
KEYLENGTH
]={

471 cÚ¡ *
Te¡V®s
[8]={

481 cÚ¡ 
by‹
 
ouut
[8][
TTMAC
::
DIGESTSIZE
]={

491 
by‹
 
dige¡
[
TTMAC
::
DIGESTSIZE
];

492 
boŞ
 
·ss
=
Œue
, 
ç
;

494 
cout
 << "\nTwo-Track-MAC validation suite„unning...\n";

496 
TTMAC
 
	`mac
(
key
, (key));

497 
k
=0; k<(
Te¡V®s
)/(TestVals[0]); k++)

499 
mac
.
	`Upd©e
((
by‹
 *)
Te¡V®s
[
k
], 
	`¡¾’
(TestVals[k]));

500 
mac
.
	`Fš®
(
dige¡
);

501 
ç
 = 
	`memcmp
(
dige¡
, 
ouut
[
k
], 
TTMAC
::
DIGESTSIZE
)

502 || !
mac
.
	`V”ifyDige¡
(
ouut
[
k
], (
by‹
 *)
Te¡V®s
[k], 
	`¡¾’
(TestVals[k]));

503 
·ss
 =…as && !
ç
;

504 
cout
 << (
ç
 ? "FAILED " : "passed ");

505 
j
=0;j<
TTMAC
::
DIGESTSIZE
;j++)

506 
cout
 << 
	`£tw
(2è<< 
	`£tfl
('0'è<< 
hex
 << ()
dige¡
[
j
];

507 
cout
 << " \"" << 
Te¡V®s
[
k
] << '\"' << 
’dl
;

510  
Œue
;

511 
	}
}

513 
	sPBKDF_Te¡Tu¶e


515 
by‹
 
	mpu½o£
;

516 
	m™”©iÚs
;

517 cÚ¡ *
	mhexPasswÜd
, *
	mhexS®t
, *
	mhexD”ivedKey
;

520 
boŞ
 
	$Te¡PBKDF
(
PasswÜdBa£dKeyD”iv©iÚFunùiÚ
 &
pbkdf
, cÚ¡ 
PBKDF_Te¡Tu¶e
 *
‹¡S‘
, 
‹¡S‘Size
)

522 
boŞ
 
·ss
 = 
Œue
;

524 
i
=0; i<
‹¡S‘Size
; i++)

526 cÚ¡ 
PBKDF_Te¡Tu¶e
 &
tu¶e
 = 
‹¡S‘
[
i
];

528 
¡ršg
 
·sswÜd
, 
§É
, 
d”ivedKey
;

529 
	`SŒšgSourû
(
tu¶e
.
hexPasswÜd
, 
Œue
, 
Ãw
 
	`HexDecod”
Òew 
	`SŒšgSšk
(
·sswÜd
)));

530 
	`SŒšgSourû
(
tu¶e
.
hexS®t
, 
Œue
, 
Ãw
 
	`HexDecod”
Òew 
	`SŒšgSšk
(
§É
)));

531 
	`SŒšgSourû
(
tu¶e
.
hexD”ivedKey
, 
Œue
, 
Ãw
 
	`HexDecod”
Òew 
	`SŒšgSšk
(
d”ivedKey
)));

533 
SecBy‹Block
 
	`d”ived
(
d”ivedKey
.
	`size
());

534 
pbkdf
.
	`D”iveKey
(
d”ived
, d”ived.
	`size
(), 
tu¶e
.
pu½o£
, (
by‹
 *)
·sswÜd
.
	`d©a
(),…asswÜd.size(), (by‹ *)
§É
.d©a(), s®t.size(),u¶e.
™”©iÚs
);

535 
boŞ
 
ç
 = 
	`memcmp
(
d”ived
, 
d”ivedKey
.
	`d©a
(), d”ived.
	`size
()) != 0;

536 
·ss
 =…as && !
ç
;

538 
HexEncod”
 
	`’c
(
Ãw
 
	`FeSšk
(
cout
));

539 
cout
 << (
ç
 ? "FAILED " : "passed ");

540 
’c
.
	`Put
(
tu¶e
.
pu½o£
);

541 
cout
 << " " << 
tu¶e
.
™”©iÚs
;

542 
cout
 << " " << 
tu¶e
.
hexPasswÜd
 << " " <<u¶e.
hexS®t
 << " ";

543 
’c
.
	`Put
(
d”ived
, d”ived.
	`size
());

544 
cout
 << 
’dl
;

547  
·ss
;

548 
	}
}

550 
boŞ
 
	$V®id©ePBKDF
()

552 
boŞ
 
·ss
 = 
Œue
;

556 
PBKDF_Te¡Tu¶e
 
‹¡S‘
[] =

570 
PKCS12_PBKDF
<
SHA1
> 
pbkdf
;

572 
cout
 << "\nPKCS #12 PBKDF validation suite„unning...\n\n";

573 
·ss
 = 
	`Te¡PBKDF
(
pbkdf
, 
‹¡S‘
, (testSet)/(testSet[0])) &&…ass;

578 
PBKDF_Te¡Tu¶e
 
‹¡S‘
[] =

584 
PKCS5_PBKDF2_HMAC
<
SHA1
> 
pbkdf
;

586 
cout
 << "\nPKCS #5 PBKDF2 validation suite„unning...\n\n";

587 
·ss
 = 
	`Te¡PBKDF
(
pbkdf
, 
‹¡S‘
, (testSet)/(testSet[0])) &&…ass;

590  
·ss
;

591 
	}
}

	@validate.h

1 #iâdeà
CRYPTOPP_VALIDATE_H


2 
	#CRYPTOPP_VALIDATE_H


	)

4 
	~"üy±lib.h
"

6 
boŞ
 
V®id©eAÎ
(boŞ 
thÜough
);

7 
boŞ
 
Te¡S‘tšgs
();

8 
boŞ
 
Te¡OS_RNG
();

9 
boŞ
 
V®id©eBa£Code
();

11 
boŞ
 
V®id©eCRC32
();

12 
boŞ
 
V®id©eAdËr32
();

13 
boŞ
 
V®id©eMD2
();

14 
boŞ
 
V®id©eMD4
();

15 
boŞ
 
V®id©eMD5
();

16 
boŞ
 
V®id©eSHA
();

17 
boŞ
 
V®id©eSHA2
();

18 
boŞ
 
V®id©eTig”
();

19 
boŞ
 
V®id©eRIPEMD
();

20 
boŞ
 
V®id©ePªama
();

21 
boŞ
 
V®id©eWhœÍoŞ
();

23 
boŞ
 
V®id©eHMAC
();

24 
boŞ
 
V®id©eTTMAC
();

26 
boŞ
 
V®id©eCh”Modes
();

27 
boŞ
 
V®id©ePBKDF
();

29 
boŞ
 
V®id©eDES
();

30 
boŞ
 
V®id©eIDEA
();

31 
boŞ
 
V®id©eSAFER
();

32 
boŞ
 
V®id©eRC2
();

33 
boŞ
 
V®id©eARC4
();

35 
boŞ
 
V®id©eRC5
();

36 
boŞ
 
V®id©eBlowfish
();

37 
boŞ
 
V®id©eTh»eWay
();

38 
boŞ
 
V®id©eGOST
();

39 
boŞ
 
V®id©eSHARK
();

40 
boŞ
 
V®id©eSEAL
();

41 
boŞ
 
V®id©eCAST
();

42 
boŞ
 
V®id©eSqu¬e
();

43 
boŞ
 
V®id©eSKIPJACK
();

44 
boŞ
 
V®id©eRC6
();

45 
boŞ
 
V®id©eMARS
();

46 
boŞ
 
V®id©eRijnd«l
();

47 
boŞ
 
V®id©eTwofish
();

48 
boŞ
 
V®id©eS”³Á
();

49 
boŞ
 
V®id©eSHACAL2
();

50 
boŞ
 
V®id©eCam–lŸ
();

51 
boŞ
 
V®id©eS®§
();

52 
boŞ
 
V®id©eSo£mªuk
();

53 
boŞ
 
V®id©eVMAC
();

54 
boŞ
 
V®id©eCCM
();

55 
boŞ
 
V®id©eGCM
();

56 
boŞ
 
V®id©eCMAC
();

58 
boŞ
 
V®id©eBBS
();

59 
boŞ
 
V®id©eDH
();

60 
boŞ
 
V®id©eMQV
();

61 
boŞ
 
V®id©eRSA
();

62 
boŞ
 
V®id©eElGam®
();

63 
boŞ
 
V®id©eDLIES
();

64 
boŞ
 
V®id©eNR
();

65 
boŞ
 
V®id©eDSA
(boŞ 
thÜough
);

66 
boŞ
 
V®id©eLUC
();

67 
boŞ
 
V®id©eLUC_DL
();

68 
boŞ
 
V®id©eLUC_DH
();

69 
boŞ
 
V®id©eXTR_DH
();

70 
boŞ
 
V®id©eRabš
();

71 
boŞ
 
V®id©eRW
();

73 
boŞ
 
V®id©eECP
();

74 
boŞ
 
V®id©eEC2N
();

75 
boŞ
 
V®id©eECDSA
();

76 
boŞ
 
V®id©eESIGN
();

78 
	gCry±oPP
::
RªdomNumb”G’”©Ü
 & 
Glob®RNG
();

79 
boŞ
 
RunTe¡D©aFe
(cÚ¡ *
f’ame
, cÚ¡ 
Cry±oPP
::
NameV®uePaœs
 &
ov”rideP¬am‘”s
=Cry±oPP::
g_nuÎNameV®uePaœs
, boŞ 
thÜough
=
Œue
);

	@vmac.cpp

4 
	~"pch.h
"

5 
	~"vmac.h
"

6 
	~"¬gÇmes.h
"

7 
	~"ıu.h
"

9 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

11 #ià
	`defšed
(
_MSC_VER
è&& !
CRYPTOPP_BOOL_SLOW_WORD64


12 
	~<šŒš.h
>

15 
	#VMAC_BOOL_WORD128
 (
	`defšed
(
CRYPTOPP_WORD128_AVAILABLE
è&& !defšed(
CRYPTOPP_X64_ASM_AVAILABLE
))

	)

16 #ifdeà
__BORLANDC__


19 cÚ¡ 
wÜd64
 
p64
 = 
	`W64LIT
(0xffffffffffffãff);

	)

20 cÚ¡ 
wÜd64
 
m62
 = 
	`W64LIT
(0x3fffffffffffffff);

21 cÚ¡ 
wÜd64
 
m63
 = 
	`W64LIT
(0x7fffffffffffffff);

22 cÚ¡ 
wÜd64
 
m64
 = 
	`W64LIT
(0xffffffffffffffff);

23 cÚ¡ 
wÜd64
 
mpŞy
 = 
	`W64LIT
(0x1fffffff1fffffff);

24 #ifdeà
__BORLANDC__


27 #ià
VMAC_BOOL_WORD128


28 #ifdeà
__pow”pc__


30 
	#m126
 ((
	`wÜd128
(
m62
)<<64)|
m64
)

	)

32 cÚ¡ 
wÜd128
 
m126
 = (
	`wÜd128
(
m62
)<<64)|
m64
;

36 
VMAC_Ba£
::
	$UncheckedS‘Key
(cÚ¡ 
by‹
 *
u£rKey
, 
keyËngth
, cÚ¡ 
NameV®uePaœs
 &
·¿ms
)

38 
dige¡L’gth
 = 
·¿ms
.
	`G‘IÁV®ueW™hDeçuÉ
(
Name
::
	`Dige¡Size
(), 
	`DeçuÉDige¡Size
());

39 ià(
dige¡L’gth
 != 8 && digestLength != 16)

40 
throw
 
	`Inv®idArgum’t
("VMAC: DigestSize must be 8 or 16");

41 
m_is128
 = 
dige¡L’gth
 == 16;

43 
m_L1KeyL’gth
 = 
·¿ms
.
	`G‘IÁV®ueW™hDeçuÉ
(
Name
::
	`L1KeyL’gth
(), 128);

44 ià(
m_L1KeyL’gth
 <= 0 || m_L1KeyLength % 128 != 0)

45 
throw
 
	`Inv®idArgum’t
("VMAC: L1KeyLength must be‡…ositive multiple of 128");

47 
	`AÎoÿ‹Blocks
();

49 
BlockCh”
 &
ch”
 = 
	`AcûssCh”
();

50 
ch”
.
	`S‘Key
(
u£rKey
, 
keyËngth
, 
·¿ms
);

51 
blockSize
 = 
ch”
.
	`BlockSize
();

52 
blockSizeInWÜds
 = 
blockSize
 / (
wÜd64
);

53 
SecBlock
<
wÜd64
> 
	`out
(
blockSizeInWÜds
);

54 
SecBy‹Block
 
š
;

55 
š
.
	`CËªNew
(
blockSize
);

56 
size_t
 
i
;

59 
š
[0] = 0x80;

60 
ch”
.
	`AdvªûdProûssBlocks
(
š
, 
NULL
, (
by‹
 *)
	`m_nhKey
(), 
	`m_nhKeySize
()*(
wÜd64
), ch”.
BT_InBlockIsCouÁ”
);

61 
CÚd™iÚ®By‹Rev”£
<
wÜd64
>(
BIG_ENDIAN_ORDER
, 
	`m_nhKey
(), m_nhKey(), 
	`m_nhKeySize
()*(word64));

64 
š
[0] = 0xC0;

65 
š
[15] = 0;

66 
i
 = 0; i <ğ(
size_t
)
m_is128
; i++)

68 
ch”
.
	`ProûssBlock
(
š
, 
out
.
	`By‹PŒ
());

69 
	`m_pŞyS‹
()[
i
*4+2] = 
G‘WÜd
<
wÜd64
>(
Œue
, 
BIG_ENDIAN_ORDER
, 
out
.
	`By‹PŒ
()è& 
mpŞy
;

70 
	`m_pŞyS‹
()[
i
*4+3] = 
G‘WÜd
<
wÜd64
>(
Œue
, 
BIG_ENDIAN_ORDER
, 
out
.
	`By‹PŒ
()+8è& 
mpŞy
;

71 
š
[15]++;

75 
š
[0] = 0xE0;

76 
š
[15] = 0;

77 
wÜd64
 *
l3Key
 = 
	`m_l3Key
();

78 
i
 = 0; i <ğ(
size_t
)
m_is128
; i++)

81 
ch”
.
	`ProûssBlock
(
š
, 
out
.
	`By‹PŒ
());

82 
l3Key
[
i
*2+0] = 
G‘WÜd
<
wÜd64
>(
Œue
, 
BIG_ENDIAN_ORDER
, 
out
.
	`By‹PŒ
());

83 
l3Key
[
i
*2+1] = 
G‘WÜd
<
wÜd64
>(
Œue
, 
BIG_ENDIAN_ORDER
, 
out
.
	`By‹PŒ
()+8);

84 
š
[15]++;

85 } (
l3Key
[
i
*2+0] >ğ
p64
) || (l3Key[i*2+1] >=…64));

87 
m_·dCached
 = 
çl£
;

88 
size_t
 
nÚûL’gth
;

89 cÚ¡ 
by‹
 *
nÚû
 = 
	`G‘IVAndThrowIfInv®id
(
·¿ms
, 
nÚûL’gth
);

90 
	`ResynchrÚize
(
nÚû
, ()
nÚûL’gth
);

91 
	}
}

93 
	gVMAC_Ba£
::
	$G‘NextIV
(
RªdomNumb”G’”©Ü
 &
ºg
, 
by‹
 *
IV
)

95 
Sim¶eKeyšgIÁ”çû
::
	`G‘NextIV
(
ºg
, 
IV
);

96 
IV
[0] &= 0x7f;

97 
	}
}

99 
	gVMAC_Ba£
::
	$ResynchrÚize
(cÚ¡ 
by‹
 *
nÚû
, 
Ën
)

101 
size_t
 
Ëngth
 = 
	`ThrowIfInv®idIVL’gth
(
Ën
);

102 
size_t
 
s
 = 
	`IVSize
();

103 
by‹
 *
¡ÜedNÚû
 = 
	`m_nÚû
();

105 ià(
m_is128
)

107 
	`mem£t
(
¡ÜedNÚû
, 0, 
s
-
Ëngth
);

108 
	`memıy
(
¡ÜedNÚû
+
s
-
Ëngth
, 
nÚû
,†ength);

109 
	`AcûssCh”
().
	`ProûssBlock
(
¡ÜedNÚû
, 
	`m_·d
());

113 ià(
m_·dCached
 && (
¡ÜedNÚû
[
s
-1] | 1è=ğ(
nÚû
[
Ëngth
-1] | 1))

115 
m_·dCached
 = 
	`V”ifyBufsEqu®
(
¡ÜedNÚû
+
s
-
Ëngth
, 
nÚû
,†ength-1);

116 
size_t
 
i
=0; 
m_·dCached
 && i<
s
-
Ëngth
; i++)

117 
m_·dCached
 = (
¡ÜedNÚû
[
i
] == 0);

119 ià(!
m_·dCached
)

121 
	`mem£t
(
¡ÜedNÚû
, 0, 
s
-
Ëngth
);

122 
	`memıy
(
¡ÜedNÚû
+
s
-
Ëngth
, 
nÚû
,†ength-1);

123 
¡ÜedNÚû
[
s
-1] = 
nÚû
[
Ëngth
-1] & 0xfe;

124 
	`AcûssCh”
().
	`ProûssBlock
(
¡ÜedNÚû
, 
	`m_·d
());

125 
m_·dCached
 = 
Œue
;

127 
¡ÜedNÚû
[
s
-1] = 
nÚû
[
Ëngth
-1];

129 
m_isFœ¡Block
 = 
Œue
;

130 
	`Re¡¬t
();

131 
	}
}

133 
	gVMAC_Ba£
::
	$HashEndŸnCÜ»ùedBlock
(cÚ¡ 
wÜd64
 *
d©a
)

135 
	`as£¹
(
çl£
);

136 
throw
 0;

137 
	}
}

139 #ià
CRYPTOPP_BOOL_SSE2_ASM_AVAILABLE
 && 
CRYPTOPP_BOOL_X86


140 #´agm¨
w¬nšg
(
di§bË
: 4731)

142 #ifdeà
__GNUC__


143 
__©Œibu‹__
 ((
nošlše
))

145 
	gVMAC_Ba£
::
	$VHASH_Upd©e_SSE2
(cÚ¡ 
wÜd64
 *
d©a
, 
size_t
 
blocksRemaššgInWÜd64
, 
gP¬t
)

147 cÚ¡ 
wÜd64
 *
nhK
 = 
	`m_nhKey
();

148 
wÜd64
 *
pŞyS
 = 
	`m_pŞyS‹
();

149 
wÜd32
 
L1KeyL’gth
 = 
m_L1KeyL’gth
;

151 #ifdeà
__GNUC__


152 
wÜd32
 
‹mp
;

153 
__asm__
 
__vŞ©e__


155 
	`AS2
Ğ
mov
 %%
ebx
, %0)

156 
	`AS2
Ğ
mov
 %1, %%
ebx
)

159 #ià
_MSC_VER
 < 1300 || 
	`defšed
(
__INTEL_COMPILER
)

160 
isFœ¡Block
 = 
m_isFœ¡Block
;

161 
	`AS2
Ğ
mov
 
ebx
, [
L1KeyL’gth
])

162 
	`AS2
Ğ
mov
 
dl
, [
isFœ¡Block
])

164 
	`AS2
Ğ
mov
 
ecx
, 
this
)

165 
	`AS2
Ğ
mov
 
ebx
, [
ecx
+
m_L1KeyL’gth
])

166 
	`AS2
Ğ
mov
 
dl
, [
ecx
+
m_isFœ¡Block
])

168 
	`AS2
Ğ
mov
 
—x
, 
gP¬t
)

169 
	`AS2
Ğ
shl
 
—x
, 4)

170 
	`AS2
Ğ
mov
 
edi
, 
nhK
)

171 
	`AS2
Ğ
add
 
edi
, 
—x
)

172 
	`AS2
Ğ
add
 
—x
,ƒax)

173 
	`AS2
Ğ
add
 
—x
, 
pŞyS
)

175 
	`AS2
Ğ
mov
 
esi
, 
d©a
)

176 
	`AS2
Ğ
mov
 
ecx
, 
blocksRemaššgInWÜd64
)

179 
	`AS2
Ğ
shr
 
ebx
, 3)

180 
	`AS1
Ğ
push
 
ebp
)

181 
	`AS2
Ğ
sub
 
e¥
, 12)

182 
	`ASL
(4)

183 
	`AS2
Ğ
mov
 
ebp
, 
ebx
)

184 
	`AS2
Ğ
cmp
 
ecx
, 
ebx
)

185 
	`AS2
Ğ
cmovl
 
ebp
, 
ecx
)

186 
	`AS2
Ğ
sub
 
ecx
, 
ebp
)

187 
	`AS2
Ğ
Ëa
 
ebp
, [
edi
+8*ebp])

188 
	`AS2
Ğ
movq
 
mm6
, [
esi
])

189 
	`AS2
Ğ
·ddq
 
mm6
, [
edi
])

190 
	`AS2
Ğ
movq
 
mm5
, [
esi
+8])

191 
	`AS2
Ğ
·ddq
 
mm5
, [
edi
+8])

192 
	`AS2
Ğ
add
 
esi
, 16)

193 
	`AS2
Ğ
add
 
edi
, 16)

194 
	`AS2
Ğ
movq
 
mm4
, 
mm6
)

195 
	`ASS
Ğ
pshufw
 
mm2
, 
mm6
, 1, 0, 3, 2)

196 
	`AS2
Ğ
pmuludq
 
mm6
, 
mm5
)

197 
	`ASS
Ğ
pshufw
 
mm3
, 
mm5
, 1, 0, 3, 2)

198 
	`AS2
Ğ
pmuludq
 
mm5
, 
mm2
)

199 
	`AS2
Ğ
pmuludq
 
mm2
, 
mm3
)

200 
	`AS2
Ğ
pmuludq
 
mm3
, 
mm4
)

201 
	`AS2
Ğ
pxÜ
 
mm7
, mm7)

202 
	`AS2
Ğ
movd
 [
e¥
], 
mm6
)

203 
	`AS2
Ğ
p¤lq
 
mm6
, 32)

204 
	`AS2
Ğ
movd
 [
e¥
+4], 
mm5
)

205 
	`AS2
Ğ
p¤lq
 
mm5
, 32)

206 
	`AS2
Ğ
cmp
 
edi
, 
ebp
)

207 
	`ASJ
Ğ
je
, 1, 
f
)

208 
	`ASL
(0)

209 
	`AS2
Ğ
movq
 
mm0
, [
esi
])

210 
	`AS2
Ğ
·ddq
 
mm0
, [
edi
])

211 
	`AS2
Ğ
movq
 
mm1
, [
esi
+8])

212 
	`AS2
Ğ
·ddq
 
mm1
, [
edi
+8])

213 
	`AS2
Ğ
add
 
esi
, 16)

214 
	`AS2
Ğ
add
 
edi
, 16)

215 
	`AS2
Ğ
movq
 
mm4
, 
mm0
)

216 
	`AS2
Ğ
·ddq
 
mm5
, 
mm2
)

217 
	`ASS
Ğ
pshufw
 
mm2
, 
mm0
, 1, 0, 3, 2)

218 
	`AS2
Ğ
pmuludq
 
mm0
, 
mm1
)

219 
	`AS2
Ğ
movd
 [
e¥
+8], 
mm3
)

220 
	`AS2
Ğ
p¤lq
 
mm3
, 32)

221 
	`AS2
Ğ
·ddq
 
mm5
, 
mm3
)

222 
	`ASS
Ğ
pshufw
 
mm3
, 
mm1
, 1, 0, 3, 2)

223 
	`AS2
Ğ
pmuludq
 
mm1
, 
mm2
)

224 
	`AS2
Ğ
pmuludq
 
mm2
, 
mm3
)

225 
	`AS2
Ğ
pmuludq
 
mm3
, 
mm4
)

226 
	`AS2
Ğ
movd
 
mm4
, [
e¥
])

227 
	`AS2
Ğ
·ddq
 
mm7
, 
mm4
)

228 
	`AS2
Ğ
movd
 
mm4
, [
e¥
+4])

229 
	`AS2
Ğ
·ddq
 
mm6
, 
mm4
)

230 
	`AS2
Ğ
movd
 
mm4
, [
e¥
+8])

231 
	`AS2
Ğ
·ddq
 
mm6
, 
mm4
)

232 
	`AS2
Ğ
movd
 [
e¥
], 
mm0
)

233 
	`AS2
Ğ
p¤lq
 
mm0
, 32)

234 
	`AS2
Ğ
·ddq
 
mm6
, 
mm0
)

235 
	`AS2
Ğ
movd
 [
e¥
+4], 
mm1
)

236 
	`AS2
Ğ
p¤lq
 
mm1
, 32)

237 
	`AS2
Ğ
·ddq
 
mm5
, 
mm1
)

238 
	`AS2
Ğ
cmp
 
edi
, 
ebp
)

239 
	`ASJ
Ğ
jÃ
, 0, 
b
)

240 
	`ASL
(1)

241 
	`AS2
Ğ
·ddq
 
mm5
, 
mm2
)

242 
	`AS2
Ğ
movd
 [
e¥
+8], 
mm3
)

243 
	`AS2
Ğ
p¤lq
 
mm3
, 32)

244 
	`AS2
Ğ
·ddq
 
mm5
, 
mm3
)

245 
	`AS2
Ğ
movd
 
mm4
, [
e¥
])

246 
	`AS2
Ğ
·ddq
 
mm7
, 
mm4
)

247 
	`AS2
Ğ
movd
 
mm4
, [
e¥
+4])

248 
	`AS2
Ğ
·ddq
 
mm6
, 
mm4
)

249 
	`AS2
Ğ
movd
 
mm4
, [
e¥
+8])

250 
	`AS2
Ğ
·ddq
 
mm6
, 
mm4
)

251 
	`AS2
Ğ
Ëa
 
ebp
, [8*
ebx
])

252 
	`AS2
Ğ
sub
 
edi
, 
ebp
)

254 
	`AS2
Ğ
movd
 [
e¥
], 
mm7
)

255 
	`AS2
Ğ
p¤lq
 
mm7
, 32)

256 
	`AS2
Ğ
·ddq
 
mm6
, 
mm7
)

257 
	`AS2
Ğ
movd
 [
e¥
+4], 
mm6
)

258 
	`AS2
Ğ
p¤lq
 
mm6
, 32)

259 
	`AS2
Ğ
·ddq
 
mm5
, 
mm6
)

260 
	`AS2
Ğ
p¦lq
 
mm5
, 2)

261 
	`AS2
Ğ
p¤lq
 
mm5
, 2)

263 
	#a0
 [
—x
+2*4]

	)

264 
	#a1
 [
—x
+3*4]

	)

265 
	#a2
 [
—x
+0*4]

	)

266 
	#a3
 [
—x
+1*4]

	)

267 
	#k0
 [
—x
+2*8+2*4]

	)

268 
	#k1
 [
—x
+2*8+3*4]

	)

269 
	#k2
 [
—x
+2*8+0*4]

	)

270 
	#k3
 [
—x
+2*8+1*4]

	)

271 
	`AS2
Ğ
‹¡
 
dl
, dl)

272 
	`ASJ
Ğ
jz
, 2, 
f
)

273 
	`AS2
Ğ
movd
 
mm1
, 
k0
)

274 
	`AS2
Ğ
movd
 
mm0
, [
e¥
])

275 
	`AS2
Ğ
·ddq
 
mm0
, 
mm1
)

276 
	`AS2
Ğ
movd
 
a0
, 
mm0
)

277 
	`AS2
Ğ
p¤lq
 
mm0
, 32)

278 
	`AS2
Ğ
movd
 
mm1
, 
k1
)

279 
	`AS2
Ğ
movd
 
mm2
, [
e¥
+4])

280 
	`AS2
Ğ
·ddq
 
mm1
, 
mm2
)

281 
	`AS2
Ğ
·ddq
 
mm0
, 
mm1
)

282 
	`AS2
Ğ
movd
 
a1
, 
mm0
)

283 
	`AS2
Ğ
p¤lq
 
mm0
, 32)

284 
	`AS2
Ğ
·ddq
 
mm5
, 
k2
)

285 
	`AS2
Ğ
·ddq
 
mm0
, 
mm5
)

286 
	`AS2
Ğ
movq
 
a2
, 
mm0
)

287 
	`AS2
Ğ
xÜ
 
edx
,ƒdx)

288 
	`ASJ
Ğ
jmp
, 3, 
f
)

289 
	`ASL
(2)

290 
	`AS2
Ğ
movd
 
mm0
, 
a3
)

291 
	`AS2
Ğ
movq
 
mm4
, 
mm0
)

292 
	`AS2
Ğ
pmuludq
 
mm0
, 
k3
)

293 
	`AS2
Ğ
movd
 
mm1
, 
a0
)

294 
	`AS2
Ğ
pmuludq
 
mm1
, 
k2
)

295 
	`AS2
Ğ
movd
 
mm2
, 
a1
)

296 
	`AS2
Ğ
movd
 
mm6
, 
k1
)

297 
	`AS2
Ğ
pmuludq
 
mm2
, 
mm6
)

298 
	`AS2
Ğ
movd
 
mm3
, 
a2
)

299 
	`AS2
Ğ
p¦lq
 
mm0
, 1)

300 
	`AS2
Ğ
·ddq
 
mm0
, 
mm5
)

301 
	`AS2
Ğ
movq
 
mm5
, 
mm3
)

302 
	`AS2
Ğ
movd
 
mm7
, 
k0
)

303 
	`AS2
Ğ
pmuludq
 
mm3
, 
mm7
)

304 
	`AS2
Ğ
pmuludq
 
mm4
, 
mm7
)

305 
	`AS2
Ğ
pmuludq
 
mm5
, 
mm6
)

306 
	`AS2
Ğ
·ddq
 
mm0
, 
mm1
)

307 
	`AS2
Ğ
movd
 
mm1
, 
a1
)

308 
	`AS2
Ğ
·ddq
 
mm4
, 
mm5
)

309 
	`AS2
Ğ
movq
 
mm5
, 
mm1
)

310 
	`AS2
Ğ
pmuludq
 
mm1
, 
k2
)

311 
	`AS2
Ğ
·ddq
 
mm0
, 
mm2
)

312 
	`AS2
Ğ
movd
 
mm2
, 
a0
)

313 
	`AS2
Ğ
·ddq
 
mm0
, 
mm3
)

314 
	`AS2
Ğ
movq
 
mm3
, 
mm2
)

315 
	`AS2
Ğ
pmuludq
 
mm2
, 
k3
)

316 
	`AS2
Ğ
pmuludq
 
mm3
, 
mm7
)

317 
	`AS2
Ğ
movd
 [
e¥
+8], 
mm0
)

318 
	`AS2
Ğ
p¤lq
 
mm0
, 32)

319 
	`AS2
Ğ
pmuludq
 
mm7
, 
mm5
)

320 
	`AS2
Ğ
pmuludq
 
mm5
, 
k3
)

321 
	`AS2
Ğ
·ddq
 
mm0
, 
mm1
)

322 
	`AS2
Ğ
movd
 
mm1
, 
a2
)

323 
	`AS2
Ğ
pmuludq
 
mm1
, 
k2
)

324 
	`AS2
Ğ
·ddq
 
mm0
, 
mm2
)

325 
	`AS2
Ğ
·ddq
 
mm0
, 
mm4
)

326 
	`AS2
Ğ
movq
 
mm4
, 
mm0
)

327 
	`AS2
Ğ
movd
 
mm2
, 
a3
)

328 
	`AS2
Ğ
pmuludq
 
mm2
, 
mm6
)

329 
	`AS2
Ğ
pmuludq
 
mm6
, 
a0
)

330 
	`AS2
Ğ
p¤lq
 
mm0
, 31)

331 
	`AS2
Ğ
·ddq
 
mm0
, 
mm3
)

332 
	`AS2
Ğ
movd
 
mm3
, [
e¥
])

333 
	`AS2
Ğ
·ddq
 
mm0
, 
mm3
)

334 
	`AS2
Ğ
movd
 
mm3
, 
a2
)

335 
	`AS2
Ğ
pmuludq
 
mm3
, 
k3
)

336 
	`AS2
Ğ
·ddq
 
mm5
, 
mm1
)

337 
	`AS2
Ğ
movd
 
mm1
, 
a3
)

338 
	`AS2
Ğ
pmuludq
 
mm1
, 
k2
)

339 
	`AS2
Ğ
·ddq
 
mm5
, 
mm2
)

340 
	`AS2
Ğ
movd
 
mm2
, [
e¥
+4])

341 
	`AS2
Ğ
p¦lq
 
mm5
, 1)

342 
	`AS2
Ğ
·ddq
 
mm0
, 
mm5
)

343 
	`AS2
Ğ
p¦lq
 
mm4
, 33)

344 
	`AS2
Ğ
movd
 
a0
, 
mm0
)

345 
	`AS2
Ğ
p¤lq
 
mm0
, 32)

346 
	`AS2
Ğ
·ddq
 
mm6
, 
mm7
)

347 
	`AS2
Ğ
movd
 
mm7
, [
e¥
+8])

348 
	`AS2
Ğ
·ddq
 
mm0
, 
mm6
)

349 
	`AS2
Ğ
·ddq
 
mm0
, 
mm2
)

350 
	`AS2
Ğ
·ddq
 
mm3
, 
mm1
)

351 
	`AS2
Ğ
p¦lq
 
mm3
, 1)

352 
	`AS2
Ğ
·ddq
 
mm0
, 
mm3
)

353 
	`AS2
Ğ
p¤lq
 
mm4
, 1)

354 
	`AS2
Ğ
movd
 
a1
, 
mm0
)

355 
	`AS2
Ğ
p¤lq
 
mm0
, 32)

356 
	`AS2
Ğ
pÜ
 
mm4
, 
mm7
)

357 
	`AS2
Ğ
·ddq
 
mm0
, 
mm4
)

358 
	`AS2
Ğ
movq
 
a2
, 
mm0
)

359 #undeà
a0


360 #undeà
a1


361 #undeà
a2


362 #undeà
a3


363 #undeà
k0


364 #undeà
k1


365 #undeà
k2


366 #undeà
k3


368 
	`ASL
(3)

369 
	`AS2
Ğ
‹¡
 
ecx
,ƒcx)

370 
	`ASJ
Ğ
jnz
, 4, 
b
)

372 
	`AS2
Ğ
add
 
e¥
, 12)

373 
	`AS1
Ğ
pİ
 
ebp
)

374 
	`AS1
Ğ
emms
)

375 #ifdeà
__GNUC__


377 
	`AS2
Ğ
mov
 %0, %%
ebx
)

378 : "=m" (
‹mp
)

379 : "m" (
L1KeyL’gth
), "c" (
blocksRemaššgInWÜd64
), "S" (
d©a
), "D" (
nhK
+
gP¬t
*2), "d" (
m_isFœ¡Block
), "a" (
pŞyS
+tagPart*4)

383 
	}
}

386 #ià
VMAC_BOOL_WORD128


387 
	#Deş¬eNH
(
a
è
wÜd128
‡=0

	)

388 
	#MUL64
(
rh
,
¾
,
i1
,
i2
è{
wÜd128
 
p
 = 
	`wÜd128
(i1)*(i2);„h = 
	`wÜd64
Õ>>64);„ÈğwÜd64Õ);}

	)

389 
	#AccumuÏ‹NH
(
a
, 
b
, 
c
è¨+ğ
	`wÜd128
(b)*(c)

	)

390 
	#MuÉly128
(
r
, 
i1
, 
i2
è¸ğ
	`wÜd128
(
	`wÜd64
(i1)è* wÜd64(i2)

	)

392 #ià
_MSC_VER
 >ğ1400 && !
defšed
(
__INTEL_COMPILER
)

393 
	#MUL32
(
a
, 
b
è
	`__emulu
(
	`wÜd32
×), wÜd32(b))

	)

395 
	#MUL32
(
a
, 
b
è((
wÜd64
)((
wÜd32
)×)è* (wÜd32)(b))

	)

397 #ià
defšed
(
CRYPTOPP_X64_ASM_AVAILABLE
)

398 
	#Deş¬eNH
(
a
è
wÜd64
‡##0=0,‡##1=0

	)

399 
	#MUL64
(
rh
,
¾
,
i1
,
i2
è
	`asm
 ("mulq %3" : "÷"Ôl), "=d"Ôhè: "a"(i1), "g"(i2è: "cc");

	)

400 
	#AccumuÏ‹NH
(
a
, 
b
, 
c
è
	`asm
 ("mulq %3;‡ddq %%¿x, %0;‡dcq %%rdx, %1" : "+r"×##0), "+r"×##1è: "a"(b), "g"(cè: "%rdx", "cc");

	)

401 
	#ADD128
(
rh
,
¾
,
ih
,

è
	`asm
 ("addq %3, %1;‡dcq %2, %0" : "+r"Ôh),"+r"Ôlè: "r"(ih),"r"(è: "cc");

	)

402 #–ià
defšed
(
_MSC_VER
è&& !
CRYPTOPP_BOOL_SLOW_WORD64


403 
	#Deş¬eNH
(
a
è
wÜd64
‡##0=0,‡##1=0

	)

404 
	#MUL64
(
rh
,
¾
,
i1
,
i2
èÔlèğ
	`_umul128
(i1,i2,&Ôh));

	)

405 
	#AccumuÏ‹NH
(
a
, 
b
, 
c
) {\

406 
wÜd64
 
ph
, 
¶
;\

407 
¶
 = 
	`_umul128
(
b
,
c
,&
ph
);\

408 
a
##0 +ğ
¶
;\

409 
a
##1 +ğ
ph
 + (a##0 < 
¶
);}

	)

411 
	#VMAC_BOOL_32BIT
 1

	)

412 
	#Deş¬eNH
(
a
è
wÜd64
‡##0=0,‡##1=0,‡##2=0

	)

413 
	#MUL64
(
rh
,
¾
,
i1
,
i2
) \

414 { 
wÜd64
 
_i1
 = (
i1
), 
_i2
 = (
i2
); \

415 
wÜd64
 
m1
ğ
	`MUL32
(
_i1
,
_i2
>>32); \

416 
wÜd64
 
m2
ğ
	`MUL32
(
_i1
>>32,
_i2
); \

417 
rh
 = 
	`MUL32
(
_i1
>>32,
_i2
>>32); \

418 
¾
 = 
	`MUL32
(
_i1
,
_i2
); \

419 
	`ADD128
(
rh
,
¾
,(
m1
 >> 32),(m1 << 32)); \

420 
	`ADD128
(
rh
,
¾
,(
m2
 >> 32),(m2 << 32)); \

421 }

	)

422 
	#AccumuÏ‹NH
(
a
, 
b
, 
c
) {\

423 
wÜd64
 
p
 = 
	`MUL32
(
b
, 
c
);\

424 
a
##1 +ğ
	`wÜd32
((
p
)>>32);\

425 
a
##0 +ğ
	`wÜd32
(
p
);\

426 
p
 = 
	`MUL32
((
b
)>>32, 
c
);\

427 
a
##2 +ğ
	`wÜd32
((
p
)>>32);\

428 
a
##1 +ğ
	`wÜd32
(
p
);\

429 
p
 = 
	`MUL32
((
b
)>>32, (
c
)>>32);\

430 
a
##2 +ğ
p
;\

431 
p
 = 
	`MUL32
(
b
, (
c
)>>32);\

432 
a
##1 +ğ
	`wÜd32
(
p
);\

433 
a
##2 +ğ
	`wÜd32
(
p
>>32);}

	)

436 #iâdeà
VMAC_BOOL_32BIT


437 
	#VMAC_BOOL_32BIT
 0

	)

439 #iâdeà
ADD128


440 
	#ADD128
(
rh
,
¾
,
ih
,

) \

441 { 
wÜd64
 
_
 = (

); \

442 (
¾
è+ğ(
_
); \

443 (
rh
è+ğ(
ih
è+ ((
¾
è< (
_
)); \

444 }

	)

447 #ià!(
defšed
(
_MSC_VER
) && _MSC_VER < 1300)

448 
	g‹m¶©e
 <
boŞ
 
	gT_128B™Tag
>

450 
	gVMAC_Ba£
::
	$VHASH_Upd©e_Tem¶©e
(cÚ¡ 
wÜd64
 *
d©a
, 
size_t
 
blocksRemaššgInWÜd64
)

452 
	#INNER_LOOP_ITERATION
(
j
) {\

453 
wÜd64
 
d0
 = 
	`CÚd™iÚ®By‹Rev”£
(
LITTLE_ENDIAN_ORDER
, 
d©a
[
i
+2*
j
+0]);\

454 
wÜd64
 
d1
 = 
	`CÚd™iÚ®By‹Rev”£
(
LITTLE_ENDIAN_ORDER
, 
d©a
[
i
+2*
j
+1]);\

455 
	`AccumuÏ‹NH
(
nhA
, 
d0
+
nhK
[
i
+2*
j
+0], 
d1
+nhK[i+2*j+1]);\

456 ià(
T_128B™Tag
)\

457 
	`AccumuÏ‹NH
(
nhB
, 
d0
+
nhK
[
i
+2*
j
+2], 
d1
+nhK[i+2*j+3]);\

458 }

	)

460 #ià(
	`defšed
(
_MSC_VER
) && _MSC_VER < 1300)

461 
boŞ
 
T_128B™Tag
 = 
m_is128
;

463 
size_t
 
L1KeyL’gthInWÜd64
 = 
m_L1KeyL’gth
 / 8;

464 
size_t
 
šÃrLoİEnd
 = 
L1KeyL’gthInWÜd64
;

465 cÚ¡ 
wÜd64
 *
nhK
 = 
	`m_nhKey
();

466 
wÜd64
 *
pŞyS
 = 
	`m_pŞyS‹
();

467 
boŞ
 
isFœ¡Block
 = 
Œue
;

468 
size_t
 
i
;

470 #ià!
VMAC_BOOL_32BIT


471 #ià
VMAC_BOOL_WORD128


472 
wÜd128
 
a1
, 
a2
;

474 
wÜd64
 
ah1
, 
®1
, 
ah2
, 
®2
;

476 
wÜd64
 
kh1
, 
kl1
, 
kh2
, 
kl2
;

477 
kh1
=(
pŞyS
+0*4+2)[0]; 
kl1
=(polyS+0*4+2)[1];

478 ià(
T_128B™Tag
)

480 
kh2
=(
pŞyS
+1*4+2)[0]; 
kl2
=(polyS+1*4+2)[1];

486 
	`Deş¬eNH
(
nhA
);

487 
	`Deş¬eNH
(
nhB
);

489 
i
 = 0;

490 ià(
blocksRemaššgInWÜd64
 < 
L1KeyL’gthInWÜd64
)

492 ià(
blocksRemaššgInWÜd64
 % 8)

494 
šÃrLoİEnd
 = 
blocksRemaššgInWÜd64
 % 8;

495 ; 
i
<
šÃrLoİEnd
; i+=2)

496 
	`INNER_LOOP_ITERATION
(0);

498 
šÃrLoİEnd
 = 
blocksRemaššgInWÜd64
;

500 ; 
i
<
šÃrLoİEnd
; i+=8)

502 
	`INNER_LOOP_ITERATION
(0);

503 
	`INNER_LOOP_ITERATION
(1);

504 
	`INNER_LOOP_ITERATION
(2);

505 
	`INNER_LOOP_ITERATION
(3);

507 
blocksRemaššgInWÜd64
 -ğ
šÃrLoİEnd
;

508 
d©a
 +ğ
šÃrLoİEnd
;

510 #ià
VMAC_BOOL_32BIT


511 
wÜd32
 
nh0
[2], 
nh1
[2];

512 
wÜd64
 
nh2
[2];

514 
nh0
[0] = 
	`wÜd32
(
nhA0
);

515 
nhA1
 +ğ(
nhA0
 >> 32);

516 
nh1
[0] = 
	`wÜd32
(
nhA1
);

517 
nh2
[0] = (
nhA2
 + (
nhA1
 >> 32)è& 
m62
;

519 ià(
T_128B™Tag
)

521 
nh0
[1] = 
	`wÜd32
(
nhB0
);

522 
nhB1
 +ğ(
nhB0
 >> 32);

523 
nh1
[1] = 
	`wÜd32
(
nhB1
);

524 
nh2
[1] = (
nhB2
 + (
nhB1
 >> 32)è& 
m62
;

527 
	#a0
 (((
wÜd32
 *)(
pŞyS
+
i
*4))[2+
N©iveBy‹Ord”
::
	`ToEnum
()])

	)

528 
	#a1
 (*(((
wÜd32
 *)(
pŞyS
+
i
*4))+3-
N©iveBy‹Ord”
::
	`ToEnum
()))

529 
	#a2
 (((
wÜd32
 *)(
pŞyS
+
i
*4))[0+
N©iveBy‹Ord”
::
	`ToEnum
()])

	)

530 
	#a3
 (*(((
wÜd32
 *)(
pŞyS
+
i
*4))+1-
N©iveBy‹Ord”
::
	`ToEnum
()))

	)

531 
	#aHi
 ((
pŞyS
+
i
*4)[0])

	)

532 
	#k0
 (((
wÜd32
 *)(
pŞyS
+
i
*4+2))[2+
N©iveBy‹Ord”
::
	`ToEnum
()])

	)

533 
	#k1
 (*(((
wÜd32
 *)(
pŞyS
+
i
*4+2))+3-
N©iveBy‹Ord”
::
	`ToEnum
()))

	)

534 
	#k2
 (((
wÜd32
 *)(
pŞyS
+
i
*4+2))[0+
N©iveBy‹Ord”
::
	`ToEnum
()])

	)

535 
	#k3
 (*(((
wÜd32
 *)(
pŞyS
+
i
*4+2))+1-
N©iveBy‹Ord”
::
	`ToEnum
()))

	)

536 
	#kHi
 ((
pŞyS
+
i
*4+2)[0])

	)

538 ià(
isFœ¡Block
)

540 
isFœ¡Block
 = 
çl£
;

541 ià(
m_isFœ¡Block
)

543 
m_isFœ¡Block
 = 
çl£
;

544 
i
=0; i<=(
size_t
)
T_128B™Tag
; i++)

546 
wÜd64
 
t
 = (wÜd64)
nh0
[
i
] + 
k0
;

547 
a0
 = (
wÜd32
)
t
;

548 
t
 = (ˆ>> 32è+ 
nh1
[
i
] + 
k1
;

549 
a1
 = (
wÜd32
)
t
;

550 
aHi
 = (
t
 >> 32è+ 
nh2
[
i
] + 
kHi
;

555 
i
=0; i<=(
size_t
)
T_128B™Tag
; i++)

557 
wÜd64
 
p
, 
t
;

558 
wÜd32
 
t2
;

560 
p
 = 
	`MUL32
(
a3
, 2*
k3
);

561 
p
 +ğ
nh2
[
i
];

562 
p
 +ğ
	`MUL32
(
a0
, 
k2
);

563 
p
 +ğ
	`MUL32
(
a1
, 
k1
);

564 
p
 +ğ
	`MUL32
(
a2
, 
k0
);

565 
t2
 = (
wÜd32
)
p
;

566 
p
 >>= 32;

567 
p
 +ğ
	`MUL32
(
a0
, 
k3
);

568 
p
 +ğ
	`MUL32
(
a1
, 
k2
);

569 
p
 +ğ
	`MUL32
(
a2
, 
k1
);

570 
p
 +ğ
	`MUL32
(
a3
, 
k0
);

571 
t
 = (
	`wÜd64
(
	`wÜd32
(
p
è& 0x7fffffffè<< 32è| 
t2
;

572 
p
 >>= 31;

573 
p
 +ğ
nh0
[
i
];

574 
p
 +ğ
	`MUL32
(
a0
, 
k0
);

575 
p
 +ğ
	`MUL32
(
a1
, 2*
k3
);

576 
p
 +ğ
	`MUL32
(
a2
, 2*
k2
);

577 
p
 +ğ
	`MUL32
(
a3
, 2*
k1
);

578 
t2
 = (
wÜd32
)
p
;

579 
p
 >>= 32;

580 
p
 +ğ
nh1
[
i
];

581 
p
 +ğ
	`MUL32
(
a0
, 
k1
);

582 
p
 +ğ
	`MUL32
(
a1
, 
k0
);

583 
p
 +ğ
	`MUL32
(
a2
, 2*
k3
);

584 
p
 +ğ
	`MUL32
(
a3
, 2*
k2
);

585 
a0
 = 
t2
;

586 
a1
 = (
wÜd32
)
p
;

587 
aHi
 = (
p
 >> 32è+ 
t
;

590 #undeà
a0


591 #undeà
a1


592 #undeà
a2


593 #undeà
a3


594 #undeà
aHi


595 #undeà
k0


596 #undeà
k1


597 #undeà
k2


598 #undeà
k3


599 #undeà
kHi


601 ià(
isFœ¡Block
)

603 
isFœ¡Block
 = 
çl£
;

604 ià(
m_isFœ¡Block
)

606 
m_isFœ¡Block
 = 
çl£
;

607 #ià
VMAC_BOOL_WORD128


608 
	#fœ¡_pŞy_¡•
(
a
, 
kh
, 
kl
, 
m
è¨ğ(m & 
m126
è+ ((
	`wÜd128
(khè<< 64è| kl)

	)

610 
	`fœ¡_pŞy_¡•
(
a1
, 
kh1
, 
kl1
, 
nhA
);

611 ià(
T_128B™Tag
)

612 
	`fœ¡_pŞy_¡•
(
a2
, 
kh2
, 
kl2
, 
nhB
);

614 
	#fœ¡_pŞy_¡•
(
ah
, 
®
, 
kh
, 
kl
, 
mh
, 
ml
) {\

615 
mh
 &ğ
m62
;\

616 
	`ADD128
(
mh
, 
ml
, 
kh
, 
kl
); \

617 
ah
 = 
mh
; 
®
 = 
ml
;}

	)

619 
	`fœ¡_pŞy_¡•
(
ah1
, 
®1
, 
kh1
, 
kl1
, 
nhA1
, 
nhA0
);

620 ià(
T_128B™Tag
)

621 
	`fœ¡_pŞy_¡•
(
ah2
, 
®2
, 
kh2
, 
kl2
, 
nhB1
, 
nhB0
);

627 #ià
VMAC_BOOL_WORD128


628 
a1
 = (
	`wÜd128
((
pŞyS
+0*4)[0]) << 64) | (polyS+0*4)[1];

630 
ah1
=(
pŞyS
+0*4)[0]; 
®1
=(polyS+0*4)[1];

632 ià(
T_128B™Tag
)

634 #ià
VMAC_BOOL_WORD128


635 
a2
 = (
	`wÜd128
((
pŞyS
+1*4)[0]) << 64) | (polyS+1*4)[1];

637 
ah2
=(
pŞyS
+1*4)[0]; 
®2
=(polyS+1*4)[1];

643 #ià
VMAC_BOOL_WORD128


644 
	#pŞy_¡•
(
a
, 
kh
, 
kl
, 
m
) \

645 { 
wÜd128
 
t1
, 
t2
, 
t3
, 
t4
;\

646 
	`MuÉly128
(
t2
, 
a
>>64, 
kl
);\

647 
	`MuÉly128
(
t3
, 
a
, 
kh
);\

648 
	`MuÉly128
(
t1
, 
a
, 
kl
);\

649 
	`MuÉly128
(
t4
, 
a
>>64, 2*
kh
);\

650 
t2
 +ğ
t3
;\

651 
t4
 +ğ
t1
;\

652 
t2
 +ğ
t4
>>64;\

653 
a
 = (
	`wÜd128
(
	`wÜd64
(
t2
)&
m63
è<< 64è| wÜd64(
t4
);\

654 
t2
 *= 2;\

655 
a
 +ğ
m
 & 
m126
;\

656 
a
 +ğ
t2
>>64;}

	)

658 
	`pŞy_¡•
(
a1
, 
kh1
, 
kl1
, 
nhA
);

659 ià(
T_128B™Tag
)

660 
	`pŞy_¡•
(
a2
, 
kh2
, 
kl2
, 
nhB
);

662 
	#pŞy_¡•
(
ah
, 
®
, 
kh
, 
kl
, 
mh
, 
ml
) \

663 { 
wÜd64
 
t1h
, 
t1l
, 
t2h
, 
t2l
, 
t3h
, 
t3l
, 
z
=0; \

665 
	`MUL64
(
t2h
,
t2l
,
ah
,
kl
); \

666 
	`MUL64
(
t3h
,
t3l
,
®
,
kh
); \

667 
	`MUL64
(
t1h
,
t1l
,
ah
,2*
kh
); \

668 
	`MUL64
(
ah
,
®
,®,
kl
); \

670 
	`ADD128
(
t2h
,
t2l
,
t3h
,
t3l
); \

672 
	`ADD128
(
ah
,
®
,
t1h
,
t1l
); \

675 
	`ADD128
(
t2h
,
ah
,
z
,
t2l
); \

677 
t2h
 +ğt2h + (
ah
 >> 63); \

678 
ah
 &ğ
m63
; \

680 
mh
 &ğ
m62
; \

681 
	`ADD128
(
ah
,
®
,
mh
,
ml
); \

682 
	`ADD128
(
ah
,
®
,
z
,
t2h
); \

683 }

	)

685 
	`pŞy_¡•
(
ah1
, 
®1
, 
kh1
, 
kl1
, 
nhA1
, 
nhA0
);

686 ià(
T_128B™Tag
)

687 
	`pŞy_¡•
(
ah2
, 
®2
, 
kh2
, 
kl2
, 
nhB1
, 
nhB0
);

690 } 
blocksRemaššgInWÜd64
);

692 #ià
VMAC_BOOL_WORD128


693 (
pŞyS
+0*4)[0]=
	`wÜd64
(
a1
>>64); (polyS+0*4)[1]=word64(a1);

694 ià(
T_128B™Tag
)

696 (
pŞyS
+1*4)[0]=
	`wÜd64
(
a2
>>64); (polyS+1*4)[1]=word64(a2);

698 #–ià!
VMAC_BOOL_32BIT


699 (
pŞyS
+0*4)[0]=
ah1
; (pŞyS+0*4)[1]=
®1
;

700 ià(
T_128B™Tag
)

702 (
pŞyS
+1*4)[0]=
ah2
; (pŞyS+1*4)[1]=
®2
;

705 
	}
}

707 
šlše
 
	gVMAC_Ba£
::
	$VHASH_Upd©e
(cÚ¡ 
wÜd64
 *
d©a
, 
size_t
 
blocksRemaššgInWÜd64
)

709 #ià
CRYPTOPP_BOOL_SSE2_ASM_AVAILABLE
 && 
CRYPTOPP_BOOL_X86


710 ià(
	`HasSSE2
())

712 
	`VHASH_Upd©e_SSE2
(
d©a
, 
blocksRemaššgInWÜd64
, 0);

713 ià(
m_is128
)

714 
	`VHASH_Upd©e_SSE2
(
d©a
, 
blocksRemaššgInWÜd64
, 1);

715 
m_isFœ¡Block
 = 
çl£
;

720 #ià
	`defšed
(
_MSC_VER
) && _MSC_VER < 1300

721 
	`VHASH_Upd©e_Tem¶©e
(
d©a
, 
blocksRemaššgInWÜd64
);

723 ià(
m_is128
)

724 
VHASH_Upd©e_Tem¶©e
<
Œue
>(
d©a
, 
blocksRemaššgInWÜd64
);

726 
VHASH_Upd©e_Tem¶©e
<
çl£
>(
d©a
, 
blocksRemaššgInWÜd64
);

729 
	}
}

731 
size_t
 
	gVMAC_Ba£
::
	$HashMuÉËBlocks
(cÚ¡ 
wÜd64
 *
d©a
, 
size_t
 
Ëngth
)

733 
size_t
 
»maššg
 = 
	`ModPow”Of2
(
Ëngth
, 
m_L1KeyL’gth
);

734 
	`VHASH_Upd©e
(
d©a
, (
Ëngth
-
»maššg
)/8);

735  
»maššg
;

736 
	}
}

738 
wÜd64
 
	$L3Hash
(cÚ¡ 
wÜd64
 *
šput
, cÚ¡ wÜd64 *
l3Key
, 
size_t
 
Ën
)

740 
wÜd64
 
rh
, 
¾
, 
t
, 
z
=0;

741 
wÜd64
 
p1
 = 
šput
[0], 
p2
 = input[1];

742 
wÜd64
 
k1
 = 
l3Key
[0], 
k2
 =†3Key[1];

745 
t
 = 
p1
 >> 63;

746 
p1
 &ğ
m63
;

747 
	`ADD128
(
p1
, 
p2
, 
Ën
, 
t
);

749 
t
 = (
p1
 > 
m63
è+ (Õ1 =ğm63è& (
p2
 =ğ
m64
));

750 
	`ADD128
(
p1
, 
p2
, 
z
, 
t
);

751 
p1
 &ğ
m63
;

754 
t
 = 
p1
 + (
p2
 >> 32);

755 
t
 += (t >> 32);

756 
t
 +ğ(
wÜd32
)t > 0xfffffffeU;

757 
p1
 +ğ(
t
 >> 32);

758 
p2
 +ğ(
p1
 << 32);

761 
p1
 +ğ
k1
;

762 
p1
 +ğ(0 - (p1 < 
k1
)) & 257;

763 
p2
 +ğ
k2
;

764 
p2
 +ğ(0 - (p2 < 
k2
)) & 257;

767 
	`MUL64
(
rh
, 
¾
, 
p1
, 
p2
);

768 
t
 = 
rh
 >> 56;

769 
	`ADD128
(
t
, 
¾
, 
z
, 
rh
);

770 
rh
 <<= 8;

771 
	`ADD128
(
t
, 
¾
, 
z
, 
rh
);

772 
t
 += << 8;

773 
¾
 +ğ
t
;

774 
¾
 +ğ(0 - (¾ < 
t
)) & 257;

775 
¾
 +ğ(0 - (¾ > 
p64
-1)) & 257;

776  
¾
;

777 
	}
}

779 
	gVMAC_Ba£
::
	$Trunÿ‹dFš®
(
by‹
 *
mac
, 
size_t
 
size
)

781 
size_t
 
Ën
 = 
	`ModPow”Of2
(
	`G‘B™CouÁLo
()/8, 
m_L1KeyL’gth
);

783 ià(
Ën
)

785 
	`mem£t
(
	`m_d©a
()+
Ën
, 0, (0-len)%16);

786 
	`VHASH_Upd©e
(
	`D©aBuf
(), ((
Ën
+15)/16)*2);

787 
Ën
 *= 8;

789 ià(
m_isFœ¡Block
)

792 
	`m_pŞyS‹
()[0] = m_polyState()[2];

793 
	`m_pŞyS‹
()[1] = m_polyState()[3];

794 ià(
m_is128
)

796 
	`m_pŞyS‹
()[4] = m_polyState()[6];

797 
	`m_pŞyS‹
()[5] = m_polyState()[7];

801 ià(
m_is128
)

803 
wÜd64
 
t
[2];

804 
t
[0] = 
	`L3Hash
(
	`m_pŞyS‹
(), 
	`m_l3Key
(), 
Ën
è+ 
G‘WÜd
<
wÜd64
>(
Œue
, 
BIG_ENDIAN_ORDER
, 
	`m_·d
());

805 
t
[1] = 
	`L3Hash
(
	`m_pŞyS‹
()+4, 
	`m_l3Key
()+2, 
Ën
è+ 
G‘WÜd
<
wÜd64
>(
Œue
, 
BIG_ENDIAN_ORDER
, 
	`m_·d
()+8);

806 ià(
size
 == 16)

808 
	`PutWÜd
(
çl£
, 
BIG_ENDIAN_ORDER
, 
mac
, 
t
[0]);

809 
	`PutWÜd
(
çl£
, 
BIG_ENDIAN_ORDER
, 
mac
+8, 
t
[1]);

813 
t
[0] = 
	`CÚd™iÚ®By‹Rev”£
(
BIG_ENDIAN_ORDER
,[0]);

814 
t
[1] = 
	`CÚd™iÚ®By‹Rev”£
(
BIG_ENDIAN_ORDER
,[1]);

815 
	`memıy
(
mac
, 
t
, 
size
);

820 
wÜd64
 
t
 = 
	`L3Hash
(
	`m_pŞyS‹
(), 
	`m_l3Key
(), 
Ën
);

821 
t
 +ğ
G‘WÜd
<
wÜd64
>(
Œue
, 
BIG_ENDIAN_ORDER
, 
	`m_·d
(è+ (
	`m_nÚû
()[
	`IVSize
()-1]&1) * 8);

822 ià(
size
 == 8)

823 
	`PutWÜd
(
çl£
, 
BIG_ENDIAN_ORDER
, 
mac
, 
t
);

826 
t
 = 
	`CÚd™iÚ®By‹Rev”£
(
BIG_ENDIAN_ORDER
,);

827 
	`memıy
(
mac
, &
t
, 
size
);

830 
	}
}

832 
	gNAMESPACE_END


	@vmac.h

1 #iâdeà
CRYPTOPP_VMAC_H


2 
	#CRYPTOPP_VMAC_H


	)

4 
	~"™”hash.h
"

5 
	~"£ckey.h
"

7 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

10 
şass
 
VMAC_Ba£
 : 
public
 
I‹¿‹dHashBa£
<
wÜd64
, 
Mes§geAuth’tiÿtiÚCode
>

12 
public
:

13 
¡d
::
¡ršg
 
	`AlgÜ™hmName
(ècÚ¡ { std::
	`¡ršg
("VMAC("è+ 
	`G‘Ch”
().AlgÜ™hmName(è+ ")-" + 
	`IÁToSŒšg
(
	`Dige¡Size
()*8);}

14 
	`IVSize
(ècÚ¡ { 
	`G‘Ch”
().
	`BlockSize
();}

15 
	`MšIVL’gth
() const { 1;}

16 
	`ResynchrÚize
(cÚ¡ 
by‹
 *
nÚû
, 
Ëngth
=-1);

17 
	`G‘NextIV
(
RªdomNumb”G’”©Ü
 &
ºg
, 
by‹
 *
IV
);

18 
	`Dige¡Size
(ècÚ¡ { 
m_is128
 ? 16 : 8;};

19 
	`UncheckedS‘Key
(cÚ¡ 
by‹
 *
u£rKey
, 
keyËngth
, cÚ¡ 
NameV®uePaœs
 &
·¿ms
);

20 
	`Trunÿ‹dFš®
(
by‹
 *
mac
, 
size_t
 
size
);

21 
	`BlockSize
(ècÚ¡ { 
m_L1KeyL’gth
;}

22 
By‹Ord”
 
	`G‘By‹Ord”
(ècÚ¡ { 
LITTLE_ENDIAN_ORDER
;}

24 
´Ùeùed
:

25 
vœtu®
 
BlockCh”
 & 
	`AcûssCh”
() =0;

26 
vœtu®
 
	`DeçuÉDige¡Size
() const =0;

27 cÚ¡ 
BlockCh”
 & 
	`G‘Ch”
(ècÚ¡ { 
cÚ¡_ÿ¡
<
VMAC_Ba£
 *>(
this
)->
	`AcûssCh”
();}

28 
	`HashEndŸnCÜ»ùedBlock
(cÚ¡ 
wÜd64
 *
d©a
);

29 
size_t
 
	`HashMuÉËBlocks
(cÚ¡ 
wÜd64
 *
šput
, size_ˆ
Ëngth
);

30 
	`In™
() {}

31 
wÜd64
* 
	`S‹Buf
(è{ 
NULL
;}

32 
wÜd64
* 
	`D©aBuf
(è{ (wÜd64 *)
	`m_d©a
();}

34 
	`VHASH_Upd©e_SSE2
(cÚ¡ 
wÜd64
 *
d©a
, 
size_t
 
blocksRemaššgInWÜd64
, 
gP¬t
);

35 #ià!(
	`defšed
(
_MSC_VER
) && _MSC_VER < 1300)

36 
‹m¶©e
 <
boŞ
 
T_128B™Tag
>

38 
	`VHASH_Upd©e_Tem¶©e
(cÚ¡ 
wÜd64
 *
d©a
, 
size_t
 
blockRemaššgInWÜd128
);

39 
	`VHASH_Upd©e
(cÚ¡ 
wÜd64
 *
d©a
, 
size_t
 
blocksRemaššgInWÜd128
);

41 
	`CRYPTOPP_BLOCK_1
(
pŞyS‹
, 
wÜd64
, 4*(
m_is128
+1))

42 
	`CRYPTOPP_BLOCK_2
(
nhKey
, 
wÜd64
, 
m_L1KeyL’gth
/(wÜd64è+ 2*
m_is128
)

43 
	`CRYPTOPP_BLOCK_3
(
d©a
, 
by‹
, 
m_L1KeyL’gth
)

44 
	`CRYPTOPP_BLOCK_4
(
l3Key
, 
wÜd64
, 2*(
m_is128
+1))

45 
	`CRYPTOPP_BLOCK_5
(
nÚû
, 
by‹
, 
	`IVSize
())

46 
	`CRYPTOPP_BLOCK_6
(
·d
, 
by‹
, 
	`IVSize
())

47 
	`CRYPTOPP_BLOCKS_END
(6)

49 
boŞ
 
m_is128
, 
m_·dCached
, 
m_isFœ¡Block
;

50 
m_L1KeyL’gth
;

51 
	}
};

54 
	g‹m¶©e
 <
şass
 
	gT_BlockCh”
, 
	gT_Dige¡B™Size
 = 128>

55 
şass
 
VMAC
 : 
public
 
Sim¶eKeyšgIÁ”çûIm¶
<
VMAC_Ba£
, 
	gSameKeyL’gthAs
<
	gT_BlockCh”
, 
	gSim¶eKeyšgIÁ”çû
::
UNIQUE_IV
, T_BlockCh”::
BLOCKSIZE
> >

57 
public
:

58 
¡d
::
¡ršg
 
SticAlgÜ™hmName
(è{ std::¡ršg("VMAC("è+ 
T_BlockCh”
::SticAlgÜ™hmName(è+ ")-" + 
IÁToSŒšg
(
T_Dige¡B™Size
);}

60 
	g´iv©e
:

61 
BlockCh”
 & 
AcûssCh”
(è{ 
m_ch”
;}

62 
DeçuÉDige¡Size
(ècÚ¡ { 
	gT_Dige¡B™Size
/8;}

63 
ty³Çme
 
	gT_BlockCh”
::
Enüy±iÚ
 
m_ch”
;

66 
	gNAMESPACE_END


	@wait.cpp

3 
	~"pch.h
"

4 
	~"wa™.h
"

5 
	~"misc.h
"

7 #ifdeà
SOCKETS_AVAILABLE


9 #ifdeà
USE_BERKELEY_STYLE_SOCKETS


10 
	~<”ºo.h
>

11 
	~<sys/ty³s.h
>

12 
	~<sys/time.h
>

13 
	~<uni¡d.h
>

16 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

18 
Wa™ObjeùCÚš”
::
	$MaxWa™Objeùs
()

20 #ifdeà
USE_WINDOWS_STYLE_SOCKETS


21  
MAXIMUM_WAIT_OBJECTS
 * (MAXIMUM_WAIT_OBJECTS-1);

23  
FD_SETSIZE
;

25 
	}
}

27 
	gWa™ObjeùCÚš”
::
	$Wa™ObjeùCÚš”
(
Wa™ObjeùsT¿ûr
* 
Œaûr
)

28 : 
	`m_Œaûr
(
Œaûr
), 
	`m_ev’tTim”
(
Tim”
::
MILLISECONDS
)

29 , 
	`m_§meResuÉCouÁ
(0), 
	$m_noWa™Tim”
(
Tim”
::
MILLISECONDS
)

31 
	`CË¬
();

32 
m_ev’tTim”
.
	`S¹Tim”
();

33 
	}
}

35 
	gWa™ObjeùCÚš”
::
	$CË¬
()

37 #ifdeà
USE_WINDOWS_STYLE_SOCKETS


38 
m_hªdËs
.
	`ş—r
();

40 
m_maxFd
 = 0;

41 
	`FD_ZERO
(&
m_»adfds
);

42 
	`FD_ZERO
(&
m_wr™efds
);

44 
m_noWa™
 = 
çl£
;

45 
m_fœ¡Ev’tTime
 = 0;

46 
	}
}

48 
šlše
 
	gWa™ObjeùCÚš”
::
	$S‘La¡ResuÉ
(
La¡ResuÉTy³
 
»suÉ
)

50 ià(
»suÉ
 =ğ
m_Ï¡ResuÉ
)

51 
m_§meResuÉCouÁ
++;

54 
m_Ï¡ResuÉ
 = 
»suÉ
;

55 
m_§meResuÉCouÁ
 = 0;

57 
	}
}

59 
	gWa™ObjeùCÚš”
::
	$D‘eùNoWa™
(
La¡ResuÉTy³
 
»suÉ
, 
C®lSck
 cÚ¡& 
ÿÎSck
)

61 ià(
»suÉ
 =ğ
m_Ï¡ResuÉ
 && 
m_noWa™Tim”
.
	`EÏp£dTime
() > 1000)

63 ià(
m_§meResuÉCouÁ
 > 
m_noWa™Tim”
.
	`EÏp£dTime
())

65 ià(
m_Œaûr
)

67 
¡d
::
¡ršg
 
desc
 = "No wait†oop detected - m_lastResult: ";

68 
desc
.
	`­³nd
(
	`IÁToSŒšg
(
m_Ï¡ResuÉ
)).append(", call stack:");

69 
C®lSck
 cÚ¡* 
cs
 = &
ÿÎSck
; cs; c ğcs->
	`P»v
())

70 
desc
.
	`­³nd
("\n- ").­³nd(
cs
->
	`FÜm©
());

71 
m_Œaûr
->
	`T¿ûNoWa™Loİ
(
desc
);

73 
Œy
 { 
throw
 0; } 
	`ÿtch
 (...) {}

76 
m_noWa™Tim”
.
	`S¹Tim”
();

77 
m_§meResuÉCouÁ
 = 0;

79 
	}
}

81 
	gWa™ObjeùCÚš”
::
	$S‘NoWa™
(
C®lSck
 cÚ¡& 
ÿÎSck
)

83 
	`D‘eùNoWa™
(
LASTRESULT_NOWAIT
, 
	`C®lSck
("Wa™ObjeùCÚš”::S‘NoWa™()", &
ÿÎSck
));

84 
m_noWa™
 = 
Œue
;

85 
	}
}

87 
	gWa™ObjeùCÚš”
::
	$ScheduËEv’t
(
mli£cÚds
, 
C®lSck
 cÚ¡& 
ÿÎSck
)

89 ià(
mli£cÚds
 <= 3)

90 
	`D‘eùNoWa™
(
LASTRESULT_SCHEDULED
, 
	`C®lSck
("Wa™ObjeùCÚš”::ScheduËEv’t()", &
ÿÎSck
));

91 
thisEv’tTime
 = 
m_ev’tTim”
.
	`EÏp£dTimeAsDoubË
(è+ 
mli£cÚds
;

92 ià(!
m_fœ¡Ev’tTime
 || 
thisEv’tTime
 < m_firstEventTime)

93 
m_fœ¡Ev’tTime
 = 
thisEv’tTime
;

94 
	}
}

96 #ifdeà
USE_WINDOWS_STYLE_SOCKETS


98 
	sWa™šgTh»adD©a


100 
boŞ
 
	mwa™šgToWa™
, 
	m‹rmš©e
;

101 
HANDLE
 
	m¡¬tWa™šg
, 
	m¡İWa™šg
;

102 cÚ¡ 
HANDLE
 *
	mwa™HªdËs
;

103 
	mcouÁ
;

104 
HANDLE
 
	mth»adHªdË
;

105 
DWORD
 
	mth»adId
;

106 
DWORD
* 
	m”rÜ
;

109 
	gWa™ObjeùCÚš”
::~
	$Wa™ObjeùCÚš”
()

111 
Œy


113 ià(!
m_th»ads
.
	`em±y
())

115 
HANDLE
 
th»adHªdËs
[
MAXIMUM_WAIT_OBJECTS
];

116 
i
;

117 
i
=0; i<
m_th»ads
.
	`size
(); i++)

119 
Wa™šgTh»adD©a
 &
th»ad
 = *
m_th»ads
[
i
];

120 !
th»ad
.
wa™šgToWa™
)

121 
	`SË•
(0);

122 
th»ad
.
‹rmš©e
 = 
Œue
;

123 
th»adHªdËs
[
i
] = 
th»ad
.
th»adHªdË
;

125 
	`Pul£Ev’t
(
m_¡¬tWa™šg
);

126 ::
	`Wa™FÜMuÉËObjeùs
((
DWORD
)
m_th»ads
.
	`size
(), 
th»adHªdËs
, 
TRUE
, 
INFINITE
);

127 
i
=0; i<
m_th»ads
.
	`size
(); i++)

128 
	`Clo£HªdË
(
th»adHªdËs
[
i
]);

129 
	`Clo£HªdË
(
m_¡¬tWa™šg
);

130 
	`Clo£HªdË
(
m_¡İWa™šg
);

133 
	`ÿtch
 (...)

136 
	}
}

139 
	gWa™ObjeùCÚš”
::
	$AddHªdË
(
HANDLE
 
hªdË
, 
C®lSck
 cÚ¡& 
ÿÎSck
)

141 
	`D‘eùNoWa™
(
m_hªdËs
.
	`size
(), 
	`C®lSck
("Wa™ObjeùCÚš”::AddHªdË()", &
ÿÎSck
));

142 
m_hªdËs
.
	`push_back
(
hªdË
);

143 
	}
}

145 
DWORD
 
WINAPI
 
	$Wa™šgTh»ad
(
LPVOID
 
lP¬am
)

147 
¡d
::
auto_±r
<
Wa™šgTh»adD©a
> 
	`pTh»ad
((Wa™šgTh»adD©¨*)
lP¬am
);

148 
Wa™šgTh»adD©a
 &
th»ad
 = *
pTh»ad
;

149 
¡d
::
veùÜ
<
HANDLE
> 
hªdËs
;

151 
Œue
)

153 
th»ad
.
wa™šgToWa™
 = 
Œue
;

154 ::
	`Wa™FÜSšgËObjeù
(
th»ad
.
¡¬tWa™šg
, 
INFINITE
);

155 
th»ad
.
wa™šgToWa™
 = 
çl£
;

157 ià(
th»ad
.
‹rmš©e
)

159 ià(!
th»ad
.
couÁ
)

162 
hªdËs
.
	`»size
(
th»ad
.
couÁ
 + 1);

163 
hªdËs
[0] = 
th»ad
.
¡İWa™šg
;

164 
¡d
::
	`cİy
(
th»ad
.
wa™HªdËs
,h»ad.wa™HªdËs+th»ad.
couÁ
, 
hªdËs
.
	`begš
()+1);

166 
DWORD
 
»suÉ
 = ::
	`Wa™FÜMuÉËObjeùs
((DWORD)
hªdËs
.
	`size
(), &hªdËs[0], 
FALSE
, 
INFINITE
);

168 ià(
»suÉ
 =ğ
WAIT_OBJECT_0
)

170 
	`S‘Ev’t
(
th»ad
.
¡İWa™šg
);

171 ià(!(
»suÉ
 > 
WAIT_OBJECT_0
 &&„esuÉ < WAIT_OBJECT_0 + 
hªdËs
.
	`size
()))

173 
	`as£¹
(!"error in WaitingThread");

174 *
th»ad
.
”rÜ
 = ::
	`G‘La¡E¼Ü
();

178  
S_OK
;

179 
	}
}

181 
	gWa™ObjeùCÚš”
::
	$C»©eTh»ads
(
couÁ
)

183 
size_t
 
cu¼’tCouÁ
 = 
m_th»ads
.
	`size
();

184 ià(
cu¼’tCouÁ
 == 0)

186 
m_¡¬tWa™šg
 = ::
	`C»©eEv’t
(
NULL
, 
TRUE
, 
FALSE
, NULL);

187 
m_¡İWa™šg
 = ::
	`C»©eEv’t
(
NULL
, 
TRUE
, 
FALSE
, NULL);

190 ià(
cu¼’tCouÁ
 < 
couÁ
)

192 
m_th»ads
.
	`»size
(
couÁ
);

193 
size_t
 
i
=
cu¼’tCouÁ
; i<
couÁ
; i++)

195 
m_th»ads
[
i
] = 
Ãw
 
Wa™šgTh»adD©a
;

196 
Wa™šgTh»adD©a
 &
th»ad
 = *
m_th»ads
[
i
];

197 
th»ad
.
‹rmš©e
 = 
çl£
;

198 
th»ad
.
¡¬tWa™šg
 = 
m_¡¬tWa™šg
;

199 
th»ad
.
¡İWa™šg
 = 
m_¡İWa™šg
;

200 
th»ad
.
wa™šgToWa™
 = 
çl£
;

201 
th»ad
.
th»adHªdË
 = 
	`C»©eTh»ad
(
NULL
, 0, &
Wa™šgTh»ad
, &th»ad, 0, &th»ad.
th»adId
);

204 
	}
}

206 
boŞ
 
	gWa™ObjeùCÚš”
::
	$Wa™
(
mli£cÚds
)

208 ià(
m_noWa™
 || (
m_hªdËs
.
	`em±y
(è&& !
m_fœ¡Ev’tTime
))

210 
	`S‘La¡ResuÉ
(
LASTRESULT_NOWAIT
);

211  
Œue
;

214 
boŞ
 
timeoutIsScheduËdEv’t
 = 
çl£
;

216 ià(
m_fœ¡Ev’tTime
)

218 
timeToFœ¡Ev’t
 = 
	`S©u¿tšgSubŒaù
(
m_fœ¡Ev’tTime
, 
m_ev’tTim”
.
	`EÏp£dTimeAsDoubË
());

220 ià(
timeToFœ¡Ev’t
 <ğ
mli£cÚds
)

222 
mli£cÚds
 = ()
timeToFœ¡Ev’t
;

223 
timeoutIsScheduËdEv’t
 = 
Œue
;

226 ià(
m_hªdËs
.
	`em±y
(è|| !
mli£cÚds
)

228 ià(
mli£cÚds
)

229 
	`SË•
(
mli£cÚds
);

230 
	`S‘La¡ResuÉ
(
timeoutIsScheduËdEv’t
 ? 
LASTRESULT_SCHEDULED
 : 
LASTRESULT_TIMEOUT
);

231  
timeoutIsScheduËdEv’t
;

235 ià(
m_hªdËs
.
	`size
(è> 
MAXIMUM_WAIT_OBJECTS
)

238 cÚ¡ 
WAIT_OBJECTS_PER_THREAD
 = 
MAXIMUM_WAIT_OBJECTS
-1;

239 
nTh»ads
 = ()((
m_hªdËs
.
	`size
(è+ 
WAIT_OBJECTS_PER_THREAD
 - 1) / WAIT_OBJECTS_PER_THREAD);

240 ià(
nTh»ads
 > 
MAXIMUM_WAIT_OBJECTS
)

241 
throw
 
	`E¼
("WaitObjectContainer:‚umber of wait objectsƒxceeds†imit");

242 
	`C»©eTh»ads
(
nTh»ads
);

243 
DWORD
 
”rÜ
 = 
S_OK
;

245 
i
=0; i<
m_th»ads
.
	`size
(); i++)

247 
Wa™šgTh»adD©a
 &
th»ad
 = *
m_th»ads
[
i
];

248 !
th»ad
.
wa™šgToWa™
)

249 
	`SË•
(0);

250 ià(
i
<
nTh»ads
)

252 
th»ad
.
wa™HªdËs
 = &
m_hªdËs
[
i
*
WAIT_OBJECTS_PER_THREAD
];

253 
th»ad
.
couÁ
 = 
	`UnsigÃdMš
(
WAIT_OBJECTS_PER_THREAD
, 
m_hªdËs
.
	`size
(è- 
i
*WAIT_OBJECTS_PER_THREAD);

254 
th»ad
.
”rÜ
 = &error;

257 
th»ad
.
couÁ
 = 0;

260 
	`Re£tEv’t
(
m_¡İWa™šg
);

261 
	`Pul£Ev’t
(
m_¡¬tWa™šg
);

263 
DWORD
 
»suÉ
 = ::
	`Wa™FÜSšgËObjeù
(
m_¡İWa™šg
, 
mli£cÚds
);

264 ià(
»suÉ
 =ğ
WAIT_OBJECT_0
)

266 ià(
”rÜ
 =ğ
S_OK
)

267  
Œue
;

269 
throw
 
	`E¼
("Wa™ObjeùCÚš”: Wa™FÜMuÉËObjeù šh»ad faed w™hƒ¼Ü " + 
	`IÁToSŒšg
(
”rÜ
));

271 
	`S‘Ev’t
(
m_¡İWa™šg
);

272 ià(
»suÉ
 =ğ
WAIT_TIMEOUT
)

274 
	`S‘La¡ResuÉ
(
timeoutIsScheduËdEv’t
 ? 
LASTRESULT_SCHEDULED
 : 
LASTRESULT_TIMEOUT
);

275  
timeoutIsScheduËdEv’t
;

278 
throw
 
	`E¼
("Wa™ObjeùCÚš”: Wa™FÜSšgËObjeù faed w™hƒ¼Ü " + 
	`IÁToSŒšg
(::
	`G‘La¡E¼Ü
()));

282 #ià
TRACE_WAIT


283 
Tim”
 
	`t
(Tim”::
MICROSECONDS
);

284 
Ï¡Time
 = 0;

285 
timeBefÜeWa™
 = 
t
.
	`EÏp£dTime
();

287 
DWORD
 
»suÉ
 = ::
	`Wa™FÜMuÉËObjeùs
((DWORD)
m_hªdËs
.
	`size
(), &m_hªdËs[0], 
FALSE
, 
mli£cÚds
);

288 #ià
TRACE_WAIT


289 ià(
mli£cÚds
 > 0)

291 
timeAá”Wa™
 = 
t
.
	`EÏp£dTime
();

292 
	`OuutDebugSŒšg
(("HªdË " + 
	`IÁToSŒšg
(
m_hªdËs
.
	`size
()è+ ", Woku°by " + IÁToSŒšg(
»suÉ
-
WAIT_OBJECT_0
è+ ", Bus›d fÜ " + IÁToSŒšg(
timeBefÜeWa™
-
Ï¡Time
è+ " us, Wa™ed fÜ " + IÁToSŒšg(
timeAá”Wa™
-timeBefÜeWa™è+ " us, max " + IÁToSŒšg(
mli£cÚds
è+ "ms\n").
	`c_¡r
());

293 
Ï¡Time
 = 
timeAá”Wa™
;

296 ià(
»suÉ
 >ğ
WAIT_OBJECT_0
 &&„esuÉ < WAIT_OBJECT_0 + 
m_hªdËs
.
	`size
())

298 ià(
»suÉ
 =ğ
m_Ï¡ResuÉ
)

299 
m_§meResuÉCouÁ
++;

302 
m_Ï¡ResuÉ
 = 
»suÉ
;

303 
m_§meResuÉCouÁ
 = 0;

305  
Œue
;

307 ià(
»suÉ
 =ğ
WAIT_TIMEOUT
)

309 
	`S‘La¡ResuÉ
(
timeoutIsScheduËdEv’t
 ? 
LASTRESULT_SCHEDULED
 : 
LASTRESULT_TIMEOUT
);

310  
timeoutIsScheduËdEv’t
;

313 
throw
 
	`E¼
("Wa™ObjeùCÚš”: Wa™FÜMuÉËObjeù çed w™hƒ¼Ü " + 
	`IÁToSŒšg
(::
	`G‘La¡E¼Ü
()));

315 
	}
}

319 
	gWa™ObjeùCÚš”
::
	$AddR—dFd
(
fd
, 
C®lSck
 cÚ¡& 
ÿÎSck
)

321 
	`FD_SET
(
fd
, &
m_»adfds
);

322 
m_maxFd
 = 
	`STDMAX
(m_maxFd, 
fd
);

323 
	}
}

325 
	gWa™ObjeùCÚš”
::
	$AddWr™eFd
(
fd
, 
C®lSck
 cÚ¡& 
ÿÎSck
)

327 
	`FD_SET
(
fd
, &
m_wr™efds
);

328 
m_maxFd
 = 
	`STDMAX
(m_maxFd, 
fd
);

329 
	}
}

331 
boŞ
 
	gWa™ObjeùCÚš”
::
	$Wa™
(
mli£cÚds
)

333 ià(
m_noWa™
 || (!
m_maxFd
 && !
m_fœ¡Ev’tTime
))

334  
Œue
;

336 
boŞ
 
timeoutIsScheduËdEv’t
 = 
çl£
;

338 ià(
m_fœ¡Ev’tTime
)

340 
timeToFœ¡Ev’t
 = 
	`S©u¿tšgSubŒaù
(
m_fœ¡Ev’tTime
, 
m_ev’tTim”
.
	`EÏp£dTimeAsDoubË
());

341 ià(
timeToFœ¡Ev’t
 <ğ
mli£cÚds
)

343 
mli£cÚds
 = ()
timeToFœ¡Ev’t
;

344 
timeoutIsScheduËdEv’t
 = 
Œue
;

348 
timev®
 
tv
, *
timeout
;

350 ià(
mli£cÚds
 =ğ
INFINITE_TIME
)

351 
timeout
 = 
NULL
;

354 
tv
.
tv_£c
 = 
mli£cÚds
 / 1000;

355 
tv
.
tv_u£c
 = (
mli£cÚds
 % 1000) * 1000;

356 
timeout
 = &
tv
;

359 
»suÉ
 = 
	`£Ëù
(
m_maxFd
+1, &
m_»adfds
, &
m_wr™efds
, 
NULL
, 
timeout
);

361 ià(
»suÉ
 > 0)

362  
Œue
;

363 ià(
»suÉ
 == 0)

364  
timeoutIsScheduËdEv’t
;

366 
throw
 
	`E¼
("Wa™ObjeùCÚš”: s–eù faed w™hƒ¼Ü " + 
”ºo
);

367 
	}
}

373 
	g¡d
::
¡ršg
 
C®lSck
::
	$FÜm©
() const

375  
m_šfo
;

376 
	}
}

378 
	g¡d
::
¡ršg
 
C®lSckW™hNr
::
	$FÜm©
() const

380  
¡d
::
	`¡ršg
(
m_šfo
è+ " /‚r: " + 
	`IÁToSŒšg
(
m_Ä
);

381 
	}
}

383 
	g¡d
::
¡ršg
 
C®lSckW™hSŒ
::
	$FÜm©
() const

385  
¡d
::
	`¡ršg
(
m_šfo
è+ " / " + std::¡ršg(
m_z
);

386 
	}
}

388 
boŞ
 
	gWa™abË
::
	$Wa™
(
mli£cÚds
, 
C®lSck
 cÚ¡& 
ÿÎSck
)

390 
Wa™ObjeùCÚš”
 
cÚš”
;

391 
	`G‘Wa™Objeùs
(
cÚš”
, 
ÿÎSck
);

392  
cÚš”
.
	`Wa™
(
mli£cÚds
);

393 
	}
}

395 
	gNAMESPACE_END


	@wait.h

1 #iâdeà
CRYPTOPP_WAIT_H


2 
	#CRYPTOPP_WAIT_H


	)

4 
	~"cÚfig.h
"

6 #ifdeà
SOCKETS_AVAILABLE


8 
	~"misc.h
"

9 
	~"üy±lib.h
"

10 
	~<veùÜ
>

12 #ifdeà
USE_WINDOWS_STYLE_SOCKETS


13 
	~<wšsock2.h
>

15 
	~<sys/ty³s.h
>

18 
	~"h¹im”.h
"

20 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

22 şas 
	cT¿ûr


24 
public
:

25 
	$T¿ûr
(
Ëv–
è: 
	$m_Ëv–
(
Ëv–
) {}

26 
vœtu®
 ~
	$T¿ûr
(è{
	}
}

28 
´Ùeùed
:

30 
vœtu®
 
T¿û
(
n
, 
¡d
::
¡ršg
 cÚ¡& 
s
) = 0;

36 
vœtu®
 
boŞ
 
	$UsšgDeçuÉs
(ècÚ¡ {  
Œue
; 
	}
}

38 
	g´Ùeùed
:

39 
m_Ëv–
;

41 
	$T¿ûIf
(
n
, 
¡d
::
¡ršg
 cÚ¡&
s
)

42 { ià(
n
è
	`T¿û
Ò, 
s
); 
	}
}

48 
	$T¿cšg
(
Ä
, 
mšLev–
) const

49 {  (
	`UsšgDeçuÉs
(è&& 
m_Ëv–
 >ğ
mšLev–
è? 
Ä
 : 0; 
	}
}

58 
	#CRYPTOPP_TRACER_CONSTRUCTOR
(
DERIVED
) \

59 
public
: 
	`DERIVED
(
Ëv–
 = 0è: 
	`T¿ûr
Öev–è{}

	)

61 
	#CRYPTOPP_BEGIN_TRACER_CLASS_1
(
DERIVED
, 
BASE1
) \

62 şas 
	cDERIVED
 : 
vœtu®
 
public
 
BASE1
 { 
	$CRYPTOPP_TRACER_CONSTRUCTOR
(
DERIVED
)

	)

64 
	#CRYPTOPP_BEGIN_TRACER_CLASS_2
(
DERIVED
, 
BASE1
, 
BASE2
) \

65 
şass
 
DERIVED
 : 
vœtu®
 
public
 
BASE1
, vœtu®…ubliø
BASE2
 { 
	`CRYPTOPP_TRACER_CONSTRUCTOR
(DERIVED)

	)

67 
	#CRYPTOPP_END_TRACER_CLASS
 };

	)

72 
	#CRYPTOPP_BEGIN_TRACER_EVENTS
(
UNIQUENR
è’um { 
EVENTBASE
 = UNIQUENR,

	)

73 
	#CRYPTOPP_TRACER_EVENT
(
EVENTNAME
è
Ev’tNr_
##EVENTNAME,

	)

74 
	#CRYPTOPP_END_TRACER_EVENTS
 
	}
};

	)

86 
	#CRYPTOPP_TRACER_EVENT_METHODS
(
EVENTNAME
, 
LOGLEVEL
) \

87 
vœtu®
 
T¿û
##
	$EVENTNAME
(ècÚ¡ {  
	`T¿cšg
(
Ev’tNr_
##
EVENTNAME
, 
LOGLEVEL
); 
	}
} \

88 
vœtu®
 
T¿û
##
	$EVENTNAME
(
¡d
::
¡ršg
 cÚ¡& 
s
è{ 
	`T¿ûIf
(
T¿û
##
	`EVENTNAME
(), s); 
	}

	)
}

102 şas 
	cC®lSck


104 
	gpublic
:

105 
C®lSck
(cÚ¡* 
i
, C®lSck cÚ¡* 
p
è: 
m_šfo
(i), 
m_´ev
(p) {}

106 
C®lSck
 cÚ¡* 
P»v
(ècÚ¡ {  
	gm_´ev
; }

107 
vœtu®
 
	g¡d
::
¡ršg
 
FÜm©
() const;

109 
	g´Ùeùed
:

110 cÚ¡* 
m_šfo
;

111 
C®lSck
 cÚ¡* 
	gm_´ev
;

115 şas 
	cC®lSckW™hNr
 : 
public
 
C®lSck


117 
public
:

118 
C®lSckW™hNr
(cÚ¡* 
i
, 
wÜd32
 
n
, 
C®lSck
 cÚ¡* 
p
è: C®lSck(i,…), 
m_Ä
(n) {}

119 
	g¡d
::
¡ršg
 
FÜm©
() const;

121 
	g´Ùeùed
:

122 
wÜd32
 
m_Ä
;

126 şas 
	cC®lSckW™hSŒ
 : 
public
 
C®lSck


128 
public
:

129 
C®lSckW™hSŒ
(cÚ¡* 
i
, cÚ¡* 
z
, 
C®lSck
 cÚ¡* 
p
è: C®lSck(i,…), 
m_z
(z) {}

130 
	g¡d
::
¡ršg
 
FÜm©
() const;

132 
	g´Ùeùed
:

133 cÚ¡* 
m_z
;

136 
	$CRYPTOPP_BEGIN_TRACER_CLASS_1
(
Wa™ObjeùsT¿ûr
, 
T¿ûr
)

137 
	$CRYPTOPP_BEGIN_TRACER_EVENTS
(0x48752841)

138 
	$CRYPTOPP_TRACER_EVENT
(
NoWa™Loİ
)

139 
CRYPTOPP_END_TRACER_EVENTS


140 
	$CRYPTOPP_TRACER_EVENT_METHODS
(
NoWa™Loİ
, 1)

141 
CRYPTOPP_END_TRACER_CLASS


143 
Wa™šgTh»adD©a
;

146 şas 
	cWa™ObjeùCÚš”
 : 
public
 
NÙCİyabË


148 
public
:

150 şas 
	cE¼
 : 
public
 
Exû±iÚ


152 
public
:

153 
	`E¼
(cÚ¡ 
¡d
::
¡ršg
& 
s
è: 
	`Exû±iÚ
(
IO_ERROR
, s) {}

156 
	`MaxWa™Objeùs
();

158 
	`Wa™ObjeùCÚš”
(
Wa™ObjeùsT¿ûr
* 
Œaûr
 = 0);

160 
	`CË¬
();

161 
	`S‘NoWa™
(
C®lSck
 cÚ¡& 
ÿÎSck
);

162 
	`ScheduËEv’t
(
mli£cÚds
, 
C®lSck
 cÚ¡& 
ÿÎSck
);

164 
boŞ
 
	`Wa™
(
mli£cÚds
);

166 #ifdeà
USE_WINDOWS_STYLE_SOCKETS


167 ~
	`Wa™ObjeùCÚš”
();

168 
	`AddHªdË
(
HANDLE
 
hªdË
, 
C®lSck
 cÚ¡& 
ÿÎSck
);

170 
	`AddR—dFd
(
fd
, 
C®lSck
 cÚ¡& 
ÿÎSck
);

171 
	`AddWr™eFd
(
fd
, 
C®lSck
 cÚ¡& 
ÿÎSck
);

174 
´iv©e
:

175 
Wa™ObjeùsT¿ûr
* 
m_Œaûr
;

177 #ifdeà
USE_WINDOWS_STYLE_SOCKETS


178 
	`C»©eTh»ads
(
couÁ
);

179 
¡d
::
veùÜ
<
HANDLE
> 
m_hªdËs
;

180 
¡d
::
veùÜ
<
Wa™šgTh»adD©a
 *> 
m_th»ads
;

181 
HANDLE
 
m_¡¬tWa™šg
;

182 
HANDLE
 
m_¡İWa™šg
;

184 
fd_£t
 
m_»adfds
, 
m_wr™efds
;

185 
m_maxFd
;

187 
boŞ
 
m_noWa™
;

188 
m_fœ¡Ev’tTime
;

189 
Tim”
 
m_ev’tTim”
;

191 #ifdeà
USE_WINDOWS_STYLE_SOCKETS


192 
size_t
 
	tLa¡ResuÉTy³
;

194 
	tLa¡ResuÉTy³
;

196 ’um { 
LASTRESULT_NOWAIT
 = -1, 
LASTRESULT_SCHEDULED
 = -2, 
LASTRESULT_TIMEOUT
 = -3 };

197 
La¡ResuÉTy³
 
m_Ï¡ResuÉ
;

198 
m_§meResuÉCouÁ
;

199 
Tim”
 
m_noWa™Tim”
;

200 
	`S‘La¡ResuÉ
(
La¡ResuÉTy³
 
»suÉ
);

201 
	`D‘eùNoWa™
(
La¡ResuÉTy³
 
»suÉ
, 
C®lSck
 cÚ¡& 
ÿÎSck
);

202 
	}
};

204 
	gNAMESPACE_END


	@wake.cpp

3 
	~"pch.h
"

4 
	~"wake.h
"

6 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

8 
	$WAKE_Te¡In¡ªtŸtiÚs
()

10 
WAKE_OFB
<>::
Enüy±iÚ
 
x2
;

11 
WAKE_OFB
<>::
Deüy±iÚ
 
x4
;

12 
	}
}

14 
šlše
 
wÜd32
 
	gWAKE_Ba£
::
	$M
(
wÜd32
 
x
, wÜd32 
y
)

16 
wÜd32
 
w
 = 
x
+
y
;

17  (
w
>>8è^ 
t
[w & 0xff];

18 
	}
}

20 
	gWAKE_Ba£
::
	$G’Key
(
wÜd32
 
k0
, wÜd32 
k1
, wÜd32 
k2
, wÜd32 
k3
)

23 sigÃd 
x
, 
z
, 
p
;

25 
	`CRYPTOPP_COMPILE_ASSERT
((
x
) == 4);

26 
‰
[10]= {

35 
t
[0] = 
k0
;

36 
t
[1] = 
k1
;

37 
t
[2] = 
k2
;

38 
t
[3] = 
k3
;

39 
p
=4 ;…<256 ;…++)

41 
x
=
t
[
p
-4]+t[p-1] ;

42 
t
[
p
]ğ(
x
>>3è^ 
‰
[x&7] ;

45 
p
=0 ;…<23 ;…++)

46 
t
[
p
]+=t[p+89] ;

47 
x
=
t
[33] ; 
z
=t[59] | 0x01000001 ;

48 
z
=z&0xff7fffff ;

49 
p
=0 ;…<256 ;…++) {

50 
x
=(x&0xff7fffff)+
z
 ;

51 
t
[
p
]=Ñ[p] & 0x00ffffffè^ 
x
 ; }

53 
t
[256]=t[0] ;

54 
by‹
 
y
=
	`by‹
(
x
);

55 
p
=0 ;…<256 ;…++) {

56 
t
[
p
]ñ[
y
=
	`by‹
(t[p^y]^y)] ;

57 
t
[
y
]ñ[
p
+1] ; }

58 
	}
}

60 
	g‹m¶©e
 <
şass
 
	gB
>

61 
	gWAKE_PŞicy
<
	gB
>::
	$Ch”S‘Key
(cÚ¡ 
NameV®uePaœs
 &
·¿ms
, cÚ¡ 
by‹
 *
key
, 
size_t
 
Ëngth
)

63 
wÜd32
 
k0
, 
k1
, 
k2
, 
k3
;

64 
BlockG‘AndPut
<
wÜd32
, 
BigEndŸn
>::
	`G‘
(
key
)(
r3
)(
r4
)(
r5
)(
r6
)(
k0
)(
k1
)(
k2
)(
k3
);

65 
	`G’Key
(
k0
, 
k1
, 
k2
, 
k3
);

66 
	}
}

69 
	g‹m¶©e
 <
şass
 
	gB
>

70 
	gWAKE_PŞicy
<
	gB
>::
	$O³¿‹Key¡»am
(
Key¡»amO³¿tiÚ
 
İ”©iÚ
, 
by‹
 *
ouut
, cÚ¡ by‹ *
šput
, 
size_t
 
™”©iÚCouÁ
)

72 
	#WAKE_OUTPUT
(
x
)\

73 
™”©iÚCouÁ
--)\

75 
	`CRYPTOPP_KEYSTREAM_OUTPUT_WORD
(
x
, 
B
::
	`ToEnum
(), 0, 
r6
);\

76 
r3
 = 
	`M
Ô3, 
r6
);\

77 
r4
 = 
	`M
Ô4, 
r3
);\

78 
r5
 = 
	`M
Ô5, 
r4
);\

79 
r6
 = 
	`M
Ô6, 
r5
);\

80 
ouut
 += 4;\

81 ià(!(
x
 & 
INPUT_NULL
))\

82 
šput
 += 4;\

83 }

	)

85 
wÜd32
 
	tWÜdTy³
;

86 
	`CRYPTOPP_KEYSTREAM_OUTPUT_SWITCH
(
WAKE_OUTPUT
, 0);

87 
	}
}

104 
‹m¶©e
 
şass
 
	gWAKE_PŞicy
<
	gBigEndŸn
>;

105 
‹m¶©e
 
şass
 
	gWAKE_PŞicy
<
	gL™eEndŸn
>;

109 
	gNAMESPACE_END


	@wake.h

1 #iâdeà
CRYPTOPP_WAKE_H


2 
	#CRYPTOPP_WAKE_H


	)

4 
	~"£ckey.h
"

5 
	~"£cblock.h
"

6 
	~"¡rchr.h
"

8 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

11 
‹m¶©e
 <
şass
 
B
 = 
BigEndŸn
>

12 
WAKE_OFB_Info
 : 
public
 
FixedKeyL’gth
<32>

14 cÚ¡ *
	`SticAlgÜ™hmName
(è{ 
B
::
	`ToEnum
(è=ğ
LITTLE_ENDIAN_ORDER
 ? "WAKE-OFB-LE" : "WAKE-OFB-BE";}

15 
	}
};

17 şas 
	cCRYPTOPP_NO_VTABLE
 
	mWAKE_Ba£


19 
	m´Ùeùed
:

20 
wÜd32
 
M
(wÜd32 
x
, wÜd32 
y
);

21 
G’Key
(
wÜd32
 
k0
, wÜd32 
k1
, wÜd32 
k2
, wÜd32 
k3
);

23 
wÜd32
 
	mt
[257];

24 
wÜd32
 
	mr3
, 
	mr4
, 
	mr5
, 
	mr6
;

27 
	g‹m¶©e
 <
şass
 
	gB
 = 
BigEndŸn
>

28 
şass
 
CRYPTOPP_NO_VTABLE
 
WAKE_PŞicy
 : 
public
 
Add™iveCh”CÚü‘ePŞicy
<
wÜd32
, 1, 64>, 
´Ùeùed
 
	gWAKE_Ba£


30 
	g´Ùeùed
:

31 
Ch”S‘Key
(cÚ¡ 
NameV®uePaœs
 &
·¿ms
, cÚ¡ 
by‹
 *
key
, 
size_t
 
Ëngth
);

33 
O³¿‹Key¡»am
(
Key¡»amO³¿tiÚ
 
İ”©iÚ
, 
by‹
 *
ouut
, cÚ¡ by‹ *
šput
, 
size_t
 
™”©iÚCouÁ
);

34 
boŞ
 
Ch”IsRªdomAcûss
(ècÚ¡ { 
	gçl£
;}

38 
	g‹m¶©e
 <
şass
 
	gB
 = 
BigEndŸn
>

39 
WAKE_OFB
 : 
public
 
WAKE_OFB_Info
<
B
>,…ubliø
	gSymm‘ricCh”Docum’tiÚ


41 
	gSymm‘ricCh”Fš®
<
	tCÚü‘ePŞicyHŞd”
<
	tWAKE_PŞicy
<
	tB
>, 
	tAdd™iveCh”Tem¶©e
<> >, 
	tWAKE_OFB_Info
<B> > 
	tEnüy±iÚ
;

42 
Enüy±iÚ
 
	tDeüy±iÚ
;

61 
	gNAMESPACE_END


	@whrlpool.cpp

66 
	~"pch.h
"

67 
	~"wh¾poŞ.h
"

68 
	~"misc.h
"

69 
	~"ıu.h
"

71 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

73 
	$WhœÍoŞ_Te¡In¡ªtŸtiÚs
()

75 
WhœÍoŞ
 
x
;

76 
	}
}

78 
	gWhœÍoŞ
::
	$In™S‹
(
HashWÜdTy³
 *
¡©e
)

80 
	`mem£t
(
¡©e
, 0, 8*(state[0]));

81 
	}
}

83 
	gWhœÍoŞ
::
	$Trunÿ‹dFš®
(
by‹
 *
hash
, 
size_t
 
size
)

85 
	`ThrowIfInv®idTrunÿ‹dSize
(
size
);

87 
	`PadLa¡Block
(32);

88 
	`CÜ»ùEndŸÃss
(
m_d©a
, m_data, 32);

90 
m_d©a
[m_d©a.
	`size
()-4] = 0;

91 
m_d©a
[m_d©a.
	`size
()-3] = 0;

92 
m_d©a
[m_d©a.
	`size
()-2] = 
	`G‘B™CouÁHi
();

93 
m_d©a
[m_d©a.
	`size
()-1] = 
	`G‘B™CouÁLo
();

95 
	`T¿nsfÜm
(
m_¡©e
, 
m_d©a
);

96 
	`CÜ»ùEndŸÃss
(
m_¡©e
, m_¡©e, 
	`Dige¡Size
());

97 
	`memıy
(
hash
, 
m_¡©e
, 
size
);

99 
	`Re¡¬t
();

100 
	}
}

105 
	#R
 10

	)

114 #ià
CRYPTOPP_BOOL_SSE2_ASM_AVAILABLE


115 
	$CRYPTOPP_ALIGN_DATA
(16ècÚ¡ 
wÜd64
 
WhœÍoŞ_C
[4*256+
R
] 
CRYPTOPP_SECTION_ALIGN16
 = {

117 cÚ¡ 
wÜd64
 
WhœÍoŞ_C
[4*256+
R
] = {

119 
	`W64LIT
(0x18186018c07830d8), W64LIT(0x23238c2305af4626), W64LIT(0xc6c63fc67ef991b8), W64LIT(0xe8e887e8136fcdfb),

120 
	`W64LIT
(0x878726874ca113cb), W64LIT(0xb8b8dab8a9626d11), W64LIT(0x0101040108050209), W64LIT(0x4f4f214f426e9e0d),

121 
	`W64LIT
(0x3636d836adee6c9b), W64LIT(0xa6a6a2a6590451ff), W64LIT(0xd2d26fd2debdb90c), W64LIT(0xf5f5f3f5fb06f70e),

122 
	`W64LIT
(0x7979f979ef80f296), W64LIT(0x6f6fa16f5fcede30), W64LIT(0x91917e91fcef3f6d), W64LIT(0x52525552aa07a4f8),

123 
	`W64LIT
(0x60609d6027fdc047), W64LIT(0xbcbccabc89766535), W64LIT(0x9b9b569baccd2b37), W64LIT(0x8e8e028e048c018a),

124 
	`W64LIT
(0xa3a3b6a371155bd2), W64LIT(0x0c0c300c603c186c), W64LIT(0x7b7bf17bff8af684), W64LIT(0x3535d435b5e16a80),

125 
	`W64LIT
(0x1d1d741de8693af5), W64LIT(0xe0e0a7e05347ddb3), W64LIT(0xd7d77bd7f6acb321), W64LIT(0xc2c22fc25eed999c),

126 
	`W64LIT
(0x2e2eb82e6d965c43), W64LIT(0x4b4b314b627a9629), W64LIT(0xfefedffea321e15d), W64LIT(0x575741578216aed5),

127 
	`W64LIT
(0x15155415a8412abd), W64LIT(0x7777c1779fb6eee8), W64LIT(0x3737dc37a5eb6e92), W64LIT(0xe5e5b3e57b56d79e),

128 
	`W64LIT
(0x9f9f469f8cd92313), W64LIT(0xf0f0e7f0d317fd23), W64LIT(0x4a4a354a6a7f9420), W64LIT(0xdada4fda9e95a944),

129 
	`W64LIT
(0x58587d58fa25b0a2), W64LIT(0xc9c903c906ca8fcf), W64LIT(0x2929a429558d527c), W64LIT(0x0a0a280a5022145a),

130 
	`W64LIT
(0xb1b1feb1e14f7f50), W64LIT(0xa0a0baa0691a5dc9), W64LIT(0x6b6bb16b7fdad614), W64LIT(0x85852e855cab17d9),

131 
	`W64LIT
(0xbdbdcebd8173673c), W64LIT(0x5d5d695dd234ba8f), W64LIT(0x1010401080502090), W64LIT(0xf4f4f7f4f303f507),

132 
	`W64LIT
(0xcbcb0bcb16c08bdd), W64LIT(0x3e3ef83eedc67cd3), W64LIT(0x0505140528110a2d), W64LIT(0x676781671fe6ce78),

133 
	`W64LIT
(0xe4e4b7e47353d597), W64LIT(0x27279c2725bb4e02), W64LIT(0x4141194132588273), W64LIT(0x8b8b168b2c9d0ba7),

134 
	`W64LIT
(0xa7a7a6a7510153f6), W64LIT(0x7d7de97dcf94fab2), W64LIT(0x95956e95dcfb3749), W64LIT(0xd8d847d88e9fad56),

135 
	`W64LIT
(0xfbfbcbfb8b30eb70), W64LIT(0xeeee9fee2371c1cd), W64LIT(0x7c7ced7cc791f8bb), W64LIT(0x6666856617e3cc71),

136 
	`W64LIT
(0xdddd53dda68ea77b), W64LIT(0x17175c17b84b2eaf), W64LIT(0x4747014702468e45), W64LIT(0x9e9e429e84dc211a),

137 
	`W64LIT
(0xcaca0fca1ec589d4), W64LIT(0x2d2db42d75995a58), W64LIT(0xbfbfc6bf9179632e), W64LIT(0x07071c07381b0e3f),

138 
	`W64LIT
(0xadad8ead012347ac), W64LIT(0x5a5a755aea2fb4b0), W64LIT(0x838336836cb51bef), W64LIT(0x3333cc3385ff66b6),

139 
	`W64LIT
(0x636391633ff2c65c), W64LIT(0x02020802100a0412), W64LIT(0xaaaa92aa39384993), W64LIT(0x7171d971afa8e2de),

140 
	`W64LIT
(0xc8c807c80ecf8dc6), W64LIT(0x19196419c87d32d1), W64LIT(0x494939497270923b), W64LIT(0xd9d943d9869aaf5f),

141 
	`W64LIT
(0xf2f2eff2c31df931), W64LIT(0xe3e3abe34b48dba8), W64LIT(0x5b5b715be22ab6b9), W64LIT(0x88881a8834920dbc),

142 
	`W64LIT
(0x9a9a529aa4c8293e), W64LIT(0x262698262dbe4c0b), W64LIT(0x3232c8328dfa64bf), W64LIT(0xb0b0fab0e94a7d59),

143 
	`W64LIT
(0xe9e983e91b6acff2), W64LIT(0x0f0f3c0f78331e77), W64LIT(0xd5d573d5e6a6b733), W64LIT(0x80803a8074ba1df4),

144 
	`W64LIT
(0xbebec2be997c6127), W64LIT(0xcdcd13cd26de87eb), W64LIT(0x3434d034bde46889), W64LIT(0x48483d487a759032),

145 
	`W64LIT
(0xffffdbffab24e354), W64LIT(0x7a7af57af78ff48d), W64LIT(0x90907a90f4ea3d64), W64LIT(0x5f5f615fc23ebe9d),

146 
	`W64LIT
(0x202080201da0403d), W64LIT(0x6868bd6867d5d00f), W64LIT(0x1a1a681ad07234ca), W64LIT(0xaeae82ae192c41b7),

147 
	`W64LIT
(0xb4b4eab4c95e757d), W64LIT(0x54544d549a19a8ce), W64LIT(0x93937693ece53b7f), W64LIT(0x222288220daa442f),

148 
	`W64LIT
(0x64648d6407e9c863), W64LIT(0xf1f1e3f1db12ff2a), W64LIT(0x7373d173bfa2e6cc), W64LIT(0x12124812905a2482),

149 
	`W64LIT
(0x40401d403a5d807a), W64LIT(0x0808200840281048), W64LIT(0xc3c32bc356e89b95), W64LIT(0xecec97ec337bc5df),

150 
	`W64LIT
(0xdbdb4bdb9690ab4d), W64LIT(0xa1a1bea1611f5fc0), W64LIT(0x8d8d0e8d1c830791), W64LIT(0x3d3df43df5c97ac8),

151 
	`W64LIT
(0x97976697ccf1335b), W64LIT(0x0000000000000000), W64LIT(0xcfcf1bcf36d483f9), W64LIT(0x2b2bac2b4587566e),

152 
	`W64LIT
(0x7676c57697b3ece1), W64LIT(0x8282328264b019e6), W64LIT(0xd6d67fd6fea9b128), W64LIT(0x1b1b6c1bd87736c3),

153 
	`W64LIT
(0xb5b5eeb5c15b7774), W64LIT(0xafaf86af112943be), W64LIT(0x6a6ab56a77dfd41d), W64LIT(0x50505d50ba0da0ea),

154 
	`W64LIT
(0x45450945124c8a57), W64LIT(0xf3f3ebf3cb18fb38), W64LIT(0x3030c0309df060ad), W64LIT(0xefef9bef2b74c3c4),

155 
	`W64LIT
(0x3f3ffc3fe5c37eda), W64LIT(0x55554955921caac7), W64LIT(0xa2a2b2a2791059db), W64LIT(0xeaea8fea0365c9e9),

156 
	`W64LIT
(0x656589650fecca6a), W64LIT(0xbabad2bab9686903), W64LIT(0x2f2fbc2f65935e4a), W64LIT(0xc0c027c04ee79d8e),

157 
	`W64LIT
(0xdede5fdebe81a160), W64LIT(0x1c1c701ce06c38fc), W64LIT(0xfdfdd3fdbb2ee746), W64LIT(0x4d4d294d52649a1f),

158 
	`W64LIT
(0x92927292e4e03976), W64LIT(0x7575c9758fbceafa), W64LIT(0x06061806301e0c36), W64LIT(0x8a8a128a249809ae),

159 
	`W64LIT
(0xb2b2f2b2f940794b), W64LIT(0xe6e6bfe66359d185), W64LIT(0x0e0e380e70361c7e), W64LIT(0x1f1f7c1ff8633ee7),

160 
	`W64LIT
(0x6262956237f7c455), W64LIT(0xd4d477d4eea3b53a), W64LIT(0xa8a89aa829324d81), W64LIT(0x96966296c4f43152),

161 
	`W64LIT
(0xf9f9c3f99b3aef62), W64LIT(0xc5c533c566f697a3), W64LIT(0x2525942535b14a10), W64LIT(0x59597959f220b2ab),

162 
	`W64LIT
(0x84842a8454ae15d0), W64LIT(0x7272d572b7a7e4c5), W64LIT(0x3939e439d5dd72ec), W64LIT(0x4c4c2d4c5a619816),

163 
	`W64LIT
(0x5e5e655eca3bbc94), W64LIT(0x7878fd78e785f09f), W64LIT(0x3838e038ddd870e5), W64LIT(0x8c8c0a8c14860598),

164 
	`W64LIT
(0xd1d163d1c6b2bf17), W64LIT(0xa5a5aea5410b57e4), W64LIT(0xe2e2afe2434dd9a1), W64LIT(0x616199612ff8c24e),

165 
	`W64LIT
(0xb3b3f6b3f1457b42), W64LIT(0x2121842115a54234), W64LIT(0x9c9c4a9c94d62508), W64LIT(0x1e1e781ef0663cee),

166 
	`W64LIT
(0x4343114322528661), W64LIT(0xc7c73bc776fc93b1), W64LIT(0xfcfcd7fcb32be54f), W64LIT(0x0404100420140824),

167 
	`W64LIT
(0x51515951b208a2e3), W64LIT(0x99995e99bcc72f25), W64LIT(0x6d6da96d4fc4da22), W64LIT(0x0d0d340d68391a65),

168 
	`W64LIT
(0xfafacffa8335e979), W64LIT(0xdfdf5bdfb684a369), W64LIT(0x7e7ee57ed79bfca9), W64LIT(0x242490243db44819),

169 
	`W64LIT
(0x3b3bec3bc5d776fe), W64LIT(0xabab96ab313d4b9a), W64LIT(0xcece1fce3ed181f0), W64LIT(0x1111441188552299),

170 
	`W64LIT
(0x8f8f068f0c890383), W64LIT(0x4e4e254e4a6b9c04), W64LIT(0xb7b7e6b7d1517366), W64LIT(0xebeb8beb0b60cbe0),

171 
	`W64LIT
(0x3c3cf03cfdcc78c1), W64LIT(0x81813e817cbf1ffd), W64LIT(0x94946a94d4fe3540), W64LIT(0xf7f7fbf7eb0cf31c),

172 
	`W64LIT
(0xb9b9deb9a1676f18), W64LIT(0x13134c13985f268b), W64LIT(0x2c2cb02c7d9c5851), W64LIT(0xd3d36bd3d6b8bb05),

173 
	`W64LIT
(0xe7e7bbe76b5cd38c), W64LIT(0x6e6ea56e57cbdc39), W64LIT(0xc4c437c46ef395aa), W64LIT(0x03030c03180f061b),

174 
	`W64LIT
(0x565645568a13acdc), W64LIT(0x44440d441a49885e), W64LIT(0x7f7fe17fdf9efea0), W64LIT(0xa9a99ea921374f88),

175 
	`W64LIT
(0x2a2aa82a4d825467), W64LIT(0xbbbbd6bbb16d6b0a), W64LIT(0xc1c123c146e29f87), W64LIT(0x53535153a202a6f1),

176 
	`W64LIT
(0xdcdc57dcae8ba572), W64LIT(0x0b0b2c0b58271653), W64LIT(0x9d9d4e9d9cd32701), W64LIT(0x6c6cad6c47c1d82b),

177 
	`W64LIT
(0x3131c43195f562a4), W64LIT(0x7474cd7487b9e8f3), W64LIT(0xf6f6fff6e309f115), W64LIT(0x464605460a438c4c),

178 
	`W64LIT
(0xacac8aac092645a5), W64LIT(0x89891e893c970fb5), W64LIT(0x14145014a04428b4), W64LIT(0xe1e1a3e15b42dfba),

179 
	`W64LIT
(0x16165816b04e2ca6), W64LIT(0x3a3ae83acdd274f7), W64LIT(0x6969b9696fd0d206), W64LIT(0x09092409482d1241),

180 
	`W64LIT
(0x7070dd70a7ade0d7), W64LIT(0xb6b6e2b6d954716f), W64LIT(0xd0d067d0ceb7bd1e), W64LIT(0xeded93ed3b7ec7d6),

181 
	`W64LIT
(0xcccc17cc2edb85e2), W64LIT(0x424215422a578468), W64LIT(0x98985a98b4c22d2c), W64LIT(0xa4a4aaa4490e55ed),

182 
	`W64LIT
(0x2828a0285d885075), W64LIT(0x5c5c6d5cda31b886), W64LIT(0xf8f8c7f8933fed6b), W64LIT(0x8686228644a411c2),

184 
	`W64LIT
(0xd818186018c07830), W64LIT(0x2623238c2305af46), W64LIT(0xb8c6c63fc67ef991), W64LIT(0xfbe8e887e8136fcd),

185 
	`W64LIT
(0xcb878726874ca113), W64LIT(0x11b8b8dab8a9626d), W64LIT(0x0901010401080502), W64LIT(0x0d4f4f214f426e9e),

186 
	`W64LIT
(0x9b3636d836adee6c), W64LIT(0xffa6a6a2a6590451), W64LIT(0x0cd2d26fd2debdb9), W64LIT(0x0ef5f5f3f5fb06f7),

187 
	`W64LIT
(0x967979f979ef80f2), W64LIT(0x306f6fa16f5fcede), W64LIT(0x6d91917e91fcef3f), W64LIT(0xf852525552aa07a4),

188 
	`W64LIT
(0x4760609d6027fdc0), W64LIT(0x35bcbccabc897665), W64LIT(0x379b9b569baccd2b), W64LIT(0x8a8e8e028e048c01),

189 
	`W64LIT
(0xd2a3a3b6a371155b), W64LIT(0x6c0c0c300c603c18), W64LIT(0x847b7bf17bff8af6), W64LIT(0x803535d435b5e16a),

190 
	`W64LIT
(0xf51d1d741de8693a), W64LIT(0xb3e0e0a7e05347dd), W64LIT(0x21d7d77bd7f6acb3), W64LIT(0x9cc2c22fc25eed99),

191 
	`W64LIT
(0x432e2eb82e6d965c), W64LIT(0x294b4b314b627a96), W64LIT(0x5dfefedffea321e1), W64LIT(0xd5575741578216ae),

192 
	`W64LIT
(0xbd15155415a8412a), W64LIT(0xe87777c1779fb6ee), W64LIT(0x923737dc37a5eb6e), W64LIT(0x9ee5e5b3e57b56d7),

193 
	`W64LIT
(0x139f9f469f8cd923), W64LIT(0x23f0f0e7f0d317fd), W64LIT(0x204a4a354a6a7f94), W64LIT(0x44dada4fda9e95a9),

194 
	`W64LIT
(0xa258587d58fa25b0), W64LIT(0xcfc9c903c906ca8f), W64LIT(0x7c2929a429558d52), W64LIT(0x5a0a0a280a502214),

195 
	`W64LIT
(0x50b1b1feb1e14f7f), W64LIT(0xc9a0a0baa0691a5d), W64LIT(0x146b6bb16b7fdad6), W64LIT(0xd985852e855cab17),

196 
	`W64LIT
(0x3cbdbdcebd817367), W64LIT(0x8f5d5d695dd234ba), W64LIT(0x9010104010805020), W64LIT(0x07f4f4f7f4f303f5),

197 
	`W64LIT
(0xddcbcb0bcb16c08b), W64LIT(0xd33e3ef83eedc67c), W64LIT(0x2d0505140528110a), W64LIT(0x78676781671fe6ce),

198 
	`W64LIT
(0x97e4e4b7e47353d5), W64LIT(0x0227279c2725bb4e), W64LIT(0x7341411941325882), W64LIT(0xa78b8b168b2c9d0b),

199 
	`W64LIT
(0xf6a7a7a6a7510153), W64LIT(0xb27d7de97dcf94fa), W64LIT(0x4995956e95dcfb37), W64LIT(0x56d8d847d88e9fad),

200 
	`W64LIT
(0x70fbfbcbfb8b30eb), W64LIT(0xcdeeee9fee2371c1), W64LIT(0xbb7c7ced7cc791f8), W64LIT(0x716666856617e3cc),

201 
	`W64LIT
(0x7bdddd53dda68ea7), W64LIT(0xaf17175c17b84b2e), W64LIT(0x454747014702468e), W64LIT(0x1a9e9e429e84dc21),

202 
	`W64LIT
(0xd4caca0fca1ec589), W64LIT(0x582d2db42d75995a), W64LIT(0x2ebfbfc6bf917963), W64LIT(0x3f07071c07381b0e),

203 
	`W64LIT
(0xacadad8ead012347), W64LIT(0xb05a5a755aea2fb4), W64LIT(0xef838336836cb51b), W64LIT(0xb63333cc3385ff66),

204 
	`W64LIT
(0x5c636391633ff2c6), W64LIT(0x1202020802100a04), W64LIT(0x93aaaa92aa393849), W64LIT(0xde7171d971afa8e2),

205 
	`W64LIT
(0xc6c8c807c80ecf8d), W64LIT(0xd119196419c87d32), W64LIT(0x3b49493949727092), W64LIT(0x5fd9d943d9869aaf),

206 
	`W64LIT
(0x31f2f2eff2c31df9), W64LIT(0xa8e3e3abe34b48db), W64LIT(0xb95b5b715be22ab6), W64LIT(0xbc88881a8834920d),

207 
	`W64LIT
(0x3e9a9a529aa4c829), W64LIT(0x0b262698262dbe4c), W64LIT(0xbf3232c8328dfa64), W64LIT(0x59b0b0fab0e94a7d),

208 
	`W64LIT
(0xf2e9e983e91b6acf), W64LIT(0x770f0f3c0f78331e), W64LIT(0x33d5d573d5e6a6b7), W64LIT(0xf480803a8074ba1d),

209 
	`W64LIT
(0x27bebec2be997c61), W64LIT(0xebcdcd13cd26de87), W64LIT(0x893434d034bde468), W64LIT(0x3248483d487a7590),

210 
	`W64LIT
(0x54ffffdbffab24e3), W64LIT(0x8d7a7af57af78ff4), W64LIT(0x6490907a90f4ea3d), W64LIT(0x9d5f5f615fc23ebe),

211 
	`W64LIT
(0x3d202080201da040), W64LIT(0x0f6868bd6867d5d0), W64LIT(0xca1a1a681ad07234), W64LIT(0xb7aeae82ae192c41),

212 
	`W64LIT
(0x7db4b4eab4c95e75), W64LIT(0xce54544d549a19a8), W64LIT(0x7f93937693ece53b), W64LIT(0x2f222288220daa44),

213 
	`W64LIT
(0x6364648d6407e9c8), W64LIT(0x2af1f1e3f1db12ff), W64LIT(0xcc7373d173bfa2e6), W64LIT(0x8212124812905a24),

214 
	`W64LIT
(0x7a40401d403a5d80), W64LIT(0x4808082008402810), W64LIT(0x95c3c32bc356e89b), W64LIT(0xdfecec97ec337bc5),

215 
	`W64LIT
(0x4ddbdb4bdb9690ab), W64LIT(0xc0a1a1bea1611f5f), W64LIT(0x918d8d0e8d1c8307), W64LIT(0xc83d3df43df5c97a),

216 
	`W64LIT
(0x5b97976697ccf133), W64LIT(0x0000000000000000), W64LIT(0xf9cfcf1bcf36d483), W64LIT(0x6e2b2bac2b458756),

217 
	`W64LIT
(0xe17676c57697b3ec), W64LIT(0xe68282328264b019), W64LIT(0x28d6d67fd6fea9b1), W64LIT(0xc31b1b6c1bd87736),

218 
	`W64LIT
(0x74b5b5eeb5c15b77), W64LIT(0xbeafaf86af112943), W64LIT(0x1d6a6ab56a77dfd4), W64LIT(0xea50505d50ba0da0),

219 
	`W64LIT
(0x5745450945124c8a), W64LIT(0x38f3f3ebf3cb18fb), W64LIT(0xad3030c0309df060), W64LIT(0xc4efef9bef2b74c3),

220 
	`W64LIT
(0xda3f3ffc3fe5c37e), W64LIT(0xc755554955921caa), W64LIT(0xdba2a2b2a2791059), W64LIT(0xe9eaea8fea0365c9),

221 
	`W64LIT
(0x6a656589650fecca), W64LIT(0x03babad2bab96869), W64LIT(0x4a2f2fbc2f65935e), W64LIT(0x8ec0c027c04ee79d),

222 
	`W64LIT
(0x60dede5fdebe81a1), W64LIT(0xfc1c1c701ce06c38), W64LIT(0x46fdfdd3fdbb2ee7), W64LIT(0x1f4d4d294d52649a),

223 
	`W64LIT
(0x7692927292e4e039), W64LIT(0xfa7575c9758fbcea), W64LIT(0x3606061806301e0c), W64LIT(0xae8a8a128a249809),

224 
	`W64LIT
(0x4bb2b2f2b2f94079), W64LIT(0x85e6e6bfe66359d1), W64LIT(0x7e0e0e380e70361c), W64LIT(0xe71f1f7c1ff8633e),

225 
	`W64LIT
(0x556262956237f7c4), W64LIT(0x3ad4d477d4eea3b5), W64LIT(0x81a8a89aa829324d), W64LIT(0x5296966296c4f431),

226 
	`W64LIT
(0x62f9f9c3f99b3aef), W64LIT(0xa3c5c533c566f697), W64LIT(0x102525942535b14a), W64LIT(0xab59597959f220b2),

227 
	`W64LIT
(0xd084842a8454ae15), W64LIT(0xc57272d572b7a7e4), W64LIT(0xec3939e439d5dd72), W64LIT(0x164c4c2d4c5a6198),

228 
	`W64LIT
(0x945e5e655eca3bbc), W64LIT(0x9f7878fd78e785f0), W64LIT(0xe53838e038ddd870), W64LIT(0x988c8c0a8c148605),

229 
	`W64LIT
(0x17d1d163d1c6b2bf), W64LIT(0xe4a5a5aea5410b57), W64LIT(0xa1e2e2afe2434dd9), W64LIT(0x4e616199612ff8c2),

230 
	`W64LIT
(0x42b3b3f6b3f1457b), W64LIT(0x342121842115a542), W64LIT(0x089c9c4a9c94d625), W64LIT(0xee1e1e781ef0663c),

231 
	`W64LIT
(0x6143431143225286), W64LIT(0xb1c7c73bc776fc93), W64LIT(0x4ffcfcd7fcb32be5), W64LIT(0x2404041004201408),

232 
	`W64LIT
(0xe351515951b208a2), W64LIT(0x2599995e99bcc72f), W64LIT(0x226d6da96d4fc4da), W64LIT(0x650d0d340d68391a),

233 
	`W64LIT
(0x79fafacffa8335e9), W64LIT(0x69dfdf5bdfb684a3), W64LIT(0xa97e7ee57ed79bfc), W64LIT(0x19242490243db448),

234 
	`W64LIT
(0xfe3b3bec3bc5d776), W64LIT(0x9aabab96ab313d4b), W64LIT(0xf0cece1fce3ed181), W64LIT(0x9911114411885522),

235 
	`W64LIT
(0x838f8f068f0c8903), W64LIT(0x044e4e254e4a6b9c), W64LIT(0x66b7b7e6b7d15173), W64LIT(0xe0ebeb8beb0b60cb),

236 
	`W64LIT
(0xc13c3cf03cfdcc78), W64LIT(0xfd81813e817cbf1f), W64LIT(0x4094946a94d4fe35), W64LIT(0x1cf7f7fbf7eb0cf3),

237 
	`W64LIT
(0x18b9b9deb9a1676f), W64LIT(0x8b13134c13985f26), W64LIT(0x512c2cb02c7d9c58), W64LIT(0x05d3d36bd3d6b8bb),

238 
	`W64LIT
(0x8ce7e7bbe76b5cd3), W64LIT(0x396e6ea56e57cbdc), W64LIT(0xaac4c437c46ef395), W64LIT(0x1b03030c03180f06),

239 
	`W64LIT
(0xdc565645568a13ac), W64LIT(0x5e44440d441a4988), W64LIT(0xa07f7fe17fdf9efe), W64LIT(0x88a9a99ea921374f),

240 
	`W64LIT
(0x672a2aa82a4d8254), W64LIT(0x0abbbbd6bbb16d6b), W64LIT(0x87c1c123c146e29f), W64LIT(0xf153535153a202a6),

241 
	`W64LIT
(0x72dcdc57dcae8ba5), W64LIT(0x530b0b2c0b582716), W64LIT(0x019d9d4e9d9cd327), W64LIT(0x2b6c6cad6c47c1d8),

242 
	`W64LIT
(0xa43131c43195f562), W64LIT(0xf37474cd7487b9e8), W64LIT(0x15f6f6fff6e309f1), W64LIT(0x4c464605460a438c),

243 
	`W64LIT
(0xa5acac8aac092645), W64LIT(0xb589891e893c970f), W64LIT(0xb414145014a04428), W64LIT(0xbae1e1a3e15b42df),

244 
	`W64LIT
(0xa616165816b04e2c), W64LIT(0xf73a3ae83acdd274), W64LIT(0x066969b9696fd0d2), W64LIT(0x4109092409482d12),

245 
	`W64LIT
(0xd77070dd70a7ade0), W64LIT(0x6fb6b6e2b6d95471), W64LIT(0x1ed0d067d0ceb7bd), W64LIT(0xd6eded93ed3b7ec7),

246 
	`W64LIT
(0xe2cccc17cc2edb85), W64LIT(0x68424215422a5784), W64LIT(0x2c98985a98b4c22d), W64LIT(0xeda4a4aaa4490e55),

247 
	`W64LIT
(0x752828a0285d8850), W64LIT(0x865c5c6d5cda31b8), W64LIT(0x6bf8f8c7f8933fed), W64LIT(0xc28686228644a411),

249 
	`W64LIT
(0x30d818186018c078), W64LIT(0x462623238c2305af), W64LIT(0x91b8c6c63fc67ef9), W64LIT(0xcdfbe8e887e8136f),

250 
	`W64LIT
(0x13cb878726874ca1), W64LIT(0x6d11b8b8dab8a962), W64LIT(0x0209010104010805), W64LIT(0x9e0d4f4f214f426e),

251 
	`W64LIT
(0x6c9b3636d836adee), W64LIT(0x51ffa6a6a2a65904), W64LIT(0xb90cd2d26fd2debd), W64LIT(0xf70ef5f5f3f5fb06),

252 
	`W64LIT
(0xf2967979f979ef80), W64LIT(0xde306f6fa16f5fce), W64LIT(0x3f6d91917e91fcef), W64LIT(0xa4f852525552aa07),

253 
	`W64LIT
(0xc04760609d6027fd), W64LIT(0x6535bcbccabc8976), W64LIT(0x2b379b9b569baccd), W64LIT(0x018a8e8e028e048c),

254 
	`W64LIT
(0x5bd2a3a3b6a37115), W64LIT(0x186c0c0c300c603c), W64LIT(0xf6847b7bf17bff8a), W64LIT(0x6a803535d435b5e1),

255 
	`W64LIT
(0x3af51d1d741de869), W64LIT(0xddb3e0e0a7e05347), W64LIT(0xb321d7d77bd7f6ac), W64LIT(0x999cc2c22fc25eed),

256 
	`W64LIT
(0x5c432e2eb82e6d96), W64LIT(0x96294b4b314b627a), W64LIT(0xe15dfefedffea321), W64LIT(0xaed5575741578216),

257 
	`W64LIT
(0x2abd15155415a841), W64LIT(0xeee87777c1779fb6), W64LIT(0x6e923737dc37a5eb), W64LIT(0xd79ee5e5b3e57b56),

258 
	`W64LIT
(0x23139f9f469f8cd9), W64LIT(0xfd23f0f0e7f0d317), W64LIT(0x94204a4a354a6a7f), W64LIT(0xa944dada4fda9e95),

259 
	`W64LIT
(0xb0a258587d58fa25), W64LIT(0x8fcfc9c903c906ca), W64LIT(0x527c2929a429558d), W64LIT(0x145a0a0a280a5022),

260 
	`W64LIT
(0x7f50b1b1feb1e14f), W64LIT(0x5dc9a0a0baa0691a), W64LIT(0xd6146b6bb16b7fda), W64LIT(0x17d985852e855cab),

261 
	`W64LIT
(0x673cbdbdcebd8173), W64LIT(0xba8f5d5d695dd234), W64LIT(0x2090101040108050), W64LIT(0xf507f4f4f7f4f303),

262 
	`W64LIT
(0x8bddcbcb0bcb16c0), W64LIT(0x7cd33e3ef83eedc6), W64LIT(0x0a2d050514052811), W64LIT(0xce78676781671fe6),

263 
	`W64LIT
(0xd597e4e4b7e47353), W64LIT(0x4e0227279c2725bb), W64LIT(0x8273414119413258), W64LIT(0x0ba78b8b168b2c9d),

264 
	`W64LIT
(0x53f6a7a7a6a75101), W64LIT(0xfab27d7de97dcf94), W64LIT(0x374995956e95dcfb), W64LIT(0xad56d8d847d88e9f),

265 
	`W64LIT
(0xeb70fbfbcbfb8b30), W64LIT(0xc1cdeeee9fee2371), W64LIT(0xf8bb7c7ced7cc791), W64LIT(0xcc716666856617e3),

266 
	`W64LIT
(0xa77bdddd53dda68e), W64LIT(0x2eaf17175c17b84b), W64LIT(0x8e45474701470246), W64LIT(0x211a9e9e429e84dc),

267 
	`W64LIT
(0x89d4caca0fca1ec5), W64LIT(0x5a582d2db42d7599), W64LIT(0x632ebfbfc6bf9179), W64LIT(0x0e3f07071c07381b),

268 
	`W64LIT
(0x47acadad8ead0123), W64LIT(0xb4b05a5a755aea2f), W64LIT(0x1bef838336836cb5), W64LIT(0x66b63333cc3385ff),

269 
	`W64LIT
(0xc65c636391633ff2), W64LIT(0x041202020802100a), W64LIT(0x4993aaaa92aa3938), W64LIT(0xe2de7171d971afa8),

270 
	`W64LIT
(0x8dc6c8c807c80ecf), W64LIT(0x32d119196419c87d), W64LIT(0x923b494939497270), W64LIT(0xaf5fd9d943d9869a),

271 
	`W64LIT
(0xf931f2f2eff2c31d), W64LIT(0xdba8e3e3abe34b48), W64LIT(0xb6b95b5b715be22a), W64LIT(0x0dbc88881a883492),

272 
	`W64LIT
(0x293e9a9a529aa4c8), W64LIT(0x4c0b262698262dbe), W64LIT(0x64bf3232c8328dfa), W64LIT(0x7d59b0b0fab0e94a),

273 
	`W64LIT
(0xcff2e9e983e91b6a), W64LIT(0x1e770f0f3c0f7833), W64LIT(0xb733d5d573d5e6a6), W64LIT(0x1df480803a8074ba),

274 
	`W64LIT
(0x6127bebec2be997c), W64LIT(0x87ebcdcd13cd26de), W64LIT(0x68893434d034bde4), W64LIT(0x903248483d487a75),

275 
	`W64LIT
(0xe354ffffdbffab24), W64LIT(0xf48d7a7af57af78f), W64LIT(0x3d6490907a90f4ea), W64LIT(0xbe9d5f5f615fc23e),

276 
	`W64LIT
(0x403d202080201da0), W64LIT(0xd00f6868bd6867d5), W64LIT(0x34ca1a1a681ad072), W64LIT(0x41b7aeae82ae192c),

277 
	`W64LIT
(0x757db4b4eab4c95e), W64LIT(0xa8ce54544d549a19), W64LIT(0x3b7f93937693ece5), W64LIT(0x442f222288220daa),

278 
	`W64LIT
(0xc86364648d6407e9), W64LIT(0xff2af1f1e3f1db12), W64LIT(0xe6cc7373d173bfa2), W64LIT(0x248212124812905a),

279 
	`W64LIT
(0x807a40401d403a5d), W64LIT(0x1048080820084028), W64LIT(0x9b95c3c32bc356e8), W64LIT(0xc5dfecec97ec337b),

280 
	`W64LIT
(0xab4ddbdb4bdb9690), W64LIT(0x5fc0a1a1bea1611f), W64LIT(0x07918d8d0e8d1c83), W64LIT(0x7ac83d3df43df5c9),

281 
	`W64LIT
(0x335b97976697ccf1), W64LIT(0x0000000000000000), W64LIT(0x83f9cfcf1bcf36d4), W64LIT(0x566e2b2bac2b4587),

282 
	`W64LIT
(0xece17676c57697b3), W64LIT(0x19e68282328264b0), W64LIT(0xb128d6d67fd6fea9), W64LIT(0x36c31b1b6c1bd877),

283 
	`W64LIT
(0x7774b5b5eeb5c15b), W64LIT(0x43beafaf86af1129), W64LIT(0xd41d6a6ab56a77df), W64LIT(0xa0ea50505d50ba0d),

284 
	`W64LIT
(0x8a5745450945124c), W64LIT(0xfb38f3f3ebf3cb18), W64LIT(0x60ad3030c0309df0), W64LIT(0xc3c4efef9bef2b74),

285 
	`W64LIT
(0x7eda3f3ffc3fe5c3), W64LIT(0xaac755554955921c), W64LIT(0x59dba2a2b2a27910), W64LIT(0xc9e9eaea8fea0365),

286 
	`W64LIT
(0xca6a656589650fec), W64LIT(0x6903babad2bab968), W64LIT(0x5e4a2f2fbc2f6593), W64LIT(0x9d8ec0c027c04ee7),

287 
	`W64LIT
(0xa160dede5fdebe81), W64LIT(0x38fc1c1c701ce06c), W64LIT(0xe746fdfdd3fdbb2e), W64LIT(0x9a1f4d4d294d5264),

288 
	`W64LIT
(0x397692927292e4e0), W64LIT(0xeafa7575c9758fbc), W64LIT(0x0c3606061806301e), W64LIT(0x09ae8a8a128a2498),

289 
	`W64LIT
(0x794bb2b2f2b2f940), W64LIT(0xd185e6e6bfe66359), W64LIT(0x1c7e0e0e380e7036), W64LIT(0x3ee71f1f7c1ff863),

290 
	`W64LIT
(0xc4556262956237f7), W64LIT(0xb53ad4d477d4eea3), W64LIT(0x4d81a8a89aa82932), W64LIT(0x315296966296c4f4),

291 
	`W64LIT
(0xef62f9f9c3f99b3a), W64LIT(0x97a3c5c533c566f6), W64LIT(0x4a102525942535b1), W64LIT(0xb2ab59597959f220),

292 
	`W64LIT
(0x15d084842a8454ae), W64LIT(0xe4c57272d572b7a7), W64LIT(0x72ec3939e439d5dd), W64LIT(0x98164c4c2d4c5a61),

293 
	`W64LIT
(0xbc945e5e655eca3b), W64LIT(0xf09f7878fd78e785), W64LIT(0x70e53838e038ddd8), W64LIT(0x05988c8c0a8c1486),

294 
	`W64LIT
(0xbf17d1d163d1c6b2), W64LIT(0x57e4a5a5aea5410b), W64LIT(0xd9a1e2e2afe2434d), W64LIT(0xc24e616199612ff8),

295 
	`W64LIT
(0x7b42b3b3f6b3f145), W64LIT(0x42342121842115a5), W64LIT(0x25089c9c4a9c94d6), W64LIT(0x3cee1e1e781ef066),

296 
	`W64LIT
(0x8661434311432252), W64LIT(0x93b1c7c73bc776fc), W64LIT(0xe54ffcfcd7fcb32b), W64LIT(0x0824040410042014),

297 
	`W64LIT
(0xa2e351515951b208), W64LIT(0x2f2599995e99bcc7), W64LIT(0xda226d6da96d4fc4), W64LIT(0x1a650d0d340d6839),

298 
	`W64LIT
(0xe979fafacffa8335), W64LIT(0xa369dfdf5bdfb684), W64LIT(0xfca97e7ee57ed79b), W64LIT(0x4819242490243db4),

299 
	`W64LIT
(0x76fe3b3bec3bc5d7), W64LIT(0x4b9aabab96ab313d), W64LIT(0x81f0cece1fce3ed1), W64LIT(0x2299111144118855),

300 
	`W64LIT
(0x03838f8f068f0c89), W64LIT(0x9c044e4e254e4a6b), W64LIT(0x7366b7b7e6b7d151), W64LIT(0xcbe0ebeb8beb0b60),

301 
	`W64LIT
(0x78c13c3cf03cfdcc), W64LIT(0x1ffd81813e817cbf), W64LIT(0x354094946a94d4fe), W64LIT(0xf31cf7f7fbf7eb0c),

302 
	`W64LIT
(0x6f18b9b9deb9a167), W64LIT(0x268b13134c13985f), W64LIT(0x58512c2cb02c7d9c), W64LIT(0xbb05d3d36bd3d6b8),

303 
	`W64LIT
(0xd38ce7e7bbe76b5c), W64LIT(0xdc396e6ea56e57cb), W64LIT(0x95aac4c437c46ef3), W64LIT(0x061b03030c03180f),

304 
	`W64LIT
(0xacdc565645568a13), W64LIT(0x885e44440d441a49), W64LIT(0xfea07f7fe17fdf9e), W64LIT(0x4f88a9a99ea92137),

305 
	`W64LIT
(0x54672a2aa82a4d82), W64LIT(0x6b0abbbbd6bbb16d), W64LIT(0x9f87c1c123c146e2), W64LIT(0xa6f153535153a202),

306 
	`W64LIT
(0xa572dcdc57dcae8b), W64LIT(0x16530b0b2c0b5827), W64LIT(0x27019d9d4e9d9cd3), W64LIT(0xd82b6c6cad6c47c1),

307 
	`W64LIT
(0x62a43131c43195f5), W64LIT(0xe8f37474cd7487b9), W64LIT(0xf115f6f6fff6e309), W64LIT(0x8c4c464605460a43),

308 
	`W64LIT
(0x45a5acac8aac0926), W64LIT(0x0fb589891e893c97), W64LIT(0x28b414145014a044), W64LIT(0xdfbae1e1a3e15b42),

309 
	`W64LIT
(0x2ca616165816b04e), W64LIT(0x74f73a3ae83acdd2), W64LIT(0xd2066969b9696fd0), W64LIT(0x124109092409482d),

310 
	`W64LIT
(0xe0d77070dd70a7ad), W64LIT(0x716fb6b6e2b6d954), W64LIT(0xbd1ed0d067d0ceb7), W64LIT(0xc7d6eded93ed3b7e),

311 
	`W64LIT
(0x85e2cccc17cc2edb), W64LIT(0x8468424215422a57), W64LIT(0x2d2c98985a98b4c2), W64LIT(0x55eda4a4aaa4490e),

312 
	`W64LIT
(0x50752828a0285d88), W64LIT(0xb8865c5c6d5cda31), W64LIT(0xed6bf8f8c7f8933f), W64LIT(0x11c28686228644a4),

314 
	`W64LIT
(0x7830d818186018c0), W64LIT(0xaf462623238c2305), W64LIT(0xf991b8c6c63fc67e), W64LIT(0x6fcdfbe8e887e813),

315 
	`W64LIT
(0xa113cb878726874c), W64LIT(0x626d11b8b8dab8a9), W64LIT(0x0502090101040108), W64LIT(0x6e9e0d4f4f214f42),

316 
	`W64LIT
(0xee6c9b3636d836ad), W64LIT(0x0451ffa6a6a2a659), W64LIT(0xbdb90cd2d26fd2de), W64LIT(0x06f70ef5f5f3f5fb),

317 
	`W64LIT
(0x80f2967979f979ef), W64LIT(0xcede306f6fa16f5f), W64LIT(0xef3f6d91917e91fc), W64LIT(0x07a4f852525552aa),

318 
	`W64LIT
(0xfdc04760609d6027), W64LIT(0x766535bcbccabc89), W64LIT(0xcd2b379b9b569bac), W64LIT(0x8c018a8e8e028e04),

319 
	`W64LIT
(0x155bd2a3a3b6a371), W64LIT(0x3c186c0c0c300c60), W64LIT(0x8af6847b7bf17bff), W64LIT(0xe16a803535d435b5),

320 
	`W64LIT
(0x693af51d1d741de8), W64LIT(0x47ddb3e0e0a7e053), W64LIT(0xacb321d7d77bd7f6), W64LIT(0xed999cc2c22fc25e),

321 
	`W64LIT
(0x965c432e2eb82e6d), W64LIT(0x7a96294b4b314b62), W64LIT(0x21e15dfefedffea3), W64LIT(0x16aed55757415782),

322 
	`W64LIT
(0x412abd15155415a8), W64LIT(0xb6eee87777c1779f), W64LIT(0xeb6e923737dc37a5), W64LIT(0x56d79ee5e5b3e57b),

323 
	`W64LIT
(0xd923139f9f469f8c), W64LIT(0x17fd23f0f0e7f0d3), W64LIT(0x7f94204a4a354a6a), W64LIT(0x95a944dada4fda9e),

324 
	`W64LIT
(0x25b0a258587d58fa), W64LIT(0xca8fcfc9c903c906), W64LIT(0x8d527c2929a42955), W64LIT(0x22145a0a0a280a50),

325 
	`W64LIT
(0x4f7f50b1b1feb1e1), W64LIT(0x1a5dc9a0a0baa069), W64LIT(0xdad6146b6bb16b7f), W64LIT(0xab17d985852e855c),

326 
	`W64LIT
(0x73673cbdbdcebd81), W64LIT(0x34ba8f5d5d695dd2), W64LIT(0x5020901010401080), W64LIT(0x03f507f4f4f7f4f3),

327 
	`W64LIT
(0xc08bddcbcb0bcb16), W64LIT(0xc67cd33e3ef83eed), W64LIT(0x110a2d0505140528), W64LIT(0xe6ce78676781671f),

328 
	`W64LIT
(0x53d597e4e4b7e473), W64LIT(0xbb4e0227279c2725), W64LIT(0x5882734141194132), W64LIT(0x9d0ba78b8b168b2c),

329 
	`W64LIT
(0x0153f6a7a7a6a751), W64LIT(0x94fab27d7de97dcf), W64LIT(0xfb374995956e95dc), W64LIT(0x9fad56d8d847d88e),

330 
	`W64LIT
(0x30eb70fbfbcbfb8b), W64LIT(0x71c1cdeeee9fee23), W64LIT(0x91f8bb7c7ced7cc7), W64LIT(0xe3cc716666856617),

331 
	`W64LIT
(0x8ea77bdddd53dda6), W64LIT(0x4b2eaf17175c17b8), W64LIT(0x468e454747014702), W64LIT(0xdc211a9e9e429e84),

332 
	`W64LIT
(0xc589d4caca0fca1e), W64LIT(0x995a582d2db42d75), W64LIT(0x79632ebfbfc6bf91), W64LIT(0x1b0e3f07071c0738),

333 
	`W64LIT
(0x2347acadad8ead01), W64LIT(0x2fb4b05a5a755aea), W64LIT(0xb51bef838336836c), W64LIT(0xff66b63333cc3385),

334 
	`W64LIT
(0xf2c65c636391633f), W64LIT(0x0a04120202080210), W64LIT(0x384993aaaa92aa39), W64LIT(0xa8e2de7171d971af),

335 
	`W64LIT
(0xcf8dc6c8c807c80e), W64LIT(0x7d32d119196419c8), W64LIT(0x70923b4949394972), W64LIT(0x9aaf5fd9d943d986),

336 
	`W64LIT
(0x1df931f2f2eff2c3), W64LIT(0x48dba8e3e3abe34b), W64LIT(0x2ab6b95b5b715be2), W64LIT(0x920dbc88881a8834),

337 
	`W64LIT
(0xc8293e9a9a529aa4), W64LIT(0xbe4c0b262698262d), W64LIT(0xfa64bf3232c8328d), W64LIT(0x4a7d59b0b0fab0e9),

338 
	`W64LIT
(0x6acff2e9e983e91b), W64LIT(0x331e770f0f3c0f78), W64LIT(0xa6b733d5d573d5e6), W64LIT(0xba1df480803a8074),

339 
	`W64LIT
(0x7c6127bebec2be99), W64LIT(0xde87ebcdcd13cd26), W64LIT(0xe468893434d034bd), W64LIT(0x75903248483d487a),

340 
	`W64LIT
(0x24e354ffffdbffab), W64LIT(0x8ff48d7a7af57af7), W64LIT(0xea3d6490907a90f4), W64LIT(0x3ebe9d5f5f615fc2),

341 
	`W64LIT
(0xa0403d202080201d), W64LIT(0xd5d00f6868bd6867), W64LIT(0x7234ca1a1a681ad0), W64LIT(0x2c41b7aeae82ae19),

342 
	`W64LIT
(0x5e757db4b4eab4c9), W64LIT(0x19a8ce54544d549a), W64LIT(0xe53b7f93937693ec), W64LIT(0xaa442f222288220d),

343 
	`W64LIT
(0xe9c86364648d6407), W64LIT(0x12ff2af1f1e3f1db), W64LIT(0xa2e6cc7373d173bf), W64LIT(0x5a24821212481290),

344 
	`W64LIT
(0x5d807a40401d403a), W64LIT(0x2810480808200840), W64LIT(0xe89b95c3c32bc356), W64LIT(0x7bc5dfecec97ec33),

345 
	`W64LIT
(0x90ab4ddbdb4bdb96), W64LIT(0x1f5fc0a1a1bea161), W64LIT(0x8307918d8d0e8d1c), W64LIT(0xc97ac83d3df43df5),

346 
	`W64LIT
(0xf1335b97976697cc), W64LIT(0x0000000000000000), W64LIT(0xd483f9cfcf1bcf36), W64LIT(0x87566e2b2bac2b45),

347 
	`W64LIT
(0xb3ece17676c57697), W64LIT(0xb019e68282328264), W64LIT(0xa9b128d6d67fd6fe), W64LIT(0x7736c31b1b6c1bd8),

348 
	`W64LIT
(0x5b7774b5b5eeb5c1), W64LIT(0x2943beafaf86af11), W64LIT(0xdfd41d6a6ab56a77), W64LIT(0x0da0ea50505d50ba),

349 
	`W64LIT
(0x4c8a574545094512), W64LIT(0x18fb38f3f3ebf3cb), W64LIT(0xf060ad3030c0309d), W64LIT(0x74c3c4efef9bef2b),

350 
	`W64LIT
(0xc37eda3f3ffc3fe5), W64LIT(0x1caac75555495592), W64LIT(0x1059dba2a2b2a279), W64LIT(0x65c9e9eaea8fea03),

351 
	`W64LIT
(0xecca6a656589650f), W64LIT(0x686903babad2bab9), W64LIT(0x935e4a2f2fbc2f65), W64LIT(0xe79d8ec0c027c04e),

352 
	`W64LIT
(0x81a160dede5fdebe), W64LIT(0x6c38fc1c1c701ce0), W64LIT(0x2ee746fdfdd3fdbb), W64LIT(0x649a1f4d4d294d52),

353 
	`W64LIT
(0xe0397692927292e4), W64LIT(0xbceafa7575c9758f), W64LIT(0x1e0c360606180630), W64LIT(0x9809ae8a8a128a24),

354 
	`W64LIT
(0x40794bb2b2f2b2f9), W64LIT(0x59d185e6e6bfe663), W64LIT(0x361c7e0e0e380e70), W64LIT(0x633ee71f1f7c1ff8),

355 
	`W64LIT
(0xf7c4556262956237), W64LIT(0xa3b53ad4d477d4ee), W64LIT(0x324d81a8a89aa829), W64LIT(0xf4315296966296c4),

356 
	`W64LIT
(0x3aef62f9f9c3f99b), W64LIT(0xf697a3c5c533c566), W64LIT(0xb14a102525942535), W64LIT(0x20b2ab59597959f2),

357 
	`W64LIT
(0xae15d084842a8454), W64LIT(0xa7e4c57272d572b7), W64LIT(0xdd72ec3939e439d5), W64LIT(0x6198164c4c2d4c5a),

358 
	`W64LIT
(0x3bbc945e5e655eca), W64LIT(0x85f09f7878fd78e7), W64LIT(0xd870e53838e038dd), W64LIT(0x8605988c8c0a8c14),

359 
	`W64LIT
(0xb2bf17d1d163d1c6), W64LIT(0x0b57e4a5a5aea541), W64LIT(0x4dd9a1e2e2afe243), W64LIT(0xf8c24e616199612f),

360 
	`W64LIT
(0x457b42b3b3f6b3f1), W64LIT(0xa542342121842115), W64LIT(0xd625089c9c4a9c94), W64LIT(0x663cee1e1e781ef0),

361 
	`W64LIT
(0x5286614343114322), W64LIT(0xfc93b1c7c73bc776), W64LIT(0x2be54ffcfcd7fcb3), W64LIT(0x1408240404100420),

362 
	`W64LIT
(0x08a2e351515951b2), W64LIT(0xc72f2599995e99bc), W64LIT(0xc4da226d6da96d4f), W64LIT(0x391a650d0d340d68),

363 
	`W64LIT
(0x35e979fafacffa83), W64LIT(0x84a369dfdf5bdfb6), W64LIT(0x9bfca97e7ee57ed7), W64LIT(0xb44819242490243d),

364 
	`W64LIT
(0xd776fe3b3bec3bc5), W64LIT(0x3d4b9aabab96ab31), W64LIT(0xd181f0cece1fce3e), W64LIT(0x5522991111441188),

365 
	`W64LIT
(0x8903838f8f068f0c), W64LIT(0x6b9c044e4e254e4a), W64LIT(0x517366b7b7e6b7d1), W64LIT(0x60cbe0ebeb8beb0b),

366 
	`W64LIT
(0xcc78c13c3cf03cfd), W64LIT(0xbf1ffd81813e817c), W64LIT(0xfe354094946a94d4), W64LIT(0x0cf31cf7f7fbf7eb),

367 
	`W64LIT
(0x676f18b9b9deb9a1), W64LIT(0x5f268b13134c1398), W64LIT(0x9c58512c2cb02c7d), W64LIT(0xb8bb05d3d36bd3d6),

368 
	`W64LIT
(0x5cd38ce7e7bbe76b), W64LIT(0xcbdc396e6ea56e57), W64LIT(0xf395aac4c437c46e), W64LIT(0x0f061b03030c0318),

369 
	`W64LIT
(0x13acdc565645568a), W64LIT(0x49885e44440d441a), W64LIT(0x9efea07f7fe17fdf), W64LIT(0x374f88a9a99ea921),

370 
	`W64LIT
(0x8254672a2aa82a4d), W64LIT(0x6d6b0abbbbd6bbb1), W64LIT(0xe29f87c1c123c146), W64LIT(0x02a6f153535153a2),

371 
	`W64LIT
(0x8ba572dcdc57dcae), W64LIT(0x2716530b0b2c0b58), W64LIT(0xd327019d9d4e9d9c), W64LIT(0xc1d82b6c6cad6c47),

372 
	`W64LIT
(0xf562a43131c43195), W64LIT(0xb9e8f37474cd7487), W64LIT(0x09f115f6f6fff6e3), W64LIT(0x438c4c464605460a),

373 
	`W64LIT
(0x2645a5acac8aac09), W64LIT(0x970fb589891e893c), W64LIT(0x4428b414145014a0), W64LIT(0x42dfbae1e1a3e15b),

374 
	`W64LIT
(0x4e2ca616165816b0), W64LIT(0xd274f73a3ae83acd), W64LIT(0xd0d2066969b9696f), W64LIT(0x2d12410909240948),

375 
	`W64LIT
(0xade0d77070dd70a7), W64LIT(0x54716fb6b6e2b6d9), W64LIT(0xb7bd1ed0d067d0ce), W64LIT(0x7ec7d6eded93ed3b),

376 
	`W64LIT
(0xdb85e2cccc17cc2e), W64LIT(0x578468424215422a), W64LIT(0xc22d2c98985a98b4), W64LIT(0x0e55eda4a4aaa449),

377 
	`W64LIT
(0x8850752828a0285d), W64LIT(0x31b8865c5c6d5cda), W64LIT(0x3fed6bf8f8c7f893), W64LIT(0xa411c28686228644),

379 
	`W64LIT
(0x1823c6e887b8014f),

380 
	`W64LIT
(0x36a6d2f5796f9152),

381 
	`W64LIT
(0x60bc9b8ea30c7b35),

382 
	`W64LIT
(0x1de0d7c22e4bfe57),

383 
	`W64LIT
(0x157737e59ff04ada),

384 
	`W64LIT
(0x58c9290ab1a06b85),

385 
	`W64LIT
(0xbd5d10f4cb3e0567),

386 
	`W64LIT
(0xe427418ba77d95d8),

387 
	`W64LIT
(0xfbee7c66dd17479e),

388 
	`W64LIT
(0xca2dbf07ad5a8333)

389 
	}
};

392 
	gWhœÍoŞ
::
	$T¿nsfÜm
(
wÜd64
 *
dige¡
, cÚ¡ wÜd64 *
block
)

394 #ià
CRYPTOPP_BOOL_SSE2_ASM_AVAILABLE


395 ià(
	`HasISSE
())

398 #ifdeà
__GNUC__


399 #ià
CRYPTOPP_BOOL_X64


400 
wÜd64
 
wÜk¥aû
[16];

402 
__asm__
 
__vŞ©e__


405 
	`AS_PUSH_IF86
Ğ
bx
)

406 
	`AS2
Ğ
mov
 
AS_REG_6
, 
	`WORD_REG
(
ax
))

408 #ià
_MSC_VER
 < 1300

409 
	`AS_PUSH_IF86
Ğ
bx
)

411 
	`AS2
Ğ
Ëa
 
AS_REG_6
, [
WhœÍoŞ_C
])

412 
	`AS2
Ğ
mov
 
	`WORD_REG
(
cx
), 
dige¡
)

413 
	`AS2
Ğ
mov
 
	`WORD_REG
(
dx
), 
block
)

415 #ià
CRYPTOPP_BOOL_X86


416 
	`AS2
Ğ
mov
 
—x
, 
e¥
)

417 
	`AS2
Ğ
ªd
 
e¥
, -16)

418 
	`AS2
Ğ
sub
 
e¥
, 16*8)

419 
	`AS1
Ğ
push
 
—x
)

420 
	#SSE2_wÜk¥aû
 
e¥
+
WORD_SZ


	)

422 
	#SSE2_wÜk¥aû
 %3

	)

424 
	`AS2
Ğ
xÜ
 
esi
,ƒsi)

425 
	`ASL
(0)

426 
	`AS2
Ğ
movq
 
mm0
, [
	`WORD_REG
(
cx
)+8*WORD_REG(
si
)])

427 
	`AS2
Ğ
movq
 [
SSE2_wÜk¥aû
+8*
	`WORD_REG
(
si
)], 
mm0
)

428 
	`AS2
Ğ
pxÜ
 
mm0
, [
	`WORD_REG
(
dx
)+8*WORD_REG(
si
)])

429 
	`AS2
Ğ
movq
 [
SSE2_wÜk¥aû
+64+8*
	`WORD_REG
(
si
)], 
mm0
)

430 
	`AS2
Ğ
movq
 [
	`WORD_REG
(
cx
)+8*WORD_REG(
si
)], 
mm0
)

431 
	`AS1
Ğ
šc
 
	`WORD_REG
(
si
))

432 
	`AS2
Ğ
cmp
 
	`WORD_REG
(
si
), 8)

433 
	`ASJ
Ğ
jÃ
, 0, 
b
)

435 
	`AS2
Ğ
xÜ
 
esi
,ƒsi)

436 
	`ASL
(1)

438 
	#KSL0
(
a
, 
b
è
	`AS2
(
movq
 
mm
##a, b)

	)

439 
	#KSL1
(
a
, 
b
è
	`AS2
(
pxÜ
 
mm
##a, b)

	)

441 
	#KSL
(
İ
, 
i
, 
a
, 
b
, 
c
, 
d
) \

442 
	`AS2
(
mov
 
—x
, [
SSE2_wÜk¥aû
+8*
i
])\

443 
	`AS2
(
movzx
 
edi
, 
®
)\

444 
KSL
##
	`İ
(
a
, [
AS_REG_6
+3*2048+8*
	`WORD_REG
(
di
)])\

445 
	`AS2
(
movzx
 
edi
, 
ah
)\

446 
KSL
##
	`İ
(
b
, [
AS_REG_6
+2*2048+8*
	`WORD_REG
(
di
)])\

447 
	`AS2
(
shr
 
—x
, 16)\

448 
	`AS2
(
movzx
 
edi
, 
®
)\

449 
	`AS2
(
shr
 
—x
, 8)\

450 
KSL
##
	`İ
(
c
, [
AS_REG_6
+1*2048+8*
	`WORD_REG
(
di
)])\

451 
KSL
##
	`İ
(
d
, [
AS_REG_6
+0*2048+8*
	`WORD_REG
(
ax
)])

	)

453 
	#KSH0
(
a
, 
b
) \

454 
	`ASS
(
pshufw
 
mm
##
a
, mm##a, 1, 0, 3, 2)\

455 
	`AS2
(
pxÜ
 
mm
##
a
, 
b
)

	)

456 
	#KSH1
(
a
, 
b
) \

457 
	`AS2
(
pxÜ
 
mm
##
a
, 
b
)

	)

458 
	#KSH2
(
a
, 
b
) \

459 
	`AS2
(
pxÜ
 
mm
##
a
, 
b
)\

460 
	`AS2
(
movq
 [
SSE2_wÜk¥aû
+8*
a
], 
mm
##a)

	)

462 
	#KSH
(
İ
, 
i
, 
a
, 
b
, 
c
, 
d
) \

463 
	`AS2
(
mov
 
—x
, [
SSE2_wÜk¥aû
+8*((
i
+4)-8*((i+4)/8))+4])\

464 
	`AS2
(
movzx
 
edi
, 
®
)\

465 
KSH
##
	`İ
(
a
, [
AS_REG_6
+3*2048+8*
	`WORD_REG
(
di
)])\

466 
	`AS2
(
movzx
 
edi
, 
ah
)\

467 
KSH
##
	`İ
(
b
, [
AS_REG_6
+2*2048+8*
	`WORD_REG
(
di
)])\

468 
	`AS2
(
shr
 
—x
, 16)\

469 
	`AS2
(
movzx
 
edi
, 
®
)\

470 
	`AS2
(
shr
 
—x
, 8)\

471 
KSH
##
	`İ
(
c
, [
AS_REG_6
+1*2048+8*
	`WORD_REG
(
di
)])\

472 
KSH
##
	`İ
(
d
, [
AS_REG_6
+0*2048+8*
	`WORD_REG
(
ax
)])

	)

474 
	#TSL
(
İ
, 
i
, 
a
, 
b
, 
c
, 
d
) \

475 
	`AS2
(
mov
 
—x
, [
SSE2_wÜk¥aû
+64+8*
i
])\

476 
	`AS2
(
movzx
 
edi
, 
®
)\

477 
KSL
##
	`İ
(
a
, [
AS_REG_6
+3*2048+8*
	`WORD_REG
(
di
)])\

478 
	`AS2
(
movzx
 
edi
, 
ah
)\

479 
KSL
##
	`İ
(
b
, [
AS_REG_6
+2*2048+8*
	`WORD_REG
(
di
)])\

480 
	`AS2
(
shr
 
—x
, 16)\

481 
	`AS2
(
movzx
 
edi
, 
®
)\

482 
	`AS2
(
shr
 
—x
, 8)\

483 
KSL
##
	`İ
(
c
, [
AS_REG_6
+1*2048+8*
	`WORD_REG
(
di
)])\

484 
KSL
##
	`İ
(
d
, [
AS_REG_6
+0*2048+8*
	`WORD_REG
(
ax
)])

	)

486 
	#TSH0
(
a
, 
b
) \

487 
	`ASS
(
pshufw
 
mm
##
a
, mm##a, 1, 0, 3, 2)\

488 
	`AS2
(
pxÜ
 
mm
##
a
, [
SSE2_wÜk¥aû
+8*a])\

489 
	`AS2
(
pxÜ
 
mm
##
a
, 
b
)

	)

490 
	#TSH1
(
a
, 
b
) \

491 
	`AS2
(
pxÜ
 
mm
##
a
, 
b
)

	)

492 
	#TSH2
(
a
, 
b
) \

493 
	`AS2
(
pxÜ
 
mm
##
a
, 
b
)\

494 
	`AS2
(
movq
 [
SSE2_wÜk¥aû
+64+8*
a
], 
mm
##a)

	)

495 
	#TSH3
(
a
, 
b
) \

496 
	`AS2
(
pxÜ
 
mm
##
a
, 
b
)\

497 
	`AS2
(
pxÜ
 
mm
##
a
, [
	`WORD_REG
(
cx
)+8*a])\

498 
	`AS2
(
movq
 [
	`WORD_REG
(
cx
)+8*
a
], 
mm
##a)

	)

500 
	#TSH
(
İ
, 
i
, 
a
, 
b
, 
c
, 
d
) \

501 
	`AS2
(
mov
 
—x
, [
SSE2_wÜk¥aû
+64+8*((
i
+4)-8*((i+4)/8))+4])\

502 
	`AS2
(
movzx
 
edi
, 
®
)\

503 
TSH
##
	`İ
(
a
, [
AS_REG_6
+3*2048+8*
	`WORD_REG
(
di
)])\

504 
	`AS2
(
movzx
 
edi
, 
ah
)\

505 
TSH
##
	`İ
(
b
, [
AS_REG_6
+2*2048+8*
	`WORD_REG
(
di
)])\

506 
	`AS2
(
shr
 
—x
, 16)\

507 
	`AS2
(
movzx
 
edi
, 
®
)\

508 
	`AS2
(
shr
 
—x
, 8)\

509 
TSH
##
	`İ
(
c
, [
AS_REG_6
+1*2048+8*
	`WORD_REG
(
di
)])\

510 
TSH
##
	`İ
(
d
, [
AS_REG_6
+0*2048+8*
	`WORD_REG
(
ax
)])

	)

512 
	`KSL
(0, 4, 3, 2, 1, 0)

513 
	`KSL
(0, 0, 7, 6, 5, 4)

514 
	`KSL
(1, 1, 0, 7, 6, 5)

515 
	`KSL
(1, 2, 1, 0, 7, 6)

516 
	`KSL
(1, 3, 2, 1, 0, 7)

517 
	`KSL
(1, 5, 4, 3, 2, 1)

518 
	`KSL
(1, 6, 5, 4, 3, 2)

519 
	`KSL
(1, 7, 6, 5, 4, 3)

520 
	`KSH
(0, 0, 7, 6, 5, 4)

521 
	`KSH
(0, 4, 3, 2, 1, 0)

522 
	`KSH
(1, 1, 0, 7, 6, 5)

523 
	`KSH
(1, 2, 1, 0, 7, 6)

524 
	`KSH
(1, 5, 4, 3, 2, 1)

525 
	`KSH
(1, 6, 5, 4, 3, 2)

526 
	`KSH
(2, 3, 2, 1, 0, 7)

527 
	`KSH
(2, 7, 6, 5, 4, 3)

529 
	`AS2
Ğ
pxÜ
 
mm0
, [
AS_REG_6
 + 8*1024 + 
	`WORD_REG
(
si
)*8])

530 
	`AS2
Ğ
movq
 [
SSE2_wÜk¥aû
], 
mm0
)

532 
	`TSL
(0, 4, 3, 2, 1, 0)

533 
	`TSL
(0, 0, 7, 6, 5, 4)

534 
	`TSL
(1, 1, 0, 7, 6, 5)

535 
	`TSL
(1, 2, 1, 0, 7, 6)

536 
	`TSL
(1, 3, 2, 1, 0, 7)

537 
	`TSL
(1, 5, 4, 3, 2, 1)

538 
	`TSL
(1, 6, 5, 4, 3, 2)

539 
	`TSL
(1, 7, 6, 5, 4, 3)

540 
	`TSH
(0, 0, 7, 6, 5, 4)

541 
	`TSH
(0, 4, 3, 2, 1, 0)

542 
	`TSH
(1, 1, 0, 7, 6, 5)

543 
	`TSH
(1, 2, 1, 0, 7, 6)

544 
	`TSH
(1, 5, 4, 3, 2, 1)

545 
	`TSH
(1, 6, 5, 4, 3, 2)

547 
	`AS1
Ğ
šc
 
	`WORD_REG
(
si
))

548 
	`AS2
Ğ
cmp
 
	`WORD_REG
(
si
), 10)

549 
	`ASJ
Ğ
je
, 2, 
f
)

551 
	`TSH
(2, 3, 2, 1, 0, 7)

552 
	`TSH
(2, 7, 6, 5, 4, 3)

554 
	`ASJ
Ğ
jmp
, 1, 
b
)

555 
	`ASL
(2)

557 
	`TSH
(3, 3, 2, 1, 0, 7)

558 
	`TSH
(3, 7, 6, 5, 4, 3)

560 #undeà
KSL


561 #undeà
KSH


562 #undeà
TSL


563 #undeà
TSH


565 
	`AS_POP_IF86
Ğ
¥
)

566 
	`AS1
Ğ
emms
)

568 #ià
	`defšed
(
__GNUC__
è|| (defšed(
_MSC_VER
) && _MSC_VER < 1300)

569 
	`AS_POP_IF86
Ğ
bx
)

571 #ifdeà
__GNUC__


574 : "a" (
WhœÍoŞ_C
), "c" (
dige¡
), "d" (
block
)

575 #ià
CRYPTOPP_BOOL_X64


576 , "r" (
wÜk¥aû
)

579 #ià
CRYPTOPP_BOOL_X64


588 
wÜd64
 
s
[8];

589 
wÜd64
 
k
[8];

593 
i
=0; i<8; i++)

594 
dige¡
[
i
] = 
s
[i] = 
block
[i] ^ (
k
[i] = digest[i]);

596 
	#KSL
(
İ
, 
i
, 
a
, 
b
, 
c
, 
d
) \

597 
t
 = (
wÜd32
)
k
[
i
];\

598 
w
##
a
 = 
WhœÍoŞ_C
[3*256 + (
by‹
)
t
] ^ (
İ
 ? w##a : 0);\

599 
t
 >>= 8;\

600 
w
##
b
 = 
WhœÍoŞ_C
[2*256 + (
by‹
)
t
] ^ (
İ
 ? w##b : 0);\

601 
t
 >>= 8;\

602 
w
##
c
 = 
WhœÍoŞ_C
[1*256 + (
by‹
)
t
] ^ (
İ
 ? w##c : 0);\

603 
t
 >>= 8;\

604 
w
##
d
 = 
WhœÍoŞ_C
[0*256 + 
t
] ^ (
İ
 ? w##d : 0);

	)

606 
	#KSH
(
İ
, 
i
, 
a
, 
b
, 
c
, 
d
) \

607 
t
 = (
wÜd32
)(
k
[(
i
+4)%8]>>32);\

608 
w
##
a
 = 
WhœÍoŞ_C
[3*256 + (
by‹
)
t
] ^ (
İ
 ? w##¨: 
	`rÙrFixed
(w##a, 32));\

609 ià(
İ
==2è
k
[
a
] = 
w
##a;\

610 
t
 >>= 8;\

611 
w
##
b
 = 
WhœÍoŞ_C
[2*256 + (
by‹
)
t
] ^ (
İ
 ? w##b : 
	`rÙrFixed
(w##b, 32));\

612 ià(
İ
==2è
k
[
b
] = 
w
##b;\

613 
t
 >>= 8;\

614 
w
##
c
 = 
WhœÍoŞ_C
[1*256 + (
by‹
)
t
] ^ (
İ
 ? w##ø: 
	`rÙrFixed
(w##c, 32));\

615 ià(
İ
==2è
k
[
c
] = 
w
##c;\

616 
t
 >>= 8;\

617 
w
##
d
 = 
WhœÍoŞ_C
[0*256 + 
t
] ^ (
İ
 ? w##d : 
	`rÙrFixed
(w##d, 32));\

618 ià(
İ
==2è
k
[
d
] = 
w
##d;\

619 

	)

620 
	#TSL
(
İ
, 
i
, 
a
, 
b
, 
c
, 
d
) \

621 
t
 = (
wÜd32
)
s
[
i
];\

622 
w
##
a
 = 
WhœÍoŞ_C
[3*256 + (
by‹
)
t
] ^ (
İ
 ? w##a : 0);\

623 
t
 >>= 8;\

624 
w
##
b
 = 
WhœÍoŞ_C
[2*256 + (
by‹
)
t
] ^ (
İ
 ? w##b : 0);\

625 
t
 >>= 8;\

626 
w
##
c
 = 
WhœÍoŞ_C
[1*256 + (
by‹
)
t
] ^ (
İ
 ? w##c : 0);\

627 
t
 >>= 8;\

628 
w
##
d
 = 
WhœÍoŞ_C
[0*256 + 
t
] ^ (
İ
 ? w##d : 0);

	)

630 
	#TSH_OP
(
İ
, 
a
, 
b
) \

631 
w
##
a
 = 
WhœÍoŞ_C
[
b
*256 + (
by‹
)
t
] ^ (
İ
 ? w##¨: 
	`rÙrFixed
(w##a, 32è^ 
k
[a]);\

632 ià(
İ
==2è
s
[
a
] = 
w
##a;\

633 ià(
İ
==3è
dige¡
[
a
] ^ğ
w
##a;\

634 

	)

635 
	#TSH
(
İ
, 
i
, 
a
, 
b
, 
c
, 
d
) \

636 
t
 = (
wÜd32
)(
s
[(
i
+4)%8]>>32);\

637 
	`TSH_OP
(
İ
, 
a
, 3);\

638 
t
 >>= 8;\

639 
	`TSH_OP
(
İ
, 
b
, 2);\

640 
t
 >>= 8;\

641 
	`TSH_OP
(
İ
, 
c
, 1);\

642 
t
 >>= 8;\

643 
	`TSH_OP
(
İ
, 
d
, 0);\

644 

	)

646 
r
=0;

647 
Œue
)

649 
wÜd64
 
w0
, 
w1
, 
w2
, 
w3
, 
w4
, 
w5
, 
w6
, 
w7
;

650 
wÜd32
 
t
;

652 
	`KSL
(0, 4, 3, 2, 1, 0)

653 
	`KSL
(0, 0, 7, 6, 5, 4)

654 
	`KSL
(1, 1, 0, 7, 6, 5)

655 
	`KSL
(1, 2, 1, 0, 7, 6)

656 
	`KSL
(1, 3, 2, 1, 0, 7)

657 
	`KSL
(1, 5, 4, 3, 2, 1)

658 
	`KSL
(1, 6, 5, 4, 3, 2)

659 
	`KSL
(1, 7, 6, 5, 4, 3)

660 
	`KSH
(0, 0, 7, 6, 5, 4)

661 
	`KSH
(0, 4, 3, 2, 1, 0)

662 
	`KSH
(1, 1, 0, 7, 6, 5)

663 
	`KSH
(1, 2, 1, 0, 7, 6)

664 
	`KSH
(1, 5, 4, 3, 2, 1)

665 
	`KSH
(1, 6, 5, 4, 3, 2)

666 
	`KSH
(2, 3, 2, 1, 0, 7)

667 
	`KSH
(2, 7, 6, 5, 4, 3)

669 
k
[0] ^ğ
WhœÍoŞ_C
[1024+
r
];

671 
	`TSL
(0, 4, 3, 2, 1, 0)

672 
	`TSL
(0, 0, 7, 6, 5, 4)

673 
	`TSL
(1, 1, 0, 7, 6, 5)

674 
	`TSL
(1, 2, 1, 0, 7, 6)

675 
	`TSL
(1, 3, 2, 1, 0, 7)

676 
	`TSL
(1, 5, 4, 3, 2, 1)

677 
	`TSL
(1, 6, 5, 4, 3, 2)

678 
	`TSL
(1, 7, 6, 5, 4, 3)

679 
	`TSH
(0, 0, 7, 6, 5, 4)

680 
	`TSH
(0, 4, 3, 2, 1, 0)

681 
	`TSH
(1, 1, 0, 7, 6, 5)

682 
	`TSH
(1, 2, 1, 0, 7, 6)

683 
	`TSH
(1, 5, 4, 3, 2, 1)

684 
	`TSH
(1, 6, 5, 4, 3, 2)

686 ià(++
r
 < 
R
)

688 
	`TSH
(2, 3, 2, 1, 0, 7)

689 
	`TSH
(2, 7, 6, 5, 4, 3)

693 
	`TSH
(3, 3, 2, 1, 0, 7)

694 
	`TSH
(3, 7, 6, 5, 4, 3)

699 
	}
}

701 
	gNAMESPACE_END


	@whrlpool.h

1 #iâdeà
CRYPTOPP_WHIRLPOOL_H


2 
	#CRYPTOPP_WHIRLPOOL_H


	)

4 
	~"cÚfig.h
"

5 
	~"™”hash.h
"

7 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

10 
şass
 
WhœÍoŞ
 : 
public
 
I‹¿‹dHashW™hSticT¿nsfÜm
<
wÜd64
, 
BigEndŸn
, 64, 64, Whirlpool>

12 
public
:

13 
	`In™S‹
(
HashWÜdTy³
 *
¡©e
);

14 
	`T¿nsfÜm
(
wÜd64
 *
dige¡
, cÚ¡ wÜd64 *
d©a
);

15 
	`Trunÿ‹dFš®
(
by‹
 *
hash
, 
size_t
 
size
);

16 cÚ¡ * 
	`SticAlgÜ™hmName
() { "Whirlpool";}

17 
	}
};

19 
	gNAMESPACE_END


	@winpipes.cpp

3 
	~"pch.h
"

4 
	~"wšpes.h
"

6 #ifdeà
WINDOWS_PIPES_AVAILABLE


8 
	~"wa™.h
"

10 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

12 
WšdowsHªdË
::
	$WšdowsHªdË
(
HANDLE
 
h
, 
boŞ
 
own
)

13 : 
	`m_h
(
h
), 
	$m_own
(
own
)

15 
	}
}

17 
	gWšdowsHªdË
::~
	$WšdowsHªdË
()

19 ià(
m_own
)

21 
Œy


23 
	`Clo£HªdË
();

25 
	`ÿtch
 (...)

29 
	}
}

31 
boŞ
 
	gWšdowsHªdË
::
	$HªdËV®id
() const

33  
m_h
 && m_h !ğ
INVALID_HANDLE_VALUE
;

34 
	}
}

36 
	gWšdowsHªdË
::
	$A‰achHªdË
(
HANDLE
 
h
, 
boŞ
 
own
)

38 ià(
m_own
)

39 
	`Clo£HªdË
();

41 
m_h
 = 
h
;

42 
m_own
 = 
own
;

43 
	`HªdËChªged
();

44 
	}
}

46 
HANDLE
 
	gWšdowsHªdË
::
	$D‘achHªdË
()

48 
HANDLE
 
h
 = 
m_h
;

49 
m_h
 = 
INVALID_HANDLE_VALUE
;

50 
	`HªdËChªged
();

51  
h
;

52 
	}
}

54 
	gWšdowsHªdË
::
	$Clo£HªdË
()

56 ià(
m_h
 !ğ
INVALID_HANDLE_VALUE
)

58 ::
	`Clo£HªdË
(
m_h
);

59 
m_h
 = 
INVALID_HANDLE_VALUE
;

60 
	`HªdËChªged
();

62 
	}
}

66 
	gWšdowsPe
::
	$HªdËE¼Ü
(cÚ¡ *
İ”©iÚ
) const

68 
DWORD
 
”r
 = 
	`G‘La¡E¼Ü
();

69 
throw
 
	`E¼
(
	`G‘HªdË
(), 
İ”©iÚ
, 
”r
);

70 
	}
}

72 
	gWšdowsPe
::
E¼
::
	$E¼
(
HANDLE
 
s
, cÚ¡ 
¡d
::
¡ršg
& 
İ”©iÚ
, 
”rÜ
)

73 : 
	`OS_E¼Ü
(
IO_ERROR
, "WšdowsPe: " + 
İ”©iÚ
 + " o³¿tiÚ faed w™hƒ¼Ü 0x" + 
	`IÁToSŒšg
(
”rÜ
, 16), operation,ƒrror)

74 , 
	$m_h
(
s
)

76 
	}
}

80 
	gWšdowsPeReûiv”
::
	$WšdowsPeReûiv”
()

81 : 
	`m_»suÉP’dšg
(
çl£
), 
	$m_eofReûived
(
çl£
)

83 
m_ev’t
.
	`A‰achHªdË
(
	`C»©eEv’t
(
NULL
, 
Œue
, 
çl£
, NULL),rue);

84 
	`CheckAndHªdËE¼Ü
("C»©eEv’t", 
m_ev’t
.
	`HªdËV®id
());

85 
	`mem£t
(&
m_ov”Ïµed
, 0, (m_overlapped));

86 
m_ov”Ïµed
.
hEv’t
 = 
m_ev’t
;

87 
	}
}

89 
boŞ
 
	gWšdowsPeReûiv”
::
	$Reûive
(
by‹
* 
buf
, 
size_t
 
bufL’
)

91 
	`as£¹
(!
m_»suÉP’dšg
 && !
m_eofReûived
);

93 
HANDLE
 
h
 = 
	`G‘HªdË
();

95 ià(
	`R—dFe
(
h
, 
buf
, 
	`UnsigÃdMš
((
DWORD
)128*1024, 
bufL’
), &
m_Ï¡ResuÉ
, &
m_ov”Ïµed
))

97 ià(
m_Ï¡ResuÉ
 == 0)

98 
m_eofReûived
 = 
Œue
;

102 
	`G‘La¡E¼Ü
())

105 
	`CheckAndHªdËE¼Ü
("R—dFe", 
çl£
);

106 
ERROR_BROKEN_PIPE
:

107 
ERROR_HANDLE_EOF
:

108 
m_Ï¡ResuÉ
 = 0;

109 
m_eofReûived
 = 
Œue
;

111 
ERROR_IO_PENDING
:

112 
m_»suÉP’dšg
 = 
Œue
;

115  !
m_»suÉP’dšg
;

116 
	}
}

118 
	gWšdowsPeReûiv”
::
	$G‘Wa™Objeùs
(
Wa™ObjeùCÚš”
 &
cÚš”
, 
C®lSck
 cÚ¡& 
ÿÎSck
)

120 ià(
m_»suÉP’dšg
)

121 
cÚš”
.
	`AddHªdË
(
m_ev’t
, 
	`C®lSck
("WšdowsPeReûiv”::G‘Wa™Objeùs(è-„esuÉ…’dšg", &
ÿÎSck
));

122 ià(!
m_eofReûived
)

123 
cÚš”
.
	`S‘NoWa™
(
	`C®lSck
("WšdowsPeReûiv”::G‘Wa™Objeùs(è-„esuÉ„—dy", &
ÿÎSck
));

124 
	}
}

126 
	gWšdowsPeReûiv”
::
	$G‘ReûiveResuÉ
()

128 ià(
m_»suÉP’dšg
)

130 
HANDLE
 
h
 = 
	`G‘HªdË
();

131 ià(
	`G‘Ov”ÏµedResuÉ
(
h
, &
m_ov”Ïµed
, &
m_Ï¡ResuÉ
, 
çl£
))

133 ià(
m_Ï¡ResuÉ
 == 0)

134 
m_eofReûived
 = 
Œue
;

138 
	`G‘La¡E¼Ü
())

141 
	`CheckAndHªdËE¼Ü
("G‘Ov”ÏµedResuÉ", 
çl£
);

142 
ERROR_BROKEN_PIPE
:

143 
ERROR_HANDLE_EOF
:

144 
m_Ï¡ResuÉ
 = 0;

145 
m_eofReûived
 = 
Œue
;

148 
m_»suÉP’dšg
 = 
çl£
;

150  
m_Ï¡ResuÉ
;

151 
	}
}

155 
	gWšdowsPeS’d”
::
	$WšdowsPeS’d”
()

156 : 
	`m_»suÉP’dšg
(
çl£
), 
	$m_Ï¡ResuÉ
(0)

158 
m_ev’t
.
	`A‰achHªdË
(
	`C»©eEv’t
(
NULL
, 
Œue
, 
çl£
, NULL),rue);

159 
	`CheckAndHªdËE¼Ü
("C»©eEv’t", 
m_ev’t
.
	`HªdËV®id
());

160 
	`mem£t
(&
m_ov”Ïµed
, 0, (m_overlapped));

161 
m_ov”Ïµed
.
hEv’t
 = 
m_ev’t
;

162 
	}
}

164 
	gWšdowsPeS’d”
::
	$S’d
(cÚ¡ 
by‹
* 
buf
, 
size_t
 
bufL’
)

166 
DWORD
 
wr™‹n
 = 0;

167 
HANDLE
 
h
 = 
	`G‘HªdË
();

169 ià(
	`Wr™eFe
(
h
, 
buf
, 
	`UnsigÃdMš
((
DWORD
)128*1024, 
bufL’
), &
wr™‹n
, &
m_ov”Ïµed
))

171 
m_»suÉP’dšg
 = 
çl£
;

172 
m_Ï¡ResuÉ
 = 
wr™‹n
;

176 ià(
	`G‘La¡E¼Ü
(è!ğ
ERROR_IO_PENDING
)

177 
	`CheckAndHªdËE¼Ü
("Wr™eFe", 
çl£
);

179 
m_»suÉP’dšg
 = 
Œue
;

181 
	}
}

183 
	gWšdowsPeS’d”
::
	$G‘Wa™Objeùs
(
Wa™ObjeùCÚš”
 &
cÚš”
, 
C®lSck
 cÚ¡& 
ÿÎSck
)

185 ià(
m_»suÉP’dšg
)

186 
cÚš”
.
	`AddHªdË
(
m_ev’t
, 
	`C®lSck
("WšdowsPeS’d”::G‘Wa™Objeùs(è-„esuÉ…’dšg", &
ÿÎSck
));

188 
cÚš”
.
	`S‘NoWa™
(
	`C®lSck
("WšdowsPeS’d”::G‘Wa™Objeùs(è-„esuÉ„—dy", &
ÿÎSck
));

189 
	}
}

191 
	gWšdowsPeS’d”
::
	$G‘S’dResuÉ
()

193 ià(
m_»suÉP’dšg
)

195 
HANDLE
 
h
 = 
	`G‘HªdË
();

196 
BOOL
 
»suÉ
 = 
	`G‘Ov”ÏµedResuÉ
(
h
, &
m_ov”Ïµed
, &
m_Ï¡ResuÉ
, 
çl£
);

197 
	`CheckAndHªdËE¼Ü
("G‘Ov”ÏµedResuÉ", 
»suÉ
);

198 
m_»suÉP’dšg
 = 
çl£
;

200  
m_Ï¡ResuÉ
;

201 
	}
}

203 
	gNAMESPACE_END


	@winpipes.h

1 #iâdeà
CRYPTOPP_WINPIPES_H


2 
	#CRYPTOPP_WINPIPES_H


	)

4 
	~"cÚfig.h
"

6 #ifdeà
WINDOWS_PIPES_AVAILABLE


8 
	~"ÃtwÜk.h
"

9 
	~"queue.h
"

10 
	~<wšsock2.h
>

12 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

15 şas 
	cWšdowsHªdË


17 
public
:

18 
	`WšdowsHªdË
(
HANDLE
 
h
 = 
INVALID_HANDLE_VALUE
, 
boŞ
 
own
=
çl£
);

19 
	$WšdowsHªdË
(cÚ¡ 
WšdowsHªdË
 &
h
è: 
	`m_h
(h.
m_h
), 
	$m_own
(
çl£
) {}

20 
vœtu®
 ~
	`WšdowsHªdË
();

22 
boŞ
 
	$G‘OwÃrsh
(ècÚ¡ { 
m_own
;
	}
}

23 
	$S‘OwÃrsh
(
boŞ
 
own
è{
m_own
 = own;
	}
}

25 
İ”©Ü
 
	$HANDLE
(è{ 
m_h
;
	}
}

26 
HANDLE
 
	$G‘HªdË
(ècÚ¡ { 
m_h
;
	}
}

27 
boŞ
 
	$HªdËV®id
() const;

28 
	`A‰achHªdË
(
HANDLE
 
h
, 
boŞ
 
own
=
çl£
);

29 
HANDLE
 
	`D‘achHªdË
();

30 
	`Clo£HªdË
();

32 
´Ùeùed
:

33 
vœtu®
 
	$HªdËChªged
(è{
	}
}

35 
HANDLE
 
m_h
;

36 
boŞ
 
	gm_own
;

40 şas 
	cWšdowsPe


42 
	mpublic
:

43 şas 
	cE¼
 : 
public
 
OS_E¼Ü


45 
public
:

46 
E¼
(
HANDLE
 
h
, cÚ¡ 
¡d
::
¡ršg
& 
İ”©iÚ
, 
”rÜ
);

47 
HANDLE
 
G‘HªdË
(ècÚ¡ { 
	mm_h
;}

49 
	m´iv©e
:

50 
HANDLE
 
m_h
;

53 
	g´Ùeùed
:

54 
vœtu®
 
HANDLE
 
	$G‘HªdË
() const =0;

55 
vœtu®
 
	$HªdËE¼Ü
(cÚ¡ *
İ”©iÚ
) const;

56 
	$CheckAndHªdËE¼Ü
(cÚ¡ *
İ”©iÚ
, 
BOOL
 
»suÉ
) const

57 {
	`as£¹
(
»suÉ
==
TRUE
 ||„esuÉ==
FALSE
); ià(!»suÉè
	`HªdËE¼Ü
(
İ”©iÚ
);
	}
}

61 
şass
 
	gWšdowsPeReûiv”
 : 
public
 
WšdowsPe
,…ubliø
	gN‘wÜkReûiv”


63 
	gpublic
:

64 
WšdowsPeReûiv”
();

66 
boŞ
 
Mu¡Wa™FÜResuÉ
(è{ 
	gŒue
;}

67 
boŞ
 
Reûive
(
by‹
* 
buf
, 
size_t
 
bufL’
);

68 
G‘ReûiveResuÉ
();

69 
boŞ
 
EofReûived
(ècÚ¡ { 
	gm_eofReûived
;}

71 
G‘MaxWa™ObjeùCouÁ
() const { 1;}

72 
G‘Wa™Objeùs
(
Wa™ObjeùCÚš”
 &
cÚš”
, 
C®lSck
 cÚ¡& 
ÿÎSck
);

74 
	g´iv©e
:

75 
WšdowsHªdË
 
m_ev’t
;

76 
OVERLAPPED
 
	gm_ov”Ïµed
;

77 
boŞ
 
	gm_»suÉP’dšg
;

78 
DWORD
 
	gm_Ï¡ResuÉ
;

79 
boŞ
 
	gm_eofReûived
;

83 
şass
 
	gWšdowsPeS’d”
 : 
public
 
WšdowsPe
,…ubliø
	gN‘wÜkS’d”


85 
	gpublic
:

86 
WšdowsPeS’d”
();

88 
boŞ
 
Mu¡Wa™FÜResuÉ
(è{ 
	gŒue
;}

89 
S’d
(cÚ¡ 
by‹
* 
buf
, 
size_t
 
bufL’
);

90 
G‘S’dResuÉ
();

91 
boŞ
 
Mu¡Wa™FÜEof
(è{  
	gçl£
; }

92 
S’dEof
() {}

94 
G‘MaxWa™ObjeùCouÁ
() const { 1;}

95 
G‘Wa™Objeùs
(
Wa™ObjeùCÚš”
 &
cÚš”
, 
C®lSck
 cÚ¡& 
ÿÎSck
);

97 
	g´iv©e
:

98 
WšdowsHªdË
 
m_ev’t
;

99 
OVERLAPPED
 
	gm_ov”Ïµed
;

100 
boŞ
 
	gm_»suÉP’dšg
;

101 
DWORD
 
	gm_Ï¡ResuÉ
;

105 
şass
 
	gWšdowsPeSourû
 : 
public
 
WšdowsHªdË
,…ubliø
	gN‘wÜkSourû
,…ubliø
	gWšdowsPeReûiv”


107 
	gpublic
:

108 
WšdowsPeSourû
(
HANDLE
 
h
=
INVALID_HANDLE_VALUE
, 
boŞ
 
pumpAÎ
=
çl£
, 
Bufã»dT¿nsfÜm©iÚ
 *
©chm’t
=
NULL
)

109 : 
WšdowsHªdË
(
h
), 
N‘wÜkSourû
(
©chm’t
)

111 ià(
	gpumpAÎ
)

112 
PumpAÎ
();

115 
	gN‘wÜkSourû
::
G‘MaxWa™ObjeùCouÁ
;

116 
	gN‘wÜkSourû
::
G‘Wa™Objeùs
;

118 
	g´iv©e
:

119 
HANDLE
 
G‘HªdË
(ècÚ¡ { 
WšdowsHªdË
::GetHandle();}

120 
	gN‘wÜkReûiv”
 & 
AcûssReûiv”
(è{ *
	gthis
;}

124 
şass
 
	gWšdowsPeSšk
 : 
public
 
WšdowsHªdË
,…ubliø
	gN‘wÜkSšk
,…ubliø
	gWšdowsPeS’d”


126 
	gpublic
:

127 
WšdowsPeSšk
(
HANDLE
 
h
=
INVALID_HANDLE_VALUE
, 
maxBufãrSize
=0, 
autoFlushBound
=16*1024)

128 : 
WšdowsHªdË
(
h
), 
N‘wÜkSšk
(
maxBufãrSize
, 
autoFlushBound
) {}

130 
	gN‘wÜkSšk
::
G‘MaxWa™ObjeùCouÁ
;

131 
	gN‘wÜkSšk
::
G‘Wa™Objeùs
;

133 
	g´iv©e
:

134 
HANDLE
 
G‘HªdË
(ècÚ¡ { 
WšdowsHªdË
::GetHandle();}

135 
	gN‘wÜkS’d”
 & 
AcûssS’d”
(è{ *
	gthis
;}

138 
	gNAMESPACE_END


	@words.h

1 #iâdeà
CRYPTOPP_WORDS_H


2 
	#CRYPTOPP_WORDS_H


	)

4 
	~"misc.h
"

6 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

8 
šlše
 
size_t
 
	$CouÁWÜds
(cÚ¡ 
wÜd
 *
X
, 
size_t
 
N
)

10 
N
 && 
X
[N-1]==0)

11 
N
--;

12  
N
;

13 
	}
}

15 
šlše
 
	$S‘WÜds
(
wÜd
 *
r
, wÜd 
a
, 
size_t
 
n
)

17 
size_t
 
i
=0; i<
n
; i++)

18 
r
[
i
] = 
a
;

19 
	}
}

21 
šlše
 
	$CİyWÜds
(
wÜd
 *
r
, cÚ¡ wÜd *
a
, 
size_t
 
n
)

23 ià(
r
 !ğ
a
)

24 
	`memıy
(
r
, 
a
, 
n
*
WORD_SIZE
);

25 
	}
}

27 
šlše
 
	$XÜWÜds
(
wÜd
 *
r
, cÚ¡ wÜd *
a
, cÚ¡ wÜd *
b
, 
size_t
 
n
)

29 
size_t
 
i
=0; i<
n
; i++)

30 
r
[
i
] = 
a
[i] ^ 
b
[i];

31 
	}
}

33 
šlše
 
	$XÜWÜds
(
wÜd
 *
r
, cÚ¡ wÜd *
a
, 
size_t
 
n
)

35 
size_t
 
i
=0; i<
n
; i++)

36 
r
[
i
] ^ğ
a
[i];

37 
	}
}

39 
šlše
 
	$AndWÜds
(
wÜd
 *
r
, cÚ¡ wÜd *
a
, cÚ¡ wÜd *
b
, 
size_t
 
n
)

41 
size_t
 
i
=0; i<
n
; i++)

42 
r
[
i
] = 
a
[i] & 
b
[i];

43 
	}
}

45 
šlše
 
	$AndWÜds
(
wÜd
 *
r
, cÚ¡ wÜd *
a
, 
size_t
 
n
)

47 
size_t
 
i
=0; i<
n
; i++)

48 
r
[
i
] &ğ
a
[i];

49 
	}
}

51 
šlše
 
wÜd
 
	$ShiáWÜdsLeáByB™s
(
wÜd
 *
r
, 
size_t
 
n
, 
shiáB™s
)

53 
	`as£¹
 (
shiáB™s
<
WORD_BITS
);

54 
wÜd
 
u
, 
ÿ¼y
=0;

55 ià(
shiáB™s
)

56 
size_t
 
i
=0; i<
n
; i++)

58 
u
 = 
r
[
i
];

59 
r
[
i
] = (
u
 << 
shiáB™s
è| 
ÿ¼y
;

60 
ÿ¼y
 = 
u
 >> (
WORD_BITS
-
shiáB™s
);

62  
ÿ¼y
;

63 
	}
}

65 
šlše
 
wÜd
 
	$ShiáWÜdsRightByB™s
(
wÜd
 *
r
, 
size_t
 
n
, 
shiáB™s
)

67 
	`as£¹
 (
shiáB™s
<
WORD_BITS
);

68 
wÜd
 
u
, 
ÿ¼y
=0;

69 ià(
shiáB™s
)

70 
size_t
 
i
=
n
; i>0; i--)

72 
u
 = 
r
[
i
-1];

73 
r
[
i
-1] = (
u
 >> 
shiáB™s
è| 
ÿ¼y
;

74 
ÿ¼y
 = 
u
 << (
WORD_BITS
-
shiáB™s
);

76  
ÿ¼y
;

77 
	}
}

79 
šlše
 
	$ShiáWÜdsLeáByWÜds
(
wÜd
 *
r
, 
size_t
 
n
, size_ˆ
shiáWÜds
)

81 
shiáWÜds
 = 
	`STDMIN
(shiáWÜds, 
n
);

82 ià(
shiáWÜds
)

84 
size_t
 
i
=
n
-1; i>=
shiáWÜds
; i--)

85 
r
[
i
] =„[i-
shiáWÜds
];

86 
	`S‘WÜds
(
r
, 0, 
shiáWÜds
);

88 
	}
}

90 
šlše
 
	$ShiáWÜdsRightByWÜds
(
wÜd
 *
r
, 
size_t
 
n
, size_ˆ
shiáWÜds
)

92 
shiáWÜds
 = 
	`STDMIN
(shiáWÜds, 
n
);

93 ià(
shiáWÜds
)

95 
size_t
 
i
=0; i+
shiáWÜds
<
n
; i++)

96 
r
[
i
] =„[i+
shiáWÜds
];

97 
	`S‘WÜds
(
r
+
n
-
shiáWÜds
, 0, shiftWords);

99 
	}
}

101 
	gNAMESPACE_END


	@xtr.cpp

3 
	~"pch.h
"

4 
	~"xŒ.h
"

5 
	~"nbtheÜy.h
"

7 
	~"®geb¿.ıp
"

9 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

11 cÚ¡ 
GFP2EËm’t
 & GFP2EËm’t::
	$Z”o
()

13  
SšgËtÚ
<
GFP2EËm’t
>().
	`Ref
();

14 
	}
}

16 
	$XTR_FšdPrimesAndG’”©Ü
(
RªdomNumb”G’”©Ü
 &
ºg
, 
IÁeg”
 &
p
, IÁeg” &
q
, 
GFP2EËm’t
 &
g
, 
pb™s
, 
qb™s
)

18 
	`as£¹
(
qb™s
 > 9);

19 
	`as£¹
(
pb™s
 > 
qb™s
);

21 cÚ¡ 
IÁeg”
 
mšQ
 = IÁeg”::
	`Pow”2
(
qb™s
 - 1);

22 cÚ¡ 
IÁeg”
 
maxQ
 = IÁeg”::
	`Pow”2
(
qb™s
) - 1;

23 cÚ¡ 
IÁeg”
 
mšP
 = IÁeg”::
	`Pow”2
(
pb™s
 - 1);

24 cÚ¡ 
IÁeg”
 
maxP
 = IÁeg”::
	`Pow”2
(
pb™s
) - 1;

26 
IÁeg”
 
r1
, 
r2
;

29 
boŞ
 
qFound
 = 
q
.
	`Rªdomize
(
ºg
, 
mšQ
, 
maxQ
, 
IÁeg”
::
PRIME
, 7, 12);

30 
	`as£¹
(
qFound
);

31 
boŞ
 
sŞutiÚsExi¡
 = 
	`SŞveModuÏrQuad¿ticEqu©iÚ
(
r1
, 
r2
, 1, -1, 1, 
q
);

32 
	`as£¹
(
sŞutiÚsExi¡
);

33 } !
p
.
	`Rªdomize
(
ºg
, 
mšP
, 
maxP
, 
IÁeg”
::
PRIME
, 
	`CRT
Ông.
	`G’”©eB™
()?
r1
:
r2
, 
q
, 2, 3, 
	`Euşid—nMuÉliÿtiveInv”£
(p, 3)), 3*q));

34 
	`as£¹
(((
p
.
	`Squ¬ed
(è-… + 1è% 
q
).
	`IsZ”o
());

36 
GFP2_ONB
<
ModuÏrAr™hm‘ic
> 
	`gå2
(
p
);

37 
GFP2EËm’t
 
th»e
 = 
gå2
.
	`CÚv”tIn
(3), 
t
;

39 
Œue
)

41 
g
.
c1
.
	`Rªdomize
(
ºg
, 
IÁeg”
::
	`Z”o
(), 
p
-1);

42 
g
.
c2
.
	`Rªdomize
(
ºg
, 
IÁeg”
::
	`Z”o
(), 
p
-1);

43 
t
 = 
	`XTR_ExpÚ’tŸ‹
(
g
, 
p
+1,…);

44 ià(
t
.
c1
 =ğt.
c2
)

46 
g
 = 
	`XTR_ExpÚ’tŸ‹
(g, (
p
.
	`Squ¬ed
()-p+1)/
q
,…);

47 ià(
g
 !ğ
th»e
)

50 
	`as£¹
(
	`XTR_ExpÚ’tŸ‹
(
g
, 
q
, 
p
è=ğ
th»e
);

51 
	}
}

53 
GFP2EËm’t
 
	$XTR_ExpÚ’tŸ‹
(cÚ¡ 
GFP2EËm’t
 &
b
, cÚ¡ 
IÁeg”
 &
e
, cÚ¡ IÁeg” &
p
)

55 
b™CouÁ
 = 
e
.
	`B™CouÁ
();

56 ià(
b™CouÁ
 == 0)

57  
	`GFP2EËm’t
(-3, -3);

60 
lowe¡1b™
;

61 
lowe¡1b™
=0; 
e
.
	`G‘B™
(lowest1bit) == 0;†owest1bit++) {}

63 
GFP2_ONB
<
MÚtgom”yR•»£Á©iÚ
> 
	`gå2
(
p
);

64 
GFP2EËm’t
 
c
 = 
gå2
.
	`CÚv”tIn
(
b
);

65 
GFP2EËm’t
 
ı
 = 
gå2
.
	`PthPow”
(
c
);

66 
GFP2EËm’t
 
S
[5] = {
gå2
.
	`CÚv”tIn
(3), 
c
, gå2.
	`S³cŸlO³¿tiÚ1
(c)};

69 
i
;

70 
i
 = 
e
.
	`B™CouÁ
(è- 1; i>
lowe¡1b™
; i--)

72 ià(
e
.
	`G‘B™
(
i
))

74 
gå2
.
	`Rai£ToPthPow”
(
S
[0]);

75 
gå2
.
	`AccumuÏ‹
(
S
[0], gå2.
	`S³cŸlO³¿tiÚ2
(S[2], 
c
, S[1]));

76 
S
[1] = 
gå2
.
	`S³cŸlO³¿tiÚ1
(S[1]);

77 
S
[2] = 
gå2
.
	`S³cŸlO³¿tiÚ1
(S[2]);

78 
S
[0].
	`sw­
(S[1]);

82 
gå2
.
	`Rai£ToPthPow”
(
S
[2]);

83 
gå2
.
	`AccumuÏ‹
(
S
[2], gå2.
	`S³cŸlO³¿tiÚ2
(S[0], 
ı
, S[1]));

84 
S
[1] = 
gå2
.
	`S³cŸlO³¿tiÚ1
(S[1]);

85 
S
[0] = 
gå2
.
	`S³cŸlO³¿tiÚ1
(S[0]);

86 
S
[2].
	`sw­
(S[1]);

91 
i
--)

92 
S
[1] = 
gå2
.
	`S³cŸlO³¿tiÚ1
(S[1]);

94  
gå2
.
	`CÚv”tOut
(
S
[1]);

95 
	}
}

97 
‹m¶©e
 
şass
 
	gAb¡¿ùRšg
<
	gGFP2EËm’t
>;

98 
‹m¶©e
 
şass
 
	gAb¡¿ùGroup
<
	gGFP2EËm’t
>;

100 
	gNAMESPACE_END


	@xtr.h

1 #iâdeà
CRYPTOPP_XTR_H


2 
	#CRYPTOPP_XTR_H


	)

8 
	~"mod¬™h.h
"

10 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

13 şas 
	cGFP2EËm’t


15 
public
:

16 
	$GFP2EËm’t
() {}

17 
	$GFP2EËm’t
(cÚ¡ 
IÁeg”
 &
c1
, cÚ¡ IÁeg” &
c2
è: 
	`c1
(c1), 
	$c2
(
c2
è{
	}
}

18 
	$GFP2EËm’t
(cÚ¡ 
by‹
 *
’codedEËm’t
, 
size
)

19 : 
	`c1
(
’codedEËm’t
, 
size
/2), 
	`c2
ÓncodedEËm’t+size/2, size/2è{
	}
}

21 
	$Encode
(
by‹
 *
’codedEËm’t
, 
size
)

23 
c1
.
	`Encode
(
’codedEËm’t
, 
size
/2);

24 
c2
.
	`Encode
(
’codedEËm’t
+
size
/2, size/2);

25 
	}
}

27 
boŞ
 
	gİ”©Ü
==(cÚ¡ 
GFP2EËm’t
 &
rhs
ècÚ¡ { 
c1
 =ğrhs.c1 && 
c2
 ==„hs.c2;}

28 
boŞ
 
	gİ”©Ü
!=(cÚ¡ 
GFP2EËm’t
 &
rhs
ècÚ¡ { !
İ”©Ü
==(rhs);}

30 
	$sw­
(
GFP2EËm’t
 &
a
)

32 
c1
.
	`sw­
(
a
.c1);

33 
c2
.
	`sw­
(
a
.c2);

34 
	}
}

36 cÚ¡ 
	gGFP2EËm’t
 & 
Z”o
();

38 
IÁeg”
 
	gc1
, 
	gc2
;

42 
	g‹m¶©e
 <
şass
 
	gF
>

43 
şass
 
	gGFP2_ONB
 : 
public
 
Ab¡¿ùRšg
<
GFP2EËm’t
>

45 
public
:

46 
F
 
	tBa£F›ld
;

48 
GFP2_ONB
(cÚ¡ 
IÁeg”
 &
p
è: 
modp
(p)

50 ià(
p
%3 != 2)

51 
throw
 
Inv®idArgum’t
("GFP2_ONB: modulus must beƒquivalento 2 mod 3");

54 cÚ¡ 
	gIÁeg”
& 
G‘Modulus
(ècÚ¡ { 
	gmodp
.GetModulus();}

56 
GFP2EËm’t
 
CÚv”tIn
(cÚ¡ 
IÁeg”
 &
a
) const

58 
	gt
 = 
modp
.
Inv”£
(modp.
CÚv”tIn
(
a
));

59  
GFP2EËm’t
(
t
,);

62 
GFP2EËm’t
 
CÚv”tIn
(cÚ¡ GFP2EËm’ˆ&
a
) const

63 { 
GFP2EËm’t
(
modp
.
CÚv”tIn
(
a
.
c1
), modp.CÚv”tIn×.
c2
));}

65 
GFP2EËm’t
 
CÚv”tOut
(cÚ¡ GFP2EËm’ˆ&
a
) const

66 { 
GFP2EËm’t
(
modp
.
CÚv”tOut
(
a
.
c1
), modp.CÚv”tOut×.
c2
));}

68 
boŞ
 
Equ®
(cÚ¡ 
GFP2EËm’t
 &
a
, cÚ¡ GFP2EËm’ˆ&
b
) const

70  
	gmodp
.
Equ®
(
a
.
c1
, 
b
.c1è&& modp.Equ®×.
c2
, b.c2);

73 cÚ¡ 
	gEËm’t
& 
Id’t™y
() const

75  
	gGFP2EËm’t
::
Z”o
();

78 cÚ¡ 
	gEËm’t
& 
Add
(cÚ¡ 
EËm’t
 &
a
, cÚ¡ EËm’ˆ&
b
) const

80 
	g»suÉ
.
	gc1
 = 
modp
.
Add
(
a
.
c1
, 
b
.c1);

81 
	g»suÉ
.
	gc2
 = 
modp
.
Add
(
a
.
c2
, 
b
.c2);

82  
	g»suÉ
;

85 cÚ¡ 
	gEËm’t
& 
Inv”£
(cÚ¡ 
EËm’t
 &
a
) const

87 
	g»suÉ
.
	gc1
 = 
modp
.
Inv”£
(
a
.
c1
);

88 
	g»suÉ
.
	gc2
 = 
modp
.
Inv”£
(
a
.
c2
);

89  
	g»suÉ
;

92 cÚ¡ 
	gEËm’t
& 
DoubË
(cÚ¡ 
EËm’t
 &
a
) const

94 
	g»suÉ
.
	gc1
 = 
modp
.
DoubË
(
a
.
c1
);

95 
	g»suÉ
.
	gc2
 = 
modp
.
DoubË
(
a
.
c2
);

96  
	g»suÉ
;

99 cÚ¡ 
	gEËm’t
& 
SubŒaù
(cÚ¡ 
EËm’t
 &
a
, cÚ¡ EËm’ˆ&
b
) const

101 
	g»suÉ
.
	gc1
 = 
modp
.
SubŒaù
(
a
.
c1
, 
b
.c1);

102 
	g»suÉ
.
	gc2
 = 
modp
.
SubŒaù
(
a
.
c2
, 
b
.c2);

103  
	g»suÉ
;

106 
	gEËm’t
& 
AccumuÏ‹
(
EËm’t
 &
a
, cÚ¡ EËm’ˆ&
b
) const

108 
	gmodp
.
AccumuÏ‹
(
a
.
c1
, 
b
.c1);

109 
	gmodp
.
AccumuÏ‹
(
a
.
c2
, 
b
.c2);

110  
	ga
;

113 
	gEËm’t
& 
Reduû
(
EËm’t
 &
a
, cÚ¡ EËm’ˆ&
b
) const

115 
	gmodp
.
Reduû
(
a
.
c1
, 
b
.c1);

116 
	gmodp
.
Reduû
(
a
.
c2
, 
b
.c2);

117  
	ga
;

120 
boŞ
 
IsUn™
(cÚ¡ 
EËm’t
 &
a
) const

122  
	ga
.
	gc1
.
NÙZ”o
(è||‡.
	gc2
.NotZero();

125 cÚ¡ 
	gEËm’t
& 
MuÉliÿtiveId’t™y
() const

127 
	g»suÉ
.
	gc1
 = 
»suÉ
.
c2
 = 
modp
.
Inv”£
(modp.
MuÉliÿtiveId’t™y
());

128  
	g»suÉ
;

131 cÚ¡ 
	gEËm’t
& 
MuÉly
(cÚ¡ 
EËm’t
 &
a
, cÚ¡ EËm’ˆ&
b
) const

133 
	gt
 = 
modp
.
Add
(
a
.
c1
,‡.
c2
);

134 
	gt
 = 
modp
.
MuÉly
(
t
, modp.
Add
(
b
.
c1
, b.
c2
));

135 
	g»suÉ
.
	gc1
 = 
modp
.
MuÉly
(
a
.
c1
, 
b
.c1);

136 
	g»suÉ
.
	gc2
 = 
modp
.
MuÉly
(
a
.
c2
, 
b
.c2);

137 
	g»suÉ
.
	gc1
.
sw­
(
»suÉ
.
c2
);

138 
	gmodp
.
Reduû
(
t
, 
»suÉ
.
c1
);

139 
	gmodp
.
Reduû
(
t
, 
»suÉ
.
c2
);

140 
	gmodp
.
Reduû
(
»suÉ
.
c1
, 
t
);

141 
	gmodp
.
Reduû
(
»suÉ
.
c2
, 
t
);

142  
	g»suÉ
;

145 cÚ¡ 
	gEËm’t
& 
MuÉliÿtiveInv”£
(cÚ¡ 
EËm’t
 &
a
) const

147  
	g»suÉ
 = 
ExpÚ’tŸ‹
(
a
, 
modp
.
G‘Modulus
()-2);

150 cÚ¡ 
	gEËm’t
& 
Squ¬e
(cÚ¡ 
EËm’t
 &
a
) const

152 cÚ¡ 
	gIÁeg”
 &
	gac1
 = (&
a
 =ğ&
»suÉ
è? (
t
 =‡.
c1
) :‡.c1;

153 
	g»suÉ
.
	gc1
 = 
modp
.
MuÉly
(modp.
SubŒaù
(modp.SubŒaù(
a
.
c2
,‡.
c1
),‡.c1),‡.c2);

154 
	g»suÉ
.
	gc2
 = 
modp
.
MuÉly
(modp.
SubŒaù
(modp.SubŒaù(
ac1
, 
a
.
c2
),‡.c2),‡c1);

155  
	g»suÉ
;

158 
EËm’t
 
ExpÚ’tŸ‹
(cÚ¡ EËm’ˆ&
a
, cÚ¡ 
IÁeg”
 &
e
) const

160 
IÁeg”
 
	gedivp
, 
	gemodp
;

161 
	gIÁeg”
::
Divide
(
emodp
, 
edivp
, 
e
, 
modp
.
G‘Modulus
());

162 
EËm’t
 
	gb
 = 
PthPow”
(
a
);

163  
	gAb¡¿ùRšg
<
	gGFP2EËm’t
>::
CasÿdeExpÚ’tŸ‹
(
a
, 
emodp
, 
b
, 
edivp
);

166 cÚ¡ 
	gEËm’t
 & 
PthPow”
(cÚ¡ 
EËm’t
 &
a
) const

168 
	g»suÉ
 = 
a
;

169 
	g»suÉ
.
	gc1
.
sw­
(
»suÉ
.
c2
);

170  
	g»suÉ
;

173 
Rai£ToPthPow”
(
EËm’t
 &
a
) const

175 
	ga
.
	gc1
.
sw­
(
a
.
c2
);

179 cÚ¡ 
	gEËm’t
 & 
S³cŸlO³¿tiÚ1
(cÚ¡ 
EËm’t
 &
a
) const

181 
as£¹
(&
a
 !ğ&
»suÉ
);

182 
	g»suÉ
 = 
Squ¬e
(
a
);

183 
	gmodp
.
Reduû
(
»suÉ
.
c1
, 
a
.
c2
);

184 
	gmodp
.
Reduû
(
»suÉ
.
c1
, 
a
.
c2
);

185 
	gmodp
.
Reduû
(
»suÉ
.
c2
, 
a
.
c1
);

186 
	gmodp
.
Reduû
(
»suÉ
.
c2
, 
a
.
c1
);

187  
	g»suÉ
;

191 cÚ¡ 
	gEËm’t
 & 
S³cŸlO³¿tiÚ2
(cÚ¡ 
EËm’t
 &
x
, cÚ¡ EËm’ˆ&
y
, cÚ¡ EËm’ˆ&
z
) const

193 
as£¹
(&
x
 !ğ&
»suÉ
 && &
y
 !ğ&»suÉ && &
z
 != &result);

194 
	gt
 = 
modp
.
Add
(
x
.
c2
, 
y
.c2);

195 
	g»suÉ
.
	gc1
 = 
modp
.
MuÉly
(
z
.
c1
, modp.
SubŒaù
(
y
.c1, 
t
));

196 
	gmodp
.
AccumuÏ‹
(
»suÉ
.
c1
, 
modp
.
MuÉly
(
z
.
c2
, modp.
SubŒaù
(
t
, 
x
.c1)));

197 
	gt
 = 
modp
.
Add
(
x
.
c1
, 
y
.c1);

198 
	g»suÉ
.
	gc2
 = 
modp
.
MuÉly
(
z
.
c2
, modp.
SubŒaù
(
y
.c2, 
t
));

199 
	gmodp
.
AccumuÏ‹
(
»suÉ
.
c2
, 
modp
.
MuÉly
(
z
.
c1
, modp.
SubŒaù
(
t
, 
x
.c2)));

200  
	g»suÉ
;

203 
	g´Ùeùed
:

204 
Ba£F›ld
 
modp
;

205 
mubË
 
GFP2EËm’t
 
	g»suÉ
;

206 
mubË
 
IÁeg”
 
	gt
;

209 
XTR_FšdPrimesAndG’”©Ü
(
RªdomNumb”G’”©Ü
 &
ºg
, 
IÁeg”
 &
p
, IÁeg” &
q
, 
GFP2EËm’t
 &
g
, 
pb™s
, 
qb™s
);

211 
GFP2EËm’t
 
XTR_ExpÚ’tŸ‹
(cÚ¡ GFP2EËm’ˆ&
b
, cÚ¡ 
IÁeg”
 &
e
, cÚ¡ IÁeg” &
p
);

213 
	gNAMESPACE_END


	@xtrcrypt.cpp

3 
	~"pch.h
"

4 
	~"xŒüy±.h
"

5 
	~"nbtheÜy.h
"

6 
	~"a¢.h
"

7 
	~"¬gÇmes.h
"

9 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

11 
XTR_DH
::
	$XTR_DH
(cÚ¡ 
IÁeg”
 &
p
, cÚ¡ IÁeg” &
q
, cÚ¡ 
GFP2EËm’t
 &
g
)

12 : 
	`m_p
(
p
), 
	`m_q
(
q
), 
	$m_g
(
g
)

14 
	}
}

16 
	gXTR_DH
::
	$XTR_DH
(
RªdomNumb”G’”©Ü
 &
ºg
, 
pb™s
, 
qb™s
)

18 
	`XTR_FšdPrimesAndG’”©Ü
(
ºg
, 
m_p
, 
m_q
, 
m_g
, 
pb™s
, 
qb™s
);

19 
	}
}

21 
	gXTR_DH
::
	$XTR_DH
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
)

23 
BERSequ’ûDecod”
 
	`£q
(
bt
);

24 
m_p
.
	`BERDecode
(
£q
);

25 
m_q
.
	`BERDecode
(
£q
);

26 
m_g
.
c1
.
	`BERDecode
(
£q
);

27 
m_g
.
c2
.
	`BERDecode
(
£q
);

28 
£q
.
	`Mes§geEnd
();

29 
	}
}

31 
	gXTR_DH
::
	$DEREncode
(
Bufã»dT¿nsfÜm©iÚ
 &
bt
) const

33 
DERSequ’ûEncod”
 
	`£q
(
bt
);

34 
m_p
.
	`DEREncode
(
£q
);

35 
m_q
.
	`DEREncode
(
£q
);

36 
m_g
.
c1
.
	`DEREncode
(
£q
);

37 
m_g
.
c2
.
	`DEREncode
(
£q
);

38 
£q
.
	`Mes§geEnd
();

39 
	}
}

41 
boŞ
 
	gXTR_DH
::
	$V®id©e
(
RªdomNumb”G’”©Ü
 &
ºg
, 
Ëv–
) const

43 
boŞ
 
·ss
 = 
Œue
;

44 
·ss
 =…as && 
m_p
 > 
IÁeg”
::
	`OÃ
(è&& m_p.
	`IsOdd
();

45 
·ss
 =…as && 
m_q
 > 
IÁeg”
::
	`OÃ
(è&& m_q.
	`IsOdd
();

46 
GFP2EËm’t
 
th»e
 = 
GFP2_ONB
<
ModuÏrAr™hm‘ic
>(
m_p
).
	`CÚv”tIn
(3);

47 
·ss
 =…as && !(
m_g
.
c1
.
	`IsNeg©ive
(è|| m_g.
c2
.IsNeg©ive(è|| m_g.c1 >ğ
m_p
 || m_g.c2 >ğm_°|| m_g =ğ
th»e
);

48 ià(
Ëv–
 >= 1)

49 
·ss
 =…as && ((
m_p
.
	`Squ¬ed
()-m_p+1)%
m_q
).
	`IsZ”o
();

50 ià(
Ëv–
 >= 2)

52 
·ss
 =…as && 
	`V”ifyPrime
(
ºg
, 
m_p
, 
Ëv–
-2è&& V”ifyPrimeÔng, 
m_q
,†evel-2);

53 
·ss
 =…as && 
	`XTR_ExpÚ’tŸ‹
(
m_g
, (
m_p
.
	`Squ¬ed
()-m_p+1)/
m_q
, m_pè!ğ
th»e
;

54 
·ss
 =…as && 
	`XTR_ExpÚ’tŸ‹
(
m_g
, 
m_q
, 
m_p
è=ğ
th»e
;

56  
·ss
;

57 
	}
}

59 
boŞ
 
	gXTR_DH
::
	$G‘VoidV®ue
(cÚ¡ *
Çme
, cÚ¡ 
¡d
::
ty³_šfo
 &
v®ueTy³
, *
pV®ue
) const

61  
	`G‘V®ueH–³r
(
this
, 
Çme
, 
v®ueTy³
, 
pV®ue
).
	`AssigÇbË
()

62 
	`CRYPTOPP_GET_FUNCTION_ENTRY
(
Modulus
)

63 
	`CRYPTOPP_GET_FUNCTION_ENTRY
(
SubgroupOrd”
)

64 
	`CRYPTOPP_GET_FUNCTION_ENTRY
(
SubgroupG’”©Ü
)

66 
	}
}

68 
	gXTR_DH
::
	$AssignFrom
(cÚ¡ 
NameV®uePaœs
 &
sourû
)

70 
	`AssignFromH–³r
(
this
, 
sourû
)

71 
	`CRYPTOPP_SET_FUNCTION_ENTRY
(
Modulus
)

72 
	`CRYPTOPP_SET_FUNCTION_ENTRY
(
SubgroupOrd”
)

73 
	`CRYPTOPP_SET_FUNCTION_ENTRY
(
SubgroupG’”©Ü
)

75 
	}
}

77 
	gXTR_DH
::
	$G’”©ePriv©eKey
(
RªdomNumb”G’”©Ü
 &
ºg
, 
by‹
 *
´iv©eKey
) const

79 
IÁeg”
 
	`x
(
ºg
, IÁeg”::
	`Z”o
(), 
m_q
-1);

80 
x
.
	`Encode
(
´iv©eKey
, 
	`Priv©eKeyL’gth
());

81 
	}
}

83 
	gXTR_DH
::
	$G’”©ePublicKey
(
RªdomNumb”G’”©Ü
 &
ºg
, cÚ¡ 
by‹
 *
´iv©eKey
, by‹ *
publicKey
) const

85 
IÁeg”
 
	`x
(
´iv©eKey
, 
	`Priv©eKeyL’gth
());

86 
GFP2EËm’t
 
y
 = 
	`XTR_ExpÚ’tŸ‹
(
m_g
, 
x
, 
m_p
);

87 
y
.
	`Encode
(
publicKey
, 
	`PublicKeyL’gth
());

88 
	}
}

90 
boŞ
 
	gXTR_DH
::
	$Ag»e
(
by‹
 *
ag»edV®ue
, cÚ¡ by‹ *
´iv©eKey
, cÚ¡ by‹ *
Ùh”PublicKey
, 
boŞ
 
v®id©eOth”PublicKey
) const

92 
GFP2EËm’t
 
	`w
(
Ùh”PublicKey
, 
	`PublicKeyL’gth
());

93 ià(
v®id©eOth”PublicKey
)

95 
GFP2_ONB
<
ModuÏrAr™hm‘ic
> 
	`gå2
(
m_p
);

96 
GFP2EËm’t
 
th»e
 = 
gå2
.
	`CÚv”tIn
(3);

97 ià(
w
.
c1
.
	`IsNeg©ive
(è|| w.
c2
.IsNeg©ive(è|| w.c1 >ğ
m_p
 || w.c2 >ğm_°|| w =ğ
th»e
)

98  
çl£
;

99 ià(
	`XTR_ExpÚ’tŸ‹
(
w
, 
m_q
, 
m_p
è!ğ
th»e
)

100  
çl£
;

102 
IÁeg”
 
	`s
(
´iv©eKey
, 
	`Priv©eKeyL’gth
());

103 
GFP2EËm’t
 
z
 = 
	`XTR_ExpÚ’tŸ‹
(
w
, 
s
, 
m_p
);

104 
z
.
	`Encode
(
ag»edV®ue
, 
	`Ag»edV®ueL’gth
());

105  
Œue
;

106 
	}
}

108 
	gNAMESPACE_END


	@xtrcrypt.h

1 #iâdeà
CRYPTOPP_XTRCRYPT_H


2 
	#CRYPTOPP_XTRCRYPT_H


	)

8 
	~"xŒ.h
"

10 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

14 
şass
 
XTR_DH
 : 
public
 
Sim¶eKeyAg»em’tDomaš
,…ubliø
Cry±oP¬am‘”s


16 
XTR_DH
 
	tThisCÏss
;

18 
public
:

19 
	`XTR_DH
(cÚ¡ 
IÁeg”
 &
p
, cÚ¡ IÁeg” &
q
, cÚ¡ 
GFP2EËm’t
 &
g
);

20 
	`XTR_DH
(
RªdomNumb”G’”©Ü
 &
ºg
, 
pb™s
, 
qb™s
);

21 
	`XTR_DH
(
Bufã»dT¿nsfÜm©iÚ
 &
domašP¬ams
);

23 
	`DEREncode
(
Bufã»dT¿nsfÜm©iÚ
 &
domašP¬ams
) const;

25 
boŞ
 
	`V®id©e
(
RªdomNumb”G’”©Ü
 &
ºg
, 
Ëv–
) const;

26 
boŞ
 
	`G‘VoidV®ue
(cÚ¡ *
Çme
, cÚ¡ 
¡d
::
ty³_šfo
 &
v®ueTy³
, *
pV®ue
) const;

27 
	`AssignFrom
(cÚ¡ 
NameV®uePaœs
 &
sourû
);

28 
Cry±oP¬am‘”s
 & 
	`AcûssCry±oP¬am‘”s
(è{ *
this
;}

29 
	`Ag»edV®ueL’gth
(ècÚ¡ { 2*
m_p
.
	`By‹CouÁ
();}

30 
	`Priv©eKeyL’gth
(ècÚ¡ { 
m_q
.
	`By‹CouÁ
();}

31 
	`PublicKeyL’gth
(ècÚ¡ { 2*
m_p
.
	`By‹CouÁ
();}

33 
	`G’”©ePriv©eKey
(
RªdomNumb”G’”©Ü
 &
ºg
, 
by‹
 *
´iv©eKey
) const;

34 
	`G’”©ePublicKey
(
RªdomNumb”G’”©Ü
 &
ºg
, cÚ¡ 
by‹
 *
´iv©eKey
, by‹ *
publicKey
) const;

35 
boŞ
 
	`Ag»e
(
by‹
 *
ag»edV®ue
, cÚ¡ by‹ *
´iv©eKey
, cÚ¡ by‹ *
Ùh”PublicKey
, boŞ 
v®id©eOth”PublicKey
=
Œue
) const;

37 cÚ¡ 
IÁeg”
 &
	`G‘Modulus
(ècÚ¡ { 
m_p
;}

38 cÚ¡ 
IÁeg”
 &
	`G‘SubgroupOrd”
(ècÚ¡ { 
m_q
;}

39 cÚ¡ 
GFP2EËm’t
 &
	`G‘SubgroupG’”©Ü
(ècÚ¡ { 
m_g
;}

41 
	`S‘Modulus
(cÚ¡ 
IÁeg”
 &
p
è{
m_p
 =…;}

42 
	`S‘SubgroupOrd”
(cÚ¡ 
IÁeg”
 &
q
è{
m_q
 = q;}

43 
	`S‘SubgroupG’”©Ü
(cÚ¡ 
GFP2EËm’t
 &
g
è{
m_g
 = g;}

45 
´iv©e
:

46 
	`ExpÚ’tB™L’gth
() const;

48 
IÁeg”
 
m_p
, 
m_q
;

49 
GFP2EËm’t
 
m_g
;

50 
	}
};

52 
	gNAMESPACE_END


	@zdeflate.cpp

8 
	~"pch.h
"

9 
	~"zdeæ©e.h
"

10 
	~<funùiÚ®
>

12 #ià
_MSC_VER
 >= 1600

14 
	~<™”©Ü
>

17 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

19 
usšg
 
Çme¥aû
 
¡d
;

21 
LowFœ¡B™Wr™”
::
	$LowFœ¡B™Wr™”
(
Bufã»dT¿nsfÜm©iÚ
 *
©chm’t
)

22 : 
	`F‹r
(
©chm’t
), 
	`m_couÁšg
(
çl£
), 
	`m_bufãr
(0), 
	`m_b™sBufã»d
(0), 
	$m_by‹sBufã»d
(0)

24 
	}
}

26 
	gLowFœ¡B™Wr™”
::
	$S¹CouÁšg
()

28 
	`as£¹
(!
m_couÁšg
);

29 
m_couÁšg
 = 
Œue
;

30 
m_b™CouÁ
 = 0;

31 
	}
}

33 
	gLowFœ¡B™Wr™”
::
	$FšishCouÁšg
()

35 
	`as£¹
(
m_couÁšg
);

36 
m_couÁšg
 = 
çl£
;

37  
m_b™CouÁ
;

38 
	}
}

40 
	gLowFœ¡B™Wr™”
::
	$PutB™s
(
v®ue
, 
Ëngth
)

42 ià(
m_couÁšg
)

43 
m_b™CouÁ
 +ğ
Ëngth
;

46 
m_bufãr
 |ğ
v®ue
 << 
m_b™sBufã»d
;

47 
m_b™sBufã»d
 +ğ
Ëngth
;

48 
	`as£¹
(
m_b™sBufã»d
 <= ()*8);

49 
m_b™sBufã»d
 >= 8)

51 
m_ouutBufãr
[
m_by‹sBufã»d
++] = (
by‹
)
m_bufãr
;

52 ià(
m_by‹sBufã»d
 =ğ
m_ouutBufãr
.
	`size
())

54 
	`A‰achedT¿nsfÜm©iÚ
()->
	`PutModifŸbË
(
m_ouutBufãr
, 
m_by‹sBufã»d
);

55 
m_by‹sBufã»d
 = 0;

57 
m_bufãr
 >>= 8;

58 
m_b™sBufã»d
 -= 8;

61 
	}
}

63 
	gLowFœ¡B™Wr™”
::
	$FlushB™Bufãr
()

65 ià(
m_couÁšg
)

66 
m_b™CouÁ
 +ğ8*(
m_b™sBufã»d
 > 0);

69 ià(
m_by‹sBufã»d
 > 0)

71 
	`A‰achedT¿nsfÜm©iÚ
()->
	`PutModifŸbË
(
m_ouutBufãr
, 
m_by‹sBufã»d
);

72 
m_by‹sBufã»d
 = 0;

74 ià(
m_b™sBufã»d
 > 0)

76 
	`A‰achedT¿nsfÜm©iÚ
()->
	`Put
((
by‹
)
m_bufãr
);

77 
m_bufãr
 = 0;

78 
m_b™sBufã»d
 = 0;

81 
	}
}

83 
	gLowFœ¡B™Wr™”
::
	$CË¬B™Bufãr
()

85 
m_bufãr
 = 0;

86 
m_by‹sBufã»d
 = 0;

87 
m_b™sBufã»d
 = 0;

88 
	}
}

90 
	gHuffmªEncod”
::
	$HuffmªEncod”
(cÚ¡ *
codeB™s
, 
nCodes
)

92 
	`In™Ÿlize
(
codeB™s
, 
nCodes
);

93 
	}
}

95 
	sHuffmªNode


97 
size_t
 
	msymbŞ
;

98 uniÚ {
size_t
 
	m·»Á
; 
	md•th
, 
	mäeq
;};

101 
	sF»qLessThª


103 
šlše
 
boŞ
 
İ”©Ü
()(
	mlhs
, cÚ¡ 
	mHuffmªNode
 &
	mrhs
è{†h <„hs.
	mäeq
;}

104 
šlše
 
boŞ
 
İ”©Ü
()(cÚ¡ 
	mHuffmªNode
 &
	mlhs
, cÚ¡ HuffmªNod&
	mrhs
ècÚ¡ {†hs.
	mäeq
 <„hs.freq;}

106 
šlše
 
boŞ
 
İ”©Ü
()(cÚ¡ 
	mHuffmªNode
 &
	mlhs
, 
	mrhs
è{†hs.
	mäeq
 <„hs;}

109 
	gHuffmªEncod”
::
	$G’”©eCodeL’gths
(*
codeB™s
, 
maxCodeB™s
, cÚ¡ *
codeCouÁs
, 
size_t
 
nCodes
)

111 
	`as£¹
(
nCodes
 > 0);

112 
	`as£¹
(
nCodes
 <ğ((
size_t
)1 << 
maxCodeB™s
));

114 
size_t
 
i
;

115 
SecBlockW™hHšt
<
HuffmªNode
, 2*286> 
	`Œ“
(
nCodes
);

116 
i
=0; i<
nCodes
; i++)

118 
Œ“
[
i
].
symbŞ
 = i;

119 
Œ“
[
i
].
äeq
 = 
codeCouÁs
[i];

121 
	`sÜt
(
Œ“
.
	`begš
(),»e.
	`’d
(), 
	`F»qLessThª
());

122 
size_t
 
Œ“Begš
 = 
	`uµ”_bound
(
Œ“
.
	`begš
(),»e.
	`’d
(), 0, 
	`F»qLessThª
()) -ree.begin();

123 ià(
Œ“Begš
 =ğ
nCodes
)

125 
	`fl
(
codeB™s
, codeB™s+
nCodes
, 0);

128 
Œ“
.
	`»size
(
nCodes
 +‚Code - 
Œ“Begš
 - 1);

130 
size_t
 
Ëa¡L—f
 = 
Œ“Begš
, 
Ëa¡IÁ”iÜ
 = 
nCodes
;

131 
i
=
nCodes
; i<
Œ“
.
	`size
(); i++)

133 
size_t
 
Ëa¡
;

134 
Ëa¡
 = (
Ëa¡L—f
 =ğ
nCodes
 || (
Ëa¡IÁ”iÜ
 < 
i
 && 
Œ“
[Ëa¡IÁ”iÜ].
äeq
 <ree[leastLeaf].freq)) ?†eastInterior++ :†eastLeaf++;

135 
Œ“
[
i
].
äeq
 =»e[
Ëa¡
].freq;

136 
Œ“
[
Ëa¡
].
·»Á
 = 
i
;

137 
Ëa¡
 = (
Ëa¡L—f
 =ğ
nCodes
 || (
Ëa¡IÁ”iÜ
 < 
i
 && 
Œ“
[Ëa¡IÁ”iÜ].
äeq
 <ree[leastLeaf].freq)) ?†eastInterior++ :†eastLeaf++;

138 
Œ“
[
i
].
äeq
 +ğŒ“[
Ëa¡
].freq;

139 
Œ“
[
Ëa¡
].
·»Á
 = 
i
;

142 
Œ“
[Œ“.
	`size
()-1].
d•th
 = 0;

143 ià(
Œ“
.
	`size
() >= 2)

144 
i
=
Œ“
.
	`size
()-2; i>=
nCodes
; i--)

145 
Œ“
[
i
].
d•th
 =»e[Œ“[i].
·»Á
].depth + 1;

146 
sum
 = 0;

147 
SecBlockW™hHšt
<, 15+1> 
	`blCouÁ
(
maxCodeB™s
+1);

148 
	`fl
(
blCouÁ
.
	`begš
(), blCouÁ.
	`’d
(), 0);

149 
i
=
Œ“Begš
; i<
nCodes
; i++)

151 
size_t
 
d•th
 = 
	`STDMIN
(
maxCodeB™s
, 
Œ“
[Œ“[
i
].
·»Á
].depth + 1);

152 
blCouÁ
[
d•th
]++;

153 
sum
 +ğ1 << (
maxCodeB™s
 - 
d•th
);

156 
ov”æow
 = 
sum
 > ()(1 << 
maxCodeB™s
) ? sum - (1 << maxCodeBits) : 0;

158 
ov”æow
--)

160 
b™s
 = 
maxCodeB™s
-1;

161 
blCouÁ
[
b™s
] == 0)

162 
b™s
--;

163 
blCouÁ
[
b™s
]--;

164 
blCouÁ
[
b™s
+1] += 2;

165 
	`as£¹
(
blCouÁ
[
maxCodeB™s
] > 0);

166 
blCouÁ
[
maxCodeB™s
]--;

169 
i
=0; i<
Œ“Begš
; i++)

170 
codeB™s
[
Œ“
[
i
].
symbŞ
] = 0;

171 
b™s
 = 
maxCodeB™s
;

172 
i
=
Œ“Begš
; i<
nCodes
; i++)

174 
blCouÁ
[
b™s
] == 0)

175 
b™s
--;

176 
codeB™s
[
Œ“
[
i
].
symbŞ
] = 
b™s
;

177 
blCouÁ
[
b™s
]--;

179 
	`as£¹
(
blCouÁ
[
b™s
] == 0);

180 
	}
}

182 
	gHuffmªEncod”
::
	$In™Ÿlize
(cÚ¡ *
codeB™s
, 
nCodes
)

184 
	`as£¹
(
nCodes
 > 0);

185 
maxCodeB™s
 = *
	`max_–em’t
(
codeB™s
, codeB™s+
nCodes
);

186 ià(
maxCodeB™s
 == 0)

189 
SecBlockW™hHšt
<, 15+1> 
	`blCouÁ
(
maxCodeB™s
+1);

190 
	`fl
(
blCouÁ
.
	`begš
(), blCouÁ.
	`’d
(), 0);

191 
i
;

192 
i
=0; i<
nCodes
; i++)

193 
blCouÁ
[
codeB™s
[
i
]]++;

195 
code_t
 
code
 = 0;

196 
SecBlockW™hHšt
<
code_t
, 15+1> 
	`ÃxtCode
(
maxCodeB™s
+1);

197 
ÃxtCode
[1] = 0;

198 
i
=2; i<=
maxCodeB™s
; i++)

200 
code
 = (cod+ 
blCouÁ
[
i
-1]) << 1;

201 
ÃxtCode
[
i
] = 
code
;

203 
	`as£¹
(
maxCodeB™s
 =ğ1 || 
code
 =ğ(1 << maxCodeB™sè- 
blCouÁ
[maxCodeBits]);

205 
m_v®ueToCode
.
	`»size
(
nCodes
);

206 
i
=0; i<
nCodes
; i++)

208 
Ën
 = 
m_v®ueToCode
[
i
].ËÀğ
codeB™s
[i];

209 ià(
Ën
 != 0)

210 
m_v®ueToCode
[
i
].
code
 = 
	`B™Rev”£
(
ÃxtCode
[
Ën
]++è>> (8*(
code_t
)-len);

212 
	}
}

214 
šlše
 
	gHuffmªEncod”
::
	$Encode
(
LowFœ¡B™Wr™”
 &
wr™”
, 
v®ue_t
 
v®ue
) const

216 
	`as£¹
(
m_v®ueToCode
[
v®ue
].
Ën
 > 0);

217 
wr™”
.
	`PutB™s
(
m_v®ueToCode
[
v®ue
].
code
, m_v®ueToCode[v®ue].
Ën
);

218 
	}
}

220 
	gDeæ©Ü
::
	$Deæ©Ü
(
Bufã»dT¿nsfÜm©iÚ
 *
©chm’t
, 
deæ©eLev–
, 
log2WšdowSize
, 
boŞ
 
d‘eùUncom´essibË
)

221 : 
	`LowFœ¡B™Wr™”
(
©chm’t
)

222 , 
	`m_deæ©eLev–
(-1)

224 
	`In™ŸlizeSticEncod”s
();

225 
	`IsŞ©edIn™Ÿlize
(
	`MakeP¬am‘”s
("Deæ©eLev–", 
deæ©eLev–
)("Log2WšdowSize", 
log2WšdowSize
)("D‘eùUncom´essibË", 
d‘eùUncom´essibË
));

226 
	}
}

228 
	gDeæ©Ü
::
	$Deæ©Ü
(cÚ¡ 
NameV®uePaœs
 &
·¿m‘”s
, 
Bufã»dT¿nsfÜm©iÚ
 *
©chm’t
)

229 : 
	`LowFœ¡B™Wr™”
(
©chm’t
)

230 , 
	`m_deæ©eLev–
(-1)

232 
	`In™ŸlizeSticEncod”s
();

233 
	`IsŞ©edIn™Ÿlize
(
·¿m‘”s
);

234 
	}
}

236 
	gDeæ©Ü
::
	$In™ŸlizeSticEncod”s
()

238 
codeL’gths
[288];

239 
	`fl
(
codeL’gths
 + 0, codeLengths + 144, 8);

240 
	`fl
(
codeL’gths
 + 144, codeLengths + 256, 9);

241 
	`fl
(
codeL’gths
 + 256, codeLengths + 280, 7);

242 
	`fl
(
codeL’gths
 + 280, codeLengths + 288, 8);

243 
m_¡©icL™”®Encod”
.
	`In™Ÿlize
(
codeL’gths
, 288);

244 
	`fl
(
codeL’gths
 + 0, codeLengths + 32, 5);

245 
m_¡©icDi¡ªûEncod”
.
	`In™Ÿlize
(
codeL’gths
, 32);

246 
	}
}

248 
	gDeæ©Ü
::
	$IsŞ©edIn™Ÿlize
(cÚ¡ 
NameV®uePaœs
 &
·¿m‘”s
)

250 
log2WšdowSize
 = 
·¿m‘”s
.
	`G‘IÁV®ueW™hDeçuÉ
("Log2WšdowSize", 
DEFAULT_LOG2_WINDOW_SIZE
);

251 ià(!(
MIN_LOG2_WINDOW_SIZE
 <ğ
log2WšdowSize
 &&†og2WšdowSiz<ğ
MAX_LOG2_WINDOW_SIZE
))

252 
throw
 
	`Inv®idArgum’t
("Deæ©Ü: " + 
	`IÁToSŒšg
(
log2WšdowSize
) + " is‡n invalid window size");

254 
m_log2WšdowSize
 = 
log2WšdowSize
;

255 
DSIZE
 = 1 << 
m_log2WšdowSize
;

256 
DMASK
 = 
DSIZE
 - 1;

257 
HSIZE
 = 1 << 
m_log2WšdowSize
;

258 
HMASK
 = 
HSIZE
 - 1;

259 
m_by‹Bufãr
.
	`New
(2*
DSIZE
);

260 
m_h—d
.
	`New
(
HSIZE
);

261 
m_´ev
.
	`New
(
DSIZE
);

262 
m_m©chBufãr
.
	`New
(
DSIZE
/2);

263 
	`Re£t
(
Œue
);

265 
	`S‘Deæ©eLev–
(
·¿m‘”s
.
	`G‘IÁV®ueW™hDeçuÉ
("Deæ©eLev–", 
DEFAULT_DEFLATE_LEVEL
));

266 
boŞ
 
d‘eùUncom´essibË
 = 
·¿m‘”s
.
	`G‘V®ueW™hDeçuÉ
("D‘eùUncom´essibË", 
Œue
);

267 
m_com´essibËDeæ©eLev–
 = 
d‘eùUncom´essibË
 ? 
m_deæ©eLev–
 : 0;

268 
	}
}

270 
	gDeæ©Ü
::
	$Re£t
(
boŞ
 
fÜûRe£t
)

272 ià(
fÜûRe£t
)

273 
	`CË¬B™Bufãr
();

275 
	`as£¹
(
m_b™sBufã»d
 == 0);

277 
m_h—d”Wr™‹n
 = 
çl£
;

278 
m_m©chAvaabË
 = 
çl£
;

279 
m_diùiÚ¬yEnd
 = 0;

280 
m_¡ršgS¹
 = 0;

281 
m_lookah—d
 = 0;

282 
m_mšLookah—d
 = 
MAX_MATCH
;

283 
m_m©chBufãrEnd
 = 0;

284 
m_blockS¹
 = 0;

285 
m_blockL’gth
 = 0;

287 
m_d‘eùCouÁ
 = 1;

288 
m_d‘eùSk
 = 0;

291 
	`fl
(
m_h—d
.
	`begš
(), m_h—d.
	`’d
(), 0);

293 
	`fl
(
m_l™”®CouÁs
.
	`begš
(), m_l™”®CouÁs.
	`’d
(), 0);

294 
	`fl
(
m_di¡ªûCouÁs
.
	`begš
(), m_di¡ªûCouÁs.
	`’d
(), 0);

295 
	}
}

297 
	gDeæ©Ü
::
	$S‘Deæ©eLev–
(
deæ©eLev–
)

299 ià(!(
MIN_DEFLATE_LEVEL
 <ğ
deæ©eLev–
 && deæ©eLev– <ğ
MAX_DEFLATE_LEVEL
))

300 
throw
 
	`Inv®idArgum’t
("Deæ©Ü: " + 
	`IÁToSŒšg
(
deæ©eLev–
) + " is‡n invalid deflate†evel");

302 ià(
deæ©eLev–
 =ğ
m_deæ©eLev–
)

305 
	`EndBlock
(
çl£
);

307 cÚ¡ 
cÚfigu¿tiÚTabË
[10][4] = {

320 
GOOD_MATCH
 = 
cÚfigu¿tiÚTabË
[
deæ©eLev–
][0];

321 
MAX_LAZYLENGTH
 = 
cÚfigu¿tiÚTabË
[
deæ©eLev–
][1];

322 
MAX_CHAIN_LENGTH
 = 
cÚfigu¿tiÚTabË
[
deæ©eLev–
][3];

324 
m_deæ©eLev–
 = 
deæ©eLev–
;

325 
	}
}

327 
	gDeæ©Ü
::
	$FlWšdow
(cÚ¡ 
by‹
 *
¡r
, 
size_t
 
Ëngth
)

329 
maxBlockSize
 = ()
	`STDMIN
(2UL*
DSIZE
, 0xffffUL);

331 ià(
m_¡ršgS¹
 >ğ
maxBlockSize
 - 
MAX_MATCH
)

333 ià(
m_blockS¹
 < 
DSIZE
)

334 
	`EndBlock
(
çl£
);

336 
	`memıy
(
m_by‹Bufãr
, m_by‹Bufã¸+ 
DSIZE
, DSIZE);

338 
m_diùiÚ¬yEnd
 = m_diùiÚ¬yEnd < 
DSIZE
 ? 0 : m_dictionaryEnd-DSIZE;

339 
	`as£¹
(
m_¡ršgS¹
 >ğ
DSIZE
);

340 
m_¡ršgS¹
 -ğ
DSIZE
;

341 
	`as£¹
(!
m_m©chAvaabË
 || 
m_´eviousM©ch
 >ğ
DSIZE
);

342 
m_´eviousM©ch
 -ğ
DSIZE
;

343 
	`as£¹
(
m_blockS¹
 >ğ
DSIZE
);

344 
m_blockS¹
 -ğ
DSIZE
;

346 
i
;

348 
i
=0; i<
HSIZE
; i++)

349 
m_h—d
[
i
] = 
	`S©u¿tšgSubŒaù
(m_h—d[i], 
DSIZE
);

351 
i
=0; i<
DSIZE
; i++)

352 
m_´ev
[
i
] = 
	`S©u¿tšgSubŒaù
(m_´ev[i], 
DSIZE
);

355 
	`as£¹
(
maxBlockSize
 > 
m_¡ršgS¹
+
m_lookah—d
);

356 
acû±ed
 = 
	`UnsigÃdMš
(
maxBlockSize
-(
m_¡ršgS¹
+
m_lookah—d
), 
Ëngth
);

357 
	`as£¹
(
acû±ed
 > 0);

358 
	`memıy
(
m_by‹Bufãr
 + 
m_¡ršgS¹
 + 
m_lookah—d
, 
¡r
, 
acû±ed
);

359 
m_lookah—d
 +ğ
acû±ed
;

360  
acû±ed
;

361 
	}
}

363 
šlše
 
	gDeæ©Ü
::
	$Compu‹Hash
(cÚ¡ 
by‹
 *
¡r
) const

365 
	`as£¹
(
¡r
+3 <ğ
m_by‹Bufãr
 + 
m_¡ršgS¹
 + 
m_lookah—d
);

366  ((
¡r
[0] << 10è^ (¡r[1] << 5è^ sŒ[2]è& 
HMASK
;

367 
	}
}

369 
	gDeæ©Ü
::
	$LÚge¡M©ch
(&
be¡M©ch
) const

371 
	`as£¹
(
m_´eviousL’gth
 < 
MAX_MATCH
);

373 
be¡M©ch
 = 0;

374 
be¡L’gth
 = 
	`STDMAX
(
m_´eviousL’gth
, ()
MIN_MATCH
-1);

375 ià(
m_lookah—d
 <ğ
be¡L’gth
)

378 cÚ¡ 
by‹
 *
sÿn
 = 
m_by‹Bufãr
 + 
m_¡ršgS¹
, *
sÿnEnd
 = sÿÀ+ 
	`STDMIN
(()
MAX_MATCH
, 
m_lookah—d
);

379 
lim™
 = 
m_¡ršgS¹
 > (
DSIZE
-
MAX_MATCH
) ? m_stringStart - (DSIZE-MAX_MATCH) : 0;

380 
cu¼’t
 = 
m_h—d
[
	`Compu‹Hash
(
sÿn
)];

382 
chašL’gth
 = 
MAX_CHAIN_LENGTH
;

383 ià(
m_´eviousL’gth
 >ğ
GOOD_MATCH
)

384 
chašL’gth
 >>= 2;

386 
cu¼’t
 > 
lim™
 && --
chašL’gth
 > 0)

388 cÚ¡ 
by‹
 *
m©ch
 = 
m_by‹Bufãr
 + 
cu¼’t
;

389 
	`as£¹
(
sÿn
 + 
be¡L’gth
 < 
m_by‹Bufãr
 + 
m_¡ršgS¹
 + 
m_lookah—d
);

390 ià(
sÿn
[
be¡L’gth
-1] =ğ
m©ch
[bestLength-1] && scan[bestLength] == match[bestLength] && scan[0] == match[0] && scan[1] == match[1])

392 
	`as£¹
(
sÿn
[2] =ğ
m©ch
[2]);

393 
Ën
 = ()(

394 #ià
	`defšed
(
_STDEXT_BEGIN
è&& !(defšed(
_MSC_VER
è&& (_MSC_VER < 1400 || _MSC_VER >ğ1600)è&& !defšed(
_STLPORT_VERSION
)

395 
¡dext
::
unchecked_mism©ch


397 
¡d
::
mism©ch


399 #ià
_MSC_VER
 >= 1600

400 (
¡dext
::
	`make_unchecked_¬¿y_™”©Ü
(
sÿn
)+3, stdext::make_unchecked_¬¿y_™”©Ü(
sÿnEnd
), stdext::make_unchecked_¬¿y_™”©Ü(
m©ch
)+3).
fœ¡
 - stdext::make_unchecked_array_iterator(scan));

402 (
sÿn
+3, 
sÿnEnd
, 
m©ch
+3).
fœ¡
 - scan);

404 
	`as£¹
(
Ën
 !ğ
be¡L’gth
);

405 ià(
Ën
 > 
be¡L’gth
)

407 
be¡L’gth
 = 
Ën
;

408 
be¡M©ch
 = 
cu¼’t
;

409 ià(
Ën
 =ğ(
sÿnEnd
 - 
sÿn
))

413 
cu¼’t
 = 
m_´ev
[cu¼’ˆ& 
DMASK
];

415  (
be¡M©ch
 > 0è? 
be¡L’gth
 : 0;

416 
	}
}

418 
šlše
 
	gDeæ©Ü
::
	$In£¹SŒšg
(
¡¬t
)

420 
hash
 = 
	`Compu‹Hash
(
m_by‹Bufãr
 + 
¡¬t
);

421 
m_´ev
[
¡¬t
 & 
DMASK
] = 
m_h—d
[
hash
];

422 
m_h—d
[
hash
] = 
¡¬t
;

423 
	}
}

425 
	gDeæ©Ü
::
	$ProûssBufãr
()

427 ià(!
m_h—d”Wr™‹n
)

429 
	`Wr™eP»¡»amH—d”
();

430 
m_h—d”Wr™‹n
 = 
Œue
;

433 ià(
m_deæ©eLev–
 == 0)

435 
m_¡ršgS¹
 +ğ
m_lookah—d
;

436 
m_lookah—d
 = 0;

437 
m_blockL’gth
 = 
m_¡ršgS¹
 - 
m_blockS¹
;

438 
m_m©chAvaabË
 = 
çl£
;

442 
m_lookah—d
 > 
m_mšLookah—d
)

444 
m_diùiÚ¬yEnd
 < 
m_¡ršgS¹
 && m_diùiÚ¬yEnd+3 <ğm_¡ršgS¹+
m_lookah—d
)

445 
	`In£¹SŒšg
(
m_diùiÚ¬yEnd
++);

447 ià(
m_m©chAvaabË
)

449 
m©chPos™iÚ
, 
m©chL’gth
;

450 
boŞ
 
u£P»viousM©ch
;

451 ià(
m_´eviousL’gth
 >ğ
MAX_LAZYLENGTH
)

452 
u£P»viousM©ch
 = 
Œue
;

455 
m©chL’gth
 = 
	`LÚge¡M©ch
(
m©chPos™iÚ
);

456 
u£P»viousM©ch
 = (
m©chL’gth
 == 0);

458 ià(
u£P»viousM©ch
)

460 
	`M©chFound
(
m_¡ršgS¹
-1-
m_´eviousM©ch
, 
m_´eviousL’gth
);

461 
m_¡ršgS¹
 +ğ
m_´eviousL’gth
-1;

462 
m_lookah—d
 -ğ
m_´eviousL’gth
-1;

463 
m_m©chAvaabË
 = 
çl£
;

467 
m_´eviousL’gth
 = 
m©chL’gth
;

468 
m_´eviousM©ch
 = 
m©chPos™iÚ
;

469 
	`L™”®By‹
(
m_by‹Bufãr
[
m_¡ršgS¹
-1]);

470 
m_¡ršgS¹
++;

471 
m_lookah—d
--;

476 
m_´eviousL’gth
 = 0;

477 
m_´eviousL’gth
 = 
	`LÚge¡M©ch
(
m_´eviousM©ch
);

478 ià(
m_´eviousL’gth
)

479 
m_m©chAvaabË
 = 
Œue
;

481 
	`L™”®By‹
(
m_by‹Bufãr
[
m_¡ršgS¹
]);

482 
m_¡ršgS¹
++;

483 
m_lookah—d
--;

486 
	`as£¹
(
m_¡ršgS¹
 - (
m_blockS¹
+
m_blockL’gth
è=ğ()
m_m©chAvaabË
);

489 ià(
m_mšLookah—d
 =ğ0 && 
m_m©chAvaabË
)

491 
	`L™”®By‹
(
m_by‹Bufãr
[
m_¡ršgS¹
-1]);

492 
m_m©chAvaabË
 = 
çl£
;

494 
	}
}

496 
size_t
 
	gDeæ©Ü
::
	$Put2
(cÚ¡ 
by‹
 *
¡r
, 
size_t
 
Ëngth
, 
mes§geEnd
, 
boŞ
 
blockšg
)

498 ià(!
blockšg
)

499 
throw
 
	`BlockšgIÅutOÆy
("Deflator");

501 
size_t
 
acû±ed
 = 0;

502 
acû±ed
 < 
Ëngth
)

504 
ÃwAcû±ed
 = 
	`FlWšdow
(
¡r
+
acû±ed
, 
Ëngth
-accepted);

505 
	`ProûssBufãr
();

507 
	`ProûssUncom´es£dD©a
(
¡r
+
acû±ed
, 
ÃwAcû±ed
);

508 
acû±ed
 +ğ
ÃwAcû±ed
;

510 
	`as£¹
(
acû±ed
 =ğ
Ëngth
);

512 ià(
mes§geEnd
)

514 
m_mšLookah—d
 = 0;

515 
	`ProûssBufãr
();

516 
	`EndBlock
(
Œue
);

517 
	`FlushB™Bufãr
();

518 
	`Wr™ePo¡¡»amTa
();

519 
	`Re£t
();

522 
	`Ouut
(0, 
NULL
, 0, 
mes§geEnd
, 
blockšg
);

524 
	}
}

526 
boŞ
 
	gDeæ©Ü
::
	$IsŞ©edFlush
(
boŞ
 
h¬dFlush
, boŞ 
blockšg
)

528 ià(!
blockšg
)

529 
throw
 
	`BlockšgIÅutOÆy
("Deflator");

531 
m_mšLookah—d
 = 0;

532 
	`ProûssBufãr
();

533 
m_mšLookah—d
 = 
MAX_MATCH
;

534 
	`EndBlock
(
çl£
);

535 ià(
h¬dFlush
)

536 
	`EncodeBlock
(
çl£
, 
STORED
);

537  
çl£
;

538 
	}
}

540 
	gDeæ©Ü
::
	$L™”®By‹
(
by‹
 
b
)

542 ià(
m_m©chBufãrEnd
 =ğ
m_m©chBufãr
.
	`size
())

543 
	`EndBlock
(
çl£
);

545 
m_m©chBufãr
[
m_m©chBufãrEnd
++].
l™”®Code
 = 
b
;

546 
m_l™”®CouÁs
[
b
]++;

547 
m_blockL’gth
++;

548 
	}
}

550 
	gDeæ©Ü
::
	$M©chFound
(
di¡ªû
, 
Ëngth
)

552 ià(
m_m©chBufãrEnd
 =ğ
m_m©chBufãr
.
	`size
())

553 
	`EndBlock
(
çl£
);

555 cÚ¡ 
ËngthCodes
[] = {

572 cÚ¡ 
ËngthBa£s
[] = {3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258};

573 cÚ¡ 
di¡ªûBa£s
[30] =

576 
EncodedM©ch
 &
m
 = 
m_m©chBufãr
[
m_m©chBufãrEnd
++];

577 
	`as£¹
(
Ëngth
 >= 3);

578 
ËngthCode
 = 
ËngthCodes
[
Ëngth
-3];

579 
m
.
l™”®Code
 = 
ËngthCode
;

580 
m
.
l™”®ExŒa
 = 
Ëngth
 - 
ËngthBa£s
[
ËngthCode
-257];

581 
di¡ªûCode
 = ()(
	`uµ”_bound
(
di¡ªûBa£s
, di¡ªûBa£s+30, 
di¡ªû
) - distanceBases - 1);

582 
m
.
di¡ªûCode
 = distanceCode;

583 
m
.
di¡ªûExŒa
 = 
di¡ªû
 - 
di¡ªûBa£s
[
di¡ªûCode
];

585 
m_l™”®CouÁs
[
ËngthCode
]++;

586 
m_di¡ªûCouÁs
[
di¡ªûCode
]++;

587 
m_blockL’gth
 +ğ
Ëngth
;

588 
	}
}

590 
šlše
 
	$CodeL’gthEncode
(cÚ¡ *
begš
,

591 cÚ¡ *
’d
,

592 cÚ¡ *& 
p
,

593 &
exŒaB™s
,

594 &
exŒaB™sL’gth
)

596 
v
 = *
p
;

597 ià((
’d
-
p
) >= 3)

599 cÚ¡ *
Şdp
 = 
p
;

600 ià(
v
==0 && 
p
[1]==0 &&…[2]==0)

602 
p
õ+3;…!=
’d
 && *p==0 &&…!=
Şdp
+138;…++) {}

603 
»³©
 = ()(
p
 - 
Şdp
);

604 ià(
»³©
 <= 10)

606 
exŒaB™s
 = 
»³©
-3;

607 
exŒaB™sL’gth
 = 3;

612 
exŒaB™s
 = 
»³©
-11;

613 
exŒaB™sL’gth
 = 7;

617 ià(
p
!=
begš
 && 
v
==p[-1] && v==p[1] && v==p[2])

619 
p
õ+3;…!=
’d
 && *p==
v
 &&…!=
Şdp
+6;…++) {}

620 
»³©
 = ()(
p
 - 
Şdp
);

621 
exŒaB™s
 = 
»³©
-3;

622 
exŒaB™sL’gth
 = 2;

626 
p
++;

627 
exŒaB™s
 = 0;

628 
exŒaB™sL’gth
 = 0;

629  
v
;

630 
	}
}

632 
	gDeæ©Ü
::
	$EncodeBlock
(
boŞ
 
eof
, 
blockTy³
)

634 
	`PutB™s
(
eof
, 1);

635 
	`PutB™s
(
blockTy³
, 2);

637 ià(
blockTy³
 =ğ
STORED
)

639 
	`as£¹
(
m_blockS¹
 + 
m_blockL’gth
 <ğ
m_by‹Bufãr
.
	`size
());

640 
	`as£¹
(
m_blockL’gth
 <= 0xffff);

641 
	`FlushB™Bufãr
();

642 
	`A‰achedT¿nsfÜm©iÚ
()->
	`PutWÜd16
(
m_blockL’gth
, 
LITTLE_ENDIAN_ORDER
);

643 
	`A‰achedT¿nsfÜm©iÚ
()->
	`PutWÜd16
(~
m_blockL’gth
, 
LITTLE_ENDIAN_ORDER
);

644 
	`A‰achedT¿nsfÜm©iÚ
()->
	`Put
(
m_by‹Bufãr
 + 
m_blockS¹
, 
m_blockL’gth
);

648 ià(
blockTy³
 =ğ
DYNAMIC
)

650 #ià
	`defšed
(
_MSC_VER
è&& !defšed(
__MWERKS__
) && (_MSC_VER <= 1300)

652 
»v”£_bidœeùiÚ®_™”©Ü
<*, > 
	tRevIt
;

653 #–ià
	`defšed
(
_RWSTD_NO_CLASS_PARTIAL_SPEC
)

654 
»v”£_™”©Ü
<*, 
	t¿ndom_acûss_™”©Ü_g
, > 
	tRevIt
;

656 
»v”£_™”©Ü
<*> 
	tRevIt
;

659 
FixedSizeSecBlock
<, 286> 
l™”®CodeL’gths
;

660 
FixedSizeSecBlock
<, 30> 
di¡ªûCodeL’gths
;

662 
m_l™”®CouÁs
[256] = 1;

663 
HuffmªEncod”
::
	`G’”©eCodeL’gths
(
l™”®CodeL’gths
, 15, 
m_l™”®CouÁs
, 286);

664 
m_dyÇmicL™”®Encod”
.
	`In™Ÿlize
(
l™”®CodeL’gths
, 286);

665 
hl™
 = ()(
	`fšd_if
(
	`RevIt
(
l™”®CodeL’gths
.
	`’d
()), RevItÖ™”®CodeL’gths.
	`begš
()+257), 
	`bšd2nd
(
nÙ_equ®_to
<>(), 0)).
	`ba£
() - (literalCodeLengths.begin()+257));

667 
HuffmªEncod”
::
	`G’”©eCodeL’gths
(
di¡ªûCodeL’gths
, 15, 
m_di¡ªûCouÁs
, 30);

668 
m_dyÇmicDi¡ªûEncod”
.
	`In™Ÿlize
(
di¡ªûCodeL’gths
, 30);

669 
hdi¡
 = ()(
	`fšd_if
(
	`RevIt
(
di¡ªûCodeL’gths
.
	`’d
()), RevIt(di¡ªûCodeL’gths.
	`begš
()+1), 
	`bšd2nd
(
nÙ_equ®_to
<>(), 0)).
	`ba£
() - (distanceCodeLengths.begin()+1));

671 
SecBlockW™hHšt
<, 286+30> 
	`combšedL’gths
(
hl™
+257+
hdi¡
+1);

672 
	`memıy
(
combšedL’gths
, 
l™”®CodeL’gths
, (
hl™
+257)*());

673 
	`memıy
(
combšedL’gths
+
hl™
+257, 
di¡ªûCodeL’gths
, (
hdi¡
+1)*());

675 
FixedSizeSecBlock
<, 19> 
codeL’gthCodeCouÁs
, 
codeL’gthCodeL’gths
;

676 
	`fl
(
codeL’gthCodeCouÁs
.
	`begš
(), codeL’gthCodeCouÁs.
	`’d
(), 0);

677 cÚ¡ *
p
 = 
combšedL’gths
.
	`begš
(), *
begš
 = combšedL’gths.begš(), *
’d
 = combšedL’gths.
	`’d
();

678 
p
 !ğ
’d
)

680 
code
, 
exŒaB™s
, 
exŒaB™sL’gth
;

681 
code
 = 
	`CodeL’gthEncode
(
begš
, 
’d
, 
p
, 
exŒaB™s
, 
exŒaB™sL’gth
);

682 
codeL’gthCodeCouÁs
[
code
]++;

684 
HuffmªEncod”
::
	`G’”©eCodeL’gths
(
codeL’gthCodeL’gths
, 7, 
codeL’gthCodeCouÁs
, 19);

685 
HuffmªEncod”
 
	`codeL’gthEncod”
(
codeL’gthCodeL’gths
, 19);

686 cÚ¡ 
bÜd”
[] = {

688 
hş’
 = 19;

689 
hş’
 > 4 && 
codeL’gthCodeL’gths
[
bÜd”
[hclen-1]] == 0)

690 
hş’
--;

691 
hş’
 -= 4;

693 
	`PutB™s
(
hl™
, 5);

694 
	`PutB™s
(
hdi¡
, 5);

695 
	`PutB™s
(
hş’
, 4);

697 
i
=0; i<
hş’
+4; i++)

698 
	`PutB™s
(
codeL’gthCodeL’gths
[
bÜd”
[
i
]], 3);

700 
p
 = 
combšedL’gths
.
	`begš
();

701 
p
 !ğ
’d
)

703 
code
, 
exŒaB™s
, 
exŒaB™sL’gth
;

704 
code
 = 
	`CodeL’gthEncode
(
begš
, 
’d
, 
p
, 
exŒaB™s
, 
exŒaB™sL’gth
);

705 
codeL’gthEncod”
.
	`Encode
(*
this
, 
code
);

706 
	`PutB™s
(
exŒaB™s
, 
exŒaB™sL’gth
);

710 cÚ¡ 
ËngthExŒaB™s
[] = {

713 cÚ¡ 
di¡ªûExŒaB™s
[] = {

718 cÚ¡ 
HuffmªEncod”
 &
l™”®Encod”
 = (
blockTy³
 =ğ
STATIC
è? 
m_¡©icL™”®Encod”
 : 
m_dyÇmicL™”®Encod”
;

719 cÚ¡ 
HuffmªEncod”
 &
di¡ªûEncod”
 = (
blockTy³
 =ğ
STATIC
è? 
m_¡©icDi¡ªûEncod”
 : 
m_dyÇmicDi¡ªûEncod”
;

721 
i
=0; i<
m_m©chBufãrEnd
; i++)

723 
l™”®Code
 = 
m_m©chBufãr
[
i
].literalCode;

724 
l™”®Encod”
.
	`Encode
(*
this
, 
l™”®Code
);

725 ià(
l™”®Code
 >= 257)

727 
	`as£¹
(
l™”®Code
 <= 285);

728 
	`PutB™s
(
m_m©chBufãr
[
i
].
l™”®ExŒa
, 
ËngthExŒaB™s
[
l™”®Code
-257]);

729 
di¡ªûCode
 = 
m_m©chBufãr
[
i
].distanceCode;

730 
di¡ªûEncod”
.
	`Encode
(*
this
, 
di¡ªûCode
);

731 
	`PutB™s
(
m_m©chBufãr
[
i
].
di¡ªûExŒa
, 
di¡ªûExŒaB™s
[
di¡ªûCode
]);

734 
l™”®Encod”
.
	`Encode
(*
this
, 256);

736 
	}
}

738 
	gDeæ©Ü
::
	$EndBlock
(
boŞ
 
eof
)

740 ià(
m_blockL’gth
 =ğ0 && !
eof
)

743 ià(
m_deæ©eLev–
 == 0)

745 
	`EncodeBlock
(
eof
, 
STORED
);

747 ià(
m_com´essibËDeæ©eLev–
 > 0 && ++
m_d‘eùCouÁ
 =ğ
m_d‘eùSk
)

749 
m_deæ©eLev–
 = 
m_com´essibËDeæ©eLev–
;

750 
m_d‘eùCouÁ
 = 1;

755 
¡ÜedL’
 = 8*(()
m_blockL’gth
+4è+ 
	`RoundUpToMuÉËOf
(
m_b™sBufã»d
+3, 8U)-m_bitsBuffered;

757 
	`S¹CouÁšg
();

758 
	`EncodeBlock
(
eof
, 
STATIC
);

759 
¡©icL’
 = 
	`FšishCouÁšg
();

761 
dyÇmicL’
;

762 ià(
m_blockL’gth
 < 128 && 
m_deæ©eLev–
 < 8)

763 
dyÇmicL’
 = 
ULONG_MAX
;

766 
	`S¹CouÁšg
();

767 
	`EncodeBlock
(
eof
, 
DYNAMIC
);

768 
dyÇmicL’
 = 
	`FšishCouÁšg
();

771 ià(
¡ÜedL’
 <ğ
¡©icL’
 && stÜedL’ <ğ
dyÇmicL’
)

773 
	`EncodeBlock
(
eof
, 
STORED
);

775 ià(
m_com´essibËDeæ©eLev–
 > 0)

777 ià(
m_d‘eùSk
)

778 
m_deæ©eLev–
 = 0;

779 
m_d‘eùSk
 = m_d‘eùSk ? 
	`STDMIN
(2*m_detectSkip, 128U) : 1;

784 ià(
¡©icL’
 <ğ
dyÇmicL’
)

785 
	`EncodeBlock
(
eof
, 
STATIC
);

787 
	`EncodeBlock
(
eof
, 
DYNAMIC
);

789 ià(
m_com´essibËDeæ©eLev–
 > 0)

790 
m_d‘eùSk
 = 0;

794 
m_m©chBufãrEnd
 = 0;

795 
m_blockS¹
 +ğ
m_blockL’gth
;

796 
m_blockL’gth
 = 0;

797 
	`fl
(
m_l™”®CouÁs
.
	`begš
(), m_l™”®CouÁs.
	`’d
(), 0);

798 
	`fl
(
m_di¡ªûCouÁs
.
	`begš
(), m_di¡ªûCouÁs.
	`’d
(), 0);

799 
	}
}

801 
	gNAMESPACE_END


	@zdeflate.h

1 #iâdeà
CRYPTOPP_ZDEFLATE_H


2 
	#CRYPTOPP_ZDEFLATE_H


	)

4 
	~"f‹rs.h
"

5 
	~"misc.h
"

7 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

10 şas 
	cLowFœ¡B™Wr™”
 : 
public
 
F‹r


12 
public
:

13 
	`LowFœ¡B™Wr™”
(
Bufã»dT¿nsfÜm©iÚ
 *
©chm’t
);

14 
	`PutB™s
(
v®ue
, 
Ëngth
);

15 
	`FlushB™Bufãr
();

16 
	`CË¬B™Bufãr
();

18 
	`S¹CouÁšg
();

19 
	`FšishCouÁšg
();

21 
´Ùeùed
:

22 
boŞ
 
m_couÁšg
;

23 
m_b™CouÁ
;

24 
m_bufãr
;

25 
m_b™sBufã»d
, 
m_by‹sBufã»d
;

26 
FixedSizeSecBlock
<
by‹
, 256> 
m_ouutBufãr
;

30 şas 
	cHuffmªEncod”


32 
public
:

33 
	tcode_t
;

34 
	tv®ue_t
;

36 
	$HuffmªEncod”
() {}

37 
	`HuffmªEncod”
(cÚ¡ *
codeB™s
, 
nCodes
);

38 
	`In™Ÿlize
(cÚ¡ *
codeB™s
, 
nCodes
);

40 
	`G’”©eCodeL’gths
(*
codeB™s
, 
maxCodeB™s
, cÚ¡ *
codeCouÁs
, 
size_t
 
nCodes
);

42 
	$Encode
(
LowFœ¡B™Wr™”
 &
wr™”
, 
v®ue_t
 
v®ue
) const;

44 
	sCode


46 
code
;

47 
Ën
;

48 
	}
};

50 
	gSecBlock
<
	gCode
> 
	gm_v®ueToCode
;

55 şas 
	cDeæ©Ü
 : 
public
 
LowFœ¡B™Wr™”


57 
public
:

58 ’um {
MIN_DEFLATE_LEVEL
 = 0, 
	mDEFAULT_DEFLATE_LEVEL
 = 6, 
	mMAX_DEFLATE_LEVEL
 = 9};

59 ’um {
	gMIN_LOG2_WINDOW_SIZE
 = 9, 
	gDEFAULT_LOG2_WINDOW_SIZE
 = 15, 
	gMAX_LOG2_WINDOW_SIZE
 = 15};

63 
Deæ©Ü
(
Bufã»dT¿nsfÜm©iÚ
 *
©chm’t
=
NULL
, 
deæ©eLev–
=
DEFAULT_DEFLATE_LEVEL
, 
log2WšdowSize
=
DEFAULT_LOG2_WINDOW_SIZE
, 
boŞ
 
d‘eùUncom´essibË
=
Œue
);

65 
Deæ©Ü
(cÚ¡ 
NameV®uePaœs
 &
·¿m‘”s
, 
Bufã»dT¿nsfÜm©iÚ
 *
©chm’t
=
NULL
);

68 
S‘Deæ©eLev–
(
deæ©eLev–
);

69 
	$G‘Deæ©eLev–
(ècÚ¡ { 
m_deæ©eLev–
;
	}
}

70 
	$G‘Log2WšdowSize
(ècÚ¡ { 
m_log2WšdowSize
;
	}
}

72 
IsŞ©edIn™Ÿlize
(cÚ¡ 
NameV®uePaœs
 &
·¿m‘”s
);

73 
size_t
 
Put2
(cÚ¡ 
by‹
 *
šSŒšg
, size_ˆ
Ëngth
, 
mes§geEnd
, 
boŞ
 
blockšg
);

74 
boŞ
 
IsŞ©edFlush
(boŞ 
h¬dFlush
, boŞ 
blockšg
);

76 
	g´Ùeùed
:

77 
vœtu®
 
	$Wr™eP»¡»amH—d”
(è{
	}
}

78 
vœtu®
 
	$ProûssUncom´es£dD©a
(cÚ¡ 
by‹
 *
¡ršg
, 
size_t
 
Ëngth
è{
	}
}

79 
vœtu®
 
	$Wr™ePo¡¡»amTa
(è{
	}
}

81 ’um {
	gSTORED
 = 0, 
	gSTATIC
 = 1, 
	gDYNAMIC
 = 2};

82 ’um {
	gMIN_MATCH
 = 3, 
	gMAX_MATCH
 = 258};

84 
In™ŸlizeSticEncod”s
();

85 
Re£t
(
boŞ
 
fÜûRe£t
 = 
çl£
);

86 
FlWšdow
(cÚ¡ 
by‹
 *
¡r
, 
size_t
 
Ëngth
);

87 
	$Compu‹Hash
(cÚ¡ 
by‹
 *
¡r
) const;

88 
	$LÚge¡M©ch
(&
be¡M©ch
) const;

89 
	`In£¹SŒšg
(
¡¬t
);

90 
	`ProûssBufãr
();

92 
	`L™”®By‹
(
by‹
 
b
);

93 
	`M©chFound
(
di¡ªû
, 
Ëngth
);

94 
	`EncodeBlock
(
boŞ
 
eof
, 
blockTy³
);

95 
	`EndBlock
(
boŞ
 
eof
);

97 
	sEncodedM©ch


99 
l™”®Code
 : 9;

100 
l™”®ExŒa
 : 5;

101 
di¡ªûCode
 : 5;

102 
di¡ªûExŒa
 : 13;

103 
	}
};

105 
	gm_deæ©eLev–
, 
	gm_log2WšdowSize
, 
	gm_com´essibËDeæ©eLev–
;

106 
	gm_d‘eùSk
, 
	gm_d‘eùCouÁ
;

107 
	gDSIZE
, 
	gDMASK
, 
	gHSIZE
, 
	gHMASK
, 
	gGOOD_MATCH
, 
	gMAX_LAZYLENGTH
, 
	gMAX_CHAIN_LENGTH
;

108 
boŞ
 
	gm_h—d”Wr™‹n
, 
	gm_m©chAvaabË
;

109 
	gm_diùiÚ¬yEnd
, 
	gm_¡ršgS¹
, 
	gm_lookah—d
, 
	gm_mšLookah—d
, 
	gm_´eviousM©ch
, 
	gm_´eviousL’gth
;

110 
HuffmªEncod”
 
	gm_¡©icL™”®Encod”
, 
	gm_¡©icDi¡ªûEncod”
, 
	gm_dyÇmicL™”®Encod”
, 
	gm_dyÇmicDi¡ªûEncod”
;

111 
SecBy‹Block
 
	gm_by‹Bufãr
;

112 
	gSecBlock
<
	gwÜd16
> 
	gm_h—d
, 
	gm_´ev
;

113 
	gFixedSizeSecBlock
<, 286> 
	gm_l™”®CouÁs
;

114 
	gFixedSizeSecBlock
<, 30> 
	gm_di¡ªûCouÁs
;

115 
	gSecBlock
<
	gEncodedM©ch
> 
	gm_m©chBufãr
;

116 
	gm_m©chBufãrEnd
, 
	gm_blockS¹
, 
	gm_blockL’gth
;

119 
	gNAMESPACE_END


	@zinflate.cpp

8 
	~"pch.h
"

9 
	~"zšæ©e.h
"

11 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

13 
	sCodeLessThª


15 
šlše
 
boŞ
 
	`İ”©Ü
()(
Cry±oPP
::
HuffmªDecod”
::
code_t
 
lhs
, cÚ¡ Cry±oPP::HuffmªDecod”::
CodeInfo
 &
rhs
)

16 { 
lhs
 < 
rhs
.
code
;}

18 
šlše
 
boŞ
 
	`İ”©Ü
()(cÚ¡ 
Cry±oPP
::
HuffmªDecod”
::
CodeInfo
 &
lhs
, cÚ¡ Cry±oPP::HuffmªDecod”::CodeInfØ&
rhs
)

19 { 
lhs
.
code
 < 
rhs
.code;}

22 
šlše
 
boŞ
 
LowFœ¡B™R—d”
::
	$FlBufãr
(
Ëngth
)

24 
m_b™sBufã»d
 < 
Ëngth
)

26 
by‹
 
b
;

27 ià(!
m_¡Üe
.
	`G‘
(
b
))

28  
çl£
;

29 
m_bufãr
 |ğ()
b
 << 
m_b™sBufã»d
;

30 
m_b™sBufã»d
 += 8;

32 
	`as£¹
(
m_b™sBufã»d
 <= ()*8);

33  
Œue
;

34 
	}
}

36 
šlše
 
	gLowFœ¡B™R—d”
::
	$P“kB™s
(
Ëngth
)

38 
boŞ
 
»suÉ
 = 
	`FlBufãr
(
Ëngth
);

39 
	`as£¹
(
»suÉ
);

40  
m_bufãr
 & ((()1 << 
Ëngth
) - 1);

41 
	}
}

43 
šlše
 
	gLowFœ¡B™R—d”
::
	$SkB™s
(
Ëngth
)

45 
	`as£¹
(
m_b™sBufã»d
 >ğ
Ëngth
);

46 
m_bufãr
 >>ğ
Ëngth
;

47 
m_b™sBufã»d
 -ğ
Ëngth
;

48 
	}
}

50 
šlše
 
	gLowFœ¡B™R—d”
::
	$G‘B™s
(
Ëngth
)

52 
»suÉ
 = 
	`P“kB™s
(
Ëngth
);

53 
	`SkB™s
(
Ëngth
);

54  
»suÉ
;

55 
	}
}

57 
šlše
 
	gHuffmªDecod”
::
code_t
 
HuffmªDecod”
::
	$NÜm®izeCode
(
HuffmªDecod”
::
code_t
 
code
, 
codeB™s
)

59  
code
 << (
MAX_CODE_BITS
 - 
codeB™s
);

60 
	}
}

62 
	gHuffmªDecod”
::
	$In™Ÿlize
(cÚ¡ *
codeB™s
, 
nCodes
)

79 ià(
nCodes
 == 0)

80 
throw
 
	`E¼
("null code");

82 
m_maxCodeB™s
 = *
¡d
::
	`max_–em’t
(
codeB™s
, codeB™s+
nCodes
);

84 ià(
m_maxCodeB™s
 > 
MAX_CODE_BITS
)

85 
throw
 
	`E¼
("code†engthƒxceeds maximum");

87 ià(
m_maxCodeB™s
 == 0)

88 
throw
 
	`E¼
("null code");

91 
SecBlockW™hHšt
<, 15+1> 
	`blCouÁ
(
m_maxCodeB™s
+1);

92 
¡d
::
	`fl
(
blCouÁ
.
	`begš
(), blCouÁ.
	`’d
(), 0);

93 
i
;

94 
i
=0; i<
nCodes
; i++)

95 
blCouÁ
[
codeB™s
[
i
]]++;

98 
code_t
 
code
 = 0;

99 
SecBlockW™hHšt
<
code_t
, 15+1> 
	`ÃxtCode
(
m_maxCodeB™s
+1);

100 
ÃxtCode
[1] = 0;

101 
i
=2; i<=
m_maxCodeB™s
; i++)

104 ià(
code
 > cod+ 
blCouÁ
[
i
-1])

105 
throw
 
	`E¼
("codes oversubscribed");

106 
code
 +ğ
blCouÁ
[
i
-1];

107 ià(
code
 > (code << 1))

108 
throw
 
	`E¼
("codes oversubscribed");

109 
code
 <<= 1;

110 
ÃxtCode
[
i
] = 
code
;

113 ià(
code
 > (1 << 
m_maxCodeB™s
è- 
blCouÁ
[m_maxCodeBits])

114 
throw
 
	`E¼
("codes oversubscribed");

115 ià(
m_maxCodeB™s
 !ğ1 && 
code
 < (1 << m_maxCodeB™sè- 
blCouÁ
[m_maxCodeBits])

116 
throw
 
	`E¼
("codes incomplete");

119 
m_codeToV®ue
.
	`»size
(
nCodes
 - 
blCouÁ
[0]);

120 
j
=0;

121 
i
=0; i<
nCodes
; i++)

123 
Ën
 = 
codeB™s
[
i
];

124 ià(
Ën
 != 0)

126 
code
 = 
	`NÜm®izeCode
(
ÃxtCode
[
Ën
]++,†en);

127 
m_codeToV®ue
[
j
].
code
 = code;

128 
m_codeToV®ue
[
j
].
Ën
 =†en;

129 
m_codeToV®ue
[
j
].
v®ue
 = 
i
;

130 
j
++;

133 
¡d
::
	`sÜt
(
m_codeToV®ue
.
	`begš
(), m_codeToV®ue.
	`’d
());

136 
m_ÿcheB™s
 = 
	`STDMIN
(9U, 
m_maxCodeB™s
);

137 
m_ÿcheMask
 = (1 << 
m_ÿcheB™s
) - 1;

138 
m_nÜm®izedCacheMask
 = 
	`NÜm®izeCode
(
m_ÿcheMask
, 
m_ÿcheB™s
);

139 
	`as£¹
(
m_nÜm®izedCacheMask
 =ğ
	`B™Rev”£
(
m_ÿcheMask
));

141 ià(
m_ÿche
.
	`size
(è!ğ
	`size_t
(1è<< 
m_ÿcheB™s
)

142 
m_ÿche
.
	`»size
(1 << 
m_ÿcheB™s
);

144 
i
=0; i<
m_ÿche
.
	`size
(); i++)

145 
m_ÿche
[
i
].
ty³
 = 0;

146 
	}
}

148 
	gHuffmªDecod”
::
	$FlCacheEÁry
(
LookupEÁry
 &
’Œy
, 
code_t
 
nÜm®izedCode
) const

150 
nÜm®izedCode
 &ğ
m_nÜm®izedCacheMask
;

151 cÚ¡ 
CodeInfo
 &
codeInfo
 = *(
¡d
::
	`uµ”_bound
(
m_codeToV®ue
.
	`begš
(), m_codeToV®ue.
	`’d
(), 
nÜm®izedCode
, 
	`CodeLessThª
())-1);

152 ià(
codeInfo
.
Ën
 <ğ
m_ÿcheB™s
)

154 
’Œy
.
ty³
 = 1;

155 
’Œy
.
v®ue
 = 
codeInfo
.value;

156 
’Œy
.
Ën
 = 
codeInfo
.len;

160 
’Œy
.
begš
 = &
codeInfo
;

161 cÚ¡ 
CodeInfo
 *
Ï¡
 = & *(
¡d
::
	`uµ”_bound
(
m_codeToV®ue
.
	`begš
(), m_codeToV®ue.
	`’d
(), 
nÜm®izedCode
 + ~
m_nÜm®izedCacheMask
, 
	`CodeLessThª
())-1);

162 ià(
codeInfo
.
Ën
 =ğ
Ï¡
->len)

164 
’Œy
.
ty³
 = 2;

165 
’Œy
.
Ën
 = 
codeInfo
.len;

169 
’Œy
.
ty³
 = 3;

170 
’Œy
.
’d
 = 
Ï¡
+1;

173 
	}
}

175 
šlše
 
	gHuffmªDecod”
::
	$Decode
(
code_t
 
code
, 
v®ue_t
 &
v®ue
) const

177 
	`as£¹
(
m_codeToV®ue
.
	`size
() > 0);

178 
LookupEÁry
 &
’Œy
 = 
m_ÿche
[
code
 & 
m_ÿcheMask
];

180 
code_t
 
nÜm®izedCode
;

181 ià(
’Œy
.
ty³
 != 1)

182 
nÜm®izedCode
 = 
	`B™Rev”£
(
code
);

184 ià(
’Œy
.
ty³
 == 0)

185 
	`FlCacheEÁry
(
’Œy
, 
nÜm®izedCode
);

187 ià(
’Œy
.
ty³
 == 1)

189 
v®ue
 = 
’Œy
.value;

190  
’Œy
.
Ën
;

194 cÚ¡ 
CodeInfo
 &
codeInfo
 = (
’Œy
.
ty³
 == 2)

195 ? 
’Œy
.
begš
[(
nÜm®izedCode
 << 
m_ÿcheB™s
è>> (
MAX_CODE_BITS
 - (’Œy.
Ën
 - m_cacheBits))]

196 : *(
¡d
::
	`uµ”_bound
(
’Œy
.
begš
,ƒÁry.
’d
, 
nÜm®izedCode
, 
	`CodeLessThª
())-1);

197 
v®ue
 = 
codeInfo
.value;

198  
codeInfo
.
Ën
;

200 
	}
}

202 
boŞ
 
	gHuffmªDecod”
::
	$Decode
(
LowFœ¡B™R—d”
 &
»ad”
, 
v®ue_t
 &
v®ue
) const

204 
»ad”
.
	`FlBufãr
(
m_maxCodeB™s
);

205 
codeB™s
 = 
	`Decode
(
»ad”
.
	`P“kBufãr
(), 
v®ue
);

206 ià(
codeB™s
 > 
»ad”
.
	`B™sBufã»d
())

207  
çl£
;

208 
»ad”
.
	`SkB™s
(
codeB™s
);

209  
Œue
;

210 
	}
}

214 
	gInæ©Ü
::
	$Inæ©Ü
(
Bufã»dT¿nsfÜm©iÚ
 *
©chm’t
, 
boŞ
 
»³©
, 
´İag©iÚ
)

215 : 
AutoSigÇlšg
<
F‹r
>(
´İag©iÚ
)

216 , 
	`m_¡©e
(
PRE_STREAM
), 
	`m_»³©
(
»³©
), 
	$m_»ad”
(
m_šQueue
)

218 
	`D‘ach
(
©chm’t
);

219 
	}
}

221 
	gInæ©Ü
::
	$IsŞ©edIn™Ÿlize
(cÚ¡ 
NameV®uePaœs
 &
·¿m‘”s
)

223 
m_¡©e
 = 
PRE_STREAM
;

224 
·¿m‘”s
.
	`G‘V®ue
("R•—t", 
m_»³©
);

225 
m_šQueue
.
	`CË¬
();

226 
m_»ad”
.
	`SkB™s
(m_»ad”.
	`B™sBufã»d
());

227 
	}
}

229 
	gInæ©Ü
::
	$OuutBy‹
(
by‹
 
b
)

231 
m_wšdow
[
m_cu¼’t
++] = 
b
;

232 ià(
m_cu¼’t
 =ğ
m_wšdow
.
	`size
())

234 
	`ProûssDecom´es£dD©a
(
m_wšdow
 + 
m_Ï¡Flush
, m_wšdow.
	`size
() - m_lastFlush);

235 
m_Ï¡Flush
 = 0;

236 
m_cu¼’t
 = 0;

237 
m_w¿µedAround
 = 
Œue
;

239 
	}
}

241 
	gInæ©Ü
::
	$OuutSŒšg
(cÚ¡ 
by‹
 *
¡ršg
, 
size_t
 
Ëngth
)

243 
Ëngth
)

245 
size_t
 
Ën
 = 
	`UnsigÃdMš
(
Ëngth
, 
m_wšdow
.
	`size
(è- 
m_cu¼’t
);

246 
	`memıy
(
m_wšdow
 + 
m_cu¼’t
, 
¡ršg
, 
Ën
);

247 
m_cu¼’t
 +ğ
Ën
;

248 ià(
m_cu¼’t
 =ğ
m_wšdow
.
	`size
())

250 
	`ProûssDecom´es£dD©a
(
m_wšdow
 + 
m_Ï¡Flush
, m_wšdow.
	`size
() - m_lastFlush);

251 
m_Ï¡Flush
 = 0;

252 
m_cu¼’t
 = 0;

253 
m_w¿µedAround
 = 
Œue
;

255 
¡ršg
 +ğ
Ën
;

256 
Ëngth
 -ğ
Ën
;

258 
	}
}

260 
	gInæ©Ü
::
	$OuutPa¡
(
Ëngth
, 
di¡ªû
)

262 
size_t
 
¡¬t
;

263 ià(
di¡ªû
 <ğ
m_cu¼’t
)

264 
¡¬t
 = 
m_cu¼’t
 - 
di¡ªû
;

265 ià(
m_w¿µedAround
 && 
di¡ªû
 <ğ
m_wšdow
.
	`size
())

266 
¡¬t
 = 
m_cu¼’t
 + 
m_wšdow
.
	`size
(è- 
di¡ªû
;

268 
throw
 
	`BadBlockE¼
();

270 ià(
¡¬t
 + 
Ëngth
 > 
m_wšdow
.
	`size
())

272 ; 
¡¬t
 < 
m_wšdow
.
	`size
(); s¹++, 
Ëngth
--)

273 
	`OuutBy‹
(
m_wšdow
[
¡¬t
]);

274 
¡¬t
 = 0;

277 ià(
¡¬t
 + 
Ëngth
 > 
m_cu¼’t
 || m_cu¼’ˆ+†’gth >ğ
m_wšdow
.
	`size
())

279 
Ëngth
--)

280 
	`OuutBy‹
(
m_wšdow
[
¡¬t
++]);

284 
	`memıy
(
m_wšdow
 + 
m_cu¼’t
, m_wšdow + 
¡¬t
, 
Ëngth
);

285 
m_cu¼’t
 +ğ
Ëngth
;

287 
	}
}

289 
size_t
 
	gInæ©Ü
::
	$Put2
(cÚ¡ 
by‹
 *
šSŒšg
, 
size_t
 
Ëngth
, 
mes§geEnd
, 
boŞ
 
blockšg
)

291 ià(!
blockšg
)

292 
throw
 
	`BlockšgIÅutOÆy
("Inflator");

294 
LazyPu‰”
 
	`Í
(
m_šQueue
, 
šSŒšg
, 
Ëngth
);

295 
	`ProûssIÅut
(
mes§geEnd
 != 0);

297 ià(
mes§geEnd
)

298 ià(!(
m_¡©e
 =ğ
PRE_STREAM
 || m_¡©=ğ
AFTER_END
))

299 
throw
 
	`UÃx³ùedEndE¼
();

301 
	`Ouut
(0, 
NULL
, 0, 
mes§geEnd
, 
blockšg
);

303 
	}
}

305 
boŞ
 
	gInæ©Ü
::
	$IsŞ©edFlush
(
boŞ
 
h¬dFlush
, boŞ 
blockšg
)

307 ià(!
blockšg
)

308 
throw
 
	`BlockšgIÅutOÆy
("Inflator");

310 ià(
h¬dFlush
)

311 
	`ProûssIÅut
(
Œue
);

312 
	`FlushOuut
();

314  
çl£
;

315 
	}
}

317 
	gInæ©Ü
::
	$ProûssIÅut
(
boŞ
 
æush
)

319 
Œue
)

321 
m_¡©e
)

323 
PRE_STREAM
:

324 ià(!
æush
 && 
m_šQueue
.
	`Cu¼’tSize
(è< 
	`MaxP»¡»amH—d”Size
())

326 
	`ProûssP»¡»amH—d”
();

327 
m_¡©e
 = 
WAIT_HEADER
;

328 
m_w¿µedAround
 = 
çl£
;

329 
m_cu¼’t
 = 0;

330 
m_Ï¡Flush
 = 0;

331 
m_wšdow
.
	`New
(1 << 
	`G‘Log2WšdowSize
());

333 
WAIT_HEADER
:

336 cÚ¡ 
size_t
 
MAX_HEADER_SIZE
 = 
	`B™sToBy‹s
(3+5+5+4+19*7+286*15+19*15);

337 ià(
m_šQueue
.
	`Cu¼’tSize
(è< (
æush
 ? 1 : 
MAX_HEADER_SIZE
))

339 
	`DecodeH—d”
();

342 
DECODING_BODY
:

343 ià(!
	`DecodeBody
())

346 
POST_STREAM
:

347 ià(!
æush
 && 
m_šQueue
.
	`Cu¼’tSize
(è< 
	`MaxPo¡¡»amTaSize
())

349 
	`ProûssPo¡¡»amTa
();

350 
m_¡©e
 = 
m_»³©
 ? 
PRE_STREAM
 : 
AFTER_END
;

351 
	`Ouut
(0, 
NULL
, 0, 
	`G‘AutoSigÇlPrİag©iÚ
(), 
Œue
);

352 ià(
m_šQueue
.
	`IsEm±y
())

355 
AFTER_END
:

356 
m_šQueue
.
	`T¿nsãrTo
(*
	`A‰achedT¿nsfÜm©iÚ
());

360 
	}
}

362 
	gInæ©Ü
::
	$DecodeH—d”
()

364 ià(!
m_»ad”
.
	`FlBufãr
(3))

365 
throw
 
	`UÃx³ùedEndE¼
();

366 
m_eof
 = 
m_»ad”
.
	`G‘B™s
(1) != 0;

367 
m_blockTy³
 = (
by‹
)
m_»ad”
.
	`G‘B™s
(2);

368 
m_blockTy³
)

372 
m_»ad”
.
	`SkB™s
(m_»ad”.
	`B™sBufã»d
() % 8);

373 ià(!
m_»ad”
.
	`FlBufãr
(32))

374 
throw
 
	`UÃx³ùedEndE¼
();

375 
m_¡ÜedL’
 = (
wÜd16
)
m_»ad”
.
	`G‘B™s
(16);

376 
wÜd16
 
Æ’
 = (wÜd16)
m_»ad”
.
	`G‘B™s
(16);

377 ià(
Æ’
 !ğ(
wÜd16
)~
m_¡ÜedL’
)

378 
throw
 
	`BadBlockE¼
();

382 
m_ÃxtDecode
 = 
LITERAL
;

386 ià(!
m_»ad”
.
	`FlBufãr
(5+5+4))

387 
throw
 
	`UÃx³ùedEndE¼
();

388 
hl™
 = 
m_»ad”
.
	`G‘B™s
(5);

389 
hdi¡
 = 
m_»ad”
.
	`G‘B™s
(5);

390 
hş’
 = 
m_»ad”
.
	`G‘B™s
(4);

392 
FixedSizeSecBlock
<, 286+32> 
codeL’gths
;

393 
i
;

394 cÚ¡ 
bÜd”
[] = {

396 
¡d
::
	`fl
(
codeL’gths
.
	`begš
(), codeLengths+19, 0);

397 
i
=0; i<
hş’
+4; i++)

398 
codeL’gths
[
bÜd”
[
i
]] = 
m_»ad”
.
	`G‘B™s
(3);

400 
Œy


402 
HuffmªDecod”
 
	`codeL’gthDecod”
(
codeL’gths
, 19);

403 
i
 = 0; i < 
hl™
+257+
hdi¡
+1; )

405 
k
, 
couÁ
, 
»³©”
;

406 
boŞ
 
»suÉ
 = 
codeL’gthDecod”
.
	`Decode
(
m_»ad”
, 
k
);

407 ià(!
»suÉ
)

408 
throw
 
	`UÃx³ùedEndE¼
();

409 ià(
k
 <= 15)

411 
couÁ
 = 1;

412 
»³©”
 = 
k
;

414 
k
)

417 ià(!
m_»ad”
.
	`FlBufãr
(2))

418 
throw
 
	`UÃx³ùedEndE¼
();

419 
couÁ
 = 3 + 
m_»ad”
.
	`G‘B™s
(2);

420 ià(
i
 == 0)

421 
throw
 
	`BadBlockE¼
();

422 
»³©”
 = 
codeL’gths
[
i
-1];

425 ià(!
m_»ad”
.
	`FlBufãr
(3))

426 
throw
 
	`UÃx³ùedEndE¼
();

427 
couÁ
 = 3 + 
m_»ad”
.
	`G‘B™s
(3);

428 
»³©”
 = 0;

431 ià(!
m_»ad”
.
	`FlBufãr
(7))

432 
throw
 
	`UÃx³ùedEndE¼
();

433 
couÁ
 = 11 + 
m_»ad”
.
	`G‘B™s
(7);

434 
»³©”
 = 0;

437 ià(
i
 + 
couÁ
 > 
hl™
+257+
hdi¡
+1)

438 
throw
 
	`BadBlockE¼
();

439 
¡d
::
	`fl
(
codeL’gths
 + 
i
, codeL’gth + i + 
couÁ
, 
»³©”
);

440 
i
 +ğ
couÁ
;

442 
m_dyÇmicL™”®Decod”
.
	`In™Ÿlize
(
codeL’gths
, 
hl™
+257);

443 ià(
hdi¡
 =ğ0 && 
codeL’gths
[
hl™
+257] == 0)

445 ià(
hl™
 != 0)

446 
throw
 
	`BadBlockE¼
();

449 
m_dyÇmicDi¡ªûDecod”
.
	`In™Ÿlize
(
codeL’gths
+
hl™
+257, 
hdi¡
+1);

450 
m_ÃxtDecode
 = 
LITERAL
;

452 
	`ÿtch
 (
HuffmªDecod”
::
E¼
 &)

454 
throw
 
	`BadBlockE¼
();

459 
throw
 
	`BadBlockE¼
();

461 
m_¡©e
 = 
DECODING_BODY
;

462 
	}
}

464 
boŞ
 
	gInæ©Ü
::
	$DecodeBody
()

466 
boŞ
 
blockEnd
 = 
çl£
;

467 
m_blockTy³
)

470 
	`as£¹
(
m_»ad”
.
	`B™sBufã»d
() == 0);

471 !
m_šQueue
.
	`IsEm±y
(è&& !
blockEnd
)

473 
size_t
 
size
;

474 cÚ¡ 
by‹
 *
block
 = 
m_šQueue
.
	`Spy
(
size
);

475 
size
 = 
	`UnsigÃdMš
(
m_¡ÜedL’
, size);

476 
	`OuutSŒšg
(
block
, 
size
);

477 
m_šQueue
.
	`Sk
(
size
);

478 
m_¡ÜedL’
 -ğ(
wÜd16
)
size
;

479 ià(
m_¡ÜedL’
 == 0)

480 
blockEnd
 = 
Œue
;

485 cÚ¡ 
ËngthS¹s
[] = {

488 cÚ¡ 
ËngthExŒaB™s
[] = {

491 cÚ¡ 
di¡ªûS¹s
[] = {

495 cÚ¡ 
di¡ªûExŒaB™s
[] = {

500 cÚ¡ 
HuffmªDecod”
& 
l™”®Decod”
 = 
	`G‘L™”®Decod”
();

501 cÚ¡ 
HuffmªDecod”
& 
di¡ªûDecod”
 = 
	`G‘Di¡ªûDecod”
();

503 
m_ÃxtDecode
)

505 
LITERAL
:

506 
Œue
)

508 ià(!
l™”®Decod”
.
	`Decode
(
m_»ad”
, 
m_l™”®
))

510 
m_ÃxtDecode
 = 
LITERAL
;

513 ià(
m_l™”®
 < 256)

514 
	`OuutBy‹
((
by‹
)
m_l™”®
);

515 ià(
m_l™”®
 == 256)

517 
blockEnd
 = 
Œue
;

522 ià(
m_l™”®
 > 285)

523 
throw
 
	`BadBlockE¼
();

524 
b™s
;

525 
LENGTH_BITS
:

526 
b™s
 = 
ËngthExŒaB™s
[
m_l™”®
-257];

527 ià(!
m_»ad”
.
	`FlBufãr
(
b™s
))

529 
m_ÃxtDecode
 = 
LENGTH_BITS
;

532 
m_l™”®
 = 
m_»ad”
.
	`G‘B™s
(
b™s
è+ 
ËngthS¹s
[m_literal-257];

533 
DISTANCE
:

534 ià(!
di¡ªûDecod”
.
	`Decode
(
m_»ad”
, 
m_di¡ªû
))

536 
m_ÃxtDecode
 = 
DISTANCE
;

539 
DISTANCE_BITS
:

540 
b™s
 = 
di¡ªûExŒaB™s
[
m_di¡ªû
];

541 ià(!
m_»ad”
.
	`FlBufãr
(
b™s
))

543 
m_ÃxtDecode
 = 
DISTANCE_BITS
;

546 
m_di¡ªû
 = 
m_»ad”
.
	`G‘B™s
(
b™s
è+ 
di¡ªûS¹s
[m_distance];

547 
	`OuutPa¡
(
m_l™”®
, 
m_di¡ªû
);

552 ià(
blockEnd
)

554 ià(
m_eof
)

556 
	`FlushOuut
();

557 
m_»ad”
.
	`SkB™s
(m_»ad”.
	`B™sBufã»d
()%8);

558 ià(
m_»ad”
.
	`B™sBufã»d
())

561 
SecBlockW™hHšt
<
by‹
, 4> 
	`bufãr
(
m_»ad”
.
	`B™sBufã»d
() / 8);

562 
i
=0; i<
bufãr
.
	`size
(); i++)

563 
bufãr
[
i
] = (
by‹
)
m_»ad”
.
	`G‘B™s
(8);

564 
m_šQueue
.
	`Ung‘
(
bufãr
, bufãr.
	`size
());

566 
m_¡©e
 = 
POST_STREAM
;

569 
m_¡©e
 = 
WAIT_HEADER
;

571  
blockEnd
;

572 
	}
}

574 
	gInæ©Ü
::
	$FlushOuut
()

576 ià(
m_¡©e
 !ğ
PRE_STREAM
)

578 
	`as£¹
(
m_cu¼’t
 >ğ
m_Ï¡Flush
);

579 
	`ProûssDecom´es£dD©a
(
m_wšdow
 + 
m_Ï¡Flush
, 
m_cu¼’t
 - m_lastFlush);

580 
m_Ï¡Flush
 = 
m_cu¼’t
;

582 
	}
}

584 
	sNewFixedL™”®Decod”


586 
HuffmªDecod”
 * 
İ”©Ü
()() const

588 
	mcodeL’gths
[288];

589 
	m¡d
::
fl
(
codeL’gths
 + 0, codeLengths + 144, 8);

590 
	m¡d
::
fl
(
codeL’gths
 + 144, codeLengths + 256, 9);

591 
	m¡d
::
fl
(
codeL’gths
 + 256, codeLengths + 280, 7);

592 
	m¡d
::
fl
(
codeL’gths
 + 280, codeLengths + 288, 8);

593 
	m¡d
::
auto_±r
<
HuffmªDecod”
> 
pDecod”
(
Ãw
 HuffmanDecoder);

594 
	mpDecod”
->
In™Ÿlize
(
codeL’gths
, 288);

595  
	mpDecod”
.
»Ëa£
();

599 
	sNewFixedDi¡ªûDecod”


601 
HuffmªDecod”
 * 
İ”©Ü
()() const

603 
	mcodeL’gths
[32];

604 
	m¡d
::
fl
(
codeL’gths
 + 0, codeLengths + 32, 5);

605 
	m¡d
::
auto_±r
<
HuffmªDecod”
> 
pDecod”
(
Ãw
 HuffmanDecoder);

606 
	mpDecod”
->
In™Ÿlize
(
codeL’gths
, 32);

607  
	mpDecod”
.
»Ëa£
();

611 cÚ¡ 
	gHuffmªDecod”
& 
	gInæ©Ü
::
	$G‘L™”®Decod”
() const

613  
m_blockTy³
 =ğ1 ? 
SšgËtÚ
<
HuffmªDecod”
, 
NewFixedL™”®Decod”
>().
	`Ref
(è: 
m_dyÇmicL™”®Decod”
;

614 
	}
}

616 cÚ¡ 
	gHuffmªDecod”
& 
	gInæ©Ü
::
	$G‘Di¡ªûDecod”
() const

618  
m_blockTy³
 =ğ1 ? 
SšgËtÚ
<
HuffmªDecod”
, 
NewFixedDi¡ªûDecod”
>().
	`Ref
(è: 
m_dyÇmicDi¡ªûDecod”
;

619 
	}
}

621 
	gNAMESPACE_END


	@zinflate.h

1 #iâdeà
CRYPTOPP_ZINFLATE_H


2 
	#CRYPTOPP_ZINFLATE_H


	)

4 
	~"f‹rs.h
"

5 
	~<veùÜ
>

7 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

10 şas 
	cLowFœ¡B™R—d”


12 
public
:

13 
	$LowFœ¡B™R—d”
(
Bufã»dT¿nsfÜm©iÚ
 &
¡Üe
)

14 : 
	`m_¡Üe
(
¡Üe
), 
	`m_bufãr
(0), 
	$m_b™sBufã»d
(0) {}

16 
	$B™sBufã»d
(ècÚ¡ { 
m_b™sBufã»d
;
	}
}

17 
	$P“kBufãr
(ècÚ¡ { 
m_bufãr
;
	}
}

18 
boŞ
 
FlBufãr
(
Ëngth
);

19 
P“kB™s
(
Ëngth
);

20 
SkB™s
(
Ëngth
);

21 
G‘B™s
(
Ëngth
);

23 
	g´iv©e
:

24 
Bufã»dT¿nsfÜm©iÚ
 &
m_¡Üe
;

25 
	gm_bufãr
;

26 
	gm_b™sBufã»d
;

29 
	gCodeLessThª
;

32 şas 
	cHuffmªDecod”


34 
	mpublic
:

35 
	tcode_t
;

36 
	tv®ue_t
;

37 ’um {
	mMAX_CODE_BITS
 = (
code_t
)*8};

39 şas 
	cE¼
 : 
public
 
Exû±iÚ
 {public: 
E¼
(cÚ¡ 
¡d
::
¡ršg
 &
wh©
è: Exû±iÚ(
INVALID_DATA_FORMAT
, "HuffmanDecoder: " + what) {}};

41 
	$HuffmªDecod”
(è{
	}
}

42 
	$HuffmªDecod”
(cÚ¡ *
codeB™L’gths
, 
nCodes
è{
	`In™Ÿlize
(codeB™L’gths,‚Codes);
	}
}

44 
In™Ÿlize
(cÚ¡ *
codeB™L’gths
, 
nCodes
);

45 
	$Decode
(
code_t
 
code
, 
v®ue_t
 &
v®ue
) const;

46 
boŞ
 
	$Decode
(
LowFœ¡B™R—d”
 &
»ad”
, 
v®ue_t
 &
v®ue
) const;

48 
´iv©e
:

49 
ä›nd
 
CodeLessThª
;

51 
	sCodeInfo


53 
	`CodeInfo
(
code_t
 
code
=0, 
Ën
=0, 
v®ue_t
 
v®ue
=0è: 
	`code
(code), 
	`Ën
Ö’), 
	`v®ue
(value) {}

54 
šlše
 
boŞ
 
İ”©Ü
<(cÚ¡ 
CodeInfo
 &
rhs
ècÚ¡ { 
code
 <„hs.code;}

55 
code_t
 
code
;

56 
Ën
;

57 
v®ue_t
 
v®ue
;

58 
	}
};

60 
	sLookupEÁry


62 
	gty³
;

65 
v®ue_t
 
	gv®ue
;

66 cÚ¡ 
CodeInfo
 *
	gbegš
;

70 
	gËn
;

71 cÚ¡ 
CodeInfo
 *
	g’d
;

75 
code_t
 
NÜm®izeCode
(code_ˆ
code
, 
codeB™s
);

76 
	$FlCacheEÁry
(
LookupEÁry
 &
’Œy
, 
code_t
 
nÜm®izedCode
) const;

78 
m_maxCodeB™s
, 
m_ÿcheB™s
, 
m_ÿcheMask
, 
m_nÜm®izedCacheMask
;

79 
¡d
::
veùÜ
<
CodeInfo
, 
AÎoÿtÜW™hCËªup
<CodeInfo> > 
m_codeToV®ue
;

80 
mubË
 
¡d
::
veùÜ
<
LookupEÁry
, 
AÎoÿtÜW™hCËªup
<LookupEÁry> > 
m_ÿche
;

81 
	}
};

85 
şass
 
	gInæ©Ü
 : 
public
 
AutoSigÇlšg
<
F‹r
>

87 
public
:

88 şas 
	cE¼
 : 
public
 
Exû±iÚ


90 
public
:

91 
E¼
(
E¼ÜTy³
 
e
, cÚ¡ 
¡d
::
¡ršg
 &
s
)

92 : 
Exû±iÚ
(
e
, 
s
) {}

94 şas 
	cUÃx³ùedEndE¼
 : 
public
 
E¼
 {public: 
UÃx³ùedEndE¼
(è: E¼(
INVALID_DATA_FORMAT
, "Inflator: unexpectedƒnd of compressed block") {}};

95 şas 
	cBadBlockE¼
 : 
public
 
E¼
 {public: 
BadBlockE¼
(è: E¼(
INVALID_DATA_FORMAT
, "Inflator:ƒrror in compressed block") {}};

100 
Inæ©Ü
(
Bufã»dT¿nsfÜm©iÚ
 *
©chm’t
 = 
NULL
, 
boŞ
 
»³©
 = 
çl£
, 
autoSigÇlPrİag©iÚ
 = -1);

102 
IsŞ©edIn™Ÿlize
(cÚ¡ 
NameV®uePaœs
 &
·¿m‘”s
);

103 
size_t
 
Put2
(cÚ¡ 
by‹
 *
šSŒšg
, size_ˆ
Ëngth
, 
mes§geEnd
, 
boŞ
 
blockšg
);

104 
boŞ
 
IsŞ©edFlush
(boŞ 
h¬dFlush
, boŞ 
blockšg
);

106 
vœtu®
 
	$G‘Log2WšdowSize
(ècÚ¡ { 15;
	}
}

108 
	g´Ùeùed
:

109 
By‹Queue
 
m_šQueue
;

111 
	g´iv©e
:

112 
vœtu®
 
	$MaxP»¡»amH—d”Size
(ècÚ¡ { 0;
	}
}

113 
vœtu®
 
	$ProûssP»¡»amH—d”
(è{
	}
}

114 
vœtu®
 
	$ProûssDecom´es£dD©a
(cÚ¡ 
by‹
 *
¡ršg
, 
size_t
 
Ëngth
)

115 {
	`A‰achedT¿nsfÜm©iÚ
()->
	`Put
(
¡ršg
, 
Ëngth
);
	}
}

116 
vœtu®
 
	$MaxPo¡¡»amTaSize
(ècÚ¡ { 0;
	}
}

117 
vœtu®
 
	$ProûssPo¡¡»amTa
(è{
	}
}

119 
ProûssIÅut
(
boŞ
 
æush
);

120 
DecodeH—d”
();

121 
boŞ
 
DecodeBody
();

122 
FlushOuut
();

123 
OuutBy‹
(
by‹
 
b
);

124 
OuutSŒšg
(cÚ¡ 
by‹
 *
¡ršg
, 
size_t
 
Ëngth
);

125 
OuutPa¡
(
Ëngth
, 
di¡ªû
);

127 cÚ¡ 
HuffmªDecod”
 *
FixedL™”®Decod”
();

128 cÚ¡ 
HuffmªDecod”
 *
FixedDi¡ªûDecod”
();

130 cÚ¡ 
	gHuffmªDecod”
& 
	$G‘L™”®Decod”
() const;

131 cÚ¡ 
HuffmªDecod”
& 
	$G‘Di¡ªûDecod”
() const;

133 
	eS‹
 {
PRE_STREAM
, 
WAIT_HEADER
, 
DECODING_BODY
, 
POST_STREAM
, 
AFTER_END
};

134 
S‹
 
	gm_¡©e
;

135 
boŞ
 
	gm_»³©
, 
	gm_eof
, 
	gm_w¿µedAround
;

136 
by‹
 
	gm_blockTy³
;

137 
wÜd16
 
	gm_¡ÜedL’
;

138 
	eNextDecode
 {
	gLITERAL
, 
	gLENGTH_BITS
, 
	gDISTANCE
, 
	gDISTANCE_BITS
};

139 
NextDecode
 
	gm_ÃxtDecode
;

140 
	gm_l™”®
, 
	gm_di¡ªû
;

141 
HuffmªDecod”
 
	gm_dyÇmicL™”®Decod”
, 
	gm_dyÇmicDi¡ªûDecod”
;

142 
LowFœ¡B™R—d”
 
	gm_»ad”
;

143 
SecBy‹Block
 
	gm_wšdow
;

144 
size_t
 
	gm_cu¼’t
, 
	gm_Ï¡Flush
;

147 
	gNAMESPACE_END


	@zlib.cpp

8 
	~"pch.h
"

9 
	~"zlib.h
"

10 
	~"zdeæ©e.h
"

11 
	~"zšæ©e.h
"

13 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

15 cÚ¡ 
by‹
 
DEFLATE_METHOD
 = 8;

16 cÚ¡ 
by‹
 
FDICT_FLAG
 = 1 << 5;

20 
ZlibCom´essÜ
::
	$Wr™eP»¡»amH—d”
()

22 
m_adËr32
.
	`Re¡¬t
();

23 
by‹
 
cmf
 = 
DEFLATE_METHOD
 | ((
	`G‘Log2WšdowSize
()-8) << 4);

24 
by‹
 
æags
 = 
	`G‘Com´essiÚLev–
() << 6;

25 
	`A‰achedT¿nsfÜm©iÚ
()->
	`PutWÜd16
(
	`RoundUpToMuÉËOf
(
cmf
*256+
æags
, 31));

26 
	}
}

28 
	gZlibCom´essÜ
::
	$ProûssUncom´es£dD©a
(cÚ¡ 
by‹
 *
šSŒšg
, 
size_t
 
Ëngth
)

30 
m_adËr32
.
	`Upd©e
(
šSŒšg
, 
Ëngth
);

31 
	}
}

33 
	gZlibCom´essÜ
::
	$Wr™ePo¡¡»amTa
()

35 
FixedSizeSecBlock
<
by‹
, 4> 
adËr32
;

36 
m_adËr32
.
	`Fš®
(
adËr32
);

37 
	`A‰achedT¿nsfÜm©iÚ
()->
	`Put
(
adËr32
, 4);

38 
	}
}

40 
	gZlibCom´essÜ
::
	$G‘Com´essiÚLev–
() const

42 cÚ¡ 
deæ©eToCom´essiÚLev–
[] = {0, 1, 1, 1, 2, 2, 2, 2, 2, 3};

43  
deæ©eToCom´essiÚLev–
[
	`G‘Deæ©eLev–
()];

44 
	}
}

48 
	gZlibDecom´essÜ
::
	$ZlibDecom´essÜ
(
Bufã»dT¿nsfÜm©iÚ
 *
©chm’t
, 
boŞ
 
»³©
, 
´İag©iÚ
)

49 : 
	$Inæ©Ü
(
©chm’t
, 
»³©
, 
´İag©iÚ
)

51 
	}
}

53 
	gZlibDecom´essÜ
::
	$ProûssP»¡»amH—d”
()

55 
m_adËr32
.
	`Re¡¬t
();

57 
by‹
 
cmf
;

58 
by‹
 
æags
;

60 ià(!
m_šQueue
.
	`G‘
(
cmf
è|| !m_šQueue.G‘(
æags
))

61 
throw
 
	`H—d”E¼
();

63 ià((
cmf
*256+
æags
) % 31 != 0)

64 
throw
 
	`H—d”E¼
();

66 ià((
cmf
 & 0xfè!ğ
DEFLATE_METHOD
)

67 
throw
 
	`UnsuµÜ‹dAlgÜ™hm
();

69 ià(
æags
 & 
FDICT_FLAG
)

70 
throw
 
	`UnsuµÜ‹dP»£tDiùiÚ¬y
();

72 
m_log2WšdowSize
 = 8 + (
cmf
 >> 4);

73 
	}
}

75 
	gZlibDecom´essÜ
::
	$ProûssDecom´es£dD©a
(cÚ¡ 
by‹
 *
šSŒšg
, 
size_t
 
Ëngth
)

77 
	`A‰achedT¿nsfÜm©iÚ
()->
	`Put
(
šSŒšg
, 
Ëngth
);

78 
m_adËr32
.
	`Upd©e
(
šSŒšg
, 
Ëngth
);

79 
	}
}

81 
	gZlibDecom´essÜ
::
	$ProûssPo¡¡»amTa
()

83 
FixedSizeSecBlock
<
by‹
, 4> 
adËr32
;

84 ià(
m_šQueue
.
	`G‘
(
adËr32
, 4) != 4)

85 
throw
 
	`AdËr32E¼
();

86 ià(!
m_adËr32
.
	`V”ify
(
adËr32
))

87 
throw
 
	`AdËr32E¼
();

88 
	}
}

90 
	gNAMESPACE_END


	@zlib.h

1 #iâdeà
CRYPTOPP_ZLIB_H


2 
	#CRYPTOPP_ZLIB_H


	)

4 
	~"adËr32.h
"

5 
	~"zdeæ©e.h
"

6 
	~"zšæ©e.h
"

8 
	$NAMESPACE_BEGIN
(
Cry±oPP
)

11 şas 
	cZlibCom´essÜ
 : 
public
 
Deæ©Ü


13 
public
:

14 
	$ZlibCom´essÜ
(
Bufã»dT¿nsfÜm©iÚ
 *
©chm’t
=
NULL
, 
deæ©eLev–
=
DEFAULT_DEFLATE_LEVEL
, 
log2WšdowSize
=
DEFAULT_LOG2_WINDOW_SIZE
, 
boŞ
 
d‘eùUncom´essibË
=
Œue
)

15 : 
	$Deæ©Ü
(
©chm’t
, 
deæ©eLev–
, 
log2WšdowSize
, 
d‘eùUncom´essibË
) {}

16 
	$ZlibCom´essÜ
(cÚ¡ 
NameV®uePaœs
 &
·¿m‘”s
, 
Bufã»dT¿nsfÜm©iÚ
 *
©chm’t
=
NULL
)

17 : 
	$Deæ©Ü
(
·¿m‘”s
, 
©chm’t
è{
	}
}

19 
	$G‘Com´essiÚLev–
() const;

21 
´Ùeùed
:

22 
	`Wr™eP»¡»amH—d”
();

23 
	`ProûssUncom´es£dD©a
(cÚ¡ 
by‹
 *
¡ršg
, 
size_t
 
Ëngth
);

24 
	`Wr™ePo¡¡»amTa
();

26 
AdËr32
 
m_adËr32
;

27 
	}
};

30 şas 
	cZlibDecom´essÜ
 : 
public
 
Inæ©Ü


32 
public
:

33 
Inæ©Ü
::
	tE¼
 Err;

34 şas 
	cH—d”E¼
 : 
public
 
E¼
 {public: 
H—d”E¼
(è: E¼(
INVALID_DATA_FORMAT
, "ZlibDecompressor: header decodingƒrror") {}};

35 şas 
	cAdËr32E¼
 : 
public
 
E¼
 {public: 
AdËr32E¼
(è: E¼(
DATA_INTEGRITY_CHECK_FAILED
, "ZlibDecompressor: ADLER32 checkƒrror") {}};

36 şas 
	cUnsuµÜ‹dAlgÜ™hm
 : 
public
 
E¼
 {public: 
UnsuµÜ‹dAlgÜ™hm
(è: E¼(
INVALID_DATA_FORMAT
, "ZlibDecompressor: unsupported‡lgorithm") {}};

37 şas 
	cUnsuµÜ‹dP»£tDiùiÚ¬y
 : 
public
 
E¼
 {public: 
UnsuµÜ‹dP»£tDiùiÚ¬y
(è: E¼(
INVALID_DATA_FORMAT
, "ZlibDecompressor: unsupported…reset dictionary") {}};

42 
ZlibDecom´essÜ
(
Bufã»dT¿nsfÜm©iÚ
 *
©chm’t
 = 
NULL
, 
boŞ
 
»³©
 = 
çl£
, 
autoSigÇlPrİag©iÚ
 = -1);

43 
	$G‘Log2WšdowSize
(ècÚ¡ { 
m_log2WšdowSize
;
	}
}

45 
	g´iv©e
:

46 
	$MaxP»¡»amH—d”Size
(ècÚ¡ { 2;
	}
}

47 
ProûssP»¡»amH—d”
();

48 
ProûssDecom´es£dD©a
(cÚ¡ 
by‹
 *
¡ršg
, 
size_t
 
Ëngth
);

49 
	$MaxPo¡¡»amTaSize
(ècÚ¡ { 4;
	}
}

50 
ProûssPo¡¡»amTa
();

52 
	gm_log2WšdowSize
;

53 
AdËr32
 
	gm_adËr32
;

56 
	gNAMESPACE_END


	@/usr/include/alloca.h

18 #iâdef 
_ALLOCA_H


19 
	#_ALLOCA_H
 1

	)

21 
	~<ã©u»s.h
>

23 
	#__Ãed_size_t


	)

24 
	~<¡ddef.h
>

26 
	g__BEGIN_DECLS


29 #undeà
®loÿ


32 *
	$®loÿ
 (
size_t
 
__size
è
__THROW
;

34 #ifdef 
__GNUC__


35 
	#®loÿ
(
size
è
	`__butš_®loÿ
 (size)

	)

38 
__END_DECLS


	@/usr/include/arpa/inet.h

18 #iâdeà
_ARPA_INET_H


19 
	#_ARPA_INET_H
 1

	)

21 
	~<ã©u»s.h
>

22 
	~<Ãtš‘/š.h
>

25 #iâdeà
__sockËn_t_defšed


26 
__sockËn_t
 
	tsockËn_t
;

27 
	#__sockËn_t_defšed


	)

30 
__BEGIN_DECLS


34 
š_addr_t
 
	$š‘_addr
 (cÚ¡ *
__ı
è
__THROW
;

37 
š_addr_t
 
	$š‘_Êaof
 (
š_addr
 
__š
è
__THROW
;

41 
š_addr
 
	$š‘_mak—ddr
 (
š_addr_t
 
__Ãt
, in_addr_ˆ
__ho¡
)

42 
__THROW
;

45 
š_addr_t
 
	$š‘_Ãtof
 (
š_addr
 
__š
è
__THROW
;

49 
š_addr_t
 
	$š‘_ÃtwÜk
 (cÚ¡ *
__ı
è
__THROW
;

53 *
	$š‘_Áß
 (
š_addr
 
__š
è
__THROW
;

58 
	$š‘_±Ú
 (
__af
, cÚ¡ *
__»¡riù
 
__ı
,

59 *
__»¡riù
 
__buf
è
__THROW
;

64 cÚ¡ *
	$š‘_Áİ
 (
__af
, cÚ¡ *
__»¡riù
 
__ı
,

65 *
__»¡riù
 
__buf
, 
sockËn_t
 
__Ën
)

66 
__THROW
;

70 #ifdeà
__USE_MISC


73 
	$š‘_©Ú
 (cÚ¡ *
__ı
, 
š_addr
 *
__šp
è
__THROW
;

77 *
	$š‘_Ã
 (
š_addr_t
 
__Ãt
, *
__buf
, 
size_t
 
__Ën
è
__THROW
;

82 *
	$š‘_Ãt_Áİ
 (
__af
, cÚ¡ *
__ı
, 
__b™s
,

83 *
__buf
, 
size_t
 
__Ën
è
__THROW
;

88 
	$š‘_Ãt_±Ú
 (
__af
, cÚ¡ *
__ı
,

89 *
__buf
, 
size_t
 
__Ën
è
__THROW
;

94 
	$š‘_n§p_addr
 (cÚ¡ *
__ı
,

95 *
__buf
, 
__Ën
è
__THROW
;

99 *
	$š‘_n§p_Áß
 (
__Ën
, cÚ¡ *
__ı
,

100 *
__buf
è
__THROW
;

103 
__END_DECLS


	@/usr/include/assert.h

22 #ifdef 
_ASSERT_H


24 #undeà
_ASSERT_H


25 #undeà
as£¹


26 #undeà
__ASSERT_VOID_CAST


28 #ifdef 
__USE_GNU


29 #undeà
as£¹_³¼Ü


34 
	#_ASSERT_H
 1

	)

35 
	~<ã©u»s.h
>

37 #ià
defšed
 
__ılu¥lus
 && 
__GNUC_PREREQ
 (2,95)

38 
	#__ASSERT_VOID_CAST
 
¡©ic_ÿ¡
<>

	)

40 
	#__ASSERT_VOID_CAST
 ()

	)

48 #ifdef 
NDEBUG


50 
	#as£¹
(
ex´
è(
	`__ASSERT_VOID_CAST
 (0))

	)

58 #ifdef 
__USE_GNU


59 
	#as£¹_³¼Ü
(
”ºum
è(
	`__ASSERT_VOID_CAST
 (0))

	)

64 #iâdeà
_ASSERT_H_DECLS


65 
	#_ASSERT_H_DECLS


	)

66 
__BEGIN_DECLS


69 
	$__as£¹_ç
 (cÚ¡ *
__as£¹iÚ
, cÚ¡ *
__fe
,

70 
__lše
, cÚ¡ *
__funùiÚ
)

71 
__THROW
 
	`__©Œibu‹__
 ((
__nÜ‘uº__
));

74 
	$__as£¹_³¼Ü_ç
 (
__”ºum
, cÚ¡ *
__fe
,

75 
__lše
, cÚ¡ *
__funùiÚ
)

76 
__THROW
 
	`__©Œibu‹__
 ((
__nÜ‘uº__
));

81 
	$__as£¹
 (cÚ¡ *
__as£¹iÚ
, cÚ¡ *
__fe
, 
__lše
)

82 
__THROW
 
	`__©Œibu‹__
 ((
__nÜ‘uº__
));

85 
__END_DECLS


88 
	#as£¹
(
ex´
) \

89 ((
ex´
) \

90 ? 
	`__ASSERT_VOID_CAST
 (0) \

91 : 
	`__as£¹_ç
 (
	`__STRING
(
ex´
), 
__FILE__
, 
__LINE__
, 
__ASSERT_FUNCTION
))

	)

93 #ifdef 
__USE_GNU


94 
	#as£¹_³¼Ü
(
”ºum
) \

95 (!(
”ºum
) \

96 ? 
	`__ASSERT_VOID_CAST
 (0) \

97 : 
	`__as£¹_³¼Ü_ç
 ((
”ºum
), 
__FILE__
, 
__LINE__
, 
__ASSERT_FUNCTION
))

	)

105 #ià
defšed
 
__ılu¥lus
 ? 
	`__GNUC_PREREQ
 (2, 6) : __GNUC_PREREQ (2, 4)

106 
	#__ASSERT_FUNCTION
 
__PRETTY_FUNCTION__


	)

108 #ià
defšed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199901L

109 
	#__ASSERT_FUNCTION
 
__func__


	)

111 
	#__ASSERT_FUNCTION
 ((cÚ¡ *è0)

	)

118 #ià
defšed
 
__USE_ISOC11
 && !defšed 
__ılu¥lus


120 #undeà
¡©ic_as£¹


121 
	#¡©ic_as£¹
 
_Stic_as£¹


	)

	@/usr/include/byteswap.h

18 #iâdeà
_BYTESWAP_H


19 
	#_BYTESWAP_H
 1

	)

21 
	~<ã©u»s.h
>

24 
	~<b™s/by‹sw­.h
>

31 
	#bsw­_16
(
x
è
	`__bsw­_16
 (x)

	)

34 
	#bsw­_32
(
x
è
	`__bsw­_32
 (x)

	)

37 
	#bsw­_64
(
x
è
	`__bsw­_64
 (x)

	)

	@/usr/include/ctype.h

22 #iâdef 
_CTYPE_H


23 
	#_CTYPE_H
 1

	)

25 
	~<ã©u»s.h
>

26 
	~<b™s/ty³s.h
>

28 
	g__BEGIN_DECLS


30 #iâdeà
_ISb™


39 
	~<’dŸn.h
>

40 #ià
__BYTE_ORDER
 =ğ
__BIG_ENDIAN


41 
	#_ISb™
(
b™
è(1 << (b™))

	)

43 
	#_ISb™
(
b™
è((b™è< 8 ? ((1 << (b™)è<< 8è: ((1 << (b™)è>> 8))

	)

48 
	m_ISuµ”
 = 
_ISb™
 (0),

49 
	m_ISlow”
 = 
_ISb™
 (1),

50 
	m_IS®pha
 = 
_ISb™
 (2),

51 
	m_ISdig™
 = 
_ISb™
 (3),

52 
	m_ISxdig™
 = 
_ISb™
 (4),

53 
	m_IS¥aû
 = 
_ISb™
 (5),

54 
	m_IS´št
 = 
_ISb™
 (6),

55 
	m_ISg¿ph
 = 
_ISb™
 (7),

56 
	m_ISbÏnk
 = 
_ISb™
 (8),

57 
	m_ISúŒl
 = 
_ISb™
 (9),

58 
	m_ISpunù
 = 
_ISb™
 (10),

59 
	m_IS®num
 = 
_ISb™
 (11)

79 cÚ¡ **
	$__ùy³_b_loc
 ()

80 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

81 cÚ¡ 
__št32_t
 **
	$__ùy³_tŞow”_loc
 ()

82 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

83 cÚ¡ 
__št32_t
 **
	$__ùy³_touµ”_loc
 ()

84 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

87 #iâdeà
__ılu¥lus


88 
	#__isùy³
(
c
, 
ty³
) \

89 ((*
	`__ùy³_b_loc
 ())[(è(
c
)] & (è
ty³
)

	)

90 #–ià
defšed
 
__USE_EXTERN_INLINES


91 
	#__isùy³_f
(
ty³
) \

92 
__ex‹º_šlše
 \

93 
is
##
	`ty³
 (
__c
è
__THROW
 \

95  (*
	`__ùy³_b_loc
 ())[(è(
__c
)] & (è
_IS
##
ty³
; \

96 
	}

	)
}

99 
	#__i§scii
(
c
è(((cè& ~0x7fè=ğ0è

	)

100 
	#__tßscii
(
c
è((cè& 0x7fè

	)

102 
	#__exùy³
(
Çme
è
	`Çme
 (è
__THROW


	)

104 
__BEGIN_NAMESPACE_STD


110 
__exùy³
 (
i§Êum
);

111 
__exùy³
 (
i§Íha
);

112 
__exùy³
 (
isúŒl
);

113 
__exùy³
 (
isdig™
);

114 
__exùy³
 (
i¦ow”
);

115 
__exùy³
 (
isg¿ph
);

116 
__exùy³
 (
i¥ršt
);

117 
__exùy³
 (
i¥unù
);

118 
__exùy³
 (
is¥aû
);

119 
__exùy³
 (
isuµ”
);

120 
__exùy³
 (
isxdig™
);

124 
	$tŞow”
 (
__c
è
__THROW
;

127 
	$touµ”
 (
__c
è
__THROW
;

129 
__END_NAMESPACE_STD


133 #ifdef 
__USE_ISOC99


134 
__BEGIN_NAMESPACE_C99


136 
	`__exùy³
 (
isbÏnk
);

138 
__END_NAMESPACE_C99


141 #ifdeà
__USE_GNU


143 
	$isùy³
 (
__c
, 
__mask
è
__THROW
;

146 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_MISC
 || defšed 
__USE_XOPEN


150 
	$i§scii
 (
__c
è
__THROW
;

154 
	$tßscii
 (
__c
è
__THROW
;

158 
	`__exùy³
 (
_touµ”
);

159 
	`__exùy³
 (
_tŞow”
);

163 
	#__tobody
(
c
, 
f
, 
a
, 
¬gs
) \

164 (
__ex‹nsiÚ__
 \

165 ({ 
__»s
; \

166 ià( (
c
) > 1) \

168 ià(
	`__butš_cÚ¡ªt_p
 (
c
)) \

170 
__c
 = (
c
); \

171 
__»s
 = 
__c
 < -128 || __ø> 255 ? __ø: (
a
)[__c]; \

174 
__»s
 = 
f
 
¬gs
; \

177 
__»s
 = (
a
)[(è(
c
)]; \

178 
__»s
; 
	}
}))

	)

180 #ià!
defšed
 
__NO_CTYPE


181 #ifdeà
__isùy³_f


182 
	$__isùy³_f
 (
®num
)

183 
	$__isùy³_f
 (
®pha
)

184 
	$__isùy³_f
 (
úŒl
)

185 
	$__isùy³_f
 (
dig™
)

186 
	$__isùy³_f
 (
low”
)

187 
	$__isùy³_f
 (
g¿ph
)

188 
	$__isùy³_f
 (
´št
)

189 
	$__isùy³_f
 (
punù
)

190 
	$__isùy³_f
 (
¥aû
)

191 
	$__isùy³_f
 (
uµ”
)

192 
	$__isùy³_f
 (
xdig™
)

193 #ifdeà
__USE_ISOC99


194 
	$__isùy³_f
 (
bÏnk
)

196 #–ià
defšed
 
__isùy³


197 
	#i§Êum
(
c
è
	`__isùy³
((c), 
_IS®num
)

	)

198 
	#i§Íha
(
c
è
	`__isùy³
((c), 
_IS®pha
)

	)

199 
	#isúŒl
(
c
è
	`__isùy³
((c), 
_ISúŒl
)

	)

200 
	#isdig™
(
c
è
	`__isùy³
((c), 
_ISdig™
)

	)

201 
	#i¦ow”
(
c
è
	`__isùy³
((c), 
_ISlow”
)

	)

202 
	#isg¿ph
(
c
è
	`__isùy³
((c), 
_ISg¿ph
)

	)

203 
	#i¥ršt
(
c
è
	`__isùy³
((c), 
_IS´št
)

	)

204 
	#i¥unù
(
c
è
	`__isùy³
((c), 
_ISpunù
)

	)

205 
	#is¥aû
(
c
è
	`__isùy³
((c), 
_IS¥aû
)

	)

206 
	#isuµ”
(
c
è
	`__isùy³
((c), 
_ISuµ”
)

	)

207 
	#isxdig™
(
c
è
	`__isùy³
((c), 
_ISxdig™
)

	)

208 #ifdeà
__USE_ISOC99


209 
	#isbÏnk
(
c
è
	`__isùy³
((c), 
_ISbÏnk
)

	)

213 #ifdeà
__USE_EXTERN_INLINES


214 
__ex‹º_šlše
 

215 
	`__NTH
 (
	$tŞow”
 (
__c
))

217  
__c
 >ğ-128 && __ø< 256 ? (*
	`__ùy³_tŞow”_loc
 ())[__c] : __c;

218 
	}
}

220 
__ex‹º_šlše
 

221 
__NTH
 (
	$touµ”
 (
__c
))

223  
__c
 >ğ-128 && __ø< 256 ? (*
	`__ùy³_touµ”_loc
 ())[__c] : __c;

224 
	}
}

227 #ià
__GNUC__
 >ğ2 && 
defšed
 
__OPTIMIZE__
 && !defšed 
__ılu¥lus


228 
	#tŞow”
(
c
è
	`__tobody
 (c, 
tŞow”
, *
	`__ùy³_tŞow”_loc
 (), (c))

	)

229 
	#touµ”
(
c
è
	`__tobody
 (c, 
touµ”
, *
	`__ùy³_touµ”_loc
 (), (c))

	)

232 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_MISC
 || defšed 
__USE_XOPEN


233 
	#i§scii
(
c
è
	`__i§scii
 (c)

	)

234 
	#tßscii
(
c
è
	`__tßscii
 (c)

	)

236 
	#_tŞow”
(
c
è((è(*
	`__ùy³_tŞow”_loc
 ())[(è(c)])

	)

237 
	#_touµ”
(
c
è((è(*
	`__ùy³_touµ”_loc
 ())[(è(c)])

	)

243 #ifdeà
__USE_XOPEN2K8


257 
	~<xloÿË.h
>

261 
	#__isùy³_l
(
c
, 
ty³
, 
loÿË
) \

262 ((
loÿË
)->
__ùy³_b
[(è(
c
)] & (è
ty³
)

	)

264 
	#__exùy³_l
(
Çme
) \

265 
	`Çme
 (, 
__loÿË_t
è
__THROW


	)

271 
__exùy³_l
 (
i§Êum_l
);

272 
__exùy³_l
 (
i§Íha_l
);

273 
__exùy³_l
 (
isúŒl_l
);

274 
__exùy³_l
 (
isdig™_l
);

275 
__exùy³_l
 (
i¦ow”_l
);

276 
__exùy³_l
 (
isg¿ph_l
);

277 
__exùy³_l
 (
i¥ršt_l
);

278 
__exùy³_l
 (
i¥unù_l
);

279 
__exùy³_l
 (
is¥aû_l
);

280 
__exùy³_l
 (
isuµ”_l
);

281 
__exùy³_l
 (
isxdig™_l
);

283 
__exùy³_l
 (
isbÏnk_l
);

287 
	$__tŞow”_l
 (
__c
, 
__loÿË_t
 
__l
è
__THROW
;

288 
	$tŞow”_l
 (
__c
, 
__loÿË_t
 
__l
è
__THROW
;

291 
	$__touµ”_l
 (
__c
, 
__loÿË_t
 
__l
è
__THROW
;

292 
	$touµ”_l
 (
__c
, 
__loÿË_t
 
__l
è
__THROW
;

294 #ià
__GNUC__
 >ğ2 && 
defšed
 
__OPTIMIZE__
 && !defšed 
__ılu¥lus


295 
	#__tŞow”_l
(
c
, 
loÿË
) \

296 
	`__tobody
 (
c
, 
__tŞow”_l
, (
loÿË
)->
__ùy³_tŞow”
, (c,†oÿË))

	)

297 
	#__touµ”_l
(
c
, 
loÿË
) \

298 
	`__tobody
 (
c
, 
__touµ”_l
, (
loÿË
)->
__ùy³_touµ”
, (c,†oÿË))

	)

299 
	#tŞow”_l
(
c
, 
loÿË
è
	`__tŞow”_l
 ((c), (loÿË))

	)

300 
	#touµ”_l
(
c
, 
loÿË
è
	`__touµ”_l
 ((c), (loÿË))

	)

304 #iâdeà
__NO_CTYPE


305 
	#__i§Êum_l
(
c
,
l
è
	`__isùy³_l
((c), 
_IS®num
, (l))

	)

306 
	#__i§Íha_l
(
c
,
l
è
	`__isùy³_l
((c), 
_IS®pha
, (l))

	)

307 
	#__isúŒl_l
(
c
,
l
è
	`__isùy³_l
((c), 
_ISúŒl
, (l))

	)

308 
	#__isdig™_l
(
c
,
l
è
	`__isùy³_l
((c), 
_ISdig™
, (l))

	)

309 
	#__i¦ow”_l
(
c
,
l
è
	`__isùy³_l
((c), 
_ISlow”
, (l))

	)

310 
	#__isg¿ph_l
(
c
,
l
è
	`__isùy³_l
((c), 
_ISg¿ph
, (l))

	)

311 
	#__i¥ršt_l
(
c
,
l
è
	`__isùy³_l
((c), 
_IS´št
, (l))

	)

312 
	#__i¥unù_l
(
c
,
l
è
	`__isùy³_l
((c), 
_ISpunù
, (l))

	)

313 
	#__is¥aû_l
(
c
,
l
è
	`__isùy³_l
((c), 
_IS¥aû
, (l))

	)

314 
	#__isuµ”_l
(
c
,
l
è
	`__isùy³_l
((c), 
_ISuµ”
, (l))

	)

315 
	#__isxdig™_l
(
c
,
l
è
	`__isùy³_l
((c), 
_ISxdig™
, (l))

	)

317 
	#__isbÏnk_l
(
c
,
l
è
	`__isùy³_l
((c), 
_ISbÏnk
, (l))

	)

319 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_MISC


320 
	#__i§scii_l
(
c
,
l
è(Ö), 
	`__i§scii
 (c))

	)

321 
	#__tßscii_l
(
c
,
l
è(Ö), 
	`__tßscii
 (c))

	)

324 
	#i§Êum_l
(
c
,
l
è
	`__i§Êum_l
 ((c), (l))

	)

325 
	#i§Íha_l
(
c
,
l
è
	`__i§Íha_l
 ((c), (l))

	)

326 
	#isúŒl_l
(
c
,
l
è
	`__isúŒl_l
 ((c), (l))

	)

327 
	#isdig™_l
(
c
,
l
è
	`__isdig™_l
 ((c), (l))

	)

328 
	#i¦ow”_l
(
c
,
l
è
	`__i¦ow”_l
 ((c), (l))

	)

329 
	#isg¿ph_l
(
c
,
l
è
	`__isg¿ph_l
 ((c), (l))

	)

330 
	#i¥ršt_l
(
c
,
l
è
	`__i¥ršt_l
 ((c), (l))

	)

331 
	#i¥unù_l
(
c
,
l
è
	`__i¥unù_l
 ((c), (l))

	)

332 
	#is¥aû_l
(
c
,
l
è
	`__is¥aû_l
 ((c), (l))

	)

333 
	#isuµ”_l
(
c
,
l
è
	`__isuµ”_l
 ((c), (l))

	)

334 
	#isxdig™_l
(
c
,
l
è
	`__isxdig™_l
 ((c), (l))

	)

336 
	#isbÏnk_l
(
c
,
l
è
	`__isbÏnk_l
 ((c), (l))

	)

338 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_MISC


339 
	#i§scii_l
(
c
,
l
è
	`__i§scii_l
 ((c), (l))

	)

340 
	#tßscii_l
(
c
,
l
è
	`__tßscii_l
 ((c), (l))

	)

347 
__END_DECLS


	@/usr/include/errno.h

22 #iâdef 
_ERRNO_H


26 #iâdef 
__Ãed_Em©h


27 
	#_ERRNO_H
 1

	)

28 
	~<ã©u»s.h
>

31 
	g__BEGIN_DECLS


35 
	~<b™s/”ºo.h
>

36 #undeà
__Ãed_Em©h


38 #ifdef 
_ERRNO_H


45 #iâdef 
”ºo


46 
”ºo
;

49 #ifdeà
__USE_GNU


54 *
´og¿m_švoÿtiÚ_Çme
, *
´og¿m_švoÿtiÚ_shÜt_Çme
;

58 
	g__END_DECLS


66 #ià
defšed
 
__USE_GNU
 || defšed 
__Ãed_”rÜ_t


67 #iâdeà
__”rÜ_t_defšed


68 
	t”rÜ_t
;

69 
	#__”rÜ_t_defšed
 1

	)

71 #undeà
__Ãed_”rÜ_t


	@/usr/include/fcntl.h

22 #iâdef 
_FCNTL_H


23 
	#_FCNTL_H
 1

	)

25 
	~<ã©u»s.h
>

28 
	g__BEGIN_DECLS


31 
	~<b™s/ty³s.h
>

35 
	~<b™s/fú.h
>

40 #iâdeà
__mode_t_defšed


41 
__mode_t
 
	tmode_t
;

42 
	#__mode_t_defšed


	)

45 #iâdeà
__off_t_defšed


46 #iâdeà
__USE_FILE_OFFSET64


47 
__off_t
 
	toff_t
;

49 
__off64_t
 
	toff_t
;

51 
	#__off_t_defšed


	)

54 #ià
defšed
 
__USE_LARGEFILE64
 && !defšed 
__off64_t_defšed


55 
__off64_t
 
	toff64_t
;

56 
	#__off64_t_defšed


	)

59 #iâdeà
__pid_t_defšed


60 
__pid_t
 
	tpid_t
;

61 
	#__pid_t_defšed


	)

65 #ià
defšed
 
__USE_XOPEN
 || defšed 
__USE_XOPEN2K8


66 
	#__Ãed_time¥ec


	)

67 
	~<time.h
>

68 
	~<b™s/¡©.h
>

70 
	#S_IFMT
 
__S_IFMT


	)

71 
	#S_IFDIR
 
__S_IFDIR


	)

72 
	#S_IFCHR
 
__S_IFCHR


	)

73 
	#S_IFBLK
 
__S_IFBLK


	)

74 
	#S_IFREG
 
__S_IFREG


	)

75 #ifdeà
__S_IFIFO


76 
	#S_IFIFO
 
__S_IFIFO


	)

78 #ifdeà
__S_IFLNK


79 
	#S_IFLNK
 
__S_IFLNK


	)

81 #ià(
defšed
 
__USE_UNIX98
 || defšed 
__USE_XOPEN2K8
è&& defšed 
__S_IFSOCK


82 
	#S_IFSOCK
 
__S_IFSOCK


	)

87 
	#S_ISUID
 
__S_ISUID


	)

88 
	#S_ISGID
 
__S_ISGID


	)

90 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_MISC
 || defšed 
__USE_XOPEN


92 
	#S_ISVTX
 
__S_ISVTX


	)

95 
	#S_IRUSR
 
__S_IREAD


	)

96 
	#S_IWUSR
 
__S_IWRITE


	)

97 
	#S_IXUSR
 
__S_IEXEC


	)

99 
	#S_IRWXU
 (
__S_IREAD
|
__S_IWRITE
|
__S_IEXEC
)

	)

101 
	#S_IRGRP
 (
S_IRUSR
 >> 3è

	)

102 
	#S_IWGRP
 (
S_IWUSR
 >> 3è

	)

103 
	#S_IXGRP
 (
S_IXUSR
 >> 3è

	)

105 
	#S_IRWXG
 (
S_IRWXU
 >> 3)

	)

107 
	#S_IROTH
 (
S_IRGRP
 >> 3è

	)

108 
	#S_IWOTH
 (
S_IWGRP
 >> 3è

	)

109 
	#S_IXOTH
 (
S_IXGRP
 >> 3è

	)

111 
	#S_IRWXO
 (
S_IRWXG
 >> 3)

	)

114 #ifdef 
__USE_MISC


115 #iâdeà
R_OK


118 
	#R_OK
 4

	)

119 
	#W_OK
 2

	)

120 
	#X_OK
 1

	)

121 
	#F_OK
 0

	)

126 #ià
defšed
 
__USE_XOPEN
 || defšed 
__USE_XOPEN2K8


127 
	#SEEK_SET
 0

	)

128 
	#SEEK_CUR
 1

	)

129 
	#SEEK_END
 2

	)

137 
fú
 (
__fd
, 
__cmd
, ...);

145 #iâdeà
__USE_FILE_OFFSET64


146 
	$İ’
 (cÚ¡ *
__fe
, 
__oæag
, ...è
	`__nÚnuÎ
 ((1));

148 #ifdeà
__REDIRECT


149 
	`__REDIRECT
 (
İ’
, (cÚ¡ *
__fe
, 
__oæag
, ...), 
İ’64
)

150 
	`__nÚnuÎ
 ((1));

152 
	#İ’
 
İ’64


	)

155 #ifdeà
__USE_LARGEFILE64


156 
	$İ’64
 (cÚ¡ *
__fe
, 
__oæag
, ...è
	`__nÚnuÎ
 ((1));

159 #ifdeà
__USE_ATFILE


169 #iâdeà
__USE_FILE_OFFSET64


170 
	$İ’©
 (
__fd
, cÚ¡ *
__fe
, 
__oæag
, ...)

171 
	`__nÚnuÎ
 ((2));

173 #ifdeà
__REDIRECT


174 
	`__REDIRECT
 (
İ’©
, (
__fd
, cÚ¡ *
__fe
, 
__oæag
,

175 ...), 
İ’©64
è
	`__nÚnuÎ
 ((2));

177 
	#İ’©
 
İ’©64


	)

180 #ifdeà
__USE_LARGEFILE64


181 
	$İ’©64
 (
__fd
, cÚ¡ *
__fe
, 
__oæag
, ...)

182 
	`__nÚnuÎ
 ((2));

191 #iâdeà
__USE_FILE_OFFSET64


192 
	$ü—t
 (cÚ¡ *
__fe
, 
mode_t
 
__mode
è
	`__nÚnuÎ
 ((1));

194 #ifdeà
__REDIRECT


195 
	`__REDIRECT
 (
ü—t
, (cÚ¡ *
__fe
, 
mode_t
 
__mode
),

196 
ü—t64
è
	`__nÚnuÎ
 ((1));

198 
	#ü—t
 
ü—t64


	)

201 #ifdeà
__USE_LARGEFILE64


202 
	$ü—t64
 (cÚ¡ *
__fe
, 
mode_t
 
__mode
è
	`__nÚnuÎ
 ((1));

205 #ià!
defšed
 
F_LOCK
 && (defšed 
__USE_MISC
 || (defšed 
__USE_XOPEN_EXTENDED
 \

206 && !
defšed
 
__USE_POSIX
))

215 
	#F_ULOCK
 0

	)

216 
	#F_LOCK
 1

	)

217 
	#F_TLOCK
 2

	)

218 
	#F_TEST
 3

	)

220 #iâdeà
__USE_FILE_OFFSET64


221 
	`lockf
 (
__fd
, 
__cmd
, 
off_t
 
__Ën
);

223 #ifdeà
__REDIRECT


224 
	`__REDIRECT
 (
lockf
, (
__fd
, 
__cmd
, 
__off64_t
 
__Ën
), 
lockf64
);

226 
	#lockf
 
lockf64


	)

229 #ifdeà
__USE_LARGEFILE64


230 
	`lockf64
 (
__fd
, 
__cmd
, 
off64_t
 
__Ën
);

234 #ifdeà
__USE_XOPEN2K


237 #iâdeà
__USE_FILE_OFFSET64


238 
	$posix_çdvi£
 (
__fd
, 
off_t
 
__off£t
, off_ˆ
__Ën
,

239 
__advi£
è
__THROW
;

241 #ifdeà
__REDIRECT_NTH


242 
	`__REDIRECT_NTH
 (
posix_çdvi£
, (
__fd
, 
__off64_t
 
__off£t
,

243 
__off64_t
 
__Ën
, 
__advi£
),

244 
posix_çdvi£64
);

246 
	#posix_çdvi£
 
posix_çdvi£64


	)

249 #ifdeà
__USE_LARGEFILE64


250 
	$posix_çdvi£64
 (
__fd
, 
off64_t
 
__off£t
, off64_ˆ
__Ën
,

251 
__advi£
è
__THROW
;

259 #iâdeà
__USE_FILE_OFFSET64


260 
	`posix_çÎoÿ‹
 (
__fd
, 
off_t
 
__off£t
, off_ˆ
__Ën
);

262 #ifdeà
__REDIRECT


263 
	`__REDIRECT
 (
posix_çÎoÿ‹
, (
__fd
, 
__off64_t
 
__off£t
,

264 
__off64_t
 
__Ën
),

265 
posix_çÎoÿ‹64
);

267 
	#posix_çÎoÿ‹
 
posix_çÎoÿ‹64


	)

270 #ifdeà
__USE_LARGEFILE64


271 
	`posix_çÎoÿ‹64
 (
__fd
, 
off64_t
 
__off£t
, off64_ˆ
__Ën
);

277 #ià
__USE_FORTIFY_LEVEL
 > 0 && 
defšed
 
__fÜtify_funùiÚ
 \

278 && 
defšed
 
__va_¬g_·ck_Ën


279 
	~<b™s/fú2.h
>

282 
__END_DECLS


	@/usr/include/limits.h

22 #iâdeà
_LIBC_LIMITS_H_


23 
	#_LIBC_LIMITS_H_
 1

	)

25 
	~<ã©u»s.h
>

31 
	#MB_LEN_MAX
 16

	)

36 #ià!
defšed
 
__GNUC__
 || __GNUC__ < 2

41 #iâdeà
_LIMITS_H


42 
	#_LIMITS_H
 1

	)

44 
	~<b™s/wÜdsize.h
>

53 
	#CHAR_BIT
 8

	)

56 
	#SCHAR_MIN
 (-128)

	)

57 
	#SCHAR_MAX
 127

	)

60 
	#UCHAR_MAX
 255

	)

63 #ifdeà
__CHAR_UNSIGNED__


64 
	#CHAR_MIN
 0

	)

65 
	#CHAR_MAX
 
UCHAR_MAX


	)

67 
	#CHAR_MIN
 
SCHAR_MIN


	)

68 
	#CHAR_MAX
 
SCHAR_MAX


	)

72 
	#SHRT_MIN
 (-32768)

	)

73 
	#SHRT_MAX
 32767

	)

76 
	#USHRT_MAX
 65535

	)

79 
	#INT_MIN
 (-
INT_MAX
 - 1)

	)

80 
	#INT_MAX
 2147483647

	)

83 
	#UINT_MAX
 4294967295U

	)

86 #ià
__WORDSIZE
 == 64

87 
	#LONG_MAX
 9223372036854775807L

	)

89 
	#LONG_MAX
 2147483647L

	)

91 
	#LONG_MIN
 (-
LONG_MAX
 - 1L)

	)

94 #ià
__WORDSIZE
 == 64

95 
	#ULONG_MAX
 18446744073709551615UL

	)

97 
	#ULONG_MAX
 4294967295UL

	)

100 #ifdeà
__USE_ISOC99


103 
	#LLONG_MAX
 9223372036854775807LL

	)

104 
	#LLONG_MIN
 (-
LLONG_MAX
 - 1LL)

	)

107 
	#ULLONG_MAX
 18446744073709551615ULL

	)

121 #ià
defšed
 
__GNUC__
 && !defšed 
_GCC_LIMITS_H_


123 #šşude_Ãxˆ<
lim™s
.
h
>

129 #ià
defšed
 
__USE_ISOC99
 && defšed 
__GNUC__


130 #iâdeà
LLONG_MIN


131 
	#LLONG_MIN
 (-
LLONG_MAX
-1)

	)

133 #iâdeà
LLONG_MAX


134 
	#LLONG_MAX
 
__LONG_LONG_MAX__


	)

136 #iâdeà
ULLONG_MAX


137 
	#ULLONG_MAX
 (
LLONG_MAX
 * 2ULL + 1)

	)

141 #ifdef 
__USE_POSIX


143 
	~<b™s/posix1_lim.h
>

146 #ifdef 
__USE_POSIX2


147 
	~<b™s/posix2_lim.h
>

150 #ifdef 
__USE_XOPEN


151 
	~<b™s/xİ’_lim.h
>

	@/usr/include/malloc.h

19 #iâdeà
_MALLOC_H


20 
	#_MALLOC_H
 1

	)

22 
	~<ã©u»s.h
>

23 
	~<¡ddef.h
>

24 
	~<¡dio.h
>

26 #ifdeà
_LIBC


27 
	#__MALLOC_HOOK_VOLATILE


	)

28 
	#__MALLOC_DEPRECATED


	)

30 
	#__MALLOC_HOOK_VOLATILE
 vŞ©e

	)

31 
	#__MALLOC_DEPRECATED
 
__©Œibu‹_d•»ÿ‹d__


	)

35 
__BEGIN_DECLS


38 *
	$m®loc
 (
size_t
 
__size
è
__THROW
 
__©Œibu‹_m®loc__
 
__wur
;

41 *
	$ÿÎoc
 (
size_t
 
__nmemb
, size_ˆ
__size
)

42 
__THROW
 
__©Œibu‹_m®loc__
 
__wur
;

49 *
	$»®loc
 (*
__±r
, 
size_t
 
__size
)

50 
__THROW
 
__©Œibu‹_w¬n_unu£d_»suÉ__
;

53 
	$ä“
 (*
__±r
è
__THROW
;

56 
	$cä“
 (*
__±r
è
__THROW
;

59 *
	$mem®ign
 (
size_t
 
__®ignm’t
, size_ˆ
__size
)

60 
__THROW
 
__©Œibu‹_m®loc__
 
__wur
;

63 *
	$v®loc
 (
size_t
 
__size
è
__THROW
 
__©Œibu‹_m®loc__
 
__wur
;

67 *
	$pv®loc
 (
size_t
 
__size
è
__THROW
 
__©Œibu‹_m®loc__
 
__wur
;

71 *(*
__mÜecÜe
è(
±rdiff_t
 
__size
);

74 *
	$__deçuÉ_mÜecÜe
 (
±rdiff_t
 
__size
)

75 
__THROW
 
__©Œibu‹_m®loc__
;

79 
	sm®lšfo


81 
¬’a
;

82 
Üdblks
;

83 
smblks
;

84 
hblks
;

85 
hblkhd
;

86 
usmblks
;

87 
fsmblks
;

88 
uÜdblks
;

89 
fÜdblks
;

90 
k“pco¡
;

94 
m®lšfo
 
	$m®lšfo
 (è
__THROW
;

97 #iâdeà
M_MXFAST


98 
	#M_MXFAST
 1

	)

100 #iâdeà
M_NLBLKS


101 
	#M_NLBLKS
 2

	)

103 #iâdeà
M_GRAIN


104 
	#M_GRAIN
 3

	)

106 #iâdeà
M_KEEP


107 
	#M_KEEP
 4

	)

111 
	#M_TRIM_THRESHOLD
 -1

	)

112 
	#M_TOP_PAD
 -2

	)

113 
	#M_MMAP_THRESHOLD
 -3

	)

114 
	#M_MMAP_MAX
 -4

	)

115 
	#M_CHECK_ACTION
 -5

	)

116 
	#M_PERTURB
 -6

	)

117 
	#M_ARENA_TEST
 -7

	)

118 
	#M_ARENA_MAX
 -8

	)

121 
	$m®lİt
 (
__·¿m
, 
__v®
è
__THROW
;

125 
	$m®loc_Œim
 (
size_t
 
__·d
è
__THROW
;

129 
size_t
 
	$m®loc_u§bË_size
 (*
__±r
è
__THROW
;

132 
	$m®loc_¡©s
 (è
__THROW
;

135 
	$m®loc_šfo
 (
__İtiÚs
, 
FILE
 *
__å
è
__THROW
;

138 *
	$m®loc_g‘_¡©e
 (è
__THROW
;

142 
	$m®loc_£t_¡©e
 (*
__±r
è
__THROW
;

147 (*
__MALLOC_HOOK_VOLATILE
 
__m®loc_š™Ÿlize_hook
) ()

148 
__MALLOC_DEPRECATED
;

150 (*
__MALLOC_HOOK_VOLATILE
 
__ä“_hook
è(*
__±r
,

152 
__MALLOC_DEPRECATED
;

153 *(*
__MALLOC_HOOK_VOLATILE
 
__m®loc_hook
)(
size_t
 
__size
,

155 
__MALLOC_DEPRECATED
;

156 *(*
__MALLOC_HOOK_VOLATILE
 
__»®loc_hook
)(*
__±r
,

157 
size_t
 
__size
,

159 
__MALLOC_DEPRECATED
;

160 *(*
__MALLOC_HOOK_VOLATILE
 
__mem®ign_hook
)(
size_t
 
__®ignm’t
,

161 
size_t
 
__size
,

163 
__MALLOC_DEPRECATED
;

164 (*
__MALLOC_HOOK_VOLATILE
 
__aá”_mÜecÜe_hook
) ();

167 
	$__m®loc_check_š™
 (è
__THROW
 
__MALLOC_DEPRECATED
;

170 
__END_DECLS


	@/usr/include/math.h

23 #iâdef 
_MATH_H


24 
	#_MATH_H
 1

	)

26 
	~<ã©u»s.h
>

28 
	g__BEGIN_DECLS


32 
	~<b™s/huge_v®.h
>

33 #ifdeà
__USE_ISOC99


34 
	~<b™s/huge_v®f.h
>

35 
	~<b™s/huge_v®l.h
>

38 
	~<b™s/šf.h
>

41 
	~<b™s/Çn.h
>

45 
	~<b™s/m©hdef.h
>

52 
	#__MATHCALL
(
funùiÚ
,
suffix
, 
¬gs
) \

53 
	`__MATHDECL
 (
_MdoubË_
,
funùiÚ
,
suffix
, 
¬gs
)

	)

54 
	#__MATHDECL
(
ty³
, 
funùiÚ
,
suffix
, 
¬gs
) \

55 
	`__MATHDECL_1
(
ty³
, 
funùiÚ
,
suffix
, 
¬gs
); \

56 
	`__MATHDECL_1
(
ty³
, 
	`__CONCAT
(
__
,
funùiÚ
),
suffix
, 
¬gs
)

	)

57 
	#__MATHCALLX
(
funùiÚ
,
suffix
, 
¬gs
, 
©Œib
) \

58 
	`__MATHDECLX
 (
_MdoubË_
,
funùiÚ
,
suffix
, 
¬gs
, 
©Œib
)

	)

59 
	#__MATHDECLX
(
ty³
, 
funùiÚ
,
suffix
, 
¬gs
, 
©Œib
) \

60 
	`__MATHDECL_1
(
ty³
, 
funùiÚ
,
suffix
, 
¬gs
è
	`__©Œibu‹__
 (
©Œib
); \

61 
	`__MATHDECL_1
(
ty³
, 
	`__CONCAT
(
__
,
funùiÚ
),
suffix
, 
¬gs
è
	`__©Œibu‹__
 (
©Œib
)

	)

62 
	#__MATHDECL_1
(
ty³
, 
funùiÚ
,
suffix
, 
¬gs
) \

63 
ty³
 
	`__MATH_PRECNAME
(
funùiÚ
,
suffix
è
¬gs
 
__THROW


	)

65 
	#_MdoubË_
 

	)

66 
	#__MATH_PRECNAME
(
Çme
,
r
è
	`__CONCAT
Òame,r)

	)

67 
	#_MdoubË_BEGIN_NAMESPACE
 
__BEGIN_NAMESPACE_STD


	)

68 
	#_MdoubË_END_NAMESPACE
 
__END_NAMESPACE_STD


	)

69 
	~<b™s/m©hÿÎs.h
>

70 #undeà
_MdoubË_


71 #undeà
_MdoubË_BEGIN_NAMESPACE


72 #undeà
_MdoubË_END_NAMESPACE


73 #undeà
__MATH_PRECNAME


75 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_ISOC99


81 #iâdeà
_Mæßt_


82 
	#_Mæßt_
 

	)

84 
	#_MdoubË_
 
_Mæßt_


	)

85 
	#__MATH_PRECNAME
(
Çme
,
r
èÇme##
f
##
	)
r

86 
	#_MdoubË_BEGIN_NAMESPACE
 
__BEGIN_NAMESPACE_C99


	)

87 
	#_MdoubË_END_NAMESPACE
 
__END_NAMESPACE_C99


	)

88 
	~<b™s/m©hÿÎs.h
>

89 #undeà
_MdoubË_


90 #undeà
_MdoubË_BEGIN_NAMESPACE


91 #undeà
_MdoubË_END_NAMESPACE


92 #undeà
__MATH_PRECNAME


94 #ià!(
defšed
 
__NO_LONG_DOUBLE_MATH
 && defšed 
_LIBC
) \

95 || 
defšed
 
__LDBL_COMPAT


96 #ifdeà
__LDBL_COMPAT


98 #ifdeà
__USE_ISOC99


99 
	$__Ædbl_Ãx‰ow¬df
 (
__x
, 
__y
)

100 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

101 #ifdeà
__REDIRECT_NTH


102 
	`__REDIRECT_NTH
 (
Ãx‰ow¬df
, (
__x
, 
__y
),

103 
__Ædbl_Ãx‰ow¬df
)

104 
	`__©Œibu‹__
 ((
__cÚ¡__
));

105 
	`__REDIRECT_NTH
 (
Ãx‰ow¬d
, (
__x
, 
__y
),

106 
Ãxá”
è
	`__©Œibu‹__
 ((
__cÚ¡__
));

107 
	`__REDIRECT_NTH
 (
Ãx‰ow¬dl
,

108 (
__x
, 
__y
),

109 
Ãxá”
è
	`__©Œibu‹__
 ((
__cÚ¡__
));

113 #undeà
__MATHDECL_1


114 
	#__MATHDECL_2
(
ty³
, 
funùiÚ
,
suffix
, 
¬gs
, 
®Ÿs
) \

115 
ty³
 
	`__REDIRECT_NTH
(
	`__MATH_PRECNAME
(
funùiÚ
,
suffix
), \

116 
¬gs
, 
®Ÿs
)

	)

117 
	#__MATHDECL_1
(
ty³
, 
funùiÚ
,
suffix
, 
¬gs
) \

118 
	`__MATHDECL_2
(
ty³
, 
funùiÚ
,
suffix
, 
¬gs
, 
	`__CONCAT
(funùiÚ,suffix))

	)

124 #iâdeà
_MlÚg_doubË_


125 
	#_MlÚg_doubË_
 

	)

127 
	#_MdoubË_
 
_MlÚg_doubË_


	)

128 
	#__MATH_PRECNAME
(
Çme
,
r
èÇme##
l
##
	)
r

129 
	#_MdoubË_BEGIN_NAMESPACE
 
__BEGIN_NAMESPACE_C99


	)

130 
	#_MdoubË_END_NAMESPACE
 
__END_NAMESPACE_C99


	)

131 
	#__MATH_DECLARE_LDOUBLE
 1

	)

132 
	~<b™s/m©hÿÎs.h
>

133 #undeà
_MdoubË_


134 #undeà
_MdoubË_BEGIN_NAMESPACE


135 #undeà
_MdoubË_END_NAMESPACE


136 #undeà
__MATH_PRECNAME


141 #undeà
__MATHDECL_1


142 #undeà
__MATHDECL


143 #undeà
__MATHCALL


146 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN


148 
signgam
;

153 #ifdeà
__USE_ISOC99


191 
FP_NAN
 =

192 
	#FP_NAN
 0

	)

193 
FP_NAN
,

194 
FP_INFINITE
 =

195 
	#FP_INFINITE
 1

	)

196 
FP_INFINITE
,

197 
FP_ZERO
 =

198 
	#FP_ZERO
 2

	)

199 
FP_ZERO
,

200 
FP_SUBNORMAL
 =

201 
	#FP_SUBNORMAL
 3

	)

202 
FP_SUBNORMAL
,

203 
FP_NORMAL
 =

204 
	#FP_NORMAL
 4

	)

205 
FP_NORMAL


209 #ifdeà
__NO_LONG_DOUBLE_MATH


210 
	#åşassify
(
x
) \

211 ( (
x
è=ğ (è? 
	`__åşassifyf
 (xè: 
	`__åşassify
 (x))

	)

213 
	#åşassify
(
x
) \

214 ( (
x
) ==  () \

215 ? 
	`__åşassifyf
 (
x
) \

216 :  (
x
) ==  () \

217 ? 
	`__åşassify
 (
x
è: 
	`__åşassifyl
 (x))

	)

221 #ifdeà
__NO_LONG_DOUBLE_MATH


222 
	#signb™
(
x
) \

223 ( (
x
è=ğ (è? 
	`__signb™f
 (xè: 
	`__signb™
 (x))

	)

225 
	#signb™
(
x
) \

226 ( (
x
) ==  () \

227 ? 
	`__signb™f
 (
x
) \

228 :  (
x
) ==  () \

229 ? 
	`__signb™
 (
x
è: 
	`__signb™l
 (x))

	)

233 #ifdeà
__NO_LONG_DOUBLE_MATH


234 
	#isfš™e
(
x
) \

235 ( (
x
è=ğ (è? 
	`__fš™ef
 (xè: 
	`__fš™e
 (x))

	)

237 
	#isfš™e
(
x
) \

238 ( (
x
) ==  () \

239 ? 
	`__fš™ef
 (
x
) \

240 :  (
x
) ==  () \

241 ? 
	`__fš™e
 (
x
è: 
	`__fš™–
 (x))

	)

245 
	#i¢Üm®
(
x
è(
	`åşassify
 (xè=ğ
FP_NORMAL
)

	)

249 #ifdeà
__NO_LONG_DOUBLE_MATH


250 
	#i¢ª
(
x
) \

251 ( (
x
è=ğ (è? 
	`__i¢ªf
 (xè: 
	`__i¢ª
 (x))

	)

253 
	#i¢ª
(
x
) \

254 ( (
x
) ==  () \

255 ? 
	`__i¢ªf
 (
x
) \

256 :  (
x
) ==  () \

257 ? 
	`__i¢ª
 (
x
è: 
	`__i¢ªl
 (x))

	)

261 #ifdeà
__NO_LONG_DOUBLE_MATH


262 
	#isšf
(
x
) \

263 ( (
x
è=ğ (è? 
	`__isšff
 (xè: 
	`__isšf
 (x))

	)

265 
	#isšf
(
x
) \

266 ( (
x
) ==  () \

267 ? 
	`__isšff
 (
x
) \

268 :  (
x
) ==  () \

269 ? 
	`__isšf
 (
x
è: 
	`__isšæ
 (x))

	)

273 
	#MATH_ERRNO
 1

	)

274 
	#MATH_ERREXCEPT
 2

	)

279 #iâdeà
__FAST_MATH__


280 
	#m©h_”rhªdlšg
 (
MATH_ERRNO
 | 
MATH_ERREXCEPT
)

	)

285 #ifdeà
__USE_GNU


287 #ifdeà
__NO_LONG_DOUBLE_MATH


288 
	#issigÇlšg
(
x
) \

289 ( (
x
è=ğ (è? 
	`__issigÇlšgf
 (xè: 
	`__issigÇlšg
 (x))

	)

291 
	#issigÇlšg
(
x
) \

292 ( (
x
) ==  () \

293 ? 
	`__issigÇlšgf
 (
x
) \

294 :  (
x
) ==  () \

295 ? 
	`__issigÇlšg
 (
x
è: 
	`__issigÇlšgl
 (x))

	)

299 #ifdef 
__USE_MISC


303 
_IEEE_
 = -1,

304 
_SVID_
,

305 
_XOPEN_
,

306 
_POSIX_
,

307 
_ISOC_


308 } 
	t_LIB_VERSION_TYPE
;

313 
_LIB_VERSION_TYPE
 
_LIB_VERSION
;

317 #ifdeà
__USE_SVID


323 #ifdeà
__ılu¥lus


324 
__exû±iÚ


326 
exû±iÚ


329 
ty³
;

330 *
Çme
;

331 
¬g1
;

332 
¬g2
;

333 
»tv®
;

334 
	}
};

336 #ifdeà
__ılu¥lus


337 
	$m©h”r
 (
__exû±iÚ
 *
__exc
è
	`throw
 ();

339 
	`m©h”r
 (
exû±iÚ
 *
__exc
);

342 
	#X_TLOSS
 1.41484755040568800000e+16

	)

345 
	#DOMAIN
 1

	)

346 
	#SING
 2

	)

347 
	#OVERFLOW
 3

	)

348 
	#UNDERFLOW
 4

	)

349 
	#TLOSS
 5

	)

350 
	#PLOSS
 6

	)

353 
	#HUGE
 3.40282347e+38F

	)

357 #ifdeà
__USE_XOPEN


359 
	#MAXFLOAT
 3.40282347e+38F

	)

366 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN


367 
	#M_E
 2.7182818284590452354

	)

368 
	#M_LOG2E
 1.4426950408889634074

	)

369 
	#M_LOG10E
 0.43429448190325182765

	)

370 
	#M_LN2
 0.69314718055994530942

	)

371 
	#M_LN10
 2.30258509299404568402

	)

372 
	#M_PI
 3.14159265358979323846

	)

373 
	#M_PI_2
 1.57079632679489661923

	)

374 
	#M_PI_4
 0.78539816339744830962

	)

375 
	#M_1_PI
 0.31830988618379067154

	)

376 
	#M_2_PI
 0.63661977236758134308

	)

377 
	#M_2_SQRTPI
 1.12837916709551257390

	)

378 
	#M_SQRT2
 1.41421356237309504880

	)

379 
	#M_SQRT1_2
 0.70710678118654752440

	)

385 #ifdeà
__USE_GNU


386 
	#M_El
 2.718281828459045235360287471352662498L

	)

387 
	#M_LOG2El
 1.442695040888963407359924681001892137L

	)

388 
	#M_LOG10El
 0.434294481903251827651128918916605082L

	)

389 
	#M_LN2l
 0.693147180559945309417232121458176568L

	)

390 
	#M_LN10l
 2.302585092994045684017991454684364208L

	)

391 
	#M_PIl
 3.141592653589793238462643383279502884L

	)

392 
	#M_PI_2l
 1.570796326794896619231321691639751442L

	)

393 
	#M_PI_4l
 0.785398163397448309615660845819875721L

	)

394 
	#M_1_PIl
 0.318309886183790671537767526745028724L

	)

395 
	#M_2_PIl
 0.636619772367581343075535053490057448L

	)

396 
	#M_2_SQRTPIl
 1.128379167095512573896158903121545172L

	)

397 
	#M_SQRT2l
 1.414213562373095048801688724209698079L

	)

398 
	#M_SQRT1_2l
 0.707106781186547524400844362104849039L

	)

405 #ià
defšed
 
__STRICT_ANSI__
 && !defšed 
__NO_MATH_INLINES


406 
	#__NO_MATH_INLINES
 1

	)

409 #ià
defšed
 
__USE_ISOC99
 && 
	`__GNUC_PREREQ
(2,97)

416 
	#isg»©”
(
x
, 
y
è
	`__butš_isg»©”
(x, y)

	)

417 
	#isg»©”equ®
(
x
, 
y
è
	`__butš_isg»©”equ®
(x, y)

	)

418 
	#i¦ess
(
x
, 
y
è
	`__butš_i¦ess
(x, y)

	)

419 
	#i¦es£qu®
(
x
, 
y
è
	`__butš_i¦es£qu®
(x, y)

	)

420 
	#i¦essg»©”
(
x
, 
y
è
	`__butš_i¦essg»©”
(x, y)

	)

421 
	#isunÜd”ed
(
u
, 
v
è
	`__butš_isunÜd”ed
(u, v)

	)

425 #ifdeà
__USE_EXTERN_INLINES


426 
	~<b™s/m©hšlše.h
>

431 #ià
defšed
 
__FINITE_MATH_ONLY__
 && __FINITE_MATH_ONLY__ > 0

432 
	~<b™s/m©h-fš™e.h
>

435 #ifdeà
__USE_ISOC99


439 #iâdeà
isg»©”


440 
	#isg»©”
(
x
, 
y
) \

441 (
__ex‹nsiÚ__
 \

442 ({ 
	`__ty³of__
(
x
è
__x
 = (x); __ty³of__(
y
è
__y
 = (y); \

443 !
	`isunÜd”ed
 (
__x
, 
__y
è&& __x > __y; 
	}
}))

	)

447 #iâdeà
isg»©”equ®


448 
	#isg»©”equ®
(
x
, 
y
) \

449 (
__ex‹nsiÚ__
 \

450 ({ 
	`__ty³of__
(
x
è
__x
 = (x); __ty³of__(
y
è
__y
 = (y); \

451 !
	`isunÜd”ed
 (
__x
, 
__y
è&& __x >ğ__y; }))

	)

455 #iâdeà
i¦ess


456 
	#i¦ess
(
x
, 
y
) \

457 (
__ex‹nsiÚ__
 \

458 ({ 
	`__ty³of__
(
x
è
__x
 = (x); __ty³of__(
y
è
__y
 = (y); \

459 !
	`isunÜd”ed
 (
__x
, 
__y
è&& __x < __y; }))

	)

463 #iâdeà
i¦es£qu®


464 
	#i¦es£qu®
(
x
, 
y
) \

465 (
__ex‹nsiÚ__
 \

466 ({ 
	`__ty³of__
(
x
è
__x
 = (x); __ty³of__(
y
è
__y
 = (y); \

467 !
	`isunÜd”ed
 (
__x
, 
__y
è&& __x <ğ__y; }))

	)

471 #iâdeà
i¦essg»©”


472 
	#i¦essg»©”
(
x
, 
y
) \

473 (
__ex‹nsiÚ__
 \

474 ({ 
	`__ty³of__
(
x
è
__x
 = (x); __ty³of__(
y
è
__y
 = (y); \

475 !
	`isunÜd”ed
 (
__x
, 
__y
è&& (__x < __y || __y < __x); }))

	)

479 #iâdeà
isunÜd”ed


480 
	#isunÜd”ed
(
u
, 
v
) \

481 (
__ex‹nsiÚ__
 \

482 ({ 
	`__ty³of__
(
u
è
__u
 = (u); __ty³of__(
v
è
__v
 = (v); \

483 
	`åşassify
 (
__u
è=ğ
FP_NAN
 || fpşassify (
__v
è=ğFP_NAN; }))

	)

488 
	g__END_DECLS


	@/usr/include/netdb.h

22 #iâdef 
_NETDB_H


23 
	#_NETDB_H
 1

	)

25 
	~<ã©u»s.h
>

27 
	~<Ãtš‘/š.h
>

28 
	~<¡dšt.h
>

29 #ifdeà
__USE_MISC


32 
	~<½c/Ãtdb.h
>

35 #ifdeà
__USE_GNU


36 
	#__Ãed_sigev’t_t


	)

37 
	~<b™s/sigšfo.h
>

38 
	#__Ãed_time¥ec


	)

39 
	~<time.h
>

42 
	~<b™s/Ãtdb.h
>

45 
	#_PATH_HEQUIV
 "/‘c/ho¡s.equiv"

	)

46 
	#_PATH_HOSTS
 "/‘c/ho¡s"

	)

47 
	#_PATH_NETWORKS
 "/‘c/ÃtwÜks"

	)

48 
	#_PATH_NSSWITCH_CONF
 "/‘c/nssw™ch.cÚf"

	)

49 
	#_PATH_PROTOCOLS
 "/‘c/´ÙocŞs"

	)

50 
	#_PATH_SERVICES
 "/‘c/£rviûs"

	)

53 
	g__BEGIN_DECLS


55 #ià
defšed
 
__USE_MISC
 || !defšed 
__USE_XOPEN2K8


58 
	#h_”ºo
 (*
	`__h_”ºo_loÿtiÚ
 ())

	)

61 *
	$__h_”ºo_loÿtiÚ
 (è
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

65 
	#HOST_NOT_FOUND
 1

	)

66 
	#TRY_AGAIN
 2

	)

68 
	#NO_RECOVERY
 3

	)

70 
	#NO_DATA
 4

	)

73 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_GNU


74 
	#NETDB_INTERNAL
 -1

	)

75 
	#NETDB_SUCCESS
 0

	)

76 
	#NO_ADDRESS
 
NO_DATA


	)

79 #ià
defšed
 
__USE_XOPEN2K
 || defšed 
__USE_XOPEN_EXTENDED


81 
	#IPPORT_RESERVED
 1024

	)

84 #ifdeà
__USE_GNU


86 
	#SCOPE_DELIMITER
 '%'

	)

89 #ifdeà
__USE_MISC


92 
	$h”rÜ
 (cÚ¡ *
__¡r
è
__THROW
;

95 cÚ¡ *
	$h¡»¼Ü
 (
__”r_num
è
__THROW
;

100 
	sho¡’t


102 *
h_Çme
;

103 **
h_®Ÿ£s
;

104 
h_add¹y³
;

105 
h_Ëngth
;

106 **
h_addr_li¡
;

107 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_GNU


108 
	#h_addr
 
h_addr_li¡
[0]

	)

117 
	`£tho¡’t
 (
__¡ay_İ’
);

123 
	`’dho¡’t
 ();

130 
ho¡’t
 *
	`g‘ho¡’t
 ();

137 
ho¡’t
 *
	`g‘ho¡byaddr
 (cÚ¡ *
__addr
, 
__sockËn_t
 
__Ën
,

138 
__ty³
);

144 
ho¡’t
 *
	`g‘ho¡byÇme
 (cÚ¡ *
__Çme
);

146 #ifdeà
__USE_MISC


155 
ho¡’t
 *
	`g‘ho¡byÇme2
 (cÚ¡ *
__Çme
, 
__af
);

167 
	`g‘ho¡’t_r
 (
ho¡’t
 *
__»¡riù
 
__»suÉ_buf
,

168 *
__»¡riù
 
__buf
, 
size_t
 
__buæ’
,

169 
ho¡’t
 **
__»¡riù
 
__»suÉ
,

170 *
__»¡riù
 
__h_”ºİ
);

172 
	`g‘ho¡byaddr_r
 (cÚ¡ *
__»¡riù
 
__addr
, 
__sockËn_t
 
__Ën
,

173 
__ty³
,

174 
ho¡’t
 *
__»¡riù
 
__»suÉ_buf
,

175 *
__»¡riù
 
__buf
, 
size_t
 
__buæ’
,

176 
ho¡’t
 **
__»¡riù
 
__»suÉ
,

177 *
__»¡riù
 
__h_”ºİ
);

179 
	`g‘ho¡byÇme_r
 (cÚ¡ *
__»¡riù
 
__Çme
,

180 
ho¡’t
 *
__»¡riù
 
__»suÉ_buf
,

181 *
__»¡riù
 
__buf
, 
size_t
 
__buæ’
,

182 
ho¡’t
 **
__»¡riù
 
__»suÉ
,

183 *
__»¡riù
 
__h_”ºİ
);

185 
	`g‘ho¡byÇme2_r
 (cÚ¡ *
__»¡riù
 
__Çme
, 
__af
,

186 
ho¡’t
 *
__»¡riù
 
__»suÉ_buf
,

187 *
__»¡riù
 
__buf
, 
size_t
 
__buæ’
,

188 
ho¡’t
 **
__»¡riù
 
__»suÉ
,

189 *
__»¡riù
 
__h_”ºİ
);

198 
	`£Š‘’t
 (
__¡ay_İ’
);

204 
	`’dÃ‹Á
 ();

211 
Ã‹Á
 *
	`g‘Ã‹Á
 ();

218 
Ã‹Á
 *
	`g‘Ãtbyaddr
 (
ušt32_t
 
__Ãt
, 
__ty³
);

224 
Ã‹Á
 *
	`g‘ÃtbyÇme
 (cÚ¡ *
__Çme
);

226 #ifdef 
__USE_MISC


237 
	`g‘Ã‹Á_r
 (
Ã‹Á
 *
__»¡riù
 
__»suÉ_buf
,

238 *
__»¡riù
 
__buf
, 
size_t
 
__buæ’
,

239 
Ã‹Á
 **
__»¡riù
 
__»suÉ
,

240 *
__»¡riù
 
__h_”ºİ
);

242 
	`g‘Ãtbyaddr_r
 (
ušt32_t
 
__Ãt
, 
__ty³
,

243 
Ã‹Á
 *
__»¡riù
 
__»suÉ_buf
,

244 *
__»¡riù
 
__buf
, 
size_t
 
__buæ’
,

245 
Ã‹Á
 **
__»¡riù
 
__»suÉ
,

246 *
__»¡riù
 
__h_”ºİ
);

248 
	`g‘ÃtbyÇme_r
 (cÚ¡ *
__»¡riù
 
__Çme
,

249 
Ã‹Á
 *
__»¡riù
 
__»suÉ_buf
,

250 *
__»¡riù
 
__buf
, 
size_t
 
__buæ’
,

251 
Ã‹Á
 **
__»¡riù
 
__»suÉ
,

252 *
__»¡riù
 
__h_”ºİ
);

257 
	s£rv’t


259 *
s_Çme
;

260 **
s_®Ÿ£s
;

261 
s_pÜt
;

262 *
s_´Ùo
;

270 
	`£t£rv’t
 (
__¡ay_İ’
);

276 
	`’d£rv’t
 ();

283 
£rv’t
 *
	`g‘£rv’t
 ();

290 
£rv’t
 *
	`g‘£rvbyÇme
 (cÚ¡ *
__Çme
, cÚ¡ *
__´Ùo
);

297 
£rv’t
 *
	`g‘£rvbypÜt
 (
__pÜt
, cÚ¡ *
__´Ùo
);

300 #ifdef 
__USE_MISC


308 
	`g‘£rv’t_r
 (
£rv’t
 *
__»¡riù
 
__»suÉ_buf
,

309 *
__»¡riù
 
__buf
, 
size_t
 
__buæ’
,

310 
£rv’t
 **
__»¡riù
 
__»suÉ
);

312 
	`g‘£rvbyÇme_r
 (cÚ¡ *
__»¡riù
 
__Çme
,

313 cÚ¡ *
__»¡riù
 
__´Ùo
,

314 
£rv’t
 *
__»¡riù
 
__»suÉ_buf
,

315 *
__»¡riù
 
__buf
, 
size_t
 
__buæ’
,

316 
£rv’t
 **
__»¡riù
 
__»suÉ
);

318 
	`g‘£rvbypÜt_r
 (
__pÜt
, cÚ¡ *
__»¡riù
 
__´Ùo
,

319 
£rv’t
 *
__»¡riù
 
__»suÉ_buf
,

320 *
__»¡riù
 
__buf
, 
size_t
 
__buæ’
,

321 
£rv’t
 **
__»¡riù
 
__»suÉ
);

326 
	s´ÙÛÁ


328 *
p_Çme
;

329 **
p_®Ÿ£s
;

330 
p_´Ùo
;

338 
	`£rÙÛÁ
 (
__¡ay_İ’
);

344 
	`’d´ÙÛÁ
 ();

351 
´ÙÛÁ
 *
	`g‘´ÙÛÁ
 ();

357 
´ÙÛÁ
 *
	`g‘´ÙobyÇme
 (cÚ¡ *
__Çme
);

363 
´ÙÛÁ
 *
	`g‘´Ùobynumb”
 (
__´Ùo
);

366 #ifdef 
__USE_MISC


374 
	`g‘´ÙÛÁ_r
 (
´ÙÛÁ
 *
__»¡riù
 
__»suÉ_buf
,

375 *
__»¡riù
 
__buf
, 
size_t
 
__buæ’
,

376 
´ÙÛÁ
 **
__»¡riù
 
__»suÉ
);

378 
	`g‘´ÙobyÇme_r
 (cÚ¡ *
__»¡riù
 
__Çme
,

379 
´ÙÛÁ
 *
__»¡riù
 
__»suÉ_buf
,

380 *
__»¡riù
 
__buf
, 
size_t
 
__buæ’
,

381 
´ÙÛÁ
 **
__»¡riù
 
__»suÉ
);

383 
	`g‘´Ùobynumb”_r
 (
__´Ùo
,

384 
´ÙÛÁ
 *
__»¡riù
 
__»suÉ_buf
,

385 *
__»¡riù
 
__buf
, 
size_t
 
__buæ’
,

386 
´ÙÛÁ
 **
__»¡riù
 
__»suÉ
);

395 
	`£Š‘g»Á
 (cÚ¡ *
__Ãtgroup
);

403 
	`’dÃtg»Á
 ();

412 
	`g‘Ãtg»Á
 (**
__»¡riù
 
__ho¡p
,

413 **
__»¡riù
 
__u£½
,

414 **
__»¡riù
 
__domašp
);

423 
	`šÃtgr
 (cÚ¡ *
__Ãtgroup
, cÚ¡ *
__ho¡
,

424 cÚ¡ *
__u£r
, cÚ¡ *
__domaš
);

432 
	`g‘Ãtg»Á_r
 (**
__»¡riù
 
__ho¡p
,

433 **
__»¡riù
 
__u£½
,

434 **
__»¡riù
 
__domašp
,

435 *
__»¡riù
 
__bufãr
, 
size_t
 
__buæ’
);

439 #ifdeà
__USE_BSD


451 
	`rcmd
 (**
__»¡riù
 
__aho¡
, 
__½Üt
,

452 cÚ¡ *
__»¡riù
 
__locu£r
,

453 cÚ¡ *
__»¡riù
 
__»mu£r
,

454 cÚ¡ *
__»¡riù
 
__cmd
, *__»¡riù 
__fd2p
);

463 
	`rcmd_af
 (**
__»¡riù
 
__aho¡
, 
__½Üt
,

464 cÚ¡ *
__»¡riù
 
__locu£r
,

465 cÚ¡ *
__»¡riù
 
__»mu£r
,

466 cÚ¡ *
__»¡riù
 
__cmd
, *__»¡riù 
__fd2p
,

467 
§_çmy_t
 
__af
);

479 
	`»xec
 (**
__»¡riù
 
__aho¡
, 
__½Üt
,

480 cÚ¡ *
__»¡riù
 
__Çme
,

481 cÚ¡ *
__»¡riù
 
__·ss
,

482 cÚ¡ *
__»¡riù
 
__cmd
, *__»¡riù 
__fd2p
);

491 
	`»xec_af
 (**
__»¡riù
 
__aho¡
, 
__½Üt
,

492 cÚ¡ *
__»¡riù
 
__Çme
,

493 cÚ¡ *
__»¡riù
 
__·ss
,

494 cÚ¡ *
__»¡riù
 
__cmd
, *__»¡riù 
__fd2p
,

495 
§_çmy_t
 
__af
);

505 
	`ru£rok
 (cÚ¡ *
__rho¡
, 
__su£r
,

506 cÚ¡ *
__»mu£r
, cÚ¡ *
__locu£r
);

515 
	`ru£rok_af
 (cÚ¡ *
__rho¡
, 
__su£r
,

516 cÚ¡ *
__»mu£r
, cÚ¡ *
__locu£r
,

517 
§_çmy_t
 
__af
);

528 
	`œu£rok
 (
ušt32_t
 
__¿ddr
, 
__su£r
,

529 cÚ¡ *
__»mu£r
, cÚ¡ *
__locu£r
);

539 
	`œu£rok_af
 (cÚ¡ *
__¿ddr
, 
__su£r
,

540 cÚ¡ *
__»mu£r
, cÚ¡ *
__locu£r
,

541 
§_çmy_t
 
__af
);

551 
	`¼esvpÜt
 (*
__®pÜt
);

560 
	`¼esvpÜt_af
 (*
__®pÜt
, 
§_çmy_t
 
__af
);

565 #ifdef 
__USE_POSIX


567 
	saddršfo


569 
ai_æags
;

570 
ai_çmy
;

571 
ai_sockty³
;

572 
ai_´ÙocŞ
;

573 
sockËn_t
 
ai_add¾’
;

574 
sockaddr
 *
ai_addr
;

575 *
ai_ÿnÚÇme
;

576 
addršfo
 *
ai_Ãxt
;

579 #ifdeà
__USE_GNU


581 
	sgaicb


583 cÚ¡ *
¬_Çme
;

584 cÚ¡ *
¬_£rviû
;

585 cÚ¡ 
addršfo
 *
¬_»que¡
;

586 
addršfo
 *
¬_»suÉ
;

588 
__»tuº
;

589 
__glibc_»£rved
[5];

593 
	#GAI_WAIT
 0

	)

594 
	#GAI_NOWAIT
 1

	)

598 
	#AI_PASSIVE
 0x0001

	)

599 
	#AI_CANONNAME
 0x0002

	)

600 
	#AI_NUMERICHOST
 0x0004

	)

601 
	#AI_V4MAPPED
 0x0008

	)

602 
	#AI_ALL
 0x0010

	)

603 
	#AI_ADDRCONFIG
 0x0020

	)

605 #ifdeà
__USE_GNU


606 
	#AI_IDN
 0x0040

	)

609 
	#AI_CANONIDN
 0x0080

	)

610 
	#AI_IDN_ALLOW_UNASSIGNED
 0x0100

	)

612 
	#AI_IDN_USE_STD3_ASCII_RULES
 0x0200

	)

615 
	#AI_NUMERICSERV
 0x0400

	)

618 
	#EAI_BADFLAGS
 -1

	)

619 
	#EAI_NONAME
 -2

	)

620 
	#EAI_AGAIN
 -3

	)

621 
	#EAI_FAIL
 -4

	)

622 
	#EAI_FAMILY
 -6

	)

623 
	#EAI_SOCKTYPE
 -7

	)

624 
	#EAI_SERVICE
 -8

	)

625 
	#EAI_MEMORY
 -10

	)

626 
	#EAI_SYSTEM
 -11

	)

627 
	#EAI_OVERFLOW
 -12

	)

628 #ifdeà
__USE_GNU


629 
	#EAI_NODATA
 -5

	)

630 
	#EAI_ADDRFAMILY
 -9

	)

631 
	#EAI_INPROGRESS
 -100

	)

632 
	#EAI_CANCELED
 -101

	)

633 
	#EAI_NOTCANCELED
 -102

	)

634 
	#EAI_ALLDONE
 -103

	)

635 
	#EAI_INTR
 -104

	)

636 
	#EAI_IDN_ENCODE
 -105

	)

639 #ifdeà
__USE_MISC


640 
	#NI_MAXHOST
 1025

	)

641 
	#NI_MAXSERV
 32

	)

644 
	#NI_NUMERICHOST
 1

	)

645 
	#NI_NUMERICSERV
 2

	)

646 
	#NI_NOFQDN
 4

	)

647 
	#NI_NAMEREQD
 8

	)

648 
	#NI_DGRAM
 16

	)

649 #ifdeà
__USE_GNU


650 
	#NI_IDN
 32

	)

651 
	#NI_IDN_ALLOW_UNASSIGNED
 64

	)

653 
	#NI_IDN_USE_STD3_ASCII_RULES
 128

	)

662 
	`g‘addršfo
 (cÚ¡ *
__»¡riù
 
__Çme
,

663 cÚ¡ *
__»¡riù
 
__£rviû
,

664 cÚ¡ 
addršfo
 *
__»¡riù
 
__»q
,

665 
addršfo
 **
__»¡riù
 
__·i
);

668 
	$ä“addršfo
 (
addršfo
 *
__ai
è
__THROW
;

671 cÚ¡ *
	$gai_¡»¼Ü
 (
__ecode
è
__THROW
;

677 
	`g‘Çmešfo
 (cÚ¡ 
sockaddr
 *
__»¡riù
 
__§
,

678 
sockËn_t
 
__§Ën
, *
__»¡riù
 
__ho¡
,

679 
sockËn_t
 
__ho¡Ën
, *
__»¡riù
 
__£rv
,

680 
sockËn_t
 
__£rvËn
, 
__æags
);

683 #ifdeà
__USE_GNU


692 
	`g‘addršfo_a
 (
__mode
, 
gaicb
 *
__li¡
[
__»¡riù_¬r
],

693 
__’t
, 
sigev’t
 *
__»¡riù
 
__sig
);

703 
	`gai_su¥’d
 (cÚ¡ 
gaicb
 *cÚ¡ 
__li¡
[], 
__’t
,

704 cÚ¡ 
time¥ec
 *
__timeout
);

707 
	$gai_”rÜ
 (
gaicb
 *
__»q
è
__THROW
;

710 
	$gai_ÿnûl
 (
gaicb
 *
__gaicbp
è
__THROW
;

713 
__END_DECLS


	@/usr/include/netinet/in.h

18 #iâdef 
_NETINET_IN_H


19 
	#_NETINET_IN_H
 1

	)

21 
	~<ã©u»s.h
>

22 
	~<¡dšt.h
>

23 
	~<sys/sock‘.h
>

24 
	~<b™s/ty³s.h
>

27 
__BEGIN_DECLS


30 
ušt32_t
 
	tš_addr_t
;

31 
	sš_addr


33 
š_addr_t
 
	ms_addr
;

37 
	~<b™s/š.h
>

42 
	mIPPROTO_IP
 = 0,

43 
	#IPPROTO_IP
 
IPPROTO_IP


	)

44 
	mIPPROTO_ICMP
 = 1,

45 
	#IPPROTO_ICMP
 
IPPROTO_ICMP


	)

46 
	mIPPROTO_IGMP
 = 2,

47 
	#IPPROTO_IGMP
 
IPPROTO_IGMP


	)

48 
	mIPPROTO_IPIP
 = 4,

49 
	#IPPROTO_IPIP
 
IPPROTO_IPIP


	)

50 
	mIPPROTO_TCP
 = 6,

51 
	#IPPROTO_TCP
 
IPPROTO_TCP


	)

52 
	mIPPROTO_EGP
 = 8,

53 
	#IPPROTO_EGP
 
IPPROTO_EGP


	)

54 
	mIPPROTO_PUP
 = 12,

55 
	#IPPROTO_PUP
 
IPPROTO_PUP


	)

56 
	mIPPROTO_UDP
 = 17,

57 
	#IPPROTO_UDP
 
IPPROTO_UDP


	)

58 
	mIPPROTO_IDP
 = 22,

59 
	#IPPROTO_IDP
 
IPPROTO_IDP


	)

60 
	mIPPROTO_TP
 = 29,

61 
	#IPPROTO_TP
 
IPPROTO_TP


	)

62 
	mIPPROTO_DCCP
 = 33,

63 
	#IPPROTO_DCCP
 
IPPROTO_DCCP


	)

64 
	mIPPROTO_IPV6
 = 41,

65 
	#IPPROTO_IPV6
 
IPPROTO_IPV6


	)

66 
	mIPPROTO_RSVP
 = 46,

67 
	#IPPROTO_RSVP
 
IPPROTO_RSVP


	)

68 
	mIPPROTO_GRE
 = 47,

69 
	#IPPROTO_GRE
 
IPPROTO_GRE


	)

70 
	mIPPROTO_ESP
 = 50,

71 
	#IPPROTO_ESP
 
IPPROTO_ESP


	)

72 
	mIPPROTO_AH
 = 51,

73 
	#IPPROTO_AH
 
IPPROTO_AH


	)

74 
	mIPPROTO_MTP
 = 92,

75 
	#IPPROTO_MTP
 
IPPROTO_MTP


	)

76 
	mIPPROTO_BEETPH
 = 94,

77 
	#IPPROTO_BEETPH
 
IPPROTO_BEETPH


	)

78 
	mIPPROTO_ENCAP
 = 98,

79 
	#IPPROTO_ENCAP
 
IPPROTO_ENCAP


	)

80 
	mIPPROTO_PIM
 = 103,

81 
	#IPPROTO_PIM
 
IPPROTO_PIM


	)

82 
	mIPPROTO_COMP
 = 108,

83 
	#IPPROTO_COMP
 
IPPROTO_COMP


	)

84 
	mIPPROTO_SCTP
 = 132,

85 
	#IPPROTO_SCTP
 
IPPROTO_SCTP


	)

86 
	mIPPROTO_UDPLITE
 = 136,

87 
	#IPPROTO_UDPLITE
 
IPPROTO_UDPLITE


	)

88 
	mIPPROTO_RAW
 = 255,

89 
	#IPPROTO_RAW
 
IPPROTO_RAW


	)

90 
	mIPPROTO_MAX


96 #iâdeà
__USE_KERNEL_IPV6_DEFS


99 
	mIPPROTO_HOPOPTS
 = 0,

100 
	#IPPROTO_HOPOPTS
 
IPPROTO_HOPOPTS


	)

101 
	mIPPROTO_ROUTING
 = 43,

102 
	#IPPROTO_ROUTING
 
IPPROTO_ROUTING


	)

103 
	mIPPROTO_FRAGMENT
 = 44,

104 
	#IPPROTO_FRAGMENT
 
IPPROTO_FRAGMENT


	)

105 
	mIPPROTO_ICMPV6
 = 58,

106 
	#IPPROTO_ICMPV6
 
IPPROTO_ICMPV6


	)

107 
	mIPPROTO_NONE
 = 59,

108 
	#IPPROTO_NONE
 
IPPROTO_NONE


	)

109 
	mIPPROTO_DSTOPTS
 = 60,

110 
	#IPPROTO_DSTOPTS
 
IPPROTO_DSTOPTS


	)

111 
	mIPPROTO_MH
 = 135

112 
	#IPPROTO_MH
 
IPPROTO_MH


	)

117 
ušt16_t
 
	tš_pÜt_t
;

122 
	mIPPORT_ECHO
 = 7,

123 
	mIPPORT_DISCARD
 = 9,

124 
	mIPPORT_SYSTAT
 = 11,

125 
	mIPPORT_DAYTIME
 = 13,

126 
	mIPPORT_NETSTAT
 = 15,

127 
	mIPPORT_FTP
 = 21,

128 
	mIPPORT_TELNET
 = 23,

129 
	mIPPORT_SMTP
 = 25,

130 
	mIPPORT_TIMESERVER
 = 37,

131 
	mIPPORT_NAMESERVER
 = 42,

132 
	mIPPORT_WHOIS
 = 43,

133 
	mIPPORT_MTP
 = 57,

135 
	mIPPORT_TFTP
 = 69,

136 
	mIPPORT_RJE
 = 77,

137 
	mIPPORT_FINGER
 = 79,

138 
	mIPPORT_TTYLINK
 = 87,

139 
	mIPPORT_SUPDUP
 = 95,

142 
	mIPPORT_EXECSERVER
 = 512,

143 
	mIPPORT_LOGINSERVER
 = 513,

144 
	mIPPORT_CMDSERVER
 = 514,

145 
	mIPPORT_EFSSERVER
 = 520,

148 
	mIPPORT_BIFFUDP
 = 512,

149 
	mIPPORT_WHOSERVER
 = 513,

150 
	mIPPORT_ROUTESERVER
 = 520,

153 
	mIPPORT_RESERVED
 = 1024,

156 
	mIPPORT_USERRESERVED
 = 5000

164 
	#IN_CLASSA
(
a
è((((
š_addr_t
)×)è& 0x80000000è=ğ0)

	)

165 
	#IN_CLASSA_NET
 0xff000000

	)

166 
	#IN_CLASSA_NSHIFT
 24

	)

167 
	#IN_CLASSA_HOST
 (0xfffffffà& ~
IN_CLASSA_NET
)

	)

168 
	#IN_CLASSA_MAX
 128

	)

170 
	#IN_CLASSB
(
a
è((((
š_addr_t
)×)è& 0xc0000000è=ğ0x80000000)

	)

171 
	#IN_CLASSB_NET
 0xffff0000

	)

172 
	#IN_CLASSB_NSHIFT
 16

	)

173 
	#IN_CLASSB_HOST
 (0xfffffffà& ~
IN_CLASSB_NET
)

	)

174 
	#IN_CLASSB_MAX
 65536

	)

176 
	#IN_CLASSC
(
a
è((((
š_addr_t
)×)è& 0xe0000000è=ğ0xc0000000)

	)

177 
	#IN_CLASSC_NET
 0xffffff00

	)

178 
	#IN_CLASSC_NSHIFT
 8

	)

179 
	#IN_CLASSC_HOST
 (0xfffffffà& ~
IN_CLASSC_NET
)

	)

181 
	#IN_CLASSD
(
a
è((((
š_addr_t
)×)è& 0xf0000000è=ğ0xe0000000)

	)

182 
	#IN_MULTICAST
(
a
è
	`IN_CLASSD
×)

	)

184 
	#IN_EXPERIMENTAL
(
a
è((((
š_addr_t
)×)è& 0xe0000000è=ğ0xe0000000)

	)

185 
	#IN_BADCLASS
(
a
è((((
š_addr_t
)×)è& 0xf0000000è=ğ0xf0000000)

	)

188 
	#INADDR_ANY
 ((
š_addr_t
è0x00000000)

	)

190 
	#INADDR_BROADCAST
 ((
š_addr_t
è0xffffffff)

	)

192 
	#INADDR_NONE
 ((
š_addr_t
è0xffffffff)

	)

195 
	#IN_LOOPBACKNET
 127

	)

197 #iâdeà
INADDR_LOOPBACK


198 
	#INADDR_LOOPBACK
 ((
š_addr_t
è0x7f000001è

	)

202 
	#INADDR_UNSPEC_GROUP
 ((
š_addr_t
è0xe0000000è

	)

203 
	#INADDR_ALLHOSTS_GROUP
 ((
š_addr_t
è0xe0000001è

	)

204 
	#INADDR_ALLRTRS_GROUP
 ((
š_addr_t
è0xe0000002è

	)

205 
	#INADDR_MAX_LOCAL_GROUP
 ((
š_addr_t
è0xe00000ffè

	)

207 #iâdeà
__USE_KERNEL_IPV6_DEFS


209 
	sš6_addr


213 
ušt8_t
 
	m__u6_addr8
[16];

214 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_GNU


215 
ušt16_t
 
	m__u6_addr16
[8];

216 
ušt32_t
 
	m__u6_addr32
[4];

218 } 
	m__š6_u
;

219 
	#s6_addr
 
__š6_u
.
__u6_addr8


	)

220 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_GNU


221 
	#s6_addr16
 
__š6_u
.
__u6_addr16


	)

222 
	#s6_addr32
 
__š6_u
.
__u6_addr32


	)

227 cÚ¡ 
š6_addr
 
š6addr_ªy
;

228 cÚ¡ 
š6_addr
 
š6addr_loİback
;

229 
	#IN6ADDR_ANY_INIT
 { { { 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0 } } }

	)

230 
	#IN6ADDR_LOOPBACK_INIT
 { { { 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1 } } }

	)

232 
	#INET_ADDRSTRLEN
 16

	)

233 
	#INET6_ADDRSTRLEN
 46

	)

237 
	ssockaddr_š


239 
__SOCKADDR_COMMON
 (
sš_
);

240 
š_pÜt_t
 
	msš_pÜt
;

241 
š_addr
 
	msš_addr
;

244 
	msš_z”o
[ (
sockaddr
) -

245 
__SOCKADDR_COMMON_SIZE
 -

246  (
š_pÜt_t
) -

247  (
š_addr
)];

250 #iâdeà
__USE_KERNEL_IPV6_DEFS


252 
	ssockaddr_š6


254 
__SOCKADDR_COMMON
 (
sš6_
);

255 
š_pÜt_t
 
	msš6_pÜt
;

256 
ušt32_t
 
	msš6_æowšfo
;

257 
š6_addr
 
	msš6_addr
;

258 
ušt32_t
 
	msš6_scİe_id
;

262 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_GNU


264 
	s_m»q


267 
š_addr
 
	mimr_muÉŸddr
;

270 
š_addr
 
	mimr_š‹rçû
;

273 
	s_m»q_sourû


276 
š_addr
 
	mimr_muÉŸddr
;

279 
š_addr
 
	mimr_š‹rçû
;

282 
š_addr
 
	mimr_sourûaddr
;

286 #iâdeà
__USE_KERNEL_IPV6_DEFS


288 
	sv6_m»q


291 
š6_addr
 
	mv6mr_muÉŸddr
;

294 
	mv6mr_š‹rçû
;

298 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_GNU


300 
	sgroup_»q


303 
ušt32_t
 
	mgr_š‹rçû
;

306 
sockaddr_¡Üage
 
	mgr_group
;

309 
	sgroup_sourû_»q


312 
ušt32_t
 
	mg¤_š‹rçû
;

315 
sockaddr_¡Üage
 
	mg¤_group
;

318 
sockaddr_¡Üage
 
	mg¤_sourû
;

323 
	s_msf‹r


326 
š_addr
 
	mimsf_muÉŸddr
;

329 
š_addr
 
	mimsf_š‹rçû
;

332 
ušt32_t
 
	mimsf_fmode
;

335 
ušt32_t
 
	mimsf_num¤c
;

337 
š_addr
 
	mimsf_¦i¡
[1];

340 
	#IP_MSFILTER_SIZE
(
num¤c
è( (
_msf‹r
) \

341 -  (
š_addr
) \

342 + (
num¤c
è*  (
š_addr
))

	)

344 
	sgroup_f‹r


347 
ušt32_t
 
	mgf_š‹rçû
;

350 
sockaddr_¡Üage
 
	mgf_group
;

353 
ušt32_t
 
	mgf_fmode
;

356 
ušt32_t
 
	mgf_num¤c
;

358 
sockaddr_¡Üage
 
	mgf_¦i¡
[1];

361 
	#GROUP_FILTER_SIZE
(
num¤c
è( (
group_f‹r
) \

362 -  (
sockaddr_¡Üage
) \

363 + ((
num¤c
) \

364 *  (
sockaddr_¡Üage
)))

	)

374 
ušt32_t
 
	$Áohl
 (
ušt32_t
 
__ÃÚg
è
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

375 
ušt16_t
 
	$Áohs
 (
ušt16_t
 
__ÃtshÜt
)

376 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

377 
ušt32_t
 
	$htÚl
 (
ušt32_t
 
__ho¡lÚg
)

378 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

379 
ušt16_t
 
	$htÚs
 (
ušt16_t
 
__ho¡shÜt
)

380 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

382 
	~<’dŸn.h
>

385 
	~<b™s/by‹sw­.h
>

387 #ifdeà
__OPTIMIZE__


391 #ià
__BYTE_ORDER
 =ğ
__BIG_ENDIAN


394 
	#Áohl
(
x
è(x)

	)

395 
	#Áohs
(
x
è(x)

	)

396 
	#htÚl
(
x
è(x)

	)

397 
	#htÚs
(
x
è(x)

	)

399 #ià
__BYTE_ORDER
 =ğ
__LITTLE_ENDIAN


400 
	#Áohl
(
x
è
	`__bsw­_32
 (x)

	)

401 
	#Áohs
(
x
è
	`__bsw­_16
 (x)

	)

402 
	#htÚl
(
x
è
	`__bsw­_32
 (x)

	)

403 
	#htÚs
(
x
è
	`__bsw­_16
 (x)

	)

408 #ifdeà
__GNUC__


409 
	#IN6_IS_ADDR_UNSPECIFIED
(
a
) \

410 (
__ex‹nsiÚ__
 \

411 ({ cÚ¡ 
š6_addr
 *
__a
 = (cÚ¡ š6_add¸*è(
a
); \

412 
__a
->
s6_addr32
[0] == 0 \

413 && 
__a
->
s6_addr32
[1] == 0 \

414 && 
__a
->
s6_addr32
[2] == 0 \

415 && 
__a
->
s6_addr32
[3] =ğ0; 
	}
}))

	)

417 
	#IN6_IS_ADDR_LOOPBACK
(
a
) \

418 (
__ex‹nsiÚ__
 \

419 ({ cÚ¡ 
š6_addr
 *
__a
 = (cÚ¡ š6_add¸*è(
a
); \

420 
__a
->
s6_addr32
[0] == 0 \

421 && 
__a
->
s6_addr32
[1] == 0 \

422 && 
__a
->
s6_addr32
[2] == 0 \

423 && 
__a
->
s6_addr32
[3] =ğ
	`htÚl
 (1); }))

	)

425 
	#IN6_IS_ADDR_LINKLOCAL
(
a
) \

426 (
__ex‹nsiÚ__
 \

427 ({ cÚ¡ 
š6_addr
 *
__a
 = (cÚ¡ š6_add¸*è(
a
); \

428 (
__a
->
s6_addr32
[0] & 
	`htÚl
 (0xffc00000)è=ğhtÚÈ(0xã800000); }))

	)

430 
	#IN6_IS_ADDR_SITELOCAL
(
a
) \

431 (
__ex‹nsiÚ__
 \

432 ({ cÚ¡ 
š6_addr
 *
__a
 = (cÚ¡ š6_add¸*è(
a
); \

433 (
__a
->
s6_addr32
[0] & 
	`htÚl
 (0xffc00000)è=ğhtÚÈ(0xãc00000); }))

	)

435 
	#IN6_IS_ADDR_V4MAPPED
(
a
) \

436 (
__ex‹nsiÚ__
 \

437 ({ cÚ¡ 
š6_addr
 *
__a
 = (cÚ¡ š6_add¸*è(
a
); \

438 
__a
->
s6_addr32
[0] == 0 \

439 && 
__a
->
s6_addr32
[1] == 0 \

440 && 
__a
->
s6_addr32
[2] =ğ
	`htÚl
 (0xffff); }))

	)

442 
	#IN6_IS_ADDR_V4COMPAT
(
a
) \

443 (
__ex‹nsiÚ__
 \

444 ({ cÚ¡ 
š6_addr
 *
__a
 = (cÚ¡ š6_add¸*è(
a
); \

445 
__a
->
s6_addr32
[0] == 0 \

446 && 
__a
->
s6_addr32
[1] == 0 \

447 && 
__a
->
s6_addr32
[2] == 0 \

448 && 
	`Áohl
 (
__a
->
s6_addr32
[3]è> 1; }))

	)

450 
	#IN6_ARE_ADDR_EQUAL
(
a
,
b
) \

451 (
__ex‹nsiÚ__
 \

452 ({ cÚ¡ 
š6_addr
 *
__a
 = (cÚ¡ š6_add¸*è(
a
); \

453 cÚ¡ 
š6_addr
 *
__b
 = (cÚ¡ š6_add¸*è(
b
); \

454 
__a
->
s6_addr32
[0] =ğ
__b
->s6_addr32[0] \

455 && 
__a
->
s6_addr32
[1] =ğ
__b
->s6_addr32[1] \

456 && 
__a
->
s6_addr32
[2] =ğ
__b
->s6_addr32[2] \

457 && 
__a
->
s6_addr32
[3] =ğ
__b
->s6_addr32[3]; }))

	)

459 
	#IN6_IS_ADDR_UNSPECIFIED
(
a
) \

460 (((cÚ¡ 
ušt32_t
 *è(
a
))[0] == 0 \

461 && ((cÚ¡ 
ušt32_t
 *è(
a
))[1] == 0 \

462 && ((cÚ¡ 
ušt32_t
 *è(
a
))[2] == 0 \

463 && ((cÚ¡ 
ušt32_t
 *è(
a
))[3] =ğ0)

	)

465 
	#IN6_IS_ADDR_LOOPBACK
(
a
) \

466 (((cÚ¡ 
ušt32_t
 *è(
a
))[0] == 0 \

467 && ((cÚ¡ 
ušt32_t
 *è(
a
))[1] == 0 \

468 && ((cÚ¡ 
ušt32_t
 *è(
a
))[2] == 0 \

469 && ((cÚ¡ 
ušt32_t
 *è(
a
))[3] =ğ
	`htÚl
 (1))

	)

471 
	#IN6_IS_ADDR_LINKLOCAL
(
a
) \

472 ((((cÚ¡ 
ušt32_t
 *è(
a
))[0] & 
	`htÚl
 (0xffc00000)) \

473 =ğ
	`htÚl
 (0xã800000))

	)

475 
	#IN6_IS_ADDR_SITELOCAL
(
a
) \

476 ((((cÚ¡ 
ušt32_t
 *è(
a
))[0] & 
	`htÚl
 (0xffc00000)) \

477 =ğ
	`htÚl
 (0xãc00000))

	)

479 
	#IN6_IS_ADDR_V4MAPPED
(
a
) \

480 ((((cÚ¡ 
ušt32_t
 *è(
a
))[0] == 0) \

481 && (((cÚ¡ 
ušt32_t
 *è(
a
))[1] == 0) \

482 && (((cÚ¡ 
ušt32_t
 *è(
a
))[2] =ğ
	`htÚl
 (0xffff)))

	)

484 
	#IN6_IS_ADDR_V4COMPAT
(
a
) \

485 ((((cÚ¡ 
ušt32_t
 *è(
a
))[0] == 0) \

486 && (((cÚ¡ 
ušt32_t
 *è(
a
))[1] == 0) \

487 && (((cÚ¡ 
ušt32_t
 *è(
a
))[2] == 0) \

488 && (
	`Áohl
 (((cÚ¡ 
ušt32_t
 *è(
a
))[3]è> 1))

	)

490 
	#IN6_ARE_ADDR_EQUAL
(
a
,
b
) \

491 ((((cÚ¡ 
ušt32_t
 *è(
a
))[0] =ğ((cÚ¡ ušt32_ˆ*è(
b
))[0]) \

492 && (((cÚ¡ 
ušt32_t
 *è(
a
))[1] =ğ((cÚ¡ ušt32_ˆ*è(
b
))[1]) \

493 && (((cÚ¡ 
ušt32_t
 *è(
a
))[2] =ğ((cÚ¡ ušt32_ˆ*è(
b
))[2]) \

494 && (((cÚ¡ 
ušt32_t
 *è(
a
))[3] =ğ((cÚ¡ ušt32_ˆ*è(
b
))[3]))

	)

497 
	#IN6_IS_ADDR_MULTICAST
(
a
è(((cÚ¡ 
ušt8_t
 *è×))[0] =ğ0xff)

	)

499 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_GNU


501 
	$bšd»svpÜt
 (
__sockfd
, 
sockaddr_š
 *
__sock_š
è
__THROW
;

504 
	$bšd»svpÜt6
 (
__sockfd
, 
sockaddr_š6
 *
__sock_š
)

505 
__THROW
;

509 
	#IN6_IS_ADDR_MC_NODELOCAL
(
a
) \

510 (
	`IN6_IS_ADDR_MULTICAST
(
a
) \

511 && ((((cÚ¡ 
ušt8_t
 *è(
a
))[1] & 0xfè=ğ0x1))

	)

513 
	#IN6_IS_ADDR_MC_LINKLOCAL
(
a
) \

514 (
	`IN6_IS_ADDR_MULTICAST
(
a
) \

515 && ((((cÚ¡ 
ušt8_t
 *è(
a
))[1] & 0xfè=ğ0x2))

	)

517 
	#IN6_IS_ADDR_MC_SITELOCAL
(
a
) \

518 (
	`IN6_IS_ADDR_MULTICAST
(
a
) \

519 && ((((cÚ¡ 
ušt8_t
 *è(
a
))[1] & 0xfè=ğ0x5))

	)

521 
	#IN6_IS_ADDR_MC_ORGLOCAL
(
a
) \

522 (
	`IN6_IS_ADDR_MULTICAST
(
a
) \

523 && ((((cÚ¡ 
ušt8_t
 *è(
a
))[1] & 0xfè=ğ0x8))

	)

525 
	#IN6_IS_ADDR_MC_GLOBAL
(
a
) \

526 (
	`IN6_IS_ADDR_MULTICAST
(
a
) \

527 && ((((cÚ¡ 
ušt8_t
 *è(
a
))[1] & 0xfè=ğ0xe))

	)

530 #ifdeà
__USE_GNU


531 
cmsghdr
;

534 
	sš6_pktšfo


536 
š6_addr
 
i6_addr
;

537 
i6_ifšdex
;

541 
	s6_mtušfo


543 
sockaddr_š6
 
6m_addr
;

544 
ušt32_t
 
6m_mtu
;

549 
	$š‘6_İtiÚ_¥aû
 (
__nby‹s
)

550 
__THROW
 
__©Œibu‹_d•»ÿ‹d__
;

551 
	$š‘6_İtiÚ_š™
 (*
__bp
, 
cmsghdr
 **
__cmsgp
,

552 
__ty³
è
__THROW
 
__©Œibu‹_d•»ÿ‹d__
;

553 
	$š‘6_İtiÚ_­³nd
 (
cmsghdr
 *
__cmsg
,

554 cÚ¡ 
ušt8_t
 *
__ty³p
, 
__muÉx
,

555 
__¶usy
è
__THROW
 
__©Œibu‹_d•»ÿ‹d__
;

556 
ušt8_t
 *
	$š‘6_İtiÚ_®loc
 (
cmsghdr
 *
__cmsg
, 
__d©®’
,

557 
__muÉx
, 
__¶usy
)

558 
__THROW
 
__©Œibu‹_d•»ÿ‹d__
;

559 
	$š‘6_İtiÚ_Ãxt
 (cÚ¡ 
cmsghdr
 *
__cmsg
,

560 
ušt8_t
 **
__Œp
)

561 
__THROW
 
__©Œibu‹_d•»ÿ‹d__
;

562 
	$š‘6_İtiÚ_fšd
 (cÚ¡ 
cmsghdr
 *
__cmsg
,

563 
ušt8_t
 **
__Œp
, 
__ty³
)

564 
__THROW
 
__©Œibu‹_d•»ÿ‹d__
;

568 
	$š‘6_İt_š™
 (*
__extbuf
, 
sockËn_t
 
__ex’
è
__THROW
;

569 
	$š‘6_İt_­³nd
 (*
__extbuf
, 
sockËn_t
 
__ex’
, 
__off£t
,

570 
ušt8_t
 
__ty³
, 
sockËn_t
 
__Ën
, ušt8_ˆ
__®ign
,

571 **
__d©abuå
è
__THROW
;

572 
	$š‘6_İt_fšish
 (*
__extbuf
, 
sockËn_t
 
__ex’
, 
__off£t
)

573 
__THROW
;

574 
	$š‘6_İt_£t_v®
 (*
__d©abuf
, 
__off£t
, *
__v®
,

575 
sockËn_t
 
__v®Ën
è
__THROW
;

576 
	$š‘6_İt_Ãxt
 (*
__extbuf
, 
sockËn_t
 
__ex’
, 
__off£t
,

577 
ušt8_t
 *
__ty³p
, 
sockËn_t
 *
__ËÅ
,

578 **
__d©abuå
è
__THROW
;

579 
	$š‘6_İt_fšd
 (*
__extbuf
, 
sockËn_t
 
__ex’
, 
__off£t
,

580 
ušt8_t
 
__ty³
, 
sockËn_t
 *
__ËÅ
,

581 **
__d©abuå
è
__THROW
;

582 
	$š‘6_İt_g‘_v®
 (*
__d©abuf
, 
__off£t
, *
__v®
,

583 
sockËn_t
 
__v®Ën
è
__THROW
;

587 
sockËn_t
 
	$š‘6_¹h_¥aû
 (
__ty³
, 
__£gm’ts
è
__THROW
;

588 *
	$š‘6_¹h_š™
 (*
__bp
, 
sockËn_t
 
__bp_Ën
, 
__ty³
,

589 
__£gm’ts
è
__THROW
;

590 
	$š‘6_¹h_add
 (*
__bp
, cÚ¡ 
š6_addr
 *
__addr
è
__THROW
;

591 
	$š‘6_¹h_»v”£
 (cÚ¡ *
__š
, *
__out
è
__THROW
;

592 
	$š‘6_¹h_£gm’ts
 (cÚ¡ *
__bp
è
__THROW
;

593 
š6_addr
 *
	$š‘6_¹h_g‘addr
 (cÚ¡ *
__bp
, 
__šdex
)

594 
__THROW
;

600 
	$g‘v4sourûf‹r
 (
__s
, 
š_addr
 
__š‹rçû_addr
,

601 
š_addr
 
__group
, 
ušt32_t
 *
__fmode
,

602 
ušt32_t
 *
__num¤c
, 
š_addr
 *
__¦i¡
)

603 
__THROW
;

606 
	$£tv4sourûf‹r
 (
__s
, 
š_addr
 
__š‹rçû_addr
,

607 
š_addr
 
__group
, 
ušt32_t
 
__fmode
,

608 
ušt32_t
 
__num¤c
,

609 cÚ¡ 
š_addr
 *
__¦i¡
)

610 
__THROW
;

614 
	$g‘sourûf‹r
 (
__s
, 
ušt32_t
 
__š‹rçû_addr
,

615 cÚ¡ 
sockaddr
 *
__group
,

616 
sockËn_t
 
__grou¶’
, 
ušt32_t
 *
__fmode
,

617 
ušt32_t
 *
__num¤c
,

618 
sockaddr_¡Üage
 *
__¦i¡
è
__THROW
;

621 
	$£tsourûf‹r
 (
__s
, 
ušt32_t
 
__š‹rçû_addr
,

622 cÚ¡ 
sockaddr
 *
__group
,

623 
sockËn_t
 
__grou¶’
, 
ušt32_t
 
__fmode
,

624 
ušt32_t
 
__num¤c
,

625 cÚ¡ 
sockaddr_¡Üage
 *
__¦i¡
è
__THROW
;

628 
__END_DECLS


	@/usr/include/netinet/tcp.h

32 #iâdeà
_NETINET_TCP_H


33 
	#_NETINET_TCP_H
 1

	)

35 
	~<ã©u»s.h
>

40 
	#TCP_NODELAY
 1

	)

41 
	#TCP_MAXSEG
 2

	)

42 
	#TCP_CORK
 3

	)

43 
	#TCP_KEEPIDLE
 4

	)

44 
	#TCP_KEEPINTVL
 5

	)

45 
	#TCP_KEEPCNT
 6

	)

46 
	#TCP_SYNCNT
 7

	)

47 
	#TCP_LINGER2
 8

	)

48 
	#TCP_DEFER_ACCEPT
 9

	)

49 
	#TCP_WINDOW_CLAMP
 10

	)

50 
	#TCP_INFO
 11

	)

51 
	#TCP_QUICKACK
 12

	)

52 
	#TCP_CONGESTION
 13

	)

53 
	#TCP_MD5SIG
 14

	)

54 
	#TCP_COOKIE_TRANSACTIONS
 15

	)

55 
	#TCP_THIN_LINEAR_TIMEOUTS
 16

	)

56 
	#TCP_THIN_DUPACK
 17

	)

57 
	#TCP_USER_TIMEOUT
 18

	)

58 
	#TCP_REPAIR
 19

	)

59 
	#TCP_REPAIR_QUEUE
 20

	)

60 
	#TCP_QUEUE_SEQ
 21

	)

61 
	#TCP_REPAIR_OPTIONS
 22

	)

62 
	#TCP_FASTOPEN
 23

	)

63 
	#TCP_TIMESTAMP
 24

	)

65 #ifdeà
__USE_MISC


66 
	~<sys/ty³s.h
>

67 
	~<sys/sock‘.h
>

69 
u_št32_t
 
	ttı_£q
;

74 
	stıhdr


76 
__ex‹nsiÚ__
 union

80 
u_št16_t
 
	mth_¥Üt
;

81 
u_št16_t
 
	mth_dpÜt
;

82 
tı_£q
 
	mth_£q
;

83 
tı_£q
 
	mth_ack
;

84 #ià
__BYTE_ORDER
 =ğ
__LITTLE_ENDIAN


85 
u_št8_t
 
	mth_x2
:4;

86 
u_št8_t
 
	mth_off
:4;

88 #ià
__BYTE_ORDER
 =ğ
__BIG_ENDIAN


89 
u_št8_t
 
	mth_off
:4;

90 
u_št8_t
 
	mth_x2
:4;

92 
u_št8_t
 
	mth_æags
;

93 
	#TH_FIN
 0x01

	)

94 
	#TH_SYN
 0x02

	)

95 
	#TH_RST
 0x04

	)

96 
	#TH_PUSH
 0x08

	)

97 
	#TH_ACK
 0x10

	)

98 
	#TH_URG
 0x20

	)

99 
u_št16_t
 
	mth_wš
;

100 
u_št16_t
 
	mth_sum
;

101 
u_št16_t
 
	mth_u½
;

105 
u_št16_t
 
	msourû
;

106 
u_št16_t
 
	mde¡
;

107 
u_št32_t
 
	m£q
;

108 
u_št32_t
 
	mack_£q
;

109 #ià
__BYTE_ORDER
 =ğ
__LITTLE_ENDIAN


110 
u_št16_t
 
	m»s1
:4;

111 
u_št16_t
 
	mdoff
:4;

112 
u_št16_t
 
	mfš
:1;

113 
u_št16_t
 
	msyn
:1;

114 
u_št16_t
 
	mr¡
:1;

115 
u_št16_t
 
	mpsh
:1;

116 
u_št16_t
 
	mack
:1;

117 
u_št16_t
 
	murg
:1;

118 
u_št16_t
 
	m»s2
:2;

119 #–ià
__BYTE_ORDER
 =ğ
__BIG_ENDIAN


120 
u_št16_t
 
	mdoff
:4;

121 
u_št16_t
 
	m»s1
:4;

122 
u_št16_t
 
	m»s2
:2;

123 
u_št16_t
 
	murg
:1;

124 
u_št16_t
 
	mack
:1;

125 
u_št16_t
 
	mpsh
:1;

126 
u_št16_t
 
	mr¡
:1;

127 
u_št16_t
 
	msyn
:1;

128 
u_št16_t
 
	mfš
:1;

132 
u_št16_t
 
	mwšdow
;

133 
u_št16_t
 
	mcheck
;

134 
u_št16_t
 
	murg_±r
;

141 
	mTCP_ESTABLISHED
 = 1,

142 
	mTCP_SYN_SENT
,

143 
	mTCP_SYN_RECV
,

144 
	mTCP_FIN_WAIT1
,

145 
	mTCP_FIN_WAIT2
,

146 
	mTCP_TIME_WAIT
,

147 
	mTCP_CLOSE
,

148 
	mTCP_CLOSE_WAIT
,

149 
	mTCP_LAST_ACK
,

150 
	mTCP_LISTEN
,

151 
	mTCP_CLOSING


154 
	#TCPOPT_EOL
 0

	)

155 
	#TCPOPT_NOP
 1

	)

156 
	#TCPOPT_MAXSEG
 2

	)

157 
	#TCPOLEN_MAXSEG
 4

	)

158 
	#TCPOPT_WINDOW
 3

	)

159 
	#TCPOLEN_WINDOW
 3

	)

160 
	#TCPOPT_SACK_PERMITTED
 4

	)

161 
	#TCPOLEN_SACK_PERMITTED
 2

	)

162 
	#TCPOPT_SACK
 5

	)

163 
	#TCPOPT_TIMESTAMP
 8

	)

164 
	#TCPOLEN_TIMESTAMP
 10

	)

165 
	#TCPOLEN_TSTAMP_APPA
 (
TCPOLEN_TIMESTAMP
+2è

	)

167 
	#TCPOPT_TSTAMP_HDR
 \

168 (
TCPOPT_NOP
<<24|TCPOPT_NOP<<16|
TCPOPT_TIMESTAMP
<<8|
TCPOLEN_TIMESTAMP
)

	)

176 
	#TCP_MSS
 512

	)

178 
	#TCP_MAXWIN
 65535

	)

180 
	#TCP_MAX_WINSHIFT
 14

	)

182 
	#SOL_TCP
 6

	)

185 
	#TCPI_OPT_TIMESTAMPS
 1

	)

186 
	#TCPI_OPT_SACK
 2

	)

187 
	#TCPI_OPT_WSCALE
 4

	)

188 
	#TCPI_OPT_ECN
 8

	)

189 
	#TCPI_OPT_ECN_SEEN
 16

	)

190 
	#TCPI_OPT_SYN_DATA
 32

	)

193 
	etı_ÿ_¡©e


195 
	mTCP_CA_O³n
 = 0,

196 
	mTCP_CA_DisÜd”
 = 1,

197 
	mTCP_CA_CWR
 = 2,

198 
	mTCP_CA_Recov”y
 = 3,

199 
	mTCP_CA_Loss
 = 4

202 
	stı_šfo


204 
u_št8_t
 
	mtıi_¡©e
;

205 
u_št8_t
 
	mtıi_ÿ_¡©e
;

206 
u_št8_t
 
	mtıi_»Œªsm™s
;

207 
u_št8_t
 
	mtıi_´obes
;

208 
u_št8_t
 
	mtıi_backoff
;

209 
u_št8_t
 
	mtıi_İtiÚs
;

210 
u_št8_t
 
	mtıi_¢d_wsÿË
 : 4, 
	mtıi_rcv_wsÿË
 : 4;

212 
u_št32_t
 
	mtıi_¹o
;

213 
u_št32_t
 
	mtıi_©o
;

214 
u_št32_t
 
	mtıi_¢d_mss
;

215 
u_št32_t
 
	mtıi_rcv_mss
;

217 
u_št32_t
 
	mtıi_uÇcked
;

218 
u_št32_t
 
	mtıi_§cked
;

219 
u_št32_t
 
	mtıi_lo¡
;

220 
u_št32_t
 
	mtıi_»Œªs
;

221 
u_št32_t
 
	mtıi_çck‘s
;

224 
u_št32_t
 
	mtıi_Ï¡_d©a_£Á
;

225 
u_št32_t
 
	mtıi_Ï¡_ack_£Á
;

226 
u_št32_t
 
	mtıi_Ï¡_d©a_»cv
;

227 
u_št32_t
 
	mtıi_Ï¡_ack_»cv
;

230 
u_št32_t
 
	mtıi_pmtu
;

231 
u_št32_t
 
	mtıi_rcv_s¡h»sh
;

232 
u_št32_t
 
	mtıi_¹t
;

233 
u_št32_t
 
	mtıi_¹tv¬
;

234 
u_št32_t
 
	mtıi_¢d_s¡h»sh
;

235 
u_št32_t
 
	mtıi_¢d_cwnd
;

236 
u_št32_t
 
	mtıi_advmss
;

237 
u_št32_t
 
	mtıi_»Üd”šg
;

239 
u_št32_t
 
	mtıi_rcv_¹t
;

240 
u_št32_t
 
	mtıi_rcv_¥aû
;

242 
u_št32_t
 
	mtıi_tÙ®_»Œªs
;

247 
	#TCP_MD5SIG_MAXKEYLEN
 80

	)

249 
	stı_md5sig


251 
sockaddr_¡Üage
 
	mtım_addr
;

252 
u_št16_t
 
	m__tım_·d1
;

253 
u_št16_t
 
	mtım_keyËn
;

254 
u_št32_t
 
	m__tım_·d2
;

255 
u_št8_t
 
	mtım_key
[
TCP_MD5SIG_MAXKEYLEN
];

259 
	stı_»·œ_İt


261 
u_št32_t
 
	mİt_code
;

262 
u_št32_t
 
	mİt_v®
;

268 
	mTCP_NO_QUEUE
,

269 
	mTCP_RECV_QUEUE
,

270 
	mTCP_SEND_QUEUE
,

271 
	mTCP_QUEUES_NR
,

275 
	#TCP_COOKIE_MIN
 8

	)

276 
	#TCP_COOKIE_MAX
 16

	)

277 
	#TCP_COOKIE_PAIR_SIZE
 (2*
TCP_COOKIE_MAX
)

	)

280 
	#TCP_COOKIE_IN_ALWAYS
 (1 << 0è

	)

281 
	#TCP_COOKIE_OUT_NEVER
 (1 << 1è

	)

285 
	#TCP_S_DATA_IN
 (1 << 2è

	)

286 
	#TCP_S_DATA_OUT
 (1 << 3è

	)

288 
	#TCP_MSS_DEFAULT
 536U

	)

289 
	#TCP_MSS_DESIRED
 1220U

	)

291 
	stı_cook›_Œª§ùiÚs


293 
u_št16_t
 
	mtıù_æags
;

294 
u_št8_t
 
	m__tıù_·d1
;

295 
u_št8_t
 
	mtıù_cook›_desœed
;

296 
u_št16_t
 
	mtıù_s_d©a_desœed
;

297 
u_št16_t
 
	mtıù_u£d
;

298 
u_št8_t
 
	mtıù_v®ue
[
TCP_MSS_DEFAULT
];

	@/usr/include/pthread.h

18 #iâdeà
_PTHREAD_H


19 
	#_PTHREAD_H
 1

	)

21 
	~<ã©u»s.h
>

22 
	~<’dŸn.h
>

23 
	~<sched.h
>

24 
	~<time.h
>

26 
	~<b™s/±h»adty³s.h
>

27 
	~<b™s/£tjmp.h
>

28 
	~<b™s/wÜdsize.h
>

34 
	mPTHREAD_CREATE_JOINABLE
,

35 
	#PTHREAD_CREATE_JOINABLE
 
PTHREAD_CREATE_JOINABLE


	)

36 
	mPTHREAD_CREATE_DETACHED


37 
	#PTHREAD_CREATE_DETACHED
 
PTHREAD_CREATE_DETACHED


	)

44 
	mPTHREAD_MUTEX_TIMED_NP
,

45 
	mPTHREAD_MUTEX_RECURSIVE_NP
,

46 
	mPTHREAD_MUTEX_ERRORCHECK_NP
,

47 
	mPTHREAD_MUTEX_ADAPTIVE_NP


48 #ià
defšed
 
__USE_UNIX98
 || defšed 
__USE_XOPEN2K8


50 
	mPTHREAD_MUTEX_NORMAL
 = 
PTHREAD_MUTEX_TIMED_NP
,

51 
	mPTHREAD_MUTEX_RECURSIVE
 = 
PTHREAD_MUTEX_RECURSIVE_NP
,

52 
	mPTHREAD_MUTEX_ERRORCHECK
 = 
PTHREAD_MUTEX_ERRORCHECK_NP
,

53 
	mPTHREAD_MUTEX_DEFAULT
 = 
PTHREAD_MUTEX_NORMAL


55 #ifdeà
__USE_GNU


57 , 
	mPTHREAD_MUTEX_FAST_NP
 = 
PTHREAD_MUTEX_TIMED_NP


62 #ifdeà
__USE_XOPEN2K


66 
	mPTHREAD_MUTEX_STALLED
,

67 
	mPTHREAD_MUTEX_STALLED_NP
 = 
PTHREAD_MUTEX_STALLED
,

68 
	mPTHREAD_MUTEX_ROBUST
,

69 
	mPTHREAD_MUTEX_ROBUST_NP
 = 
PTHREAD_MUTEX_ROBUST


74 #ià
defšed
 
__USE_POSIX199506
 || defšed 
__USE_UNIX98


78 
	mPTHREAD_PRIO_NONE
,

79 
	mPTHREAD_PRIO_INHERIT
,

80 
	mPTHREAD_PRIO_PROTECT


86 #ià
__PTHREAD_MUTEX_HAVE_ELISION
 == 1

87 
	#__PTHREAD_SPINS
 0, 0

	)

88 #–ià
__PTHREAD_MUTEX_HAVE_ELISION
 == 2

89 
	#__PTHREAD_SPINS
 { 0, 0 }

	)

91 
	#__PTHREAD_SPINS
 0

	)

94 #ifdeà
__PTHREAD_MUTEX_HAVE_PREV


95 
	#PTHREAD_MUTEX_INITIALIZER
 \

96 { { 0, 0, 0, 0, 0, 
__PTHREAD_SPINS
, { 0, 0 } } }

	)

97 #ifdeà
__USE_GNU


98 
	#PTHREAD_RECURSIVE_MUTEX_INITIALIZER_NP
 \

99 { { 0, 0, 0, 0, 
PTHREAD_MUTEX_RECURSIVE_NP
, 
__PTHREAD_SPINS
, { 0, 0 } } }

	)

100 
	#PTHREAD_ERRORCHECK_MUTEX_INITIALIZER_NP
 \

101 { { 0, 0, 0, 0, 
PTHREAD_MUTEX_ERRORCHECK_NP
, 
__PTHREAD_SPINS
, { 0, 0 } } }

	)

102 
	#PTHREAD_ADAPTIVE_MUTEX_INITIALIZER_NP
 \

103 { { 0, 0, 0, 0, 
PTHREAD_MUTEX_ADAPTIVE_NP
, 
__PTHREAD_SPINS
, { 0, 0 } } }

	)

104 
	#PTHREAD_ADAPTIVE_MUTEX_INITIALIZER_NP
 \

105 { { 0, 0, 0, 0, 
PTHREAD_MUTEX_ADAPTIVE_NP
, 
__PTHREAD_SPINS
, { 0, 0 } } }

	)

109 
	#PTHREAD_MUTEX_INITIALIZER
 \

110 { { 0, 0, 0, 0, 0, { 
__PTHREAD_SPINS
 } } }

	)

111 #ifdeà
__USE_GNU


112 
	#PTHREAD_RECURSIVE_MUTEX_INITIALIZER_NP
 \

113 { { 0, 0, 0, 
PTHREAD_MUTEX_RECURSIVE_NP
, 0, { 
__PTHREAD_SPINS
 } } }

	)

114 
	#PTHREAD_ERRORCHECK_MUTEX_INITIALIZER_NP
 \

115 { { 0, 0, 0, 
PTHREAD_MUTEX_ERRORCHECK_NP
, 0, { 
__PTHREAD_SPINS
 } } }

	)

116 
	#PTHREAD_ADAPTIVE_MUTEX_INITIALIZER_NP
 \

117 { { 0, 0, 0, 
PTHREAD_MUTEX_ADAPTIVE_NP
, 0, { 
__PTHREAD_SPINS
 } } }

	)

124 #ià
defšed
 
__USE_UNIX98
 || defšed 
__USE_XOPEN2K


127 
	mPTHREAD_RWLOCK_PREFER_READER_NP
,

128 
	mPTHREAD_RWLOCK_PREFER_WRITER_NP
,

129 
	mPTHREAD_RWLOCK_PREFER_WRITER_NONRECURSIVE_NP
,

130 
	mPTHREAD_RWLOCK_DEFAULT_NP
 = 
PTHREAD_RWLOCK_PREFER_READER_NP


136 #iâdeà
__PTHREAD_RWLOCK_INT_FLAGS_SHARED


137 #ià
__WORDSIZE
 == 64

138 
	#__PTHREAD_RWLOCK_INT_FLAGS_SHARED
 1

	)

143 
	#PTHREAD_RWLOCK_INITIALIZER
 \

144 { { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 } }

	)

145 #ifdeà
__USE_GNU


146 #ifdeà
__PTHREAD_RWLOCK_INT_FLAGS_SHARED


147 
	#PTHREAD_RWLOCK_WRITER_NONRECURSIVE_INITIALIZER_NP
 \

149 
PTHREAD_RWLOCK_PREFER_WRITER_NONRECURSIVE_NP
 } }

	)

151 #ià
__BYTE_ORDER
 =ğ
__LITTLE_ENDIAN


152 
	#PTHREAD_RWLOCK_WRITER_NONRECURSIVE_INITIALIZER_NP
 \

153 { { 0, 0, 0, 0, 0, 0, 
PTHREAD_RWLOCK_PREFER_WRITER_NONRECURSIVE_NP
, \

154 0, 0, 0, 0 } }

	)

156 
	#PTHREAD_RWLOCK_WRITER_NONRECURSIVE_INITIALIZER_NP
 \

157 { { 0, 0, 0, 0, 0, 0, 0, 0, 0, 
PTHREAD_RWLOCK_PREFER_WRITER_NONRECURSIVE_NP
,\

158 0 } }

	)

168 
	mPTHREAD_INHERIT_SCHED
,

169 
	#PTHREAD_INHERIT_SCHED
 
PTHREAD_INHERIT_SCHED


	)

170 
	mPTHREAD_EXPLICIT_SCHED


171 
	#PTHREAD_EXPLICIT_SCHED
 
PTHREAD_EXPLICIT_SCHED


	)

178 
	mPTHREAD_SCOPE_SYSTEM
,

179 
	#PTHREAD_SCOPE_SYSTEM
 
PTHREAD_SCOPE_SYSTEM


	)

180 
	mPTHREAD_SCOPE_PROCESS


181 
	#PTHREAD_SCOPE_PROCESS
 
PTHREAD_SCOPE_PROCESS


	)

188 
	mPTHREAD_PROCESS_PRIVATE
,

189 
	#PTHREAD_PROCESS_PRIVATE
 
PTHREAD_PROCESS_PRIVATE


	)

190 
	mPTHREAD_PROCESS_SHARED


191 
	#PTHREAD_PROCESS_SHARED
 
PTHREAD_PROCESS_SHARED


	)

197 
	#PTHREAD_COND_INITIALIZER
 { { 0, 0, 0, 0, 0, (*è0, 0, 0 } }

	)

201 
	s_±h»ad_ş—nup_bufãr


203 (*
	m__routše
) (*);

204 *
	m__¬g
;

205 
	m__ÿnûÉy³
;

206 
_±h»ad_ş—nup_bufãr
 *
	m__´ev
;

212 
	mPTHREAD_CANCEL_ENABLE
,

213 
	#PTHREAD_CANCEL_ENABLE
 
PTHREAD_CANCEL_ENABLE


	)

214 
	mPTHREAD_CANCEL_DISABLE


215 
	#PTHREAD_CANCEL_DISABLE
 
PTHREAD_CANCEL_DISABLE


	)

219 
	mPTHREAD_CANCEL_DEFERRED
,

220 
	#PTHREAD_CANCEL_DEFERRED
 
PTHREAD_CANCEL_DEFERRED


	)

221 
	mPTHREAD_CANCEL_ASYNCHRONOUS


222 
	#PTHREAD_CANCEL_ASYNCHRONOUS
 
PTHREAD_CANCEL_ASYNCHRONOUS


	)

224 
	#PTHREAD_CANCELED
 ((*è-1)

	)

228 
	#PTHREAD_ONCE_INIT
 0

	)

231 #ifdeà
__USE_XOPEN2K


235 
	#PTHREAD_BARRIER_SERIAL_THREAD
 -1

	)

239 
__BEGIN_DECLS


244 
±h»ad_ü—‹
 (
±h»ad_t
 *
__»¡riù
 
__Ãwth»ad
,

245 cÚ¡ 
±h»ad_©Œ_t
 *
__»¡riù
 
__©Œ
,

246 *(*
__¡¬t_routše
) (*),

247 *
__»¡riù
 
__¬g
è
__THROWNL
 
__nÚnuÎ
 ((1, 3));

253 
	$±h»ad_ex™
 (*
__»tv®
è
	`__©Œibu‹__
 ((
__nÜ‘uº__
));

261 
	`±h»ad_još
 (
±h»ad_t
 
__th
, **
__th»ad_»tuº
);

263 #ifdeà
__USE_GNU


266 
	$±h»ad_Œyjoš_Å
 (
±h»ad_t
 
__th
, **
__th»ad_»tuº
è
__THROW
;

274 
	`±h»ad_timedjoš_Å
 (
±h»ad_t
 
__th
, **
__th»ad_»tuº
,

275 cÚ¡ 
time¥ec
 *
__ab¡ime
);

282 
	$±h»ad_d‘ach
 (
±h»ad_t
 
__th
è
__THROW
;

286 
±h»ad_t
 
	$±h»ad_£lf
 (è
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

289 
	$±h»ad_equ®
 (
±h»ad_t
 
__th»ad1
,…th»ad_ˆ
__th»ad2
)

290 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

298 
	$±h»ad_©Œ_š™
 (
±h»ad_©Œ_t
 *
__©Œ
è
__THROW
 
	`__nÚnuÎ
 ((1));

301 
	$±h»ad_©Œ_de¡roy
 (
±h»ad_©Œ_t
 *
__©Œ
)

302 
__THROW
 
	`__nÚnuÎ
 ((1));

305 
	$±h»ad_©Œ_g‘d‘ach¡©e
 (cÚ¡ 
±h»ad_©Œ_t
 *
__©Œ
,

306 *
__d‘ach¡©e
)

307 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

310 
	$±h»ad_©Œ_£td‘ach¡©e
 (
±h»ad_©Œ_t
 *
__©Œ
,

311 
__d‘ach¡©e
)

312 
__THROW
 
	`__nÚnuÎ
 ((1));

316 
	$±h»ad_©Œ_g‘gu¬dsize
 (cÚ¡ 
±h»ad_©Œ_t
 *
__©Œ
,

317 
size_t
 *
__gu¬dsize
)

318 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

321 
	$±h»ad_©Œ_£tgu¬dsize
 (
±h»ad_©Œ_t
 *
__©Œ
,

322 
size_t
 
__gu¬dsize
)

323 
__THROW
 
	`__nÚnuÎ
 ((1));

327 
	$±h»ad_©Œ_g‘sched·¿m
 (cÚ¡ 
±h»ad_©Œ_t
 *
__»¡riù
 
__©Œ
,

328 
sched_·¿m
 *
__»¡riù
 
__·¿m
)

329 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

332 
	$±h»ad_©Œ_£tsched·¿m
 (
±h»ad_©Œ_t
 *
__»¡riù
 
__©Œ
,

333 cÚ¡ 
sched_·¿m
 *
__»¡riù


334 
__·¿m
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

337 
	$±h»ad_©Œ_g‘schedpŞicy
 (cÚ¡ 
±h»ad_©Œ_t
 *
__»¡riù


338 
__©Œ
, *
__»¡riù
 
__pŞicy
)

339 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

342 
	$±h»ad_©Œ_£tschedpŞicy
 (
±h»ad_©Œ_t
 *
__©Œ
, 
__pŞicy
)

343 
__THROW
 
	`__nÚnuÎ
 ((1));

346 
	$±h»ad_©Œ_g‘šh”™sched
 (cÚ¡ 
±h»ad_©Œ_t
 *
__»¡riù


347 
__©Œ
, *
__»¡riù
 
__šh”™
)

348 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

351 
	$±h»ad_©Œ_£tšh”™sched
 (
±h»ad_©Œ_t
 *
__©Œ
,

352 
__šh”™
)

353 
__THROW
 
	`__nÚnuÎ
 ((1));

357 
	$±h»ad_©Œ_g‘scİe
 (cÚ¡ 
±h»ad_©Œ_t
 *
__»¡riù
 
__©Œ
,

358 *
__»¡riù
 
__scİe
)

359 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

362 
	$±h»ad_©Œ_£tscİe
 (
±h»ad_©Œ_t
 *
__©Œ
, 
__scİe
)

363 
__THROW
 
	`__nÚnuÎ
 ((1));

366 
	$±h»ad_©Œ_g‘¡ackaddr
 (cÚ¡ 
±h»ad_©Œ_t
 *
__»¡riù


367 
__©Œ
, **
__»¡riù
 
__¡ackaddr
)

368 
__THROW
 
	`__nÚnuÎ
 ((1, 2)è
__©Œibu‹_d•»ÿ‹d__
;

374 
	$±h»ad_©Œ_£t¡ackaddr
 (
±h»ad_©Œ_t
 *
__©Œ
,

375 *
__¡ackaddr
)

376 
__THROW
 
	`__nÚnuÎ
 ((1)è
__©Œibu‹_d•»ÿ‹d__
;

379 
	$±h»ad_©Œ_g‘¡acksize
 (cÚ¡ 
±h»ad_©Œ_t
 *
__»¡riù


380 
__©Œ
, 
size_t
 *
__»¡riù
 
__¡acksize
)

381 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

386 
	$±h»ad_©Œ_£t¡acksize
 (
±h»ad_©Œ_t
 *
__©Œ
,

387 
size_t
 
__¡acksize
)

388 
__THROW
 
	`__nÚnuÎ
 ((1));

390 #ifdeà
__USE_XOPEN2K


392 
	$±h»ad_©Œ_g‘¡ack
 (cÚ¡ 
±h»ad_©Œ_t
 *
__»¡riù
 
__©Œ
,

393 **
__»¡riù
 
__¡ackaddr
,

394 
size_t
 *
__»¡riù
 
__¡acksize
)

395 
__THROW
 
	`__nÚnuÎ
 ((1, 2, 3));

400 
	$±h»ad_©Œ_£t¡ack
 (
±h»ad_©Œ_t
 *
__©Œ
, *
__¡ackaddr
,

401 
size_t
 
__¡acksize
è
__THROW
 
	`__nÚnuÎ
 ((1));

404 #ifdeà
__USE_GNU


407 
	$±h»ad_©Œ_£ffš™y_Å
 (
±h»ad_©Œ_t
 *
__©Œ
,

408 
size_t
 
__ıu£tsize
,

409 cÚ¡ 
ıu_£t_t
 *
__ıu£t
)

410 
__THROW
 
	`__nÚnuÎ
 ((1, 3));

414 
	$±h»ad_©Œ_g‘affš™y_Å
 (cÚ¡ 
±h»ad_©Œ_t
 *
__©Œ
,

415 
size_t
 
__ıu£tsize
,

416 
ıu_£t_t
 *
__ıu£t
)

417 
__THROW
 
	`__nÚnuÎ
 ((1, 3));

420 
	$±h»ad_g‘©Œ_deçuÉ_Å
 (
±h»ad_©Œ_t
 *
__©Œ
)

421 
__THROW
 
	`__nÚnuÎ
 ((1));

425 
	$±h»ad_£‰r_deçuÉ_Å
 (cÚ¡ 
±h»ad_©Œ_t
 *
__©Œ
)

426 
__THROW
 
	`__nÚnuÎ
 ((1));

431 
	$±h»ad_g‘©Œ_Å
 (
±h»ad_t
 
__th
, 
±h»ad_©Œ_t
 *
__©Œ
)

432 
__THROW
 
	`__nÚnuÎ
 ((2));

440 
	$±h»ad_£tsched·¿m
 (
±h»ad_t
 
__rg‘_th»ad
, 
__pŞicy
,

441 cÚ¡ 
sched_·¿m
 *
__·¿m
)

442 
__THROW
 
	`__nÚnuÎ
 ((3));

445 
	$±h»ad_g‘sched·¿m
 (
±h»ad_t
 
__rg‘_th»ad
,

446 *
__»¡riù
 
__pŞicy
,

447 
sched_·¿m
 *
__»¡riù
 
__·¿m
)

448 
__THROW
 
	`__nÚnuÎ
 ((2, 3));

451 
	$±h»ad_£tsched´io
 (
±h»ad_t
 
__rg‘_th»ad
, 
__´io
)

452 
__THROW
;

455 #ifdeà
__USE_GNU


457 
	$±h»ad_g‘Çme_Å
 (
±h»ad_t
 
__rg‘_th»ad
, *
__buf
,

458 
size_t
 
__buæ’
)

459 
__THROW
 
	`__nÚnuÎ
 ((2));

462 
	$±h»ad_£Šame_Å
 (
±h»ad_t
 
__rg‘_th»ad
, cÚ¡ *
__Çme
)

463 
__THROW
 
	`__nÚnuÎ
 ((2));

467 #ifdeà
__USE_UNIX98


469 
	$±h»ad_g‘cÚcu¼’cy
 (è
__THROW
;

472 
	$±h»ad_£tcÚcu¼’cy
 (
__Ëv–
è
__THROW
;

475 #ifdeà
__USE_GNU


480 
	$±h»ad_y›ld
 (è
__THROW
;

485 
	$±h»ad_£ffš™y_Å
 (
±h»ad_t
 
__th
, 
size_t
 
__ıu£tsize
,

486 cÚ¡ 
ıu_£t_t
 *
__ıu£t
)

487 
__THROW
 
	`__nÚnuÎ
 ((3));

490 
	$±h»ad_g‘affš™y_Å
 (
±h»ad_t
 
__th
, 
size_t
 
__ıu£tsize
,

491 
ıu_£t_t
 *
__ıu£t
)

492 
__THROW
 
	`__nÚnuÎ
 ((3));

505 
	`±h»ad_Úû
 (
±h»ad_Úû_t
 *
__Úû_cÚŒŞ
,

506 (*
__š™_routše
è()è
	`__nÚnuÎ
 ((1, 2));

517 
	`±h»ad_£tÿnûl¡©e
 (
__¡©e
, *
__Şd¡©e
);

521 
	`±h»ad_£tÿnûÉy³
 (
__ty³
, *
__Şdty³
);

524 
	`±h»ad_ÿnûl
 (
±h»ad_t
 
__th
);

529 
	`±h»ad_‹¡ÿnûl
 ();

538 
__jmp_buf
 
__ÿnûl_jmp_buf
;

539 
__mask_was_§ved
;

540 } 
__ÿnûl_jmp_buf
[1];

541 *
__·d
[4];

542 } 
	t__±h»ad_unwšd_buf_t
 
	t__©Œibu‹__
 ((
	t__®igÃd__
));

545 #iâdeà
__ş—nup_fù_©Œibu‹


546 
	#__ş—nup_fù_©Œibu‹


	)

551 
	s__±h»ad_ş—nup_äame


553 (*
__ÿnûl_routše
) (*);

554 *
__ÿnûl_¬g
;

555 
__do_™
;

556 
__ÿnûl_ty³
;

559 #ià
defšed
 
__GNUC__
 && defšed 
__EXCEPTIONS


560 #ifdeà
__ılu¥lus


562 şas 
	c__±h»ad_ş—nup_şass


564 (*
__ÿnûl_routše
) (*);

565 *
__ÿnûl_¬g
;

566 
__do_™
;

567 
__ÿnûl_ty³
;

569 
public
:

570 
	`__±h»ad_ş—nup_şass
 ((*
__fù
è(*), *
__¬g
)

571 : 
	`__ÿnûl_routše
 (
__fù
), 
	`__ÿnûl_¬g
 (
__¬g
), 
	$__do_™
 (1) { }

572 ~
	$__±h»ad_ş—nup_şass
 (è{ ià(
__do_™
è
	`__ÿnûl_routše
 (
__ÿnûl_¬g
); 
	}
}

573 
	$__£tdo™
 (
__Ãwv®
è{ 
__do_™
 = __Ãwv®; 
	}
}

574 
	$__deãr
 (è{ 
	`±h»ad_£tÿnûÉy³
 (
PTHREAD_CANCEL_DEFERRED
,

575 &
__ÿnûl_ty³
); 
	}
}

576 
	$__»¡Üe
 (ècÚ¡ { 
	`±h»ad_£tÿnûÉy³
 (
__ÿnûl_ty³
, 0); 
	}
}

586 
	#±h»ad_ş—nup_push
(
routše
, 
¬g
) \

588 
__±h»ad_ş—nup_şass
 
	`__şäame
 (
routše
, 
¬g
)

	)

592 
	#±h»ad_ş—nup_pİ
(
execu‹
) \

593 
__şäame
.
	`__£tdo™
 (
execu‹
); \

594 } 0)

	)

596 #ifdeà
__USE_GNU


600 
	#±h»ad_ş—nup_push_deãr_Å
(
routše
, 
¬g
) \

602 
__±h»ad_ş—nup_şass
 
	`__şäame
 (
routše
, 
¬g
); \

603 
__şäame
.
	`__deãr
 ()

	)

608 
	#±h»ad_ş—nup_pİ_»¡Üe_Å
(
execu‹
) \

609 
__şäame
.
	`__»¡Üe
 (); \

610 
__şäame
.
	`__£tdo™
 (
execu‹
); \

611 } 0)

	)

618 
__ex‹º_šlše
 

619 
	$__±h»ad_ş—nup_routše
 (
__±h»ad_ş—nup_äame
 *
__äame
)

621 ià(
__äame
->
__do_™
)

622 
__äame
->
	`__ÿnûl_routše
 (__äame->
__ÿnûl_¬g
);

623 
	}
}

632 
	#±h»ad_ş—nup_push
(
routše
, 
¬g
) \

634 
__±h»ad_ş—nup_äame
 
__şäame
 \

635 
	`__©Œibu‹__
 ((
	`__ş—nup__
 (
__±h»ad_ş—nup_routše
))) \

636 ğ{ .
__ÿnûl_routše
 = (
routše
), .
__ÿnûl_¬g
 = (
¬g
), \

637 .
__do_™
 = 1 };

	)

641 
	#±h»ad_ş—nup_pİ
(
execu‹
) \

642 
__şäame
.
__do_™
 = (
execu‹
); \

643 } 0)

	)

645 #ifdeà
__USE_GNU


649 
	#±h»ad_ş—nup_push_deãr_Å
(
routše
, 
¬g
) \

651 
__±h»ad_ş—nup_äame
 
__şäame
 \

652 
	`__©Œibu‹__
 ((
	`__ş—nup__
 (
__±h»ad_ş—nup_routše
))) \

653 ğ{ .
__ÿnûl_routše
 = (
routše
), .
__ÿnûl_¬g
 = (
¬g
), \

654 .
__do_™
 = 1 }; \

655 (è
	`±h»ad_£tÿnûÉy³
 (
PTHREAD_CANCEL_DEFERRED
, \

656 &
__şäame
.
__ÿnûl_ty³
)

	)

661 
	#±h»ad_ş—nup_pİ_»¡Üe_Å
(
execu‹
) \

662 (è
	`±h»ad_£tÿnûÉy³
 (
__şäame
.
__ÿnûl_ty³
, 
NULL
); \

663 
__şäame
.
__do_™
 = (
execu‹
); \

664 } 0)

	)

675 
	#±h»ad_ş—nup_push
(
routše
, 
¬g
) \

677 
__±h»ad_unwšd_buf_t
 
__ÿnûl_buf
; \

678 (*
__ÿnûl_routše
è(*èğ(
routše
); \

679 *
__ÿnûl_¬g
 = (
¬g
); \

680 
__nÙ_fœ¡_ÿÎ
 = 
	`__sig£tjmp
 ((
__jmp_buf_g
 *) (*) \

681 
__ÿnûl_buf
.
__ÿnûl_jmp_buf
, 0); \

682 ià(
	`__glibc_uÆik–y
 (
__nÙ_fœ¡_ÿÎ
)) \

684 
	`__ÿnûl_routše
 (
__ÿnûl_¬g
); \

685 
	`__±h»ad_unwšd_Ãxt
 (&
__ÿnûl_buf
); \

689 
	`__±h»ad_»gi¡”_ÿnûl
 (&
__ÿnûl_buf
); \

690 dØ{

	)

691 
__±h»ad_»gi¡”_ÿnûl
 (
__±h»ad_unwšd_buf_t
 *
__buf
)

692 
__ş—nup_fù_©Œibu‹
;

696 
	#±h»ad_ş—nup_pİ
(
execu‹
) \

699 
	`__±h»ad_uÄegi¡”_ÿnûl
 (&
__ÿnûl_buf
); \

700 ià(
execu‹
) \

701 
	`__ÿnûl_routše
 (
__ÿnûl_¬g
); \

702 } 0)

	)

703 
	$__±h»ad_uÄegi¡”_ÿnûl
 (
__±h»ad_unwšd_buf_t
 *
__buf
)

704 
__ş—nup_fù_©Œibu‹
;

706 #ifdeà
__USE_GNU


710 
	#±h»ad_ş—nup_push_deãr_Å
(
routše
, 
¬g
) \

712 
__±h»ad_unwšd_buf_t
 
__ÿnûl_buf
; \

713 (*
__ÿnûl_routše
è(*èğ(
routše
); \

714 *
__ÿnûl_¬g
 = (
¬g
); \

715 
__nÙ_fœ¡_ÿÎ
 = 
	`__sig£tjmp
 ((
__jmp_buf_g
 *) (*) \

716 
__ÿnûl_buf
.
__ÿnûl_jmp_buf
, 0); \

717 ià(
	`__glibc_uÆik–y
 (
__nÙ_fœ¡_ÿÎ
)) \

719 
	`__ÿnûl_routše
 (
__ÿnûl_¬g
); \

720 
	`__±h»ad_unwšd_Ãxt
 (&
__ÿnûl_buf
); \

724 
	`__±h»ad_»gi¡”_ÿnûl_deãr
 (&
__ÿnûl_buf
); \

725 dØ{

	)

726 
	`__±h»ad_»gi¡”_ÿnûl_deãr
 (
__±h»ad_unwšd_buf_t
 *
__buf
)

727 
__ş—nup_fù_©Œibu‹
;

732 
	#±h»ad_ş—nup_pİ_»¡Üe_Å
(
execu‹
) \

735 
	`__±h»ad_uÄegi¡”_ÿnûl_»¡Üe
 (&
__ÿnûl_buf
); \

736 ià(
execu‹
) \

737 
	`__ÿnûl_routše
 (
__ÿnûl_¬g
); \

738 
	}
} 0)

	)

739 
	$__±h»ad_uÄegi¡”_ÿnûl_»¡Üe
 (
__±h»ad_unwšd_buf_t
 *
__buf
)

740 
__ş—nup_fù_©Œibu‹
;

744 
	$__±h»ad_unwšd_Ãxt
 (
__±h»ad_unwšd_buf_t
 *
__buf
)

745 
__ş—nup_fù_©Œibu‹
 
	`__©Œibu‹__
 ((
__nÜ‘uº__
))

746 #iâdeà
SHARED


747 
	`__©Œibu‹__
 ((
__w—k__
))

753 
__jmp_buf_g
;

754 
	$__sig£tjmp
 (
__jmp_buf_g
 *
__’v
, 
__§vemask
è
__THROWNL
;

760 
	$±h»ad_mu‹x_š™
 (
±h»ad_mu‹x_t
 *
__mu‹x
,

761 cÚ¡ 
±h»ad_mu‹x©Œ_t
 *
__mu‹x©Œ
)

762 
__THROW
 
	`__nÚnuÎ
 ((1));

765 
	$±h»ad_mu‹x_de¡roy
 (
±h»ad_mu‹x_t
 *
__mu‹x
)

766 
__THROW
 
	`__nÚnuÎ
 ((1));

769 
	$±h»ad_mu‹x_Œylock
 (
±h»ad_mu‹x_t
 *
__mu‹x
)

770 
__THROWNL
 
	`__nÚnuÎ
 ((1));

773 
	$±h»ad_mu‹x_lock
 (
±h»ad_mu‹x_t
 *
__mu‹x
)

774 
__THROWNL
 
	`__nÚnuÎ
 ((1));

776 #ifdeà
__USE_XOPEN2K


778 
	$±h»ad_mu‹x_timedlock
 (
±h»ad_mu‹x_t
 *
__»¡riù
 
__mu‹x
,

779 cÚ¡ 
time¥ec
 *
__»¡riù


780 
__ab¡ime
è
__THROWNL
 
	`__nÚnuÎ
 ((1, 2));

784 
	$±h»ad_mu‹x_uÆock
 (
±h»ad_mu‹x_t
 *
__mu‹x
)

785 
__THROWNL
 
	`__nÚnuÎ
 ((1));

789 
	$±h»ad_mu‹x_g‘´ioûšg
 (cÚ¡ 
±h»ad_mu‹x_t
 *

790 
__»¡riù
 
__mu‹x
,

791 *
__»¡riù
 
__´ioûšg
)

792 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

796 
	$±h»ad_mu‹x_£rioûšg
 (
±h»ad_mu‹x_t
 *
__»¡riù
 
__mu‹x
,

797 
__´ioûšg
,

798 *
__»¡riù
 
__Şd_ûšg
)

799 
__THROW
 
	`__nÚnuÎ
 ((1, 3));

802 #ifdeà
__USE_XOPEN2K8


804 
	$±h»ad_mu‹x_cÚsi¡’t
 (
±h»ad_mu‹x_t
 *
__mu‹x
)

805 
__THROW
 
	`__nÚnuÎ
 ((1));

806 #ifdeà
__USE_GNU


807 
	$±h»ad_mu‹x_cÚsi¡’t_Å
 (
±h»ad_mu‹x_t
 *
__mu‹x
)

808 
__THROW
 
	`__nÚnuÎ
 ((1));

817 
	$±h»ad_mu‹x©Œ_š™
 (
±h»ad_mu‹x©Œ_t
 *
__©Œ
)

818 
__THROW
 
	`__nÚnuÎ
 ((1));

821 
	$±h»ad_mu‹x©Œ_de¡roy
 (
±h»ad_mu‹x©Œ_t
 *
__©Œ
)

822 
__THROW
 
	`__nÚnuÎ
 ((1));

825 
	$±h»ad_mu‹x©Œ_g‘psh¬ed
 (cÚ¡ 
±h»ad_mu‹x©Œ_t
 *

826 
__»¡riù
 
__©Œ
,

827 *
__»¡riù
 
__psh¬ed
)

828 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

831 
	$±h»ad_mu‹x©Œ_£sh¬ed
 (
±h»ad_mu‹x©Œ_t
 *
__©Œ
,

832 
__psh¬ed
)

833 
__THROW
 
	`__nÚnuÎ
 ((1));

835 #ià
defšed
 
__USE_UNIX98
 || defšed 
__USE_XOPEN2K8


837 
	$±h»ad_mu‹x©Œ_g‘ty³
 (cÚ¡ 
±h»ad_mu‹x©Œ_t
 *
__»¡riù


838 
__©Œ
, *
__»¡riù
 
__kšd
)

839 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

844 
	$±h»ad_mu‹x©Œ_£‰y³
 (
±h»ad_mu‹x©Œ_t
 *
__©Œ
, 
__kšd
)

845 
__THROW
 
	`__nÚnuÎ
 ((1));

849 
	$±h»ad_mu‹x©Œ_g‘´ÙocŞ
 (cÚ¡ 
±h»ad_mu‹x©Œ_t
 *

850 
__»¡riù
 
__©Œ
,

851 *
__»¡riù
 
__´ÙocŞ
)

852 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

856 
	$±h»ad_mu‹x©Œ_£rÙocŞ
 (
±h»ad_mu‹x©Œ_t
 *
__©Œ
,

857 
__´ÙocŞ
)

858 
__THROW
 
	`__nÚnuÎ
 ((1));

861 
	$±h»ad_mu‹x©Œ_g‘´ioûšg
 (cÚ¡ 
±h»ad_mu‹x©Œ_t
 *

862 
__»¡riù
 
__©Œ
,

863 *
__»¡riù
 
__´ioûšg
)

864 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

867 
	$±h»ad_mu‹x©Œ_£rioûšg
 (
±h»ad_mu‹x©Œ_t
 *
__©Œ
,

868 
__´ioûšg
)

869 
__THROW
 
	`__nÚnuÎ
 ((1));

871 #ifdeà
__USE_XOPEN2K


873 
	$±h»ad_mu‹x©Œ_g‘robu¡
 (cÚ¡ 
±h»ad_mu‹x©Œ_t
 *
__©Œ
,

874 *
__robu¡Ãss
)

875 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

876 #ifdeà
__USE_GNU


877 
	$±h»ad_mu‹x©Œ_g‘robu¡_Å
 (cÚ¡ 
±h»ad_mu‹x©Œ_t
 *
__©Œ
,

878 *
__robu¡Ãss
)

879 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

883 
	$±h»ad_mu‹x©Œ_£Œobu¡
 (
±h»ad_mu‹x©Œ_t
 *
__©Œ
,

884 
__robu¡Ãss
)

885 
__THROW
 
	`__nÚnuÎ
 ((1));

886 #ifdeà
__USE_GNU


887 
	$±h»ad_mu‹x©Œ_£Œobu¡_Å
 (
±h»ad_mu‹x©Œ_t
 *
__©Œ
,

888 
__robu¡Ãss
)

889 
__THROW
 
	`__nÚnuÎ
 ((1));

894 #ià
defšed
 
__USE_UNIX98
 || defšed 
__USE_XOPEN2K


899 
	$±h»ad_rwlock_š™
 (
±h»ad_rwlock_t
 *
__»¡riù
 
__rwlock
,

900 cÚ¡ 
±h»ad_rwlock©Œ_t
 *
__»¡riù


901 
__©Œ
è
__THROW
 
	`__nÚnuÎ
 ((1));

904 
	$±h»ad_rwlock_de¡roy
 (
±h»ad_rwlock_t
 *
__rwlock
)

905 
__THROW
 
	`__nÚnuÎ
 ((1));

908 
	$±h»ad_rwlock_rdlock
 (
±h»ad_rwlock_t
 *
__rwlock
)

909 
__THROWNL
 
	`__nÚnuÎ
 ((1));

912 
	$±h»ad_rwlock_Œyrdlock
 (
±h»ad_rwlock_t
 *
__rwlock
)

913 
__THROWNL
 
	`__nÚnuÎ
 ((1));

915 #ifdeà
__USE_XOPEN2K


917 
	$±h»ad_rwlock_timedrdlock
 (
±h»ad_rwlock_t
 *
__»¡riù
 
__rwlock
,

918 cÚ¡ 
time¥ec
 *
__»¡riù


919 
__ab¡ime
è
__THROWNL
 
	`__nÚnuÎ
 ((1, 2));

923 
	$±h»ad_rwlock_w¾ock
 (
±h»ad_rwlock_t
 *
__rwlock
)

924 
__THROWNL
 
	`__nÚnuÎ
 ((1));

927 
	$±h»ad_rwlock_Œyw¾ock
 (
±h»ad_rwlock_t
 *
__rwlock
)

928 
__THROWNL
 
	`__nÚnuÎ
 ((1));

930 #ifdeà
__USE_XOPEN2K


932 
	$±h»ad_rwlock_timedw¾ock
 (
±h»ad_rwlock_t
 *
__»¡riù
 
__rwlock
,

933 cÚ¡ 
time¥ec
 *
__»¡riù


934 
__ab¡ime
è
__THROWNL
 
	`__nÚnuÎ
 ((1, 2));

938 
	$±h»ad_rwlock_uÆock
 (
±h»ad_rwlock_t
 *
__rwlock
)

939 
__THROWNL
 
	`__nÚnuÎ
 ((1));

945 
	$±h»ad_rwlock©Œ_š™
 (
±h»ad_rwlock©Œ_t
 *
__©Œ
)

946 
__THROW
 
	`__nÚnuÎ
 ((1));

949 
	$±h»ad_rwlock©Œ_de¡roy
 (
±h»ad_rwlock©Œ_t
 *
__©Œ
)

950 
__THROW
 
	`__nÚnuÎ
 ((1));

953 
	$±h»ad_rwlock©Œ_g‘psh¬ed
 (cÚ¡ 
±h»ad_rwlock©Œ_t
 *

954 
__»¡riù
 
__©Œ
,

955 *
__»¡riù
 
__psh¬ed
)

956 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

959 
	$±h»ad_rwlock©Œ_£sh¬ed
 (
±h»ad_rwlock©Œ_t
 *
__©Œ
,

960 
__psh¬ed
)

961 
__THROW
 
	`__nÚnuÎ
 ((1));

964 
	$±h»ad_rwlock©Œ_g‘kšd_Å
 (cÚ¡ 
±h»ad_rwlock©Œ_t
 *

965 
__»¡riù
 
__©Œ
,

966 *
__»¡riù
 
__´ef
)

967 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

970 
	$±h»ad_rwlock©Œ_£tkšd_Å
 (
±h»ad_rwlock©Œ_t
 *
__©Œ
,

971 
__´ef
è
__THROW
 
	`__nÚnuÎ
 ((1));

979 
	$±h»ad_cÚd_š™
 (
±h»ad_cÚd_t
 *
__»¡riù
 
__cÚd
,

980 cÚ¡ 
±h»ad_cÚd©Œ_t
 *
__»¡riù
 
__cÚd_©Œ
)

981 
__THROW
 
	`__nÚnuÎ
 ((1));

984 
	$±h»ad_cÚd_de¡roy
 (
±h»ad_cÚd_t
 *
__cÚd
)

985 
__THROW
 
	`__nÚnuÎ
 ((1));

988 
	$±h»ad_cÚd_sigÇl
 (
±h»ad_cÚd_t
 *
__cÚd
)

989 
__THROWNL
 
	`__nÚnuÎ
 ((1));

992 
	$±h»ad_cÚd_brßdÿ¡
 (
±h»ad_cÚd_t
 *
__cÚd
)

993 
__THROWNL
 
	`__nÚnuÎ
 ((1));

1000 
	$±h»ad_cÚd_wa™
 (
±h»ad_cÚd_t
 *
__»¡riù
 
__cÚd
,

1001 
±h»ad_mu‹x_t
 *
__»¡riù
 
__mu‹x
)

1002 
	`__nÚnuÎ
 ((1, 2));

1011 
	$±h»ad_cÚd_timedwa™
 (
±h»ad_cÚd_t
 *
__»¡riù
 
__cÚd
,

1012 
±h»ad_mu‹x_t
 *
__»¡riù
 
__mu‹x
,

1013 cÚ¡ 
time¥ec
 *
__»¡riù
 
__ab¡ime
)

1014 
	`__nÚnuÎ
 ((1, 2, 3));

1019 
	$±h»ad_cÚd©Œ_š™
 (
±h»ad_cÚd©Œ_t
 *
__©Œ
)

1020 
__THROW
 
	`__nÚnuÎ
 ((1));

1023 
	$±h»ad_cÚd©Œ_de¡roy
 (
±h»ad_cÚd©Œ_t
 *
__©Œ
)

1024 
__THROW
 
	`__nÚnuÎ
 ((1));

1027 
	$±h»ad_cÚd©Œ_g‘psh¬ed
 (cÚ¡ 
±h»ad_cÚd©Œ_t
 *

1028 
__»¡riù
 
__©Œ
,

1029 *
__»¡riù
 
__psh¬ed
)

1030 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

1033 
	$±h»ad_cÚd©Œ_£sh¬ed
 (
±h»ad_cÚd©Œ_t
 *
__©Œ
,

1034 
__psh¬ed
è
__THROW
 
	`__nÚnuÎ
 ((1));

1036 #ifdeà
__USE_XOPEN2K


1038 
	$±h»ad_cÚd©Œ_g‘şock
 (cÚ¡ 
±h»ad_cÚd©Œ_t
 *

1039 
__»¡riù
 
__©Œ
,

1040 
__şockid_t
 *
__»¡riù
 
__şock_id
)

1041 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

1044 
	$±h»ad_cÚd©Œ_£tşock
 (
±h»ad_cÚd©Œ_t
 *
__©Œ
,

1045 
__şockid_t
 
__şock_id
)

1046 
__THROW
 
	`__nÚnuÎ
 ((1));

1050 #ifdeà
__USE_XOPEN2K


1055 
	$±h»ad_¥š_š™
 (
±h»ad_¥šlock_t
 *
__lock
, 
__psh¬ed
)

1056 
__THROW
 
	`__nÚnuÎ
 ((1));

1059 
	$±h»ad_¥š_de¡roy
 (
±h»ad_¥šlock_t
 *
__lock
)

1060 
__THROW
 
	`__nÚnuÎ
 ((1));

1063 
	$±h»ad_¥š_lock
 (
±h»ad_¥šlock_t
 *
__lock
)

1064 
__THROWNL
 
	`__nÚnuÎ
 ((1));

1067 
	$±h»ad_¥š_Œylock
 (
±h»ad_¥šlock_t
 *
__lock
)

1068 
__THROWNL
 
	`__nÚnuÎ
 ((1));

1071 
	$±h»ad_¥š_uÆock
 (
±h»ad_¥šlock_t
 *
__lock
)

1072 
__THROWNL
 
	`__nÚnuÎ
 ((1));

1079 
	$±h»ad_b¬r›r_š™
 (
±h»ad_b¬r›r_t
 *
__»¡riù
 
__b¬r›r
,

1080 cÚ¡ 
±h»ad_b¬r›¿‰r_t
 *
__»¡riù


1081 
__©Œ
, 
__couÁ
)

1082 
__THROW
 
	`__nÚnuÎ
 ((1));

1085 
	$±h»ad_b¬r›r_de¡roy
 (
±h»ad_b¬r›r_t
 *
__b¬r›r
)

1086 
__THROW
 
	`__nÚnuÎ
 ((1));

1089 
	$±h»ad_b¬r›r_wa™
 (
±h»ad_b¬r›r_t
 *
__b¬r›r
)

1090 
__THROWNL
 
	`__nÚnuÎ
 ((1));

1094 
	$±h»ad_b¬r›¿‰r_š™
 (
±h»ad_b¬r›¿‰r_t
 *
__©Œ
)

1095 
__THROW
 
	`__nÚnuÎ
 ((1));

1098 
	$±h»ad_b¬r›¿‰r_de¡roy
 (
±h»ad_b¬r›¿‰r_t
 *
__©Œ
)

1099 
__THROW
 
	`__nÚnuÎ
 ((1));

1102 
	$±h»ad_b¬r›¿‰r_g‘psh¬ed
 (cÚ¡ 
±h»ad_b¬r›¿‰r_t
 *

1103 
__»¡riù
 
__©Œ
,

1104 *
__»¡riù
 
__psh¬ed
)

1105 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

1108 
	$±h»ad_b¬r›¿‰r_£sh¬ed
 (
±h»ad_b¬r›¿‰r_t
 *
__©Œ
,

1109 
__psh¬ed
)

1110 
__THROW
 
	`__nÚnuÎ
 ((1));

1122 
	`±h»ad_key_ü—‹
 (
±h»ad_key_t
 *
__key
,

1123 (*
__de¡r_funùiÚ
) (*))

1124 
__THROW
 
	`__nÚnuÎ
 ((1));

1127 
	$±h»ad_key_d–‘e
 (
±h»ad_key_t
 
__key
è
__THROW
;

1130 *
	$±h»ad_g‘¥ecific
 (
±h»ad_key_t
 
__key
è
__THROW
;

1133 
	$±h»ad_£t¥ecific
 (
±h»ad_key_t
 
__key
,

1134 cÚ¡ *
__poš‹r
è
__THROW
 ;

1137 #ifdeà
__USE_XOPEN2K


1139 
	$±h»ad_g‘ıuşockid
 (
±h»ad_t
 
__th»ad_id
,

1140 
__şockid_t
 *
__şock_id
)

1141 
__THROW
 
	`__nÚnuÎ
 ((2));

1156 
	`±h»ad_©fÜk
 ((*
__´•¬e
) (),

1157 (*
__·»Á
) (),

1158 (*
__chd
è()è
__THROW
;

1161 #ifdeà
__USE_EXTERN_INLINES


1163 
__ex‹º_šlše
 

1164 
	`__NTH
 (
	$±h»ad_equ®
 (
±h»ad_t
 
__th»ad1
,…th»ad_ˆ
__th»ad2
))

1166  
__th»ad1
 =ğ
__th»ad2
;

1167 
	}
}

1170 
	g__END_DECLS


	@/usr/include/setjmp.h

22 #iâdef 
_SETJMP_H


23 
	#_SETJMP_H
 1

	)

25 
	~<ã©u»s.h
>

27 
	g__BEGIN_DECLS


29 
	~<b™s/£tjmp.h
>

30 
	~<b™s/sig£t.h
>

34 
	s__jmp_buf_g


40 
__jmp_buf
 
	m__jmpbuf
;

41 
	m__mask_was_§ved
;

42 
__sig£t_t
 
	m__§ved_mask
;

46 
__BEGIN_NAMESPACE_STD


48 
__jmp_buf_g
 
	tjmp_buf
[1];

52 
	$£tjmp
 (
jmp_buf
 
__’v
è
__THROWNL
;

54 
__END_NAMESPACE_STD


59 
	$__sig£tjmp
 (
__jmp_buf_g
 
__’v
[1], 
__§vemask
è
__THROWNL
;

63 
	$_£tjmp
 (
__jmp_buf_g
 
__’v
[1]è
__THROWNL
;

67 
	#£tjmp
(
’v
è
	`_£tjmp
 (’v)

	)

70 
__BEGIN_NAMESPACE_STD


74 
	$lÚgjmp
 (
__jmp_buf_g
 
__’v
[1], 
__v®
)

75 
__THROWNL
 
	`__©Œibu‹__
 ((
__nÜ‘uº__
));

77 
__END_NAMESPACE_STD


79 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN


83 
	$_lÚgjmp
 (
__jmp_buf_g
 
__’v
[1], 
__v®
)

84 
__THROWNL
 
	`__©Œibu‹__
 ((
__nÜ‘uº__
));

88 #ifdef 
__USE_POSIX


92 
__jmp_buf_g
 
	tsigjmp_buf
[1];

96 
	#sig£tjmp
(
’v
, 
§vemask
è
	`__sig£tjmp
 (’v, savemask)

	)

102 
	$siglÚgjmp
 (
sigjmp_buf
 
__’v
, 
__v®
)

103 
__THROWNL
 
	`__©Œibu‹__
 ((
__nÜ‘uº__
));

108 #ià
__USE_FORTIFY_LEVEL
 > 0

109 
	~<b™s/£tjmp2.h
>

112 
__END_DECLS


	@/usr/include/signal.h

22 #iâdef 
_SIGNAL_H


24 #ià!
defšed
 
__Ãed_sig_©omic_t
 && !defšed 
__Ãed_sig£t_t


25 
	#_SIGNAL_H


	)

28 
	~<ã©u»s.h
>

30 
	g__BEGIN_DECLS


32 
	~<b™s/sig£t.h
>

36 #ià
defšed
 
__Ãed_sig_©omic_t
 || defšed 
_SIGNAL_H


37 #iâdeà
__sig_©omic_t_defšed


38 
	#__sig_©omic_t_defšed


	)

39 
__BEGIN_NAMESPACE_STD


40 
__sig_©omic_t
 
	tsig_©omic_t
;

41 
	g__END_NAMESPACE_STD


43 #undeà
__Ãed_sig_©omic_t


46 #ià
defšed
 
__Ãed_sig£t_t
 || (defšed 
_SIGNAL_H
 && defšed 
__USE_POSIX
)

47 #iâdeà
__sig£t_t_defšed


48 
	#__sig£t_t_defšed


	)

49 
__sig£t_t
 
	tsig£t_t
;

51 #undeà
__Ãed_sig£t_t


54 #ifdeà
_SIGNAL_H


56 
	~<b™s/ty³s.h
>

57 
	~<b™s/signum.h
>

59 #ià
defšed
 
__USE_XOPEN
 || defšed 
__USE_XOPEN2K


60 #iâdeà
__pid_t_defšed


61 
__pid_t
 
	tpid_t
;

62 
	#__pid_t_defšed


	)

64 #ifdeà
__USE_XOPEN


66 #iâdeà
__uid_t_defšed


67 
__uid_t
 
	tuid_t
;

68 
	#__uid_t_defšed


	)

72 #ifdeà
__USE_POSIX199309


74 
	#__Ãed_time¥ec


	)

75 
	~<time.h
>

78 #ià
defšed
 
__USE_POSIX199309
 || defšed 
__USE_XOPEN_EXTENDED


80 
	~<b™s/sigšfo.h
>

85 (*
	t__sighªdËr_t
) ();

90 
__sighªdËr_t
 
	$__sysv_sigÇl
 (
__sig
, 
__sighªdËr_t
 
__hªdËr
)

91 
__THROW
;

92 #ifdeà
__USE_GNU


93 
__sighªdËr_t
 
	$sysv_sigÇl
 (
__sig
, 
__sighªdËr_t
 
__hªdËr
)

94 
__THROW
;

100 
__BEGIN_NAMESPACE_STD


101 #ifdeà
__USE_BSD


102 
__sighªdËr_t
 
	$sigÇl
 (
__sig
, 
__sighªdËr_t
 
__hªdËr
)

103 
__THROW
;

106 #ifdeà
__REDIRECT_NTH


107 
__sighªdËr_t
 
	`__REDIRECT_NTH
 (
sigÇl
,

108 (
__sig
, 
__sighªdËr_t
 
__hªdËr
),

109 
__sysv_sigÇl
);

111 
	#sigÇl
 
__sysv_sigÇl


	)

114 
__END_NAMESPACE_STD


116 #ifdeà
__USE_XOPEN


119 
__sighªdËr_t
 
	$bsd_sigÇl
 (
__sig
, 
__sighªdËr_t
 
__hªdËr
)

120 
__THROW
;

126 #ifdeà
__USE_POSIX


127 
	$kl
 (
__pid_t
 
__pid
, 
__sig
è
__THROW
;

130 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED


134 
	$kÍg
 (
__pid_t
 
__pg½
, 
__sig
è
__THROW
;

137 
__BEGIN_NAMESPACE_STD


139 
	$¿i£
 (
__sig
è
__THROW
;

140 
__END_NAMESPACE_STD


142 #ifdeà
__USE_SVID


144 
__sighªdËr_t
 
	$ssigÇl
 (
__sig
, 
__sighªdËr_t
 
__hªdËr
)

145 
__THROW
;

146 
	$gsigÇl
 (
__sig
è
__THROW
;

149 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN2K


151 
	`psigÇl
 (
__sig
, cÚ¡ *
__s
);

154 #ifdeà
__USE_XOPEN2K


156 
	`psigšfo
 (cÚ¡ 
sigšfo_t
 *
__pšfo
, cÚ¡ *
__s
);

167 
	`__sig·u£
 (
__sig_Ü_mask
, 
__is_sig
);

169 #ifdeà
__USE_XOPEN


170 #ifdeà
__GNUC__


171 
	$sig·u£
 (
__sig
è
	`__asm__
 ("__xpg_sigpause");

174 
	#sig·u£
(
sig
è
	`__sig·u£
 ((sig), 1)

	)

179 #ifdeà
__USE_BSD


186 
	#sigmask
(
sig
è
	`__sigmask
(sig)

	)

189 
	$sigblock
 (
__mask
è
__THROW
 
__©Œibu‹_d•»ÿ‹d__
;

192 
	$sig£tmask
 (
__mask
è
__THROW
 
__©Œibu‹_d•»ÿ‹d__
;

195 
	$sigg‘mask
 (è
__THROW
 
__©Œibu‹_d•»ÿ‹d__
;

199 #ifdeà
__USE_MISC


200 
	#NSIG
 
_NSIG


	)

203 #ifdeà
__USE_GNU


204 
__sighªdËr_t
 
	tsighªdËr_t
;

208 #ifdeà
__USE_BSD


209 
__sighªdËr_t
 
	tsig_t
;

212 #ifdeà
__USE_POSIX


215 
	$sigem±y£t
 (
sig£t_t
 *
__£t
è
__THROW
 
	`__nÚnuÎ
 ((1));

218 
	$sigfl£t
 (
sig£t_t
 *
__£t
è
__THROW
 
	`__nÚnuÎ
 ((1));

221 
	$sigadd£t
 (
sig£t_t
 *
__£t
, 
__signo
è
__THROW
 
	`__nÚnuÎ
 ((1));

224 
	$sigd–£t
 (
sig£t_t
 *
__£t
, 
__signo
è
__THROW
 
	`__nÚnuÎ
 ((1));

227 
	$sigismemb”
 (cÚ¡ 
sig£t_t
 *
__£t
, 
__signo
)

228 
__THROW
 
	`__nÚnuÎ
 ((1));

230 #ifdeà
__USE_GNU


232 
	$sigi£m±y£t
 (cÚ¡ 
sig£t_t
 *
__£t
è
__THROW
 
	`__nÚnuÎ
 ((1));

235 
	$sigªd£t
 (
sig£t_t
 *
__£t
, cÚ¡ sig£t_ˆ*
__Ëá
,

236 cÚ¡ 
sig£t_t
 *
__right
è
__THROW
 
	`__nÚnuÎ
 ((1, 2, 3));

239 
	$sigÜ£t
 (
sig£t_t
 *
__£t
, cÚ¡ sig£t_ˆ*
__Ëá
,

240 cÚ¡ 
sig£t_t
 *
__right
è
__THROW
 
	`__nÚnuÎ
 ((1, 2, 3));

245 
	~<b™s/sigaùiÚ.h
>

248 
	$sig´ocmask
 (
__how
, cÚ¡ 
sig£t_t
 *
__»¡riù
 
__£t
,

249 
sig£t_t
 *
__»¡riù
 
__o£t
è
__THROW
;

256 
	$sigsu¥’d
 (cÚ¡ 
sig£t_t
 *
__£t
è
	`__nÚnuÎ
 ((1));

259 
	$sigaùiÚ
 (
__sig
, cÚ¡ 
sigaùiÚ
 *
__»¡riù
 
__aù
,

260 
sigaùiÚ
 *
__»¡riù
 
__ßù
è
__THROW
;

263 
	$sig³ndšg
 (
sig£t_t
 *
__£t
è
__THROW
 
	`__nÚnuÎ
 ((1));

270 
	$sigwa™
 (cÚ¡ 
sig£t_t
 *
__»¡riù
 
__£t
, *__»¡riù 
__sig
)

271 
	`__nÚnuÎ
 ((1, 2));

273 #ifdeà
__USE_POSIX199309


278 
	$sigwa™šfo
 (cÚ¡ 
sig£t_t
 *
__»¡riù
 
__£t
,

279 
sigšfo_t
 *
__»¡riù
 
__šfo
è
	`__nÚnuÎ
 ((1));

286 
	$sigtimedwa™
 (cÚ¡ 
sig£t_t
 *
__»¡riù
 
__£t
,

287 
sigšfo_t
 *
__»¡riù
 
__šfo
,

288 cÚ¡ 
time¥ec
 *
__»¡riù
 
__timeout
)

289 
	`__nÚnuÎ
 ((1));

293 
	$sigqueue
 (
__pid_t
 
__pid
, 
__sig
, cÚ¡ 
sigv®
 
__v®
)

294 
__THROW
;

299 #ifdeà
__USE_BSD


303 cÚ¡ *cÚ¡ 
_sys_sigli¡
[
_NSIG
];

304 cÚ¡ *cÚ¡ 
sys_sigli¡
[
_NSIG
];

307 
	ssigvec


309 
__sighªdËr_t
 
sv_hªdËr
;

310 
sv_mask
;

312 
sv_æags
;

313 
	#sv_Ú¡ack
 
sv_æags


	)

317 
	#SV_ONSTACK
 (1 << 0)

	)

318 
	#SV_INTERRUPT
 (1 << 1)

	)

319 
	#SV_RESETHAND
 (1 << 2)

	)

327 
	$sigvec
 (
__sig
, cÚ¡ 
sigvec
 *
__vec
,

328 
sigvec
 *
__ovec
è
__THROW
;

332 
	~<b™s/sigcÚ‹xt.h
>

335 
	$sig»tuº
 (
sigcÚ‹xt
 *
__sı
è
__THROW
;

340 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K8


341 
	#__Ãed_size_t


	)

342 
	~<¡ddef.h
>

347 
	$sigš‹¼u±
 (
__sig
, 
__š‹¼u±
è
__THROW
;

349 
	~<b™s/sig¡ack.h
>

350 #ià
defšed
 
__USE_XOPEN
 || defšed 
__USE_XOPEN2K8


352 
	~<sys/ucÚ‹xt.h
>

358 
	$sig¡ack
 (
sig¡ack
 *
__ss
, sig¡ack *
__oss
)

359 
__THROW
 
__©Œibu‹_d•»ÿ‹d__
;

363 
	$sig®t¡ack
 (cÚ¡ 
sig®t¡ack
 *
__»¡riù
 
__ss
,

364 
sig®t¡ack
 *
__»¡riù
 
__oss
è
__THROW
;

368 #ifdeà
__USE_XOPEN_EXTENDED


372 
	$sighŞd
 (
__sig
è
__THROW
;

375 
	$sig»l£
 (
__sig
è
__THROW
;

378 
	$sigignÜe
 (
__sig
è
__THROW
;

381 
__sighªdËr_t
 
	$sig£t
 (
__sig
, 
__sighªdËr_t
 
__di¥
è
__THROW
;

384 #ià
defšed
 
__USE_POSIX199506
 || defšed 
__USE_UNIX98


387 
	~<b™s/±h»adty³s.h
>

388 
	~<b™s/sigth»ad.h
>

395 
	$__libc_cu¼’t_sig¹mš
 (è
__THROW
;

397 
	$__libc_cu¼’t_sig¹max
 (è
__THROW
;

401 
__END_DECLS


	@/usr/include/stdlib.h

22 #iâdef 
_STDLIB_H


24 
	~<ã©u»s.h
>

27 
	#__Ãed_size_t


	)

28 #iâdeà
__Ãed_m®loc_ªd_ÿÎoc


29 
	#__Ãed_wch¬_t


	)

30 
	#__Ãed_NULL


	)

32 
	~<¡ddef.h
>

34 
	g__BEGIN_DECLS


36 #iâdeà
__Ãed_m®loc_ªd_ÿÎoc


37 
	#_STDLIB_H
 1

	)

39 #ià(
defšed
 
__USE_XOPEN
 || defšed 
__USE_XOPEN2K8
è&& !defšed 
_SYS_WAIT_H


41 
	~<b™s/wa™æags.h
>

42 
	~<b™s/wa™¡©us.h
>

44 #ifdeà
__USE_BSD


49 #ià
defšed
 
__GNUC__
 && !defšed 
__ılu¥lus


50 
	#__WAIT_INT
(
¡©us
) \

51 (
	`__ex‹nsiÚ__
 (((uniÚ { 
	`__ty³of
(
¡©us
è
__š
; 
__i
; }) \

52 { .
__š
 = (
¡©us
è}).
__i
))

	)

54 
	#__WAIT_INT
(
¡©us
è(*(*è&(¡©us))

	)

62 #ià!
defšed
 
__GNUC__
 || __GNUC__ < 2 || defšed 
__ılu¥lus


63 
	#__WAIT_STATUS
 *

	)

64 
	#__WAIT_STATUS_DEFN
 *

	)

69 
wa™
 *
	m__u±r
;

70 *
	m__Œ
;

71 } 
	t__WAIT_STATUS
 
	t__©Œibu‹__
 ((
	t__Œª¥¬’t_uniÚ__
));

72 
	#__WAIT_STATUS_DEFN
 *

	)

77 
	#__WAIT_INT
(
¡©us
è(¡©us)

	)

78 
	#__WAIT_STATUS
 *

	)

79 
	#__WAIT_STATUS_DEFN
 *

	)

84 
	#WEXITSTATUS
(
¡©us
è
	`__WEXITSTATUS
 (
	`__WAIT_INT
 (¡©us))

	)

85 
	#WTERMSIG
(
¡©us
è
	`__WTERMSIG
 (
	`__WAIT_INT
 (¡©us))

	)

86 
	#WSTOPSIG
(
¡©us
è
	`__WSTOPSIG
 (
	`__WAIT_INT
 (¡©us))

	)

87 
	#WIFEXITED
(
¡©us
è
	`__WIFEXITED
 (
	`__WAIT_INT
 (¡©us))

	)

88 
	#WIFSIGNALED
(
¡©us
è
	`__WIFSIGNALED
 (
	`__WAIT_INT
 (¡©us))

	)

89 
	#WIFSTOPPED
(
¡©us
è
	`__WIFSTOPPED
 (
	`__WAIT_INT
 (¡©us))

	)

90 #ifdeà
__WIFCONTINUED


91 
	#WIFCONTINUED
(
¡©us
è
	`__WIFCONTINUED
 (
	`__WAIT_INT
 (¡©us))

	)

95 
__BEGIN_NAMESPACE_STD


99 
	mquÙ
;

100 
	m»m
;

101 } 
	tdiv_t
;

104 #iâdeà
__ldiv_t_defšed


107 
	mquÙ
;

108 
	m»m
;

109 } 
	tldiv_t
;

110 
	#__ldiv_t_defšed
 1

	)

112 
	g__END_NAMESPACE_STD


114 #ià
defšed
 
__USE_ISOC99
 && !defšed 
__Îdiv_t_defšed


115 
__BEGIN_NAMESPACE_C99


117 
__ex‹nsiÚ__
 struct

119 
	mquÙ
;

120 
	m»m
;

121 } 
	tÎdiv_t
;

122 
	#__Îdiv_t_defšed
 1

	)

123 
	g__END_NAMESPACE_C99


128 
	#RAND_MAX
 2147483647

	)

133 
	#EXIT_FAILURE
 1

	)

134 
	#EXIT_SUCCESS
 0

	)

138 
	#MB_CUR_MAX
 (
	`__ùy³_g‘_mb_cur_max
 ())

	)

139 
size_t
 
	$__ùy³_g‘_mb_cur_max
 (è
__THROW
 
__wur
;

142 
__BEGIN_NAMESPACE_STD


144 
	$©of
 (cÚ¡ *
__ÅŒ
)

145 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1)è
__wur
;

147 
	$©oi
 (cÚ¡ *
__ÅŒ
)

148 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1)è
__wur
;

150 
	$©Ş
 (cÚ¡ *
__ÅŒ
)

151 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1)è
__wur
;

152 
__END_NAMESPACE_STD


154 #ià
defšed
 
__USE_ISOC99
 || defšed 
__USE_MISC


155 
__BEGIN_NAMESPACE_C99


157 
__ex‹nsiÚ__
 
	$©Şl
 (cÚ¡ *
__ÅŒ
)

158 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1)è
__wur
;

159 
__END_NAMESPACE_C99


162 
__BEGIN_NAMESPACE_STD


164 
	$¡¹od
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

165 **
__»¡riù
 
__’d±r
)

166 
__THROW
 
	`__nÚnuÎ
 ((1));

167 
__END_NAMESPACE_STD


169 #ifdef 
__USE_ISOC99


170 
__BEGIN_NAMESPACE_C99


172 
	$¡¹of
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

173 **
__»¡riù
 
__’d±r
è
__THROW
 
	`__nÚnuÎ
 ((1));

175 
	$¡¹Şd
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

176 **
__»¡riù
 
__’d±r
)

177 
__THROW
 
	`__nÚnuÎ
 ((1));

178 
__END_NAMESPACE_C99


181 
__BEGIN_NAMESPACE_STD


183 
	$¡¹Ş
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

184 **
__»¡riù
 
__’d±r
, 
__ba£
)

185 
__THROW
 
	`__nÚnuÎ
 ((1));

187 
	$¡¹oul
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

188 **
__»¡riù
 
__’d±r
, 
__ba£
)

189 
__THROW
 
	`__nÚnuÎ
 ((1));

190 
__END_NAMESPACE_STD


192 #ifdeà
__USE_BSD


194 
__ex‹nsiÚ__


195 
	$¡¹oq
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

196 **
__»¡riù
 
__’d±r
, 
__ba£
)

197 
__THROW
 
	`__nÚnuÎ
 ((1));

199 
__ex‹nsiÚ__


200 
	$¡¹ouq
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

201 **
__»¡riù
 
__’d±r
, 
__ba£
)

202 
__THROW
 
	`__nÚnuÎ
 ((1));

205 #ià
defšed
 
__USE_ISOC99
 || defšed 
__USE_MISC


206 
__BEGIN_NAMESPACE_C99


208 
__ex‹nsiÚ__


209 
	$¡¹Şl
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

210 **
__»¡riù
 
__’d±r
, 
__ba£
)

211 
__THROW
 
	`__nÚnuÎ
 ((1));

213 
__ex‹nsiÚ__


214 
	$¡¹ouÎ
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

215 **
__»¡riù
 
__’d±r
, 
__ba£
)

216 
__THROW
 
	`__nÚnuÎ
 ((1));

217 
__END_NAMESPACE_C99


221 #ifdeà
__USE_GNU


235 
	~<xloÿË.h
>

239 
	$¡¹Ş_l
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

240 **
__»¡riù
 
__’d±r
, 
__ba£
,

241 
__loÿË_t
 
__loc
è
__THROW
 
	`__nÚnuÎ
 ((1, 4));

243 
	$¡¹oul_l
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

244 **
__»¡riù
 
__’d±r
,

245 
__ba£
, 
__loÿË_t
 
__loc
)

246 
__THROW
 
	`__nÚnuÎ
 ((1, 4));

248 
__ex‹nsiÚ__


249 
	$¡¹Şl_l
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

250 **
__»¡riù
 
__’d±r
, 
__ba£
,

251 
__loÿË_t
 
__loc
)

252 
__THROW
 
	`__nÚnuÎ
 ((1, 4));

254 
__ex‹nsiÚ__


255 
	$¡¹ouÎ_l
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

256 **
__»¡riù
 
__’d±r
,

257 
__ba£
, 
__loÿË_t
 
__loc
)

258 
__THROW
 
	`__nÚnuÎ
 ((1, 4));

260 
	$¡¹od_l
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

261 **
__»¡riù
 
__’d±r
, 
__loÿË_t
 
__loc
)

262 
__THROW
 
	`__nÚnuÎ
 ((1, 3));

264 
	$¡¹of_l
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

265 **
__»¡riù
 
__’d±r
, 
__loÿË_t
 
__loc
)

266 
__THROW
 
	`__nÚnuÎ
 ((1, 3));

268 
	$¡¹Şd_l
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

269 **
__»¡riù
 
__’d±r
,

270 
__loÿË_t
 
__loc
)

271 
__THROW
 
	`__nÚnuÎ
 ((1, 3));

275 #ifdeà
__USE_EXTERN_INLINES


276 
__BEGIN_NAMESPACE_STD


277 
__ex‹º_šlše
 

278 
	`__NTH
 (
	$©oi
 (cÚ¡ *
__ÅŒ
))

280  (è
	`¡¹Ş
 (
__ÅŒ
, (**è
NULL
, 10);

281 
	}
}

282 
__ex‹º_šlše
 

283 
__NTH
 (
	$©Ş
 (cÚ¡ *
__ÅŒ
))

285  
	`¡¹Ş
 (
__ÅŒ
, (**è
NULL
, 10);

286 
	}
}

287 
	g__END_NAMESPACE_STD


289 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_ISOC99


290 
__BEGIN_NAMESPACE_C99


291 
__ex‹nsiÚ__
 
__ex‹º_šlše
 

292 
__NTH
 (
	$©Şl
 (cÚ¡ *
__ÅŒ
))

294  
	`¡¹Şl
 (
__ÅŒ
, (**è
NULL
, 10);

295 
	}
}

296 
	g__END_NAMESPACE_C99


301 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_XOPEN_EXTENDED


305 *
	$l64a
 (
__n
è
__THROW
 
__wur
;

308 
	$a64l
 (cÚ¡ *
__s
)

309 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1)è
__wur
;

313 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_BSD


314 
	~<sys/ty³s.h
>

321 
	$¿ndom
 (è
__THROW
;

324 
	$¤ªdom
 (
__£ed
è
__THROW
;

330 *
	$š™¡©e
 (
__£ed
, *
__¡©ebuf
,

331 
size_t
 
__¡©–’
è
__THROW
 
	`__nÚnuÎ
 ((2));

335 *
	$£t¡©e
 (*
__¡©ebuf
è
__THROW
 
	`__nÚnuÎ
 ((1));

338 #ifdeà
__USE_MISC


343 
	s¿ndom_d©a


345 
št32_t
 *
åŒ
;

346 
št32_t
 *
½Œ
;

347 
št32_t
 *
¡©e
;

348 
¿nd_ty³
;

349 
¿nd_deg
;

350 
¿nd_£p
;

351 
št32_t
 *
’d_±r
;

354 
	$¿ndom_r
 (
¿ndom_d©a
 *
__»¡riù
 
__buf
,

355 
št32_t
 *
__»¡riù
 
__»suÉ
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

357 
	$¤ªdom_r
 (
__£ed
, 
¿ndom_d©a
 *
__buf
)

358 
__THROW
 
	`__nÚnuÎ
 ((2));

360 
	$š™¡©e_r
 (
__£ed
, *
__»¡riù
 
__¡©ebuf
,

361 
size_t
 
__¡©–’
,

362 
¿ndom_d©a
 *
__»¡riù
 
__buf
)

363 
__THROW
 
	`__nÚnuÎ
 ((2, 4));

365 
	$£t¡©e_r
 (*
__»¡riù
 
__¡©ebuf
,

366 
¿ndom_d©a
 *
__»¡riù
 
__buf
)

367 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

372 
__BEGIN_NAMESPACE_STD


374 
	$¿nd
 (è
__THROW
;

376 
	$¤ªd
 (
__£ed
è
__THROW
;

377 
__END_NAMESPACE_STD


379 #ifdeà
__USE_POSIX


381 
	$¿nd_r
 (*
__£ed
è
__THROW
;

385 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_XOPEN


389 
	$d¿nd48
 (è
__THROW
;

390 
	$”ªd48
 (
__xsubi
[3]è
__THROW
 
	`__nÚnuÎ
 ((1));

393 
	$Ìªd48
 (è
__THROW
;

394 
	$Äªd48
 (
__xsubi
[3])

395 
__THROW
 
	`__nÚnuÎ
 ((1));

398 
	$m¿nd48
 (è
__THROW
;

399 
	$j¿nd48
 (
__xsubi
[3])

400 
__THROW
 
	`__nÚnuÎ
 ((1));

403 
	$¤ªd48
 (
__£edv®
è
__THROW
;

404 *
	$£ed48
 (
__£ed16v
[3])

405 
__THROW
 
	`__nÚnuÎ
 ((1));

406 
	$lcÚg48
 (
__·¿m
[7]è
__THROW
 
	`__nÚnuÎ
 ((1));

408 #ifdeà
__USE_MISC


412 
	sd¿nd48_d©a


414 
__x
[3];

415 
__Şd_x
[3];

416 
__c
;

417 
__š™
;

418 
__ex‹nsiÚ__
 
__a
;

423 
	$d¿nd48_r
 (
d¿nd48_d©a
 *
__»¡riù
 
__bufãr
,

424 *
__»¡riù
 
__»suÉ
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

425 
	$”ªd48_r
 (
__xsubi
[3],

426 
d¿nd48_d©a
 *
__»¡riù
 
__bufãr
,

427 *
__»¡riù
 
__»suÉ
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

430 
	$Ìªd48_r
 (
d¿nd48_d©a
 *
__»¡riù
 
__bufãr
,

431 *
__»¡riù
 
__»suÉ
)

432 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

433 
	$Äªd48_r
 (
__xsubi
[3],

434 
d¿nd48_d©a
 *
__»¡riù
 
__bufãr
,

435 *
__»¡riù
 
__»suÉ
)

436 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

439 
	$m¿nd48_r
 (
d¿nd48_d©a
 *
__»¡riù
 
__bufãr
,

440 *
__»¡riù
 
__»suÉ
)

441 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

442 
	$j¿nd48_r
 (
__xsubi
[3],

443 
d¿nd48_d©a
 *
__»¡riù
 
__bufãr
,

444 *
__»¡riù
 
__»suÉ
)

445 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

448 
	$¤ªd48_r
 (
__£edv®
, 
d¿nd48_d©a
 *
__bufãr
)

449 
__THROW
 
	`__nÚnuÎ
 ((2));

451 
	$£ed48_r
 (
__£ed16v
[3],

452 
d¿nd48_d©a
 *
__bufãr
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

454 
	$lcÚg48_r
 (
__·¿m
[7],

455 
d¿nd48_d©a
 *
__bufãr
)

456 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

462 #iâdeà
__m®loc_ªd_ÿÎoc_defšed


463 
	#__m®loc_ªd_ÿÎoc_defšed


	)

464 
__BEGIN_NAMESPACE_STD


466 *
	$m®loc
 (
size_t
 
__size
è
__THROW
 
__©Œibu‹_m®loc__
 
__wur
;

468 *
	$ÿÎoc
 (
size_t
 
__nmemb
, size_ˆ
__size
)

469 
__THROW
 
__©Œibu‹_m®loc__
 
__wur
;

470 
__END_NAMESPACE_STD


473 #iâdeà
__Ãed_m®loc_ªd_ÿÎoc


474 
__BEGIN_NAMESPACE_STD


480 *
	$»®loc
 (*
__±r
, 
size_t
 
__size
)

481 
__THROW
 
__©Œibu‹_w¬n_unu£d_»suÉ__
;

483 
	$ä“
 (*
__±r
è
__THROW
;

484 
__END_NAMESPACE_STD


486 #ifdef 
__USE_MISC


488 
	$cä“
 (*
__±r
è
__THROW
;

491 #ià
defšed
 
__USE_GNU
 || defšed 
__USE_BSD
 || defšed 
__USE_MISC


492 
	~<®loÿ.h
>

495 #ià(
defšed
 
__USE_XOPEN_EXTENDED
 && !defšed 
__USE_XOPEN2K
) \

496 || 
defšed
 
__USE_BSD


498 *
	$v®loc
 (
size_t
 
__size
è
__THROW
 
__©Œibu‹_m®loc__
 
__wur
;

501 #ifdeà
__USE_XOPEN2K


503 
	$posix_mem®ign
 (**
__mem±r
, 
size_t
 
__®ignm’t
, size_ˆ
__size
)

504 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

507 #ifdeà
__USE_ISOC11


509 *
	$®igÃd_®loc
 (
size_t
 
__®ignm’t
, size_ˆ
__size
)

510 
__THROW
 
__©Œibu‹_m®loc__
 
	`__©Œibu‹_®loc_size__
 ((2)è
__wur
;

513 
__BEGIN_NAMESPACE_STD


515 
	$abÜt
 (è
__THROW
 
	`__©Œibu‹__
 ((
__nÜ‘uº__
));

519 
	`©ex™
 ((*
__func
è()è
__THROW
 
	`__nÚnuÎ
 ((1));

521 #ià
defšed
 
__USE_ISOC11
 || defšed 
__USE_ISOCXX11


523 #ifdeà
__ılu¥lus


524 "C++" 
	`©_quick_ex™
 ((*
__func
) ())

525 
__THROW
 
	`__asm
 ("©_quick_ex™"è
	`__nÚnuÎ
 ((1));

527 
	`©_quick_ex™
 ((*
__func
è()è
__THROW
 
	`__nÚnuÎ
 ((1));

530 
__END_NAMESPACE_STD


532 #ifdef 
__USE_MISC


535 
	`Ú_ex™
 ((*
__func
è(
__¡©us
, *
__¬g
), *__arg)

536 
__THROW
 
	`__nÚnuÎ
 ((1));

539 
__BEGIN_NAMESPACE_STD


543 
	$ex™
 (
__¡©us
è
__THROW
 
	`__©Œibu‹__
 ((
__nÜ‘uº__
));

545 #ià
defšed
 
__USE_ISOC11
 || defšed 
__USE_ISOCXX11


549 
	$quick_ex™
 (
__¡©us
è
__THROW
 
	`__©Œibu‹__
 ((
__nÜ‘uº__
));

551 
__END_NAMESPACE_STD


553 #ifdeà
__USE_ISOC99


554 
__BEGIN_NAMESPACE_C99


557 
	$_Ex™
 (
__¡©us
è
__THROW
 
	`__©Œibu‹__
 ((
__nÜ‘uº__
));

558 
__END_NAMESPACE_C99


562 
__BEGIN_NAMESPACE_STD


564 *
	$g‘’v
 (cÚ¡ *
__Çme
è
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

565 
__END_NAMESPACE_STD


567 #ifdeà
__USE_GNU


570 *
	$£cu»_g‘’v
 (cÚ¡ *
__Çme
)

571 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

574 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_XOPEN


578 
	$pu‹nv
 (*
__¡ršg
è
__THROW
 
	`__nÚnuÎ
 ((1));

581 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN2K


584 
	$£‹nv
 (cÚ¡ *
__Çme
, cÚ¡ *
__v®ue
, 
__»¶aû
)

585 
__THROW
 
	`__nÚnuÎ
 ((2));

588 
	$un£‹nv
 (cÚ¡ *
__Çme
è
__THROW
 
	`__nÚnuÎ
 ((1));

591 #ifdef 
__USE_MISC


595 
	$ş—»nv
 (è
__THROW
;

599 #ià
defšed
 
__USE_MISC
 \

600 || (
defšed
 
__USE_XOPEN_EXTENDED
 && !defšed 
__USE_XOPEN2K8
)

606 *
	$mk‹mp
 (*
__‹m¶©e
è
__THROW
 
	`__nÚnuÎ
 ((1));

609 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN_EXTENDED
 \

610 || 
defšed
 
__USE_XOPEN2K8


619 #iâdeà
__USE_FILE_OFFSET64


620 
	$mk¡emp
 (*
__‹m¶©e
è
	`__nÚnuÎ
 ((1)è
__wur
;

622 #ifdeà
__REDIRECT


623 
	`__REDIRECT
 (
mk¡emp
, (*
__‹m¶©e
), 
mk¡emp64
)

624 
	`__nÚnuÎ
 ((1)è
__wur
;

626 
	#mk¡emp
 
mk¡emp64


	)

629 #ifdeà
__USE_LARGEFILE64


630 
	$mk¡emp64
 (*
__‹m¶©e
è
	`__nÚnuÎ
 ((1)è
__wur
;

634 #ifdeà
__USE_MISC


641 #iâdeà
__USE_FILE_OFFSET64


642 
	$mk¡emps
 (*
__‹m¶©e
, 
__suffixËn
è
	`__nÚnuÎ
 ((1)è
__wur
;

644 #ifdeà
__REDIRECT


645 
	`__REDIRECT
 (
mk¡emps
, (*
__‹m¶©e
, 
__suffixËn
),

646 
mk¡emps64
è
	`__nÚnuÎ
 ((1)è
__wur
;

648 
	#mk¡emps
 
mk¡emps64


	)

651 #ifdeà
__USE_LARGEFILE64


652 
	$mk¡emps64
 (*
__‹m¶©e
, 
__suffixËn
)

653 
	`__nÚnuÎ
 ((1)è
__wur
;

657 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN2K8


663 *
	$mkd‹mp
 (*
__‹m¶©e
è
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

666 #ifdeà
__USE_GNU


673 #iâdeà
__USE_FILE_OFFSET64


674 
	$mko¡emp
 (*
__‹m¶©e
, 
__æags
è
	`__nÚnuÎ
 ((1)è
__wur
;

676 #ifdeà
__REDIRECT


677 
	`__REDIRECT
 (
mko¡emp
, (*
__‹m¶©e
, 
__æags
), 
mko¡emp64
)

678 
	`__nÚnuÎ
 ((1)è
__wur
;

680 
	#mko¡emp
 
mko¡emp64


	)

683 #ifdeà
__USE_LARGEFILE64


684 
	$mko¡emp64
 (*
__‹m¶©e
, 
__æags
è
	`__nÚnuÎ
 ((1)è
__wur
;

693 #iâdeà
__USE_FILE_OFFSET64


694 
	$mko¡emps
 (*
__‹m¶©e
, 
__suffixËn
, 
__æags
)

695 
	`__nÚnuÎ
 ((1)è
__wur
;

697 #ifdeà
__REDIRECT


698 
	`__REDIRECT
 (
mko¡emps
, (*
__‹m¶©e
, 
__suffixËn
,

699 
__æags
), 
mko¡emps64
)

700 
	`__nÚnuÎ
 ((1)è
__wur
;

702 
	#mko¡emps
 
mko¡emps64


	)

705 #ifdeà
__USE_LARGEFILE64


706 
	$mko¡emps64
 (*
__‹m¶©e
, 
__suffixËn
, 
__æags
)

707 
	`__nÚnuÎ
 ((1)è
__wur
;

712 
__BEGIN_NAMESPACE_STD


717 
	$sy¡em
 (cÚ¡ *
__commªd
è
__wur
;

718 
__END_NAMESPACE_STD


721 #ifdef 
__USE_GNU


724 *
	$ÿnÚiÿlize_fe_Çme
 (cÚ¡ *
__Çme
)

725 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

728 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED


734 *
	$»®·th
 (cÚ¡ *
__»¡riù
 
__Çme
,

735 *
__»¡riù
 
__»sŞved
è
__THROW
 
__wur
;

740 #iâdeà
__COMPAR_FN_T


741 
	#__COMPAR_FN_T


	)

742 (*
	t__com·r_â_t
) (const *, const *);

744 #ifdef 
__USE_GNU


745 
__com·r_â_t
 
	tcom·risÚ_â_t
;

748 #ifdeà
__USE_GNU


749 (*
	t__com·r_d_â_t
) (const *, const *, *);

752 
__BEGIN_NAMESPACE_STD


755 *
	$b£¬ch
 (cÚ¡ *
__key
, cÚ¡ *
__ba£
,

756 
size_t
 
__nmemb
, size_ˆ
__size
, 
__com·r_â_t
 
__com·r
)

757 
	`__nÚnuÎ
 ((1, 2, 5)è
__wur
;

759 #ifdeà
__USE_EXTERN_INLINES


760 
	~<b™s/¡dlib-b£¬ch.h
>

765 
	$qsÜt
 (*
__ba£
, 
size_t
 
__nmemb
, size_ˆ
__size
,

766 
__com·r_â_t
 
__com·r
è
	`__nÚnuÎ
 ((1, 4));

767 #ifdeà
__USE_GNU


768 
	$qsÜt_r
 (*
__ba£
, 
size_t
 
__nmemb
, size_ˆ
__size
,

769 
__com·r_d_â_t
 
__com·r
, *
__¬g
)

770 
	`__nÚnuÎ
 ((1, 4));

775 
	$abs
 (
__x
è
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
)è
__wur
;

776 
	$Ïbs
 (
__x
è
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
)è
__wur
;

777 
__END_NAMESPACE_STD


779 #ifdeà
__USE_ISOC99


780 
__ex‹nsiÚ__
 
	$Îabs
 (
__x
)

781 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
)è
__wur
;

785 
__BEGIN_NAMESPACE_STD


789 
div_t
 
	$div
 (
__num”
, 
__d’om
)

790 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
)è
__wur
;

791 
ldiv_t
 
	$ldiv
 (
__num”
, 
__d’om
)

792 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
)è
__wur
;

793 
__END_NAMESPACE_STD


795 #ifdeà
__USE_ISOC99


796 
__BEGIN_NAMESPACE_C99


797 
__ex‹nsiÚ__
 
Îdiv_t
 
	$Îdiv
 (
__num”
,

798 
__d’om
)

799 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
)è
__wur
;

800 
__END_NAMESPACE_C99


804 #ià(
defšed
 
__USE_XOPEN_EXTENDED
 && !defšed 
__USE_XOPEN2K8
) \

805 || 
defšed
 
__USE_SVID


812 *
	$ecvt
 (
__v®ue
, 
__ndig™
, *
__»¡riù
 
__deıt
,

813 *
__»¡riù
 
__sign
è
__THROW
 
	`__nÚnuÎ
 ((3, 4)è
__wur
;

818 *
	$fcvt
 (
__v®ue
, 
__ndig™
, *
__»¡riù
 
__deıt
,

819 *
__»¡riù
 
__sign
è
__THROW
 
	`__nÚnuÎ
 ((3, 4)è
__wur
;

824 *
	$gcvt
 (
__v®ue
, 
__ndig™
, *
__buf
)

825 
__THROW
 
	`__nÚnuÎ
 ((3)è
__wur
;

828 #ifdeà
__USE_MISC


830 *
	$qecvt
 (
__v®ue
, 
__ndig™
,

831 *
__»¡riù
 
__deıt
, *__»¡riù 
__sign
)

832 
__THROW
 
	`__nÚnuÎ
 ((3, 4)è
__wur
;

833 *
	$qfcvt
 (
__v®ue
, 
__ndig™
,

834 *
__»¡riù
 
__deıt
, *__»¡riù 
__sign
)

835 
__THROW
 
	`__nÚnuÎ
 ((3, 4)è
__wur
;

836 *
	$qgcvt
 (
__v®ue
, 
__ndig™
, *
__buf
)

837 
__THROW
 
	`__nÚnuÎ
 ((3)è
__wur
;

842 
	$ecvt_r
 (
__v®ue
, 
__ndig™
, *
__»¡riù
 
__deıt
,

843 *
__»¡riù
 
__sign
, *__»¡riù 
__buf
,

844 
size_t
 
__Ën
è
__THROW
 
	`__nÚnuÎ
 ((3, 4, 5));

845 
	$fcvt_r
 (
__v®ue
, 
__ndig™
, *
__»¡riù
 
__deıt
,

846 *
__»¡riù
 
__sign
, *__»¡riù 
__buf
,

847 
size_t
 
__Ën
è
__THROW
 
	`__nÚnuÎ
 ((3, 4, 5));

849 
	$qecvt_r
 (
__v®ue
, 
__ndig™
,

850 *
__»¡riù
 
__deıt
, *__»¡riù 
__sign
,

851 *
__»¡riù
 
__buf
, 
size_t
 
__Ën
)

852 
__THROW
 
	`__nÚnuÎ
 ((3, 4, 5));

853 
	$qfcvt_r
 (
__v®ue
, 
__ndig™
,

854 *
__»¡riù
 
__deıt
, *__»¡riù 
__sign
,

855 *
__»¡riù
 
__buf
, 
size_t
 
__Ën
)

856 
__THROW
 
	`__nÚnuÎ
 ((3, 4, 5));

860 
__BEGIN_NAMESPACE_STD


863 
	$mbËn
 (cÚ¡ *
__s
, 
size_t
 
__n
è
__THROW
;

866 
	$mbtowc
 (
wch¬_t
 *
__»¡riù
 
__pwc
,

867 cÚ¡ *
__»¡riù
 
__s
, 
size_t
 
__n
è
__THROW
;

870 
	$wùomb
 (*
__s
, 
wch¬_t
 
__wch¬
è
__THROW
;

874 
size_t
 
	$mb¡owcs
 (
wch¬_t
 *
__»¡riù
 
__pwcs
,

875 cÚ¡ *
__»¡riù
 
__s
, 
size_t
 
__n
è
__THROW
;

877 
size_t
 
	$wc¡ombs
 (*
__»¡riù
 
__s
,

878 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__pwcs
, 
size_t
 
__n
)

879 
__THROW
;

880 
__END_NAMESPACE_STD


883 #ifdeà
__USE_SVID


888 
	$½m©ch
 (cÚ¡ *
__»¥Ú£
è
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

892 #ià
defšed
 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K8


899 
	$g‘subİt
 (**
__»¡riù
 
__İtiÚp
,

900 *cÚ¡ *
__»¡riù
 
__tok’s
,

901 **
__»¡riù
 
__v®u•
)

902 
__THROW
 
	`__nÚnuÎ
 ((1, 2, 3)è
__wur
;

906 #ifdeà
__USE_XOPEN


908 
	$£tkey
 (cÚ¡ *
__key
è
__THROW
 
	`__nÚnuÎ
 ((1));

914 #ifdeà
__USE_XOPEN2KXSI


916 
	$posix_İ’±
 (
__oæag
è
__wur
;

919 #ifdeà
__USE_XOPEN


924 
	$g¿Á±
 (
__fd
è
__THROW
;

928 
	$uÆock±
 (
__fd
è
__THROW
;

933 *
	$±¢ame
 (
__fd
è
__THROW
 
__wur
;

936 #ifdeà
__USE_GNU


940 
	$±¢ame_r
 (
__fd
, *
__buf
, 
size_t
 
__buæ’
)

941 
__THROW
 
	`__nÚnuÎ
 ((2));

944 
	`g‘±
 ();

947 #ifdeà
__USE_BSD


951 
	$g‘lßdavg
 (
__lßdavg
[], 
__ÃËm
)

952 
__THROW
 
	`__nÚnuÎ
 ((1));

955 
	~<b™s/¡dlib-æßt.h
>

958 #ià
__USE_FORTIFY_LEVEL
 > 0 && 
defšed
 
__fÜtify_funùiÚ


959 
	~<b™s/¡dlib.h
>

961 #ifdeà
__LDBL_COMPAT


962 
	~<b™s/¡dlib-ldbl.h
>

966 #undeà
__Ãed_m®loc_ªd_ÿÎoc


968 
__END_DECLS


	@/usr/include/string.h

22 #iâdef 
_STRING_H


23 
	#_STRING_H
 1

	)

25 
	~<ã©u»s.h
>

27 
	g__BEGIN_DECLS


30 
	#__Ãed_size_t


	)

31 
	#__Ãed_NULL


	)

32 
	~<¡ddef.h
>

39 #ià
defšed
 
__ılu¥lus
 && (__ılu¥lu >ğ199711L || 
__GNUC_PREREQ
 (4, 4))

40 
	#__CORRECT_ISO_CPP_STRING_H_PROTO


	)

44 
__BEGIN_NAMESPACE_STD


46 *
	$memıy
 (*
__»¡riù
 
__de¡
, cÚ¡ *__»¡riù 
__¤c
,

47 
size_t
 
__n
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

50 *
	$memmove
 (*
__de¡
, cÚ¡ *
__¤c
, 
size_t
 
__n
)

51 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

52 
__END_NAMESPACE_STD


57 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_BSD
 || defšed 
__USE_XOPEN


58 *
	$memcıy
 (*
__»¡riù
 
__de¡
, cÚ¡ *__»¡riù 
__¤c
,

59 
__c
, 
size_t
 
__n
)

60 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

64 
__BEGIN_NAMESPACE_STD


66 *
	$mem£t
 (*
__s
, 
__c
, 
size_t
 
__n
è
__THROW
 
	`__nÚnuÎ
 ((1));

69 
	$memcmp
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
, 
size_t
 
__n
)

70 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

73 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


76 *
	`memchr
 (*
__s
, 
__c
, 
size_t
 
__n
)

77 
__THROW
 
	`__asm
 ("memchr"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

78 cÚ¡ *
	`memchr
 (cÚ¡ *
__s
, 
__c
, 
size_t
 
__n
)

79 
__THROW
 
	`__asm
 ("memchr"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

81 #ifdeà
__OPTIMIZE__


82 
__ex‹º_®ways_šlše
 *

83 
	`memchr
 (*
__s
, 
__c
, 
size_t
 
__n
è
__THROW


85  
	`__butš_memchr
 (
__s
, 
__c
, 
__n
);

88 
__ex‹º_®ways_šlše
 const *

89 
	`memchr
 (cÚ¡ *
__s
, 
__c
, 
size_t
 
__n
è
__THROW


91  
	`__butš_memchr
 (
__s
, 
__c
, 
__n
);

94 
	}
}

96 *
	$memchr
 (cÚ¡ *
__s
, 
__c
, 
size_t
 
__n
)

97 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

99 
__END_NAMESPACE_STD


101 #ifdeà
__USE_GNU


104 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


105 "C++" *
	$¿wmemchr
 (*
__s
, 
__c
)

106 
__THROW
 
	`__asm
 ("¿wmemchr"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

107 "C++" cÚ¡ *
	$¿wmemchr
 (cÚ¡ *
__s
, 
__c
)

108 
__THROW
 
	`__asm
 ("¿wmemchr"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

110 *
	$¿wmemchr
 (cÚ¡ *
__s
, 
__c
)

111 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

115 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


116 "C++" *
	$memrchr
 (*
__s
, 
__c
, 
size_t
 
__n
)

117 
__THROW
 
	`__asm
 ("memrchr"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

118 "C++" cÚ¡ *
	$memrchr
 (cÚ¡ *
__s
, 
__c
, 
size_t
 
__n
)

119 
__THROW
 
	`__asm
 ("memrchr"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

121 *
	$memrchr
 (cÚ¡ *
__s
, 
__c
, 
size_t
 
__n
)

122 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

127 
__BEGIN_NAMESPACE_STD


129 *
	$¡rıy
 (*
__»¡riù
 
__de¡
, cÚ¡ *__»¡riù 
__¤c
)

130 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

132 *
	$¡ºıy
 (*
__»¡riù
 
__de¡
,

133 cÚ¡ *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

134 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

137 *
	$¡rÿt
 (*
__»¡riù
 
__de¡
, cÚ¡ *__»¡riù 
__¤c
)

138 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

140 *
	$¡ºÿt
 (*
__»¡riù
 
__de¡
, cÚ¡ *__»¡riù 
__¤c
,

141 
size_t
 
__n
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

144 
	$¡rcmp
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
)

145 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

147 
	$¡ºcmp
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
, 
size_t
 
__n
)

148 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

151 
	$¡rcŞl
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
)

152 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

154 
size_t
 
	$¡rxäm
 (*
__»¡riù
 
__de¡
,

155 cÚ¡ *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

156 
__THROW
 
	`__nÚnuÎ
 ((2));

157 
__END_NAMESPACE_STD


159 #ifdeà
__USE_XOPEN2K8


163 
	~<xloÿË.h
>

166 
	$¡rcŞl_l
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
, 
__loÿË_t
 
__l
)

167 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2, 3));

169 
size_t
 
	$¡rxäm_l
 (*
__de¡
, cÚ¡ *
__¤c
, 
size_t
 
__n
,

170 
__loÿË_t
 
__l
è
__THROW
 
	`__nÚnuÎ
 ((2, 4));

173 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED
 \

174 || 
defšed
 
__USE_XOPEN2K8


176 *
	$¡rdup
 (cÚ¡ *
__s
)

177 
__THROW
 
__©Œibu‹_m®loc__
 
	`__nÚnuÎ
 ((1));

183 #ià
defšed
 
__USE_XOPEN2K8


184 *
	$¡ºdup
 (cÚ¡ *
__¡ršg
, 
size_t
 
__n
)

185 
__THROW
 
__©Œibu‹_m®loc__
 
	`__nÚnuÎ
 ((1));

188 #ià
defšed
 
__USE_GNU
 && defšed 
__GNUC__


190 
	#¡rdu·
(
s
) \

191 (
__ex‹nsiÚ__
 \

193 cÚ¡ *
__Şd
 = (
s
); \

194 
size_t
 
__Ën
 = 
	`¡¾’
 (
__Şd
) + 1; \

195 *
__Ãw
 = (*è
	`__butš_®loÿ
 (
__Ën
); \

196 (*è
	`memıy
 (
__Ãw
, 
__Şd
, 
__Ën
); \

197 
	}
}))

	)

200 
	#¡ºdu·
(
s
, 
n
) \

201 (
__ex‹nsiÚ__
 \

203 cÚ¡ *
__Şd
 = (
s
); \

204 
size_t
 
__Ën
 = 
	`¡ºËn
 (
__Şd
, (
n
)); \

205 *
__Ãw
 = (*è
	`__butš_®loÿ
 (
__Ën
 + 1); \

206 
__Ãw
[
__Ën
] = '\0'; \

207 (*è
	`memıy
 (
__Ãw
, 
__Şd
, 
__Ën
); \

208 }))

	)

211 
	g__BEGIN_NAMESPACE_STD


213 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


216 *
¡rchr
 (*
__s
, 
__c
)

217 
__THROW
 
__asm
 ("¡rchr"è
__©Œibu‹_pu»__
 
__nÚnuÎ
 ((1));

218 cÚ¡ *
¡rchr
 (cÚ¡ *
__s
, 
__c
)

219 
__THROW
 
__asm
 ("¡rchr"è
__©Œibu‹_pu»__
 
__nÚnuÎ
 ((1));

221 #ifdeà
__OPTIMIZE__


222 
__ex‹º_®ways_šlše
 *

223 
¡rchr
 (*
__s
, 
__c
è
	g__THROW


225  
__butš_¡rchr
 (
__s
, 
__c
);

228 
__ex‹º_®ways_šlše
 const *

229 
¡rchr
 (cÚ¡ *
__s
, 
__c
è
	g__THROW


231  
__butš_¡rchr
 (
__s
, 
__c
);

236 *
	$¡rchr
 (cÚ¡ *
__s
, 
__c
)

237 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

240 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


243 *
	`¡¼chr
 (*
__s
, 
__c
)

244 
__THROW
 
	`__asm
 ("¡¼chr"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

245 cÚ¡ *
	`¡¼chr
 (cÚ¡ *
__s
, 
__c
)

246 
__THROW
 
	`__asm
 ("¡¼chr"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

248 #ifdeà
__OPTIMIZE__


249 
__ex‹º_®ways_šlše
 *

250 
	`¡¼chr
 (*
__s
, 
__c
è
__THROW


252  
	`__butš_¡¼chr
 (
__s
, 
__c
);

255 
__ex‹º_®ways_šlše
 const *

256 
	`¡¼chr
 (cÚ¡ *
__s
, 
__c
è
__THROW


258  
	`__butš_¡¼chr
 (
__s
, 
__c
);

261 
	}
}

263 *
	$¡¼chr
 (cÚ¡ *
__s
, 
__c
)

264 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

266 
__END_NAMESPACE_STD


268 #ifdeà
__USE_GNU


271 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


272 "C++" *
	$¡rchºul
 (*
__s
, 
__c
)

273 
__THROW
 
	`__asm
 ("¡rchºul"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

274 "C++" cÚ¡ *
	$¡rchºul
 (cÚ¡ *
__s
, 
__c
)

275 
__THROW
 
	`__asm
 ("¡rchºul"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

277 *
	$¡rchºul
 (cÚ¡ *
__s
, 
__c
)

278 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

282 
__BEGIN_NAMESPACE_STD


285 
size_t
 
	$¡rc¥n
 (cÚ¡ *
__s
, cÚ¡ *
__»jeù
)

286 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

289 
size_t
 
	$¡r¥n
 (cÚ¡ *
__s
, cÚ¡ *
__acû±
)

290 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

292 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


295 *
	`¡½brk
 (*
__s
, cÚ¡ *
__acû±
)

296 
__THROW
 
	`__asm
 ("¡½brk"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

297 cÚ¡ *
	`¡½brk
 (cÚ¡ *
__s
, cÚ¡ *
__acû±
)

298 
__THROW
 
	`__asm
 ("¡½brk"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

300 #ifdeà
__OPTIMIZE__


301 
__ex‹º_®ways_šlše
 *

302 
	`¡½brk
 (*
__s
, cÚ¡ *
__acû±
è
__THROW


304  
	`__butš_¡½brk
 (
__s
, 
__acû±
);

307 
__ex‹º_®ways_šlše
 const *

308 
	`¡½brk
 (cÚ¡ *
__s
, cÚ¡ *
__acû±
è
__THROW


310  
	`__butš_¡½brk
 (
__s
, 
__acû±
);

313 
	}
}

315 *
	$¡½brk
 (cÚ¡ *
__s
, cÚ¡ *
__acû±
)

316 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

319 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


322 *
	`¡r¡r
 (*
__hay¡ack
, cÚ¡ *
__ÃedË
)

323 
__THROW
 
	`__asm
 ("¡r¡r"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

324 cÚ¡ *
	`¡r¡r
 (cÚ¡ *
__hay¡ack
, cÚ¡ *
__ÃedË
)

325 
__THROW
 
	`__asm
 ("¡r¡r"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

327 #ifdeà
__OPTIMIZE__


328 
__ex‹º_®ways_šlše
 *

329 
	`¡r¡r
 (*
__hay¡ack
, cÚ¡ *
__ÃedË
è
__THROW


331  
	`__butš_¡r¡r
 (
__hay¡ack
, 
__ÃedË
);

334 
__ex‹º_®ways_šlše
 const *

335 
	`¡r¡r
 (cÚ¡ *
__hay¡ack
, cÚ¡ *
__ÃedË
è
__THROW


337  
	`__butš_¡r¡r
 (
__hay¡ack
, 
__ÃedË
);

340 
	}
}

342 *
	$¡r¡r
 (cÚ¡ *
__hay¡ack
, cÚ¡ *
__ÃedË
)

343 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

348 *
	$¡¹ok
 (*
__»¡riù
 
__s
, cÚ¡ *__»¡riù 
__d–im
)

349 
__THROW
 
	`__nÚnuÎ
 ((2));

350 
__END_NAMESPACE_STD


354 *
	$__¡¹ok_r
 (*
__»¡riù
 
__s
,

355 cÚ¡ *
__»¡riù
 
__d–im
,

356 **
__»¡riù
 
__§ve_±r
)

357 
__THROW
 
	`__nÚnuÎ
 ((2, 3));

358 #ià
defšed
 
__USE_POSIX
 || defšed 
__USE_MISC


359 *
	$¡¹ok_r
 (*
__»¡riù
 
__s
, cÚ¡ *__»¡riù 
__d–im
,

360 **
__»¡riù
 
__§ve_±r
)

361 
__THROW
 
	`__nÚnuÎ
 ((2, 3));

364 #ifdeà
__USE_GNU


366 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


367 "C++" *
	$¡rÿ£¡r
 (*
__hay¡ack
, cÚ¡ *
__ÃedË
)

368 
__THROW
 
	`__asm
 ("¡rÿ£¡r"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

369 "C++" cÚ¡ *
	$¡rÿ£¡r
 (cÚ¡ *
__hay¡ack
,

370 cÚ¡ *
__ÃedË
)

371 
__THROW
 
	`__asm
 ("¡rÿ£¡r"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

373 *
	$¡rÿ£¡r
 (cÚ¡ *
__hay¡ack
, cÚ¡ *
__ÃedË
)

374 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

378 #ifdeà
__USE_GNU


382 *
	$memmem
 (cÚ¡ *
__hay¡ack
, 
size_t
 
__hay¡ackËn
,

383 cÚ¡ *
__ÃedË
, 
size_t
 
__ÃedËËn
)

384 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 3));

388 *
	$__mempıy
 (*
__»¡riù
 
__de¡
,

389 cÚ¡ *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

390 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

391 *
	$mempıy
 (*
__»¡riù
 
__de¡
,

392 cÚ¡ *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

393 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

397 
__BEGIN_NAMESPACE_STD


399 
size_t
 
	$¡¾’
 (cÚ¡ *
__s
)

400 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

401 
__END_NAMESPACE_STD


403 #ifdef 
__USE_XOPEN2K8


406 
size_t
 
	$¡ºËn
 (cÚ¡ *
__¡ršg
, 
size_t
 
__maxËn
)

407 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

411 
__BEGIN_NAMESPACE_STD


413 *
	$¡»¼Ü
 (
__”ºum
è
__THROW
;

414 
__END_NAMESPACE_STD


415 #ià
defšed
 
__USE_XOPEN2K
 || defšed 
__USE_MISC


423 #ià
defšed
 
__USE_XOPEN2K
 && !defšed 
__USE_GNU


426 #ifdeà
__REDIRECT_NTH


427 
	`__REDIRECT_NTH
 (
¡»¼Ü_r
,

428 (
__”ºum
, *
__buf
, 
size_t
 
__buæ’
),

429 
__xpg_¡»¼Ü_r
è
	`__nÚnuÎ
 ((2));

431 
	$__xpg_¡»¼Ü_r
 (
__”ºum
, *
__buf
, 
size_t
 
__buæ’
)

432 
__THROW
 
	`__nÚnuÎ
 ((2));

433 
	#¡»¼Ü_r
 
__xpg_¡»¼Ü_r


	)

438 *
	$¡»¼Ü_r
 (
__”ºum
, *
__buf
, 
size_t
 
__buæ’
)

439 
__THROW
 
	`__nÚnuÎ
 ((2)è
__wur
;

443 #ifdeà
__USE_XOPEN2K8


445 *
	$¡»¼Ü_l
 (
__”ºum
, 
__loÿË_t
 
__l
è
__THROW
;

451 
	$__bz”o
 (*
__s
, 
size_t
 
__n
è
__THROW
 
	`__nÚnuÎ
 ((1));

453 #ifdeà
__USE_BSD


455 
	$bcİy
 (cÚ¡ *
__¤c
, *
__de¡
, 
size_t
 
__n
)

456 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

459 
	$bz”o
 (*
__s
, 
size_t
 
__n
è
__THROW
 
	`__nÚnuÎ
 ((1));

462 
	$bcmp
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
, 
size_t
 
__n
)

463 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

466 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


469 *
	`šdex
 (*
__s
, 
__c
)

470 
__THROW
 
	`__asm
 ("šdex"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

471 cÚ¡ *
	`šdex
 (cÚ¡ *
__s
, 
__c
)

472 
__THROW
 
	`__asm
 ("šdex"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

474 #ià
defšed
 
__OPTIMIZE__
 && !defšed 
__CORRECT_ISO_CPP_STRINGS_H_PROTO


475 
__ex‹º_®ways_šlše
 *

476 
	`šdex
 (*
__s
, 
__c
è
__THROW


478  
	`__butš_šdex
 (
__s
, 
__c
);

481 
__ex‹º_®ways_šlše
 const *

482 
	`šdex
 (cÚ¡ *
__s
, 
__c
è
__THROW


484  
	`__butš_šdex
 (
__s
, 
__c
);

487 
	}
}

489 *
	$šdex
 (cÚ¡ *
__s
, 
__c
)

490 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

494 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


497 *
	`ršdex
 (*
__s
, 
__c
)

498 
__THROW
 
	`__asm
 ("ršdex"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

499 cÚ¡ *
	`ršdex
 (cÚ¡ *
__s
, 
__c
)

500 
__THROW
 
	`__asm
 ("ršdex"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

502 #ià
defšed
 
__OPTIMIZE__
 && !defšed 
__CORRECT_ISO_CPP_STRINGS_H_PROTO


503 
__ex‹º_®ways_šlše
 *

504 
	`ršdex
 (*
__s
, 
__c
è
__THROW


506  
	`__butš_ršdex
 (
__s
, 
__c
);

509 
__ex‹º_®ways_šlše
 const *

510 
	`ršdex
 (cÚ¡ *
__s
, 
__c
è
__THROW


512  
	`__butš_ršdex
 (
__s
, 
__c
);

515 
	}
}

517 *
	$ršdex
 (cÚ¡ *
__s
, 
__c
)

518 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

523 
	$ffs
 (
__i
è
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

527 #ifdef 
__USE_GNU


528 
	$ff¦
 (
__l
è
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

529 
__ex‹nsiÚ__
 
	$ff¦l
 (
__Î
)

530 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

534 
	$¡rÿ£cmp
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
)

535 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

538 
	$¡ºÿ£cmp
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
, 
size_t
 
__n
)

539 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

542 #ifdef 
__USE_GNU


545 
	$¡rÿ£cmp_l
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
,

546 
__loÿË_t
 
__loc
)

547 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2, 3));

549 
	$¡ºÿ£cmp_l
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
,

550 
size_t
 
__n
, 
__loÿË_t
 
__loc
)

551 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2, 4));

554 #ifdef 
__USE_BSD


557 *
	$¡r£p
 (**
__»¡riù
 
__¡ršgp
,

558 cÚ¡ *
__»¡riù
 
__d–im
)

559 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

562 #ifdef 
__USE_XOPEN2K8


564 *
	$¡rsigÇl
 (
__sig
è
__THROW
;

567 *
	$__¡pıy
 (*
__»¡riù
 
__de¡
, cÚ¡ *__»¡riù 
__¤c
)

568 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

569 *
	$¡pıy
 (*
__»¡riù
 
__de¡
, cÚ¡ *__»¡riù 
__¤c
)

570 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

574 *
	$__¡²ıy
 (*
__»¡riù
 
__de¡
,

575 cÚ¡ *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

576 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

577 *
	$¡²ıy
 (*
__»¡riù
 
__de¡
,

578 cÚ¡ *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

579 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

582 #ifdef 
__USE_GNU


584 
	$¡rv”scmp
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
)

585 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

588 *
	$¡räy
 (*
__¡ršg
è
__THROW
 
	`__nÚnuÎ
 ((1));

591 *
	$memäob
 (*
__s
, 
size_t
 
__n
è
__THROW
 
	`__nÚnuÎ
 ((1));

593 #iâdeà
ba£Çme


598 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


599 "C++" *
	$ba£Çme
 (*
__f’ame
)

600 
__THROW
 
	`__asm
 ("ba£Çme"è
	`__nÚnuÎ
 ((1));

601 "C++" cÚ¡ *
	$ba£Çme
 (cÚ¡ *
__f’ame
)

602 
__THROW
 
	`__asm
 ("ba£Çme"è
	`__nÚnuÎ
 ((1));

604 *
	$ba£Çme
 (cÚ¡ *
__f’ame
è
__THROW
 
	`__nÚnuÎ
 ((1));

610 #ià
defšed
 
__GNUC__
 && __GNUC__ >= 2

611 #ià
defšed
 
__OPTIMIZE__
 && !defšed 
__OPTIMIZE_SIZE__
 \

612 && !
defšed
 
__NO_INLINE__
 && !defšed 
__ılu¥lus


632 
	~<b™s/¡ršg.h
>

635 
	~<b™s/¡ršg2.h
>

638 #ià
__USE_FORTIFY_LEVEL
 > 0 && 
defšed
 
__fÜtify_funùiÚ


640 
	~<b™s/¡ršg3.h
>

644 
__END_DECLS


	@/usr/include/time.h

22 #iâdef 
_TIME_H


24 #ià(! 
defšed
 
__Ãed_time_t
 && !defšed 
__Ãed_şock_t
 && \

25 ! 
defšed
 
	g__Ãed_time¥ec
)

26 
	#_TIME_H
 1

	)

27 
	~<ã©u»s.h
>

29 
	g__BEGIN_DECLS


33 #ifdef 
_TIME_H


35 
	#__Ãed_size_t


	)

36 
	#__Ãed_NULL


	)

37 
	~<¡ddef.h
>

41 
	~<b™s/time.h
>

44 #ià!
defšed
 
__STRICT_ANSI__
 && !defšed 
__USE_XOPEN2K


45 #iâdeà
CLK_TCK


46 
	#CLK_TCK
 
CLOCKS_PER_SEC


	)

52 #ià!
defšed
 
__şock_t_defšed
 && (defšed 
_TIME_H
 || defšed 
__Ãed_şock_t
)

53 
	#__şock_t_defšed
 1

	)

55 
	~<b™s/ty³s.h
>

57 
__BEGIN_NAMESPACE_STD


59 
__şock_t
 
	tşock_t
;

60 
	g__END_NAMESPACE_STD


61 #ià
defšed
 
__USE_XOPEN
 || defšed 
__USE_POSIX
 || defšed 
__USE_MISC


62 
	$__USING_NAMESPACE_STD
(
şock_t
)

66 #undeà
__Ãed_şock_t


68 #ià!
defšed
 
__time_t_defšed
 && (defšed 
_TIME_H
 || defšed 
__Ãed_time_t
)

69 
	#__time_t_defšed
 1

	)

71 
	~<b™s/ty³s.h
>

73 
__BEGIN_NAMESPACE_STD


75 
__time_t
 
	ttime_t
;

76 
__END_NAMESPACE_STD


77 #ià
defšed
 
__USE_POSIX
 || defšed 
__USE_MISC
 || defšed 
__USE_SVID


78 
	$__USING_NAMESPACE_STD
(
time_t
)

82 #undeà
__Ãed_time_t


84 #ià!
defšed
 
__şockid_t_defšed
 && \

85 ((
defšed
 
_TIME_H
 && defšed 
__USE_POSIX199309
è|| defšed 
__Ãed_şockid_t
)

86 
	#__şockid_t_defšed
 1

	)

88 
	~<b™s/ty³s.h
>

91 
__şockid_t
 
	tşockid_t
;

94 #undeà
__şockid_time_t


96 #ià!
defšed
 
__tim”_t_defšed
 && \

97 ((
defšed
 
_TIME_H
 && defšed 
__USE_POSIX199309
è|| defšed 
__Ãed_tim”_t
)

98 
	#__tim”_t_defšed
 1

	)

100 
	~<b™s/ty³s.h
>

103 
__tim”_t
 
	ttim”_t
;

106 #undeà
__Ãed_tim”_t


109 #ià(!
defšed
 
__time¥ec_defšed
 \

110 && ((
defšed
 
_TIME_H
 \

111 && (
defšed
 
__USE_POSIX199309
 || defšed 
__USE_MISC
 \

112 || 
defšed
 
__USE_ISOC11
)) \

113 || 
defšed
 
__Ãed_time¥ec
))

114 
	#__time¥ec_defšed
 1

	)

116 
	~<b™s/ty³s.h
>

120 
	stime¥ec


122 
__time_t
 
tv_£c
;

123 
__sysÿÎ_¦Úg_t
 
tv_n£c
;

127 #undeà
__Ãed_time¥ec


130 #ifdef 
_TIME_H


131 
__BEGIN_NAMESPACE_STD


133 
	stm


135 
tm_£c
;

136 
tm_mš
;

137 
tm_hour
;

138 
tm_mday
;

139 
tm_mÚ
;

140 
tm_y—r
;

141 
tm_wday
;

142 
tm_yday
;

143 
tm_isd¡
;

145 #ifdef 
__USE_BSD


146 
tm_gmtoff
;

147 cÚ¡ *
tm_zÚe
;

149 
__tm_gmtoff
;

150 cÚ¡ *
__tm_zÚe
;

153 
__END_NAMESPACE_STD


154 #ià
defšed
 
__USE_XOPEN
 || defšed 
__USE_POSIX
 || defšed 
__USE_MISC


155 
	$__USING_NAMESPACE_STD
(
tm
)

159 #ifdeà
__USE_POSIX199309


161 
	s™im”¥ec


163 
time¥ec
 
™_š‹rv®
;

164 
time¥ec
 
™_v®ue
;

168 
sigev’t
;

172 #ifdeà
__USE_XOPEN2K


173 #iâdeà
__pid_t_defšed


174 
__pid_t
 
	tpid_t
;

175 
	#__pid_t_defšed


	)

180 #ifdeà
__USE_ISOC11


182 
	#TIME_UTC
 1

	)

186 
__BEGIN_NAMESPACE_STD


189 
şock_t
 
	$şock
 (è
__THROW
;

192 
time_t
 
	$time
 (
time_t
 *
__tim”
è
__THROW
;

195 
	$difáime
 (
time_t
 
__time1
,ime_ˆ
__time0
)

196 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

199 
time_t
 
	$mktime
 (
tm
 *
__
è
__THROW
;

205 
size_t
 
	$¡ráime
 (*
__»¡riù
 
__s
, 
size_t
 
__maxsize
,

206 cÚ¡ *
__»¡riù
 
__fÜm©
,

207 cÚ¡ 
tm
 *
__»¡riù
 
__
è
__THROW
;

208 
__END_NAMESPACE_STD


210 #ifdeà
__USE_XOPEN


213 *
	$¡½time
 (cÚ¡ *
__»¡riù
 
__s
,

214 cÚ¡ *
__»¡riù
 
__fmt
, 
tm
 *
__
)

215 
__THROW
;

218 #ifdeà
__USE_XOPEN2K8


221 
	~<xloÿË.h
>

223 
size_t
 
	$¡ráime_l
 (*
__»¡riù
 
__s
, 
size_t
 
__maxsize
,

224 cÚ¡ *
__»¡riù
 
__fÜm©
,

225 cÚ¡ 
tm
 *
__»¡riù
 
__
,

226 
__loÿË_t
 
__loc
è
__THROW
;

229 #ifdeà
__USE_GNU


230 *
	$¡½time_l
 (cÚ¡ *
__»¡riù
 
__s
,

231 cÚ¡ *
__»¡riù
 
__fmt
, 
tm
 *
__
,

232 
__loÿË_t
 
__loc
è
__THROW
;

236 
__BEGIN_NAMESPACE_STD


239 
tm
 *
	$gmtime
 (cÚ¡ 
time_t
 *
__tim”
è
__THROW
;

243 
tm
 *
	$loÿÉime
 (cÚ¡ 
time_t
 *
__tim”
è
__THROW
;

244 
__END_NAMESPACE_STD


246 #ià
defšed
 
__USE_POSIX
 || defšed 
__USE_MISC


249 
tm
 *
	$gmtime_r
 (cÚ¡ 
time_t
 *
__»¡riù
 
__tim”
,

250 
tm
 *
__»¡riù
 
__
è
__THROW
;

254 
tm
 *
	$loÿÉime_r
 (cÚ¡ 
time_t
 *
__»¡riù
 
__tim”
,

255 
tm
 *
__»¡riù
 
__
è
__THROW
;

258 
__BEGIN_NAMESPACE_STD


261 *
	$asùime
 (cÚ¡ 
tm
 *
__
è
__THROW
;

264 *
	$ùime
 (cÚ¡ 
time_t
 *
__tim”
è
__THROW
;

265 
__END_NAMESPACE_STD


267 #ià
defšed
 
__USE_POSIX
 || defšed 
__USE_MISC


272 *
	$asùime_r
 (cÚ¡ 
tm
 *
__»¡riù
 
__
,

273 *
__»¡riù
 
__buf
è
__THROW
;

276 *
	$ùime_r
 (cÚ¡ 
time_t
 *
__»¡riù
 
__tim”
,

277 *
__»¡riù
 
__buf
è
__THROW
;

282 *
__tzÇme
[2];

283 
__daylight
;

284 
__timezÚe
;

287 #ifdef 
__USE_POSIX


289 *
tzÇme
[2];

293 
	$tz£t
 (è
__THROW
;

296 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_XOPEN


297 
daylight
;

298 
timezÚe
;

301 #ifdeà
__USE_SVID


304 
	$¡ime
 (cÚ¡ 
time_t
 *
__wh’
è
__THROW
;

310 
	#__i¦—p
(
y—r
) \

311 ((
y—r
è% 4 =ğ0 && ((y—rè% 100 !ğ0 || (y—rè% 400 =ğ0))

	)

314 #ifdeà
__USE_MISC


319 
time_t
 
	$timegm
 (
tm
 *
__
è
__THROW
;

322 
time_t
 
	$tim–oÿl
 (
tm
 *
__
è
__THROW
;

325 
	$dysize
 (
__y—r
è
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

329 #ifdeà
__USE_POSIX199309


334 
	`Çno¦“p
 (cÚ¡ 
time¥ec
 *
__»que¡ed_time
,

335 
time¥ec
 *
__»maššg
);

339 
	$şock_g‘»s
 (
şockid_t
 
__şock_id
, 
time¥ec
 *
__»s
è
__THROW
;

342 
	$şock_g‘time
 (
şockid_t
 
__şock_id
, 
time¥ec
 *
__
è
__THROW
;

345 
	$şock_£‰ime
 (
şockid_t
 
__şock_id
, cÚ¡ 
time¥ec
 *
__
)

346 
__THROW
;

348 #ifdeà
__USE_XOPEN2K


353 
	`şock_Çno¦“p
 (
şockid_t
 
__şock_id
, 
__æags
,

354 cÚ¡ 
time¥ec
 *
__»q
,

355 
time¥ec
 *
__»m
);

358 
	$şock_g‘ıuşockid
 (
pid_t
 
__pid
, 
şockid_t
 *
__şock_id
è
__THROW
;

363 
	$tim”_ü—‹
 (
şockid_t
 
__şock_id
,

364 
sigev’t
 *
__»¡riù
 
__evp
,

365 
tim”_t
 *
__»¡riù
 
__tim”id
è
__THROW
;

368 
	$tim”_d–‘e
 (
tim”_t
 
__tim”id
è
__THROW
;

371 
	$tim”_£‰ime
 (
tim”_t
 
__tim”id
, 
__æags
,

372 cÚ¡ 
™im”¥ec
 *
__»¡riù
 
__v®ue
,

373 
™im”¥ec
 *
__»¡riù
 
__ov®ue
è
__THROW
;

376 
	$tim”_g‘time
 (
tim”_t
 
__tim”id
, 
™im”¥ec
 *
__v®ue
)

377 
__THROW
;

380 
	$tim”_g‘ov”run
 (
tim”_t
 
__tim”id
è
__THROW
;

384 #ifdeà
__USE_ISOC11


386 
	$time¥ec_g‘
 (
time¥ec
 *
__ts
, 
__ba£
)

387 
__THROW
 
	`__nÚnuÎ
 ((1));

391 #ifdeà
__USE_XOPEN_EXTENDED


403 
g‘d©e_”r
;

412 
tm
 *
	`g‘d©e
 (cÚ¡ *
__¡ršg
);

415 #ifdeà
__USE_GNU


426 
	`g‘d©e_r
 (cÚ¡ *
__»¡riù
 
__¡ršg
,

427 
tm
 *
__»¡riù
 
__»sbuå
);

430 
__END_DECLS


	@/usr/include/unistd.h

22 #iâdef 
_UNISTD_H


23 
	#_UNISTD_H
 1

	)

25 
	~<ã©u»s.h
>

27 
	g__BEGIN_DECLS


32 #ifdeà
__USE_XOPEN2K8


34 
	#_POSIX_VERSION
 200809L

	)

35 #–ià
defšed
 
__USE_XOPEN2K


37 
	#_POSIX_VERSION
 200112L

	)

38 #–ià
defšed
 
__USE_POSIX199506


40 
	#_POSIX_VERSION
 199506L

	)

41 #–ià
defšed
 
__USE_POSIX199309


43 
	#_POSIX_VERSION
 199309L

	)

46 
	#_POSIX_VERSION
 199009L

	)

52 #ifdeà
__USE_XOPEN2K8


53 
	#__POSIX2_THIS_VERSION
 200809L

	)

55 #–ià
defšed
 
__USE_XOPEN2K


57 
	#__POSIX2_THIS_VERSION
 200112L

	)

58 #–ià
defšed
 
__USE_POSIX199506


60 
	#__POSIX2_THIS_VERSION
 199506L

	)

63 
	#__POSIX2_THIS_VERSION
 199209L

	)

67 
	#_POSIX2_VERSION
 
__POSIX2_THIS_VERSION


	)

71 
	#_POSIX2_C_BIND
 
__POSIX2_THIS_VERSION


	)

75 
	#_POSIX2_C_DEV
 
__POSIX2_THIS_VERSION


	)

79 
	#_POSIX2_SW_DEV
 
__POSIX2_THIS_VERSION


	)

83 
	#_POSIX2_LOCALEDEF
 
__POSIX2_THIS_VERSION


	)

86 #ifdeà
__USE_XOPEN2K8


87 
	#_XOPEN_VERSION
 700

	)

88 #–ià
defšed
 
__USE_XOPEN2K


89 
	#_XOPEN_VERSION
 600

	)

90 #–ià
defšed
 
__USE_UNIX98


91 
	#_XOPEN_VERSION
 500

	)

93 
	#_XOPEN_VERSION
 4

	)

97 
	#_XOPEN_XCU_VERSION
 4

	)

100 
	#_XOPEN_XPG2
 1

	)

101 
	#_XOPEN_XPG3
 1

	)

102 
	#_XOPEN_XPG4
 1

	)

105 
	#_XOPEN_UNIX
 1

	)

108 
	#_XOPEN_CRYPT
 1

	)

112 
	#_XOPEN_ENH_I18N
 1

	)

115 
	#_XOPEN_LEGACY
 1

	)

202 
	~<b™s/posix_İt.h
>

205 #ià
defšed
 
__USE_UNIX98
 || defšed 
__USE_XOPEN2K


206 
	~<b™s/’vœÚm’ts.h
>

210 
	#STDIN_FILENO
 0

	)

211 
	#STDOUT_FILENO
 1

	)

212 
	#STDERR_FILENO
 2

	)

217 
	~<b™s/ty³s.h
>

219 #iâdef 
__ssize_t_defšed


220 
__ssize_t
 
	tssize_t
;

221 
	#__ssize_t_defšed


	)

224 
	#__Ãed_size_t


	)

225 
	#__Ãed_NULL


	)

226 
	~<¡ddef.h
>

228 #ià
defšed
 
__USE_XOPEN
 || defšed 
__USE_XOPEN2K


231 #iâdeà
__gid_t_defšed


232 
__gid_t
 
	tgid_t
;

233 
	#__gid_t_defšed


	)

236 #iâdeà
__uid_t_defšed


237 
__uid_t
 
	tuid_t
;

238 
	#__uid_t_defšed


	)

241 #iâdeà
__off_t_defšed


242 #iâdeà
__USE_FILE_OFFSET64


243 
__off_t
 
	toff_t
;

245 
__off64_t
 
	toff_t
;

247 
	#__off_t_defšed


	)

249 #ià
defšed
 
__USE_LARGEFILE64
 && !defšed 
__off64_t_defšed


250 
__off64_t
 
	toff64_t
;

251 
	#__off64_t_defšed


	)

254 #iâdeà
__u£cÚds_t_defšed


255 
__u£cÚds_t
 
	tu£cÚds_t
;

256 
	#__u£cÚds_t_defšed


	)

259 #iâdeà
__pid_t_defšed


260 
__pid_t
 
	tpid_t
;

261 
	#__pid_t_defšed


	)

265 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K


266 #iâdeà
__šŒ_t_defšed


267 
__šŒ_t
 
	tšŒ_t
;

268 
	#__šŒ_t_defšed


	)

272 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN


273 #iâdeà
__sockËn_t_defšed


274 
__sockËn_t
 
	tsockËn_t
;

275 
	#__sockËn_t_defšed


	)

281 
	#R_OK
 4

	)

282 
	#W_OK
 2

	)

283 
	#X_OK
 1

	)

284 
	#F_OK
 0

	)

287 
	$acûss
 (cÚ¡ *
__Çme
, 
__ty³
è
__THROW
 
	`__nÚnuÎ
 ((1));

289 #ifdeà
__USE_GNU


292 
	$euidacûss
 (cÚ¡ *
__Çme
, 
__ty³
)

293 
__THROW
 
	`__nÚnuÎ
 ((1));

296 
	$—cûss
 (cÚ¡ *
__Çme
, 
__ty³
)

297 
__THROW
 
	`__nÚnuÎ
 ((1));

300 #ifdeà
__USE_ATFILE


304 
	$çcûs§t
 (
__fd
, cÚ¡ *
__fe
, 
__ty³
, 
__æag
)

305 
__THROW
 
	`__nÚnuÎ
 ((2)è
__wur
;

310 #iâdef 
_STDIO_H


311 
	#SEEK_SET
 0

	)

312 
	#SEEK_CUR
 1

	)

313 
	#SEEK_END
 2

	)

314 #ifdeà
__USE_GNU


315 
	#SEEK_DATA
 3

	)

316 
	#SEEK_HOLE
 4

	)

320 #ià
defšed
 
__USE_BSD
 && !defšed 
L_SET


322 
	#L_SET
 
SEEK_SET


	)

323 
	#L_INCR
 
SEEK_CUR


	)

324 
	#L_XTND
 
SEEK_END


	)

333 #iâdeà
__USE_FILE_OFFSET64


334 
__off_t
 
	$l£ek
 (
__fd
, 
__off_t
 
__off£t
, 
__wh’û
è
__THROW
;

336 #ifdeà
__REDIRECT_NTH


337 
__off64_t
 
	`__REDIRECT_NTH
 (
l£ek
,

338 (
__fd
, 
__off64_t
 
__off£t
, 
__wh’û
),

339 
l£ek64
);

341 
	#l£ek
 
l£ek64


	)

344 #ifdeà
__USE_LARGEFILE64


345 
__off64_t
 
	$l£ek64
 (
__fd
, 
__off64_t
 
__off£t
, 
__wh’û
)

346 
__THROW
;

353 
	`şo£
 (
__fd
);

360 
ssize_t
 
	$»ad
 (
__fd
, *
__buf
, 
size_t
 
__nby‹s
è
__wur
;

366 
ssize_t
 
	$wr™e
 (
__fd
, cÚ¡ *
__buf
, 
size_t
 
__n
è
__wur
;

368 #ià
defšed
 
__USE_UNIX98
 || defšed 
__USE_XOPEN2K8


369 #iâdeà
__USE_FILE_OFFSET64


376 
ssize_t
 
	$´—d
 (
__fd
, *
__buf
, 
size_t
 
__nby‹s
,

377 
__off_t
 
__off£t
è
__wur
;

384 
ssize_t
 
	$pwr™e
 (
__fd
, cÚ¡ *
__buf
, 
size_t
 
__n
,

385 
__off_t
 
__off£t
è
__wur
;

387 #ifdeà
__REDIRECT


388 
ssize_t
 
	`__REDIRECT
 (
´—d
, (
__fd
, *
__buf
, 
size_t
 
__nby‹s
,

389 
__off64_t
 
__off£t
),

390 
´—d64
è
__wur
;

391 
ssize_t
 
	`__REDIRECT
 (
pwr™e
, (
__fd
, cÚ¡ *
__buf
,

392 
size_t
 
__nby‹s
, 
__off64_t
 
__off£t
),

393 
pwr™e64
è
__wur
;

395 
	#´—d
 
´—d64


	)

396 
	#pwr™e
 
pwr™e64


	)

400 #ifdeà
__USE_LARGEFILE64


404 
ssize_t
 
	$´—d64
 (
__fd
, *
__buf
, 
size_t
 
__nby‹s
,

405 
__off64_t
 
__off£t
è
__wur
;

408 
ssize_t
 
	$pwr™e64
 (
__fd
, cÚ¡ *
__buf
, 
size_t
 
__n
,

409 
__off64_t
 
__off£t
è
__wur
;

417 
	$pe
 (
__pedes
[2]è
__THROW
 
__wur
;

419 #ifdeà
__USE_GNU


422 
	$pe2
 (
__pedes
[2], 
__æags
è
__THROW
 
__wur
;

432 
	$®¬m
 (
__£cÚds
è
__THROW
;

444 
	`¦“p
 (
__£cÚds
);

446 #ià(
defšed
 
__USE_XOPEN_EXTENDED
 && !defšed 
__USE_XOPEN2K8
) \

447 || 
defšed
 
__USE_BSD


452 
__u£cÚds_t
 
	$u®¬m
 (
__u£cÚds_t
 
__v®ue
, __u£cÚds_ˆ
__š‹rv®
)

453 
__THROW
;

460 
	`u¦“p
 (
__u£cÚds_t
 
__u£cÚds
);

469 
	`·u£
 ();

473 
	$chown
 (cÚ¡ *
__fe
, 
__uid_t
 
__owÃr
, 
__gid_t
 
__group
)

474 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

476 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K8


478 
	$fchown
 (
__fd
, 
__uid_t
 
__owÃr
, 
__gid_t
 
__group
è
__THROW
 
__wur
;

483 
	$lchown
 (cÚ¡ *
__fe
, 
__uid_t
 
__owÃr
, 
__gid_t
 
__group
)

484 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

488 #ifdeà
__USE_ATFILE


491 
	$fchowÇt
 (
__fd
, cÚ¡ *
__fe
, 
__uid_t
 
__owÃr
,

492 
__gid_t
 
__group
, 
__æag
)

493 
__THROW
 
	`__nÚnuÎ
 ((2)è
__wur
;

497 
	$chdœ
 (cÚ¡ *
__·th
è
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

499 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K8


501 
	$fchdœ
 (
__fd
è
__THROW
 
__wur
;

511 *
	$g‘cwd
 (*
__buf
, 
size_t
 
__size
è
__THROW
 
__wur
;

513 #ifdef 
__USE_GNU


517 *
	$g‘_cu¼’t_dœ_Çme
 (è
__THROW
;

520 #ià(
defšed
 
__USE_XOPEN_EXTENDED
 && !defšed 
__USE_XOPEN2K8
) \

521 || 
defšed
 
__USE_BSD


525 *
	$g‘wd
 (*
__buf
)

526 
__THROW
 
	`__nÚnuÎ
 ((1)è
__©Œibu‹_d•»ÿ‹d__
 
__wur
;

531 
	$dup
 (
__fd
è
__THROW
 
__wur
;

534 
	$dup2
 (
__fd
, 
__fd2
è
__THROW
;

536 #ifdeà
__USE_GNU


539 
	$dup3
 (
__fd
, 
__fd2
, 
__æags
è
__THROW
;

543 **
__’vœÚ
;

544 #ifdeà
__USE_GNU


545 **
’vœÚ
;

551 
	$execve
 (cÚ¡ *
__·th
, *cÚ¡ 
__¬gv
[],

552 *cÚ¡ 
__’vp
[]è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

554 #ifdeà
__USE_XOPEN2K8


557 
	$ãxecve
 (
__fd
, *cÚ¡ 
__¬gv
[], *cÚ¡ 
__’vp
[])

558 
__THROW
 
	`__nÚnuÎ
 ((2));

563 
	$execv
 (cÚ¡ *
__·th
, *cÚ¡ 
__¬gv
[])

564 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

568 
	$exeşe
 (cÚ¡ *
__·th
, cÚ¡ *
__¬g
, ...)

569 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

573 
	$exeş
 (cÚ¡ *
__·th
, cÚ¡ *
__¬g
, ...)

574 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

578 
	$execvp
 (cÚ¡ *
__fe
, *cÚ¡ 
__¬gv
[])

579 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

584 
	$exeşp
 (cÚ¡ *
__fe
, cÚ¡ *
__¬g
, ...)

585 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

587 #ifdeà
__USE_GNU


590 
	$execv³
 (cÚ¡ *
__fe
, *cÚ¡ 
__¬gv
[],

591 *cÚ¡ 
__’vp
[])

592 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

596 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN


598 
	$niû
 (
__šc
è
__THROW
 
__wur
;

603 
	$_ex™
 (
__¡©us
è
	`__©Œibu‹__
 ((
__nÜ‘uº__
));

609 
	~<b™s/cÚâame.h
>

612 
	$·thcÚf
 (cÚ¡ *
__·th
, 
__Çme
)

613 
__THROW
 
	`__nÚnuÎ
 ((1));

616 
	$å©hcÚf
 (
__fd
, 
__Çme
è
__THROW
;

619 
	$syscÚf
 (
__Çme
è
__THROW
;

621 #ifdef 
__USE_POSIX2


623 
size_t
 
	$cÚf¡r
 (
__Çme
, *
__buf
, 
size_t
 
__Ën
è
__THROW
;

628 
__pid_t
 
	$g‘pid
 (è
__THROW
;

631 
__pid_t
 
	$g‘µid
 (è
__THROW
;

634 
__pid_t
 
	$g‘pg½
 (è
__THROW
;

637 
__pid_t
 
	$__g‘pgid
 (
__pid_t
 
__pid
è
__THROW
;

638 #ià
defšed
 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K8


639 
__pid_t
 
	$g‘pgid
 (
__pid_t
 
__pid
è
__THROW
;

646 
	$£gid
 (
__pid_t
 
__pid
, __pid_ˆ
__pgid
è
__THROW
;

648 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED


660 
	$£g½
 (è
__THROW
;

667 
__pid_t
 
	$£tsid
 (è
__THROW
;

669 #ià
defšed
 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K8


671 
__pid_t
 
	$g‘sid
 (
__pid_t
 
__pid
è
__THROW
;

675 
__uid_t
 
	$g‘uid
 (è
__THROW
;

678 
__uid_t
 
	$g‘euid
 (è
__THROW
;

681 
__gid_t
 
	$g‘gid
 (è
__THROW
;

684 
__gid_t
 
	$g‘egid
 (è
__THROW
;

689 
	$g‘groups
 (
__size
, 
__gid_t
 
__li¡
[]è
__THROW
 
__wur
;

691 #ifdef 
__USE_GNU


693 
	$group_memb”
 (
__gid_t
 
__gid
è
__THROW
;

700 
	$£tuid
 (
__uid_t
 
__uid
è
__THROW
 
__wur
;

702 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED


705 
	$£Œeuid
 (
__uid_t
 
__ruid
, __uid_ˆ
__euid
è
__THROW
 
__wur
;

708 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN2K


710 
	$£‹uid
 (
__uid_t
 
__uid
è
__THROW
 
__wur
;

717 
	$£tgid
 (
__gid_t
 
__gid
è
__THROW
 
__wur
;

719 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED


722 
	$£Œegid
 (
__gid_t
 
__rgid
, __gid_ˆ
__egid
è
__THROW
 
__wur
;

725 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN2K


727 
	$£‹gid
 (
__gid_t
 
__gid
è
__THROW
 
__wur
;

730 #ifdeà
__USE_GNU


733 
	$g‘»suid
 (
__uid_t
 *
__ruid
, __uid_ˆ*
__euid
, __uid_ˆ*
__suid
)

734 
__THROW
;

738 
	$g‘»sgid
 (
__gid_t
 *
__rgid
, __gid_ˆ*
__egid
, __gid_ˆ*
__sgid
)

739 
__THROW
;

743 
	$£Œesuid
 (
__uid_t
 
__ruid
, __uid_ˆ
__euid
, __uid_ˆ
__suid
)

744 
__THROW
 
__wur
;

748 
	$£Œesgid
 (
__gid_t
 
__rgid
, __gid_ˆ
__egid
, __gid_ˆ
__sgid
)

749 
__THROW
 
__wur
;

756 
__pid_t
 
	$fÜk
 (è
__THROWNL
;

758 #ià(
defšed
 
__USE_XOPEN_EXTENDED
 && !defšed 
__USE_XOPEN2K8
) \

759 || 
defšed
 
__USE_BSD


764 
__pid_t
 
	$vfÜk
 (è
__THROW
;

770 *
	$‰yÇme
 (
__fd
è
__THROW
;

774 
	$‰yÇme_r
 (
__fd
, *
__buf
, 
size_t
 
__buæ’
)

775 
__THROW
 
	`__nÚnuÎ
 ((2)è
__wur
;

779 
	$i§‰y
 (
__fd
è
__THROW
;

781 #ià
defšed
 
__USE_BSD
 \

782 || (
defšed
 
__USE_XOPEN_EXTENDED
 && !defšed 
__USE_UNIX98
)

785 
	$‰y¦Ù
 (è
__THROW
;

790 
	$lšk
 (cÚ¡ *
__äom
, cÚ¡ *
__to
)

791 
__THROW
 
	`__nÚnuÎ
 ((1, 2)è
__wur
;

793 #ifdeà
__USE_ATFILE


796 
	$lšk©
 (
__äomfd
, cÚ¡ *
__äom
, 
__tofd
,

797 cÚ¡ *
__to
, 
__æags
)

798 
__THROW
 
	`__nÚnuÎ
 ((2, 4)è
__wur
;

801 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K


803 
	$symlšk
 (cÚ¡ *
__äom
, cÚ¡ *
__to
)

804 
__THROW
 
	`__nÚnuÎ
 ((1, 2)è
__wur
;

809 
ssize_t
 
	$»adlšk
 (cÚ¡ *
__»¡riù
 
__·th
,

810 *
__»¡riù
 
__buf
, 
size_t
 
__Ën
)

811 
__THROW
 
	`__nÚnuÎ
 ((1, 2)è
__wur
;

814 #ifdeà
__USE_ATFILE


816 
	$symlšk©
 (cÚ¡ *
__äom
, 
__tofd
,

817 cÚ¡ *
__to
è
__THROW
 
	`__nÚnuÎ
 ((1, 3)è
__wur
;

820 
ssize_t
 
	$»adlšk©
 (
__fd
, cÚ¡ *
__»¡riù
 
__·th
,

821 *
__»¡riù
 
__buf
, 
size_t
 
__Ën
)

822 
__THROW
 
	`__nÚnuÎ
 ((2, 3)è
__wur
;

826 
	$uÆšk
 (cÚ¡ *
__Çme
è
__THROW
 
	`__nÚnuÎ
 ((1));

828 #ifdeà
__USE_ATFILE


830 
	$uÆšk©
 (
__fd
, cÚ¡ *
__Çme
, 
__æag
)

831 
__THROW
 
	`__nÚnuÎ
 ((2));

835 
	$rmdœ
 (cÚ¡ *
__·th
è
__THROW
 
	`__nÚnuÎ
 ((1));

839 
__pid_t
 
	$tcg‘pg½
 (
__fd
è
__THROW
;

842 
	$tc£g½
 (
__fd
, 
__pid_t
 
__pg½_id
è
__THROW
;

849 *
	`g‘logš
 ();

850 #ià
defšed
 
__USE_REENTRANT
 || defšed 
__USE_POSIX199506


857 
	$g‘logš_r
 (*
__Çme
, 
size_t
 
__Çme_Ën
è
	`__nÚnuÎ
 ((1));

860 #ifdef 
__USE_BSD


862 
	$£ogš
 (cÚ¡ *
__Çme
è
__THROW
 
	`__nÚnuÎ
 ((1));

866 #ifdef 
__USE_POSIX2


870 
	#__Ãed_g‘İt


	)

871 
	~<g‘İt.h
>

875 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_UNIX98
 || defšed 
__USE_XOPEN2K


879 
	$g‘ho¡Çme
 (*
__Çme
, 
size_t
 
__Ën
è
__THROW
 
	`__nÚnuÎ
 ((1));

883 #ià
defšed
 
__USE_BSD
 || (defšed 
__USE_XOPEN
 && !defšed 
__USE_UNIX98
)

886 
	$£tho¡Çme
 (cÚ¡ *
__Çme
, 
size_t
 
__Ën
)

887 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

891 
	$£tho¡id
 (
__id
è
__THROW
 
__wur
;

897 
	$g‘domašÇme
 (*
__Çme
, 
size_t
 
__Ën
)

898 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

899 
	$£tdomašÇme
 (cÚ¡ *
__Çme
, 
size_t
 
__Ën
)

900 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

906 
	$vhªgup
 (è
__THROW
;

909 
	$»voke
 (cÚ¡ *
__fe
è
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

917 
	$´of
 (*
__§m¶e_bufãr
, 
size_t
 
__size
,

918 
size_t
 
__off£t
, 
__sÿË
)

919 
__THROW
 
	`__nÚnuÎ
 ((1));

925 
	$acù
 (cÚ¡ *
__Çme
è
__THROW
;

929 *
	$g‘u£rsh–l
 (è
__THROW
;

930 
	$’du£rsh–l
 (è
__THROW
;

931 
	$£tu£rsh–l
 (è
__THROW
;

937 
	$d«mÚ
 (
__nochdœ
, 
__noşo£
è
__THROW
 
__wur
;

941 #ià
defšed
 
__USE_BSD
 || (defšed 
__USE_XOPEN
 && !defšed 
__USE_XOPEN2K
)

944 
	$chroÙ
 (cÚ¡ *
__·th
è
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

948 *
	$g‘·ss
 (cÚ¡ *
__´om±
è
	`__nÚnuÎ
 ((1));

956 
	`fsync
 (
__fd
);

959 #ifdeà
__USE_GNU


962 
	$syncfs
 (
__fd
è
__THROW
;

966 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED


969 
	`g‘ho¡id
 ();

972 
	$sync
 (è
__THROW
;

975 #ià
defšed
 
__USE_BSD
 || !defšed 
__USE_XOPEN2K


978 
	$g‘·gesize
 (è
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

983 
	$g‘dbËsize
 (è
__THROW
;

989 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K8


992 #iâdeà
__USE_FILE_OFFSET64


993 
	$Œunÿ‹
 (cÚ¡ *
__fe
, 
__off_t
 
__Ëngth
)

994 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

996 #ifdeà
__REDIRECT_NTH


997 
	`__REDIRECT_NTH
 (
Œunÿ‹
,

998 (cÚ¡ *
__fe
, 
__off64_t
 
__Ëngth
),

999 
Œunÿ‹64
è
	`__nÚnuÎ
 ((1)è
__wur
;

1001 
	#Œunÿ‹
 
Œunÿ‹64


	)

1004 #ifdeà
__USE_LARGEFILE64


1005 
	$Œunÿ‹64
 (cÚ¡ *
__fe
, 
__off64_t
 
__Ëngth
)

1006 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

1011 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_POSIX199309
 \

1012 || 
defšed
 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K


1015 #iâdeà
__USE_FILE_OFFSET64


1016 
	$árunÿ‹
 (
__fd
, 
__off_t
 
__Ëngth
è
__THROW
 
__wur
;

1018 #ifdeà
__REDIRECT_NTH


1019 
	`__REDIRECT_NTH
 (
árunÿ‹
, (
__fd
, 
__off64_t
 
__Ëngth
),

1020 
árunÿ‹64
è
__wur
;

1022 
	#árunÿ‹
 
árunÿ‹64


	)

1025 #ifdeà
__USE_LARGEFILE64


1026 
	$árunÿ‹64
 (
__fd
, 
__off64_t
 
__Ëngth
è
__THROW
 
__wur
;

1032 #ià(
defšed
 
__USE_XOPEN_EXTENDED
 && !defšed 
__USE_XOPEN2K
) \

1033 || 
defšed
 
__USE_MISC


1037 
	$brk
 (*
__addr
è
__THROW
 
__wur
;

1043 *
	$sbrk
 (
šŒ_t
 
__d–
è
__THROW
;

1047 #ifdeà
__USE_MISC


1058 
	$sysÿÎ
 (
__sy¢o
, ...è
__THROW
;

1063 #ià(
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN_EXTENDED
è&& !defšed 
F_LOCK


1075 
	#F_ULOCK
 0

	)

1076 
	#F_LOCK
 1

	)

1077 
	#F_TLOCK
 2

	)

1078 
	#F_TEST
 3

	)

1080 #iâdeà
__USE_FILE_OFFSET64


1081 
	$lockf
 (
__fd
, 
__cmd
, 
__off_t
 
__Ën
è
__wur
;

1083 #ifdeà
__REDIRECT


1084 
	`__REDIRECT
 (
lockf
, (
__fd
, 
__cmd
, 
__off64_t
 
__Ën
),

1085 
lockf64
è
__wur
;

1087 
	#lockf
 
lockf64


	)

1090 #ifdeà
__USE_LARGEFILE64


1091 
	$lockf64
 (
__fd
, 
__cmd
, 
__off64_t
 
__Ën
è
__wur
;

1096 #ifdeà
__USE_GNU


1101 
	#TEMP_FAILURE_RETRY
(
ex´essiÚ
) \

1102 (
__ex‹nsiÚ__
 \

1103 ({ 
__»suÉ
; \

1104 dØ
__»suÉ
 = (è(
ex´essiÚ
); \

1105 
__»suÉ
 =ğ-1L && 
”ºo
 =ğ
EINTR
); \

1106 
__»suÉ
; 
	}
}))

	)

1109 #ià
defšed
 
__USE_POSIX199309
 || defšed 
__USE_UNIX98


1112 
fd©async
 (
__fdes
);

1118 #ifdef 
__USE_XOPEN


1120 *
	$üy±
 (cÚ¡ *
__key
, cÚ¡ *
__§É
)

1121 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

1125 
	$’üy±
 (*
__glibc_block
, 
__edæag
)

1126 
__THROW
 
	`__nÚnuÎ
 ((1));

1133 
	$swab
 (cÚ¡ *
__»¡riù
 
__äom
, *__»¡riù 
__to
,

1134 
ssize_t
 
__n
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

1140 #ià
defšed
 
__USE_XOPEN
 && !defšed 
__USE_XOPEN2K


1142 *
	$ù”mid
 (*
__s
è
__THROW
;

1147 #ià
__USE_FORTIFY_LEVEL
 > 0 && 
defšed
 
__fÜtify_funùiÚ


1148 
	~<b™s/uni¡d.h
>

1151 
__END_DECLS


	@/usr/include/endian.h

18 #iâdef 
_ENDIAN_H


19 
	#_ENDIAN_H
 1

	)

21 
	~<ã©u»s.h
>

31 
	#__LITTLE_ENDIAN
 1234

	)

32 
	#__BIG_ENDIAN
 4321

	)

33 
	#__PDP_ENDIAN
 3412

	)

36 
	~<b™s/’dŸn.h
>

40 #iâdeà
__FLOAT_WORD_ORDER


41 
	#__FLOAT_WORD_ORDER
 
__BYTE_ORDER


	)

44 #ifdef 
__USE_BSD


45 
	#LITTLE_ENDIAN
 
__LITTLE_ENDIAN


	)

46 
	#BIG_ENDIAN
 
__BIG_ENDIAN


	)

47 
	#PDP_ENDIAN
 
__PDP_ENDIAN


	)

48 
	#BYTE_ORDER
 
__BYTE_ORDER


	)

51 #ià
__BYTE_ORDER
 =ğ
__LITTLE_ENDIAN


52 
	#__LONG_LONG_PAIR
(
HI
, 
LO
èLO, 
	)
HI

53 #–ià
__BYTE_ORDER
 =ğ
__BIG_ENDIAN


54 
	#__LONG_LONG_PAIR
(
HI
, 
LO
èHI, 
	)
LO

58 #ià
defšed
 
__USE_BSD
 && !defšed 
__ASSEMBLER__


60 
	~<b™s/by‹sw­.h
>

62 #ià
__BYTE_ORDER
 =ğ
__LITTLE_ENDIAN


63 
	#htobe16
(
x
è
	`__bsw­_16
 (x)

	)

64 
	#htŞe16
(
x
è(x)

	)

65 
	#be16toh
(
x
è
	`__bsw­_16
 (x)

	)

66 
	#Ë16toh
(
x
è(x)

	)

68 
	#htobe32
(
x
è
	`__bsw­_32
 (x)

	)

69 
	#htŞe32
(
x
è(x)

	)

70 
	#be32toh
(
x
è
	`__bsw­_32
 (x)

	)

71 
	#Ë32toh
(
x
è(x)

	)

73 
	#htobe64
(
x
è
	`__bsw­_64
 (x)

	)

74 
	#htŞe64
(
x
è(x)

	)

75 
	#be64toh
(
x
è
	`__bsw­_64
 (x)

	)

76 
	#Ë64toh
(
x
è(x)

	)

79 
	#htobe16
(
x
è(x)

	)

80 
	#htŞe16
(
x
è
	`__bsw­_16
 (x)

	)

81 
	#be16toh
(
x
è(x)

	)

82 
	#Ë16toh
(
x
è
	`__bsw­_16
 (x)

	)

84 
	#htobe32
(
x
è(x)

	)

85 
	#htŞe32
(
x
è
	`__bsw­_32
 (x)

	)

86 
	#be32toh
(
x
è(x)

	)

87 
	#Ë32toh
(
x
è
	`__bsw­_32
 (x)

	)

89 
	#htobe64
(
x
è(x)

	)

90 
	#htŞe64
(
x
è
	`__bsw­_64
 (x)

	)

91 
	#be64toh
(
x
è(x)

	)

92 
	#Ë64toh
(
x
è
	`__bsw­_64
 (x)

	)

	@/usr/include/features.h

18 #iâdef 
_FEATURES_H


19 
	#_FEATURES_H
 1

	)

101 #undeà
__USE_ISOC11


102 #undeà
__USE_ISOC99


103 #undeà
__USE_ISOC95


104 #undeà
__USE_ISOCXX11


105 #undeà
__USE_POSIX


106 #undeà
__USE_POSIX2


107 #undeà
__USE_POSIX199309


108 #undeà
__USE_POSIX199506


109 #undeà
__USE_XOPEN


110 #undeà
__USE_XOPEN_EXTENDED


111 #undeà
__USE_UNIX98


112 #undeà
__USE_XOPEN2K


113 #undeà
__USE_XOPEN2KXSI


114 #undeà
__USE_XOPEN2K8


115 #undeà
__USE_XOPEN2K8XSI


116 #undeà
__USE_LARGEFILE


117 #undeà
__USE_LARGEFILE64


118 #undeà
__USE_FILE_OFFSET64


119 #undeà
__USE_BSD


120 #undeà
__USE_SVID


121 #undeà
__USE_MISC


122 #undeà
__USE_ATFILE


123 #undeà
__USE_GNU


124 #undeà
__USE_REENTRANT


125 #undeà
__USE_FORTIFY_LEVEL


126 #undeà
__KERNEL_STRICT_NAMES


130 #iâdeà
_LOOSE_KERNEL_NAMES


131 
	#__KERNEL_STRICT_NAMES


	)

141 #ià
defšed
 
__GNUC__
 && defšed 
__GNUC_MINOR__


142 
	#__GNUC_PREREQ
(
maj
, 
mš
) \

143 ((
__GNUC__
 << 16è+ 
__GNUC_MINOR__
 >ğ((
maj
è<< 16è+ (
mš
))

	)

145 
	#__GNUC_PREREQ
(
maj
, 
mš
è0

	)

150 #ifdeà
_GNU_SOURCE


151 #undeà
_ISOC95_SOURCE


152 
	#_ISOC95_SOURCE
 1

	)

153 #undeà
_ISOC99_SOURCE


154 
	#_ISOC99_SOURCE
 1

	)

155 #undeà
_ISOC11_SOURCE


156 
	#_ISOC11_SOURCE
 1

	)

157 #undeà
_POSIX_SOURCE


158 
	#_POSIX_SOURCE
 1

	)

159 #undeà
_POSIX_C_SOURCE


160 
	#_POSIX_C_SOURCE
 200809L

	)

161 #undeà
_XOPEN_SOURCE


162 
	#_XOPEN_SOURCE
 700

	)

163 #undeà
_XOPEN_SOURCE_EXTENDED


164 
	#_XOPEN_SOURCE_EXTENDED
 1

	)

165 #undeà
_LARGEFILE64_SOURCE


166 
	#_LARGEFILE64_SOURCE
 1

	)

167 #undeà
_DEFAULT_SOURCE


168 
	#_DEFAULT_SOURCE
 1

	)

169 #undeà
_BSD_SOURCE


170 
	#_BSD_SOURCE
 1

	)

171 #undeà
_SVID_SOURCE


172 
	#_SVID_SOURCE
 1

	)

173 #undeà
_ATFILE_SOURCE


174 
	#_ATFILE_SOURCE
 1

	)

179 #ià(
defšed
 
_DEFAULT_SOURCE
 \

180 || (!
defšed
 
	g__STRICT_ANSI__
 \

181 && !
defšed
 
	g_ISOC99_SOURCE
 \

182 && !
defšed
 
	g_POSIX_SOURCE
 && !defšed 
	g_POSIX_C_SOURCE
 \

183 && !
defšed
 
	g_XOPEN_SOURCE
 \

184 && !
defšed
 
	g_BSD_SOURCE
 && !defšed 
	g_SVID_SOURCE
))

185 #undeà
_DEFAULT_SOURCE


186 
	#_DEFAULT_SOURCE
 1

	)

187 #undeà
_BSD_SOURCE


188 
	#_BSD_SOURCE
 1

	)

189 #undeà
_SVID_SOURCE


190 
	#_SVID_SOURCE
 1

	)

194 #ià(
defšed
 
_ISOC11_SOURCE
 \

195 || (
defšed
 
	g__STDC_VERSION__
 && __STDC_VERSION__ >= 201112L))

196 
	#__USE_ISOC11
 1

	)

200 #ià(
defšed
 
_ISOC99_SOURCE
 || defšed 
_ISOC11_SOURCE
 \

201 || (
defšed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199901L))

202 
	#__USE_ISOC99
 1

	)

206 #ià(
defšed
 
_ISOC99_SOURCE
 || defšed 
_ISOC11_SOURCE
 \

207 || (
defšed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199409L))

208 
	#__USE_ISOC95
 1

	)

215 #ià((
defšed
 
__ılu¥lus
 && __cplusplus >= 201103L) \

216 || 
defšed
 
__GXX_EXPERIMENTAL_CXX0X__
)

217 
	#__USE_ISOCXX11
 1

	)

223 #ifdeà
_DEFAULT_SOURCE


224 #ià!
defšed
 
_POSIX_SOURCE
 && !defšed 
_POSIX_C_SOURCE


225 
	#__USE_POSIX_IMPLICITLY
 1

	)

227 #undeà
_POSIX_SOURCE


228 
	#_POSIX_SOURCE
 1

	)

229 #undeà
_POSIX_C_SOURCE


230 
	#_POSIX_C_SOURCE
 200809L

	)

232 #ià((!
defšed
 
__STRICT_ANSI__
 || (
_XOPEN_SOURCE
 - 0) >= 500) && \

233 !
defšed
 
_POSIX_SOURCE
 && !defšed 
_POSIX_C_SOURCE
)

234 
	#_POSIX_SOURCE
 1

	)

235 #ià
defšed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) < 500

236 
	#_POSIX_C_SOURCE
 2

	)

237 #–ià
defšed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) < 600

238 
	#_POSIX_C_SOURCE
 199506L

	)

239 #–ià
defšed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) < 700

240 
	#_POSIX_C_SOURCE
 200112L

	)

242 
	#_POSIX_C_SOURCE
 200809L

	)

244 
	#__USE_POSIX_IMPLICITLY
 1

	)

247 #ià
defšed
 
_POSIX_SOURCE
 || 
_POSIX_C_SOURCE
 >ğ1 || defšed 
_XOPEN_SOURCE


248 
	#__USE_POSIX
 1

	)

251 #ià
defšed
 
_POSIX_C_SOURCE
 && _POSIX_C_SOURCE >ğ2 || defšed 
_XOPEN_SOURCE


252 
	#__USE_POSIX2
 1

	)

255 #ià(
_POSIX_C_SOURCE
 - 0) >= 199309L

256 
	#__USE_POSIX199309
 1

	)

259 #ià(
_POSIX_C_SOURCE
 - 0) >= 199506L

260 
	#__USE_POSIX199506
 1

	)

263 #ià(
_POSIX_C_SOURCE
 - 0) >= 200112L

264 
	#__USE_XOPEN2K
 1

	)

265 #undeà
__USE_ISOC95


266 
	#__USE_ISOC95
 1

	)

267 #undeà
__USE_ISOC99


268 
	#__USE_ISOC99
 1

	)

271 #ià(
_POSIX_C_SOURCE
 - 0) >= 200809L

272 
	#__USE_XOPEN2K8
 1

	)

273 #undeà
_ATFILE_SOURCE


274 
	#_ATFILE_SOURCE
 1

	)

277 #ifdef 
_XOPEN_SOURCE


278 
	#__USE_XOPEN
 1

	)

279 #ià(
_XOPEN_SOURCE
 - 0) >= 500

280 
	#__USE_XOPEN_EXTENDED
 1

	)

281 
	#__USE_UNIX98
 1

	)

282 #undeà
_LARGEFILE_SOURCE


283 
	#_LARGEFILE_SOURCE
 1

	)

284 #ià(
_XOPEN_SOURCE
 - 0) >= 600

285 #ià(
_XOPEN_SOURCE
 - 0) >= 700

286 
	#__USE_XOPEN2K8
 1

	)

287 
	#__USE_XOPEN2K8XSI
 1

	)

289 
	#__USE_XOPEN2K
 1

	)

290 
	#__USE_XOPEN2KXSI
 1

	)

291 #undeà
__USE_ISOC95


292 
	#__USE_ISOC95
 1

	)

293 #undeà
__USE_ISOC99


294 
	#__USE_ISOC99
 1

	)

297 #ifdeà
_XOPEN_SOURCE_EXTENDED


298 
	#__USE_XOPEN_EXTENDED
 1

	)

303 #ifdeà
_LARGEFILE_SOURCE


304 
	#__USE_LARGEFILE
 1

	)

307 #ifdeà
_LARGEFILE64_SOURCE


308 
	#__USE_LARGEFILE64
 1

	)

311 #ià
defšed
 
_FILE_OFFSET_BITS
 && _FILE_OFFSET_BITS == 64

312 
	#__USE_FILE_OFFSET64
 1

	)

315 #ià
defšed
 
_BSD_SOURCE
 || defšed 
_SVID_SOURCE


316 
	#__USE_MISC
 1

	)

319 #ifdef 
_BSD_SOURCE


320 
	#__USE_BSD
 1

	)

323 #ifdef 
_SVID_SOURCE


324 
	#__USE_SVID
 1

	)

327 #ifdef 
_ATFILE_SOURCE


328 
	#__USE_ATFILE
 1

	)

331 #ifdef 
_GNU_SOURCE


332 
	#__USE_GNU
 1

	)

335 #ià
defšed
 
_REENTRANT
 || defšed 
_THREAD_SAFE


336 
	#__USE_REENTRANT
 1

	)

339 #ià
defšed
 
_FORTIFY_SOURCE
 && _FORTIFY_SOURCE > 0 \

340 && 
__GNUC_PREREQ
 (4, 1è&& 
defšed
 
	g__OPTIMIZE__
 && __OPTIMIZE__ > 0

341 #ià
_FORTIFY_SOURCE
 > 1

342 
	#__USE_FORTIFY_LEVEL
 2

	)

344 
	#__USE_FORTIFY_LEVEL
 1

	)

347 
	#__USE_FORTIFY_LEVEL
 0

	)

352 
	~<¡dc-´edef.h
>

360 #undeà
__GNU_LIBRARY__


361 
	#__GNU_LIBRARY__
 6

	)

365 
	#__GLIBC__
 2

	)

366 
	#__GLIBC_MINOR__
 19

	)

368 
	#__GLIBC_PREREQ
(
maj
, 
mš
) \

369 ((
__GLIBC__
 << 16è+ 
__GLIBC_MINOR__
 >ğ((
maj
è<< 16è+ (
mš
))

	)

372 #iâdeà
__ASSEMBLER__


373 #iâdeà
_SYS_CDEFS_H


374 
	~<sys/cdefs.h
>

379 #ià
defšed
 
__USE_FILE_OFFSET64
 && !defšed 
__REDIRECT


380 
	#__USE_LARGEFILE
 1

	)

381 
	#__USE_LARGEFILE64
 1

	)

387 #ià
__GNUC_PREREQ
 (2, 7è&& 
defšed
 
__OPTIMIZE__
 \

388 && !
defšed
 
	g__OPTIMIZE_SIZE__
 && !defšed 
	g__NO_INLINE__
 \

389 && 
defšed
 
	g__ex‹º_šlše


390 
	#__USE_EXTERN_INLINES
 1

	)

398 
	~<gnu/¡ubs.h
>

	@/usr/include/getopt.h

19 #iâdeà
_GETOPT_H


21 #iâdeà
__Ãed_g‘İt


22 
	#_GETOPT_H
 1

	)

32 #ià!
defšed
 
__GNU_LIBRARY__


33 
	~<ùy³.h
>

36 #iâdeà
__THROW


37 #iâdeà
__GNUC_PREREQ


38 
	#__GNUC_PREREQ
(
maj
, 
mš
è(0)

	)

40 #ià
defšed
 
__ılu¥lus
 && 
__GNUC_PREREQ
 (2,8)

41 
	#__THROW
 
	`throw
 ()

	)

43 
	#__THROW


	)

47 #ifdef 
__ılu¥lus


57 *
İrg
;

71 
İtšd
;

76 
İ‹¼
;

80 
İtİt
;

82 #iâdeà
__Ãed_g‘İt


104 
	sİtiÚ


106 cÚ¡ *
	gÇme
;

109 
	ghas_¬g
;

110 *
	gæag
;

111 
	gv®
;

116 
	#no_¬gum’t
 0

	)

117 
	#»quœed_¬gum’t
 1

	)

118 
	#İtiÚ®_¬gum’t
 2

	)

146 #ifdeà
__GNU_LIBRARY__


150 
g‘İt
 (
___¬gc
, *cÚ¡ *
___¬gv
, cÚ¡ *
__shÜtİts
)

151 
__THROW
;

153 #ià
defšed
 
__Ãed_g‘İt
 && defšed 
__USE_POSIX2
 \

154 && !
defšed
 
	g__USE_POSIX_IMPLICITLY
 && !defšed 
	g__USE_GNU


158 #ifdeà
__REDIRECT


159 
__REDIRECT_NTH
 (
g‘İt
, (
___¬gc
, *cÚ¡ *
___¬gv
,

160 cÚ¡ *
__shÜtİts
),

161 
__posix_g‘İt
);

163 
__posix_g‘İt
 (
___¬gc
, *cÚ¡ *
___¬gv
,

164 cÚ¡ *
__shÜtİts
è
__THROW
;

165 
	#g‘İt
 
__posix_g‘İt


	)

169 
g‘İt
 ();

172 #iâdeà
__Ãed_g‘İt


173 
g‘İt_lÚg
 (
___¬gc
, *cÚ¡ *
___¬gv
,

174 cÚ¡ *
__shÜtİts
,

175 cÚ¡ 
İtiÚ
 *
__lÚgİts
, *
__lÚgšd
)

176 
__THROW
;

177 
g‘İt_lÚg_Úly
 (
___¬gc
, *cÚ¡ *
___¬gv
,

178 cÚ¡ *
__shÜtİts
,

179 cÚ¡ 
İtiÚ
 *
__lÚgİts
, *
__lÚgšd
)

180 
__THROW
;

184 #ifdef 
__ılu¥lus


189 #undeà
__Ãed_g‘İt


	@/usr/include/rpc/netdb.h

36 #iâdeà
_RPC_NETDB_H


37 
	#_RPC_NETDB_H
 1

	)

39 
	~<ã©u»s.h
>

41 
	#__Ãed_size_t


	)

42 
	~<¡ddef.h
>

44 
__BEGIN_DECLS


46 
	s½ûÁ


48 *
	mr_Çme
;

49 **
	mr_®Ÿ£s
;

50 
	mr_numb”
;

53 
	$£ŒpûÁ
 (
__¡ayİ’
è
__THROW
;

54 
	$’d½ûÁ
 (è
__THROW
;

55 
½ûÁ
 *
	$g‘½cbyÇme
 (cÚ¡ *
__Çme
è
__THROW
;

56 
½ûÁ
 *
	$g‘½cbynumb”
 (
__numb”
è
__THROW
;

57 
½ûÁ
 *
	$g‘½ûÁ
 (è
__THROW
;

59 #ifdeà
__USE_MISC


60 
	$g‘½cbyÇme_r
 (cÚ¡ *
__Çme
, 
½ûÁ
 *
__»suÉ_buf
,

61 *
__bufãr
, 
size_t
 
__buæ’
,

62 
½ûÁ
 **
__»suÉ
è
__THROW
;

64 
	$g‘½cbynumb”_r
 (
__numb”
, 
½ûÁ
 *
__»suÉ_buf
,

65 *
__bufãr
, 
size_t
 
__buæ’
,

66 
½ûÁ
 **
__»suÉ
è
__THROW
;

68 
	$g‘½ûÁ_r
 (
½ûÁ
 *
__»suÉ_buf
, *
__bufãr
,

69 
size_t
 
__buæ’
, 
½ûÁ
 **
__»suÉ
è
__THROW
;

72 
__END_DECLS


	@/usr/include/sched.h

19 #iâdef 
_SCHED_H


20 
	#_SCHED_H
 1

	)

22 
	~<ã©u»s.h
>

25 
	~<b™s/ty³s.h
>

27 
	#__Ãed_size_t


	)

28 
	~<¡ddef.h
>

30 
	#__Ãed_time_t


	)

31 
	#__Ãed_time¥ec


	)

32 
	~<time.h
>

34 #iâdeà
__pid_t_defšed


35 
__pid_t
 
	tpid_t
;

36 
	#__pid_t_defšed


	)

41 
	~<b™s/sched.h
>

43 
	#sched_´iÜ™y
 
__sched_´iÜ™y


	)

46 
__BEGIN_DECLS


49 
	$sched_£¬am
 (
__pid_t
 
__pid
, cÚ¡ 
sched_·¿m
 *
__·¿m
)

50 
__THROW
;

53 
	$sched_g‘·¿m
 (
__pid_t
 
__pid
, 
sched_·¿m
 *
__·¿m
è
__THROW
;

56 
	$sched_£tscheduËr
 (
__pid_t
 
__pid
, 
__pŞicy
,

57 cÚ¡ 
sched_·¿m
 *
__·¿m
è
__THROW
;

60 
	$sched_g‘scheduËr
 (
__pid_t
 
__pid
è
__THROW
;

63 
	$sched_y›ld
 (è
__THROW
;

66 
	$sched_g‘_´iÜ™y_max
 (
__®gÜ™hm
è
__THROW
;

69 
	$sched_g‘_´iÜ™y_mš
 (
__®gÜ™hm
è
__THROW
;

72 
	$sched_¼_g‘_š‹rv®
 (
__pid_t
 
__pid
, 
time¥ec
 *
__t
è
__THROW
;

75 #ifdeà
__USE_GNU


77 
	#CPU_SETSIZE
 
__CPU_SETSIZE


	)

78 
	#CPU_SET
(
ıu
, 
ıu£
è
	`__CPU_SET_S
 (ıu,  (
ıu_£t_t
), cpu£)

	)

79 
	#CPU_CLR
(
ıu
, 
ıu£
è
	`__CPU_CLR_S
 (ıu,  (
ıu_£t_t
), cpu£)

	)

80 
	#CPU_ISSET
(
ıu
, 
ıu£
è
	`__CPU_ISSET_S
 (ıu,  (
ıu_£t_t
), \

81 
ıu£
)

	)

82 
	#CPU_ZERO
(
ıu£
è
	`__CPU_ZERO_S
 ( (
ıu_£t_t
), cpu£)

	)

83 
	#CPU_COUNT
(
ıu£
è
	`__CPU_COUNT_S
 ( (
ıu_£t_t
), cpu£)

	)

85 
	#CPU_SET_S
(
ıu
, 
£tsize
, 
ıu£
è
	`__CPU_SET_S
 (ıu, s‘size, cpu£)

	)

86 
	#CPU_CLR_S
(
ıu
, 
£tsize
, 
ıu£
è
	`__CPU_CLR_S
 (ıu, s‘size, cpu£)

	)

87 
	#CPU_ISSET_S
(
ıu
, 
£tsize
, 
ıu£
è
	`__CPU_ISSET_S
 (cpu, setsize, \

88 
ıu£
)

	)

89 
	#CPU_ZERO_S
(
£tsize
, 
ıu£
è
	`__CPU_ZERO_S
 (£tsize, cpu£)

	)

90 
	#CPU_COUNT_S
(
£tsize
, 
ıu£
è
	`__CPU_COUNT_S
 (£tsize, cpu£)

	)

92 
	#CPU_EQUAL
(
ıu£1
, 
ıu£2
) \

93 
	`__CPU_EQUAL_S
 ( (
ıu_£t_t
), 
ıu£1
, 
ıu£2
)

	)

94 
	#CPU_EQUAL_S
(
£tsize
, 
ıu£1
, 
ıu£2
) \

95 
	`__CPU_EQUAL_S
 (
£tsize
, 
ıu£1
, 
ıu£2
)

	)

97 
	#CPU_AND
(
de¡£t
, 
¤c£t1
, 
¤c£t2
) \

98 
	`__CPU_OP_S
 ( (
ıu_£t_t
), 
de¡£t
, 
¤c£t1
, 
¤c£t2
, &)

	)

99 
	#CPU_OR
(
de¡£t
, 
¤c£t1
, 
¤c£t2
) \

100 
	`__CPU_OP_S
 ( (
ıu_£t_t
), 
de¡£t
, 
¤c£t1
, 
¤c£t2
, |)

	)

101 
	#CPU_XOR
(
de¡£t
, 
¤c£t1
, 
¤c£t2
) \

102 
	`__CPU_OP_S
 ( (
ıu_£t_t
), 
de¡£t
, 
¤c£t1
, 
¤c£t2
, ^)

	)

103 
	#CPU_AND_S
(
£tsize
, 
de¡£t
, 
¤c£t1
, 
¤c£t2
) \

104 
	`__CPU_OP_S
 (
£tsize
, 
de¡£t
, 
¤c£t1
, 
¤c£t2
, &)

	)

105 
	#CPU_OR_S
(
£tsize
, 
de¡£t
, 
¤c£t1
, 
¤c£t2
) \

106 
	`__CPU_OP_S
 (
£tsize
, 
de¡£t
, 
¤c£t1
, 
¤c£t2
, |)

	)

107 
	#CPU_XOR_S
(
£tsize
, 
de¡£t
, 
¤c£t1
, 
¤c£t2
) \

108 
	`__CPU_OP_S
 (
£tsize
, 
de¡£t
, 
¤c£t1
, 
¤c£t2
, ^)

	)

110 
	#CPU_ALLOC_SIZE
(
couÁ
è
	`__CPU_ALLOC_SIZE
 (couÁ)

	)

111 
	#CPU_ALLOC
(
couÁ
è
	`__CPU_ALLOC
 (couÁ)

	)

112 
	#CPU_FREE
(
ıu£t
è
	`__CPU_FREE
 (ıu£t)

	)

116 
	$sched_£ffš™y
 (
__pid_t
 
__pid
, 
size_t
 
__ıu£tsize
,

117 cÚ¡ 
ıu_£t_t
 *
__ıu£t
è
__THROW
;

120 
	$sched_g‘affš™y
 (
__pid_t
 
__pid
, 
size_t
 
__ıu£tsize
,

121 
ıu_£t_t
 *
__ıu£t
è
__THROW
;

124 
__END_DECLS


	@/usr/include/stdint.h

22 #iâdeà
_STDINT_H


23 
	#_STDINT_H
 1

	)

25 
	~<ã©u»s.h
>

26 
	~<b™s/wch¬.h
>

27 
	~<b™s/wÜdsize.h
>

34 #iâdeà
__št8_t_defšed


35 
	#__št8_t_defšed


	)

36 sigÃd 
	tšt8_t
;

37 
	tšt16_t
;

38 
	tšt32_t
;

39 #ià
__WORDSIZE
 == 64

40 
	tšt64_t
;

42 
__ex‹nsiÚ__


43 
	tšt64_t
;

48 
	tušt8_t
;

49 
	tušt16_t
;

50 #iâdeà
__ušt32_t_defšed


51 
	tušt32_t
;

52 
	#__ušt32_t_defšed


	)

54 #ià
__WORDSIZE
 == 64

55 
	tušt64_t
;

57 
__ex‹nsiÚ__


58 
	tušt64_t
;

65 sigÃd 
	tšt_Ëa¡8_t
;

66 
	tšt_Ëa¡16_t
;

67 
	tšt_Ëa¡32_t
;

68 #ià
__WORDSIZE
 == 64

69 
	tšt_Ëa¡64_t
;

71 
__ex‹nsiÚ__


72 
	tšt_Ëa¡64_t
;

76 
	tušt_Ëa¡8_t
;

77 
	tušt_Ëa¡16_t
;

78 
	tušt_Ëa¡32_t
;

79 #ià
__WORDSIZE
 == 64

80 
	tušt_Ëa¡64_t
;

82 
__ex‹nsiÚ__


83 
	tušt_Ëa¡64_t
;

90 sigÃd 
	tšt_ç¡8_t
;

91 #ià
__WORDSIZE
 == 64

92 
	tšt_ç¡16_t
;

93 
	tšt_ç¡32_t
;

94 
	tšt_ç¡64_t
;

96 
	tšt_ç¡16_t
;

97 
	tšt_ç¡32_t
;

98 
__ex‹nsiÚ__


99 
	tšt_ç¡64_t
;

103 
	tušt_ç¡8_t
;

104 #ià
__WORDSIZE
 == 64

105 
	tušt_ç¡16_t
;

106 
	tušt_ç¡32_t
;

107 
	tušt_ç¡64_t
;

109 
	tušt_ç¡16_t
;

110 
	tušt_ç¡32_t
;

111 
__ex‹nsiÚ__


112 
	tušt_ç¡64_t
;

117 #ià
__WORDSIZE
 == 64

118 #iâdeà
__šŒ_t_defšed


119 
	tšŒ_t
;

120 
	#__šŒ_t_defšed


	)

122 
	tušŒ_t
;

124 #iâdeà
__šŒ_t_defšed


125 
	tšŒ_t
;

126 
	#__šŒ_t_defšed


	)

128 
	tušŒ_t
;

133 #ià
__WORDSIZE
 == 64

134 
	tštmax_t
;

135 
	tuštmax_t
;

137 
__ex‹nsiÚ__


138 
	tštmax_t
;

139 
__ex‹nsiÚ__


140 
	tuštmax_t
;

144 #ià
__WORDSIZE
 == 64

145 
	#__INT64_C
(
c
èø## 
L


	)

146 
	#__UINT64_C
(
c
èø## 
UL


	)

148 
	#__INT64_C
(
c
èø## 
LL


	)

149 
	#__UINT64_C
(
c
èø## 
ULL


	)

155 
	#INT8_MIN
 (-128)

	)

156 
	#INT16_MIN
 (-32767-1)

	)

157 
	#INT32_MIN
 (-2147483647-1)

	)

158 
	#INT64_MIN
 (-
	`__INT64_C
(9223372036854775807)-1)

	)

160 
	#INT8_MAX
 (127)

	)

161 
	#INT16_MAX
 (32767)

	)

162 
	#INT32_MAX
 (2147483647)

	)

163 
	#INT64_MAX
 (
	`__INT64_C
(9223372036854775807))

	)

166 
	#UINT8_MAX
 (255)

	)

167 
	#UINT16_MAX
 (65535)

	)

168 
	#UINT32_MAX
 (4294967295U)

	)

169 
	#UINT64_MAX
 (
	`__UINT64_C
(18446744073709551615))

	)

173 
	#INT_LEAST8_MIN
 (-128)

	)

174 
	#INT_LEAST16_MIN
 (-32767-1)

	)

175 
	#INT_LEAST32_MIN
 (-2147483647-1)

	)

176 
	#INT_LEAST64_MIN
 (-
	`__INT64_C
(9223372036854775807)-1)

	)

178 
	#INT_LEAST8_MAX
 (127)

	)

179 
	#INT_LEAST16_MAX
 (32767)

	)

180 
	#INT_LEAST32_MAX
 (2147483647)

	)

181 
	#INT_LEAST64_MAX
 (
	`__INT64_C
(9223372036854775807))

	)

184 
	#UINT_LEAST8_MAX
 (255)

	)

185 
	#UINT_LEAST16_MAX
 (65535)

	)

186 
	#UINT_LEAST32_MAX
 (4294967295U)

	)

187 
	#UINT_LEAST64_MAX
 (
	`__UINT64_C
(18446744073709551615))

	)

191 
	#INT_FAST8_MIN
 (-128)

	)

192 #ià
__WORDSIZE
 == 64

193 
	#INT_FAST16_MIN
 (-9223372036854775807L-1)

	)

194 
	#INT_FAST32_MIN
 (-9223372036854775807L-1)

	)

196 
	#INT_FAST16_MIN
 (-2147483647-1)

	)

197 
	#INT_FAST32_MIN
 (-2147483647-1)

	)

199 
	#INT_FAST64_MIN
 (-
	`__INT64_C
(9223372036854775807)-1)

	)

201 
	#INT_FAST8_MAX
 (127)

	)

202 #ià
__WORDSIZE
 == 64

203 
	#INT_FAST16_MAX
 (9223372036854775807L)

	)

204 
	#INT_FAST32_MAX
 (9223372036854775807L)

	)

206 
	#INT_FAST16_MAX
 (2147483647)

	)

207 
	#INT_FAST32_MAX
 (2147483647)

	)

209 
	#INT_FAST64_MAX
 (
	`__INT64_C
(9223372036854775807))

	)

212 
	#UINT_FAST8_MAX
 (255)

	)

213 #ià
__WORDSIZE
 == 64

214 
	#UINT_FAST16_MAX
 (18446744073709551615UL)

	)

215 
	#UINT_FAST32_MAX
 (18446744073709551615UL)

	)

217 
	#UINT_FAST16_MAX
 (4294967295U)

	)

218 
	#UINT_FAST32_MAX
 (4294967295U)

	)

220 
	#UINT_FAST64_MAX
 (
	`__UINT64_C
(18446744073709551615))

	)

224 #ià
__WORDSIZE
 == 64

225 
	#INTPTR_MIN
 (-9223372036854775807L-1)

	)

226 
	#INTPTR_MAX
 (9223372036854775807L)

	)

227 
	#UINTPTR_MAX
 (18446744073709551615UL)

	)

229 
	#INTPTR_MIN
 (-2147483647-1)

	)

230 
	#INTPTR_MAX
 (2147483647)

	)

231 
	#UINTPTR_MAX
 (4294967295U)

	)

236 
	#INTMAX_MIN
 (-
	`__INT64_C
(9223372036854775807)-1)

	)

238 
	#INTMAX_MAX
 (
	`__INT64_C
(9223372036854775807))

	)

241 
	#UINTMAX_MAX
 (
	`__UINT64_C
(18446744073709551615))

	)

247 #ià
__WORDSIZE
 == 64

248 
	#PTRDIFF_MIN
 (-9223372036854775807L-1)

	)

249 
	#PTRDIFF_MAX
 (9223372036854775807L)

	)

251 
	#PTRDIFF_MIN
 (-2147483647-1)

	)

252 
	#PTRDIFF_MAX
 (2147483647)

	)

256 
	#SIG_ATOMIC_MIN
 (-2147483647-1)

	)

257 
	#SIG_ATOMIC_MAX
 (2147483647)

	)

260 #ià
__WORDSIZE
 == 64

261 
	#SIZE_MAX
 (18446744073709551615UL)

	)

263 
	#SIZE_MAX
 (4294967295U)

	)

267 #iâdeà
WCHAR_MIN


269 
	#WCHAR_MIN
 
__WCHAR_MIN


	)

270 
	#WCHAR_MAX
 
__WCHAR_MAX


	)

274 
	#WINT_MIN
 (0u)

	)

275 
	#WINT_MAX
 (4294967295u)

	)

278 
	#INT8_C
(
c
è
	)
c

279 
	#INT16_C
(
c
è
	)
c

280 
	#INT32_C
(
c
è
	)
c

281 #ià
__WORDSIZE
 == 64

282 
	#INT64_C
(
c
èø## 
L


	)

284 
	#INT64_C
(
c
èø## 
LL


	)

288 
	#UINT8_C
(
c
è
	)
c

289 
	#UINT16_C
(
c
è
	)
c

290 
	#UINT32_C
(
c
èø## 
U


	)

291 #ià
__WORDSIZE
 == 64

292 
	#UINT64_C
(
c
èø## 
UL


	)

294 
	#UINT64_C
(
c
èø## 
ULL


	)

298 #ià
__WORDSIZE
 == 64

299 
	#INTMAX_C
(
c
èø## 
L


	)

300 
	#UINTMAX_C
(
c
èø## 
UL


	)

302 
	#INTMAX_C
(
c
èø## 
LL


	)

303 
	#UINTMAX_C
(
c
èø## 
ULL


	)

	@/usr/include/stdio.h

23 #iâdeà
_STDIO_H


25 #ià!
defšed
 
__Ãed_FILE
 && !defšed 
__Ãed___FILE


26 
	#_STDIO_H
 1

	)

27 
	~<ã©u»s.h
>

29 
	g__BEGIN_DECLS


31 
	#__Ãed_size_t


	)

32 
	#__Ãed_NULL


	)

33 
	~<¡ddef.h
>

35 
	~<b™s/ty³s.h
>

36 
	#__Ãed_FILE


	)

37 
	#__Ãed___FILE


	)

41 #ià!
defšed
 
__FILE_defšed
 && defšed 
__Ãed_FILE


44 
	g_IO_FILE
;

46 
__BEGIN_NAMESPACE_STD


48 
_IO_FILE
 
	tFILE
;

49 
	g__END_NAMESPACE_STD


50 #ià
defšed
 
__USE_LARGEFILE64
 || defšed 
__USE_SVID
 || defšed 
__USE_POSIX
 \

51 || 
defšed
 
	g__USE_BSD
 || defšed 
	g__USE_ISOC99
 || defšed 
	g__USE_XOPEN
 \

52 || 
defšed
 
__USE_POSIX2


53 
	$__USING_NAMESPACE_STD
(
FILE
)

56 
	#__FILE_defšed
 1

	)

58 #undeà
__Ãed_FILE


61 #ià!
defšed
 
____FILE_defšed
 && defšed 
__Ãed___FILE


64 
_IO_FILE
 
	t__FILE
;

66 
	#____FILE_defšed
 1

	)

68 #undeà
__Ãed___FILE


71 #ifdef 
_STDIO_H


72 
	#_STDIO_USES_IOSTREAM


	)

74 
	~<libio.h
>

76 #ià
defšed
 
__USE_XOPEN
 || defšed 
__USE_XOPEN2K8


77 #ifdeà
__GNUC__


78 #iâdeà
_VA_LIST_DEFINED


79 
_G_va_li¡
 
	tva_li¡
;

80 
	#_VA_LIST_DEFINED


	)

83 
	~<¡d¬g.h
>

87 #ifdeà
__USE_XOPEN2K8


88 #iâdeà
__off_t_defšed


89 #iâdeà
__USE_FILE_OFFSET64


90 
__off_t
 
	toff_t
;

92 
__off64_t
 
	toff_t
;

94 
	#__off_t_defšed


	)

96 #ià
defšed
 
__USE_LARGEFILE64
 && !defšed 
__off64_t_defšed


97 
__off64_t
 
	toff64_t
;

98 
	#__off64_t_defšed


	)

101 #iâdeà
__ssize_t_defšed


102 
__ssize_t
 
	tssize_t
;

103 
	#__ssize_t_defšed


	)

108 
__BEGIN_NAMESPACE_STD


109 #iâdeà
__USE_FILE_OFFSET64


110 
_G_åos_t
 
	tåos_t
;

112 
_G_åos64_t
 
	tåos_t
;

114 
__END_NAMESPACE_STD


115 #ifdeà
__USE_LARGEFILE64


116 
_G_åos64_t
 
	tåos64_t
;

120 
	#_IOFBF
 0

	)

121 
	#_IOLBF
 1

	)

122 
	#_IONBF
 2

	)

126 #iâdeà
BUFSIZ


127 
	#BUFSIZ
 
_IO_BUFSIZ


	)

133 #iâdeà
EOF


134 
	#EOF
 (-1)

	)

140 
	#SEEK_SET
 0

	)

141 
	#SEEK_CUR
 1

	)

142 
	#SEEK_END
 2

	)

143 #ifdeà
__USE_GNU


144 
	#SEEK_DATA
 3

	)

145 
	#SEEK_HOLE
 4

	)

149 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_XOPEN


151 
	#P_tmpdœ
 "/tmp"

	)

164 
	~<b™s/¡dio_lim.h
>

168 
_IO_FILE
 *
¡dš
;

169 
_IO_FILE
 *
¡dout
;

170 
_IO_FILE
 *
¡d”r
;

172 
	#¡dš
 
¡dš


	)

173 
	#¡dout
 
¡dout


	)

174 
	#¡d”r
 
¡d”r


	)

176 
__BEGIN_NAMESPACE_STD


178 
	$»move
 (cÚ¡ *
__f’ame
è
__THROW
;

180 
	$»Çme
 (cÚ¡ *
__Şd
, cÚ¡ *
__Ãw
è
__THROW
;

181 
__END_NAMESPACE_STD


183 #ifdeà
__USE_ATFILE


185 
	$»Çm—t
 (
__Şdfd
, cÚ¡ *
__Şd
, 
__Ãwfd
,

186 cÚ¡ *
__Ãw
è
__THROW
;

189 
__BEGIN_NAMESPACE_STD


194 #iâdeà
__USE_FILE_OFFSET64


195 
FILE
 *
	$tmpfe
 (è
__wur
;

197 #ifdeà
__REDIRECT


198 
FILE
 *
	`__REDIRECT
 (
tmpfe
, (), 
tmpfe64
è
__wur
;

200 
	#tmpfe
 
tmpfe64


	)

204 #ifdeà
__USE_LARGEFILE64


205 
FILE
 *
	$tmpfe64
 (è
__wur
;

209 *
	$tm²am
 (*
__s
è
__THROW
 
__wur
;

210 
__END_NAMESPACE_STD


212 #ifdeà
__USE_MISC


215 *
	$tm²am_r
 (*
__s
è
__THROW
 
__wur
;

219 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_XOPEN


227 *
	$‹m²am
 (cÚ¡ *
__dœ
, cÚ¡ *
__pfx
)

228 
__THROW
 
__©Œibu‹_m®loc__
 
__wur
;

232 
__BEGIN_NAMESPACE_STD


237 
	`fşo£
 (
FILE
 *
__¡»am
);

242 
	`fæush
 (
FILE
 *
__¡»am
);

243 
__END_NAMESPACE_STD


245 #ifdeà
__USE_MISC


252 
	`fæush_uÆocked
 (
FILE
 *
__¡»am
);

255 #ifdeà
__USE_GNU


262 
	`fşo£®l
 ();

266 
__BEGIN_NAMESPACE_STD


267 #iâdeà
__USE_FILE_OFFSET64


272 
FILE
 *
	$fİ’
 (cÚ¡ *
__»¡riù
 
__f’ame
,

273 cÚ¡ *
__»¡riù
 
__modes
è
__wur
;

278 
FILE
 *
	$äeİ’
 (cÚ¡ *
__»¡riù
 
__f’ame
,

279 cÚ¡ *
__»¡riù
 
__modes
,

280 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

282 #ifdeà
__REDIRECT


283 
FILE
 *
	`__REDIRECT
 (
fİ’
, (cÚ¡ *
__»¡riù
 
__f’ame
,

284 cÚ¡ *
__»¡riù
 
__modes
), 
fİ’64
)

285 
__wur
;

286 
FILE
 *
	`__REDIRECT
 (
äeİ’
, (cÚ¡ *
__»¡riù
 
__f’ame
,

287 cÚ¡ *
__»¡riù
 
__modes
,

288 
FILE
 *
__»¡riù
 
__¡»am
), 
äeİ’64
)

289 
__wur
;

291 
	#fİ’
 
fİ’64


	)

292 
	#äeİ’
 
äeİ’64


	)

295 
__END_NAMESPACE_STD


296 #ifdeà
__USE_LARGEFILE64


297 
FILE
 *
	$fİ’64
 (cÚ¡ *
__»¡riù
 
__f’ame
,

298 cÚ¡ *
__»¡riù
 
__modes
è
__wur
;

299 
FILE
 *
	$äeİ’64
 (cÚ¡ *
__»¡riù
 
__f’ame
,

300 cÚ¡ *
__»¡riù
 
__modes
,

301 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

304 #ifdef 
__USE_POSIX


306 
FILE
 *
	$fdİ’
 (
__fd
, cÚ¡ *
__modes
è
__THROW
 
__wur
;

309 #ifdef 
__USE_GNU


312 
FILE
 *
	$fİ’cook›
 (*
__»¡riù
 
__magic_cook›
,

313 cÚ¡ *
__»¡riù
 
__modes
,

314 
_IO_cook›_io_funùiÚs_t
 
__io_funcs
è
__THROW
 
__wur
;

317 #ifdeà
__USE_XOPEN2K8


319 
FILE
 *
	$fmemİ’
 (*
__s
, 
size_t
 
__Ën
, cÚ¡ *
__modes
)

320 
__THROW
 
__wur
;

325 
FILE
 *
	$İ’_mem¡»am
 (**
__buæoc
, 
size_t
 *
__siz–oc
è
__THROW
 
__wur
;

329 
__BEGIN_NAMESPACE_STD


332 
	$£tbuf
 (
FILE
 *
__»¡riù
 
__¡»am
, *__»¡riù 
__buf
è
__THROW
;

336 
	$£tvbuf
 (
FILE
 *
__»¡riù
 
__¡»am
, *__»¡riù 
__buf
,

337 
__modes
, 
size_t
 
__n
è
__THROW
;

338 
__END_NAMESPACE_STD


340 #ifdef 
__USE_BSD


343 
	$£tbufãr
 (
FILE
 *
__»¡riù
 
__¡»am
, *__»¡riù 
__buf
,

344 
size_t
 
__size
è
__THROW
;

347 
	$£šebuf
 (
FILE
 *
__¡»am
è
__THROW
;

351 
__BEGIN_NAMESPACE_STD


356 
	`årštf
 (
FILE
 *
__»¡riù
 
__¡»am
,

357 cÚ¡ *
__»¡riù
 
__fÜm©
, ...);

362 
	`´štf
 (cÚ¡ *
__»¡riù
 
__fÜm©
, ...);

364 
	$¥rštf
 (*
__»¡riù
 
__s
,

365 cÚ¡ *
__»¡riù
 
__fÜm©
, ...è
__THROWNL
;

371 
	`vårštf
 (
FILE
 *
__»¡riù
 
__s
, cÚ¡ *__»¡riù 
__fÜm©
,

372 
_G_va_li¡
 
__¬g
);

377 
	`v´štf
 (cÚ¡ *
__»¡riù
 
__fÜm©
, 
_G_va_li¡
 
__¬g
);

379 
	$v¥rštf
 (*
__»¡riù
 
__s
, cÚ¡ *__»¡riù 
__fÜm©
,

380 
_G_va_li¡
 
__¬g
è
__THROWNL
;

381 
__END_NAMESPACE_STD


383 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_ISOC99
 || defšed 
__USE_UNIX98


384 
__BEGIN_NAMESPACE_C99


386 
	$¢´štf
 (*
__»¡riù
 
__s
, 
size_t
 
__maxËn
,

387 cÚ¡ *
__»¡riù
 
__fÜm©
, ...)

388 
__THROWNL
 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 3, 4)));

390 
	$v¢´štf
 (*
__»¡riù
 
__s
, 
size_t
 
__maxËn
,

391 cÚ¡ *
__»¡riù
 
__fÜm©
, 
_G_va_li¡
 
__¬g
)

392 
__THROWNL
 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 3, 0)));

393 
__END_NAMESPACE_C99


396 #ifdeà
__USE_GNU


399 
	$va¥rštf
 (**
__»¡riù
 
__±r
, cÚ¡ *__»¡riù 
__f
,

400 
_G_va_li¡
 
__¬g
)

401 
__THROWNL
 
	`__©Œibu‹__
 ((
	$__fÜm©__
 (
__´štf__
, 2, 0))è
__wur
;

402 
	$__a¥rštf
 (**
__»¡riù
 
__±r
,

403 cÚ¡ *
__»¡riù
 
__fmt
, ...)

404 
__THROWNL
 
	`__©Œibu‹__
 ((
	$__fÜm©__
 (
__´štf__
, 2, 3))è
__wur
;

405 
	$a¥rštf
 (**
__»¡riù
 
__±r
,

406 cÚ¡ *
__»¡riù
 
__fmt
, ...)

407 
__THROWNL
 
	`__©Œibu‹__
 ((
	$__fÜm©__
 (
__´štf__
, 2, 3))è
__wur
;

410 #ifdeà
__USE_XOPEN2K8


412 
	$vd´štf
 (
__fd
, cÚ¡ *
__»¡riù
 
__fmt
,

413 
_G_va_li¡
 
__¬g
)

414 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 2, 0)));

415 
	$d´štf
 (
__fd
, cÚ¡ *
__»¡riù
 
__fmt
, ...)

416 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 2, 3)));

420 
__BEGIN_NAMESPACE_STD


425 
	$fsÿnf
 (
FILE
 *
__»¡riù
 
__¡»am
,

426 cÚ¡ *
__»¡riù
 
__fÜm©
, ...è
__wur
;

431 
	$sÿnf
 (cÚ¡ *
__»¡riù
 
__fÜm©
, ...è
__wur
;

433 
	$ssÿnf
 (cÚ¡ *
__»¡riù
 
__s
,

434 cÚ¡ *
__»¡riù
 
__fÜm©
, ...è
__THROW
;

436 #ià
defšed
 
__USE_ISOC99
 && !defšed 
__USE_GNU
 \

437 && (!
defšed
 
__LDBL_COMPAT
 || !defšed 
__REDIRECT
) \

438 && (
defšed
 
__STRICT_ANSI__
 || defšed 
__USE_XOPEN2K
)

439 #ifdeà
__REDIRECT


443 
	`__REDIRECT
 (
fsÿnf
, (
FILE
 *
__»¡riù
 
__¡»am
,

444 cÚ¡ *
__»¡riù
 
__fÜm©
, ...),

445 
__isoc99_fsÿnf
è
__wur
;

446 
	`__REDIRECT
 (
sÿnf
, (cÚ¡ *
__»¡riù
 
__fÜm©
, ...),

447 
__isoc99_sÿnf
è
__wur
;

448 
	`__REDIRECT_NTH
 (
ssÿnf
, (cÚ¡ *
__»¡riù
 
__s
,

449 cÚ¡ *
__»¡riù
 
__fÜm©
, ...),

450 
__isoc99_ssÿnf
);

452 
	$__isoc99_fsÿnf
 (
FILE
 *
__»¡riù
 
__¡»am
,

453 cÚ¡ *
__»¡riù
 
__fÜm©
, ...è
__wur
;

454 
	$__isoc99_sÿnf
 (cÚ¡ *
__»¡riù
 
__fÜm©
, ...è
__wur
;

455 
	$__isoc99_ssÿnf
 (cÚ¡ *
__»¡riù
 
__s
,

456 cÚ¡ *
__»¡riù
 
__fÜm©
, ...è
__THROW
;

457 
	#fsÿnf
 
__isoc99_fsÿnf


	)

458 
	#sÿnf
 
__isoc99_sÿnf


	)

459 
	#ssÿnf
 
__isoc99_ssÿnf


	)

463 
__END_NAMESPACE_STD


465 #ifdef 
__USE_ISOC99


466 
__BEGIN_NAMESPACE_C99


471 
	$vfsÿnf
 (
FILE
 *
__»¡riù
 
__s
, cÚ¡ *__»¡riù 
__fÜm©
,

472 
_G_va_li¡
 
__¬g
)

473 
	`__©Œibu‹__
 ((
	$__fÜm©__
 (
__sÿnf__
, 2, 0))è
__wur
;

479 
	$vsÿnf
 (cÚ¡ *
__»¡riù
 
__fÜm©
, 
_G_va_li¡
 
__¬g
)

480 
	`__©Œibu‹__
 ((
	$__fÜm©__
 (
__sÿnf__
, 1, 0))è
__wur
;

483 
	$vssÿnf
 (cÚ¡ *
__»¡riù
 
__s
,

484 cÚ¡ *
__»¡riù
 
__fÜm©
, 
_G_va_li¡
 
__¬g
)

485 
__THROW
 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__sÿnf__
, 2, 0)));

487 #ià!
defšed
 
__USE_GNU
 \

488 && (!
defšed
 
__LDBL_COMPAT
 || !defšed 
__REDIRECT
) \

489 && (
defšed
 
__STRICT_ANSI__
 || defšed 
__USE_XOPEN2K
)

490 #ifdeà
__REDIRECT


494 
	`__REDIRECT
 (
vfsÿnf
,

495 (
FILE
 *
__»¡riù
 
__s
,

496 cÚ¡ *
__»¡riù
 
__fÜm©
, 
_G_va_li¡
 
__¬g
),

497 
__isoc99_vfsÿnf
)

498 
	`__©Œibu‹__
 ((
	$__fÜm©__
 (
__sÿnf__
, 2, 0))è
__wur
;

499 
	`__REDIRECT
 (
vsÿnf
, (cÚ¡ *
__»¡riù
 
__fÜm©
,

500 
_G_va_li¡
 
__¬g
), 
__isoc99_vsÿnf
)

501 
	`__©Œibu‹__
 ((
	$__fÜm©__
 (
__sÿnf__
, 1, 0))è
__wur
;

502 
	`__REDIRECT_NTH
 (
vssÿnf
,

503 (cÚ¡ *
__»¡riù
 
__s
,

504 cÚ¡ *
__»¡riù
 
__fÜm©
,

505 
_G_va_li¡
 
__¬g
), 
__isoc99_vssÿnf
)

506 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__sÿnf__
, 2, 0)));

508 
	$__isoc99_vfsÿnf
 (
FILE
 *
__»¡riù
 
__s
,

509 cÚ¡ *
__»¡riù
 
__fÜm©
,

510 
_G_va_li¡
 
__¬g
è
__wur
;

511 
	$__isoc99_vsÿnf
 (cÚ¡ *
__»¡riù
 
__fÜm©
,

512 
_G_va_li¡
 
__¬g
è
__wur
;

513 
	$__isoc99_vssÿnf
 (cÚ¡ *
__»¡riù
 
__s
,

514 cÚ¡ *
__»¡riù
 
__fÜm©
,

515 
_G_va_li¡
 
__¬g
è
__THROW
;

516 
	#vfsÿnf
 
__isoc99_vfsÿnf


	)

517 
	#vsÿnf
 
__isoc99_vsÿnf


	)

518 
	#vssÿnf
 
__isoc99_vssÿnf


	)

522 
__END_NAMESPACE_C99


526 
__BEGIN_NAMESPACE_STD


531 
	`fg‘c
 (
FILE
 *
__¡»am
);

532 
	`g‘c
 (
FILE
 *
__¡»am
);

538 
	`g‘ch¬
 ();

539 
__END_NAMESPACE_STD


543 
	#g‘c
(
_å
è
	`_IO_g‘c
 (_å)

	)

545 #ià
defšed
 
__USE_POSIX
 || defšed 
__USE_MISC


550 
	`g‘c_uÆocked
 (
FILE
 *
__¡»am
);

551 
	`g‘ch¬_uÆocked
 ();

554 #ifdeà
__USE_MISC


561 
	`fg‘c_uÆocked
 (
FILE
 *
__¡»am
);

565 
__BEGIN_NAMESPACE_STD


573 
	`åutc
 (
__c
, 
FILE
 *
__¡»am
);

574 
	`putc
 (
__c
, 
FILE
 *
__¡»am
);

580 
	`putch¬
 (
__c
);

581 
__END_NAMESPACE_STD


585 
	#putc
(
_ch
, 
_å
è
	`_IO_putc
 (_ch, _å)

	)

587 #ifdeà
__USE_MISC


594 
	`åutc_uÆocked
 (
__c
, 
FILE
 *
__¡»am
);

597 #ià
defšed
 
__USE_POSIX
 || defšed 
__USE_MISC


602 
	`putc_uÆocked
 (
__c
, 
FILE
 *
__¡»am
);

603 
	`putch¬_uÆocked
 (
__c
);

607 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_MISC
 \

608 || (
defšed
 
__USE_XOPEN
 && !defšed 
__USE_XOPEN2K
)

610 
	`g‘w
 (
FILE
 *
__¡»am
);

613 
	`putw
 (
__w
, 
FILE
 *
__¡»am
);

617 
__BEGIN_NAMESPACE_STD


622 *
	$fg‘s
 (*
__»¡riù
 
__s
, 
__n
, 
FILE
 *__»¡riù 
__¡»am
)

623 
__wur
;

625 #ià!
defšed
 
__USE_ISOC11
 \

626 || (
defšed
 
__ılu¥lus
 && __cplusplus <= 201103L)

638 *
	$g‘s
 (*
__s
è
__wur
 
__©Œibu‹_d•»ÿ‹d__
;

640 
__END_NAMESPACE_STD


642 #ifdeà
__USE_GNU


649 *
	$fg‘s_uÆocked
 (*
__»¡riù
 
__s
, 
__n
,

650 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

654 #ifdef 
__USE_XOPEN2K8


665 
_IO_ssize_t
 
	$__g‘d–im
 (**
__»¡riù
 
__lš•Œ
,

666 
size_t
 *
__»¡riù
 
__n
, 
__d–im™”
,

667 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

668 
_IO_ssize_t
 
	$g‘d–im
 (**
__»¡riù
 
__lš•Œ
,

669 
size_t
 *
__»¡riù
 
__n
, 
__d–im™”
,

670 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

678 
_IO_ssize_t
 
	$g‘lše
 (**
__»¡riù
 
__lš•Œ
,

679 
size_t
 *
__»¡riù
 
__n
,

680 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

684 
__BEGIN_NAMESPACE_STD


689 
	`åuts
 (cÚ¡ *
__»¡riù
 
__s
, 
FILE
 *__»¡riù 
__¡»am
);

695 
	`puts
 (cÚ¡ *
__s
);

702 
	`ung‘c
 (
__c
, 
FILE
 *
__¡»am
);

709 
size_t
 
	$ä—d
 (*
__»¡riù
 
__±r
, 
size_t
 
__size
,

710 
size_t
 
__n
, 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

715 
size_t
 
	`fwr™e
 (cÚ¡ *
__»¡riù
 
__±r
, size_ˆ
__size
,

716 
size_t
 
__n
, 
FILE
 *
__»¡riù
 
__s
);

717 
__END_NAMESPACE_STD


719 #ifdeà
__USE_GNU


726 
	`åuts_uÆocked
 (cÚ¡ *
__»¡riù
 
__s
,

727 
FILE
 *
__»¡riù
 
__¡»am
);

730 #ifdeà
__USE_MISC


737 
size_t
 
	$ä—d_uÆocked
 (*
__»¡riù
 
__±r
, 
size_t
 
__size
,

738 
size_t
 
__n
, 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

739 
size_t
 
	`fwr™e_uÆocked
 (cÚ¡ *
__»¡riù
 
__±r
, size_ˆ
__size
,

740 
size_t
 
__n
, 
FILE
 *
__»¡riù
 
__¡»am
);

744 
__BEGIN_NAMESPACE_STD


749 
	`f£ek
 (
FILE
 *
__¡»am
, 
__off
, 
__wh’û
);

754 
	$á–l
 (
FILE
 *
__¡»am
è
__wur
;

759 
	`»wšd
 (
FILE
 *
__¡»am
);

760 
__END_NAMESPACE_STD


767 #ià
defšed
 
__USE_LARGEFILE
 || defšed 
__USE_XOPEN2K


768 #iâdeà
__USE_FILE_OFFSET64


773 
	`f£eko
 (
FILE
 *
__¡»am
, 
__off_t
 
__off
, 
__wh’û
);

778 
__off_t
 
	$á–lo
 (
FILE
 *
__¡»am
è
__wur
;

780 #ifdeà
__REDIRECT


781 
	`__REDIRECT
 (
f£eko
,

782 (
FILE
 *
__¡»am
, 
__off64_t
 
__off
, 
__wh’û
),

783 
f£eko64
);

784 
__off64_t
 
	`__REDIRECT
 (
á–lo
, (
FILE
 *
__¡»am
), 
á–lo64
);

786 
	#f£eko
 
f£eko64


	)

787 
	#á–lo
 
á–lo64


	)

792 
__BEGIN_NAMESPACE_STD


793 #iâdeà
__USE_FILE_OFFSET64


798 
	`fg‘pos
 (
FILE
 *
__»¡riù
 
__¡»am
, 
åos_t
 *__»¡riù 
__pos
);

803 
	`f£os
 (
FILE
 *
__¡»am
, cÚ¡ 
åos_t
 *
__pos
);

805 #ifdeà
__REDIRECT


806 
	`__REDIRECT
 (
fg‘pos
, (
FILE
 *
__»¡riù
 
__¡»am
,

807 
åos_t
 *
__»¡riù
 
__pos
), 
fg‘pos64
);

808 
	`__REDIRECT
 (
f£os
,

809 (
FILE
 *
__¡»am
, cÚ¡ 
åos_t
 *
__pos
), 
f£os64
);

811 
	#fg‘pos
 
fg‘pos64


	)

812 
	#f£os
 
f£os64


	)

815 
__END_NAMESPACE_STD


817 #ifdeà
__USE_LARGEFILE64


818 
	`f£eko64
 (
FILE
 *
__¡»am
, 
__off64_t
 
__off
, 
__wh’û
);

819 
__off64_t
 
	$á–lo64
 (
FILE
 *
__¡»am
è
__wur
;

820 
	`fg‘pos64
 (
FILE
 *
__»¡riù
 
__¡»am
, 
åos64_t
 *__»¡riù 
__pos
);

821 
	`f£os64
 (
FILE
 *
__¡»am
, cÚ¡ 
åos64_t
 *
__pos
);

824 
__BEGIN_NAMESPACE_STD


826 
	$ş—»¼
 (
FILE
 *
__¡»am
è
__THROW
;

828 
	$ãof
 (
FILE
 *
__¡»am
è
__THROW
 
__wur
;

830 
	$ã¼Ü
 (
FILE
 *
__¡»am
è
__THROW
 
__wur
;

831 
__END_NAMESPACE_STD


833 #ifdeà
__USE_MISC


835 
	$ş—»¼_uÆocked
 (
FILE
 *
__¡»am
è
__THROW
;

836 
	$ãof_uÆocked
 (
FILE
 *
__¡»am
è
__THROW
 
__wur
;

837 
	$ã¼Ü_uÆocked
 (
FILE
 *
__¡»am
è
__THROW
 
__wur
;

841 
__BEGIN_NAMESPACE_STD


846 
	`³¼Ü
 (cÚ¡ *
__s
);

847 
__END_NAMESPACE_STD


853 
	~<b™s/sys_”¾i¡.h
>

856 #ifdef 
__USE_POSIX


858 
	$f’o
 (
FILE
 *
__¡»am
è
__THROW
 
__wur
;

861 #ifdeà
__USE_MISC


863 
	$f’o_uÆocked
 (
FILE
 *
__¡»am
è
__THROW
 
__wur
;

867 #ià(
defšed
 
__USE_POSIX2
 || defšed 
__USE_SVID
 || defšed 
__USE_BSD
 || \

868 
defšed
 
__USE_MISC
)

873 
FILE
 *
	$pİ’
 (cÚ¡ *
__commªd
, cÚ¡ *
__modes
è
__wur
;

879 
	`pşo£
 (
FILE
 *
__¡»am
);

883 #ifdef 
__USE_POSIX


885 *
	$ù”mid
 (*
__s
è
__THROW
;

889 #ifdeà
__USE_XOPEN


891 *
	`cu£rid
 (*
__s
);

895 #ifdef 
__USE_GNU


896 
ob¡ack
;

899 
	$ob¡ack_´štf
 (
ob¡ack
 *
__»¡riù
 
__ob¡ack
,

900 cÚ¡ *
__»¡riù
 
__fÜm©
, ...)

901 
__THROWNL
 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 2, 3)));

902 
	$ob¡ack_v´štf
 (
ob¡ack
 *
__»¡riù
 
__ob¡ack
,

903 cÚ¡ *
__»¡riù
 
__fÜm©
,

904 
_G_va_li¡
 
__¬gs
)

905 
__THROWNL
 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 2, 0)));

909 #ià
defšed
 
__USE_POSIX
 || defšed 
__USE_MISC


913 
	$æockfe
 (
FILE
 *
__¡»am
è
__THROW
;

917 
	$árylockfe
 (
FILE
 *
__¡»am
è
__THROW
 
__wur
;

920 
	$fuÆockfe
 (
FILE
 *
__¡»am
è
__THROW
;

923 #ià
defšed
 
__USE_XOPEN
 && !defšed 
__USE_XOPEN2K
 && !defšed 
__USE_GNU


927 
	#__Ãed_g‘İt


	)

928 
	~<g‘İt.h
>

933 #ifdeà
__USE_EXTERN_INLINES


934 
	~<b™s/¡dio.h
>

936 #ià
__USE_FORTIFY_LEVEL
 > 0 && 
defšed
 
__ex‹º_®ways_šlše


937 
	~<b™s/¡dio2.h
>

939 #ifdeà
__LDBL_COMPAT


940 
	~<b™s/¡dio-ldbl.h
>

943 
__END_DECLS


	@/usr/include/xlocale.h

20 #iâdeà
_XLOCALE_H


21 
	#_XLOCALE_H
 1

	)

27 
	s__loÿË_¡ruù


30 
__loÿË_d©a
 *
	m__loÿËs
[13];

33 cÚ¡ *
	m__ùy³_b
;

34 cÚ¡ *
	m__ùy³_tŞow”
;

35 cÚ¡ *
	m__ùy³_touµ”
;

38 cÚ¡ *
	m__Çmes
[13];

39 } *
	t__loÿË_t
;

42 
__loÿË_t
 
	tloÿË_t
;

	@/usr/include/libio.h

28 #iâdeà
_IO_STDIO_H


29 
	#_IO_STDIO_H


	)

31 
	~<_G_cÚfig.h
>

33 
	#_IO_åos_t
 
_G_åos_t


	)

34 
	#_IO_åos64_t
 
_G_åos64_t


	)

35 
	#_IO_size_t
 
size_t


	)

36 
	#_IO_ssize_t
 
__ssize_t


	)

37 
	#_IO_off_t
 
__off_t


	)

38 
	#_IO_off64_t
 
__off64_t


	)

39 
	#_IO_pid_t
 
__pid_t


	)

40 
	#_IO_uid_t
 
__uid_t


	)

41 
	#_IO_icÚv_t
 
_G_icÚv_t


	)

42 
	#_IO_HAVE_ST_BLKSIZE
 
_G_HAVE_ST_BLKSIZE


	)

43 
	#_IO_BUFSIZ
 
_G_BUFSIZ


	)

44 
	#_IO_va_li¡
 
_G_va_li¡


	)

45 
	#_IO_wšt_t
 
wšt_t


	)

48 
	#__Ãed___va_li¡


	)

49 
	~<¡d¬g.h
>

50 #ifdeà
__GNUC_VA_LIST


51 #undeà
_IO_va_li¡


52 
	#_IO_va_li¡
 
__gnuc_va_li¡


	)

55 #iâdeà
__P


56 
	~<sys/cdefs.h
>

59 
	#_IO_UNIFIED_JUMPTABLES
 1

	)

61 #iâdeà
EOF


62 
	#EOF
 (-1)

	)

64 #iâdeà
NULL


65 #ià
defšed
 
__GNUG__
 && \

66 (
	g__GNUC__
 > 2 || (__GNUC__ =ğ2 && 
__GNUC_MINOR__
 >= 8))

67 
	#NULL
 (
__nuÎ
)

	)

69 #ià!
defšed
(
__ılu¥lus
)

70 
	#NULL
 ((*)0)

	)

72 
	#NULL
 (0)

	)

77 
	#_IOS_INPUT
 1

	)

78 
	#_IOS_OUTPUT
 2

	)

79 
	#_IOS_ATEND
 4

	)

80 
	#_IOS_APPEND
 8

	)

81 
	#_IOS_TRUNC
 16

	)

82 
	#_IOS_NOCREATE
 32

	)

83 
	#_IOS_NOREPLACE
 64

	)

84 
	#_IOS_BIN
 128

	)

92 
	#_IO_MAGIC
 0xFBAD0000

	)

93 
	#_OLD_STDIO_MAGIC
 0xFABC0000

	)

94 
	#_IO_MAGIC_MASK
 0xFFFF0000

	)

95 
	#_IO_USER_BUF
 1

	)

96 
	#_IO_UNBUFFERED
 2

	)

97 
	#_IO_NO_READS
 4

	)

98 
	#_IO_NO_WRITES
 8

	)

99 
	#_IO_EOF_SEEN
 0x10

	)

100 
	#_IO_ERR_SEEN
 0x20

	)

101 
	#_IO_DELETE_DONT_CLOSE
 0x40

	)

102 
	#_IO_LINKED
 0x80

	)

103 
	#_IO_IN_BACKUP
 0x100

	)

104 
	#_IO_LINE_BUF
 0x200

	)

105 
	#_IO_TIED_PUT_GET
 0x400

	)

106 
	#_IO_CURRENTLY_PUTTING
 0x800

	)

107 
	#_IO_IS_APPENDING
 0x1000

	)

108 
	#_IO_IS_FILEBUF
 0x2000

	)

109 
	#_IO_BAD_SEEN
 0x4000

	)

110 
	#_IO_USER_LOCK
 0x8000

	)

112 
	#_IO_FLAGS2_MMAP
 1

	)

113 
	#_IO_FLAGS2_NOTCANCEL
 2

	)

114 #ifdeà
_LIBC


115 
	#_IO_FLAGS2_FORTIFY
 4

	)

117 
	#_IO_FLAGS2_USER_WBUF
 8

	)

118 #ifdeà
_LIBC


119 
	#_IO_FLAGS2_SCANF_STD
 16

	)

120 
	#_IO_FLAGS2_NOCLOSE
 32

	)

121 
	#_IO_FLAGS2_CLOEXEC
 64

	)

125 
	#_IO_SKIPWS
 01

	)

126 
	#_IO_LEFT
 02

	)

127 
	#_IO_RIGHT
 04

	)

128 
	#_IO_INTERNAL
 010

	)

129 
	#_IO_DEC
 020

	)

130 
	#_IO_OCT
 040

	)

131 
	#_IO_HEX
 0100

	)

132 
	#_IO_SHOWBASE
 0200

	)

133 
	#_IO_SHOWPOINT
 0400

	)

134 
	#_IO_UPPERCASE
 01000

	)

135 
	#_IO_SHOWPOS
 02000

	)

136 
	#_IO_SCIENTIFIC
 04000

	)

137 
	#_IO_FIXED
 010000

	)

138 
	#_IO_UNITBUF
 020000

	)

139 
	#_IO_STDIO
 040000

	)

140 
	#_IO_DONT_CLOSE
 0100000

	)

141 
	#_IO_BOOLALPHA
 0200000

	)

144 
_IO_jump_t
; 
	g_IO_FILE
;

147 #ifdeà
_IO_MTSAFE_IO


148 #ià
defšed
 
__GLIBC__
 && __GLIBC__ >= 2

149 
	~<b™s/¡dio-lock.h
>

154 
	t_IO_lock_t
;

160 
	s_IO_m¬k”
 {

161 
_IO_m¬k”
 *
	m_Ãxt
;

162 
_IO_FILE
 *
	m_sbuf
;

166 
	m_pos
;

168 
£t_¡»ampos
(
¡»ampos
 
¥
è{ 
	m_¥os
 = sp; }

169 
£t_off£t
(
off£t
è{ 
	m_pos
 = off£t; 
	m_¥os
 = (
¡»ampos
)(-2); }

170 
	mpublic
:

171 
¡»amm¬k”
(
¡»ambuf
 *
sb
);

172 ~
¡»amm¬k”
();

173 
§všg
(è{  
	m_¥os
 == -2; }

174 
d–
(
¡»amm¬k”
&);

175 
d–
();

180 
	e__codecvt_»suÉ


182 
	m__codecvt_ok
,

183 
	m__codecvt_·¹Ÿl
,

184 
	m__codecvt_”rÜ
,

185 
	m__codecvt_nocÚv


188 #ià
defšed
 
_LIBC
 || defšed 
_GLIBCPP_USE_WCHAR_T


191 
	s_IO_codecvt


193 (*
	m__codecvt_de¡r
è(
	m_IO_codecvt
 *);

194 
__codecvt_»suÉ
 (*
__codecvt_do_out
è(
	m_IO_codecvt
 *,

195 
	m__mb¡©e_t
 *,

196 cÚ¡ 
	mwch¬_t
 *,

197 cÚ¡ 
	mwch¬_t
 *,

198 cÚ¡ 
	mwch¬_t
 **, *,

200 
__codecvt_»suÉ
 (*
__codecvt_do_unshiá
è(
	m_IO_codecvt
 *,

201 
	m__mb¡©e_t
 *, *,

203 
__codecvt_»suÉ
 (*
__codecvt_do_š
è(
	m_IO_codecvt
 *,

204 
	m__mb¡©e_t
 *,

206 cÚ¡ **, 
	mwch¬_t
 *,

207 
	mwch¬_t
 *, wchar_t **);

208 (*
	m__codecvt_do_’codšg
è(
	m_IO_codecvt
 *);

209 (*
	m__codecvt_do_®ways_nocÚv
è(
	m_IO_codecvt
 *);

210 (*
	m__codecvt_do_Ëngth
è(
	m_IO_codecvt
 *, 
	m__mb¡©e_t
 *,

211 cÚ¡ *, cÚ¡ *, 
	m_IO_size_t
);

212 (*
	m__codecvt_do_max_Ëngth
è(
	m_IO_codecvt
 *);

214 
_IO_icÚv_t
 
	m__cd_š
;

215 
_IO_icÚv_t
 
	m__cd_out
;

219 
	s_IO_wide_d©a


221 
wch¬_t
 *
	m_IO_»ad_±r
;

222 
wch¬_t
 *
	m_IO_»ad_’d
;

223 
wch¬_t
 *
	m_IO_»ad_ba£
;

224 
wch¬_t
 *
	m_IO_wr™e_ba£
;

225 
wch¬_t
 *
	m_IO_wr™e_±r
;

226 
wch¬_t
 *
	m_IO_wr™e_’d
;

227 
wch¬_t
 *
	m_IO_buf_ba£
;

228 
wch¬_t
 *
	m_IO_buf_’d
;

230 
wch¬_t
 *
	m_IO_§ve_ba£
;

231 
wch¬_t
 *
	m_IO_backup_ba£
;

233 
wch¬_t
 *
	m_IO_§ve_’d
;

235 
__mb¡©e_t
 
	m_IO_¡©e
;

236 
__mb¡©e_t
 
	m_IO_Ï¡_¡©e
;

237 
_IO_codecvt
 
	m_codecvt
;

239 
wch¬_t
 
	m_shÜtbuf
[1];

241 cÚ¡ 
_IO_jump_t
 *
	m_wide_vbË
;

245 
	s_IO_FILE
 {

246 
	m_æags
;

247 
	#_IO_fe_æags
 
_æags


	)

251 * 
	m_IO_»ad_±r
;

252 * 
	m_IO_»ad_’d
;

253 * 
	m_IO_»ad_ba£
;

254 * 
	m_IO_wr™e_ba£
;

255 * 
	m_IO_wr™e_±r
;

256 * 
	m_IO_wr™e_’d
;

257 * 
	m_IO_buf_ba£
;

258 * 
	m_IO_buf_’d
;

260 *
	m_IO_§ve_ba£
;

261 *
	m_IO_backup_ba£
;

262 *
	m_IO_§ve_’d
;

264 
_IO_m¬k”
 *
	m_m¬k”s
;

266 
_IO_FILE
 *
	m_chaš
;

268 
	m_f’o
;

270 
	m_blksize
;

272 
	m_æags2
;

274 
_IO_off_t
 
	m_Şd_off£t
;

276 
	#__HAVE_COLUMN


	)

278 
	m_cur_cŞumn
;

279 sigÃd 
	m_vbË_off£t
;

280 
	m_shÜtbuf
[1];

284 
_IO_lock_t
 *
	m_lock
;

285 #ifdeà
_IO_USE_OLD_IO_FILE


288 
	s_IO_FILE_com¶‘e


290 
_IO_FILE
 
	m_fe
;

292 #ià
defšed
 
_G_IO_IO_FILE_VERSION
 && _G_IO_IO_FILE_VERSION == 0x20001

293 
_IO_off64_t
 
	m_off£t
;

294 #ià
defšed
 
_LIBC
 || defšed 
_GLIBCPP_USE_WCHAR_T


296 
_IO_codecvt
 *
	m_codecvt
;

297 
_IO_wide_d©a
 *
	m_wide_d©a
;

298 
_IO_FILE
 *
	m_ä“»s_li¡
;

299 *
	m_ä“»s_buf
;

300 
size_t
 
	m_ä“»s_size
;

302 *
	m__·d1
;

303 *
	m__·d2
;

304 *
	m__·d3
;

305 *
	m__·d4
;

306 
size_t
 
	m__·d5
;

308 
	m_mode
;

310 
	m_unu£d2
[15 *  (è- 4 *  (*è-  (
size_t
)];

314 #iâdeà
__ılu¥lus


315 
_IO_FILE
 
	t_IO_FILE
;

318 
	g_IO_FILE_¶us
;

320 
_IO_FILE_¶us
 
_IO_2_1_¡dš_
;

321 
_IO_FILE_¶us
 
_IO_2_1_¡dout_
;

322 
_IO_FILE_¶us
 
_IO_2_1_¡d”r_
;

323 #iâdeà
_LIBC


324 
	#_IO_¡dš
 ((
_IO_FILE
*)(&
_IO_2_1_¡dš_
))

	)

325 
	#_IO_¡dout
 ((
_IO_FILE
*)(&
_IO_2_1_¡dout_
))

	)

326 
	#_IO_¡d”r
 ((
_IO_FILE
*)(&
_IO_2_1_¡d”r_
))

	)

328 
_IO_FILE
 *
_IO_¡dš
 
©Œibu‹_hidd’
;

329 
_IO_FILE
 *
_IO_¡dout
 
©Œibu‹_hidd’
;

330 
_IO_FILE
 *
_IO_¡d”r
 
©Œibu‹_hidd’
;

338 
__ssize_t
 
	t__io_»ad_â
 (*
	t__cook›
, *
	t__buf
, 
	tsize_t
 
	t__nby‹s
);

346 
__ssize_t
 
	t__io_wr™e_â
 (*
	t__cook›
, cÚ¡ *
	t__buf
,

347 
	tsize_t
 
	t__n
);

355 
	t__io_£ek_â
 (*
	t__cook›
, 
	t_IO_off64_t
 *
	t__pos
, 
	t__w
);

358 
	t__io_şo£_â
 (*
	t__cook›
);

361 #ifdeà
_GNU_SOURCE


363 
__io_»ad_â
 
	tcook›_»ad_funùiÚ_t
;

364 
__io_wr™e_â
 
	tcook›_wr™e_funùiÚ_t
;

365 
__io_£ek_â
 
	tcook›_£ek_funùiÚ_t
;

366 
__io_şo£_â
 
	tcook›_şo£_funùiÚ_t
;

371 
__io_»ad_â
 *
	m»ad
;

372 
__io_wr™e_â
 *
	mwr™e
;

373 
__io_£ek_â
 *
	m£ek
;

374 
__io_şo£_â
 *
	mşo£
;

375 } 
	t_IO_cook›_io_funùiÚs_t
;

376 
_IO_cook›_io_funùiÚs_t
 
	tcook›_io_funùiÚs_t
;

378 
	g_IO_cook›_fe
;

381 
_IO_cook›_š™
 (
_IO_cook›_fe
 *
__cfe
, 
__»ad_wr™e
,

382 *
__cook›
, 
_IO_cook›_io_funùiÚs_t
 
__âs
);

386 #ifdeà
__ılu¥lus


390 
__und”æow
 (
_IO_FILE
 *);

391 
__uæow
 (
_IO_FILE
 *);

392 
__ov”æow
 (
_IO_FILE
 *, );

393 #ià
defšed
 
_LIBC
 || defšed 
_GLIBCPP_USE_WCHAR_T


394 
_IO_wšt_t
 
__wund”æow
 (
_IO_FILE
 *);

395 
_IO_wšt_t
 
__wuæow
 (
_IO_FILE
 *);

396 
_IO_wšt_t
 
__wov”æow
 (
_IO_FILE
 *, _IO_wint_t);

399 #ià 
__GNUC__
 >= 3

400 
	#_IO_BE
(
ex´
, 
»s
è
	`__butš_ex³ù
 (Óx´),„es)

	)

402 
	#_IO_BE
(
ex´
, 
»s
èÓx´)

	)

405 
	#_IO_g‘c_uÆocked
(
_å
) \

406 (
	`_IO_BE
 ((
_å
)->
_IO_»ad_±r
 >ğ(_å)->
_IO_»ad_’d
, 0) \

407 ? 
	`__uæow
 (
_å
è: *(*è(_å)->
_IO_»ad_±r
++)

	)

408 
	#_IO_³ekc_uÆocked
(
_å
) \

409 (
	`_IO_BE
 ((
_å
)->
_IO_»ad_±r
 >ğ(_å)->
_IO_»ad_’d
, 0) \

410 && 
	`__und”æow
 (
_å
è=ğ
EOF
 ? EOF \

411 : *(*è(
_å
)->
_IO_»ad_±r
)

	)

412 
	#_IO_putc_uÆocked
(
_ch
, 
_å
) \

413 (
	`_IO_BE
 ((
_å
)->
_IO_wr™e_±r
 >ğ(_å)->
_IO_wr™e_’d
, 0) \

414 ? 
	`__ov”æow
 (
_å
, (è(
_ch
)) \

415 : (è(*(
_å
)->
_IO_wr™e_±r
++ = (
_ch
)))

	)

417 #ià
defšed
 
_LIBC
 || defšed 
_GLIBCPP_USE_WCHAR_T


418 
	#_IO_g‘wc_uÆocked
(
_å
) \

419 (
	`_IO_BE
 ((
_å
)->
_wide_d©a
 =ğ
NULL
 \

420 || ((
_å
)->
_wide_d©a
->
_IO_»ad_±r
 \

421 >ğ(
_å
)->
_wide_d©a
->
_IO_»ad_’d
), 0) \

422 ? 
	`__wuæow
 (
_å
è: (
_IO_wšt_t
è*(_å)->
_wide_d©a
->
_IO_»ad_±r
++)

	)

423 
	#_IO_putwc_uÆocked
(
_wch
, 
_å
) \

424 (
	`_IO_BE
 ((
_å
)->
_wide_d©a
 =ğ
NULL
 \

425 || ((
_å
)->
_wide_d©a
->
_IO_wr™e_±r
 \

426 >ğ(
_å
)->
_wide_d©a
->
_IO_wr™e_’d
), 0) \

427 ? 
	`__wov”æow
 (
_å
, 
_wch
) \

428 : (
_IO_wšt_t
è(*(
_å
)->
_wide_d©a
->
_IO_wr™e_±r
++ = (
_wch
)))

	)

431 
	#_IO_ãof_uÆocked
(
__å
è(((__å)->
_æags
 & 
_IO_EOF_SEEN
è!ğ0)

	)

432 
	#_IO_ã¼Ü_uÆocked
(
__å
è(((__å)->
_æags
 & 
_IO_ERR_SEEN
è!ğ0)

	)

434 
_IO_g‘c
 (
_IO_FILE
 *
__å
);

435 
_IO_putc
 (
__c
, 
_IO_FILE
 *
__å
);

436 
_IO_ãof
 (
_IO_FILE
 *
__å
è
__THROW
;

437 
_IO_ã¼Ü
 (
_IO_FILE
 *
__å
è
__THROW
;

439 
_IO_³ekc_locked
 (
_IO_FILE
 *
__å
);

442 
	#_IO_PENDING_OUTPUT_COUNT
(
_å
) \

443 ((
_å
)->
_IO_wr™e_±r
 - (_å)->
_IO_wr™e_ba£
)

	)

445 
_IO_æockfe
 (
_IO_FILE
 *è
__THROW
;

446 
_IO_fuÆockfe
 (
_IO_FILE
 *è
__THROW
;

447 
_IO_árylockfe
 (
_IO_FILE
 *è
__THROW
;

449 #ifdeà
_IO_MTSAFE_IO


450 
	#_IO_³ekc
(
_å
è
	`_IO_³ekc_locked
 (_å)

	)

451 
	#_IO_æockfe
(
_å
) \

452 ià(((
_å
)->
_æags
 & 
_IO_USER_LOCK
è=ğ0è
	`_IO_æockfe
 (_å)

	)

453 
	#_IO_fuÆockfe
(
_å
) \

454 ià(((
_å
)->
_æags
 & 
_IO_USER_LOCK
è=ğ0è
	`_IO_fuÆockfe
 (_å)

	)

456 
	#_IO_³ekc
(
_å
è
	`_IO_³ekc_uÆocked
 (_å)

	)

457 
	#_IO_æockfe
(
_å
è

	)

458 
	#_IO_fuÆockfe
(
_å
è

	)

459 
	#_IO_árylockfe
(
_å
è

	)

460 
	#_IO_ş—nup_»giÚ_¡¬t
(
_fù
, 
_å
è

	)

461 
	#_IO_ş—nup_»giÚ_’d
(
_Do™
è

	)

464 
_IO_vfsÿnf
 (
_IO_FILE
 * 
__»¡riù
, const * __restrict,

465 
_IO_va_li¡
, *
__»¡riù
);

466 
_IO_vårštf
 (
_IO_FILE
 *
__»¡riù
, const *__restrict,

467 
_IO_va_li¡
);

468 
_IO_ssize_t
 
_IO_·dn
 (
_IO_FILE
 *, , _IO_ssize_t);

469 
_IO_size_t
 
_IO_sg‘n
 (
_IO_FILE
 *, *, _IO_size_t);

471 
_IO_off64_t
 
_IO_£ekoff
 (
_IO_FILE
 *, _IO_off64_t, , );

472 
_IO_off64_t
 
_IO_£ekpos
 (
_IO_FILE
 *, _IO_off64_t, );

474 
_IO_ä“_backup_¬—
 (
_IO_FILE
 *è
__THROW
;

476 #ià
defšed
 
_LIBC
 || defšed 
_GLIBCPP_USE_WCHAR_T


477 
_IO_wšt_t
 
_IO_g‘wc
 (
_IO_FILE
 *
__å
);

478 
_IO_wšt_t
 
_IO_putwc
 (
wch¬_t
 
__wc
, 
_IO_FILE
 *
__å
);

479 
_IO_fwide
 (
_IO_FILE
 *
__å
, 
__mode
è
__THROW
;

480 #ià
__GNUC__
 >= 2

483 #ià
defšed
 
_LIBC
 && defšed 
SHARED


484 
	~<shlib-com·t.h
>

485 #ià
SHLIB_COMPAT
 (
libc
, 
GLIBC_2_0
, 
GLIBC_2_1
)

486 
	#_IO_fwide_maybe_šcom·tibË
 \

487 (
	`__butš_ex³ù
 (&
_IO_¡dš_u£d
 =ğ
NULL
, 0))

	)

488 cÚ¡ 
_IO_¡dš_u£d
;

489 
w—k_ex‹º
 (
_IO_¡dš_u£d
);

492 #iâdeà
_IO_fwide_maybe_šcom·tibË


493 
	#_IO_fwide_maybe_šcom·tibË
 (0)

	)

497 
	#_IO_fwide
(
__å
, 
__mode
) \

498 ({ 
__»suÉ
 = (
__mode
); \

499 ià(
__»suÉ
 < 0 && ! 
_IO_fwide_maybe_šcom·tibË
) \

501 ià((
__å
)->
_mode
 == 0) \

503 (
__å
)->
_mode
 = -1; \

504 
__»suÉ
 = (
__å
)->
_mode
; \

506 ià(
	`__butš_cÚ¡ªt_p
 (
__mode
) && (__mode) == 0) \

507 
__»suÉ
 = 
_IO_fwide_maybe_šcom·tibË
 ? -1 : (
__å
)->
_mode
; \

509 
__»suÉ
 = 
	`_IO_fwide
 (
__å
, __result); \

510 
__»suÉ
; })

	)

513 
_IO_vfwsÿnf
 (
_IO_FILE
 * 
__»¡riù
, cÚ¡ 
wch¬_t
 * __restrict,

514 
_IO_va_li¡
, *
__»¡riù
);

515 
_IO_vfw´štf
 (
_IO_FILE
 *
__»¡riù
, cÚ¡ 
wch¬_t
 *__restrict,

516 
_IO_va_li¡
);

517 
_IO_ssize_t
 
_IO_w·dn
 (
_IO_FILE
 *, 
wšt_t
, _IO_ssize_t);

518 
_IO_ä“_wbackup_¬—
 (
_IO_FILE
 *è
__THROW
;

521 #ifdeà
__LDBL_COMPAT


522 
	~<b™s/libio-ldbl.h
>

525 #ifdeà
__ılu¥lus


	@/usr/include/stdc-predef.h

18 #iâdef 
_STDC_PREDEF_H


19 
	#_STDC_PREDEF_H
 1

	)

36 #ifdeà
__GCC_IEC_559


37 #ià
__GCC_IEC_559
 > 0

38 
	#__STDC_IEC_559__
 1

	)

41 
	#__STDC_IEC_559__
 1

	)

44 #ifdeà
__GCC_IEC_559_COMPLEX


45 #ià
__GCC_IEC_559_COMPLEX
 > 0

46 
	#__STDC_IEC_559_COMPLEX__
 1

	)

49 
	#__STDC_IEC_559_COMPLEX__
 1

	)

54 
	#__STDC_ISO_10646__
 201103L

	)

57 
	#__STDC_NO_THREADS__
 1

	)

	@/usr/include/_G_config.h

4 #iâdeà
_G_cÚfig_h


5 
	#_G_cÚfig_h
 1

	)

9 
	~<b™s/ty³s.h
>

10 
	#__Ãed_size_t


	)

11 #ià
defšed
 
_LIBC
 || defšed 
_GLIBCPP_USE_WCHAR_T


12 
	#__Ãed_wch¬_t


	)

14 
	#__Ãed_NULL


	)

15 
	~<¡ddef.h
>

16 
	#__Ãed_mb¡©e_t


	)

17 #ià
defšed
 
_LIBC
 || defšed 
_GLIBCPP_USE_WCHAR_T


18 
	#__Ãed_wšt_t


	)

20 
	~<wch¬.h
>

23 
__off_t
 
	m__pos
;

24 
__mb¡©e_t
 
	m__¡©e
;

25 } 
	t_G_åos_t
;

28 
__off64_t
 
	m__pos
;

29 
__mb¡©e_t
 
	m__¡©e
;

30 } 
	t_G_åos64_t
;

31 #ià
defšed
 
_LIBC
 || defšed 
_GLIBCPP_USE_WCHAR_T


32 
	~<gcÚv.h
>

35 
__gcÚv_šfo
 
	m__cd
;

38 
__gcÚv_šfo
 
	m__cd
;

39 
__gcÚv_¡•_d©a
 
	m__d©a
;

40 } 
	m__combšed
;

41 } 
	t_G_icÚv_t
;

46 
	#_G_va_li¡
 
__gnuc_va_li¡


	)

48 
	#_G_HAVE_MMAP
 1

	)

49 
	#_G_HAVE_MREMAP
 1

	)

51 
	#_G_IO_IO_FILE_VERSION
 0x20001

	)

54 
	#_G_HAVE_ST_BLKSIZE
 
	`defšed
 (
_STATBUF_ST_BLKSIZE
)

	)

56 
	#_G_BUFSIZ
 8192

	)

	@/usr/include/gconv.h

22 #iâdeà
_GCONV_H


23 
	#_GCONV_H
 1

	)

25 
	~<ã©u»s.h
>

26 
	#__Ãed_mb¡©e_t


	)

27 
	#__Ãed_wšt_t


	)

28 
	~<wch¬.h
>

29 
	#__Ãed_size_t


	)

30 
	#__Ãed_wch¬_t


	)

31 
	~<¡ddef.h
>

34 
	#__UNKNOWN_10646_CHAR
 ((
wch¬_t
è0xfffd)

	)

39 
	m__GCONV_OK
 = 0,

40 
	m__GCONV_NOCONV
,

41 
	m__GCONV_NODB
,

42 
	m__GCONV_NOMEM
,

44 
	m__GCONV_EMPTY_INPUT
,

45 
	m__GCONV_FULL_OUTPUT
,

46 
	m__GCONV_ILLEGAL_INPUT
,

47 
	m__GCONV_INCOMPLETE_INPUT
,

49 
	m__GCONV_ILLEGAL_DESCRIPTOR
,

50 
	m__GCONV_INTERNAL_ERROR


57 
	m__GCONV_IS_LAST
 = 0x0001,

58 
	m__GCONV_IGNORE_ERRORS
 = 0x0002,

59 
	m__GCONV_SWAP
 = 0x0004

64 
	g__gcÚv_¡•
;

65 
	g__gcÚv_¡•_d©a
;

66 
	g__gcÚv_lßded_objeù
;

67 
	g__gcÚv_Œªs_d©a
;

71 (*
	t__gcÚv_fù
è(
	t__gcÚv_¡•
 *, 
	t__gcÚv_¡•_d©a
 *,

73 **, 
	tsize_t
 *, , );

76 
	$wšt_t
 (*
	t__gcÚv_btowc_fù
è(
	t__gcÚv_¡•
 *, );

79 (*
	t__gcÚv_š™_fù
è(
	t__gcÚv_¡•
 *);

80 (*
	t__gcÚv_’d_fù
è(
	t__gcÚv_¡•
 *);

84 (*
	t__gcÚv_Œªs_fù
è(
	t__gcÚv_¡•
 *,

85 
	t__gcÚv_¡•_d©a
 *, *,

89 
	tsize_t
 *);

92 (*
	t__gcÚv_Œªs_cÚ‹xt_fù
) (*, const *,

97 (*
	t__gcÚv_Œªs_qu”y_fù
) (const *, const ***,

98 
	tsize_t
 *);

101 (*
	t__gcÚv_Œªs_š™_fù
) (**, const *);

102 (*
	t__gcÚv_Œªs_’d_fù
) (*);

104 
	s__gcÚv_Œªs_d©a


107 
__gcÚv_Œªs_fù
 
__Œªs_fù
;

108 
__gcÚv_Œªs_cÚ‹xt_fù
 
__Œªs_cÚ‹xt_fù
;

109 
__gcÚv_Œªs_’d_fù
 
__Œªs_’d_fù
;

110 *
__d©a
;

111 
__gcÚv_Œªs_d©a
 *
__Ãxt
;

116 
	s__gcÚv_¡•


118 
__gcÚv_lßded_objeù
 *
__shlib_hªdË
;

119 cÚ¡ *
__modÇme
;

121 
__couÁ”
;

123 *
__äom_Çme
;

124 *
__to_Çme
;

126 
__gcÚv_fù
 
__fù
;

127 
__gcÚv_btowc_fù
 
__btowc_fù
;

128 
__gcÚv_š™_fù
 
__š™_fù
;

129 
__gcÚv_’d_fù
 
__’d_fù
;

133 
__mš_Ãeded_äom
;

134 
__max_Ãeded_äom
;

135 
__mš_Ãeded_to
;

136 
__max_Ãeded_to
;

139 
__¡©eful
;

141 *
__d©a
;

146 
	s__gcÚv_¡•_d©a


148 *
__outbuf
;

149 *
__outbuãnd
;

153 
__æags
;

157 
__švoÿtiÚ_couÁ”
;

161 
__š‹º®_u£
;

163 
__mb¡©e_t
 *
__¡©•
;

164 
__mb¡©e_t
 
__¡©e
;

168 
__gcÚv_Œªs_d©a
 *
__Œªs
;

173 
	s__gcÚv_šfo


175 
size_t
 
__n¡•s
;

176 
__gcÚv_¡•
 *
__¡•s
;

177 
__ex‹nsiÚ__
 
__gcÚv_¡•_d©a
 
__d©a
 
__æex¬r
;

178 } *
	t__gcÚv_t
;

	@/usr/include/wchar.h

23 #iâdeà
_WCHAR_H


25 #ià!
defšed
 
__Ãed_mb¡©e_t
 && !defšed 
__Ãed_wšt_t


26 
	#_WCHAR_H
 1

	)

27 
	~<ã©u»s.h
>

30 #ifdeà
_WCHAR_H


32 
	#__Ãed___FILE


	)

33 #ià
defšed
 
__USE_UNIX98
 || defšed 
__USE_XOPEN2K


34 
	#__Ãed_FILE


	)

36 
	~<¡dio.h
>

38 
	#__Ãed___va_li¡


	)

39 
	~<¡d¬g.h
>

41 
	~<b™s/wch¬.h
>

44 
	#__Ãed_size_t


	)

45 
	#__Ãed_wch¬_t


	)

46 
	#__Ãed_NULL


	)

48 #ià
defšed
 
_WCHAR_H
 || defšed 
__Ãed_wšt_t
 || !defšed 
__WINT_TYPE__


49 #undeà
__Ãed_wšt_t


50 
	#__Ãed_wšt_t


	)

51 
	~<¡ddef.h
>

55 #iâdeà
_WINT_T


60 
	#_WINT_T


	)

61 
	twšt_t
;

65 #ià
defšed
 
__ılu¥lus
 && defšed 
_GLIBCPP_USE_NAMESPACES
 \

66 && 
defšed
 
__WINT_TYPE__


67 
__BEGIN_NAMESPACE_STD


68 
__WINT_TYPE__
 
	twšt_t
;

69 
	g__END_NAMESPACE_STD


74 #ià
defšed
 
__ılu¥lus
 && 
__GNUC_PREREQ
 (4, 4)

75 
	#__CORRECT_ISO_CPP_WCHAR_H_PROTO


	)

79 #ià(
defšed
 
_WCHAR_H
 || defšed 
__Ãed_mb¡©e_t
è&& !defšed 
____mb¡©e_t_defšed


80 
	#____mb¡©e_t_defšed
 1

	)

84 
	m__couÁ
;

87 #ifdeà
__WINT_TYPE__


88 
__WINT_TYPE__
 
	m__wch
;

90 
wšt_t
 
	m__wch
;

92 
	m__wchb
[4];

93 } 
	m__v®ue
;

94 } 
	t__mb¡©e_t
;

96 #undeà
__Ãed_mb¡©e_t


101 #ifdeà
_WCHAR_H


103 #iâdeà
__mb¡©e_t_defšed


104 
__BEGIN_NAMESPACE_C99


106 
__mb¡©e_t
 
	tmb¡©e_t
;

107 
	g__END_NAMESPACE_C99


108 
	#__mb¡©e_t_defšed
 1

	)

111 #ifdeà
__USE_GNU


112 
	$__USING_NAMESPACE_C99
(
mb¡©e_t
)

115 #iâdeà
WCHAR_MIN


117 
	#WCHAR_MIN
 
__WCHAR_MIN


	)

118 
	#WCHAR_MAX
 
__WCHAR_MAX


	)

121 #iâdeà
WEOF


122 
	#WEOF
 (0xffffffffu)

	)

127 #ià
defšed
 
__USE_XOPEN
 && !defšed 
__USE_UNIX98


128 
	~<wùy³.h
>

132 
__BEGIN_DECLS


134 
__BEGIN_NAMESPACE_STD


137 
tm
;

138 
__END_NAMESPACE_STD


142 
	$__USING_NAMESPACE_STD
(
tm
)

145 
__BEGIN_NAMESPACE_STD


147 
wch¬_t
 *
	$wcsıy
 (
wch¬_t
 *
__»¡riù
 
__de¡
,

148 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__¤c
è
__THROW
;

150 
wch¬_t
 *
	$wc¢ıy
 (
wch¬_t
 *
__»¡riù
 
__de¡
,

151 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

152 
__THROW
;

155 
wch¬_t
 *
	$wcsÿt
 (
wch¬_t
 *
__»¡riù
 
__de¡
,

156 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__¤c
è
__THROW
;

158 
wch¬_t
 *
	$wc¢ÿt
 (
wch¬_t
 *
__»¡riù
 
__de¡
,

159 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

160 
__THROW
;

163 
	$wcscmp
 (cÚ¡ 
wch¬_t
 *
__s1
, cÚ¡ wch¬_ˆ*
__s2
)

164 
__THROW
 
__©Œibu‹_pu»__
;

166 
	$wc¢cmp
 (cÚ¡ 
wch¬_t
 *
__s1
, cÚ¡ wch¬_ˆ*
__s2
, 
size_t
 
__n
)

167 
__THROW
 
__©Œibu‹_pu»__
;

168 
__END_NAMESPACE_STD


170 #ifdeà
__USE_XOPEN2K8


172 
	$wcsÿ£cmp
 (cÚ¡ 
wch¬_t
 *
__s1
, cÚ¡ wch¬_ˆ*
__s2
è
__THROW
;

175 
	$wc¢ÿ£cmp
 (cÚ¡ 
wch¬_t
 *
__s1
, cÚ¡ wch¬_ˆ*
__s2
,

176 
size_t
 
__n
è
__THROW
;

180 
	~<xloÿË.h
>

182 
	$wcsÿ£cmp_l
 (cÚ¡ 
wch¬_t
 *
__s1
, cÚ¡ wch¬_ˆ*
__s2
,

183 
__loÿË_t
 
__loc
è
__THROW
;

185 
	$wc¢ÿ£cmp_l
 (cÚ¡ 
wch¬_t
 *
__s1
, cÚ¡ wch¬_ˆ*
__s2
,

186 
size_t
 
__n
, 
__loÿË_t
 
__loc
è
__THROW
;

189 
__BEGIN_NAMESPACE_STD


192 
	$wcscŞl
 (cÚ¡ 
wch¬_t
 *
__s1
, cÚ¡ wch¬_ˆ*
__s2
è
__THROW
;

196 
size_t
 
	$wcsxäm
 (
wch¬_t
 *
__»¡riù
 
__s1
,

197 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__s2
, 
size_t
 
__n
è
__THROW
;

198 
__END_NAMESPACE_STD


200 #ifdeà
__USE_XOPEN2K8


206 
	$wcscŞl_l
 (cÚ¡ 
wch¬_t
 *
__s1
, cÚ¡ wch¬_ˆ*
__s2
,

207 
__loÿË_t
 
__loc
è
__THROW
;

212 
size_t
 
	$wcsxäm_l
 (
wch¬_t
 *
__s1
, cÚ¡ wch¬_ˆ*
__s2
,

213 
size_t
 
__n
, 
__loÿË_t
 
__loc
è
__THROW
;

216 
wch¬_t
 *
	$wcsdup
 (cÚ¡ 
wch¬_t
 *
__s
è
__THROW
 
__©Œibu‹_m®loc__
;

219 
__BEGIN_NAMESPACE_STD


221 #ifdeà
__CORRECT_ISO_CPP_WCHAR_H_PROTO


222 "C++" 
wch¬_t
 *
	$wcschr
 (
wch¬_t
 *
__wcs
, wch¬_ˆ
__wc
)

223 
__THROW
 
	`__asm
 ("wcschr"è
__©Œibu‹_pu»__
;

224 "C++" cÚ¡ 
wch¬_t
 *
	$wcschr
 (cÚ¡ 
wch¬_t
 *
__wcs
, wch¬_ˆ
__wc
)

225 
__THROW
 
	`__asm
 ("wcschr"è
__©Œibu‹_pu»__
;

227 
wch¬_t
 *
	$wcschr
 (cÚ¡ 
wch¬_t
 *
__wcs
, wch¬_ˆ
__wc
)

228 
__THROW
 
__©Œibu‹_pu»__
;

231 #ifdeà
__CORRECT_ISO_CPP_WCHAR_H_PROTO


232 "C++" 
wch¬_t
 *
	$wc¤chr
 (
wch¬_t
 *
__wcs
, wch¬_ˆ
__wc
)

233 
__THROW
 
	`__asm
 ("wc¤chr"è
__©Œibu‹_pu»__
;

234 "C++" cÚ¡ 
wch¬_t
 *
	$wc¤chr
 (cÚ¡ 
wch¬_t
 *
__wcs
, wch¬_ˆ
__wc
)

235 
__THROW
 
	`__asm
 ("wc¤chr"è
__©Œibu‹_pu»__
;

237 
wch¬_t
 *
	$wc¤chr
 (cÚ¡ 
wch¬_t
 *
__wcs
, wch¬_ˆ
__wc
)

238 
__THROW
 
__©Œibu‹_pu»__
;

240 
__END_NAMESPACE_STD


242 #ifdeà
__USE_GNU


245 
wch¬_t
 *
	$wcschºul
 (cÚ¡ 
wch¬_t
 *
__s
, wch¬_ˆ
__wc
)

246 
__THROW
 
__©Œibu‹_pu»__
;

249 
__BEGIN_NAMESPACE_STD


252 
size_t
 
	$wcsc¥n
 (cÚ¡ 
wch¬_t
 *
__wcs
, cÚ¡ wch¬_ˆ*
__»jeù
)

253 
__THROW
 
__©Œibu‹_pu»__
;

256 
size_t
 
	$wcs¥n
 (cÚ¡ 
wch¬_t
 *
__wcs
, cÚ¡ wch¬_ˆ*
__acû±
)

257 
__THROW
 
__©Œibu‹_pu»__
;

259 #ifdeà
__CORRECT_ISO_CPP_WCHAR_H_PROTO


260 "C++" 
wch¬_t
 *
	$wc¥brk
 (
wch¬_t
 *
__wcs
, cÚ¡ wch¬_ˆ*
__acû±
)

261 
__THROW
 
	`__asm
 ("wc¥brk"è
__©Œibu‹_pu»__
;

262 "C++" cÚ¡ 
wch¬_t
 *
	$wc¥brk
 (cÚ¡ 
wch¬_t
 *
__wcs
,

263 cÚ¡ 
wch¬_t
 *
__acû±
)

264 
__THROW
 
	`__asm
 ("wc¥brk"è
__©Œibu‹_pu»__
;

266 
wch¬_t
 *
	$wc¥brk
 (cÚ¡ 
wch¬_t
 *
__wcs
, cÚ¡ wch¬_ˆ*
__acû±
)

267 
__THROW
 
__©Œibu‹_pu»__
;

270 #ifdeà
__CORRECT_ISO_CPP_WCHAR_H_PROTO


271 "C++" 
wch¬_t
 *
	$wcs¡r
 (
wch¬_t
 *
__hay¡ack
, cÚ¡ wch¬_ˆ*
__ÃedË
)

272 
__THROW
 
	`__asm
 ("wcs¡r"è
__©Œibu‹_pu»__
;

273 "C++" cÚ¡ 
wch¬_t
 *
	$wcs¡r
 (cÚ¡ 
wch¬_t
 *
__hay¡ack
,

274 cÚ¡ 
wch¬_t
 *
__ÃedË
)

275 
__THROW
 
	`__asm
 ("wcs¡r"è
__©Œibu‹_pu»__
;

277 
wch¬_t
 *
	$wcs¡r
 (cÚ¡ 
wch¬_t
 *
__hay¡ack
, cÚ¡ wch¬_ˆ*
__ÃedË
)

278 
__THROW
 
__©Œibu‹_pu»__
;

282 
wch¬_t
 *
	$wc¡ok
 (
wch¬_t
 *
__»¡riù
 
__s
,

283 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__d–im
,

284 
wch¬_t
 **
__»¡riù
 
__±r
è
__THROW
;

287 
size_t
 
	$wc¦’
 (cÚ¡ 
wch¬_t
 *
__s
è
__THROW
 
__©Œibu‹_pu»__
;

288 
__END_NAMESPACE_STD


290 #ifdeà
__USE_XOPEN


292 #ifdeà
__CORRECT_ISO_CPP_WCHAR_H_PROTO


293 "C++" 
wch¬_t
 *
	$wcswcs
 (
wch¬_t
 *
__hay¡ack
, cÚ¡ wch¬_ˆ*
__ÃedË
)

294 
__THROW
 
	`__asm
 ("wcswcs"è
__©Œibu‹_pu»__
;

295 "C++" cÚ¡ 
wch¬_t
 *
	$wcswcs
 (cÚ¡ 
wch¬_t
 *
__hay¡ack
,

296 cÚ¡ 
wch¬_t
 *
__ÃedË
)

297 
__THROW
 
	`__asm
 ("wcswcs"è
__©Œibu‹_pu»__
;

299 
wch¬_t
 *
	$wcswcs
 (cÚ¡ 
wch¬_t
 *
__hay¡ack
, cÚ¡ wch¬_ˆ*
__ÃedË
)

300 
__THROW
 
__©Œibu‹_pu»__
;

304 #ifdeà
__USE_XOPEN2K8


306 
size_t
 
	$wc¢Ën
 (cÚ¡ 
wch¬_t
 *
__s
, 
size_t
 
__maxËn
)

307 
__THROW
 
__©Œibu‹_pu»__
;

311 
__BEGIN_NAMESPACE_STD


313 #ifdeà
__CORRECT_ISO_CPP_WCHAR_H_PROTO


314 "C++" 
wch¬_t
 *
	$wmemchr
 (
wch¬_t
 *
__s
, wch¬_ˆ
__c
, 
size_t
 
__n
)

315 
__THROW
 
	`__asm
 ("wmemchr"è
__©Œibu‹_pu»__
;

316 "C++" cÚ¡ 
wch¬_t
 *
	$wmemchr
 (cÚ¡ 
wch¬_t
 *
__s
, wch¬_ˆ
__c
,

317 
size_t
 
__n
)

318 
__THROW
 
	`__asm
 ("wmemchr"è
__©Œibu‹_pu»__
;

320 
wch¬_t
 *
	$wmemchr
 (cÚ¡ 
wch¬_t
 *
__s
, wch¬_ˆ
__c
, 
size_t
 
__n
)

321 
__THROW
 
__©Œibu‹_pu»__
;

325 
	$wmemcmp
 (cÚ¡ 
wch¬_t
 *
__s1
, cÚ¡ wch¬_ˆ*
__s2
, 
size_t
 
__n
)

326 
__THROW
 
__©Œibu‹_pu»__
;

329 
wch¬_t
 *
	$wmemıy
 (
wch¬_t
 *
__»¡riù
 
__s1
,

330 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__s2
, 
size_t
 
__n
è
__THROW
;

334 
wch¬_t
 *
	$wmemmove
 (
wch¬_t
 *
__s1
, cÚ¡ wch¬_ˆ*
__s2
, 
size_t
 
__n
)

335 
__THROW
;

338 
wch¬_t
 *
	$wmem£t
 (
wch¬_t
 *
__s
, wch¬_ˆ
__c
, 
size_t
 
__n
è
__THROW
;

339 
__END_NAMESPACE_STD


341 #ifdeà
__USE_GNU


344 
wch¬_t
 *
	$wmempıy
 (
wch¬_t
 *
__»¡riù
 
__s1
,

345 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__s2
, 
size_t
 
__n
)

346 
__THROW
;

350 
__BEGIN_NAMESPACE_STD


353 
wšt_t
 
	$btowc
 (
__c
è
__THROW
;

357 
	$wùob
 (
wšt_t
 
__c
è
__THROW
;

361 
	$mbsš™
 (cÚ¡ 
mb¡©e_t
 *
__ps
è
__THROW
 
__©Œibu‹_pu»__
;

365 
size_t
 
	$mb¹owc
 (
wch¬_t
 *
__»¡riù
 
__pwc
,

366 cÚ¡ *
__»¡riù
 
__s
, 
size_t
 
__n
,

367 
mb¡©e_t
 *
__»¡riù
 
__p
è
__THROW
;

370 
size_t
 
	$wütomb
 (*
__»¡riù
 
__s
, 
wch¬_t
 
__wc
,

371 
mb¡©e_t
 *
__»¡riù
 
__ps
è
__THROW
;

374 
size_t
 
	$__mb¾’
 (cÚ¡ *
__»¡riù
 
__s
, 
size_t
 
__n
,

375 
mb¡©e_t
 *
__»¡riù
 
__ps
è
__THROW
;

376 
size_t
 
	$mb¾’
 (cÚ¡ *
__»¡riù
 
__s
, 
size_t
 
__n
,

377 
mb¡©e_t
 *
__»¡riù
 
__ps
è
__THROW
;

378 
__END_NAMESPACE_STD


380 #ifdeà
__USE_EXTERN_INLINES


386 
wšt_t
 
	$__btowc_®Ÿs
 (
__c
è
	`__asm
 ("btowc");

387 
__ex‹º_šlše
 
wšt_t


388 
	`__NTH
 (
	$btowc
 (
__c
))

389 {  (
	`__butš_cÚ¡ªt_p
 (
__c
) && __c >= '\0' && __c <= '\x7f'

390 ? (
wšt_t
è
__c
 : 
	`__btowc_®Ÿs
 (__c)); 
	}
}

392 
	$__wùob_®Ÿs
 (
wšt_t
 
__c
è
	`__asm
 ("wctob");

393 
__ex‹º_šlše
 

394 
	`__NTH
 (
	$wùob
 (
wšt_t
 
__wc
))

395 {  (
	`__butš_cÚ¡ªt_p
 (
__wc
è&& __wø>ğ
L
'\0' && __wc <= L'\x7f'

396 ? (è
__wc
 : 
	`__wùob_®Ÿs
 (__wc)); 
	}
}

398 
__ex‹º_šlše
 
size_t


399 
__NTH
 (
	$mb¾’
 (cÚ¡ *
__»¡riù
 
__s
, 
size_t
 
__n
,

400 
mb¡©e_t
 *
__»¡riù
 
__ps
))

401 {  (
__ps
 !ğ
NULL


402 ? 
	`mb¹owc
 (
NULL
, 
__s
, 
__n
, 
__ps
è: 
	`__mb¾’
 (__s, __n, NULL)); 
	}
}

405 
__BEGIN_NAMESPACE_STD


408 
size_t
 
	$mb¤towcs
 (
wch¬_t
 *
__»¡riù
 
__d¡
,

409 cÚ¡ **
__»¡riù
 
__¤c
, 
size_t
 
__Ën
,

410 
mb¡©e_t
 *
__»¡riù
 
__ps
è
__THROW
;

414 
size_t
 
	$wc¤tombs
 (*
__»¡riù
 
__d¡
,

415 cÚ¡ 
wch¬_t
 **
__»¡riù
 
__¤c
, 
size_t
 
__Ën
,

416 
mb¡©e_t
 *
__»¡riù
 
__ps
è
__THROW
;

417 
__END_NAMESPACE_STD


420 #ifdef 
__USE_XOPEN2K8


423 
size_t
 
	$mb¢¹owcs
 (
wch¬_t
 *
__»¡riù
 
__d¡
,

424 cÚ¡ **
__»¡riù
 
__¤c
, 
size_t
 
__nmc
,

425 
size_t
 
__Ën
, 
mb¡©e_t
 *
__»¡riù
 
__ps
è
__THROW
;

429 
size_t
 
	$wc¢¹ombs
 (*
__»¡riù
 
__d¡
,

430 cÚ¡ 
wch¬_t
 **
__»¡riù
 
__¤c
,

431 
size_t
 
__nwc
, size_ˆ
__Ën
,

432 
mb¡©e_t
 *
__»¡riù
 
__ps
è
__THROW
;

437 #ifdeà
__USE_XOPEN


439 
	$wcwidth
 (
wch¬_t
 
__c
è
__THROW
;

443 
	$wcswidth
 (cÚ¡ 
wch¬_t
 *
__s
, 
size_t
 
__n
è
__THROW
;

447 
__BEGIN_NAMESPACE_STD


450 
	$wc¡od
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

451 
wch¬_t
 **
__»¡riù
 
__’d±r
è
__THROW
;

452 
__END_NAMESPACE_STD


454 #ifdeà
__USE_ISOC99


455 
__BEGIN_NAMESPACE_C99


457 
	$wc¡of
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

458 
wch¬_t
 **
__»¡riù
 
__’d±r
è
__THROW
;

459 
	$wc¡Şd
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

460 
wch¬_t
 **
__»¡riù
 
__’d±r
è
__THROW
;

461 
__END_NAMESPACE_C99


465 
__BEGIN_NAMESPACE_STD


468 
	$wc¡Ş
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

469 
wch¬_t
 **
__»¡riù
 
__’d±r
, 
__ba£
è
__THROW
;

473 
	$wc¡oul
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

474 
wch¬_t
 **
__»¡riù
 
__’d±r
, 
__ba£
)

475 
__THROW
;

476 
__END_NAMESPACE_STD


478 #ifdeà
__USE_ISOC99


479 
__BEGIN_NAMESPACE_C99


482 
__ex‹nsiÚ__


483 
	$wc¡Şl
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

484 
wch¬_t
 **
__»¡riù
 
__’d±r
, 
__ba£
)

485 
__THROW
;

489 
__ex‹nsiÚ__


490 
	$wc¡ouÎ
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

491 
wch¬_t
 **
__»¡riù
 
__’d±r
,

492 
__ba£
è
__THROW
;

493 
__END_NAMESPACE_C99


496 #ifdeà
__USE_GNU


499 
__ex‹nsiÚ__


500 
	$wc¡oq
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

501 
wch¬_t
 **
__»¡riù
 
__’d±r
, 
__ba£
)

502 
__THROW
;

506 
__ex‹nsiÚ__


507 
	$wc¡ouq
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

508 
wch¬_t
 **
__»¡riù
 
__’d±r
,

509 
__ba£
è
__THROW
;

512 #ifdeà
__USE_GNU


526 
	~<xloÿË.h
>

530 
	$wc¡Ş_l
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

531 
wch¬_t
 **
__»¡riù
 
__’d±r
, 
__ba£
,

532 
__loÿË_t
 
__loc
è
__THROW
;

534 
	$wc¡oul_l
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

535 
wch¬_t
 **
__»¡riù
 
__’d±r
,

536 
__ba£
, 
__loÿË_t
 
__loc
è
__THROW
;

538 
__ex‹nsiÚ__


539 
	$wc¡Şl_l
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

540 
wch¬_t
 **
__»¡riù
 
__’d±r
,

541 
__ba£
, 
__loÿË_t
 
__loc
è
__THROW
;

543 
__ex‹nsiÚ__


544 
	$wc¡ouÎ_l
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

545 
wch¬_t
 **
__»¡riù
 
__’d±r
,

546 
__ba£
, 
__loÿË_t
 
__loc
)

547 
__THROW
;

549 
	$wc¡od_l
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

550 
wch¬_t
 **
__»¡riù
 
__’d±r
, 
__loÿË_t
 
__loc
)

551 
__THROW
;

553 
	$wc¡of_l
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

554 
wch¬_t
 **
__»¡riù
 
__’d±r
, 
__loÿË_t
 
__loc
)

555 
__THROW
;

557 
	$wc¡Şd_l
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

558 
wch¬_t
 **
__»¡riù
 
__’d±r
,

559 
__loÿË_t
 
__loc
è
__THROW
;

563 #ifdeà
__USE_XOPEN2K8


566 
wch¬_t
 *
	$wııy
 (
wch¬_t
 *
__»¡riù
 
__de¡
,

567 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__¤c
è
__THROW
;

571 
wch¬_t
 *
	$wınıy
 (
wch¬_t
 *
__»¡riù
 
__de¡
,

572 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

573 
__THROW
;

580 
__FILE
 *
	$İ’_wmem¡»am
 (
wch¬_t
 **
__buæoc
, 
size_t
 *
__siz–oc
è
__THROW
;

583 #ià
defšed
 
__USE_ISOC95
 || defšed 
__USE_UNIX98


584 
__BEGIN_NAMESPACE_STD


587 
	$fwide
 (
__FILE
 *
__å
, 
__mode
è
__THROW
;

594 
	`fw´štf
 (
__FILE
 *
__»¡riù
 
__¡»am
,

595 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...)

601 
	`w´štf
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...)

604 
	$sw´štf
 (
wch¬_t
 *
__»¡riù
 
__s
, 
size_t
 
__n
,

605 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...)

606 
__THROW
 ;

612 
	`vfw´štf
 (
__FILE
 *
__»¡riù
 
__s
,

613 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

614 
__gnuc_va_li¡
 
__¬g
)

620 
	`vw´štf
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

621 
__gnuc_va_li¡
 
__¬g
)

625 
	$vsw´štf
 (
wch¬_t
 *
__»¡riù
 
__s
, 
size_t
 
__n
,

626 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

627 
__gnuc_va_li¡
 
__¬g
)

628 
__THROW
 ;

635 
	`fwsÿnf
 (
__FILE
 *
__»¡riù
 
__¡»am
,

636 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...)

642 
	`wsÿnf
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...)

645 
	$swsÿnf
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__s
,

646 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...)

647 
__THROW
 ;

649 #ià
defšed
 
__USE_ISOC99
 && !defšed 
__USE_GNU
 \

650 && (!
defšed
 
__LDBL_COMPAT
 || !defšed 
__REDIRECT
) \

651 && (
defšed
 
__STRICT_ANSI__
 || defšed 
__USE_XOPEN2K
)

652 #ifdeà
__REDIRECT


656 
	`__REDIRECT
 (
fwsÿnf
, (
__FILE
 *
__»¡riù
 
__¡»am
,

657 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...),

658 
__isoc99_fwsÿnf
)

660 
	`__REDIRECT
 (
wsÿnf
, (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...),

661 
__isoc99_wsÿnf
)

663 
	`__REDIRECT_NTH
 (
swsÿnf
, (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__s
,

664 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

665 ...), 
__isoc99_swsÿnf
)

668 
	`__isoc99_fwsÿnf
 (
__FILE
 *
__»¡riù
 
__¡»am
,

669 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...);

670 
	`__isoc99_wsÿnf
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...);

671 
	$__isoc99_swsÿnf
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__s
,

672 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...)

673 
__THROW
;

674 
	#fwsÿnf
 
__isoc99_fwsÿnf


	)

675 
	#wsÿnf
 
__isoc99_wsÿnf


	)

676 
	#swsÿnf
 
__isoc99_swsÿnf


	)

680 
__END_NAMESPACE_STD


683 #ifdeà
__USE_ISOC99


684 
__BEGIN_NAMESPACE_C99


689 
	`vfwsÿnf
 (
__FILE
 *
__»¡riù
 
__s
,

690 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

691 
__gnuc_va_li¡
 
__¬g
)

697 
	`vwsÿnf
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

698 
__gnuc_va_li¡
 
__¬g
)

701 
	$vswsÿnf
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__s
,

702 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

703 
__gnuc_va_li¡
 
__¬g
)

704 
__THROW
 ;

706 #ià!
defšed
 
__USE_GNU
 \

707 && (!
defšed
 
__LDBL_COMPAT
 || !defšed 
__REDIRECT
) \

708 && (
defšed
 
__STRICT_ANSI__
 || defšed 
__USE_XOPEN2K
)

709 #ifdeà
__REDIRECT


710 
	`__REDIRECT
 (
vfwsÿnf
, (
__FILE
 *
__»¡riù
 
__s
,

711 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

712 
__gnuc_va_li¡
 
__¬g
), 
__isoc99_vfwsÿnf
)

714 
	`__REDIRECT
 (
vwsÿnf
, (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

715 
__gnuc_va_li¡
 
__¬g
), 
__isoc99_vwsÿnf
)

717 
	`__REDIRECT_NTH
 (
vswsÿnf
, (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__s
,

718 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

719 
__gnuc_va_li¡
 
__¬g
), 
__isoc99_vswsÿnf
)

722 
	`__isoc99_vfwsÿnf
 (
__FILE
 *
__»¡riù
 
__s
,

723 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

724 
__gnuc_va_li¡
 
__¬g
);

725 
	`__isoc99_vwsÿnf
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

726 
__gnuc_va_li¡
 
__¬g
);

727 
	$__isoc99_vswsÿnf
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__s
,

728 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

729 
__gnuc_va_li¡
 
__¬g
è
__THROW
;

730 
	#vfwsÿnf
 
__isoc99_vfwsÿnf


	)

731 
	#vwsÿnf
 
__isoc99_vwsÿnf


	)

732 
	#vswsÿnf
 
__isoc99_vswsÿnf


	)

736 
__END_NAMESPACE_C99


740 
__BEGIN_NAMESPACE_STD


745 
wšt_t
 
	`fg‘wc
 (
__FILE
 *
__¡»am
);

746 
wšt_t
 
	`g‘wc
 (
__FILE
 *
__¡»am
);

752 
wšt_t
 
	`g‘wch¬
 ();

759 
wšt_t
 
	`åutwc
 (
wch¬_t
 
__wc
, 
__FILE
 *
__¡»am
);

760 
wšt_t
 
	`putwc
 (
wch¬_t
 
__wc
, 
__FILE
 *
__¡»am
);

766 
wšt_t
 
	`putwch¬
 (
wch¬_t
 
__wc
);

774 
wch¬_t
 *
	`fg‘ws
 (wch¬_ˆ*
__»¡riù
 
__ws
, 
__n
,

775 
__FILE
 *
__»¡riù
 
__¡»am
);

781 
	`åutws
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ws
,

782 
__FILE
 *
__»¡riù
 
__¡»am
);

789 
wšt_t
 
	`ung‘wc
 (wšt_ˆ
__wc
, 
__FILE
 *
__¡»am
);

790 
__END_NAMESPACE_STD


793 #ifdeà
__USE_GNU


801 
wšt_t
 
	`g‘wc_uÆocked
 (
__FILE
 *
__¡»am
);

802 
wšt_t
 
	`g‘wch¬_uÆocked
 ();

810 
wšt_t
 
	`fg‘wc_uÆocked
 (
__FILE
 *
__¡»am
);

818 
wšt_t
 
	`åutwc_uÆocked
 (
wch¬_t
 
__wc
, 
__FILE
 *
__¡»am
);

827 
wšt_t
 
	`putwc_uÆocked
 (
wch¬_t
 
__wc
, 
__FILE
 *
__¡»am
);

828 
wšt_t
 
	`putwch¬_uÆocked
 (
wch¬_t
 
__wc
);

837 
wch¬_t
 *
	`fg‘ws_uÆocked
 (wch¬_ˆ*
__»¡riù
 
__ws
, 
__n
,

838 
__FILE
 *
__»¡riù
 
__¡»am
);

846 
	`åutws_uÆocked
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ws
,

847 
__FILE
 *
__»¡riù
 
__¡»am
);

851 
__BEGIN_NAMESPACE_C99


855 
size_t
 
	$wcsáime
 (
wch¬_t
 *
__»¡riù
 
__s
, 
size_t
 
__maxsize
,

856 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

857 cÚ¡ 
tm
 *
__»¡riù
 
__
è
__THROW
;

858 
__END_NAMESPACE_C99


860 #ifdeà
__USE_GNU


861 
	~<xloÿË.h
>

865 
size_t
 
	$wcsáime_l
 (
wch¬_t
 *
__»¡riù
 
__s
, 
size_t
 
__maxsize
,

866 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

867 cÚ¡ 
tm
 *
__»¡riù
 
__
,

868 
__loÿË_t
 
__loc
è
__THROW
;

877 #ià
defšed
 
__USE_UNIX98
 && !defšed 
__USE_GNU


878 
	#__Ãed_iswxxx


	)

879 
	~<wùy³.h
>

883 #ià
__USE_FORTIFY_LEVEL
 > 0 && 
defšed
 
__fÜtify_funùiÚ


884 
	~<b™s/wch¬2.h
>

887 #ifdeà
__LDBL_COMPAT


888 
	~<b™s/wch¬-ldbl.h
>

891 
__END_DECLS


899 #undeà
__Ãed_mb¡©e_t


900 #undeà
__Ãed_wšt_t


	@/usr/include/wctype.h

23 #iâdeà
_WCTYPE_H


25 
	~<ã©u»s.h
>

26 
	~<b™s/ty³s.h
>

28 #iâdeà
__Ãed_iswxxx


29 
	#_WCTYPE_H
 1

	)

32 
	#__Ãed_wšt_t


	)

33 
	~<wch¬.h
>

37 #iâdeà
WEOF


38 
	#WEOF
 (0xffffffffu)

	)

41 #undeà
__Ãed_iswxxx


46 #iâdeà
__iswxxx_defšed


47 
	#__iswxxx_defšed
 1

	)

49 
__BEGIN_NAMESPACE_C99


52 
	twùy³_t
;

53 
	g__END_NAMESPACE_C99


55 #iâdeà
_ISwb™


60 
	~<’dŸn.h
>

61 #ià
__BYTE_ORDER
 =ğ
__BIG_ENDIAN


62 
	#_ISwb™
(
b™
è(1 << (b™))

	)

64 
	#_ISwb™
(
b™
) \

65 ((
b™
) < 8 ? () ((1UL << (bit)) << 24) \

66 : ((
b™
) < 16 ? () ((1UL << (bit)) << 8) \

67 : ((
b™
) < 24 ? () ((1UL << (bit)) >> 8) \

68 : (è((1UL << (
b™
)è>> 24))))

	)

73 
	m__ISwuµ”
 = 0,

74 
	m__ISwlow”
 = 1,

75 
	m__ISw®pha
 = 2,

76 
	m__ISwdig™
 = 3,

77 
	m__ISwxdig™
 = 4,

78 
	m__ISw¥aû
 = 5,

79 
	m__ISw´št
 = 6,

80 
	m__ISwg¿ph
 = 7,

81 
	m__ISwbÏnk
 = 8,

82 
	m__ISwúŒl
 = 9,

83 
	m__ISwpunù
 = 10,

84 
	m__ISw®num
 = 11,

86 
	m_ISwuµ”
 = 
_ISwb™
 (
__ISwuµ”
),

87 
	m_ISwlow”
 = 
_ISwb™
 (
__ISwlow”
),

88 
	m_ISw®pha
 = 
_ISwb™
 (
__ISw®pha
),

89 
	m_ISwdig™
 = 
_ISwb™
 (
__ISwdig™
),

90 
	m_ISwxdig™
 = 
_ISwb™
 (
__ISwxdig™
),

91 
	m_ISw¥aû
 = 
_ISwb™
 (
__ISw¥aû
),

92 
	m_ISw´št
 = 
_ISwb™
 (
__ISw´št
),

93 
	m_ISwg¿ph
 = 
_ISwb™
 (
__ISwg¿ph
),

94 
	m_ISwbÏnk
 = 
_ISwb™
 (
__ISwbÏnk
),

95 
	m_ISwúŒl
 = 
_ISwb™
 (
__ISwúŒl
),

96 
	m_ISwpunù
 = 
_ISwb™
 (
__ISwpunù
),

97 
	m_ISw®num
 = 
_ISwb™
 (
__ISw®num
)

102 
__BEGIN_DECLS


104 
__BEGIN_NAMESPACE_C99


111 
	$isw®num
 (
wšt_t
 
__wc
è
__THROW
;

117 
	$isw®pha
 (
wšt_t
 
__wc
è
__THROW
;

120 
	$iswúŒl
 (
wšt_t
 
__wc
è
__THROW
;

124 
	$iswdig™
 (
wšt_t
 
__wc
è
__THROW
;

128 
	$iswg¿ph
 (
wšt_t
 
__wc
è
__THROW
;

133 
	$iswlow”
 (
wšt_t
 
__wc
è
__THROW
;

136 
	$isw´št
 (
wšt_t
 
__wc
è
__THROW
;

141 
	$iswpunù
 (
wšt_t
 
__wc
è
__THROW
;

146 
	$isw¥aû
 (
wšt_t
 
__wc
è
__THROW
;

151 
	$iswuµ”
 (
wšt_t
 
__wc
è
__THROW
;

156 
	$iswxdig™
 (
wšt_t
 
__wc
è
__THROW
;

161 #ifdeà
__USE_ISOC99


162 
	$iswbÏnk
 (
wšt_t
 
__wc
è
__THROW
;

171 
wùy³_t
 
	$wùy³
 (cÚ¡ *
__´İ”ty
è
__THROW
;

175 
	$iswùy³
 (
wšt_t
 
__wc
, 
wùy³_t
 
__desc
è
__THROW
;

176 
__END_NAMESPACE_C99


183 
__BEGIN_NAMESPACE_C99


186 cÚ¡ 
	t__št32_t
 *
	twù¿ns_t
;

187 
__END_NAMESPACE_C99


188 #ifdeà
__USE_GNU


189 
	$__USING_NAMESPACE_C99
(
wù¿ns_t
)

192 
__BEGIN_NAMESPACE_C99


194 
wšt_t
 
	$towlow”
 (
wšt_t
 
__wc
è
__THROW
;

197 
wšt_t
 
	$towuµ”
 (
wšt_t
 
__wc
è
__THROW
;

198 
__END_NAMESPACE_C99


200 
__END_DECLS


207 #ifdeà
_WCTYPE_H


213 
__BEGIN_DECLS


215 
__BEGIN_NAMESPACE_C99


218 
wù¿ns_t
 
	$wù¿ns
 (cÚ¡ *
__´İ”ty
è
__THROW
;

221 
wšt_t
 
	$towù¿ns
 (
wšt_t
 
__wc
, 
wù¿ns_t
 
__desc
è
__THROW
;

222 
__END_NAMESPACE_C99


224 #ifdeà
__USE_XOPEN2K8


226 
	~<xloÿË.h
>

230 
	$isw®num_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

236 
	$isw®pha_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

239 
	$iswúŒl_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

243 
	$iswdig™_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

247 
	$iswg¿ph_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

252 
	$iswlow”_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

255 
	$isw´št_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

260 
	$iswpunù_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

265 
	$isw¥aû_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

270 
	$iswuµ”_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

275 
	$iswxdig™_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

280 
	$iswbÏnk_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

284 
wùy³_t
 
	$wùy³_l
 (cÚ¡ *
__´İ”ty
, 
__loÿË_t
 
__loÿË
)

285 
__THROW
;

289 
	$iswùy³_l
 (
wšt_t
 
__wc
, 
wùy³_t
 
__desc
, 
__loÿË_t
 
__loÿË
)

290 
__THROW
;

298 
wšt_t
 
	$towlow”_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

301 
wšt_t
 
	$towuµ”_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

305 
wù¿ns_t
 
	$wù¿ns_l
 (cÚ¡ *
__´İ”ty
, 
__loÿË_t
 
__loÿË
)

306 
__THROW
;

309 
wšt_t
 
	$towù¿ns_l
 (
wšt_t
 
__wc
, 
wù¿ns_t
 
__desc
,

310 
__loÿË_t
 
__loÿË
è
__THROW
;

314 
__END_DECLS


	@
1
.
1
/usr/include
303
3327
3way.cpp
3way.h
adhoc.cpp
adler32.cpp
adler32.h
aes.h
algebra.cpp
algebra.h
algparam.cpp
algparam.h
arc4.cpp
arc4.h
argnames.h
asn.cpp
asn.h
authenc.cpp
authenc.h
base32.cpp
base32.h
base64.cpp
base64.h
basecode.cpp
basecode.h
bench.cpp
bench.h
bench2.cpp
bfinit.cpp
blowfish.cpp
blowfish.h
blumshub.cpp
blumshub.h
camellia.cpp
camellia.h
cast.cpp
cast.h
casts.cpp
cbcmac.cpp
cbcmac.h
ccm.cpp
ccm.h
channels.cpp
channels.h
cmac.cpp
cmac.h
config.h
cpu.cpp
cpu.h
crc.cpp
crc.h
cryptlib.cpp
cryptlib.h
cryptlib_bds.cpp
datatest.cpp
default.cpp
default.h
des.cpp
des.h
dessp.cpp
dh.cpp
dh.h
dh2.cpp
dh2.h
dll.cpp
dll.h
dlltest.cpp
dmac.h
dsa.cpp
dsa.h
eax.cpp
eax.h
ec2n.cpp
ec2n.h
eccrypto.cpp
eccrypto.h
ecp.cpp
ecp.h
elgamal.cpp
elgamal.h
emsa2.cpp
emsa2.h
eprecomp.cpp
eprecomp.h
esign.cpp
esign.h
factory.h
files.cpp
files.h
filters.cpp
filters.h
fips140.cpp
fips140.h
fipsalgt.cpp
fipstest.cpp
fltrimpl.h
gcm.cpp
gcm.h
gf256.cpp
gf256.h
gf2_32.cpp
gf2_32.h
gf2n.cpp
gf2n.h
gfpcrypt.cpp
gfpcrypt.h
gost.cpp
gost.h
gzip.cpp
gzip.h
hex.cpp
hex.h
hmac.cpp
hmac.h
hrtimer.cpp
hrtimer.h
ida.cpp
ida.h
idea.cpp
idea.h
integer.cpp
integer.h
iterhash.cpp
iterhash.h
lubyrack.h
luc.cpp
luc.h
mars.cpp
mars.h
marss.cpp
md2.cpp
md2.h
md4.cpp
md4.h
md5.cpp
md5.h
mdc.h
misc.cpp
misc.h
modarith.h
modes.cpp
modes.h
modexppc.h
mqueue.cpp
mqueue.h
mqv.cpp
mqv.h
nbtheory.cpp
nbtheory.h
network.cpp
network.h
nr.h
oaep.cpp
oaep.h
oids.h
osrng.cpp
osrng.h
panama.cpp
panama.h
pch.cpp
pch.h
pkcspad.cpp
pkcspad.h
polynomi.cpp
polynomi.h
pssr.cpp
pssr.h
pubkey.cpp
pubkey.h
pwdbased.h
queue.cpp
queue.h
rabin.cpp
rabin.h
randpool.cpp
randpool.h
rc2.cpp
rc2.h
rc5.cpp
rc5.h
rc6.cpp
rc6.h
rdtables.cpp
regtest.cpp
resource.h
rijndael.cpp
rijndael.h
ripemd.cpp
ripemd.h
rng.cpp
rng.h
rsa.cpp
rsa.h
rw.cpp
rw.h
safer.cpp
safer.h
salsa.cpp
salsa.h
seal.cpp
seal.h
secblock.h
seckey.h
seed.cpp
seed.h
serpent.cpp
serpent.h
serpentp.h
sha.cpp
sha.h
sha3.cpp
sha3.h
shacal2.cpp
shacal2.h
shark.cpp
shark.h
sharkbox.cpp
simple.cpp
simple.h
skipjack.cpp
skipjack.h
smartptr.h
socketft.cpp
socketft.h
sosemanuk.cpp
sosemanuk.h
square.cpp
square.h
squaretb.cpp
stdcpp.h
strciphr.cpp
strciphr.h
tea.cpp
tea.h
test.cpp
tftables.cpp
tiger.cpp
tiger.h
tigertab.cpp
trdlocal.cpp
trdlocal.h
trunhash.h
ttmac.cpp
ttmac.h
twofish.cpp
twofish.h
validat1.cpp
validat2.cpp
validat3.cpp
validate.h
vmac.cpp
vmac.h
wait.cpp
wait.h
wake.cpp
wake.h
whrlpool.cpp
whrlpool.h
winpipes.cpp
winpipes.h
words.h
xtr.cpp
xtr.h
xtrcrypt.cpp
xtrcrypt.h
zdeflate.cpp
zdeflate.h
zinflate.cpp
zinflate.h
zlib.cpp
zlib.h
/usr/include/alloca.h
/usr/include/arpa/inet.h
/usr/include/assert.h
/usr/include/byteswap.h
/usr/include/ctype.h
/usr/include/errno.h
/usr/include/fcntl.h
/usr/include/limits.h
/usr/include/malloc.h
/usr/include/math.h
/usr/include/netdb.h
/usr/include/netinet/in.h
/usr/include/netinet/tcp.h
/usr/include/pthread.h
/usr/include/setjmp.h
/usr/include/signal.h
/usr/include/stdlib.h
/usr/include/string.h
/usr/include/time.h
/usr/include/unistd.h
/usr/include/endian.h
/usr/include/features.h
/usr/include/getopt.h
/usr/include/rpc/netdb.h
/usr/include/sched.h
/usr/include/stdint.h
/usr/include/stdio.h
/usr/include/xlocale.h
/usr/include/libio.h
/usr/include/stdc-predef.h
/usr/include/_G_config.h
/usr/include/gconv.h
/usr/include/wchar.h
/usr/include/wctype.h
